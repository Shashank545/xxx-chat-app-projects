define("bc9242cf-c4f7-4ff8-a1f4-93ae4da35b7f_0.1.0",["tslib","@ms/office-ui-fabric-react-bundle","@ms/odsp-core-bundle","@microsoft/sp-core-library","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles"],function(n,a,i,r,o,s,c,d,l){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"5pbq":function(e,t){e.exports=a},K9kD:function(e,t){e.exports=i},UWqr:function(e,t){e.exports=r},bppC:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},bwt4:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_ResponsiveModeIndex},cDcd:function(e,t){e.exports=o},cNe7:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"Qos")&&n.d(t,"Qos",function(){return a.Qos}),n.o(a,"ResultTypeEnum")&&n.d(t,"ResultTypeEnum",function(){return a.ResultTypeEnum})},faye:function(e,t){e.exports=s},fglE:function(e,t){e.exports=c},fxVk:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_Icon},"hiL/":function(e,t){e.exports=d},jOlS:function(e,t){e.exports=l},kRBI:function(e){e.exports=JSON.parse('{"e":"Pick a file||Pick files","t":"1||2-","n":"Pick a folder||Pick folders","a":"1||2-","i":"Pick an item||Pick items","r":"1||2-"}')},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"SPFilePickerHost",function(){return at}),n.d(t,"SPFilePickerHostCallbacks",function(){return Ye}),n.d(t,"getEntryConfiguration",function(){return Je}),n.d(t,"getListLayoutConfiguration",function(){return Xe}),n.d(t,"getTypesAndSourcesConfiguraton",function(){return Ze}),n.d(t,"getCommandConfiguration",function(){return $e}),n.d(t,"getPivotConfigurations",function(){return et}),n.d(t,"getFilePickerHostOptions",function(){return tt});var a=n("17wl"),i=n("cDcd"),r=n.n(i);function o(e){var t=i.useRef(e);t.current=e;var n=i.useRef();return n.current||(n.current=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var a=t.current;return a.apply(null,e)})}var s=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}(),c=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),a=function(e,a){var i=e,r=i.dispose,o="function"==typeof r&&r.disposalChain||function(e){var t=new s(e),n=e.dispose,a=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=a,a.disposalChain=t,t}(i);return o.addCallback(function(){delete t._disposables[n]}),i}(e);return this._disposables[n]=a,a},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],i=e[a];i&&"function"==typeof i.dispose&&i.dispose(),delete e[a]}},e}(),d=function(){function e(e){this._scope=new c,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(l(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var r=this._disposableMap.get(e);r||(r=new Map,this._disposableMap.set(e,r));var o=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});r.set(t,o)},e.prototype.off=function(e,t,n){var a;if(l(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var r=this._disposableMap.get(e);if(r){var o=r.get(t);o&&(o.dispose(),r.delete(t)),0===r.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function l(e){return!!e.addEventListener}var u,f=function(){function e(e){this._scope=new c,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),p="handlerRejection",m="canceled",_=0,h=function(){function e(e,t){void 0===t&&(t={});var n=this,a=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},r=e.initResources,o=e.initTimeoutMs,s=void 0===o?1e4:o,l=e.ackTimeoutMs,u=void 0===l?1e3:l,_=e.resultTimeoutMs,h=void 0===_?1e4:_,b=t.asyncType,g=void 0===b?f:b,v=t.eventGroupType,y=void 0===v?d:v,S=this._scope=new c;S.attach(r);var D,I=this._async=S.attach(new g(this)),x=S.attach(new y(this));this._ackTimeoutMs=u,this._resultTimeoutMs=h,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:p,isExpected:!1,message:"Unknown error"}).code||e.name||p,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(e){}};var C=this._port=new Promise(function(t,a){S.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=m,a(e)}}),D=I.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code="setupTimeout",a(e)},s),e.init(function(e){I.clearTimeout(D),S.attach({dispose:function(){e.close()}}),x.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=C.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=a}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:m,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++_,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o,c=t.transfer;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(b(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(b(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e},c||[]),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function b(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl"}(u||(u={}));var g=function(e,t){void 0===e&&(e=""),void 0===t&&(t=!1);var n=e.indexOf("//"),a=e.indexOf("/"),i=n>-1&&n<=a?n+"//".length:-1,r=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,i),o=r&&r.slice(i),s=e.slice(r.length),c=r?u.absolute:t&&v.test(e)?u.dataUrl:"/"===s[0]?u.serverRelative:u.relative,d=s.split("/");this.authority=r,this.domain=o,this.format=c,this.path=s,this.segments=d,this.value=e},v=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;function y(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function S(e,t){return void 0===t&&(t=!1),e?function(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}(e.toUpperCase(),t):""}function D(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i}var I=n("jOlS");Object(I.loadStyles)([{rawString:".frame_610dbd83{border:none;display:block}"}]);var x,C,O=n("cNe7"),w=n("bppC"),E=n("vNcA"),A=(x={},C=new WeakMap,Object.freeze(x),C.set(x,!0),!!C.get(x));function L(e){A&&(Object.isFrozen(e)||Object.freeze(e))}function k(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var M=new WeakMap,P=function(){function e(){this.isDelete=!0}return e.prototype.apply=function(){},e}(),T=function(){this.isPatch=!0};function U(e,t){return function(e){void 0===e&&(e={});var t=e.freeze,n=void 0!==t&&t,a=new Map,i=new Map;function r(e){return a.set(e,!0),e}return function(e){var t=e(function e(t,o){var s=a.get(t)?t:void 0;if(o){if(i.get(o))throw new Error("Encountered a circular reference in patch supplied to graft().");i.set(o,!0);for(var c=0,d=Object.keys(o);c<d.length;c++){var l=d[c],u=t[l],f=o[l];if(!k(f,u)){var p=void 0;if(f&&F(f)?p=f:f&&f instanceof T?p=f.apply(u,{graft:e,unlock:r}):f&&"object"==typeof f&&Object.getPrototypeOf(f)!==Object.prototype?p=f:f&&"object"==typeof f&&u&&"object"==typeof u?p=e(u,f):"object"==typeof f&&f&&H(f)?(p=e(r({}),f),n&&p&&"object"==typeof p&&!a.get(p)&&L(p)):p=f,!k(p,u)||!(l in t)){if(!s){s=r({});for(var m=0,_=Object.keys(t);m<_.length;m++){var h=_[m];s[h]=t[h]}}F(p)?delete s[l]:s[l]=p}}}i.delete(o)}var b=s||t;return b&&M.set(b,!1),b},{unlock:r});return n&&a.forEach(function(e,t){L(t)}),t}}()(function(n){return n(e,t)})}function F(e){return e instanceof P}function H(e){return R(e,{ancestors:new Map})}function R(e,t){var n=t.ancestors;if(n.get(e))throw new Error("Encountered circular reference in patch supplied to graft().");var a=M.get(e);if(void 0!==a)return a;n.set(e,!0);var i=!1;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=e[r];if(o&&o instanceof P){i=!0;break}if(o&&o instanceof T){i=!0;break}if(o&&"object"==typeof o&&Object.getPrototypeOf(o)===Object.prototype&&R(o,t)){i=!0;break}}return n.delete(e),M.set(e,i),i}function N(e,t){if(!k(e,t)){for(var n={},a=0,i=Object.keys(e);a<i.length;a++){var r=e[l=i[a]],o=t[l];if(l in t){if(!k(o,r))if("object"==typeof o&&o&&Object.getPrototypeOf(o)!==Object.prototype)n[l]=o;else if("object"==typeof o&&o&&"object"==typeof r&&r){var s=N(r,o);s&&Object.keys(s).length>0&&(n[l]=s)}else n[l]=o}else n[l]=new P}for(var c=0,d=Object.keys(t);c<d.length;c++){var l;(l=d[c])in e||(n[l]=t[l])}return n}}function B(e,t){var n=t instanceof Array?function(e,t,n){for(var a={},i=0,r=e;i<r.length;i++){a[r[i]]=!0}return a}(t):t,i=void 0;for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(r in n||(i||(i=Object(a.__assign)({},e)),delete i[r]));return i||e}var j="KillSwitchOverrides",V="".concat(j,"_").concat("enableKillSwitches"),z="".concat(j,"_").concat("disableKillSwitches");function G(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function K(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(V,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(z,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}var W={},q=function(){W=function(e,t,n,a){if(t)for(var i=0,r=t.split(",");i<r.length;i++)e[S(r[i],!1)]=!0;if(n)for(var o=0,s=n.split(",");o<s.length;o++)e[S(s[o],!1)]=!1;return e}({},G(V),G(z));var e=function(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]))}return t}(function(){try{return location.search?location.search.substring(1):""}catch(e){return""}}());e.enableKillSwitches,e.disableKillSwitches,e.debugKillSwitches,K(W);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0),W[S(e,!1)]=!!t,K(W)}}catch(e){}q=function(){}},Q=function(){function e(){}return e.initKillSwitches=function(t){e._killSwitch=Y({killSwitches:t||{}})},e.isActivated=function(t,n,a){var i;if(q(),e._killSwitch)return e.isActivated=e._killSwitch.isActivated,e._killSwitch.isActivated(t,n,a);try{if(window._spPageContextInfo){var r=Y(window._spPageContextInfo);return(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=r.isActivated),r.isActivated(t,n,a)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var s=0,c=Object.keys(window.Flight.KillSwitches);s<c.length;s++){var d=c[s];o[window.Flight.KillSwitches[d]]=!0}}var l=Y({killSwitches:o});return o&&(e.isActivated=l.isActivated),l.isActivated(t,n,a)}}catch(e){return!1}return!1},e}();function Y(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,a){var i=!1;if(e){var r=S(e,!1);r in W?i=!!W[r]:t&&(i=!!t[r])}return i}}}var J=n("5pbq"),X=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(X.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(X,Error));var Z=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError,r=t.wrapErrorCode,o=i||void 0,s=o?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},"string"==typeof o.correlationId?{correlationId:o.correlationId}:{}),"boolean"==typeof o.isExpected?{isExpected:o.isExpected}:{}),"string"==typeof o.name?{code:o.name}:{}),"string"==typeof o.code?{code:o.code}:{}),"object"==typeof o.extraData?{extraData:o.extraData}:{}):{},c=t.correlationId,d=void 0===c?s.correlationId:c,l=t.isExpected,u=void 0===l?s.isExpected:l,f=t.extraData;return n.correlationId=d,n.isExpected=!!u,n.code=r&&s.code&&t.code&&"".concat(t.code," (").concat(s.code,")")||t.code||s.code||"",n.extraData=Object(a.__assign)(Object(a.__assign)({},s.extraData||{}),f||{}),n}return Object(a.__extends)(t,e),t}(X),$="Canceled",ee=function(e){function t(t){void 0===t&&(t={message:$});var n=e.call(this,Object(a.__assign)({code:t.code||$,isExpected:!0},t))||this;return n.name=$,n}return Object(a.__extends)(t,e),t}(Z);function te(e){var t,n,i=e||void 0;return Object(a.__assign)(Object(a.__assign)({error:e&&(e.message||e.name),resultCode:i&&(t=i,n=[],"object"==typeof t.extraData&&t.extraData&&void 0!==t.extraData.status&&n.push("[".concat(t.extraData.status,"]")),"string"==typeof t.code&&n.push("".concat(t.code)),n.join(" "))||e&&e.name||"Unknown"},i?Object(a.__assign)({},"boolean"==typeof i.isExpected?{resultType:i.isExpected?O.ResultTypeEnum.ExpectedFailure:O.ResultTypeEnum.Failure}:{resultType:O.ResultTypeEnum.Failure}):{resultType:O.ResultTypeEnum.Success}),{extraData:Object(a.__assign)({stack:e&&e.stack},i?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},"object"==typeof i.innerError?{innerError:te(i.innerError)}:{}),"string"==typeof i.correlationId?{correlationId:i.correlationId}:{}),"object"==typeof i.extraData?Object(a.__assign)({},i.extraData):{}):{})})}var ne=n("kRBI"),ae=/\{(\d+)\}/g,ie={all:{pickerTitle:ne.i,pickerTitleIntervals:ne.r},files:{pickerTitle:ne.e,pickerTitleIntervals:ne.t},folders:{pickerTitle:ne.n,pickerTitleIntervals:ne.a}};function re(e){var t,n=e.title,a=e.selectionMode,i=e.itemMode;if(n)t=n;else{var r="multiple"===a?2:1,o=ie[i];t=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(ae,function(e,n){var a=t[Number(n)];return null===a?"":"".concat(a)})}(function(e,t,n){if(n=Number(n),void 0===e||void 0===t||void 0===n)return"";for(var a="",i=-1,r=t.split("||"),o=0,s=r.length;o<s;o++){var c=r[o];if(c){for(var d=0,l=c.split(",");d<l.length;d++){var u=l[d];if(u)if(isNaN(Number(u))){if(-1!==u.indexOf("-")){var f=u.split("-");if(2!==f.length)continue;var p=void 0,m=void 0;if("*"===u[0]){var _=f[0].substring(1),h=f[1];if(isNaN(Number(_))||isNaN(Number(h)))continue;p=parseInt(_,10),m=parseInt(h,10);for(var b=void 0,g=p;g<=m;g++){var v="[0-9]*"+g;if(new RegExp("^".concat(v,"$")).test(n.toString())){b=!0;break}}if(b){i=o;break}}else{if(""===f[0])p=0;else{if(isNaN(Number(f[0])))continue;p=parseInt(f[0],10)}if(n>=p){if(""===f[1]){i=o;break}if(isNaN(Number(f[1])))continue;if(n<=(m=parseInt(f[1],10))){i=o;break}}}}else if(-1!==u.indexOf("*")&&(v=u.trim().replace(/\*/g,"[0-9]*"),new RegExp("^".concat(v,"$")).test(n.toString()))){i=o;break}}else if(n===parseInt(u,10)){i=o;break}}if(-1!==i)break}}if(-1!==i){var y=e.split("||");y[i]&&(a=y[i])}return a}(o.pickerTitle,o.pickerTitleIntervals,r)||"")}return t}var oe=Q.isActivated("182B2FCC-2348-48AB-BFBE-04969610C5E1","10/18/2021","Split picker options across query-string and post-messaging"),se=Q.isActivated("69FB175A-8186-4311-9045-F073BA0B6A87","10/27/2021","Propagate current theme to File Picker"),ce=i.forwardRef(function(e,t){var n,r,s,l,u,f=e.options,p=e.pickerPageUrl,m=e.app,_=e.scenario,b=e.onCommand,v=e.onNotification,S=e.className,I=e.theme,x=e.getAuthToken,C=e.reloadOnEntry,A=i.useState(null),L=A[0],k=A[1],M=i.useRef(),P=i.useRef(),T=P.current||(P.current=new O.Qos({name:"Sdk80FilePickerHost.".concat(_,".load")})),F=i.useRef(null),H=i.useCallback(function(e){F.current=e,k(e&&e.contentWindow||null)},[]),R=i.useState(function(){return"filePicker-".concat(function(e){var t=[];t.push(y(8,e)),t.push(y(4,e));var n="4"+y(3,e);t.push(n);var a=y(4,e),i=parseInt(a[0],16);return i&=3,a=(i|=8).toString(16)+a.substr(1),t.push(a),t.push(y(12,e)),t.join("-")}())})[0],j=i.useMemo(function(){return Object(a.__assign)({sdk:"8.0",accessibility:{showFocusOnLoad:document.body.classList.contains(E.IsFocusVisibleClassName),enableFocusTrap:!0}},!se&&I?{theme:I}:{})},[I]),V=i.useMemo(function(){return U(U(j,f||{}),{sdk:"8.0",messaging:Object(a.__assign)({origin:location.origin,channelId:R,identifyParent:!0},oe?{}:{waitForConfiguration:!0})})},[f]),z=i.useMemo(function(){var e="string"==typeof V.theme?V.theme:function(e){return e?Object(a.__assign)(Object(a.__assign)({isInverted:e.isInverted},e.palette?{palette:B(e.palette,["white"])}:{}),e.semanticColors?{semanticColors:B(e.semanticColors,["bodyBackground"])}:{}):e}(V.theme),t=oe?V:Object(a.__assign)(Object(a.__assign)({},B(V,["sdk","authentication","messaging","entry","accounts","teams","telemetry","views"])),!se&&e?{theme:e}:{});return"".concat(p,"?").concat(function(e,t,n){var a="",i=!0;for(var r in e){var o,s=e[r];i?i=!1:a+="&",o="object"==typeof s&&s&&s.uriValue?s.uriValue:D("".concat(s)),a+="".concat(r,"=").concat(o)}return a}({app:m,scenario:_,filePicker:JSON.stringify(t)}))},[p]),G=o(e.onPick),K=o(e.onClose),W=o(e.onLoad),q=o(function(e){if("page-loaded"===e.notification){var t=void 0,n=e.error;n&&(t=new Z({code:n.code,message:n.message,isExpected:n.isExpected})),T.end(te(t)),W({error:t})}v&&v(e)}),Q=o(function(e){switch(e.command){case"pick":return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return T.end({resultType:O.ResultTypeEnum.Success}),[4,G({items:e.items,keepSharing:e.keepSharing})];case 1:return t.sent(),[2,{result:"success"}]}})});case"close":return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return(t=e.error)&&(n=new Z({code:t.code,message:t.message,isExpected:t.isExpected})),T.end(te(n)),[4,K({error:n||M.current||new ee({message:"Closed"})})];case 1:return a.sent(),[2,{result:"success"}]}})})}if(b)return b(e)}),Y=i.useRef(!1),J=i.useRef();i.useEffect(function(){var e;if(L){var t=new g(p).authority;Y.current=!0,null===(e=F.current)||void 0===e||e.setAttribute("aria-busy","true");var n=function(e,t){void 0===t&&(t={});var n=e.channelId,a=e.onReinitialize,i=e.origin,r=e.receiver,o=void 0===r?window:r,s=e.source,l=e.identifyParent,u=t.eventGroupType,f=void 0===u?d:u,p=t.messengerType,m=void 0===p?h:p,_=new c,b=_.attach(new f(null));return new m({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var r;if(l&&s){var c=setInterval(function(){var e={type:"identify-parent",channelId:n};s.postMessage(e,i)},100);r=_.attach({dispose:function(){clearInterval(c)}})}var d=!1;b.on(o,"message",function(t){var o=t.data;if(t.origin===i&&(!s||t.source===s)&&o&&"object"==typeof o&&"initialize"===o.type&&o.channelId===n){if(r&&r.dispose(),a){if(d)return a(),void b.dispose();d=!0}else b.dispose();var c=o.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:_,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({initTimeoutMs:6e4,channelId:R,origin:t,onNotification:q,onCommand:Q,identifyParent:!0,source:L});return J.current=n,Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return x?[4,x({url:p})]:[3,2];case 1:return t=a.sent(),[3,3];case 2:t=void 0,a.label=3;case 3:return e=t,(i=L.document.createElement("form")).setAttribute("method","POST"),i.setAttribute("action",z),e&&((r=L.document.createElement("input")).setAttribute("type","hidden"),r.setAttribute("name","access_token"),r.setAttribute("value",e),i.appendChild(r)),L.document.body.appendChild(i),i.submit(),F.current&&F.current.focus(),oe?[3,6]:[4,n.ready];case 4:return a.sent(),o={command:"configure",filePicker:V||{}},[4,n.sendCommand(o)];case 5:a.sent(),a.label=6;case 6:return Y.current=!1,null===(s=F.current)||void 0===s||s.setAttribute("aria-busy","false"),M.current=void 0,[2]}})}).catch(function(e){var t;Y.current=!1,null===(t=F.current)||void 0===t||t.setAttribute("aria-busy","false"),M.current||(M.current=e),W&&W({error:e})}),function(){J.current=void 0,n.dispose()}}},[L]),i.useImperativeHandle(t,function(){return{sendCommand:function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){return(n=J.current)?[2,n.sendCommand(e,t)]:[2,{result:"error",isExpected:!1}]})})}}});var X=o(function(e){M.current||(M.current=new Z({code:"UnableToLoadPickerFrame"}),W&&W({error:M.current}))}),$=i.useRef(null!==(n=V.entry)&&void 0!==n?n:{});i.useEffect(function(){Object(a.__awaiter)(void 0,void 0,void 0,function(){var e,t,n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return!J.current||Y.current?[3,3]:(e={command:"configure",filePicker:V||{}},t=null!==(i=V.entry)&&void 0!==i?i:{},n=N($.current,t),$.current=t,[4,J.current.sendCommand(e)]);case 1:return a.sent(),C&&n&&Object.keys(n).length>0?[4,J.current.sendCommand({command:"load-page"})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})}).catch(function(){})},[V]);var ne=null!==(s=null===(r=null==V?void 0:V.selection)||void 0===r?void 0:r.mode)&&void 0!==s?s:"single",ae=null!==(u=null===(l=null==V?void 0:V.typesAndSources)||void 0===l?void 0:l.mode)&&void 0!==u?u:"files";return i.createElement("iframe",{"data-automationid":"filePickerFrame",ref:H,onError:X,title:re({title:V.title,selectionMode:ne,itemMode:ae}),className:Object(w.css)("frame_610dbd83",S)})}),de=se?ce:Object(J.styled)(ce,function(e){return{}}),le=J.AnimationVariables.durationValue2,ue={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},fe=i.createContext(void 0),pe=function(){return function(){}};fe.Provider;var me=n("faye"),_e={},he={},be="fluent-default-layer-host",ge="#".concat(be);function ve(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.useCallback(function(t){n.current=t;for(var a=0,i=e;a<i.length;a++){var r=i[a];"function"==typeof r?r(t):r&&(r.current=t)}},Object(a.__spreadArray)([],e,!0));return n}var ye,Se=Object(J.classNamesFunction)(),De=i.forwardRef(function(e,t){var n=function(){var e;return null!==(e=i.useContext(fe))&&void 0!==e?e:pe}(),r=i.useRef(null),o=ve(r,t),s=i.useRef(),c=i.useRef(null),d=i.useContext(J.FocusRectsContext),l=i.useState(!1),u=l[0],f=l[1],p=i.useCallback(function(e){var t,n=!!(null==(t=null==d?void 0:d.providerRef)?void 0:t.current)&&t.current.classList.contains(J.IsFocusVisibleClassName);e&&n&&e.classList.add(J.IsFocusVisibleClassName)},[d]),m=e.children,_=e.className,h=e.eventBubblingEnabled,b=e.fabricProps,g=e.hostId,v=e.insertFirst,y=e.onLayerDidMount,S=void 0===y?function(){}:y,D=e.onLayerMounted,I=void 0===D?function(){}:D,x=e.onLayerWillUnmount,C=e.styles,O=e.theme,w=ve(c,null==b?void 0:b.ref,p),A=Se(C,{theme:O,className:_,isNotHost:!g}),L=function(){null==x||x();var e=s.current;s.current=void 0,e&&e.parentNode&&e.parentNode.removeChild(e)},k=function(){var e,t=Object(J.getDocument)(r.current);if(t){var n=function(e){var t,n;if(g){var a=function(e){var t=he[e];return t&&t[0]||void 0}(g);return a?null!==(t=a.rootRef.current)&&void 0!==t?t:null:null!==(n=e.getElementById(g))&&void 0!==n?n:null}var i=ge,r=i?e.querySelector(i):null;return r||(r=function(e){var t=e.createElement("div");return t.setAttribute("id",be),t.style.cssText="position:fixed;z-index:1000000",null==e||e.body.appendChild(t),t}(e)),r}(t);if(n){L();var a=(null!==(e=n.ownerDocument)&&void 0!==e?e:t).createElement("div");a.className=A.root,Object(J.setPortalAttribute)(a),Object(J.setVirtualParent)(a,r.current),v?n.insertBefore(a,n.firstChild):n.appendChild(a),s.current=a,f(!0)}}};return Object(E.useIsomorphicLayoutEffect)(function(){k(),g&&function(e,t){_e[e]||(_e[e]=[]),_e[e].push(t);var n=he[e];if(n)for(var a=0,i=n;a<i.length;a++)i[a].notifyLayersChanged()}(g,k);var e=s.current?n(s.current):void 0;return function(){e&&e(),L(),g&&function(e,t){var n=_e[e];if(n){var a=n.indexOf(t);a>=0&&(n.splice(a,1),0===n.length&&delete _e[e])}var i=he[e];if(i)for(var r=0,o=i;r<o.length;r++)o[r].notifyLayersChanged()}(g,k)}},[g]),i.useEffect(function(){s.current&&u&&(null==I||I(),null==S||S(),f(!1))},[u,I,S]),i.createElement("span",{className:"ms-layer",ref:o},s.current&&me.createPortal(i.createElement(J.FocusRectsProvider,{layerRoot:!0,providerRef:w},i.createElement(J.Fabric,Object(a.__assign)({},!h&&(ye||(ye={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach(function(e){return ye[e]=Ie})),ye),b,{className:Object(J.css)(A.content,null==b?void 0:b.className),ref:w}),m)),s.current))});De.displayName="LayerBase";var Ie=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()},xe={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},Ce=Object(J.styled)(De,function(e){var t=e.className,n=e.isNotHost,a=e.theme,i=Object(J.getGlobalClassNames)(xe,a);return{root:[i.root,a.fonts.medium,n&&[i.rootNoHost,{position:"fixed",zIndex:J.ZIndexes.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[i.content,{visibility:"visible"}]}},void 0,{scope:"Layer",fields:["hostId","theme","styles"]}),Oe=n("sx5R"),we=n("bwt4"),Ee=n("fxVk"),Ae=Object(J.memoizeFunction)(function(e,t){return{root:Object(J.mergeStyles)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),Le={start:"touchstart",move:"touchmove",stop:"touchend"},ke={start:"mousedown",move:"mousemove",stop:"mouseup"},Me=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=ke,n._events=[],n._onMouseDown=function(e){var t=i.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=ke,n._onDragStart(e)},n._onMouseUp=function(e){var t=i.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=ke,n._onDragStop(e)},n._onTouchStart=function(e){var t=i.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=Le,n._onDragStart(e)},n._onTouchEnd=function(e){var t=i.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=Le,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var a=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,a),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(J.on)(document.body,n._currentEventType.move,n._onDrag,!0),Object(J.on)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var a=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=a.position;n.props.onDragChange&&n.props.onDragChange(e,a),n.setState({position:i,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var a=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,a),n.props.position&&n.setState({position:n.props.position}),n._events.forEach(function(e){return e()})}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})},t.prototype.render=function(){var e=i.Children.only(this.props.children),t=e.props,n=this.props.position,r=this.state,o=r.position,s=r.isDragging,c=o.x,d=o.y;return n&&!s&&(c=n.x,d=n.y),i.cloneElement(e,{style:Object(a.__assign)(Object(a.__assign)({},t.style),{transform:"translate(".concat(c,"px, ").concat(d,"px)")}),className:Ae(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t}(i.Component),Pe=i.createContext({window:"object"==typeof window?window:void 0});function Te(e){var t=i.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}var Ue=function(){var e=Te({});return i.useEffect(function(){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];clearTimeout(a)}}},[e]),Te({setTimeout:function(t,n){var a=setTimeout(t,n);return e[a]=1,a},clearTimeout:function(t){delete e[t],clearTimeout(t)}})},Fe={x:0,y:0},He={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},Re=Object(J.classNamesFunction)(),Ne=i.forwardRef(function(e,t){var n,r,o,s,c,d,l,u=Object(J.getPropsWithDefaults)(He,e),f=u.allowTouchBodyScroll,p=u.className,m=u.children,_=u.containerClassName,h=u.scrollableContentClassName,b=u.elementToFocusOnDismiss,g=u.firstFocusableSelector,v=u.focusTrapZoneProps,y=u.forceFocusInsideTrap,S=u.disableRestoreFocus,D=void 0===S?u.ignoreExternalFocusing:S,I=u.isBlocking,x=u.isAlert,C=u.isClickableOutsideFocusTrap,O=u.isDarkOverlay,w=u.onDismiss,A=u.layerProps,L=u.overlay,k=u.isOpen,M=u.titleAriaId,P=u.styles,T=u.subtitleAriaId,U=u.theme,F=u.topOffsetFixed,H=u.responsiveMode,R=u.onLayerDidMount,N=u.isModeless,B=u.dragOptions,j=u.onDismissed,V=u.enableAriaHiddenSiblings,z=u.popupProps,G=i.useRef(null),K=i.useRef(null),W=ve(K,null==v?void 0:v.componentRef),q=i.useRef(null),Q=ve(G,t),Y=Object(we.useResponsiveMode)(Q),X=function(e,t){var n=i.useRef(t);return n.current||(n.current=Object(E.getId)("ModalFocusTrapZone")),n.current}(0,null==v?void 0:v.id),Z=i.useContext(Pe).window,$=Ue(),ee=$.setTimeout,te=$.clearTimeout,ne=i.useState(k),ae=ne[0],ie=ne[1],re=i.useState(k),oe=re[0],se=re[1],ce=i.useState(Fe),de=ce[0],ue=ce[1],fe=i.useState(),pe=fe[0],me=fe[1],_e=function(e){var t=i.useState(!1),n=t[0],a=t[1];return[n,{setTrue:Te(function(){return function(){a(!0)}}),setFalse:Te(function(){return function(){a(!1)}}),toggle:Te(function(){return function(){a(function(e){return!e})}})}]}(),he=_e[0],be=_e[1],ge=be.toggle,ye=be.setFalse,Se=Te(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:f,scrollableContent:null,lastSetCoordinates:Fe,events:new J.EventGroup({})}}),De=(B||{}).keepInBounds,Ie=null!=x?x:I&&!N,xe=void 0===A?"":A.className,Ae=Re(P,{theme:U,className:p,containerClassName:_,scrollableContentClassName:h,isOpen:k,isVisible:oe,hasBeenOpened:Se.hasBeenOpened,modalRectangleTop:pe,topOffsetFixed:F,isModeless:N,layerClassName:xe,windowInnerHeight:null==Z?void 0:Z.innerHeight,isDefaultDragHandle:B&&!B.dragHandleSelector}),Le=Object(a.__assign)(Object(a.__assign)({eventBubblingEnabled:!1},A),{onLayerDidMount:A&&A.onLayerDidMount?A.onLayerDidMount:R,insertFirst:(null==A?void 0:A.insertFirst)||N,className:Ae.layer}),ke=i.useCallback(function(e){e?Se.allowTouchBodyScroll?Object(J.allowOverscrollOnElement)(e,Se.events):Object(J.allowScrollOnElement)(e,Se.events):Se.events.off(Se.scrollableContent),Se.scrollableContent=e},[Se]),Ne=function(){var e=q.current,t=null==e?void 0:e.getBoundingClientRect();t&&(F&&me(t.top),De&&(Se.minPosition={x:-t.left,y:-t.top},Se.maxPosition={x:t.left,y:t.top}))},Be=i.useCallback(function(e,t){var n=Se.minPosition,a=Se.maxPosition;return De&&n&&a&&(t=Math.max(n[e],t),t=Math.min(a[e],t)),t},[De,Se]),je=function(){var e;Se.lastSetCoordinates=Fe,ye(),Se.isInKeyboardMoveMode=!1,ie(!1),ue(Fe),null===(e=Se.disposeOnKeyUp)||void 0===e||e.call(Se),null==j||j()},Ve=i.useCallback(function(){ye(),Se.isInKeyboardMoveMode=!1},[Se,ye]),ze=i.useCallback(function(e,t){ue(function(e){return{x:Be("x",e.x+t.delta.x),y:Be("y",e.y+t.delta.y)}})},[Be]),Ge=i.useCallback(function(){K.current&&K.current.focus()},[]);i.useEffect(function(){var e;te(Se.onModalCloseTimer),k&&(requestAnimationFrame(function(){return ee(Ne,0)}),ie(!0),B&&(e=function(e){e.altKey&&e.ctrlKey&&e.keyCode===J.KeyCodes.space&&Object(J.elementContains)(Se.scrollableContent,e.target)&&(ge(),e.preventDefault(),e.stopPropagation())},Se.disposeOnKeyUp||(Se.events.on(Z,"keyup",e,!0),Se.disposeOnKeyUp=function(){Se.events.off(Z,"keyup",e,!0),Se.disposeOnKeyUp=void 0})),Se.hasBeenOpened=!0,se(!0)),!k&&ae&&(Se.onModalCloseTimer=ee(je,1e3*parseFloat(le)),se(!1))},[ae,k]),d=function(){Se.events.dispose()},(l=i.useRef(d)).current=d,i.useEffect(function(){return function(){var e;null===(e=l.current)||void 0===e||e.call(l)}},[]),function(e,t){i.useImperativeHandle(e.componentRef,function(){return{focus:function(){t.current&&t.current.focus()}}},[t])}(u,K);var Ke=i.createElement(J.FocusTrapZone,Object(a.__assign)({},v,{id:X,ref:q,componentRef:W,className:Object(J.css)(Ae.main,null==v?void 0:v.className),elementToFocusOnDismiss:null!==(n=null==v?void 0:v.elementToFocusOnDismiss)&&void 0!==n?n:b,isClickableOutsideFocusTrap:null!==(r=null==v?void 0:v.isClickableOutsideFocusTrap)&&void 0!==r?r:N||C||!I,disableRestoreFocus:null!==(o=null==v?void 0:v.disableRestoreFocus)&&void 0!==o?o:D,forceFocusInsideTrap:(null!==(s=null==v?void 0:v.forceFocusInsideTrap)&&void 0!==s?s:y)&&!N,firstFocusableSelector:(null==v?void 0:v.firstFocusableSelector)||g,focusPreviouslyFocusedInnerElement:null===(c=null==v?void 0:v.focusPreviouslyFocusedInnerElement)||void 0===c||c,onBlur:Se.isInKeyboardMoveMode?function(e){var t,n;null===(t=null==v?void 0:v.onBlur)||void 0===t||t.call(v,e),Se.lastSetCoordinates=Fe,Se.isInKeyboardMoveMode=!1,null===(n=Se.disposeOnKeyDown)||void 0===n||n.call(Se)}:void 0}),B&&Se.isInKeyboardMoveMode&&i.createElement("div",{className:Ae.keyboardMoveIconContainer},B.keyboardMoveIconProps?i.createElement(Ee.Icon,Object(a.__assign)({},B.keyboardMoveIconProps)):i.createElement(Ee.Icon,{iconName:"move",className:Ae.keyboardMoveIcon})),i.createElement("div",{ref:ke,className:Ae.scrollableContent,"data-is-scrollable":!0},B&&he&&i.createElement(B.menu,{items:[{key:"move",text:B.moveMenuItemText,onClick:function(){var e=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===J.KeyCodes.space)return e.preventDefault(),void e.stopPropagation();var t=e.altKey||e.keyCode===J.KeyCodes.escape;if(he&&t&&ye(),!Se.isInKeyboardMoveMode||e.keyCode!==J.KeyCodes.escape&&e.keyCode!==J.KeyCodes.enter||(Se.isInKeyboardMoveMode=!1,e.preventDefault(),e.stopPropagation()),Se.isInKeyboardMoveMode){var n=!0,a=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t}(e);switch(e.keyCode){case J.KeyCodes.escape:ue(Se.lastSetCoordinates);case J.KeyCodes.enter:Se.lastSetCoordinates=Fe;break;case J.KeyCodes.up:ue(function(e){return{x:e.x,y:Be("y",e.y-a)}});break;case J.KeyCodes.down:ue(function(e){return{x:e.x,y:Be("y",e.y+a)}});break;case J.KeyCodes.left:ue(function(e){return{x:Be("x",e.x-a),y:e.y}});break;case J.KeyCodes.right:ue(function(e){return{x:Be("x",e.x+a),y:e.y}});break;default:n=!1}n&&(e.preventDefault(),e.stopPropagation())}};Se.lastSetCoordinates=de,ye(),Se.isInKeyboardMoveMode=!0,Se.events.on(Z,"keydown",e,!0),Se.disposeOnKeyDown=function(){Se.events.off(Z,"keydown",e,!0),Se.disposeOnKeyDown=void 0}}},{key:"close",text:B.closeMenuItemText,onClick:je}],onDismiss:ye,alignTargetEdge:!0,coverTarget:!0,directionalHint:J.DirectionalHint.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:Se.scrollableContent}),m));return ae&&Y>=(H||we.ResponsiveMode.small)&&i.createElement(Ce,Object(a.__assign)({ref:Q},Le),i.createElement(Oe.Popup,Object(a.__assign)({role:Ie?"alertdialog":"dialog",ariaLabelledBy:M,ariaDescribedBy:T,onDismiss:w,shouldRestoreFocus:!D,enableAriaHiddenSiblings:V,"aria-modal":!N},z),i.createElement("div",{className:Ae.root,role:N?void 0:"document"},!N&&i.createElement(J.Overlay,Object(a.__assign)({"aria-hidden":!0,isDarkThemed:O,onClick:I?void 0:w,allowTouchBodyScroll:f},L)),B?i.createElement(Me,{handleSelector:B.dragHandleSelector||"#".concat(X),preventDragSelector:"button",onStart:Ve,onDragChange:ze,onStop:Ge,position:de},Ke):Ke)))||null});Ne.displayName="Modal";var Be,je=Object(J.styled)(Ne,function(e){var t,n=e.className,a=e.containerClassName,i=e.scrollableContentClassName,r=e.isOpen,o=e.isVisible,s=e.hasBeenOpened,c=e.modalRectangleTop,d=e.theme,l=e.topOffsetFixed,u=e.isModeless,f=e.layerClassName,p=e.isDefaultDragHandle,m=e.windowInnerHeight,_=d.palette,h=d.effects,b=d.fonts,g=Object(J.getGlobalClassNames)(ue,d);return{root:[g.root,b.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity ".concat(le)},l&&"number"==typeof c&&s&&{alignItems:"flex-start"},r&&g.isOpen,o&&{opacity:1},o&&!u&&{pointerEvents:"auto"},n],main:[g.main,{boxShadow:h.elevation64,borderRadius:h.roundedCorner2,backgroundColor:_.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:u?J.ZIndexes.Layer:void 0},u&&{pointerEvents:"auto"},l&&"number"==typeof c&&s&&{top:c},p&&{cursor:"move"},a],scrollableContent:[g.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:m},t)},i],layer:u&&[f,g.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:b.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});je.displayName="Modal";var Ve=((Be={})[we.ResponsiveMode.small]="sm",Be[we.ResponsiveMode.medium]="md",Be[we.ResponsiveMode.large]="lg",Be[we.ResponsiveMode.xLarge]="xlg",Be[we.ResponsiveMode.xxLarge]="xxlg",Be[we.ResponsiveMode.xxxLarge]="xxxlg",Be[we.ResponsiveMode.unknown]="",Be);Object(I.loadStyles)([{rawString:".frame_a755d0de{width:1080px;height:680px;max-width:100%;max-height:100%}.spinnerHost_a755d0de{position:absolute;top:0;left:0;bottom:0;right:0;display:flex;justify-content:center;align-items:center;transition:opacity linear .3s 0s,visibility linear 0s 0s;background-color:"},{theme:"bodyBackground",defaultValue:"#fff"},{rawString:"}.spinnerHost_a755d0de.loaded_a755d0de{visibility:hidden;opacity:0;transition-delay:0s,0.3s}"}]);var ze,Ge,Ke=Q.isActivated("B7BDF862-7031-4B0A-AC86-FB7D4FAB4BA6","2/24/2021","Make Picker modal once loaded"),We=Q.isActivated("8907F6FD-B9E5-47A8-B133-A450AFEBD3E6","05/13/2022","Add a loading spinner to the File Picker host"),qe=(ze=de,Ge=Object(we.withResponsiveMode)(function(e){var t,n=this,r=e.onClose,s=e.onLoad,c=e.className,d=e.responsiveMode,l=void 0===d?we.ResponsiveMode.large:d,u=Object(a.__rest)(e,["onClose","onLoad","className","responsiveMode"]),f=i.useReducer(function(e){return e+1},0)[1],p=i.useRef(),m=i.useRef(),_=o(function(e){m.current=e.error,p.current=!0,f(),s&&s(e)}),h=Ve[l],b=o(function(){return Object(a.__awaiter)(n,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return r?[4,r({error:m.current||new ee({message:"Dismissed"})})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})}),g=i.useMemo(function(){return i.createElement(ze,Object(a.__assign)({},u,{onLoad:_,onClose:r,className:Object(w.css)("frame_a755d0de",h,c)}))},[u,_,r,h,c]);return i.createElement(je,{isOpen:!0,onDismiss:!p.current||m.current||Ke?b:void 0,styles:{main:{display:"flex",borderRadius:"6px"}}},g,We?null:i.createElement("div",{className:Object(w.css)("spinnerHost_a755d0de",(t={},t.loaded_a755d0de=!!p.current,t)),role:"presentation"},i.createElement(J.Spinner,null)))}),function(e){return i.createElement(Ge,Object(a.__assign)({},e))}),Qe=n("UWqr"),Ye=function(){function e(e){var t=this;this.onPickCallback=function(e){return t._handlePick(e.items).catch(function(e){})},this.onCommandCallback=function(e){switch(e.command){case"pick-local-files":return n=e.files.map(function(e){return{src:"",file:e}}),t._props.handlePick({localFilesPickedToUpload:n,selectedItems:[]}).then(function(){return Promise.resolve({result:"success"})});case"pick":return t._handlePick(e.items).then(function(){return Promise.resolve({result:"success"})});case"close":return t._props.handleCancel().then(function(){return Promise.resolve({result:"success"})});default:return}var n},this.onNotificationCallback=function(e){"page-loaded"===e.notification&&t._props.handleLoaded()},this._props={handlePick:e.handlePick,handleLoaded:e.handleLoaded,handleCancel:e.handleCancel}}return e.prototype._handlePick=function(e){var t,n=[],a=[];return(null===(t=e[0].sharepointIds)||void 0===t?void 0:t.listItemUniqueId)?n=e.map(function(e){var t=e.sharepointIds,n=e.webUrl,a=e.webDavUrl;return{WebId:null==t?void 0:t.webId,SiteId:null==t?void 0:t.siteId,UniqueId:null==t?void 0:t.listItemUniqueId,ListId:null==t?void 0:t.listId,Link:a||n,ServerAbsoluteUrl:a||n}}):a=e.map(function(e){e.sharepointIds;var t=e.webUrl;return{src:e.webDavUrl||t,name:e.name||"",id:Qe.Guid.newGuid().toString()}}),this._props.handlePick({selectedItems:n,externalImagesPickedToUpload:a})},e}();function Je(e){return{sharePoint:{byPath:{web:e}},site:{}}}function Xe(e){return{layout:{type:e}}}function Ze(e,t){return{mode:"files",filters:t,pivots:Object(a.__assign)({},e)}}function $e(e,t){return{browseThisDevice:{enabled:e,label:"Upload"},fromALink:{enabled:t,mode:"pivot"}}}function et(e){return{site:{byPath:{web:e}}}}function tt(e,t,n,a,i){return{entry:e,telemetry:{sessionId:"8afac8ce-5062-4eb0-b605-d4b726641b46"},typesAndSources:t,list:n,commands:a,pivots:i}}var nt=n("hiL/");function at(e){var t=r.a.useMemo(function(){var t,n="".concat(e.siteUrl,"/_layouts/15/FilePicker.aspx?"),i=Object(nt.isControlHostCommunicatorForCoAuthEnabled)()?e.serviceScope.consume(nt.ControlHostCommunicatorEdit.serviceKey):void 0,r=function(){null==i||i.notifyNonDataChangingEdit()},o=new Ye(Object(a.__assign)({handleLoaded:r},e));return{pickerPageUrl:n,app:e.app,scenario:e.scenario,onPick:function(e){var t;return Object(nt.isControlHostCommunicatorForCoAuthEnabled)()&&(null==i||i.notifyNonDataChangingEditEnded()),null===(t=o.onPickCallback)||void 0===t?void 0:t.call(o,e)},onClose:function(){return null==i||i.notifyNonDataChangingEditEnded(),Promise.resolve(e.handleCancel())},onLoad:r,onCommand:o.onCommandCallback,onNotification:o.onNotificationCallback,options:e.isImagePicker?it(e.siteUrl):(t=e.siteUrl,it(t))}},[]);return r.a.createElement(r.a.Fragment,null,e.show&&r.a.createElement(qe,Object(a.__assign)({},t)))}function it(e){var t=Je(e),n=Xe("tiles"),a=Ze({stockImages:!0,bing:!0,myOrganization:!0,sharedLibraries:!1,shared:!1,site:!0},["photo"]),i=et(e);return tt(t,a,n,$e(!0,!0),i)}},sx5R:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_Popup},vNcA:function(e,t,n){var a=n("fglE");e.exports=a._Utilities}})});