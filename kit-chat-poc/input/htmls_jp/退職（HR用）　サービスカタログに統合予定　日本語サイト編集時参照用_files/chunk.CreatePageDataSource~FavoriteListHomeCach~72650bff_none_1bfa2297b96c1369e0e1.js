(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[0,30],{"7qB6":function(e,t,n){"use strict";function a(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function i(e){var t=[];t.push(a(8,e)),t.push(a(4,e));var n="4"+a(3,e);t.push(n);var i=a(4,e),r=parseInt(i[0],16);return r&=3,i=(r|=8).toString(16)+i.substr(1),t.push(i),t.push(a(12,e)),t.join("-")}function r(e,t){return void 0===t&&(t=!1),e?function(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}(e.toUpperCase(),t):""}n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r})},"8wzk":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a={};n.r(a),n.d(a,"localStorage",function(){return i}),n.d(a,"indexedDB",function(){return r}),n.d(a,"none",function(){return o});var i=0,r=1,o=2,s=a},D2s4:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"ResultTypeEnum")&&n.d(t,"ResultTypeEnum",function(){return a.ResultTypeEnum})},cNe7:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"Qos")&&n.d(t,"Qos",function(){return a.Qos}),n.o(a,"ResultTypeEnum")&&n.d(t,"ResultTypeEnum",function(){return a.ResultTypeEnum})},mxVm:function(e,t,n){"use strict";n.d(t,"e",function(){return M});var a,i=n("17wl"),r=n("8wzk"),o=n("7qB6"),s="undefined"==typeof window?self:window,c=n("cNe7");!function(e){e.success="success",e.error="error"}(a||(a={}));var d="app",l="app_lastRead",u="ODSP_DB",f="ODSP_DB_TABLE",p="lastModified",m="lastRead",_="ODSP_DB_METADATA_TABLE",h="database_metadata",b="parentKey",g="reads",v=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,a=e,r=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(r),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(r),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(r),u=r.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(r),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(r),isWindows10:!d&&r.indexOf("windows nt 10")>-1,isWindows7:!d&&r.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:a})}).isFirefox,y="indexedDB is not supported",S=function(){function e(t){if(!("indexedDB"in s)||!s.indexedDB)throw new Error(y);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,r,o,s=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,[2,new Promise(function(e,i){var r=a.transaction([f],"readwrite").objectStore(f).index(l).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return[2,this._readInternal(f,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,s,c,d,l,u,p,m,_,h,b=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n={},r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,s=a.transaction([f],"readonly"),c=s.objectStore(f),d=[],l=t.index,u=t.range,p=t.direction,m=t.count,_=c.index(l),(h=_.openKeyCursor(u,p)).onerror=function(e){b._errorHandling(e,n.reject)},h.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=m?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:f,key:t,row:Object(i.__assign)(Object(i.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:f,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(f,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=v?indexedDB.open(u,{version:4,storage:"temporary"}):indexedDB.open(u,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(f,{keyPath:"key"})).createIndex(p,p,{unique:!1}),a.createIndex(g,g,{unique:!1}),t.createObjectStore(_,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(f)).createIndex(d,d,{unique:!1}),a.createIndex(m,m,{unique:!1}),a.createIndex(l,[d,m],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(f)).createIndex("app_lastModified",[d,p],{unique:!1}),a.createIndex("app_reads",[d,g],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(f)).createIndex(b,b,{unique:!1}),a.createIndex("parentKey_app",[b,d],{unique:!1}),a.createIndex("parentKey_app_lastModified",[b,d,p],{unique:!1}),a.createIndex("parentKey_app_lastRead",[b,d,m],{unique:!1}),a.createIndex("parentKey_app_reads",[b,d,g],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(_,function(e){return e.get(h)}).then(function(t){if(t)return t.data;var n={id:o.e(),created:Date.now(),cacheType:r.e.indexedDB};return e._writeInternal({tableName:_,key:h,row:{key:h,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,r,o,s=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,[2,new Promise(function(e,i){var r=s._logger({name:"PersistentCacheIDB.readInternal"}),o=Date.now(),d=a.transaction([t],"readonly").objectStore(t),l=n(d);l.onsuccess=function(t){r({resultType:c.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-o)}}),e(l.result)},l.onerror=function(e){r({resultType:c.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-o)}}),s._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,r,o,s,c=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return r=e,(o=e._db)?[3,2]:[4,e._openDBPromise];case 1:o=i.sent(),i.label=2;case 2:return a=r._db=o,s=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(s.push(n(a.value)),a.continue()):e(s)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,s,c,d=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=t.tableName,a=t.key,r=t.row,s=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=i.sent(),i.label=2;case 2:return o=s._db=c,[2,new Promise(function(e,t){try{var i=o.transaction([n],"readwrite"),s=i.objectStore(n);i.oncomplete=function(){},i.onerror=function(e){d._errorHandling(e,t)};var c=r?s.put(r):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(i.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:b,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:f,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===a.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),D="PersistentCache",I="PersistentCache_metadata",x=function(){function e(){try{if("localStorage"in s&&s.localStorage&&(this._localStorage=s.localStorage,!this._localStorage.getItem(I))){var e={id:o.e(),created:Date.now(),cacheType:r.e.localStorage};this._localStorage.setItem(I,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(i.__assign)(Object(i.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(D)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(I)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(D,"_").concat(e)},e}(),C=0,O=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var r={execute:function(){return Object(i.__awaiter)(n,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),r.error=e,[3,4];case 3:return this._completeTask(r),[7];case 4:return[2]}})})},schedule:0,id:C++,key:e,signal:a};return r},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=s.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function w(){return s.performance&&performance.now?Math.round(performance.now()):Date.now()}var E=n("D2s4"),A="_odspcache_",L="_____",k={cacheType:r.e.indexedDB},M=function(){function e(e){var t=e.cacheType,n=void 0===t?k.cacheType:t,a=Object(i.__rest)(e,["cacheType"]);if(this._config=Object(i.__assign)(Object(i.__assign)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new O,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=this._logQos({name:"PersistentCache.read"}),s=w(),c=Date.now(),i.label=1;case 1:return i.trys.push([1,12,,13]),l=this._getCacheKey(t),u=!1,f={lastModified:NaN,lastRead:c,reads:1},p=void 0,l?(m=w(),[4,this._storage.read(l)]):[3,11];case 2:return d=i.sent(),o=Math.round(w()-m),d?(_=d.data,f={lastModified:d.lastModified,lastRead:c,reads:d.reads+1},(a=e._buffer[l])&&a.cacheStats.lastModified===d.lastModified?(a.app=d.app||this._app,a.key={original:t,encoded:d.key||l},a.cacheStats.lastRead=c,a.cacheStats.reads++,a.performance={total:Math.round(w()-s)},[3,11]):[3,3]):[3,11];case 3:if(a=void 0,void 0===_)return[3,11];if(!this._dataIsEncrypted)return[3,10];h=_,b=this._cacheSecret,g=b.CurrentKey.Key,v=b.PreviousKey.Key,y=w(),i.label=4;case 4:return i.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:g})];case 5:return p=i.sent(),[3,9];case 6:return(S=i.sent())&&S.message&&S.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:v})]:[3,8];case 7:p=i.sent(),u=void 0!==p,n({resultType:E.ResultTypeEnum.ExpectedFailure,error:S.message,extraData:{cacheResult:"hit"}}),i.label=8;case 8:return[3,9];case 9:return r=Math.round(w()-y),[3,11];case 10:p=_,i.label=11;case 11:return a=a||{key:{original:t,encoded:d&&d.key||l},app:d&&d.app||this._app,data:p,cacheStats:f,cacheType:this._cacheType,performance:{crypto:r,io:o,total:Math.round(w()-s)}},e._buffer[l]=a,u&&this.update(t,p),[3,13];case 12:throw D=i.sent(),n({resultType:E.ResultTypeEnum.Failure,error:D.message?D.message:D.toString(),extraData:{cacheResult:"miss"}}),D;case 13:return n({resultType:E.ResultTypeEnum.Success,extraData:{cacheResult:"".concat(void 0!==a.data?"hit":"miss")}}),[2,Promise.resolve(a)]}})})},e.prototype.rangeQuery=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,a,o,s,c,d,l=this;return Object(i.__generator)(this,function(i){if(this._cacheType!==r.e.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=w(),o=Date.now(),c={lastModified:NaN,lastRead:o,reads:1};try{d=w(),s=this._storage.rangeQuery(e).then(function(e){return n=Math.round(w()-d),{key:void 0,app:void 0,data:e.map(function(e){return{original:l._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:c,cacheType:l._cacheType,performance:{io:n,total:Math.round(w()-a)}}})}catch(e){throw t({resultType:E.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:E.ResultTypeEnum.Success}),[2,s||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:c,cacheType:this._cacheType,performance:{io:n,total:Math.round(w()-a)}})]})})},e.prototype.update=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return a._doCacheUpdate(e,t)}).signal.promise];case 1:return i.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,o,s,c,d,l=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=w(),a=Date.now(),o=this._logQos({name:"PersistentCache.readAndUpdate"}),s=t().then(function(t){var i={app:l._app,key:{original:e,encoded:l._getCacheKey(e)},data:t,cacheType:r.e.none,cacheStats:{lastModified:void 0,lastRead:a,reads:1},performance:{total:Math.round(w()-n)}};return l.update(e,t),i}),i.label=1;case 1:i.trys.push([1,8,,9]),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,Promise.race([this.read(e),s])];case 3:return c=i.sent(),[3,5];case 4:return i.sent(),[3,5];case 5:return!c||c.cacheType!==r.e.none&&void 0===c.data?[4,s]:[3,7];case 6:c=i.sent(),i.label=7;case 7:return[3,9];case 8:throw d=i.sent(),o({resultType:E.ResultTypeEnum.Failure,error:d.message?d.message:d.toString()}),d;case 9:return o({resultType:E.ResultTypeEnum.Success}),[2,c]}})})},e.prototype._initLocalStorage=function(e){switch(e){case r.e.localStorage:this._storage=new x;break;case r.e.indexedDB:default:try{this._storage=new S(this._logQos.bind(this))}catch(e){e.message===y&&(this._storage=new x,this._cacheType=r.e.localStorage)}}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?L+e.user:""));return"".concat(A).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(A,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(L)>=0){var i=a.split(L);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,o,s,c,d,l,u;return Object(i.__generator)(this,function(f){switch(f.label){case 0:a=this._logQos({name:"PersistentCache.update"}),f.label=1;case 1:return f.trys.push([1,9,,10]),o=this._getCacheKey(t),void 0===n?[3,6]:((s=e._buffer[o]=Object(i.__assign)(Object(i.__assign)({},e._buffer[o]),{data:n,cacheType:this._cacheType})).cacheStats||(s.cacheStats={lastModified:NaN,lastRead:w(),reads:1}),c=n,d=NaN,this._dataIsEncrypted?(l=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:l,data:n,doSerialize:this._cacheType===r.e.localStorage})]):[3,3]);case 2:return c=f.sent(),d=c.cipherText?c.cipherText.byteLength:0,[3,4];case 3:try{d="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}f.label=4;case 4:return[4,this._storage.write({app:this._app,key:o,data:c,lastRead:s.cacheStats.lastRead,parentKey:t.parentKey,reads:s.cacheStats.reads,size:d})];case 5:return f.sent(),[3,8];case 6:return delete e._buffer[o],[4,this._storage.write({key:o,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:f.sent(),f.label=8;case 8:return[3,10];case 9:throw u=f.sent(),a({resultType:E.ResultTypeEnum.Failure,error:u.message?u.message:u.toString()}),u;case 10:return a({resultType:E.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(i.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(i.__awaiter)(e,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}()}}]);