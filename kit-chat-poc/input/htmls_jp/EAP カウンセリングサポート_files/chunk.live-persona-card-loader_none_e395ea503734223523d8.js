(window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee||[]).push([[6],{"+Dm3":function(e,t,n){"use strict";n.r(t),n.d(t,"bootstrap",function(){return T});var a=n("17wl"),i=n("X+PM"),r=n("cDcd"),o=n("jOlS");Object(o.loadStyles)([{rawString:".livePersonaCardAdapterRoot{display:inline-block}"}]);var s,c=n("9FFT"),d=n("K9kD"),l=["us_2_","us_86_","us_96_","us_105_","us_265_","us_266_","us_267_","us_268_","us_269_","us_270_"];!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(s||(s={}));var u,f=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new d.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:d.ResultTypeEnum.Success}),e},function(e){return n.end({resultType:d.ResultTypeEnum.Failure}),d.Promise.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new d.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:d.ResultTypeEnum.Success}),e},function(e){return n.end({resultType:d.ResultTypeEnum.Failure}),d.Promise.reject(e)})},e}(),p=n("dq6a"),m=function(){function e(){}return e.tokenCacheSessionStorageId="tokenCache",e.aboutToExpireIntervalSeconds=600,e.apiUrl="/_api/SP.OAuth.Token/Acquire",e.retries=3,e.retriableErrorCodes=[10006,10008],e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>",e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format",e.npmPackageVersion="0.1.5",e}();!function(e){e[e.unknownError=0]="unknownError",e[e.malformedResponseBody=1]="malformedResponseBody",e[e.serverError=2]="serverError"}(u||(u={}));var _=function(e){function t(n,a){var i=e.call(this,a.message)||this;return i.__proto__=t.prototype,i._type=n,i._httpResponseStatus=a.httpResponseStatus,i._cultureName=a.cultureName,i._message=a.message,i._serverErrorCode=a.serverErrorCode,i._correlationId=a.correlationId,i._redirectUrl=a.redirectUrl,i}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==u.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!1,configurable:!0}),t}(Error),h=function(){function e(e){var t=this;this._context=e,this._dispose=this._dispose.bind(this),window.addEventListener("unload",this._dispose),window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()},window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}return e._getCorrelationId=function(e){return e.headers.get("sprequestguid")},e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e},e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})},e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var a=this._getCachedTokenData(e);if(a&&!this._isExpiring(a)){var i={token:a.accessToken,isGuest:!1,expirationTimeMs:a.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:a.correlationId,spRequestTimestamp:a.requestTimestamp})}return this._retriableFetchWithDigest(e,m.retries,t).then(function(t){return n._storeTokenData(e,t),{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})},e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)},Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){return this._keysToDispose||(this._keysToDispose=new Array),this._keysToDispose},enumerable:!1,configurable:!0}),e.prototype._retriableFetchWithDigest=function(t,n,a){var i=this,r=this._context.qosMonitor(),o=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,a)).then(function(s){if(200!==s.status){i._context.logger.logError("fetchWithDigest failed. Server responded with "+s.statusText);var c=new _(u.unknownError,{httpResponseStatus:s.status,message:s.statusText,correlationId:e._getCorrelationId(s)});return 400!==s.status?(r.writeUnexpectedFailure("UnknownError",c),Promise.reject(c)):s.json().then(function(o){var s=e._extractRealError(o),c=i._getErrorCodeFromResponseCode(s);if(!i._isRetriableError(c)||0===n){var d=i._buildErrorFromResponse(s);return r.writeUnexpectedFailure("SharepointServerError",d),Promise.reject(d)}return i._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n),i._retriableFetchWithDigest(t,n-1,a)})}return i._instrumentedParseResponseData(s,r,o)})},e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))},e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))},e.prototype._getCacheKey=function(e){var t=["sp-client-shared",m.npmPackageVersion,"OAuthUtility",e].join(";");return-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t),t},e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<m.aboutToExpireIntervalSeconds},e.prototype._isRetriableError=function(e){return-1!==m.retriableErrorCodes.indexOf(e)},e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8"),n.append("Odata-Version","4.0"),n.append("Accept","application/json;odata.metadata=minimal");var a={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;return i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1)),new Request(i+m.apiUrl,a)},e.prototype._buildRequestBody=function(e){return{resource:e}},e.prototype._buildErrorFromResponse=function(e){var t,n,a=this._getErrorCodeFromResponseCode(e);if(void 0===a)return new _(u.malformedResponseBody,{httpResponseStatus:400,message:m.unexpectedErrorCodeFormat,correlationId:e.correlationId});e.message&&("string"==typeof e.message?t=e.message:(t=e.message.value,n=e.message.lang));var i="error.redirectUrl";return new _(u.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:a,correlationId:e.correlationId,redirectUrl:e[i]||e["@".concat(i)]})},e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var a=t.indexOf(",");-1!==a&&(n=Number(t.substr(0,a)))}return n},e.prototype._instrumentedParseResponseData=function(t,n,a){try{return t.json().then(function(i){return n.writeSuccess(),{accessToken:i.access_token,expiresOn:Number(i.expires_on),notBefore:Number(i.not_before),resource:i.resource,tokenType:i.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:a}})}catch(a){return n.writeUnexpectedFailure("ResponseParseError",a),Promise.reject(new _(u.malformedResponseBody,{httpResponseStatus:200,message:m.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}},e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var a=n[t];window.sessionStorage.removeItem(a)}},e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e),window._spMSBT=void 0}},e}(),b=n("3HEj"),g=function(){function e(){this._qos=new d.Qos({name:"OAuthTokenDataSource"})}return e.prototype.writeSuccess=function(){this._qos.end({resultType:d.ResultTypeEnum.Success})},e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:d.ResultTypeEnum.Failure,error:JSON.stringify(t)})},e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:d.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})},e}(),v=function(){function e(){}return e.prototype.logWarning=function(e){},e.prototype.logError=function(e){},e}(),y=function(e){function t(t,n){var a=e.call(this,{},{pageContext:t})||this;return a.logger=new v,n&&(n.logger&&(a.logger=n.logger),n.useAbsoluteUrlForOAuth&&(a._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)),a._oAuthUtility=new h(a),a}return Object(a.__extends)(t,e),t.prototype.qosMonitor=function(){return new g},Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(b.e)(this._pageContext)},enumerable:!1,configurable:!0}),t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var a=e.headers.get("Content-Type");return e.headers.delete("Content-Type"),t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),a,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})},t.prototype.getToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))},t.prototype.getInstrumentedToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))},t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};return t.forEach(function(e,t){n[t]=e}),n},t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t.prototype._es6PromiseToOdspPromise=function(e){return new d.Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t}(p.e),S=function(e){function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;return n._oAuthTokenProvider=new f(null,{oAuthTokenDataSource:new y(t)}),n}return Object(a.__extends)(t,e),t.prototype.getRegion=function(){var e=new d.Qos({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n)return e.end({resultType:d.ResultTypeEnum.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"}),"";var a=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[a]}catch(t){return e.end({resultType:d.ResultTypeEnum.Failure,resultCode:"LokiGetRegionError",error:t}),""}},t.prototype.getAuthTokenGetter=function(e){return void 0===e&&(e=""),this.getAadAuthTokenGetter()},t.prototype.getAadAuthTokenGetter=function(){var e,t,n,a=this,i=this._pageContext.CorrelationId,r=(e=(t=this._pageContext.farmSettings)&&(function(e){var t=e.ExternalService_searchcloudenvironment;return"ag08"===t||"ag09"===t}(t)||"gcc"===(n=t.ExternalService_searchcloudenvironment)||"trailblazer"===n||"pathfinder"===n||"gallatin"===t.ExternalService_searchcloudenvironment)&&t.ExternalService_searchcloudurl?JSON.parse(t.ExternalService_searchcloudurl):void 0)&&e.Loki||"https://loki.delve.office.com";return function(e,t){a._oAuthTokenProvider.getInstrumentedToken(r).then(function(t){return e(t.tokenInfo.token,t.spRequestId)}).catch(function(e){var n={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};t(JSON.stringify(n),i)})}},t.prototype.getBootstrapperConfig=function(){return{culture:this._pageContext.currentUICultureName,region:this.getRegion(),clientType:"ODSP",clientCorrelationId:this._pageContext.CorrelationId,complianceEnvironment:d.Killswitch.isActivated("f513174d-96fc-46d5-ae79-ba202d3ebf91")?(e=this._pageContext,D(e)?"Blackforest":x(e)?"GccModerate":"Prod"):I(this._pageContext),getAuthToken:this.getAuthTokenGetter()};var e},t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"},t}(p.e);function D(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_1")}function I(e){switch(function(e){var t=e.webAbsoluteUrl,n=e.farmLabel,a=e.env2,i=e.farmSettings;if("o365test"===a||"onebox"===a||"edog"===a)return a;if("string"==typeof t&&t.toLowerCase().indexOf("microsoft.sharepoint-df.com")>-1)return"spdf";if(null==i?void 0:i.ExternalService_searchcloudenvironment){var r=i.ExternalService_searchcloudenvironment;return"spdf"===r?"prodbubble":r}return function(e){return Boolean(e)&&l.some(function(t){return 0===e.toLowerCase().indexOf(t)})}(n)?"gcc":a}(e)||"prod"){case"o365test":case"onebox":case"edog":case"spdf":return"Df";case"prodbubble":return"Msit";default:return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09"}}function x(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")||0===t.indexOf("us_105_")||0===t.indexOf("us_265_")||0===t.indexOf("us_266_")||0===t.indexOf("us_267_")||0===t.indexOf("us_268_")||0===t.indexOf("us_269_")||0===t.indexOf("us_270_")}var C=n("5pbq"),O=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};return i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback),{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks,clientType:i.props.lpcClientType}},i.state={isReady:!1},i.hasCalledOnReady=!1,t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})}),i}return Object(a.__extends)(t,e),t.ensureInitializeLPC=function(e){if(!e.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if((e.pageContext.isExternalGuestUser||e.pageContext.isAnonymousGuestUser)&&(t.disableLPCForNativeIdentity||!e.pageContext.isNativeFederatedUser))return Promise.reject("LPC is not enabled for guest users.");if(window.LPC&&window.LPC.getRenderer)return t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),Promise.resolve();var n=new S(e.pageContext),a=n.getAadAuthTokenGetter(),i=I(e.pageContext),r={culture:e.pageContext.currentUICultureName,region:n.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:a,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:"Msit"===i||"Df"===i?"Prod":i};return Object(c.initializeLivePersonaCardAsync)(r).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),e.onSuccess&&e.onSuccess()}).catch(function(t){e.onFailure&&e.onFailure(t)})},t._buildHostAppPersonaId=function(e,n){if(!t.disableLPCForNativeIdentity&&e&&n)return e=e.replace(/[{}]/g,""),n=n.replace(/[{}]/g,""),"".concat(e,"@").concat(n)},t.prototype.render=function(){var e=this,n=!!this.props.displayName;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var i=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:Object(a.__assign)({personaInfo:{identifiers:{HostAppPersonaId:t._buildHostAppPersonaId(this.props.organizationId,this.props.tenantId),DisplayName:this.props.displayName,Smtp:this.props.legacyEmail||this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.legacyEmail:void 0),PersonaType:this.props.personaType,TopicId:this.props.topicId,LocationId:this.props.locationId},displayName:n?this.props.displayName:void 0,personaCoinColor:n?Object(C.getPersonaInitialsColor)({text:this.props.displayName}):void 0},behavior:Object(a.__assign)(Object(a.__assign)({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&d.Engagement.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()},onCardClose:function(){e.props.loggingData&&d.Engagement.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardClose&&e.props.lpcCardBehavior.onCardClose()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return r.createElement(t.LivePersonaCardHoverTargetV2,Object(a.__assign)({},i),this.props.children)}return t.LivePersonaCardHoverTarget?(i=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({upn:this.props.legacyEmail,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&d.Engagement.logData(e.props.loggingData),e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}}),r.createElement(t.LivePersonaCardHoverTarget,Object(a.__assign)({},i),this.props.children)):r.createElement("div",{className:"livePersonaCardAdapterRoot"},this.props.children)},t.prototype.componentDidUpdate=function(){this.state.isReady&&!this.hasCalledOnReady&&this.props.onPersonaCardReady&&(this.hasCalledOnReady=!0,this.props.onPersonaCardReady())},t.LivePersonaCardHoverTarget=void 0,t.LivePersonaCardHoverTargetV2=void 0,t.disableLPCForNativeIdentity=d.Killswitch.isActivated("4447C532-D4A2-4162-9C89-56324A4F7E52","08/03/2021","enable LPC for native identity users"),t._logResult=function(e,t,n){},t}(C.BaseComponent),w=n("y88i"),E=n("2q6Q"),A=n("yHPm"),L=n("WZz6"),k=n("hiL/"),M="CSIKM.LivePersonaCard.TopicCard";function P(e){var t="data-sp-hashtagged-topic-id",n="data-sp-topic-id";document.querySelectorAll("[".concat(t,'="').concat(e,'"], [').concat(n,'="').concat(e,'"]')).forEach(function(e){var a=!!e.getAttribute(t),i=Object(C.mergeStyles)({cursor:"text","::before":a&&{content:'"#"'}});e.setAttribute("class",i),e.removeAttribute(n),e.removeAttribute(t),e.removeAttribute("role"),e.removeAttribute("tabindex"),e.removeAttribute("aria-label"),e.removeAttribute("aria-haspopup"),e.removeAttribute("data-lpc-hover-target-id"),e.removeAttribute("data-is-focusable")})}function T(e,t,n,r,o){return function(e){return new Promise(function(t){e.whenFinished(function(){return t(e.consume(i.PageContext.serviceKey))})})}(e).then(function(i){var o=new E._QosMonitor("Topic"===n?r?"".concat(M,".").concat(r):M:"WebPartShared.LivePersonaCard");return O.ensureInitializeLPC(Object(a.__assign)({pageContext:i.legacyPageContext,clientType:t,onSuccess:function(){return o.writeSuccess({initialized:!1})},onFailure:function(e){return o.writeUnexpectedFailure("InitializeFailure",new Error(e))},dataCallBacks:{getAndPrefetchPersonaImageUri:U,getTopicPageData:function(e,t){var n;t({currentPageId:{siteId:i.site.id.toString(),webId:i.web.id.toString(),uniqueId:(null===(n=i.listItem)||void 0===n?void 0:n.uniqueId)||""},feedbackClientInfo:"Topic Data Source: ODSP"},void 0)},getTopicDataAsync:function(e){var t=e.TopicId||"";if(!t)return Promise.resolve(void 0);var n=new E._QosMonitor("CSIKM.LivePersonaCard.TopicCache");return A.e.get(t,Object(k.getTopicLanguageByCulture)(i.cultureInfo.currentUICultureName)).then(function(e){return e?(n.writeSuccess(),e):A.e.get(t,i.cultureInfo.currentUICultureName).then(function(e){return e?(n.writeSuccess(),e):(n.writeExpectedFailure("NotFound"),Promise.reject(new Error("No topics found in topics cache")))})}).catch(function(e){return n.writeUnexpectedFailure("Get",e),Promise.reject(e)})},getTopicsSDK:function(){return Object(L.getTopicsSdk)(e)}},actionCallBacks:{removeTopicHighlight:P}},{options:{isTopicTestPipelineEnabled:Object(k.isEnvSPDF)(),isRelatedTopicsEnabledFromHostApp:!0}})).then(function(){o.writeSuccess({initialized:!0})}).catch(function(e){if(("string"==typeof e||e instanceof String)&&(e=new Error(e.toString())),window.LivePersonaCardHoverTargetV2)return o.writeExpectedFailure("FailureAfterInitialize",e),Promise.resolve();throw o.writeUnexpectedFailure("LPCAdapterFailure",e),e})})}function U(e,t){var n=(e.Smtp||e.Upn||"").toLowerCase();t(n?k.SPUtility.getUserPhotoUrl(n,w.SPAlternativeUrls.UserPhotoSize.Large):"")}t.default={bootstrap:T}},"3HEj":function(e,t,n){"use strict";n.d(t,"t",function(){return f}),n.d(t,"e",function(){return p});var a={};n.r(a),n.d(a,"Default",function(){return o}),n.d(a,"Tenant",function(){return s}),n.d(a,"Hub",function(){return c}),n.d(a,"Site",function(){return d});var i,r=n("K9kD"),o=0,s=1,c=2,d=3,l=r.Killswitch.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),u="undefined"!=typeof window&&r.FeatureOverrides.isFeatureEnabled({ODB:1737});function f(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl,a=e.isSiteListsHost;return"/"===n||""===n||!l&&a||u&&(null==e?void 0:e.isUnifiedAdminUrl)?t:t.substring(0,t.lastIndexOf(n))}function p(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(i||(i={}))},dq6a:function(e,t,n){"use strict";var a=n("17wl"),i=n("K9kD"),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.noRedirect,s=t.dataRequestorType,c=void 0===s?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r,noRedirect:o})||this}return Object(a.__extends)(t,e),t}(i.DataRequestor):s,d=e.dataSourceName,l=void 0===d?"DataSource":d;this.dataRequestor=new c({qosName:l})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_){void 0===i&&(i="POST");var h=e(),b=a&&a(),g=this.needsRequestDigest(h);return this.dataRequestor.getData({url:h,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:g,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_})},e}();t.e=r}}]);