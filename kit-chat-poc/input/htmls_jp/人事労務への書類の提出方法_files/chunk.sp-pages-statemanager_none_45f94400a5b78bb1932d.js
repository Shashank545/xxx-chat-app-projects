(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[136],{"67N2":function(e,t,n){"use strict";n.d(t,"o",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"s",function(){return f});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("64510c71-1542-4054-b968-77cae1542b85")}function r(){return a._SPKillSwitch.isActivated("68d190d9-c1b0-4d51-8263-cbaf1e007b3d")}function o(){return a._SPKillSwitch.isActivated("54a84d15-714a-4db3-b282-0be5a12aaa0a")}function s(){return a._SPKillSwitch.isActivated("a0ab6d80-64ed-43fc-aac3-547bcd967c2c")}function c(){return a._SPKillSwitch.isActivated("64720ed5-b688-4f87-b062-488aa5693a56")}function d(){return a._SPKillSwitch.isActivated("ffa9c69b-28a8-4bab-9474-1f82f48b4a32")}function l(){return a._SPKillSwitch.isActivated("867ad720-b3de-4ad9-958d-1b733b2a8bb7")}function u(){return a._SPKillSwitch.isActivated("cbbaa48c-cb24-4fa4-b952-f010b43da814")}function f(){return a._SPKillSwitch.isActivated("63293d3e-268d-469a-9947-6008e3fb6963")}},Fn15:function(e,t,n){"use strict";var a=n("hiL/"),i=n("jyrw"),r=function(){function e(){}return e.pageSaved=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.Saved,e._moduleName,"SPPageSetPageSaved",{SPPageStatus:a.PageSaveStatus.Saved.toString()})},e.pageDirty=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.NotSaved,e._moduleName,"SPPageSetPageDirty",{SPPageStatus:a.PageSaveStatus.NotSaved.toString()})},e.pageCheckedOut=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.UnPublished,e._moduleName,"SPPageSetPageUnPublished",{SPPageStatus:a.PageSaveStatus.UnPublished.toString()})},e._moduleName="[PageStatusStoreAction]",e}();t.e=r},IKdF:function(e,t,n){"use strict";n.r(t);var a,i=n("17wl"),r=n("UWqr"),o=n("ut3N"),s=n("y88i"),c=n("hiL/"),d=n("2q6Q"),l=n("HVbJ"),u=n("ExwJ"),f=n("0IsF"),p=n("XdGY"),m=n("q+wp"),_=n("0SGS");!function(e){e[e.None=0]="None",e[e.Save=1]="Save",e[e.SaveNew=2]="SaveNew"}(a||(a={}));var h=n("onFi"),b=n("k6KK"),g=n("lmp7"),v=n("7plR"),y=n("xs0R"),S=function(){function e(){}return e.insert=function(e,t){var n=new d._QosMonitor("PageCacheInsert");try{var a=JSON.stringify(t);window.sessionStorage.setItem(e,a),n.writeSuccess()}catch(e){n.writeUnexpectedFailure("PageCacheInsert",e)}},e.insertPage=function(e,t,n){e=this._normalize(e),this.insert("page-cache://"+e,{route:e,preloadedData:t,version:n})},e.get=function(e){var t=new d._QosMonitor("PageCacheGet");try{var n=window.sessionStorage.getItem(e),a=JSON.parse(n);return t.writeSuccess(),a}catch(e){t.writeUnexpectedFailure("PageCacheGet",e)}},e.getPage=function(e){return e=this._normalize(e),this.get("page-cache://"+e)},e.remove=function(e){var t=new d._QosMonitor("PageCacheDelete");try{window.sessionStorage.removeItem(e),t.writeSuccess()}catch(e){t.writeUnexpectedFailure("PageCacheDelete",e)}},e.removePage=function(e){e=this._normalize(e),this.remove("page-cache://"+e)},e._normalize=function(e){return m.e.relativizeUrl(m.e.removeQueryString(e.toLowerCase()))},e}(),D=n("UF/m"),I=n("Hts7"),x=n("aflJ"),C=n("M+LP"),O="HomePage",w="ClassicHomepageUrl",E="PageTemplates",A="AuthorByLineRetrievedPeopleInfo",L=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._logSource=o._LogSource.create("SPPageDataProvider"),t.savePageCoAuthAsync=function(e,n,a,i,r){var o="".concat(t._getItemEndpointUrl(e),"/SavePageCoAuth"),s=t._getCoAuthPostPayload(n,a,r,i);return t._savePage(o,s,"SavePageCoAuthAPI",new D.n("POST"),{sharedLockId:a,lockAction:i,shouldSaveAsNewVersion:r})},t.publishPageCoAuthAsync=function(e,n,a,i){var s="".concat(t._getItemEndpointUrl(e),"/PublishCoAuth"),c=t._getCoAuthPostPayload(n,a,!1,i),l=new d._QosMonitor("PublishCoAuthAPI"),u={sharedLockId:a,lockAction:i};return t._fetchJson(s,new D.n("POST"),c.toString()).then(function(e){!Object(p.dt)()&&e.spPagesApiCorrelationId&&(u.spPagesApiCorrelationId=e.spPagesApiCorrelationId),l.writeSuccess(u)}).catch(function(e){return u.spPagesApiCorrelationId=e.correlationId,y.t.mode!==r.DisplayMode.Edit?l.writeExpectedFailure("FailedAlreadySwitchedToReadMode",e,u):e.isUnknown?(l.writeUnexpectedFailure("PublishPageAPI",e,u),o._TraceLogger.logError(t._logSource,e)):t._isAuthorByLineNotFoundError(e,n)?l.writeExpectedFailure("AuthorByLineNotFound",e,u):t._handleOdataError(e,e.status,l,"PublishCoAuthAPI",u),Promise.reject(e)})},t._isAuthorByLineNotFoundError=function(e,t){var n,a;if(e.code===b.e.authorByLineNotFoundError){var i=null===(n=null==t?void 0:t.AuthorByline)||void 0===n?void 0:n[0];if(i&&(null===(a=e.message)||void 0===a?void 0:a.indexOf(i))&&sessionStorage.getItem(A)!==i)return!0}return!1},t}return Object(i.__extends)(t,e),t.convertSitePageFlagArrayToString=function(e){var t=";#";if(Array.isArray(e)&&(null==e?void 0:e.length)>0)return"".concat(t).concat(e.join(t)).concat(t)},t.prototype.getPageUrlAsync=function(e){var t=this,n="".concat(this._getItemEndpointUrl(e),"/FileName");g.t.appCacheHit=!1;var a=new d._QosMonitor("GetPageUrlAPI");return this._fetchJson(n).then(function(e){return a.writeSuccess(),e.value}).catch(function(e){return o._TraceLogger.logError(t._logSource,e),404===e.status?a.writeExpectedFailure("FailedResponseNotFound",e):403===e.status?a.writeExpectedFailure("FailedResponseForbidden",e):406===e.status?a.writeExpectedFailure("FailedResponseNotAcceptable",e):a.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.getListItemModerationStatusAsync=function(e){var t=this._webServerRelativeUrl+"/_api/web/lists(guid'".concat(this._pageContext.list.id,"')/Items(").concat(e,")?$select=OData__ModerationStatus");return this._fetchJson(t).then(function(e){if(void 0===e.OData__ModerationStatus)throw new Error("Invalid Moderation Status");return e.OData__ModerationStatus})},t.prototype.getPageTemplates=function(){var e="".concat(E,"_").concat(this._webServerRelativeUrl),t=S.get(e);if(t)return Promise.resolve(t);var n=this._restSitePagesEndPointUrl+"/templates";return this._fetchJson(n).then(function(t){var n=t.value;return S.insert(e,n),n}).catch(function(e){throw e})},t.prototype.savePageToServerAsync=function(e,t,n,a){if(!Object.keys(t).length){var i=new Error("should not save empty page content");return o._TraceLogger.logError(this._logSource,i,a),Promise.reject(i)}var r=t[u.e.PreviewImageUrl];c.ThumbnailUrlGenerator.isStockImage(r)&&(t[u.e.PreviewImageUrl]=this._defaultSitePageThumbnail);var s=this.getRequestUrl(n,e),d=new D.t(t);return o._TraceLogger.logVerbose(this._logSource,"".concat(a," (").concat(e,")")),this._savePage(s,d,a,new D.n("POST"))},t.prototype.getRequestUrl=function(e,t){var n=e?"SavePageAsDraft":"SavePage";return"".concat(this._getItemEndpointUrl(t),"/").concat(n)},t.prototype.createBlankPageAsync=function(e,n,a,i){var r=new d._QosMonitor("CreateBlankPageAPI"),o="".concat(y.t.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl).concat(Object(C.e)(1736)?"/this":""),s=new D.t({PromotedState:e||void 0,PageLayoutType:n||void 0,ContentTypeId:a||void 0,SitePageFlags:t.convertSitePageFlagArrayToString(i)});return this.createOrCopyPage(o,new D.n("POST"),s.toString(),r,"createBlankPageAsync")},t.prototype.createPageAsync=function(e,n,a,r,o,s,l){var u=new d._QosMonitor("CreatePageAPI"),f="".concat(y.t.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl).concat(Object(C.e)(1736)?"/this":""),p=v.e.instance.serviceScope.consume(c.HiddenHighlightsInfoService.serviceKey),m=new D.t(Object(i.__assign)({PromotedState:e||void 0,PageLayoutType:n||void 0,ContentTypeId:a||void 0,SitePageFlags:t.convertSitePageFlagArrayToString(r),CanvasContent1:o||void 0,Title:s||void 0,Name:l||void 0},Object(x.c)()?{HiddenHighlightsMetadata:p.getHiddenHighlightsAsString(),HideListEditorMetadata:p.getHideListEditorAsString()}:void 0));return this.createOrCopyPage(f,new D.n("POST"),m.toString(),u,"createPageAsync")},t.prototype.createTopicPageAsync=function(){var e,t=new d._QosMonitor("CreateTopicPageAPI"),n="".concat(this._restTopicsEndPointUrl).concat(Object(C.e)(1736)?"/this":""),a=y.t.fields.EntityId,r=new D.t(Object(i.__assign)(Object(i.__assign)({Title:y.t.fields.Title,EntityId:a!==c.NULL_TOPIC_ENTITY.Id?a:"",EntityType:"",EntityRelations:c.EntityRelationsService.getRelationsAsString(v.e.instance.serviceScope)},Object(l.isTopicsMultilingualV3FlightEnabled)()&&(null===(e=y.t.fields)||void 0===e?void 0:e.TranslationLanguage)&&{Language:y.t.fields.TranslationLanguage}),{LayoutWebpartsContent:_.e.serializeLayoutWebPartData(y.t.fields.LayoutWebPartsDataMap),CanvasContent1:JSON.stringify(y.t.fields.CanvasContent1),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:f.e.Topic}));return this.createOrCopyPage(n,new D.n("POST"),r.toString(),t,"createTopicPageAsync")},t.prototype.copyPage=function(e,n){var a=new d._QosMonitor("CopyPageAPI"),i=this._shouldCreateNewsCopy();i&&(v.e.instance.promoteOnPublish=!1);var r="".concat(this._getItemEndpointUrl(e),"/").concat("CopyWithConfiguration");return this.createOrCopyPage(r,new D.n("POST"),JSON.stringify({sitePageFlags:t.convertSitePageFlagArrayToString(n),isNews:i}),a,"copyPage")},t.prototype.savePageAsTemplate=function(e){if(m.e.isScribeCopyTemplateEnabled()){var t="SavePageAsTemplate",n=new d._QosMonitor("SavePageAsTemplateAPI");return this._savePageAsTemplateInternal(e,t,n)}var a="".concat(E,"_").concat(this._webServerRelativeUrl);S.remove(a),n=new d._QosMonitor("SavePageAsTemplateAPI"),t="SavePageAsTemplate";var i="".concat(this._getItemEndpointUrl(e),"/").concat(t);return this.createOrCopyPage(i,new D.n("POST"),(new D.t).toString(),n,"savePageAsTemplate")},t.prototype.savePageAsTemplateOnMySite=function(e){var t=new o._AutoAlertableQosMonitor("SavePageAsTemplateOnMySiteAPI",o._AutoAlertableMonitorType.StaticReliabilityQos95Sev4);return this._savePageAsTemplateInternal(e,"SavePageAsTemplateOnMySite",t)},t.prototype.getTemplateFolderUrl=function(){var e=Object(C.e)(1736)?"/lists('".concat(this._pageContext.list.id,"')"):"/lists/EnsureClientRenderedSitePagesLibrary",t=this._webServerRelativeUrl+"/_api".concat(e,"/GetSpecialFolderUrl"),n=new d._QosMonitor("GetTemplateFolderUrl");return this._fetchJson(t,new D.n("POST"),JSON.stringify({type:9,bForceCreate:!1})).then(function(e){return n.writeSuccess(),e.value}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingTemplateFolderUrl",e),Promise.reject(e)})},t.prototype.createOrCopyPage=function(e,n,a,i,r){var s=this;o._TraceLogger.logVerbose(this._logSource,r);var c=window._isInitiatedByPageApp?"FromPageApp":"FromRouter";return this._fetchJson(e,n,a).then(function(e){if(!e||!e.Id)throw t._getOdataRestApiError(e)||new h.e;return s._processCreateOrCopyResponse(r,i,e)}).catch(function(e){throw e instanceof h.e?403===e.status?i.writeExpectedFailure("FailedResponseForbidden",e,{pageCreationEntryPoint:c}):e.code===b.e.siteQuotaExceededException?i.writeExpectedFailure("SiteQuoteExceeded",e,{pageCreationEntryPoint:c}):i.writeUnexpectedFailure("ErrorTag",e,{pageCreationEntryPoint:c}):(i.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}),o._TraceLogger.logError(s._logSource,e,c)),e})},t.prototype.checkOutAndReloadPageAsync=function(e){var t=this,n="".concat(this._getItemEndpointUrl(e),"/checkoutpage"),a=new d._QosMonitor("CheckOutPageAPI");return o._TraceLogger.logVerbose(this._logSource,"checkOutAndReloadPageAsync"),this._fetchJson(n,new D.n("POST")).then(function(e){if(!e||!e.IsPageCheckedOutToCurrentUser)throw new h.e;var n=_.e.tryLoadFromSitePagesOdata(e);return o._TraceLogger.logVerbose(t._logSource,"checkOutAndReloadPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof h.e?(t._handleOdataError(e,e.status,a,"CheckOutPageAPI"),o._TraceLogger.logError(t._logSource,e,"CheckOutPageAPI")):(a.writeUnexpectedFailure("FailedToCheckoutPageError2",e),o._TraceLogger.logError(t._logSource,e)),e})},t.prototype.startCoAuthAsync=function(e){var t=this,n="".concat(this._getItemEndpointUrl(e),"/startCoAuth"),a=new d._QosMonitor("StartCoAuthAPI");return o._TraceLogger.logVerbose(this._logSource,"startCoAuthAsync"),this._fetchJson(n,new D.n("POST")).then(function(e){var n=e.CoAuthState,r=e.spPagesApiCorrelationId,s=Object(i.__rest)(e,["CoAuthState","spPagesApiCorrelationId"]),c=_.e.tryLoadFromSitePagesOdata(s);o._TraceLogger.logVerbose(t._logSource,"startCoAuth success");var d={coAuthState:JSON.stringify(n)};return!Object(p.dt)()&&r&&(d.spPagesApiCorrelationId=r),a.writeSuccess(d),{pageFieldData:c,sharedLockId:n.SharedLockId,isNewSession:n.IsNewSession}}).catch(function(e){var n,i={alias:null===(n=y.t.fields)||void 0===n?void 0:n.PageLayoutType,spPagesApiCorrelationId:e.correlationId};throw e instanceof h.e?(t._handleOdataError(e,e.status,a,"StartCoAuthAPI",i,!1),o._TraceLogger.logError(t._logSource,e,"StartCoAuthAPI")):(a.writeUnexpectedFailure("FailedToStartCoAuthError",e,i),o._TraceLogger.logError(t._logSource,e)),e})},t.prototype.publishPageAsync=function(e){var t,n=this,a="".concat(this._getItemEndpointUrl(e),"/publish"),i=new d._QosMonitor("PublishPageAPI");o._TraceLogger.logVerbose(this._logSource,"publishPageAsync");var r={alias:null===(t=y.t.fields)||void 0===t?void 0:t.PageLayoutType};return this._fetchJson(a,new D.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new h.e);i.writeSuccess(r)}).catch(function(e){return e.isUnknown?(i.writeUnexpectedFailure("PublishPageAPI",e,r),o._TraceLogger.logError(n._logSource,e)):n._handleOdataError(e,e.status,i,"PublishPageAPI",r),Promise.reject(e)})},t.prototype.schedulePageAsync=function(e){var t=this,n=new d._QosMonitor("SchedulePublishAPI"),a="".concat(this._getItemEndpointUrl(e),"/schedulepublish");return o._TraceLogger.logVerbose(this._logSource,"schedulePageAsync"),this._fetchJson(a,new D.n("POST"),JSON.stringify({})).then(function(e){return n.writeSuccess(),e.value}).catch(function(e){return"-2146232832, Microsoft.SharePoint.SPFeatureDependencyNotActivatedException"===(null==e?void 0:e.code)&&(n.writeExpectedFailure("SchedulePublishAPI",e),o._TraceLogger.logError(t._logSource,e)),e.isUnknown?(n.writeUnexpectedFailure("SchedulePublishAPI",e),o._TraceLogger.logError(t._logSource,e)):t._handleOdataError(e,e.status,n,"SchedulePublishAPI"),Promise.reject(e)})},t.prototype.discardPageAsync=function(e){var t=this,n=Object(p.cn)()?"".concat(this._getItemEndpointUrl(e),"/discardPage"):"".concat(this._getItemEndpointUrl(e),"/discardPage?$expand=VersionInfo"),a=new d._QosMonitor("DiscardPageAPI");return o._TraceLogger.logVerbose(this._logSource,"discardPageAsync"),this._fetchJson(n,new D.n("POST")).then(function(e){if(!e)throw new h.e;var n=_.e.tryLoadFromSitePagesOdata(e);return o._TraceLogger.logVerbose(t._logSource,"discardPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof h.e&&!e.isUnknown?t._handleOdataError(e,e.status,a,"DiscardPageAPI"):(a.writeUnexpectedFailure("FailedToDiscardPageError22",e),o._TraceLogger.logError(t._logSource,e)),e})},t.prototype.promotePageToNewsAsync=function(e){var t=this,n="".concat(this._getItemEndpointUrl(e),"/PromoteToNews"),a=new d._QosMonitor("PromotePageToNewsAPI");return o._TraceLogger.logVerbose(this._logSource,"promotePageToNewsAsync"),this._fetchJson(n,new D.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new h.e);a.writeSuccess()}).catch(function(e){return e.isUnknown?(o._TraceLogger.logError(t._logSource,e,"PromotePageToNewsAPI"),a.writeUnexpectedFailure("PromotePageToNewsAPI",e)):t._handleOdataError(e,e.status,a,"PromotePageToNewsAPI"),Promise.reject(e)})},t.prototype.checkInFileAsync=function(e,t){var n=this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('".concat(this._pageContext.list.serverRelativeUrl+"/"+t,"')/checkin(").concat(e,")"),a=new d._QosMonitor("CheckinFileAPI");return this._fetchJson(n,new D.n("POST"),JSON.stringify({})).then(function(){return a.writeSuccess()}).catch(function(e){return a.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getFileEtagAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForEtag,this._pageServerRelativeUrl),t=new d._QosMonitor("GetFileEtagAPI");return this._fetchJson(e).then(function(e){if(!e.ETag)throw new h.e;return t.writeSuccess(),e.ETag}).catch(function(e){throw t.writeUnexpectedFailure("FailedGettingFileEtag",e),e})},t.prototype.getFileCheckinCommentsAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForCheckInComments,this._pageServerRelativeUrl),t=new d._QosMonitor("GetFileCheckInComments");return this._fetchJson(e).then(function(e){return t.writeSuccess(),e.CheckInComment}).catch(function(e){return t.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getHighlightsInfo=function(e){var t="".concat(this._getItemEndpointUrl(e),"/GetHighlightsInfo"),n=new d._QosMonitor("GetHighlightsInfo");return this._fetchJson(t,new D.n("POST")).then(function(e){return n.writeSuccess(),e}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingHighlightsInfo",e),Promise.reject(e)})},t.prototype.getUserById=function(e){var t=this._webServerRelativeUrl+"/_api/web/GetUserById(".concat(e,")"),n=new d._QosMonitor("GetUserById");return this._fetchJson(t).then(function(t){return n.writeSuccess(),{id:e,email:t.Email,name:t.Title}}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getPagePublishStartDate=function(e){var t="".concat(this._getItemEndpointUrl(e),"?$select=PublishStartDate"),n=new d._QosMonitor("GetPublishStartDate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.PublishStartDate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getListMetadataAsync=function(){var e=Object(C.e)(1736)?"/lists('".concat(this._pageContext.list.id,"')"):"/lists/EnsureClientRenderedSitePagesLibrary",t=this._webServerRelativeUrl+"/_api".concat(e,"?$select=EnableModeration,EnableMinorVersions,Id,DraftVersionVisibility"),n=new d._QosMonitor("GetListMetadataAPI");return this._fetchJson(t,new D.n("POST"),JSON.stringify({})).then(function(e){return n.writeSuccess(),{DraftVersionVisibility:e.DraftVersionVisibility,EnableMinorVersions:e.EnableMinorVersions,EnableModeration:e.EnableModeration,Id:e.Id}}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingModerationStatus",e),Promise.reject(e)})},t.prototype.getIsTemplate=function(e){var t="".concat(this._getItemEndpointUrl(e),"?$select=IsTemplate"),n=new d._QosMonitor("GetIsTemplate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.IsTemplate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingFileEtag",e),Promise.reject(e)})},t.prototype.setListItemModerationStatus=function(e,t,n,a){var i=this._webServerRelativeUrl+"/_api/SP.APIHubConnector.SetApprovalStatus",r=new d._QosMonitor("SetModerationStatusAPI"),o={action:n,comments:t,etag:a,itemId:e.toString(),listName:this._pageContext.list?this._pageContext.list.id.toString():"Site Pages"};return this._fetchJson(i,new D.n("POST"),JSON.stringify(o)).then(function(){return r.writeSuccess()}).catch(function(e){return r.writeUnexpectedFailure("FailedSettingModerationStatusAPI",e),Promise.reject(e)})},t.prototype.getDashboardPersonalizationFlag=function(){var e=this._webServerRelativeUrl+"/_api/EE/GetDashboardPersonalization",t=new d._QosMonitor("GetDashboardPersonalizationFlagAPI");return this._fetchJson(e,new D.n("GET")).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedSettingModerationStatusAPI",e),Promise.reject(e)})},t.prototype.setDashboardPersonalizationFlag=function(e){var t=this._webServerRelativeUrl+"/_api/EE/SetDashboardPersonalization",n=new d._QosMonitor("SetDashboardPersonalizationFlagAPI"),a={isEnabled:e};return this._fetchJson(t,new D.n("POST"),JSON.stringify(a)).then(function(){return n.writeSuccess()}).catch(function(e){return n.writeUnexpectedFailure("FailedSettingModerationStatusAPI",e),Promise.reject(e)})},t.prototype.getClassicHomepageUrlAsync=function(){var e=this,t=S.get("".concat(w,"_").concat(this._webServerRelativeUrl));if(t)return o._TraceLogger.logVerbose(this._logSource,"get classic homepage url from cache"),Promise.resolve(t);var n=s.Uri.concatenate(this._webServerRelativeUrl,"_api/Web?$select=ClassicWelcomePage,IsRevertHomepageLinkHidden"),a=new d._QosMonitor("GetClassicHomepageUrl");return this._fetchJson(n).then(function(t){var n=t.ClassicWelcomePage,i=t.IsRevertHomepageLinkHidden?"":n;return o._TraceLogger.logVerbose(e._logSource,"getClassicHomepageUrlAsync success"),a.writeSuccess(),S.insert("".concat(w,"_").concat(e._webServerRelativeUrl),i),i}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetClassicHomepageUrl",t),""):(a.writeUnexpectedFailure("GetClassicHomepageUrl",t),o._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.removeClassicHomepageUrl=function(){var e=this,t=this._webServerRelativeUrl+"/_api/Web",n=new d._QosMonitor("RemoveClassicHomepageUrl");return this._fetchJson(t,new D.n("PATCH"),JSON.stringify({__metadata:{type:"SP.Web"},IsRevertHomepageLinkHidden:!0})).then(function(){n.writeSuccess(),S.remove("".concat(w,"_").concat(e._webServerRelativeUrl))}).catch(function(e){return n.writeUnexpectedFailure("RemoveClassicHomepageUrl",e),Promise.reject(e)})},t.prototype.getHomePageUrlAsync=function(){var e=this,t=S.get("".concat(O,"_").concat(this._webServerRelativeUrl));if(t)return o._TraceLogger.logVerbose(this._logSource,"get home page url from cache"),Promise.resolve(t);var n=s.Uri.concatenate(this._webServerRelativeUrl,"_api/web/rootfolder?$select=welcomepage"),a=new d._QosMonitor("GetHomePageUrl");return this._fetchJson(n).then(function(t){var n=s.Uri.concatenate(e._webServerRelativeUrl,t.WelcomePage);return o._TraceLogger.logVerbose(e._logSource,"getHomePageUrlAsync success"),a.writeSuccess(),S.insert("".concat(O,"_").concat(e._webServerRelativeUrl),n),n}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetHomePageUrl",t),""):(a.writeUnexpectedFailure("GetHomePageUrl",t),o._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.getLastPageVersionInfoAsync=function(e){var t,n=this,a="".concat(this._getItemEndpointUrl(e),"/GetLatestVersionsInDescendingOrder(1)"),i=new d._QosMonitor("VersionInfoPageAPI");return o._TraceLogger.logVerbose(this._logSource,"getLastPageVersionInfoAsync"),this._fetchJson(a,new D.n("GET")).then(function(e){if(!(null==e?void 0:e.value))throw new h.e("Data for getLastPageVersionInfoAsync is undefined");if(0===e.value.length)throw new h.e("Data.Value.Length returned 0 versions");if(e.value.length>2)throw new h.e("Data.Value.Length returned versions ".concat(e.value.length," is greater than ").concat(2));return t={LastVersionCreated:e.value[e.value.length-1].Created,LastVersionCreatedBy:e.value[e.value.length-1].CreatedBy},i.writeSuccess(),t}).catch(function(e){throw e instanceof h.e?e.isUnknown?(i.writeUnexpectedFailure("FailedResponseStatus",e),o._TraceLogger.logError(n._logSource,e,"LastVersionInfoPageAPI")):n._handleOdataError(e,e.status,i,"LastVersionInfoPageAPI"):(i.writeUnexpectedFailure("FailedToGetLastPageVersion",e),o._TraceLogger.logError(n._logSource,e,"LastVersionInfoPageAPI")),e})},t.prototype.getPreviousPageVersionInfoAsync=function(e){var t=this,n="".concat(this._getItemEndpointUrl(e),"/VersionInfo"),a=new d._QosMonitor("VersionInfoPageAPI");return o._TraceLogger.logVerbose(this._logSource,"getPreviousPageVersionInfoAsync"),this._fetchJson(n,new D.n("POST")).then(function(e){if(!e)throw new h.e;return a.writeSuccess(),e}).catch(function(e){throw e instanceof h.e?e.isUnknown?(a.writeUnexpectedFailure("FailedResponseStatus",e),o._TraceLogger.logError(t._logSource,e,"VersionInfoPageAPI")):t._handleOdataError(e,e.status,a,"VersionInfoPageAPI"):(a.writeUnexpectedFailure("FailedToGetPageVersion",e),o._TraceLogger.logError(t._logSource,e)),e})},t.prototype.deletePageAsync=function(){var e=this,t=new d._QosMonitor("DeletePageAPI"),n=s.Uri.concatenate(this._webServerRelativeUrl,"/_api/web/lists(guid'".concat(this._pageContext.list.id,"')/Items(").concat(y.t.fields.Id||m.e.spPageContextInfo.pageItemId,")/recycle"));return this._fetchJson(n,new D.n("POST")).then(function(e){if(!(null==e?void 0:e.value))throw new h.e;t.writeSuccess()}).catch(function(n){throw n instanceof h.e?n.isUnknown?(t.writeUnexpectedFailure("FailedResponseStatus",n),o._TraceLogger.logError(e._logSource,n,"DeletePageAPI")):e._handleOdataError(n,n.status,t,"DeletePageAPI"):(t.writeUnexpectedFailure("FailedToDeletePage",n),o._TraceLogger.logError(e._logSource,n)),n})},t.prototype.addPageToQuickLaunchAsync=function(e,t){var n=this,a="".concat(this._webServerRelativeUrl,"/_api/web/navigation/QuickLaunch"),i=new d._QosMonitor("AddPageToQuickLaunchAPI"),r=new D.t({__metadata:{type:"SP.NavigationNode"},IsExternal:!0,Title:e,Url:t});return this._fetchJson(a,new D.n("POST"),r.toString()).then(function(e){return i.writeSuccess(),o._TraceLogger.logVerbose(n._logSource,"addPageToQuickLaunchAsync success"),{key:e.Id.toString(),name:e.Title,url:e.Url,target:m.e.isRelativeUrl(e.Url)?"_self":"_blank"}}).catch(function(e){return i.writeUnexpectedFailure("FailedResponseStatus",e),e instanceof h.e?o._TraceLogger.logError(n._logSource,e,"AddPageToQuickLaunchAPI"):o._TraceLogger.logError(n._logSource,e),Promise.reject(e)})},t.prototype.getClassicPubNavProviderTypeAsync=function(e){var t=new d._QosMonitor("GetClassicPublishingNavProviderAPI"),n="".concat(this._webServerRelativeUrl,"/_api/navigation/GetPublishingNavigationProviderType?mapProviderName=%27");return n+=e,n+="%27",this._fetchJson(n).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.ensureTitleResourceAsync=function(){var e=this,t="".concat(this._restSitePagesEndPointUrl,"/EnsureTitleResource");return this._fetchJson(t,new D.n("POST"),JSON.stringify({})).then(function(){}).catch(function(t){throw o._TraceLogger.logError(e._logSource,t),t})},t.prototype.getVersion=function(e,t){var n="".concat(this._getItemEndpointUrl(e),"/getversion(").concat(t,")"),a=new d._QosMonitor("GetVersionAPI");return this._fetchJson(n).then(function(e){if(!e)throw new h.e;var t=_.e.tryLoadFromSitePagesOdata(e);return a.writeSuccess(),t}).catch(function(e){throw a.writeUnexpectedFailure("FailedGetVersion",e),e})},t.prototype.getDashboardPage=function(){var e=this._restSitePagesEndPointUrl+"?$filter=PageLayoutType eq '".concat(f.e.Dashboard,"'&$top=1&$select=FileName"),t=new d._QosMonitor("GetDashboardPage");return this._fetchJson(e).then(function(e){return e&&e.value&&e.value.length>0?(t.writeSuccess({exist:!0}),e.value[0].FileName):void t.writeSuccess({exist:!1})}).catch(function(e){t.writeUnexpectedFailure(e)})},t.prototype._savePage=function(e,t,n,a,s){var c,l=this;void 0===s&&(s={});var u=new d._QosMonitor(n);return s=Object(i.__assign)({alias:null===(c=y.t.fields)||void 0===c?void 0:c.PageLayoutType},s),this._fetchJson(e,a,t.toString(),this._isSaveSuccessful).then(function(e){return!Object(p.dt)()&&e.spPagesApiCorrelationId&&(s.spPagesApiCorrelationId=e.spPagesApiCorrelationId),u.writeSuccess(s),o._TraceLogger.logVerbose(l._logSource,n+"success"),e.value}).catch(function(e){return y.t.mode!==r.DisplayMode.Edit?u.writeExpectedFailure("FailedAlreadySwitchedToReadMode",e,s):e instanceof h.e?e.isUnknown?(u.writeUnexpectedFailure("FailedResponseUnknown",e,s),o._TraceLogger.logError(l._logSource,e,n)):l._isAuthorByLineNotFoundError(e,t)?u.writeExpectedFailure("AuthorByLineNotFound",e,s):l._handleOdataError(e,e.status,u,n,s):(u.writeUnexpectedFailure("FailedToSavePageError2",e,s),o._TraceLogger.logError(l._logSource,e)),Promise.reject(e)})},t.prototype._processCreateOrCopyResponse=function(e,t,n){o._TraceLogger.logVerbose(this._logSource,"".concat(e," (").concat(n.Id,")"));var a="copyPage"===e||"savePageAsTemplate"===e;a&&!Object(p.xt)()&&(n.CopySourcePageRteContentVersion=y.t.rtePageSettings.contentVersion||c.RteContentVersion.CK4);var i=_.e.tryLoadFromSitePagesOdata(n),r=Object(c.isUserPreferredSpacingEnabled)()?1:0;return o._TraceLogger.logVerbose(this._logSource,"setGlobalRichTextStylingVersion to ".concat(r," in _processCreateOrCopyResponse")),I.e.setGlobalRichTextStylingVersion(r),!Object(c.shouldNewPageGetCK5Enabled)()||!Object(p.be)()&&a||(o._TraceLogger.logVerbose(this._logSource,"set contentVersion to ".concat(c.RteContentVersion.CK5," in _processCreateOrCopyResponse")),I.e.setRtePageSettings({contentVersion:c.RteContentVersion.CK5})),m.e.updatePageContextItemId(n.Id),t.writeSuccess(),i},t.prototype._shouldCreateNewsCopy=function(){return v.e.instance.promoteOnPublish},t.prototype._savePageAsTemplateInternal=function(e,t,n){var a="".concat(E,"_").concat(this._webServerRelativeUrl);S.remove(a);var i="".concat(this._getItemEndpointUrl(e),"/").concat(t);return this.createOrCopyPage(i,new D.n("POST"),(new D.t).toString(),n,t)},t.prototype._getCoAuthPostPayload=function(e,t,n,r){var o=e[u.e.PreviewImageUrl];return c.ThumbnailUrlGenerator.isStockImage(o)&&(e[u.e.PreviewImageUrl]=this._defaultSitePageThumbnail),new D.t(Object(i.__assign)(Object(i.__assign)({},e),{CoAuthState:Object(i.__assign)({SharedLockId:t,Action:n?a.SaveNew:a.Save,LockAction:r.type},1===r.type&&r.expirationTimeInMs?{LockDuration:r.expirationTimeInMs}:{})}))},t}(D.e);t.default=L},"UF/m":function(e,t,n){"use strict";n.d(t,"n",function(){return h}),n.d(t,"t",function(){return b}),n.d(t,"e",function(){return g});var a=n("UWqr"),i=n("ut3N"),r=n("vlQI"),o=n("Pk8u"),s=n("y88i"),c=n("EMa1"),d=n("XdGY"),l=n("q+wp"),u=n("bwg3"),f=n("onFi"),p=n("k6KK"),m=n("xs0R"),_=n("M+LP"),h=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},b=function(){function e(e){var t;t=m.t.isSpace?"SP.Publishing.SitePage3D":l.e.isNewTopicPage()?"SP.Publishing.TopicSitePage":"SP.Publishing.SitePage",this.__metadata={type:t},e&&Object(o.assign)(this,e)}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),g=function(){function e(t,n){this._pageContext=t,this._spHttpClient=n,this._spHttpClientFetch=this._spHttpClient.fetch.bind(this._spHttpClient),this._spHttpClientGet=this._spHttpClient.get.bind(this._spHttpClient),this._spHttpClientPost=this._spHttpClient.post.bind(this._spHttpClient),this._isResponseSuccessful=l.e.isResponseSuccessful.bind(l.e),this._isSaveSuccessful=e._isSaveResponseSuccessful}return e._getOdataRestApiError=function(e,t,n){void 0===t&&(t=500);var a=e["odata.error"],i=n&&n.message||"unknown",r=null==n?void 0:n.correlationId;return a&&a.message?new f.e("Inner-Message: ".concat(a.message.value," Exception-Message: ").concat(i),t,a.code,r):void 0},e._encodeAndSanitizeURIComponent=function(e){return(e=encodeURIComponent(e).replace(/'/g,"''")).replace(/[~!*()']/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},e._isSaveResponseSuccessful=function(e){return l.e.isResponseSuccessful(e)||413===e},Object.defineProperty(e.prototype,"_webServerRelativeUrl",{get:function(){return a.UrlUtilities.removeEndSlash(this._pageContext.legacyPageContext.webServerRelativeUrl)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSitePagesEndPointUrl",{get:function(){return Object(_.e)(1736)?"".concat(this._webServerRelativeUrl,"/_api/sitepages/pagesinlib('").concat(this._pageContext.list.id,"')"):this._webServerRelativeUrl+"/_api/sitepages/pages"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSpacesEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/spaces"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForEtag",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=ETag"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForCheckInComments",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=CheckInComment"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restTopicsEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/topics"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_defaultSitePageThumbnail",{get:function(){return s.Uri.concatenate("/",this._pageContext.legacyPageContext.layoutsUrl,"/images/sitepagethumbnail.png")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_pageServerRelativeUrl",{get:function(){var t="/"+e._encodeAndSanitizeURIComponent(l.e.url(!0).replace(l.e.domainUrl(),""));return l.e.doesUrlHaveFileName?t:l.e.spPageContextInfo.serverRequestPath},enumerable:!1,configurable:!0}),e.prototype._getItemEndpointUrl=function(e){return Object(_.e)(1736)?"".concat(this._restSitePagesEndPointUrl,"/getbyid(").concat(e,")"):"".concat(this._restSitePagesEndPointUrl,"(").concat(e,")")},e.prototype._fetch=function(e,t,n,a){var i=this._spHttpClientPost,o={body:n,headers:t};return t?"GET"===t["X-HTTP-Method"]&&(i=this._spHttpClientFetch):(o=void 0,i=this._spHttpClientGet),i(e,r.SPHttpClient.configurations.v1,o).catch(function(e){return Promise.reject({error:Object(d.lt)()?new f.e:new f.e(e.name+". "+e.message+". "+e.stack,-1)})}).then(function(e){if(!a(e.status)){var t=new f.e(l.e.getStatusMessage(e),e.status,void 0,e.headers.get("SPRequestGuid")||void 0);throw t.response=e,{error:t,isResponseSuccessful:!1}}return e})},e.prototype._fetchJson=function(t,n,a,i){var r,s,c;return this._fetch(t,n,!Object(d.Ue)()&&n&&"GET"===n["X-HTTP-Method"]?void 0:a||(new b).toString(),i||this._isResponseSuccessful).catch(function(e){if(!1===e.isResponseSuccessful)return r=e.error,e.error.response;throw e.error}).then(function(e){if(e.ok&&204===e.status)return e;s=e,Object(d.dt)()||(c=s.headers.get("SPRequestGuid")||void 0);var t=e.headers.get("content-type")||e.headers.get("Content-Type");return!t||t.toLowerCase().indexOf("application/json")>-1?e.json():e.text().then(function(e){throw new Error(e)})}).catch(function(e){if(s)throw new f.e(e.message,s.status,s.statusText,Object(d.dt)()?s.headers.get("SPRequestGuid")||void 0:c);throw e}).then(function(t){var n=e._getOdataRestApiError(t,r&&r.status,r)||r;if(n)throw n;return!Object(d.dt)()&&c?Object(o.merge)(t,{spPagesApiCorrelationId:c}):t})},e.prototype._handleOdataError=function(e,t,n,a,r,o){if(void 0===o&&(o=!0),e){if(r=r||{},void 0!==e.correlationId&&(r.spPagesApiCorrelationId=e.correlationId),t&&(r.spPagesApiHttpStatusCode=t),e.code&&(r.spPagesApiErrorCode=e.code),400!==t||e.message!==c.n.exceedStreamLimitationErrorMessage&&e.message!==c.n.requestMessageTooBigErrorMessage)if(409===t){var s=e;n.writeExpectedFailure("FailedResponsePageConflict",s,r)}else if(404===t){var l=new f.e("Page is not found",404);e.retriable=!1,n.writeExpectedFailure("FailedResponseNotFound",l,r)}else 406===t?n.writeExpectedFailure("FailedResponseNotAcceptable",e,r):403===t?(e.retriable=!1,n.writeExpectedFailure("FailedResponseForbidden",e,r)):Object(d.Et)()||e.code!==p.e.siteQuotaExceededException?429===t?n.writeExpectedFailure("FailedResponseTooManyRequests",e,r):n.writeUnexpectedFailure("FailedResponseStatus",e,r):n.writeExpectedFailure("FailedDueToSiteQuota",e);else n.writeUnexpectedFailure("FailedResponseExceedStreamLimitation",e,r);throw i._TraceLogger.logError(this._logSource,e,a),!Object(d.We)()&&o&&(e.message=Object(u.e)(t)),e}},e}()},dInN:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"t",function(){return c});var a=n("HVbJ"),i=n("0IsF"),r=n("xs0R"),o=n("XCkH");function s(){var e,t;return(null===(e=r.t.fields)||void 0===e?void 0:e.PageLayoutType)===i.e.Topic||(null===(t=r.t.fields)||void 0===t?void 0:t.PageLayoutType)===i.e.TopicPreview}function c(e,t,n){var i;n instanceof o.e&&(i="ApplicationError"),Object(a.logASHAError)(e,t,{errorName:i,error:n},{errorMessage:n.message})}},k6KK:function(e,t,n){"use strict";var a=function(){function e(){}return e.isDuplicateFieldValueError=function(e,t){var n,a;return(null===(n=e.code)||void 0===n?void 0:n.indexOf("Microsoft.SharePoint.SPDuplicateValuesFoundException"))>-1&&(null===(a=e.message)||void 0===a?void 0:a.indexOf(t))>-1},e.spDuplicatedEntityIdException="-2130575169, Microsoft.SharePoint.SPDuplicateValuesFoundException",e.siteQuotaExceededException="-2147023080, Microsoft.SharePoint.SPException",e.authorByLineNotFoundError="-2146232832, Microsoft.SharePoint.SPException",e}();t.e=a},pfXd:function(e,t,n){"use strict";var a=n("ut3N"),i=n("EMa1"),r=n("jyrw"),o=n("E7/L"),s=n("x05K"),c=n("xs0R"),d=n("q+wp"),l=n("sRIY"),u=n("XdGY"),f=n("xxQZ"),p=function(){function e(){}return e.setIsTemplate=function(t){r.e._dispatchAction("FIELDS_SET_TEMPLATE_STATUS",t,e._moduleName,"set page template flag")},e.setNumMissingRequiredProps=function(t){r.e._dispatchAction("FIELDS_SET_MISSING_PROPS",t,e._moduleName,"set missing required properties")},e.setCategories=function(t){r.e._dispatchAction("FIELDS_SET_CATEGORIES",t,e._moduleName,"set categories")},e.addFieldsToUpdate=function(t){e._dispatchAction("FIELDS_UPDATE",t,"SPPageFieldStoreSetFields")},e.addFieldToUpdate=function(t,n){if(!t)throw new Error("fieldName is undefined");var a={};a[t]=n,e.addFieldsToUpdate(a)},e.setPromotedState=function(t){e._dispatchAction("FIELDS_SET_PROMOTEDSTATE",t,"SPPageFieldStoreSetFields")},e.clearPrivateAuthoringFlag=function(){var t,n,a=null===(n=null===(t=c.t.fields)||void 0===t?void 0:t.PageFlags)||void 0===n?void 0:n.filter(function(e){return e&&e!==i.n.privateAuthoringFlagKey});a&&e.addFieldToUpdate("PageFlags",a)},e.setFields=function(t){e._dispatchAction("FIELDS_SET",t,"SPPageFieldStoreSetFields")},e.createNewPage=function(t,n,i,r){return r&&(t.bannerImageUrl=c.t.fields.BannerImageUrl),(t.pageFieldData?Promise.resolve(t.pageFieldData):Object(o.e)().then(function(e){return e.createNewPageStub(t,n,i,r)})).then(function(n){if(e._dispatchAction("PAGE_CREATE_STUB",n,"SPPageFieldStoreCreatePageStub"),n){if(!Object(u.pn)())if(Object(u.vt)())d.e.logUserEngagementForPageAuthoring(n,l.PageAuthoringEvents.CreatePage);else{var a=t.pageTemplateId,i=Object(f.t)(f.e,a)||a;d.e.logUserEngagementForPageAuthoring(n,r?l.PageAuthoringEvents.CreateCustomTemplate:l.PageAuthoringEvents.CreatePage,{},!0,"".concat(i).concat(t.isEmailReady?"_EmailReady":""),!0,"NewButton")}d.e.logUserEngagementForPage(n,!0,"NewButton")}}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.createNewPageDeprecated=function(t,n,i,r,s,f,p,m,_,h,b,g){return _&&(b=c.t.fields.BannerImageUrl),(i?Promise.resolve(i):Object(o.e)().then(function(e){return e.createNewPageStubDeprecated(t,n,r,s,f,p,m,_,h,b)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&(Object(u.pn)()||(Object(u.vt)()?d.e.logUserEngagementForPageAuthoring(t,l.PageAuthoringEvents.CreatePage):d.e.logUserEngagementForPageAuthoring(t,l.PageAuthoringEvents.CreatePage,{},!0,n,!0,"NewButton")),d.e.logUserEngagementForPage(t,!0,"NewButton"))}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.scheduleNewMajorVersionToServerAsync=function(){return Object(s.e)().then(function(e){return e.scheduleNewMajorVersionToServerAsync()})},e.publishNewMajorVersionToServerAsync=function(){return Object(s.e)().then(function(e){return e.publishNewMajorVersionToServerAsync()})},e.publishTopicPageMajorVersionToServerAsync=function(){return Object(s.t)().then(function(e){return e.publishTopicPageMajorVersionToServerAsync()})},e.discardPageOnServerAsync=function(){return Object(s.e)().then(function(e){return e.discardPageOnServerAsync()})},e.getPreviousPageVersionInfoAsync=function(){return Object(s.e)().then(function(e){return e.getPreviousPageVersionInfoAsync()})},e.setListItemModerationStatusAsync=function(e,t){return Object(s.e)().then(function(n){return n.setListItemModerationStatusAsync(e,t)})},e.setFileCheckInCommentsAsync=function(){return Object(s.e)().then(function(e){return e.setFileCheckInCommentsAsync()})},e.startCoAuthAsync=function(e){return void 0===e&&(e=!1),Object(s.e)().then(function(t){return t.startCoAuthAsync(e)})},e.savePageCoAuthFromServerAsync=function(e){return Object(s.e)().then(function(t){return t.savePageCoAuthFromServerAsync(e)})},e.saveAndPublishPageCoAuthFromServerAsync=function(e){return Object(s.e)().then(function(t){return t.saveAndPublishPageCoAuthFromServerAsync(e)})},e.checkOutFieldsFromServerAsync=function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),Object(s.e)().then(function(n){return n.checkOutFieldsFromServerAsync(e,t)})},e.saveDraftToServerAsync=function(){return Object(s.e)().then(function(e){return e.saveDraftToServerAsync()})},e.saveFieldsToServerAsync=function(e){return void 0===e&&(e=!1),Object(s.e)().then(function(t){return t.saveFieldsToServerAsync(e)})},e.getPageUrlFromServerAsync=function(){return Object(s.e)().then(function(e){return e.getPageUrlFromServerAsync()})},e.checkInFileAsync=function(e,t,n){return Object(s.e)().then(function(a){return a.checkInFileAsync(e,t,n)})},e.ensureValidPageTitleAsync=function(){return Object(s.e)().then(function(e){return e.ensureValidPageTitle()})},e.promotePageToNewsAsync=function(){return Object(s.e)().then(function(e){return e.promotePageToNewsAsync()})},e.cacheClientForm=function(t,n){void 0===n&&(n=!1),e._dispatchAction("FIELDS_CACHE_CLIENTFORM",{clientForm:t,forceCanvasUpdate:n},"SPPageCacheClientForm")},e.ensurePageExistsAsync=function(){return c.t.doesPageExistOnServer?(a._TraceLogger.logVerbose(e._logSource,"Page already Exists"),Promise.resolve()):(a._TraceLogger.logVerbose(e._logSource,"Page does not Exists, calling createNewPageOnServerAsync"),Object(s.e)().then(function(e){return e.createNewPageOnServerAsync()}))},e.commitTitle=function(){e._dispatchAction("FIELDS_COMMIT_TITLE",void 0,"SPPageFieldStoreCommitTitle")},e.deletePageAsync=function(){return Object(s.e)().then(function(e){return e.deletePageAsync()})},e.turnOnIsCollaborating=function(t){e._dispatchAction("FIELDS_SET_IS_COLLABORATING",t,"SPPageFieldTurnOnIsCollaborating")},e.setFocusMode=function(t){e._dispatchAction("FIELDS_SET_FOCUS_MODE_STATUS",t,"SPPageFieldSetFocusMode")},e._dispatchAction=function(t,n,a){return r.e._dispatchAction(t,n,e._moduleName,a,void 0,e._logSource)},e._moduleName="[PageFieldStoreAction]",e._logSource=a._LogSource.create("PageFieldStoreActionCreator"),e}();t.e=p},s2tg:function(e,t,n){"use strict";n.r(t);var a=n("jyrw"),i=function(){function e(){}return e.load=function(t){a.e._dispatchAction("CHROME_CONFIG_LOAD",t,e._moduleName,"SPPageConfigChrome")},e._moduleName="[ChromeConfigurationAction]",e}(),r=n("2q6Q"),o=n("7plR"),s=n("n1SJ"),c=n("LjAQ"),d=function(){function e(){}return e.addQuickLaunchNode=function(t){var n=new r._QosMonitor("SPPageNavigationUpdateQuickLaunch");try{o.e.instance.getPageDataProviderAsync().then(function(e){return e.addPageToQuickLaunchAsync(t.name,t.url)}).then(function(t){a.e._dispatchAction("QUICKLAUNCH_ADDONE",t,e._moduleName,"SPPageNavigationUpdateQuickLaunch",void 0,void 0,n)}).catch(function(e){s.e.showError(c.e,c.t,e)})}catch(e){throw n.writeUnexpectedFailure("SPPageNavigationUpdateQuickLaunch",e),e}},e._moduleName="[NavigationAction]",e}(),l=n("17wl"),u=n("pfXd"),f=n("ut3N"),p=f._LogSource.create("UndoablePageFieldStoreActionCreator"),m="[UndoablePageFieldStoreAction]",_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.undo=function(){a.e._dispatchAction("FIELDS_UNDO",{},m,"Undo",void 0,p,new f._QosMonitor("Undo"))},t.redo=function(){a.e._dispatchAction("FIELDS_REDO",{},m,"Redo",void 0,p,new f._QosMonitor("Redo"))},t.clearHistory=function(){a.e._dispatchAction("FIELDS_CLEAR_HISTORY",{},m,"ClearHistory",void 0,p,new f._QosMonitor("ClearHistory"))},t.disableUndo=function(){a.e._dispatchAction("FIELDS_DISABLE_UNDO",{},m,"DisableUndo")},t.enableUndo=function(){a.e._dispatchAction("FIELDS_ENABLE_UNDO",{},m,"EnableUndo")},t}(u.e),h=_,b=function(){function e(){}return e.loadPageLayoutMapping=function(t){a.e._dispatchAction("PAGELAYOUTMAPPING_LOAD",t,e._moduleName,"SPPageLayoutMapping",{Mapping:t.toString()})},e.addPageLayoutMapping=function(t,n){a.e._dispatchAction("PAGELAYOUTMAPPING_ADD",{key:t,pageLayout:n},e._moduleName,"SPPageAddPageLayoutMapping",{key:t})},e._moduleName="[PageFieldStoreAction]",e}(),g=n("Fn15"),v=function(){function e(){}return e.load=function(t){a.e._dispatchAction("PAGE_TEMPLATE_LOAD",t,e._moduleName,"SPPageTemplatesLoad")},e._moduleName="[PageTemplateAction]",e}(),y=function(){function e(){}return e.setListSettings=function(t){a.e._dispatchAction("SET_LIST_SETTINGS",t,e._moduleName,"set list settings")},e._moduleName="[ListActionCreator]",e}(),S=n("UWqr"),D=n("I6O9"),I=n("sSDQ"),x=n("hiL/"),C=n("sRIY"),O=n("EMa1"),w=n("ExwJ"),E=n("XdGY"),A=n("0IsF"),L=n("xxQZ"),k=n("9sBY"),M=n("q+wp"),P=n("lDgI"),T=n("bwg3"),U=n("Hts7"),F=n("xs0R"),H=n("67N2"),R="PageCreation.EmailReady",N=function(){function e(){}return e.createNewPage=function(t,n){var a=n.canvasContent1?e._extractWebPartIdsFromCanvasContent(n.canvasContent1):[];return(Object(x.isCortexEnabled)(o.e.instance.pageContext)?e._loadComponentManifests(a):Promise.resolve()).then(function(){return o.e.instance.autoSaverPromise.then(function(a){return o.e.instance.getPageDataProviderAsync().then(function(i){var r,d,l=(null===(r=n.pageFieldData)||void 0===r?void 0:r.PageLayoutType)===A.e.Topic,u=n.pageLayoutType===A.e.Space||(null===(d=n.pageFieldData)||void 0===d?void 0:d.PageLayoutType)===A.e.Space;return i.getListMetadataAsync().then(function(i){y.setListSettings(i),a.resetAutoSaveAttempts();var r=i.EnableMinorVersions?"0.1":"1.0";return e._dispatchNewPageActions(n,t,i.EnableModeration?x.SPModerationStatusType.Draft:void 0,r)}).then(function(){return n.isPreview?Promise.resolve():s.e.setDisplayModeEditAsync().then(function(){var e,t;document.title=l?k.n:null!==(e=n.previewPageFileName)&&void 0!==e?e:k.t,M.e.authorId=null===(t=M.e.preloadedData.user)||void 0===t?void 0:t.Id})}).then(function(){var e,t;if(l){var a=M.e.url(),i=M.e.appendUrlParam("isNewTopicPage","true",a);a!==i&&M.e.pushUrl(i,void 0,!0)}else if(S._SPFlight.isEnabled(943)&&u){var r=null===(e=n.pageFieldData)||void 0===e?void 0:e.Title,s=null===(t=n.pageFieldData)||void 0===t?void 0:t.Description;r&&(o.e.actions.fieldActions.addFieldToUpdate(w.e.Title,r),o.e.actions.fieldActions.commitTitle()),s&&o.e.actions.fieldActions.addFieldToUpdate(w.e.Description,s)}}).then(function(){return o.e.instance.serviceScope.whenFinished(function(){o.e.instance.serviceScope.consume(P.e.serviceKey).raiseNavigatedEvent()})}).catch(function(e){s.e.showError(Object(T.n)(e),c.C,e)})})})})},e.createNewCrossSitePage=function(e,t){return S.Validate.isNonemptyString(t.crossSiteUrl,"crossSiteUrl"),this.createNewPage(e,t)},e._dispatchNewPageActions=function(t,n,a,i){var r,c=!!t.templateFolderName;if(o.e.instance.autoSaver&&o.e.instance.autoSaver.resetAutoSaveAttempts(),!Object(E.he)()&&t.rteContentVersion!==F.t.rtePageSettings.contentVersion){var d=void 0;-1===o.e.instance.copySourceItemId?(d=Object(x.shouldNewPageGetCK5Enabled)()?x.RteContentVersion.CK5:x.RteContentVersion.CK4,f._TraceLogger.logVerbose(e._logSource,"set contentVersion to ".concat(d," in _dispatchNewPageActions for out of box template"))):(d=t.rteContentVersion||x.RteContentVersion.CK4,f._TraceLogger.logVerbose(e._logSource,"set contentVersion to ".concat(d," in _dispatchNewPageActions (new)"))),U.e.setRtePageSettings({contentVersion:d})}if(!Object(H.s)()){if(t.isEmailReady)if(f._TraceLogger.logVerbose(e._logSource,"flag page as email-ready in _dispatchNewPageActions"),Object(E.vt)())f._EngagementLogger.logEvent(R);else{var l=t.pageTemplateId,p=Object(L.t)(L.e,l)||l;f._EngagementLogger.log({name:R,extraData:(r={},r[C.PageAuthoringEventExtraData.PageTemplateId]="".concat(p,"_EmailReady"),r)})}U.e.setIsEmailReady(!!t.isEmailReady)}return u.e.createNewPage(t,a,i,t.templateFolderName).then(function(){s.e.setSaveStatus(x.PageSaveStatus.Draft);var a=Object(x.isUserPreferredSpacingEnabled)()?1:0;if(f._TraceLogger.logVerbose(e._logSource,"setGlobalRichTextStylingVersion to ".concat(a," in _dispatchNewPageActions")),U.e.setGlobalRichTextStylingVersion(a),Object(E.he)()&&Object(x.shouldNewPageGetCK5Enabled)()&&(Object(E.V)()||t.rteContentVersion!==x.RteContentVersion.CK4)&&(f._TraceLogger.logVerbose(e._logSource,"set contentVersion to ".concat(x.RteContentVersion.CK5," in _dispatchNewPageActions")),U.e.setRtePageSettings({contentVersion:x.RteContentVersion.CK5})),Object(H.s)()&&t.isEmailReady&&(f._TraceLogger.logVerbose(e._logSource,"flag page as email-ready in _dispatchNewPageActions"),f._EngagementLogger.logEvent(R),U.e.setIsEmailReady(t.isEmailReady)),u.e.setIsTemplate(c),u.e.setNumMissingRequiredProps(-1),n){var i=!Object(E.L)()&&t.templateFolderName?"SitePages/".concat(t.templateFolderName):"SitePages",r=S.UrlUtilities.removeEndSlash(o.e.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/".concat(i,"/").concat(t.isPreview?t.previewPageFileName||O.n.previewPageStubFileName:O.n.newPageStubFileName+"?Mode=Edit")+"".concat(t.source?"&source="+encodeURIComponent(t.source):"");n.push(r,{isNewPage:!0})}})},e._extractWebPartIdsFromCanvasContent=function(e){return("string"==typeof e?JSON.parse(e):e).reduce(function(e,t){return t.controlType===I.CanvasControlType.WebPartZone&&e.push({id:t.webPartId}),e},[])},e._loadComponentManifests=function(t){return t&&t.length?new D._ManifestProvider(o.e.instance.serviceScope,o.e.instance.pageContext.legacyPageContext.webAbsoluteUrl).tryGetManifests(t).then(function(e){D._ManifestStore.instance.registerManifests(e,!1)}).catch(function(n){f._TraceLogger.logError(e._logSource,new Error("Failed to load one or more manifests [".concat(t.join(),"]")))}):Promise.resolve()},e._logSource=f._LogSource.create("PageCreationActionCreator"),e}();t.default=function(){this.actions={coreActions:s.e,chromeActions:i,navActions:d,fieldActions:h,layoutMappingActions:b,statusActions:g.e,templateActions:v,listActions:y,pageCreationActions:N}}},x05K:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n("dInN");function i(){return Object(a.e)()?r():Promise.all([n.e(2),n.e(6),n.e(9),n.e(112)]).then(n.bind(null,"+Mf1")).then(function(e){return e.default})}function r(){return Promise.all([n.e(2),n.e(6),n.e(9),n.e(158)]).then(n.bind(null,"7EU/")).then(function(e){return e.default})}}}]);