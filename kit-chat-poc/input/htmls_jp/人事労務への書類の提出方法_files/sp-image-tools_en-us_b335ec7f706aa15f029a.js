define("1e49a922-5650-4595-926f-4d19966e0e67_1.0.0",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http"],function(n,a,i,r,o,s,c,d,l,u,f){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"3xIC":function(e){e.exports=JSON.parse('{"n":"Set focal point","i":"Zoom in","r":"Zoom out","t":"Edit details","e":"Press enter to change the title, link, image, or other options for this item.","a":"Move item","o":"Current zoom ratio is {0}."}')},"5frl":function(e){e.exports=JSON.parse('{"n":"Focal point set at {0} percent from left and {1} percent from top.","t":"Drag to set a focal point.","a":"Use up, down, right, and left arrow keys to set focal point of image. Use Enter key to leave focal point mode.","e":"Focal point setting finished."}')},"5pbq":function(e,t){e.exports=i},Pk8u:function(e,t){e.exports=r},UWqr:function(e,t){e.exports=o},cDcd:function(e,t){e.exports=s},faye:function(e,t){e.exports=c},"hiL/":function(e,t){e.exports=d},jOlS:function(e,t){e.exports=l},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"ActionBar",function(){return v}),n.d(t,"FocalPoint",function(){return O}),n.d(t,"DEFAULT_FOCAL_OFFSET",function(){return S}),n.d(t,"defaultToCenter",function(){return D}),n.d(t,"getAverageImageBrightness",function(){return w}),n.d(t,"getBackgroundImageOverlay",function(){return E}),n.d(t,"CdnService",function(){return T}),n.d(t,"TenantCdnDataProvider",function(){return M});var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("UWqr"),s=n("Pk8u"),c=n("hiL/"),d=n("2q6Q");function l(){return o._SPFlight.isEnabled(60803)}var u=n("jOlS");u.loadStyles('.j_b_cd29e395{background-color:hsla(0,0%,100%,.8);bottom:0;display:flex;height:36px;justify-content:space-between;left:0;position:absolute;right:0;transition:opacity .167s cubic-bezier(.1,.9,.2,1);width:100%}.j_b_cd29e395.g_b_cd29e395,.j_b_cd29e395.k_b_cd29e395{opacity:0}.j_b_cd29e395.l_b_cd29e395{flex-direction:row-reverse}.j_b_cd29e395.m_b_cd29e395{background-color:"[theme:neutralQuaternaryAlt, default: #e1dfdd]";opacity:.8;transition:opacity .167s cubic-bezier(.1,.9,.2,1)}.j_b_cd29e395.m_b_cd29e395.g_b_cd29e395,.j_b_cd29e395.m_b_cd29e395.k_b_cd29e395{opacity:0}.n_b_cd29e395{align-items:center;color:"[theme:neutralDark, default: #201f1e]";display:flex}.o_b_cd29e395:focus,.o_b_cd29e395:hover{color:"[theme:themePrimary, default: #0078d4]"}.p_b_cd29e395{bottom:8px;width:auto}[dir=ltr] .p_b_cd29e395{left:unset}[dir=rtl] .p_b_cd29e395{right:unset}[dir=ltr] .p_b_cd29e395{right:8px}[dir=rtl] .p_b_cd29e395{left:8px}',!0);var f="n_b_cd29e395",p=n("3xIC"),m={iconName:"FocalPoint"},_={iconName:"ZoomIn"},h={iconName:"ZoomOut"},b={iconName:"Edit"},g={iconName:"Move"},v=function(e){function t(t){var n=e.call(this,t)||this;return n._focalPointButton=i.createRef(),n._handleZoomIn=function(){if(n.props.onSetZoomFactor&&void 0!==n.props.imageItem){var e=1.1*(n.props.imageItem.zoomRatio||1);n.props.onSetZoomFactor(Object(a.__assign)(Object(a.__assign)({},n.props.imageItem),{zoomRatio:e})),n._alertZoomRatio(e),d._EngagementLogger.log({name:"ImageTools.ZoomIn",extraData:{ratio:e}})}},n._handleZoomOut=function(){if(n.props.onSetZoomFactor&&void 0!==n.props.imageItem){var e=.9*(n.props.imageItem.zoomRatio||1);n.props.onSetZoomFactor(Object(a.__assign)(Object(a.__assign)({},n.props.imageItem),{zoomRatio:e})),n._alertZoomRatio(e),d._EngagementLogger.log({name:"ImageTools.ZoomOut",extraData:{ratio:e}})}},n._alertZoomRatio=function(e){c.ScreenReaderAlert.read(o.Text.format(p.o,e.toFixed(2)),c.ReadingMode.ReadImmediately)},n._alertZoomRatio=Object(s.debounce)(n._alertZoomRatio,500),n}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e){e.isSettingFocalPoint&&!this.props.isSettingFocalPoint&&this._focalPointButton.current&&this._focalPointButton.current.focus()},t.prototype.render=function(){var e,t="grid-edit-button".concat(this.props.itemId),n=void 0!==this.props.onSetFocalPoint&&i.createElement(r.TooltipHost,{content:p.n},i.createElement(r.IconButton,{componentRef:this._focalPointButton,onClick:this.props.onSetFocalPoint,iconProps:m,title:p.n,ariaLabel:p.n,"data-automation-id":"focal-point-button",role:"menuitem"})),a=void 0!==this.props.onSetZoomFactor&&i.createElement(r.TooltipHost,{content:p.i},i.createElement(r.IconButton,{onClick:this._handleZoomIn,iconProps:_,title:p.i,ariaLabel:p.i,"data-automation-id":"zoom-in-button",role:"menuitem"})),o=void 0!==this.props.onSetZoomFactor&&i.createElement(r.TooltipHost,{content:p.r},i.createElement(r.IconButton,{onClick:this._handleZoomOut,iconProps:h,title:p.r,ariaLabel:p.r,"data-automation-id":"zoom-out-button",role:"menuitem"})),s=i.createElement(r.TooltipHost,{content:p.t},i.createElement(r.IconButton,{onClick:this.props.onEdit,onFocus:this.props.onIconFocus,iconProps:b,title:p.t,ariaLabel:p.t,ariaDescription:p.e,"data-automation-id":"edit-button",id:t,role:"menuitem"})),c=i.createElement("div",{className:f},s,n,a,o),d=this.props.hasMoveButton&&i.createElement(r.TooltipHost,{content:p.a},i.createElement(r.IconButton,{onFocus:this.props.onIconFocus,iconProps:g,title:p.a,ariaLabel:p.a,"data-automation-id":"move-button",role:"menuitem"})),u=i.createElement("div",{className:f},d),v=Object(r.css)("j_b_cd29e395",this.props.hidden&&"k_b_cd29e395",this.props.isSettingFocalPoint&&"g_b_cd29e395",this.props.reverseRow&&"l_b_cd29e395","m_b_cd29e395",l()&&"p_b_cd29e395");if(l()){var y=Object(r.getTheme)().effects;e={borderRadius:null==y?void 0:y.roundedCorner4,overflow:"hidden",button:{width:34,height:34,borderRadius:null==y?void 0:y.roundedCorner4,color:"inherit"}}}return i.createElement("div",{className:Object(r.mergeStyles)(v,e),role:"menubar","aria-activedescendant":t},u,c)},t}(i.PureComponent),y=n("faye"),S=50;function D(e){return e||{x:S,y:S}}u.loadStyles('.a_a_cd29e395{background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";height:100%;opacity:0;position:relative;transition:all .5s ease;width:100%}.b_a_cd29e395 .a_a_cd29e395{display:none}.a_a_cd29e395 .c_a_cd29e395{align-items:center;background-color:"[theme:whiteTranslucent40, default: rgba(255,255,255,.4)]";border:2px solid "[theme:yellowlight, default: #fff100]";border-radius:50%;display:flex;height:64px;justify-content:center;left:50%;pointer-events:none;position:absolute;top:50%;transform:translate(-50%,-50%);-webkit-user-select:none;-ms-user-select:none;user-select:none;width:64px}.a_a_cd29e395 .c_a_cd29e395 .e_a_cd29e395{color:#fff;font-size:32px;position:relative}.a_a_cd29e395 .f_a_cd29e395{color:#fff;font-size:14px;left:50%;margin-top:50px;position:absolute;top:50%;transform:translate(-50%,-50%)}.a_a_cd29e395.g_a_cd29e395{opacity:1;z-index:2}.a_a_cd29e395.h_a_cd29e395{cursor:pointer}.i_a_cd29e395{position:aboslute}',!0);var I="a_a_cd29e395",x=n("5frl");function C(){return o._SPKillSwitch.isActivated("a44cd83e-3a5a-4ac6-99e4-402e13bde3d6")}var O=function(e){function t(n){var a=e.call(this,n)||this;return a._focalFrame=i.createRef(),a._onDragStart=function(e){e.stopPropagation(),e.preventDefault(),a.setState({isDragging:!0})},a._onDragMove=function(e){if(a._focalFrame.current&&a.state.isDragging){e.preventDefault(),e.stopPropagation();var t=a._focalFrame.current.clientWidth,n=a._focalFrame.current.clientHeight,i=Math.min(Math.max(e.nativeEvent.offsetX,0),t),r=Math.min(Math.max(e.nativeEvent.offsetY,0),n);a._onFocalPointMove({x:i/t*100,y:r/n*100})}},a._onDragEnd=function(e){e.stopPropagation(),e.preventDefault(),a.setState({isDragging:!1}),a._onFocalPointEnd("Mouse"),o._SPKillSwitch.isActivated("daa54017-3836-4322-bb5a-a0e85af90f2e")||t.focus(a._focalFrame.current)},a._handleMouseLeave=function(e){a.state.isDragging&&(e.stopPropagation(),e.preventDefault(),a.setState({isDragging:!1}),a._onFocalPointEnd("Mouse"))},a._handleKeyDown=function(e){e.stopPropagation(),e.preventDefault();var t=D(a.props.position),n=t.x,i=t.y;a._isKey(r.KeyCodes.enter,e)?a._onFocalPointEnd("Keyboard"):(a._isKey(r.KeyCodes.escape,e)?(n=50,i=50):a._isKey(r.KeyCodes.left,e)?n--:a._isKey(r.KeyCodes.up,e)?i--:a._isKey(r.KeyCodes.right,e)?n++:a._isKey(r.KeyCodes.down,e)&&i++,a._onFocalPointMove({x:Math.min(Math.max(Math.round(n),0),100),y:Math.min(Math.max(Math.round(i),0),100)}))},a._debounceReadPosition=a._async.debounce(a._readPosition,500,{leading:!1}),a.state={isDragging:!1},a}return Object(a.__extends)(t,e),t.focus=function(e){setTimeout(function(){if(e){var t=y.findDOMNode(e);if(t instanceof Element){var n=t.classList.contains(I)?t:t.querySelector(".".concat(I));n instanceof HTMLElement&&(c.ScreenReaderAlert.read(x.a,c.ReadingMode.ReadImmediately),n.setAttribute("data-automation-id","focalFrameIsSetting"),n.focus())}}})},t.prototype.render=function(){var e=D(this.props.position),t=e.x,n=e.y,a=void 0===this.props.position&&i.createElement("div",{className:"f_a_cd29e395"},x.t),s=Object(r.css)(I,!o._SPKillSwitch.isActivated("4537cf0c-7c62-4542-b3cc-132bdc628c51")&&"i_a_cd29e395","g_a_cd29e395",this.state.isDragging&&"h_a_cd29e395"),c=Object(r.css)(Object(r.getIconClassName)("SIPMove"),"e_a_cd29e395");return i.createElement("div",{className:s,tabIndex:0,role:"region",onMouseDown:this._onDragStart,onMouseMove:this._onDragMove,onMouseUp:this._onDragEnd,onMouseLeave:this._handleMouseLeave,onKeyDown:this._handleKeyDown,ref:this._focalFrame,"data-automation-id":this.state.isDragging?"focalFrameIsDragging":"","data-sp-a11y-skipkeys":"all"},i.createElement("div",{className:"c_a_cd29e395","data-automation-id":"titleRegionFocalCircle",style:{left:"".concat(t,"%"),top:"".concat(n,"%")}},i.createElement("i",{className:c,"aria-hidden":!0})),a)},t.prototype._isKey=function(e,t){return t.keyCode===e&&!t.altKey&&!t.ctrlKey&&!t.shiftKey},t.prototype._onFocalPointEnd=function(e){c.ScreenReaderAlert.read(x.e,c.ReadingMode.ReadImmediately),this.props.onFocalPointEnd(e)},t.prototype._onFocalPointMove=function(e){this._debounceReadPosition(e),this.props.onFocalPointMove(e)},t.prototype._readPosition=function(e){var t=o._SPKillSwitch.isActivated("978713f6-fc4a-470b-9c78-ff990ab772d1")?o.Text.format(x.n,e.x,e.y):o.Text.format(x.n,Math.round(e.x),Math.round(e.y));c.ScreenReaderAlert.read(t,c.ReadingMode.ReadImmediately)},t.hideClassName="b_a_cd29e395",t}(r.BaseComponent);function w(e){return new Promise(function(t){var n=new Image;n.src=e,o._SPKillSwitch.isActivated("d836e865-e27f-495b-9a89-b622a2b621e3")||(n.crossOrigin="anonymous"),n.onload=function(){var e=document.createElement("canvas");e.width=n.naturalWidth,e.height=n.naturalHeight;var a=e.getContext("2d");a.drawImage(n,0,0);for(var i=a.getImageData(0,0,e.width,e.height).data,r=0,o=[],s=0;s<i.length;s+=4){var c=.299*i[s]+.587*i[s+1]+.114*i[s+2];r+=c,o.push(c)}var d=Math.floor(r/(n.naturalHeight*n.naturalWidth));t(d)}})}function E(e){return w(e).then(function(e){var t,n,a;return e<=153?(t="#000000",a=!0,n=e<=51?20:e<=102?40:60):(t="#FFFFFFF",a=!1,n=e<=204?80:60),{color:t,opacity:n,useLightText:a}})}var A=n("ut3N"),L=n("vlQI"),k={jsonRequest:!0,jsonResponse:!0,defaultSameOriginCredentials:!0,defaultODataVersion:L.ODataVersion.v3,requestDigest:!0},M=function(){function e(e,t){var n=this;this._checkResponseStatus=function(e){return e.status>=200&&e.status<=299?e.json():e.json().catch(function(t){return Promise.reject(new Error("Unexpected response. Response code: ".concat(e.status,". Correlation id: ").concat(e.correlationId,". Error message: ").concat(n._extractErrorMessage(t),".")))})},this._spHttpClient=e,this._webAbsoluteUrl=t}return e.prototype.getCdnUrls=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,this._spHttpClient.post("".concat(this._webAbsoluteUrl,"/_api/tenantcdn/getcdnurls"),new L.SPHttpClientConfiguration(L.SPHttpClient.configurations.v1,k),{body:JSON.stringify({items:e})})];case 1:return t=n.sent(),[4,this._checkResponseStatus(t)];case 2:return[2,n.sent().value]}})})},e.prototype._extractErrorMessage=function(e){return e?e.message?e.message:e.error&&e.error.message?e.error.message:e["odata.error"]?"message=".concat(e["odata.error"].message.value,"|code=").concat(e["odata.error"].code):"unknowError":""},e}(),P=[2560,1600,960,400].sort(function(e,t){return t-e}),T=function(){function e(e){this._proactiveThumbSeedMonitor=new A._QosMonitor("ProactiveThumbnailSeed"),this._tenantCdnDataProvider=e}return e.createFromServiceScope=function(t,n){if(t._isFinished){var a=t.consume(L.SPHttpClient.serviceKey);return a&&n?new e(new M(a,n)):void A._TraceLogger.logError(e._logSource,new Error("CdnService.createFromServiceScope: spHttpClient or webAbsoluteUrl is undefined"))}A._TraceLogger.logError(e._logSource,new Error("CdnService.createFromServiceScope: serviceScope is not finished"))},e.prototype.seedImageBreakpointsIntoCdn=function(t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var i,r,s,c,d=this;return Object(a.__generator)(this,function(l){switch(l.label){case 0:if(i={serverRelativeUrl:t,sourceWidth:n},!n||n<=0)return C()?this._proactiveThumbSeedMonitor.writeUnexpectedFailure("naturalWidth invalid: ".concat(n)):this._proactiveThumbSeedMonitor.writeUnexpectedFailure("naturalWidth invalid",void 0,i),[2];r=function(r){return Object(a.__awaiter)(d,void 0,void 0,function(){var s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D;return Object(a.__generator)(this,function(a){switch(a.label){case 0:s=P.filter(function(e){return e<=n}),i.breakpointsAvailable=s.join(","),c=[],d=0,l=s,a.label=1;case 1:if(!(d<l.length))return[3,12];u=l[d],f={breakpoint:u,isFirstBreakpoint:u===s[0],isRetry:!1,isAbandoned:!1,isSuccessful:!1,statusCode:0,statusText:""},p=new A._QosMonitor("ProactiveThumbnailSeedItem"),m={serverRelativeUrl:t,breakpoint:u,isFirstBreakpoint:f.isFirstBreakpoint,sourceWidth:n},a.label=2;case 2:return a.trys.push([2,9,10,11]),_=this._updatePreferOptimized(r),h=this._updateThumbnailWidth(_,u),[4,this._fetchImageBlob(h)];case 3:if(b=a.sent(),f.isSuccessful=!0,f.statusCode=b.status,f.statusText=b.statusText,m.cdnUrlWithWidth=h,m.statusCode=f.statusCode,m.sourceWidth=n,o._SPKillSwitch.isActivated("75282f9d-b485-4141-9879-737fc14d46a2"))return[3,8];a.label=4;case 4:return a.trys.push([4,7,,8]),v=this._getImageInfo,[4,b.blob()];case 5:return[4,v.apply(this,[a.sent()])];case 6:return g=a.sent(),m.actualWidth=g.width,m.actualHeight=g.height,m.size=g.sizeBytes,m.type=g.mimeType,[3,8];case 7:return y=a.sent(),A._TraceLogger.logError(e._logSource,y),[3,8];case 8:return p.writeSuccess(m),[3,11];case 9:return S=a.sent(),f.statusCode=null==S?void 0:S.statusCode,f.statusText=null==S?void 0:S.statusText,m.statusCode=f.statusCode,m.statusText=f.statusText,D=new Error("<serverRelativeUrl>".concat(t,"</serverRelativeUrl> <statusCode>").concat(m.statusCode,"</statusCode> Error:").concat(null==S?void 0:S.error)),p.writeUnexpectedFailure("Failed for width: ".concat(u),D,m),f.isFirstBreakpoint?(f.isAbandoned=!0,[3,12]):(A._TraceLogger.logError(e._logSource,S),[3,11]);case 10:return c.push(f),[7];case 11:return d++,[3,1];case 12:return i.successfulBreakpoints=c.filter(function(e){return e.isSuccessful}).map(function(e){return e.breakpoint}).join(","),i.failedBreakpoints=c.filter(function(e){return!e.isSuccessful}).map(function(e){return e.breakpoint}).join(","),1===c.length&&c.length<s.length?(i.statusCode=c[0].statusCode,i.statusText=c[0].statusText,this._proactiveThumbSeedMonitor.writeUnexpectedFailure("seedCdn",new Error("Initial thumb failed. Abandoned all subsequent attempts."),i)):c.some(function(e){return e.isSuccessful})?this._proactiveThumbSeedMonitor.writeSuccess(i):0===c.length?this._proactiveThumbSeedMonitor.writeExpectedFailure(C()?"No available breakpoints to process: ".concat(t):"No available breakpoints to process",void 0,i):this._proactiveThumbSeedMonitor.writeUnexpectedFailure("All failed",new Error("Impossible failure. Logic around abandoning at first items failure must have changed."),i),[2]}})})},l.label=1;case 1:return l.trys.push([1,4,,5]),[4,this.getCdnURLForItem(t)];case 2:return void 0===(s=l.sent())?(C()?this._proactiveThumbSeedMonitor.writeUnexpectedFailure("cdnUrlResult is undefined"):this._proactiveThumbSeedMonitor.writeUnexpectedFailure("cdnUrlResult is undefined",void 0,i),[2]):s.CdnUrl?[4,r(s.CdnUrl)]:(C()?this._proactiveThumbSeedMonitor.writeExpectedFailure("No CDN url for the provided item: ".concat(t)):this._proactiveThumbSeedMonitor.writeExpectedFailure("No CDN url for the provided item",void 0,i),[2]);case 3:return l.sent(),[3,5];case 4:return c=l.sent(),C()?this._proactiveThumbSeedMonitor.writeUnexpectedFailure("Cannot Continue",c):this._proactiveThumbSeedMonitor.writeUnexpectedFailure("Cannot Continue",c,i),A._TraceLogger.logError(e._logSource,c),[3,5];case 5:return[2]}})})},e.prototype.getCdnURLForItem=function(e){return this._tenantCdnDataProvider.getCdnUrls([e]).then(function(e){if(e.length>0)return e[0]})},e.prototype._updateThumbnailWidth=function(e,t){return"".concat(e).concat(-1===e.indexOf("?")?"?":"&").concat("width","=").concat(t)},e.prototype._updatePreferOptimized=function(e){return o._SPKillSwitch.isActivated("f223316a-d833-4394-8b17-bbb07fbcce9f")?e:"".concat(e).concat(-1===e.indexOf("?")?"?":"&").concat("preferOptimized","=true")},e.prototype._fetchImageBlob=function(e,t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:n=new Headers(t),i=new AbortController,r=setTimeout(function(){return i.abort("Request timed out after: ".concat(5e3,"ms"))},5e3),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,fetch(e,{headers:n,cache:"reload",redirect:"follow",signal:i.signal})];case 2:if(o=a.sent(),clearTimeout(r),o.ok)return[2,o];throw new Error("Request Failed: ".concat(o.status," ").concat(o.statusText));case 3:if(s=a.sent(),i.signal.aborted)throw new Error(i.signal.reason);throw s;case 4:return[2]}})})},e.prototype._getImageInfo=function(e){return new Promise(function(t,n){try{var a=URL.createObjectURL(e),i=new Image;i.onload=function(){var n={width:i.naturalWidth,height:i.naturalHeight,sizeBytes:e.size,mimeType:e.type};t(n)},i.onerror=function(){n()},i.src=a}catch(e){n(e)}})},e._logSource=A._LogSource.create("CdnService"),e}()},ut3N:function(e,t){e.exports=u},vlQI:function(e,t){e.exports=f}})});