(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[143],{"+HmL":function(e,t,n){"use strict";var a=n("jyrw"),i=function(){function e(){}return e.setIsHighlightsListEnabled=function(t){a.e._dispatchAction("SET_HIGHLIGHTS_LIST_FLAG",t,e._moduleName,"VivaTopicsSetHighlightsListEnabled")},e.setManualHighlightedTopics=function(t){a.e._dispatchAction("SET_MANUAL_HIGHLIGHTED_TOPICS",t,e._moduleName,"VivaTopicsSetHighlightedTopics")},e.setAutoHighlightedTopics=function(t){a.e._dispatchAction("SET_AUTO_HIGHLIGHTED_TOPICS",t,e._moduleName,"VivaTopicsSetHighlightedTopics")},e.setTopicBadges=function(t){a.e._dispatchAction("SET_TOPIC_BADGES_DESCRIPTION",t,e._moduleName,"VivaTopicsSetTopicBadgesDescription")},e.setTopicBadgesAllowedEditors=function(t){a.e._dispatchAction("SET_TOPIC_BADGES_ALLOWED_EDITORS",t,e._moduleName,"VivaTopicsSetTopicBadgesAllowedEditors")},e._moduleName="[VivaTopicsPaneActionCreator]",e}();t.e=i},"/mM3":function(e,t,n){"use strict";n.d(t,"e",function(){return b}),n.d(t,"i",function(){return g}),n.d(t,"t",function(){return v}),n.d(t,"n",function(){return y}),n.d(t,"a",function(){return S});var a,i,r=n("17wl"),o=n("cDcd"),s=n("faye"),c=n("HVbJ"),d=n("U4ag"),l=n("TOey"),u=n("5pbq");!function(e){e[e.None=0]="None",e[e.Neutral=1]="Neutral",e[e.Soft=2]="Soft",e[e.Strong=3]="Strong"}(i||(i={}));var f=((a={})[l.e.None]=i.None,a[l.e.Neutral]=i.Neutral,a[l.e.Soft]=i.Soft,a[l.e.Strong]=i.Strong,a),p=n("EMa1"),m=n("slaT"),_="topic-annoation-",h="data-automation-id",b="data-sp-topic-score";function g(e){return-1===e.tabIndex}function v(e){e.tabIndex=-1}function y(e,t,n){var a=[];return Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;1===(null==t?void 0:t.nodeType);){if(t.matches(e))return t;t=t.parentElement||t.parentNode}return null})),null==e||e.forEach(function(e){var l,v,y,S=function(e,t){return t?e.getAttribute(p.n.kmHashtaggedTopicIdAttribute)||void 0:e.getAttribute(p.n.kmTopicIdAttribute)||void 0}(e,n);if(e.getAttribute(h)!=="".concat(_).concat(S)&&S&&!g(e)){a.push(S);var D="",I=Boolean(e.closest('[data-sp-feature-tag="PageTitle"]'));if(I)D=e.className;else{var x=e.closest("div[data-theme-emphasis]");D=function(e,t){void 0===e&&(e=i.None);var n,a,r=(a=Object(u.getTheme)(),(n={})[i.None]={rest:{background:a.palette.neutralLighter,text:a.palette.neutralPrimary},hover:{background:a.palette.themeLighter,text:a.palette.themeDark}},n[i.Neutral]={rest:{background:a.palette.neutralQuaternaryAlt,text:a.palette.neutralPrimary},hover:{background:a.palette.themeLighter,text:a.palette.themeDark}},n[i.Soft]={rest:{background:a.palette.neutralLighter,text:a.palette.neutralPrimary},hover:{background:a.palette.themeLighter,text:a.palette.themeDark}},n[i.Strong]={rest:{background:a.palette.themeDarkAlt,text:a.palette.white},hover:{background:a.palette.themeDark,text:a.palette.white}},n)[e],o=" !important";return Object(u.mergeStyles)({cursor:"pointer",color:r.rest.text+o,backgroundColor:r.rest.background,textDecoration:"underline",textDecorationColor:r.rest.text,selectors:{":hover":{color:r.hover.text+o,backgroundColor:r.hover.background,textDecorationColor:r.hover.text},"::before":t&&{content:'"#"'}}})}((y=+(null==x?void 0:x.getAttribute("data-theme-emphasis")))&&f[y]?f[y]:i.None,n)}if(!I&&(null===(v=e.className)||void 0===v?void 0:v.indexOf(D))>-1)return;var C=((l={})[n?p.n.kmHashtaggedTopicIdAttribute:p.n.kmTopicIdAttribute]=S,l[h]="".concat(_).concat(S),l[b]=e.getAttribute(b)||"",l),O=e.ownerDocument.createElement("span"),w=o.createElement("span",Object(r.__assign)({className:D,role:"button","aria-haspopup":"true",tabIndex:0},C),e.innerText),E=o.createElement(d.TopicCardHoverTarget,{clientScenario:"TextWebPart",disableHover:!1,displayName:e.innerText,hostAppPersonaInfo:{PersonaType:"Topic"},serviceScope:t,legacyUpn:"",topicCardProps:{topicId:S,topicCardMetadata:{source:n?c.LinkSourceTypes.HashtaggedAnnotation:c.LinkSourceTypes.Annotation,openTypesForHeaderLinks:void 0}},useSpan:!0,onCardOpen:function(){Object(m.e)().then(function(e){e.isTeachingBubbleTempDisabled(n?"manual":"auto")&&e.setFRECompleteAndClearFlags(n)})}},w);e.parentElement.replaceChild(O,e),s.render(E,O)}}),a}function S(e,t){return null==t?void 0:t.filter(function(t){return function(e,t){var n;return Boolean(e===t.Id||(null===(n=t.AncestorIds)||void 0===n?void 0:n.some(function(t){return t===e})))}(e,t)})[0]}},"2B6j":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("d82ecbb8-7bdf-4028-8403-6df322f372cb")}function r(){return a._SPKillSwitch.isActivated("bfeebdab-f960-4ba2-9146-a3611a2a76ce")}},"6ytw":function(e,t,n){"use strict";n.r(t);var a=n("UWqr"),i=n("ut3N"),r=n("Pk8u"),o=n("HVbJ"),s=n("zOrf"),c=n("7plR"),d=n("xs0R"),l=n("saKN"),u=n("EMa1"),f=n("ExwJ"),p=n("XdGY"),m=n("xw5y"),_=n("slaT"),h=n("zMJP"),b=n("sVOx"),g=n("hCpQ"),v=n("M+LP"),y=n("3muy"),S=n("BUwq"),D=function(){function e(){this.readyToAttachAnnotationListeners=!1,this.topicAnnotator=new g.default}return e.prototype.renderAnnotations=function(t,n,u,g){var D=this;if(!a._BrowserUtilities.isMobileBrowser()){var I=new o.EngagementLogger(c.e.instance.serviceScope),x=new i._QosMonitor(e._topicQosTag),C=new m.t(g,m.e.BeginRenderAnnotations);h.n({step:"ChunkDownload",resultType:s.t.Success}),this.topicAnnotator.annotate(u||[],t,C).then(function(e){C&&C.addStage(m.e.BeginRenderAnnotatedContent);var t=c.e.instance.pageContext.legacyPageContext.pageItemId,i=c.e.instance.pageContext.site.id;if((null==e?void 0:e.content)&&(Object(p.D)()?!Object(r.isEqual)(u,null==e?void 0:e.content):null==e?void 0:e.contentAnnotated)&&d.t.mode===a.DisplayMode.Read&&t===e.pageId&&i===e.siteId)try{var o=Promise.resolve();c.e.actions.fieldActions||(o=Object(l.t)().then(function(e){c.e.updateActions(e.actions)})),o.then(function(){var t;D.readyToAttachAnnotationListeners=!0,c.e.actions.fieldActions.addFieldsToUpdate(((t={})[f.e.CanvasContent]=e.content,t)),C.addStage(m.e.UpdateFieldsComplete),g.writeSuccess(),x.writeSuccess(),D.topicAnnotator.executePostAnnotationActionsBackup(n)})}catch(e){(null==g?void 0:g.hasEnded)||(C.addStage(m.e.RenderAnnotationFailure),g.writeUnexpectedFailure("RenderAnnotationFailure",e)),x.writeUnexpectedFailure("RenderAnnotationFailure",e),h.n({step:"Render",resultType:s.t.UnexpectedFailure,errorTag:"UpdatingAnnotatedContentFailed",error:e,shouldComplete:!0})}else d.t.mode===a.DisplayMode.Read&&D.topicAnnotator.addHashtaggingAnnotation(n),(null==g?void 0:g.hasEnded)||(C.addStage(m.e.AnnotationsNotNeeded),g.writeExpectedFailure("AnnotateNotNeeded")),x.writeExpectedFailure("AnnotateNotNeeded");d.t.mode===a.DisplayMode.Read&&Object(_.e)().then(function(e){e.checkStatusAndAttachTeachingBubble()})}).catch(function(e){if((e instanceof o.RestApiError||e instanceof o.AadTokenError)&&e.isExpected)x.writeExpectedFailure(e instanceof o.RestApiError?e.code:"ExpectedFailure",e),g.writeExpectedFailure(e instanceof o.RestApiError?e.code:"ExpectedFailure",e),h.e({resultType:s.t.ExpectedFailure,errorTag:"AnnotateFailed",error:e,shouldComplete:!0});else{x.writeUnexpectedFailure(e.message,e),g.writeUnexpectedFailure(e.message,e),h.e({resultType:s.t.UnexpectedFailure,errorTag:"AnnotateFailed",error:e,shouldComplete:!0});var t=Object(v.u)()?S.e.AutomaticInlineRenderFailed:y.e.AutomaticTagLoadFailed,n=Object(v.u)()?S.e.ManualInlineRenderFailed:y.e.ManualTagLoadFailed;Object(o.logASHAError)(I,t,{errorName:"AnnotateEndpointFailed",error:e},{clientRequestId:D.topicAnnotator._clientRequestId.toString()}),Object(b.t)()&&Object(o.logASHAError)(I,n,{errorName:"AnnotateEndpointFailed",error:e},{clientRequestId:D.topicAnnotator._clientRequestId.toString()})}})}},e.prototype.executePostAnnotationActions=function(e){this.topicAnnotator.executePostAnnotationActions(e)},e._topicQosTag="".concat(u.n.kmAnnotateLogPrefix,".Render"),e}();t.default=D},"9u9O":function(e,t,n){"use strict";n.d(t,"e",function(){return p}),n.d(t,"t",function(){return m}),n.d(t,"n",function(){return _});var a,i=n("ut3N"),r=n("xw5y"),o=n("HVbJ"),s=n("sVOx"),c=n("7plR"),d=n("+HmL"),l=n("xs0R"),u=n("Pk8u"),f="HighlightsPane";function p(e,t,c){var d=new i._QosMonitor("GetAnnotationAPI"),l=new r.t(d,r.e.BeginRenderAnnotations);return Promise.all([n.e(12),n.e(143)]).then(n.bind(null,"hCpQ")).then(function(n){(a=n.default.instance).annotate(e||[],t,l).then(function(){return null==a?void 0:a.refreshHashtagWithoutHighlight(c).then(function(){d.writeSuccess()})}).catch(function(e){e instanceof o.RestApiError&&e.isExpected?d.writeExpectedFailure(e.code,e):d.writeUnexpectedFailure(e.message,e),s.e.logAnnotationsError("GetHighlightsFailed",e)})}).catch(function(e){d.writeExpectedFailure("TopicAnnotatorChunkDownloadFailure",e),s.e.logAnnotationsError("TopicAnnotatorChunkDownloadFailure",e)})}function m(e){var t=new i._QosMonitor("CSIKM.TopicPage.TopicBadgeCard.GetHiddenHighlights");return c.e.instance.getPageDataProviderAsync().then(function(e){var t,n=null===(t=l.t.fields)||void 0===t?void 0:t.Id;return n?e.getHighlightsInfo(n):void 0}).then(function(n){return n&&!Object(u.isEmpty)(n.HideListEditor)?o.DeferredPeopleDataProvider.load(f).then(function(t){return new t(e,f).getPeopleInfo(n.HideListEditor).then(function(e){var t={displayName:e.name,loginName:e.upn,email:e.email};return d.e.setIsHighlightsListEnabled({isHighlightsListEnabled:!1,highlightsListEditor:t}),Promise.resolve([])})}).catch(function(e){return t.writeUnexpectedFailure("GetPeopleInfo",e),Promise.resolve([])}):void 0===(null==n?void 0:n.HiddenHighlights)||Object(u.isEmpty)(n.HiddenHighlights)?Promise.resolve([]):JSON.parse(n.HiddenHighlights)}).catch(function(e){return t.writeUnexpectedFailure("GetHiddenHighlights",e),Promise.resolve([])})}function _(e,t){var n=e.map(function(e){return e.topicEntity.Id});Object(o.saveHiddenHighlightstoService)(t,n)}},CXez:function(e,t,n){"use strict";n.r(t),n.d(t,"SPDF_KNOWLEDGE_HUB_URL",function(){return y}),n.d(t,"MSIT_KNOWLEDGE_HUB_URL",function(){return S});var a=n("17wl"),i=n("ut3N"),r=n("hiL/"),o=n("HVbJ"),s=n("X+PM"),c=n("tvCX"),d=n("UWqr"),l=n("WZz6"),u=n("7plR"),f=n("xxQZ"),p=n("0IsF"),m=n("q+wp"),_=n("0SGS"),h=n("EMa1"),b=n("ZmHf"),g=n("lsEo"),v=n("2B6j"),y="https://microsoft.sharepoint-df.com/teams/knowledgehub",S="https://microsoft.sharepoint.com/sites/knowledgecenter",D=["odspcsitest","olfilato-test-site","EdensTestSPDF"],I=function(){function e(){this._getTopicByIdDataProvider=new c.SubstrateGetTopicByIdDataProvider(u.e.instance.serviceScope)}return Object.defineProperty(e,"knowledgeHubUrl",{get:function(){var t,n;if(e._useDFKnowledgeCenter)return y;if(null===(n=null===(t=m.e.spPageContextInfo)||void 0===t?void 0:t.knowledgeHubSiteDetails)||void 0===n?void 0:n.Url){var a=m.e.spPageContextInfo.knowledgeHubSiteDetails.Url;return a===y?S:a}return-1!==location.origin.toLowerCase().indexOf("microsoft")?S:void i._TraceLogger.logError(e._logSource,new Error("Error: Configure the KnowledgeCenter URL for Knowledge Mining scenarios to work correctly."))},enumerable:!1,configurable:!0}),Object.defineProperty(e,"knowledgeHubSitePagesUrl",{get:function(){return e.knowledgeHubUrl+"/SitePages"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_useDFKnowledgeCenter",{get:function(){var e=u.e.instance.pageContext.site.absoluteUrl.toLowerCase();return-1!==e.indexOf("microsoft.sharepoint-df.com")&&D.some(function(t){return-1!==e.indexOf(t)})},enumerable:!1,configurable:!0}),e.prototype.loadInApp=function(t,n,c,d,g){this._broadcastTopicEntity(n.Id,c),Object(l.getTopicsSdk)(u.e.instance.serviceScope,m.e.getTopicPageLanguage()),Object(r.DeferredDialogUtility)().then(function(e){var i,l,y;e.showProgressBar(b.e);var S=new Map,D=o.TopicPageLayoutDefaultTemplate.getLayoutTemplate(n,u.e.instance.pageContext);try{for(var I=Object(a.__values)(D),x=I.next();!x.done;x=I.next()){var C=x.value;Object(o.isTopicsMultilingualV3FlightEnabled)()&&C.id===o.TopicPageLayoutDefaultTemplate.TITLE_REGION_WP_ID&&n.Name!==r.NULL_TOPIC_ENTITY.Name&&(C.properties.hasTitleBeenCommitted=!0),S.set(C.id,C)}}catch(e){i={error:e}}finally{try{x&&!x.done&&(l=I.return)&&l.call(I)}finally{if(i)throw i.error}}var O=new _.e;O.Id=h.n.newPageStubId,O.Title=n.Name,O.FileName=h.n.topicPagePreviewStubFileName,O.Modified=(new Date).toISOString(),O.DoesUserHaveEditPermission=!0,O.IsPageUnpublished=!0,O.IsPageCheckedOutToCurrentUser=!0,O.PageLayoutType=p.e.Topic,O.LayoutWebPartsDataMap=S,O.EntityId=Object(v.t)()?n.Id:(null===(y=n.OriginalIds)||void 0===y?void 0:y[0])||n.Id,O.EntityType="",Object(o.isTopicsMultilingualV3FlightEnabled)()&&(O.TranslationLanguage=null==g?void 0:g.toLowerCase());var w=Object(o.getKnowledgeHubUrlWithOverrides)(u.e.instance.serviceScope.consume(s.PageContext.serviceKey)),E=d||c&&"true"!==m.e.getUrlParam("enableKHPreview")?void 0:w;return m.e.transitionToNewPage(t,{promotedState:0,pageTemplateId:f.e.Blank,source:void 0,isPreview:c,crossSiteUrl:E,previewPageFileName:h.n.topicPagePreviewStubFileName,pageFieldData:O}).then(function(){return e.dismissProgressBar()})}).catch(function(t){i._TraceLogger.logError(e._logSource,t)})},e.prototype.getLPCUsers=function(e){return e.map(function(e){return{loginName:e.OId,name:e.Name,email:e.Email}})},e.prototype._broadcastTopicEntity=function(e,t){return e===r.NULL_TOPIC_ENTITY.Id?Promise.resolve().then(function(){return d._SPEventManager.instance.raiseStickyEvent(g.t,{topicEntity:void 0,topicId:e})}):this._fetchCurrentTopicEntity(e,t).then(function(t){d._SPEventManager.instance.raiseStickyEvent(g.t,{topicEntity:t,topicId:e})},function(t){d._SPEventManager.instance.raiseStickyEvent(g.t,{topicEntity:void 0,topicId:e,fetchError:t})})},e.prototype._fetchCurrentTopicEntity=function(e,t){return this._getTopicByIdDataProvider.getTopic(e,!t,void 0,m.e.getTopicPageLanguage())},e._logSource=i._LogSource.create("TopicPagLoader"),e}();t.default=I},TOey:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.None=0]="None",e[e.Neutral=1]="Neutral",e[e.Soft=2]="Soft",e[e.Strong=3]="Strong"}(a||(a={}))},ZmHf:function(e){e.exports=JSON.parse('{"e":"Loading…"}')},hCpQ:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("UWqr"),r=n("Pk8u"),o=n("ut3N"),s=n("sSDQ"),c=n("hiL/"),d=n("HVbJ"),l=n("X+PM"),u=n("zOrf"),f=n("xEY6"),p=n("2q6Q"),m=n("8SM4"),_=n("3muy"),h=n("BUwq"),b=n("xw5y"),g=n("EMa1"),v=n("lsEo"),y=n("q+wp"),S=n("7plR"),D=n("pWQT"),I=n("/mM3"),x=n("xs0R"),C=n("zMJP"),O=n("2B6j");function w(e,t){var n=performance.now(),a=0,i=0,r=0;function o(){t&&t.reportDurationCallback&&t.reportDurationCallback({taskScheduled:n,taskStart:a,taskDuration:i-a,totalDuration:r-n})}var s=function(){a=performance.now();var t=e();i=performance.now();var n=t;return"object"==typeof n&&"function"==typeof n.then?n.then(function(){r=performance.now(),o()}):(r=performance.now(),o()),t};return new Promise(function(e){window.requestIdleCallback?window.requestIdleCallback(function(){e(s())}):window.setTimeout(function(){e(s())},0)})}var E=n("sVOx"),A=n("aflJ"),L=n("+HmL"),k=n("M+LP"),M=n("9u9O");function P(e){return e.getAttribute(g.n.kmHashtaggedTopicIdAttribute)}var T="page-title";function U(){return 1===p._SPPerfExperiment.getVariantAndTrackExperiment(p._PerformanceExperiment.TopicAnnotationsIdleExecute)}function F(e){return function(t){t.taskDuration>50&&Object(m.t)(function(e){return new o._QosMonitor(e)},"TopicAnnotationsLongTasks",[{name:"".concat(e,".sync"),timestamp:t.taskDuration},{name:"".concat(e,".total"),timestamp:t.totalDuration}])}}var H=function(){function e(){var e=this;this._clientRequestId="",this._automaticTopicEntities=new Set,this._manualTopicEntities=new Set,this._hiddenTopicIds=new Set,this._topicQueryAllSelector="span[".concat(g.n.kmTopicIdAttribute,"]"),this._annotationAttemptCount=0,this._annotateAtleastOne=0,this._annotationCount=0,this._annotationCounts={},this._hashtaggedAnnotationCount=0,this._scenarioQos=void 0,this._postAnnotationActionsRequired=!1,this._engagementLogger=new d.EngagementLogger(S.e.instance.serviceScope),this.removeAnnotation=function(e){i.Validate.isNotNullOrUndefined(e,"targetElement"),e.removeAttribute("class"),e.removeAttribute(g.n.kmTopicIdAttribute),e.removeAttribute(g.n.kmHashtaggedTopicIdAttribute),e.removeAttribute("role"),e.removeAttribute("tabindex"),e.removeAttribute("aria-label"),e.removeAttribute("aria-haspopup")},this._dispatchHighlightedTopics=function(t,n,a){if(a)L.e.setManualHighlightedTopics({manualHighlightedTopics:n});else{var i=n.map(function(n){return e._isHiddenTopic(n,t)?{topicEntity:n,isHidden:!0}:{topicEntity:n,isHidden:void 0}});L.e.setAutoHighlightedTopics({autoHighlightedTopics:i})}}}return Object.defineProperty(e,"instance",{get:function(){return this._instance||(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.annotate=function(e,t,n){var a,o,c,d,l,f=this;if(i.Validate.isNotNullOrUndefined(e,"content"),i.Validate.isNotNullOrUndefined(t,"pageManager"),this._annotationStartTime=Date.now(),this._scenarioQos=n,this._scenarioQos.addStage(b.e.BeginTopicAnnotator),!e.length&&!(null===(o=null===(a=null===x.e||void 0===x.e?void 0:x.e.fields)||void 0===a?void 0:a.Title)||void 0===o?void 0:o.length))return Promise.resolve(void 0);var p=t.pageContext.legacyPageContext.pageItemId,m=t.pageContext.site.id,_=x.e.mode!==i.DisplayMode.Read;this._annotationAttemptCount=1,this._annotateAtleastOne=0,this._annotationCount=0,this._hashtaggedAnnotationCount=0;var h="string"==typeof e?JSON.parse(e):Object(r.cloneDeep)(e),g=this._getDefinitionContent(),v=((null===(c=null===x.e||void 0===x.e?void 0:x.e.fields)||void 0===c?void 0:c.Title)&&"Topic"!==(null===(d=null===x.e||void 0===x.e?void 0:x.e.fields)||void 0===d?void 0:d.PageLayoutType)&&"TopicPreview"!==(null===(l=null===x.e||void 0===x.e?void 0:x.e.fields)||void 0===l?void 0:l.PageLayoutType)?[{id:T,text:x.e.fields.Title}]:[]).concat(g?[{id:"e9ee7242-273c-473f-bfa5-149b32873501",text:g}]:[]).concat(h.filter(function(e){return e.controlType===s.CanvasControlType.RTE&&f._hasInnerHtmlText(null==e?void 0:e.innerHTML)}).map(function(e){var t=e;return{id:t.id,text:t.innerHTML}}));return 0===v.length?Promise.resolve(void 0):(this._scenarioQos.addStage(b.e.BeginCallSubstrateAPI),C.n({step:"BuildRequest",resultType:u.t.Success}),this._annotateUsingSubstrateAPI(t,v,h,p,m,Object(A.c)()&&_))},e.prototype.executePostAnnotationActions=function(e){i.Validate.isNotNullOrUndefined(e,"context"),this._bindTopicCardAndDispatchAnnotation(e,"auto"),this.addHashtaggingAnnotation(e),C.n({step:"Render",resultType:u.t.Success}),C.e({resultType:u.t.Success})},e.prototype.executePostAnnotationActionsBackup=function(e){this._postAnnotationActionsRequired&&this.executePostAnnotationActions(e)},e.prototype.refreshHashtagWithoutHighlight=function(e){return Object(c.isCortexEnabled)(S.e.instance.pageContext)?(this._hashtaggedAnnotationCount=0,this._annotateHashtaggedTopicIds(e,!0)):Promise.resolve()},e.prototype.addHashtaggingAnnotation=function(e){var t=this;i.Validate.isNotNullOrUndefined(e,"context"),Object(c.isCortexEnabled)(S.e.instance.pageContext)&&(this._hashtaggedAnnotationCount=0,this._annotateHashtaggedTopicIds(e.serviceScope).then(function(){t._bindTopicCardAndDispatchAnnotation(e,"manual")}))},e.prototype.writeE2EScenarioQoS=function(){var e;null===(e=this._scenarioQos)||void 0===e||e.qosMonitor.writeSuccess()},e.prototype._bindTopicCardAndDispatchAnnotation=function(e,t){var n=this,a="manual"===t,r=this._getAnnotatedElements(a);if(0!==r.length){var o=Object(I.n)(r,e.serviceScope,a),s=Object(k.u)()?h.e.AutomaticInlineRender:_.e.AutomaticTagLoad,c=Object(k.u)()?h.e.ManualInlineRender:_.e.ManualTagLoad,d="manual"===t?c:s;if(Object(k.u)()){var l="manual"===t?this._manualTopicEntities:this._automaticTopicEntities;this._engagementLogger.log(d,{},{topics:Array.from(l)})}else o.forEach(function(e){n._engagementLogger.log(d,{topicId:e})});i._SPEventManager.instance.raiseStickyEvent(a?v.i:v.e,{})}else i._SPEventManager.instance.raiseStickyEvent(a?v.i:v.e,{})},e.prototype._isHiddenTopic=function(e,t){var n;if(!t)return!1;var a=null!==(n=e.AncestorIds)&&void 0!==n?n:[];return a.push(e.Id),-1!==t.findIndex(function(e){return a.indexOf(e)>-1})},e.prototype._getAnnotatedElements=function(e){var t=document.querySelectorAll(e?g.n.hashtaggedTopicQueryAllSelector:this._topicQueryAllSelector);return Array.prototype.slice.call(t)},e.prototype._hasInnerHtmlText=function(e){if(!e)return!1;var t=document.createElement("div");return t.innerHTML=e,!!t.innerText},e.prototype._encodeQuotes=function(e){return e?e.replace(new RegExp("'","g"),"&#39;").replace(new RegExp('"',"g"),"&#34;"):""},e.prototype._processResponse=function(e,t,n){return void 0===n&&(n=!1),Object(a.__awaiter)(this,void 0,void 0,function(){var r,s,c,d,l,m,_,h,y,S=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return 0===e.PageMatches.length?(i._SPEventManager.instance.raiseStickyEvent(v.e,{}),[2,{canvasControls:void 0,topicIds:[],contentAnnotated:!1}]):(n&&this._scenarioQos.addStage(b.e.BeginProcessResponse),r=[],s=!1,c="mode",(d=new URLSearchParams(self.location.search)).has(c)&&"preview"===d.get(c)?[2,{canvasControls:t,topicIds:r,contentAnnotated:s}]:(l="".concat(g.n.kmAnnotateLogPrefix,".AnnotationResponseProcessing"),m=new o._QosMonitor(l),[4,f.e.set(e.EntityDetails,!0)]));case 1:return a.sent(),n&&this._scenarioQos.addStage(b.e.TopicCacheUpdated),_=this._filterRepeatingMatchesandHiddenTopics(e.PageMatches,e.EntityDetails),n&&this._scenarioQos.addStage(b.e.FilteredRepeatMatchesComplete),U()?[4,w(function(){return S._annotateSections(t,_,e.EntityDetails)},{reportDurationCallback:F("AnnotateSections")})]:[3,3];case 2:return y=a.sent(),[3,5];case 3:return[4,this._annotateSections(t,_,e.EntityDetails)];case 4:y=a.sent(),a.label=5;case 5:return t=(h=y).canvasControls,r=h.topicIds,s=h.contentAnnotated,n&&this._scenarioQos.addStage(b.e.AnnotatedHtmlComplete),p._PerformanceLogger.addComponentBreakdown("Topics","annotationsCount",this._annotationCount),e.EntityDetails.length>0&&0===this._annotationCount?(i._SPEventManager.instance.raiseStickyEvent(v.e,{}),this._scenarioQos.addStage(b.e.NoAnnotationsWritten),this._scenarioQos.qosMonitor.writeUnexpectedFailure("NoAnnotationsWritten"),C.n({step:"Render",resultType:u.t.ExpectedFailure,errorTag:"NoAnnotations",shouldComplete:!0})):m&&(e.EntityDetails.length>0&&this._annotationCount-this._hashtaggedAnnotationCount==0?(i._SPEventManager.instance.raiseStickyEvent(v.e,{}),m.writeUnexpectedFailure("NoAnnotationsWritten")):m.writeSuccess()),[2,{canvasControls:t,topicIds:r,contentAnnotated:s}]}})})},e.prototype._annotateSections=function(e,t,n){var i;return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,l,u,f,p,m,_,h,b,g,v,y,S,D;return Object(a.__generator)(this,function(I){switch(I.label){case 0:r=t.reduce(function(e,t){return e.set(t.ComponentId,t.Matches),e},new Map),o=[];try{l=new Set,t.forEach(function(e){e.Matches.forEach(function(e){e.Entities.forEach(function(e){l.add(e.EntityId)})})}),o=Array.from(l)}catch(e){}return u=!1,r.has(T)?(h=r.get(T),[4,this._delayedAnnotateText(h,null===(i=null===x.e||void 0===x.e?void 0:x.e.fields)||void 0===i?void 0:i.Title,n)]):[3,2];case 1:if(b=I.sent(),u=u||b.hasAnnotatedContent,b.alreadyAnnotated)return[2,{canvasControls:e,topicIds:o,contentAnnotated:u}];document.dispatchEvent(new CustomEvent(d.TopicConstants.onAnnotateTitleEventName,{detail:b.innerHTML})),I.label=2;case 2:return r.has("e9ee7242-273c-473f-bfa5-149b32873501")?(h=r.get("e9ee7242-273c-473f-bfa5-149b32873501"),(f=this._getDefinitionContent())?[4,this._delayedAnnotateText(h,f,n)]:[3,4]):[3,4];case 3:b=I.sent(),u=u||b.hasAnnotatedContent,document.dispatchEvent(new CustomEvent(c.ANNOTATE_DEFINITION,{detail:b.innerHTML})),I.label=4;case 4:I.trys.push([4,9,10,11]),p=Object(a.__values)(e),m=p.next(),I.label=5;case 5:return m.done?[3,8]:(_=m.value).controlType===s.CanvasControlType.RTE&&r.has(_.id)?(h=r.get(_.id),[4,this._delayedAnnotateText(h,_.innerHTML,n)]):[3,7];case 6:if(b=I.sent(),u=u||b.hasAnnotatedContent,b.alreadyAnnotated)return[2,{canvasControls:e,topicIds:o,contentAnnotated:u}];_.innerHTML=b.innerHTML,I.label=7;case 7:return m=p.next(),[3,5];case 8:return[3,11];case 9:return g=I.sent(),S={error:g},[3,11];case 10:try{m&&!m.done&&(D=p.return)&&D.call(p)}finally{if(S)throw S.error}return[7];case 11:return v=t.filter(function(e){var t;return(null===(t=e.Matches)||void 0===t?void 0:t.length)>0}),y=v.filter(function(e){return e.ComponentId===T||"e9ee7242-273c-473f-bfa5-149b32873501"===e.ComponentId}).length,this._postAnnotationActionsRequired=y===v.length,[2,{canvasControls:e,topicIds:o,contentAnnotated:u}]}})})},e.prototype._delayedAnnotateText=function(e,t,n){var a=this;return U()?w(function(){return a._annotateText(e,t,n)},{reportDurationCallback:F("AnnotateText")}):this._annotateText(e,t,n)},e.prototype._annotateText=function(t,n,i){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,s,c,d,l,u,f,p,m,_,h;return Object(a.__generator)(this,function(b){switch(b.label){case 0:if(r=!1,!n)return[3,11];if((s=n.trim())===D.a||s===D.i)return[2,{innerHTML:n,alreadyAnnotated:!1,hasAnnotatedContent:r}];if(-1!==n.indexOf(g.n.kmTopicIdAttribute))return[2,{innerHTML:n,alreadyAnnotated:!0,hasAnnotatedContent:r}];this._annotateAtleastOne++,c=x.e.fields,b.label=1;case 1:b.trys.push([1,8,9,10]),d=Object(a.__values)(t.sort(function(e,t){return t.Start-e.Start})),l=d.next(),b.label=2;case 2:return l.done?[3,7]:(u=l.value,(f=Object(I.a)(u.Entities[0].EntityId,i))?(null==c?void 0:c.EntityId)&&((null==f?void 0:f.AncestorIds)||[]).concat(f.Id).includes(c.EntityId)||this._isSameWithCurrentPageTopic(f)?[3,4]:[4,this._delayedAnnotateHtmlChunk(n,f,u)]:[3,5]);case 3:p=b.sent(),n=p.html,r=r||p.hasAnnotatedHtml,b.label=4;case 4:return[3,6];case 5:o._TraceLogger.logError(e._logSource,new Error("Topic Entity missing form response Entity id: "+u.Entities[0].EntityId)),b.label=6;case 6:return l=d.next(),[3,2];case 7:return[3,10];case 8:return m=b.sent(),_={error:m},[3,10];case 9:try{l&&!l.done&&(h=d.return)&&h.call(d)}finally{if(_)throw _.error}return[7];case 10:case 11:return[2,{innerHTML:n,alreadyAnnotated:!1,hasAnnotatedContent:r}]}})})},e.prototype._filterRepeatingMatchesandHiddenTopics=function(e,t){var n,i,r,o,s;if(this._shouldAnnotateDuplicates)return e;var c=[],d=new Set([]),l=new Set([]),u=this._getAnnotatedElements(!0);d=new Set(u.map(P)),l=new Set(u.map(function(e){return e.innerText}));try{for(var f=Object(a.__values)(e),p=f.next();!p.done;p=f.next()){var m=p.value,_={ComponentId:m.ComponentId,Matches:[]},h=function(e){var n,i,r=e.Entities[0].EntityId,o=null==t?void 0:t.find(function(e){return e.Id===r});if(Object(A.c)()&&b._hiddenTopicIds.forEach(function(e){d.has(e)||d.add(e)}),!d.has(r)){var c=e.HighlightedName;if(l.has(c))return b._automaticTopicEntities.delete(o),"continue";if(o){var u=(null===(s=o.AlternateNames)||void 0===s?void 0:s.map(function(e){return e.Name}))||[];u.push(o.DisplayName);var f=!1;try{for(var p=(n=void 0,Object(a.__values)(u)),m=p.next();!m.done;m=p.next()){var h=m.value;if(l.has(h)){f=!0;break}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}if(f)return"continue";l=new Set(Object(a.__spreadArray)(Object(a.__spreadArray)([],Object(a.__read)(l),!1),Object(a.__read)(u),!1))}d.add(r),_.Matches.push(e)}},b=this;try{for(var g=(r=void 0,Object(a.__values)(m.Matches)),v=g.next();!v.done;v=g.next())h(v.value)}catch(e){r={error:e}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(r)throw r.error}}c.push(_)}}catch(e){n={error:e}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}return c},e.prototype._delayedAnnotateHtmlChunk=function(e,t,n){var a=this;return U()?w(function(){return a._annotateHtmlChunk(e,t,n)},{reportDurationCallback:F("AnnotateHtmlChunk")}):this._annotateHtmlChunk(e,t,n)},e.prototype._annotateHtmlChunk=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d;return Object(a.__generator)(this,function(a){return this._annotationCount++,this._countAnnotationDetails(t.Id,t.Url),r=n.Start+n.Length,this._isAnnotationInsideSpecialHTMLTag(e,n.Start,n.Length)?(this._automaticTopicEntities.delete(t),[2,{html:e,hasAnnotatedHtml:!1}]):(o=e.slice(n.Start,r),(s=this._balanceHTMLInsideAnnotation(o))?(o=s,c=i.Text.format(D.G,o),d="<span\n           ".concat(g.n.kmTopicIdAttribute,"='").concat(t.Id,"'\n           data-sp-topic-name='").concat(this._encodeQuotes(t.DisplayName),"'\n           role='button'\n           aria-haspopup='true'\n           tabindex='0'\n           aria-label='").concat(c,"'\n           ").concat(I.e,"='").concat(t.RelevanceScore,"'\n         >").concat(o,"</span>"),[2,{html:e.slice(0,n.Start)+d+e.slice(r),hasAnnotatedHtml:!0}]):(this._automaticTopicEntities.delete(t),[2,{html:e,hasAnnotatedHtml:!1}]))})})},e.prototype._isAnnotationInsideSpecialHTMLTag=function(e,t,n){var a=e.slice(0,t),i=e.slice(t,n),r="&"===a[a.length-1]&&(0===i.indexOf("amp")||0===i.indexOf("nbsp")||0===i.indexOf("lt")||0===i.indexOf("gt"));return!(a.lastIndexOf("<a ")<=a.lastIndexOf("</a>")&&a.lastIndexOf("<s>")<=a.lastIndexOf("</s>")&&!r)},e.prototype._balanceHTMLInsideAnnotation=function(e){var t,n,i=e,r=e.match(/<\/\w+>/gi);if(r)try{for(var o=Object(a.__values)(r),s=o.next();!s.done;s=o.next()){var c=s.value,d=i.indexOf(c),l=c.replace("</","<"),u=i.indexOf(l);if(!(d<u))return;i=(i=i.slice(0,u)+i.slice(u+l.length)).slice(0,d)+i.slice(d+c.length)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}if(!/<\/*\w+>/gi.test(i))return i},e.prototype._logAnnotations=function(t,n){void 0===n&&(n=!1),n&&this._scenarioQos.addStage(b.e.BeginLogAnnotations),o._TraceLogger.logVerbose(e._logSource,"Number of expected annotations on this page ".concat(this._annotationCount));var i=Object(a.__assign)({AnnotationPageAttempt:this._annotationAttemptCount.toString(),AnnotatePageAtleastOnce:this._annotateAtleastOne.toString(),AnnotationCount:this._annotationCount.toString(),HashtaggedAnnotationCount:this._hashtaggedAnnotationCount.toString(),Duration:(Date.now()-this._annotationStartTime).toString()},{TopicIds:JSON.stringify(t)});for(var r in this._annotationCounts)this._annotationCounts.hasOwnProperty(r)&&(i[r+"AnnotationCount"]=this._annotationCounts[r].toString());Object(d.logEngagement)("AnnotateTopics",g.n.kmAnnotateLogPrefix,i),n&&this._scenarioQos.addStage(b.e.LogAnnotationsComplete)},Object.defineProperty(e.prototype,"_shouldAnnotateDuplicates",{get:function(){return new URL(window.location.href).searchParams.has("annotateDuplicates")},enumerable:!1,configurable:!0}),e.prototype._annotateHashtaggedTopicIds=function(t,n){var a=this;void 0===n&&(n=!1);var i=document.querySelectorAll(g.n.hashtaggedTopicQueryAllSelector),r=Array.prototype.slice.call(i);if(0===r.length)return Promise.resolve();var s=new o._QosMonitor("".concat(g.n.kmAnnotateLogPrefix,".Hashtagged.DP")),c=r.map(P);return this._fetchHashTaggedTopicsInBatch(t,c).then(function(e){return a._manualTopicEntities=new Set(e),a._handleHashTaggedTopicsLoaded(e,r,n).then(function(){s.writeSuccess(),a._logAnnotations(c)})}).catch(function(t){if(r.forEach(a._deannotateHashTaggedElement),o._TraceLogger.logError(e._logSource,t,"Failed to annotate hashtagged topic"),s.writeUnexpectedFailure("FetchHashTaggedTopicsFailed",t),Object(E.t)()){var n=Object(k.u)()?h.e.ManualInlineRenderFailed:_.e.ManualTagLoadFailed;Object(d.logASHAError)(a._engagementLogger,n,{errorName:"FetchHashTagggedTopicsFailed",error:t})}})},e.prototype._handleHashTaggedTopicsLoaded=function(e,t,n){return void 0===n&&(n=!1),Object(a.__awaiter)(this,void 0,void 0,function(){var r,o=this;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return r=[],[4,f.e.set(e,!0)];case 1:return s.sent(),[4,Promise.all(t.map(function(t){return Object(a.__awaiter)(o,void 0,void 0,function(){var o,s,c,d;return Object(a.__generator)(this,function(a){if(o=P(t),s=Object(I.a)(o,e),c=!!s&&"Removed"===(null===(d=s.LifeCycle)||void 0===d?void 0:d.State),s&&!c){if(r.push(s),Object(A.c)()&&n)return i._SPEventManager.instance.raiseEvent(v.a,{}),[2];this._annotateSingleHashTaggedTopic(t,o,s)}else{if(Object(A.c)()&&n)return i._SPEventManager.instance.raiseEvent(v.a,{}),[2];this._deannotateHashTaggedElement(t)}return[2]})})})).then(function(){Object(A.c)()&&r.length>0&&o._dispatchHighlightedTopics([],r,!0)}).catch(function(e){var t;null===(t=o._scenarioQos)||void 0===t||t.qosMonitor.writeUnexpectedFailure("FailedGetHashTagTopics",e)})];case 2:return s.sent(),Object(d.logEngagement)("HashtaggedAnnotations",g.n.kmAnnotateLogPrefix,{hashtaggedElements:t.length.toString(),renderedHashtaggedAnnotations:this._hashtaggedAnnotationCount.toString(),topicIds:Object(O.e)()?"":e.map(function(e){return e.Id}).join(","),numberOfTopics:Object(O.e)()?"":e.length.toString()}),[2]}})})},e.prototype._deannotateHashTaggedElement=function(e){Object(I.t)(e),e.setAttribute("role","Text")},e.prototype._annotateSingleHashTaggedTopic=function(e,t,n){if(e.querySelector("[".concat(g.n.kmTopicIdAttribute,"]"))){var a=e.innerText;e.innerHTML=a}this._annotationCount++,this._hashtaggedAnnotationCount++,this._countAnnotationDetails(t,n.Url)},e.prototype._processAndLog=function(e,t,n,a,i){var r=this;return void 0===i&&(i=!1),U()?w(function(){return r._processResponse(e,t,i).then(function(e){var t=e.canvasControls,o=e.topicIds,s=e.contentAnnotated;return r._logAnnotations(o,i),{content:t,pageId:n,siteId:a,contentAnnotated:s}})},{reportDurationCallback:F("ProcessResponse")}):this._processResponse(e,t,i).then(function(e){var t=e.canvasControls,o=e.topicIds,s=e.contentAnnotated;return r._logAnnotations(o,i),{content:t,pageId:n,siteId:a,contentAnnotated:s}})},e.prototype._annotateUsingSubstrateAPI=function(e,t,n,a,r,o,s){var c=this;void 0===s&&(s=!1);var l=new d._SubstrateAnnotationDataProvider(e.serviceScope,o);return l.getAnnotations(t,y.e.getSPOId()).then(function(t){C.n({step:"APICall",resultType:u.t.Success});var o=Object(d.translateAnnotationResponse)(t);return c._automaticTopicEntities=new Set(o.EntityDetails),c._clientRequestId=l.clientRequestId?l.clientRequestId:"",Object(A.c)()?Object(M.t)(e.serviceScope).then(function(e){var t,d,l;if(c._hiddenTopicIds=new Set(e),!(o.EntityDetails&&(null===(t=o.EntityDetails)||void 0===t?void 0:t.length)>0&&(c._dispatchHighlightedTopics(e,o.EntityDetails,!1),s||!(null===(d=x.e.vivaTopicsPaneState)||void 0===d?void 0:d.isHighlightsListEnabled))))return null===(l=o.EntityDetails)||void 0===l||l.forEach(function(t){t.Id&&(null==e?void 0:e.includes(t.Id))&&c._automaticTopicEntities.delete(t)}),c._processAndLog(o,n,a,r);s?i._SPEventManager.instance.raiseEvent(v.a,{}):i._SPEventManager.instance.raiseStickyEvent(v.e,{})}):c._processAndLog(o,n,a,r)}).catch(function(e){var t;throw c._clientRequestId=null!==(t=l.clientRequestId)&&void 0!==t?t:"",Object(A.c)()&&!s&&C.n({step:"APICall",resultType:u.t.UnexpectedFailure,errorTag:"GetAnnotationsTopicHVCFailure",error:e,shouldComplete:!0}),e})},e.prototype._countAnnotationDetails=function(e,t){var n=(null==t?void 0:t.length)?d.CuratedTypes.Curated:d.CuratedTypes.NotCurated,a=Object(d.topicOrigin)(e);this._increaseCount(a),this._increaseCount(n),this._increaseCount(a+n)},e.prototype._increaseCount=function(e){this._annotationCounts[e]=this._annotationCounts[e]?this._annotationCounts[e]+1:1},e.prototype._fetchHashTaggedTopicsInBatch=function(e,t){this._substrateGetTopicsByIdsDataProvider||(this._substrateGetTopicsByIdsDataProvider=new d._SubstrateGetTopicsByIdsDataProvider(e));var n=e.consume(l.PageContext.serviceKey).cultureInfo.currentUICultureName;return this._substrateGetTopicsByIdsDataProvider.fetchTopics(t,{language:n})},e.prototype._getDefinitionContent=function(){var e=this;this._topicPageDefinition=void 0;var t=(null===x.e||void 0===x.e?void 0:x.e.fields).LayoutWebPartsDataMap;if(t&&t.size>0)return t.forEach(function(t){var n,a;"e9ee7242-273c-473f-bfa5-149b32873501"===t.id&&(e._topicPageDefinition=null===(a=null===(n=t.serverProcessedContent)||void 0===n?void 0:n.searchablePlainTexts)||void 0===a?void 0:a.content)}),this._topicPageDefinition},Object.defineProperty(e.prototype,"_topicDataService",{get:function(){return S.e.instance.serviceScope.consume(c.TopicDataService.serviceKey)},enumerable:!1,configurable:!0}),e.prototype._isSameWithCurrentPageTopic=function(e){var t=this._topicDataService.currentTopic;return!!t&&Object(d.isSameTopic)(t,e)},e._logSource=o._LogSource.create("TopicAnnotator"),e}();t.default=H},pWQT:function(e){e.exports=JSON.parse('{"i":"Edit {0} to add a definition.","a":"Contribute to {0} by adding a description.","Z":"Topic","m":"Edit","W":"Multilingual","Q":"Multilingual is currently disabled. Edit and publish this topic to enable additional language options.","q":"Multilingual is currently disabled. Return to the default language page to enable additional language options.","g":"Failed to render topic page","E":"Are you sure you want to leave? Your changes will not be saved.","G":"Topic {0}.","y":"Topics","J":"When you go back, try searching on the topic name. We couldn\\u0027t find a topic at this address.","v":"Feedback","Y":"This topic isn\\u0027t visible to everyone yet. When it\\u0027s published it will be.","z":"Ask a Knowledge Administrator to assign a Viva Topics license to you. We can\\u0027t show you a topic without one.","N":"Edit and publish this topic on the {0} to enable {1}.","R":"default language page ({0})","C":"You are viewing the {0} topic page for {1}.","x":"You are currently editing the {0} topic page for {1}. Certain properties can only be edited from the {2}.","I":"You are currently editing the {0} topic page for {1}.","c":"default language page","d":"You are viewing {0}\\u0027s default language page ({1}).","s":"You are currently editing {0}\\u0027s default language page ({1}). Publish this page to enable {2}.","V":"this topic","H":"You\\u0027ve opted out of answering questions from colleagues on this topic.","F":"We couldn\\u0027t complete this action. Please try again later.","o":"Some information is no longer available","r":"Information from this topic is missing because the default language page for this topic has been deleted. To reinstate the missing information, restore the {0} topic page from the recycle bin. Otherwise, you can choose to keep or delete your current topic page.","D":"This page isn\\u0027t available","S":"The requested language for this page isn\\u0027t supported. View this topic page in an available language.","B":"Restore","e":"Close","_":"Preparing your page for editing…","n":"There was a problem creating the {0} topic page. Review language settings and try again.","w":"{0} language variation","O":"{0} has {1} language variations. Select the language variation you want to use for this topic.","j":"Submit","U":"Save changes made to this page","T":"Your editing session has not been saved. To save your changes choose to publish this page or save your draft.","X":"{0} - This topic has been merged with {1}. You can see this topic page because you\\u0027re a knowledge manager.","K":"This topic is in the process of merging. {0}.","M":"Learn more","b":"You cannot edit this page","h":"This topic is currently in the process of being merged with another topic.","k":"Merged","t":"Copilot","p":"Publish your topic page","f":"To update the topic page, remember to publish your changes. If your edit session ends due to inactivity, a draft will be automatically saved.","u":"Continue","l":"Don\\u0027t show this again","L":"You\\u0027ve locked this topic page for editing. Publish or discard your draft to unlock the page.","P":"You have an active draft for this topic page. Publish your draft to update this topic.","A":"Go to the draft"}')},slaT:function(e,t,n){"use strict";function a(){return n.e(162).then(n.bind(null,"23xC"))}n.d(t,"e",function(){return a})},xEY6:function(e,t,n){"use strict";var a=n("yHPm");n.d(t,"e",function(){return a.e})},xw5y:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("UWqr"),i="stage_",r={BeginRenderAnnotations:"".concat(i,"beginRenderAnnotations"),BeginRenderAnnotatedContent:"".concat(i,"beginRenderAnnotatedContent"),UpdateFieldsComplete:"".concat(i,"updateFieldsComplete"),RenderAnnotationFailure:"".concat(i,"renderAnnotationFailure"),AnnotationsNotNeeded:"".concat(i,"annotationsNotNeeded"),BeginTopicAnnotator:"".concat(i,"beginTopicAnnotator"),BeginCallSubstrateAPI:"".concat(i,"beginCallSubstrateAPI"),BeginCallSPHomeAPI:"".concat(i,"beginCallSPHomeAPI"),BeginProcessResponse:"".concat(i,"beginProcessResponse"),TopicCacheUpdated:"".concat(i,"topicCacheUpdated"),FilteredRepeatMatchesComplete:"".concat(i,"filteredRepeatMatchesComplete"),AnnotatedHtmlComplete:"".concat(i,"annotatedHtmlComplete"),BeginLogAnnotations:"".concat(i,"beginLogAnnotations"),LogAnnotationsComplete:"".concat(i,"logAnnotationsComplete"),NoAnnotationsWritten:"".concat(i,"noAnnotationsWritten"),UnitTests:"".concat(i,"unitTests")},o=function(){function e(e,t){a.Validate.isNotNullOrUndefined(e,"qosMonitor"),a.Validate.isNotNullOrUndefined(t,"stage"),this._qosMonitor=e,this._qosMonitor.extraData||(this._qosMonitor.extraData={}),this.addStage(t)}return Object.defineProperty(e.prototype,"qosMonitor",{get:function(){return this._qosMonitor},enumerable:!1,configurable:!0}),e.prototype.addStage=function(e){a.Validate.isNotNullOrUndefined(e,"stage"),this._qosMonitor.extraData[e]=(new Date).toISOString()},e}();t.t=o},yHPm:function(e,t,n){"use strict";function a(e){return new Promise(function(t,n){e.onsuccess=function(){return t(e.result)},e.onerror=function(){return n(e.error)}})}function i(e){return new Promise(function(t,n){e.oncomplete=function(){return t()},e.onerror=function(){return n(e.error)}})}n.d(t,"e",function(){return u});var r,o=n("17wl"),s=function(){function e(){this._cache=new Map}return e.prototype.get=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(t){return[2,this._cache.get(e)]})})},e.prototype.set=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){var t=this;return Object(o.__generator)(this,function(n){return e.forEach(function(e){t._cache.set(e.key,e.topicEntity)}),[2]})})},e.prototype.remove=function(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(t){return this._cache.delete(e),[2]})})},e}();function c(){return r||(r=function(e,t,n){var i=indexedDB.open("topics-db",void 0);i.onupgradeneeded=function(e){var n=e.target.result;n.objectStoreNames.contains(t)||n.createObjectStore(t)};var r=a(i);return function(e){return r.then(function(n){return n.transaction(t,e).objectStore(t)})}}(0,"topics")),r}var d=function(){function e(){}return e.prototype.get=function(e){var t=this;return c()("readonly").then(function(n){return a(n.get(e)).then(function(n){if(n){if(n.ExpireTimeStamp&&n.ExpireTimeStamp>Date.now())return n.TopicEntity;t.remove(e)}})})},e.prototype.set=function(e){return c()("readwrite").then(function(t){return e.forEach(function(e){t.put({TopicEntity:e.topicEntity,ExpireTimeStamp:Date.now()+864e5},e.key)}),i(t.transaction)})},e.prototype.remove=function(e){return c()("readwrite").then(function(t){return a(t.delete(e))})},e.prototype.removeAllExpired=function(){return Object(o.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(o.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c()("readwrite")];case 1:return(e=n.sent()).openCursor().onsuccess=function(){if(this.result){var t=this.result.value;t&&t.ExpireTimeStamp&&t.ExpireTimeStamp<=Date.now()&&e.delete(this.result.key),this.result.continue()}},[2,i(e.transaction)];case 2:return t=n.sent(),[2,Promise.reject(t)];case 3:return[2]}})})},e}();function l(e,t){return e+(t?":".concat(t.toLowerCase()):"")}var u=new(function(){function e(){this._cacheProviderPromise=("undefined"==typeof indexedDB?Promise.resolve(!1):new Promise(function(e){var t="verify-indexeddb-support",n=indexedDB.open(t);n.onerror=function(){indexedDB.deleteDatabase(t),n=null,e(!1)},n.onsuccess=function(){indexedDB.deleteDatabase(t),n=null,e(!0)}})).then(function(e){return e?(n=new d,t=function(){n.removeAllExpired()},"undefined"!=typeof requestIdleCallback?requestIdleCallback(function(e){t()}):"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(function(){return t()}):setTimeout(function(){return t()},0),n):new s;var t,n})}return e.prototype.setCacheProvider=function(e){this._cacheProviderPromise=Promise.resolve(e)},e.prototype.get=function(e,t){return this._cacheProviderPromise.then(function(n){return n.get(l(e,t))})},e.prototype.set=function(e,t){var n=[];return e.forEach(function(e){var a;n.push({topicEntity:e,key:t?l(e.Id,e.CurrentLanguage):e.Id}),null===(a=e.AncestorIds)||void 0===a||a.forEach(function(a){n.push({topicEntity:e,key:t?l(a,e.CurrentLanguage):a})})}),this._cacheProviderPromise.then(function(e){return e.set(n)})},e.prototype.remove=function(e){return this._cacheProviderPromise.then(function(t){return t.remove(e)})},e}())}}]);