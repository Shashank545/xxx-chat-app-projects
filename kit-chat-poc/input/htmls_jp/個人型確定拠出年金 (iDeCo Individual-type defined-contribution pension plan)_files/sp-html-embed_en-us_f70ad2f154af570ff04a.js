define("3fbad3f4-a628-41b0-8694-2054c09edccd_1.0.3",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-loader","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","react","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"5pbq":function(e,t){e.exports=i},I6O9:function(e,t){e.exports=r},Pk8u:function(e,t){e.exports=o},UWqr:function(e,t){e.exports=s},"X+PM":function(e,t){e.exports=c},cDcd:function(e,t){e.exports=d},"hiL/":function(e,t){e.exports=l},jOlS:function(e,t){e.exports=u},mGD9:function(e){var t=e.exports=JSON.parse('{"ContentEmbedTitle":"Embed","VideoEmbedTitle":"Office 365 Video","ContentEmbedCode":"WebSite address or embed code","ContentEmbedLabel":"You can display content from some websites simply by pasting the address below. If that doesn\\u0027t work, you\\u0027ll need to paste the embed code instead.","VideoEmbedVideoLabel":"Display an Office 365 video on your page. Find the video you want on the Office 365 video portal, and then paste its web address below.","VideoEmbedURL":"Video address","VideoEmbedShowInfo":"Show title and video info","InvalidVideoURL":"This address doesn\\u0027t seem to be an Office 365 video. Check the address and try again.","UseIframeTag":"This embed code doesn\\u0027t seem to work. We only support iframe based embeds.","IllegalRenderErrorMessage":"We can\\u0027t show this embedded content because the code seems to be incomplete. Make sure that the embed code includes width, height and a valid address for the src attribute.","SrcCheckWaitingTips":"Verifying the Office 365 video...","HTMLEmbedWebPartAriaLabel":"Press enter or the Down arrow key to enter the embedded content.","IllegalSrc":"Embedding content from this website isn\\u0027t allowed. This is a setting your admin can change.","BasicGroupName":"Basic","DisplayGroupName":"Display","SourceCheckFormatError":"We can\\u0027t verify this Office 365 video file.","EmptyPlaceholderContentEmbedWebPartIconLabel":"Embed","EmptyPlaceholderContentEmbedWebPartDescription":"Enrich your page by displaying content from other websites. For example, you can embed a YouTube video, or show Bing Maps for people to get directions. ","EmptyPlaceholderEmbededVideoWebPartIconLabel":"Office 365 Video","EmptyPlaceholderEmbededVideoWebPartDescription":"Display a video from your organization\\u0027s Office 365 Video channels, so people can watch it directly on your page.","OpenPropertyPaneButtonLabel":"Add embed code","AddVideoButtonLabel":"Add video","AddEmbedCodeButtonLabel":"Add embed code","CaptionPlaceholder":"Add a caption","UseHTTPS":"We only support embedding content from secure websites (their addresses start with https.) If it\\u0027s important to embed content from unsecured websites, please send us feedback.","DisableEmbed":"The owner of this content doesn\\u0027t allow embedding.","LearnMore":"Learn More","HintTextForEmbedScreenReader":"Paste either website address or embed code here","HintTextForEmbed":"https://www.youtube.com/watch?v=...\\nor\\n<iframe width=\\u0022853\\u0022 height=\\u0022480\\u0022...","HintTextForVideoScreenReader":"Paste Office 365 video address here","AccessibleHintTextTemplate":"{0} {1}.","HintTextForVideo":"https://contoso.sharepoint.com/portals/hub/...","EmbedSuccessPrompt":"Embedded the content successfully","VideoEmbedSuccessPrompt":"Embedded the video successfully","UnsupportedEmbedUrl":"This website doesn\\u0027t support embedding using just the address. Try pasting the embed code instead. If it\\u0027s important to embed from this site using just the address, please send us feedback.","TextAreaHint":"This is a multiline text box.","VideoChannelUrlName":"Go to your organization\\u0027s video portal","OnlyChannelUrlError":"This seems like the web address for a video channel, which can contain several videos. Click on the video you want to display from that channel and paste that address instead.","FitToWidth":"Resize to fit the page","NotSettingEmbedableService":"Have not set embedableService","HTMLEmbedBoundingRectZero":"Bounding Zone of HTMLEmbed is 0","ThumbnailLoadError":"Fail to access image source from thumbnail URL","ThumbnailAriaLabel":"{0} home"}');t.default=t},mwqp:function(e,t,n){"use strict";var a,i,r;n.r(t),n.d(t,"EmbedCodeType",function(){return a}),n.d(t,"EmbedCodeShownType",function(){return i}),n.d(t,"EmbedDataSourceType",function(){return r}),n.d(t,"HTMLEmbed",function(){return T}),n.d(t,"EmbeddableServiceFactory",function(){return R}),n.d(t,"EmbedServiceResponseCode",function(){return p}),n.d(t,"getEmbedServiceClassName",function(){return m}),n.d(t,"HtmlValidator",function(){return h}),n.d(t,"SPEmbeddableService",function(){return H}),n.d(t,"O365VideoEmbeddableService",function(){return N}),n.d(t,"O365VideoIframeUtilities",function(){return B}),function(e){e[e.Url=0]="Url",e[e.VanillaHtml=1]="VanillaHtml"}(a||(a={})),function(e){e[e.BingPreviewStyle=0]="BingPreviewStyle",e[e.ContentStyle=1]="ContentStyle"}(i||(i={})),function(e){e[e.RawDataSource=1]="RawDataSource",e[e.DataProvider=2]="DataProvider"}(r||(r={}));var o,s=n("17wl"),c=n("cDcd"),d=n("hiL/"),l=n("y88i"),u=n("Pk8u"),f=n("ut3N"),p={OK:0,EmbedServiceInternalError:1,NoSupportedEmbedService:2,GetEmbedCodeError:3,SharePointPageNoPermission:4,NotAllowEmbed:5};function m(e){return e?e.constructor.toString().match(/\w+/g)[1]:""}!function(e){e.photo="photo",e.video="video",e.link="link",e.rich="rich",e.unknown="unknown"}(o||(o={}));var _=n("5pbq"),h=function(){function e(){}return e.prototype.validate=function(e){var t=this;return this._internalValidate(e).then(function(n){return!n.isValid&&t._successorValidator?t._successorValidator._internalValidate(e):n}).catch(function(e){return e})},e.prototype.setSuccessorValidator=function(e){this._successorValidator=e},e}(),b=function(e){function t(t){var n=e.call(this)||this;return n._htmlGeneratorProps=t,n}return Object(s.__extends)(t,e),t.prototype.getMaxWidthStyle=function(){return{maxWidth:this.getWidth()}},t.prototype.getPaddingBottomStyle=function(){var e=this.getWidth(),t=this.getHeight();return{paddingBottom:100*(e?t/e:0)+"%"}},t.prototype.setMobileMode=function(e){this._htmlGeneratorProps.isNarrowContainer=e},t.prototype.setVariantTheme=function(e){this._htmlGeneratorProps.variantTheme=e},t.prototype.setAltText=function(e){this._htmlGeneratorProps.altText=e},t.prototype.setContainerRect=function(e){this._htmlGeneratorProps.htmlEmbedRect=e},t}(h),g=function(){function e(){}return e.createHTMLElement=function(t,n,a){var i=e._createSafeHTMLElement(t.vanillaHtml,n,a);if(i){i.setAttribute("tabindex","-1"),e.moveRectFromStyle2Attribute(i);var r=e.getScaledDomRect(i,t.htmlEmbedRect,t.shouldScale);r&&r.width&&i.setAttribute("width",r.width.toString()),r&&r.height&&i.setAttribute("height",r.height.toString())}return i},e.createElementByTagName=function(e,t){var n=document.createElement("div");return n.innerHTML=e,n.getElementsByTagName(t)[0]},e.getScaledDomRect=function(e,t,n){if(e){var a={width:parseInt(e.getAttribute("width"),10),height:parseInt(e.getAttribute("height"),10)};if(!(a.width<=0||a.height<=0||isNaN(a.width)||isNaN(a.height))){(!t||t.width<=0||t.height<=0)&&(t=a);var i=-1===e.getAttribute("width").indexOf("%")?a.width:t.width*(a.width/100),r=-1===e.getAttribute("height").indexOf("%")?a.height:t.height*(a.height/100);return{width:Math.ceil(n?t.width:i),height:Math.ceil(n?t.width*(r/i):r)}}}},e.moveRectFromStyle2Attribute=function(t){e._moveStylePropertyToAttribute(t,"width"),e._moveStylePropertyToAttribute(t,"height")},e.scaleZeroRectByRatio=function(e,t){var n=e;return!e||e.width<=0&&e.height<=0||(e.width<=0&&(n.width=e.height*t),e.height<=0&&(n.height=e.width/t)),n},e.getHostnameFromUrl=function(e){var t="";if(e){var n=/^\s*(http:\/\/|\/\/|https:\/\/)[^\/]+/i.exec(e);n&&n.length&&(t=n[0].replace(/^\s*(http:\/\/|\/\/|https:\/\/)/i,""))}return t},e._createSafeHTMLElement=function(t,n,a){var i=e.createElementByTagName(t,n);if(!i)return i;for(var r=[],o=function(e){var t=i.attributes[e],n=!1;a.forEach(function(e){t.name===e.toLowerCase()&&(n=!0)}),n||r.push(t.name)},s=0;s<i.attributes.length;s++)o(s);return r.map(function(e){i.removeAttribute(e)}),i.innerHTML="",i},e._moveStylePropertyToAttribute=function(t,n){if(t.style&&t.style[n]){var a=t.style[n];t.setAttribute(n,/em$/i.test(a)?e._convertEmToPx(a):a),t.style.removeProperty(n)}},e._getEmPxScaleRate=function(){return parseInt(window.getComputedStyle(document.body,void 0).getPropertyValue("font-size"),10)||16},e._convertEmToPx=function(t){return(parseInt(t,10)*e._getEmPxScaleRate()).toString()},e}(),v=n("mGD9"),y=n("jOlS");y.loadStyles('.a_a_87677f78{margin:0 auto}.a_a_87677f78 .b_a_87677f78 iframe{height:100%;left:0;position:absolute;right:0;top:0;width:100%}.a_a_87677f78 .b_a_87677f78 iframe,.a_a_87677f78 .c_a_87677f78{border:none;display:block;margin:0 auto}.a_a_87677f78 [contentEditable=true]:empty:before{color:"[theme:neutralSecondaryAlt, default: #8a8886]";content:attr(placeholder);display:block}.b_a_87677f78{border:none;display:block;height:0;overflow:hidden;position:relative}.e_a_87677f78{background-color:"[theme:black, default: #000000]"}',!0);var S=function(e){function t(n){var a=e.call(this,n)||this;return a._createBorderRef=function(e){a._borderDiv=e},a._handleKeyDown=a._handleKeyDown.bind(a),n.vanillaHtml&&(a._htmlGeneratorProps.htmlEmbedRect=g.scaleZeroRectByRatio(a._htmlGeneratorProps.htmlEmbedRect,t._defaultWidthHeightScale),a._htmlElement=g.createHTMLElement(n,t._tagName,t._safeAttributes),a._htmlElement&&!a._htmlElement.getAttribute("allowfullscreen")&&a._htmlElement.setAttribute("allowfullscreen","")),a}return Object(s.__extends)(t,e),t.prototype.createHtmlElement=function(){var e=Object(_.css)("a_a_87677f78",this._htmlGeneratorProps.className);return c.createElement("div",{className:e,style:this.getMaxWidthStyle()},c.createElement("div",{role:"row",className:"b_a_87677f78","data-automation-id":"embedCode",tabIndex:0,style:this.getPaddingBottomStyle(),onKeyDown:this._handleKeyDown,"aria-label":v.HTMLEmbedWebPartAriaLabel,ref:this._createBorderRef},c.createElement("div",{dangerouslySetInnerHTML:{__html:this.getFilteredVanillaHtml()}})))},t.prototype.getFilteredVanillaHtml=function(){return this._htmlElement?this._htmlElement.outerHTML:""},t.prototype.focus=function(){this._borderDiv&&this._borderDiv.focus()},t.prototype._internalValidate=function(e){var n=g.createElementByTagName(e,t._tagName);if(!n)return Promise.reject({isValid:!1,errorMessage:v.UseIframeTag});var a=t._srcProtocolRegExp.test(n.getAttribute("src")),i=parseInt(n.getAttribute("width"),10)&&t._widthAndHeightRegExp.test(n.getAttribute("width")),r=parseInt(n.getAttribute("height"),10)&&t._widthAndHeightRegExp.test(n.getAttribute("height"));return a&&i&&r?Promise.resolve({isValid:!0,errorMessage:""}):Promise.reject({isValid:!1,errorMessage:v.IllegalRenderErrorMessage})},t.prototype.getWidth=function(){return parseInt(this._htmlElement.getAttribute("width"),10)},t.prototype.getHeight=function(){return parseInt(this._htmlElement.getAttribute("height"),10)},t.prototype._handleKeyDown=function(e){if(e.keyCode===_.KeyCodes.enter||e.keyCode===_.KeyCodes.down){e.preventDefault();var t=e.target.firstChild.firstChild;t instanceof HTMLElement&&t.focus()}},t._defaultWidthHeightScale=1.5,t._tagName="iframe",t._srcProtocolRegExp=/^http:\/\/|^\/\/|^https:\/\//i,t._widthAndHeightRegExp=/^[0-9]+/i,t._safeAttributes=["align","frameborder","height","longdesc","marginheight","marginwidth","name","scrolling","src","srcdoc","width","allowfullscreen","class","style"],t}(b),D=function(e){function t(n){var a=e.call(this,n)||this;return a._createThumbnailRef=function(e){a._thumbnailLink=e},a._htmlGeneratorProps.htmlEmbedRect=g.scaleZeroRectByRatio(a._htmlGeneratorProps.htmlEmbedRect,t._defaultWidthHeightScale),a}return Object(s.__extends)(t,e),t.prototype.createHtmlElement=function(){var e=this.getWidth(),t=d.ThumbnailUrlGenerator.updateThumbnailWidth(this._htmlGeneratorProps.metadata.Thumbnail,e);return c.createElement("a",{href:t,target:"_blank",ref:this._createThumbnailRef,rel:"noreferrer"},c.createElement("img",{src:t,width:e,height:this.getHeight(),alt:"",role:"presentation"}))},t.prototype.getFilteredVanillaHtml=function(){return""},t.prototype.focus=function(){this._thumbnailLink&&this._thumbnailLink.focus()},t.prototype._internalValidate=function(e){return this._htmlGeneratorProps.metadata&&this._htmlGeneratorProps.metadata.Thumbnail?Promise.resolve({isValid:!0,errorMessage:""}):Promise.resolve({isValid:!1,errorMessage:v.IllegalRenderErrorMessage})},t.prototype.getWidth=function(){return this._htmlGeneratorProps.shouldScale&&this._htmlGeneratorProps.htmlEmbedRect.width?this._htmlGeneratorProps.htmlEmbedRect.width:500},t.prototype.getHeight=function(){return this._htmlGeneratorProps.shouldScale&&this._htmlGeneratorProps.htmlEmbedRect.height?this._htmlGeneratorProps.htmlEmbedRect.height:500},t._defaultWidthHeightScale=1.5,t}(b),I=n("UWqr"),x=n("I6O9"),C=n("2q6Q"),O=Object(_.classNamesFunction)(),w=function(e){var t=e.variantTheme;return{title:{color:t&&t.semanticColors.actionLink,selectors:{"&:focus":{color:t&&t.semanticColors.actionLinkHovered},"&:hover":{color:t&&t.semanticColors.actionLinkHovered}}},subTitle:{color:t&&t.semanticColors.bodySubtext},description:{color:t&&t.semanticColors.bodySubtext},dividerBorder:{borderTop:t&&"1px solid ".concat(t.semanticColors.bodyDivider),borderBottom:t&&"1px solid ".concat(t.semanticColors.bodyDivider)}}};y.loadStyles('.f_b_87677f78{display:flex;margin:8px 0;padding:20px 0;width:100%}.g_b_87677f78{flex-wrap:wrap;padding:0 0 20px}.g_b_87677f78.h_b_87677f78{flex-wrap:nowrap}.g_b_87677f78 .i_b_87677f78,.g_b_87677f78 .j_b_87677f78{margin-top:20px}.i_b_87677f78{display:block}[dir=ltr] .i_b_87677f78{margin-right:20px}[dir=rtl] .i_b_87677f78{margin-left:20px}.k_b_87677f78{outline:0;position:relative}.j_b_87677f78{min-width:1px}[dir=ltr] .j_b_87677f78{padding-right:30px}[dir=rtl] .j_b_87677f78{padding-left:30px}.l_b_87677f78{word-wrap:break-word;display:inline-block;width:100%}[dir=ltr] .l_b_87677f78{margin-right:20px}[dir=rtl] .l_b_87677f78{margin-left:20px}.m_b_87677f78:not(.n_b_87677f78){line-height:17px}.m_b_87677f78.n_b_87677f78{line-height:1.35em}.m_b_87677f78:not(.o_b_87677f78){font-size:17px;font-weight:300}.m_b_87677f78.o_b_87677f78{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.m_b_87677f78.p_b_87677f78:not(.n_b_87677f78){max-height:34px}.m_b_87677f78.p_b_87677f78.n_b_87677f78,.m_b_87677f78.p_b_87677f78:not(.n_b_87677f78){-webkit-box-orient:vertical;-webkit-line-clamp:2;box-sizing:content-box;display:-webkit-box;overflow:hidden}.m_b_87677f78.p_b_87677f78.n_b_87677f78{max-height:2.7em}.q_b_87677f78{margin:5px 0 10px}.q_b_87677f78:not(.o_b_87677f78){font-size:12px;font-weight:400}.q_b_87677f78.o_b_87677f78{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}.r_b_87677f78{word-wrap:break-word}.r_b_87677f78:not(.o_b_87677f78){font-size:13px;font-weight:400}.r_b_87677f78.o_b_87677f78{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]"}.r_b_87677f78.s_b_87677f78{white-space:break-spaces}.t_b_87677f78.f_b_87677f78{display:block}.t_b_87677f78 .j_b_87677f78{padding:10px 0 0}[dir=ltr] .t_b_87677f78 .i_b_87677f78,[dir=ltr] .t_b_87677f78 .l_b_87677f78{margin-right:0}[dir=rtl] .t_b_87677f78 .i_b_87677f78,[dir=rtl] .t_b_87677f78 .l_b_87677f78{margin-left:0}.u_b_87677f78{background:rgba(0,0,0,.45);border-radius:2px;bottom:0;color:#fff;font-size:12px;margin-bottom:8px;padding-bottom:4px;padding-top:4px;position:absolute;z-index:1}[dir=ltr] .u_b_87677f78{right:0}[dir=rtl] .u_b_87677f78{left:0}[dir=ltr] .u_b_87677f78{margin-right:8px}[dir=rtl] .u_b_87677f78{margin-left:8px}[dir=ltr] .u_b_87677f78{padding-left:3px}[dir=ltr] .u_b_87677f78,[dir=rtl] .u_b_87677f78{padding-right:3px}[dir=rtl] .u_b_87677f78{padding-left:3px}',!0);var E="k_b_87677f78",A="m_b_87677f78",L="o_b_87677f78",k=function(e){function t(t){var n=e.call(this,t)||this;return n._createTitleLinkRef=function(e){n._titleLink=e},n._createThumbnailRef=function(e){n._thumbnailLink=e},n._lessText=null,n.state={isValidUrl:!0,isLessTextLoaded:!1},n._loadLessText(),n}return Object(s.__extends)(t,e),t.prototype.render=function(){var e,n,a,i=O(w,{variantTheme:this.props.variantTheme}),r=Object(_.css)(this.props.className,"f_b_87677f78",i.dividerBorder,((e={}).t_b_87677f78=this.props.isNarrowContainer,e),"g_b_87677f78",((n={}).h_b_87677f78=this.props.isFlexNoWrap,n)),o=this.props.titleMetaDataOverride?this.props.titleMetaDataOverride:this.props.metadata.Title,d=Object(_.css)(A,"n_b_87677f78",i.title,L,t._shouldUseCssClamp&&"p_b_87677f78"),l=t._shouldUseCssClamp?c.createElement("div",{title:o,className:d,"data-automation-id":"metadataTitle"},o):!!this._lessText&&c.createElement(this._lessText,{text:o,className:Object(_.css)(A,i.title,L),autoShowTitle:!0,lines:2,omission:""});return c.createElement(_.Fabric,{className:r},this._renderThumbnail(),c.createElement("div",{className:"j_b_87677f78"},c.createElement(_.Link,Object(s.__assign)({className:"l_b_87677f78"},{href:this.props.originalUrl,target:"_blank"},{componentRef:this._createTitleLinkRef}),l),c.createElement("div",{className:Object(_.css)("q_b_87677f78",i.subTitle,L)},this._getHostname()),c.createElement("div",{className:Object(_.css)("r_b_87677f78",(a={},a.s_b_87677f78=this.props.isWhiteSpaceBreakSpaces,a),i.description,L),title:this.props.metadata.Description},this.props.metadata.Description)))},t.prototype.focus=function(){this._thumbnailLink?this._thumbnailLink.focus():this._titleLink&&this._titleLink.focus()},t.prototype._getHostname=function(){var e="";if(this.props.originalUrl){var t=/^\s*(http:\/\/|\/\/|https:\/\/)[^\/]+/i.exec(this.props.originalUrl);t&&t.length&&(e=t[0].replace(/^\s*(http:\/\/|\/\/|https:\/\/)/i,""))}return e},t.prototype._renderThumbnail=function(){if(this.props.metadata.Thumbnail&&this.state.isValidUrl){var e=new C._QosMonitor("BingPreviewStyleThumbnailLoad"),n=this.props.isNarrowContainer?this.props.htmlEmbedRect.width:t._defaultThumbnailWidth,a=this.props.isNarrowContainer?this.props.htmlEmbedRect.width*t._defaultThumbnailHeightWidthRatio:t._defaultThumbnailHeight,i=d.ThumbnailUrlGenerator.updateThumbnailWidth(this.props.metadata.Thumbnail,n),r=I._SPFlight.isEnabled(60179)&&!!this.props.thumbnailOverlapText,o=c.createElement(_.Image,Object(s.__assign)({className:r?void 0:E,alt:this.props.altText||""},{width:n,height:a,src:i},{imageFit:_.ImageFit.cover,title:!I._SPKillSwitch.isActivated("f30fb522-ba6b-4f04-9def-3e95eb692ef4")&&this.props.altText?this.props.altText:this.props.metadata.Title,onLoad:this._handleThumbnailLoadSuccess(e),onError:this._handleThumbnailLoadError(e),role:this.props.altText?"img":"presentation"}));return c.createElement("a",{className:"i_b_87677f78",href:this.props.originalUrl,target:"_blank",ref:this._createThumbnailRef,"aria-label":l.StringHelper.format(v.ThumbnailAriaLabel,this.props.metadata.Title),rel:"noreferrer"},r?c.createElement("div",{className:E},o,c.createElement("div",{className:"u_b_87677f78"},this.props.thumbnailOverlapText)):o)}},t.prototype._handleThumbnailLoadSuccess=function(e){var t=this;return function(){t.setState({isValidUrl:!0}),e.writeSuccess()}},t.prototype._handleThumbnailLoadError=function(e){var t=this;return function(){t.setState({isValidUrl:!1});var n=v?v.ThumbnailLoadError:"ThumbnailLoadError";e.writeUnexpectedFailure("ThumbnailLoadError",new Error(n))}},t.prototype._loadLessText=function(){var e=this;this.state.isLessTextLoaded||x.SPComponentLoader.loadComponentById(t._spWebpartSharedComponentId).then(function(t){e._lessText=t.LessText,e.setState({isLessTextLoaded:!0})}).catch(function(e){f._TraceLogger.logError(f._LogSource.create("HtmlEmbed"),e,"LoadWebpartSharedComponent")})},t._defaultThumbnailHeightWidthRatio=.5625,t._defaultThumbnailHeight=135,t._defaultThumbnailWidth=240,t._spWebpartSharedComponentId="914330ee-2df2-4f6e-a858-30c23a812408",t._shouldUseCssClamp=I._BrowserDetection.getBrowserInformation().browser!==I._Browser.IE,Object(s.__decorate)([_.autobind],t.prototype,"focus",null),Object(s.__decorate)([_.autobind],t.prototype,"_handleThumbnailLoadSuccess",null),Object(s.__decorate)([_.autobind],t.prototype,"_handleThumbnailLoadError",null),Object(s.__decorate)([_.autobind],t.prototype,"_loadLessText",null),t}(c.Component),M=function(e){function t(n){var a=e.call(this,n)||this;return a._createBingPreviewLayoutRef=function(e){a._bingPreviewStyleComponent=e,a._shouldFocus&&e&&(e.focus(),a._shouldFocus=!1)},a._htmlGeneratorProps.htmlEmbedRect=g.scaleZeroRectByRatio(a._htmlGeneratorProps.htmlEmbedRect,t._defaultWidthHeightScale),a._shouldFocus=!1,a}return Object(s.__extends)(t,e),t.prototype.createHtmlElement=function(){return c.createElement(k,Object(s.__assign)({},this._htmlGeneratorProps,{ref:this._createBingPreviewLayoutRef}))},t.prototype.getFilteredVanillaHtml=function(){return""},t.prototype.focus=function(){this._bingPreviewStyleComponent?this._bingPreviewStyleComponent.focus():this._shouldFocus=!0},t.prototype._internalValidate=function(e){var t=Boolean(this._htmlGeneratorProps.metadata),n=Boolean(t&&this._htmlGeneratorProps.metadata.Title),a=Boolean(t&&this._htmlGeneratorProps.metadata.Description),i=Boolean(t&&this._htmlGeneratorProps.metadata.Thumbnail),r=Boolean(n||a||i),o={hasTitle:n,hasDescription:a,hasThumbnail:i,userInputHostname:g.getHostnameFromUrl(this._htmlGeneratorProps.originalUrl),currentHostname:window.location.host},s=this._htmlGeneratorProps.qosPrefixName||"HTMLEmbed",c=new C._QosMonitor(s+".BingPreviewStyle.ValidationResult");r?!n&&a&&i?c.writeExpectedFailure("MissTitle",void 0,o):n&&!a&&i?c.writeExpectedFailure("MissDescription",void 0,o):n&&a&&!i?c.writeExpectedFailure("MissThumbnail",void 0,o):!n||a||i?n||!a||i?n||a||!i?c.writeSuccess():c.writeExpectedFailure("OnlyHasThumbnail",void 0,o):c.writeExpectedFailure("OnlyHasDescription",void 0,o):c.writeExpectedFailure("OnlyHasTitle",void 0,o):c.writeExpectedFailure("EmptyMetadata",void 0,o);var d=v?v.UnsupportedEmbedUrl:"UnsupportedEmbedUrl";return Promise.resolve({isValid:r,errorMessage:r?"":d})},t.prototype.getWidth=function(){return this._htmlGeneratorProps.htmlEmbedRect.width},t.prototype.getHeight=function(){return this._htmlGeneratorProps.htmlEmbedRect.height},t._defaultWidthHeightScale=2.8,t}(b),P=function(){function e(){}return e.createHtmlGenerator=function(t){return t.embedCodeShownType===i.BingPreviewStyle?new M(t):t.type?t.type===o.photo?new D(t):new S(t):e._createHtmlGeneratorWithoutType(t)},e._createHtmlGeneratorWithoutType=function(e){return new S(e)},e}(),T=function(e){function t(t){var n=e.call(this,t)||this;return n._modifyServerResult=function(e){var t,n,a,i=null===(t=e.EmbedMetadata)||void 0===t?void 0:t.Url;if(i&&new l.Uri(i).getPath()===new l.Uri(window.location.href).getPath()&&(null===(n=e.EmbedMetadata)||void 0===n?void 0:n.Thumbnail)){var r=new l.Uri(null===(a=e.EmbedMetadata)||void 0===a?void 0:a.Thumbnail);r.setQueryParameter("randomNumber",Math.random().toFixed(5)),e.EmbedMetadata.Thumbnail=r.toString()}return e},n._createHtmlEmbedDivRef=function(e){n._htmlEmbedDivDom=e,n._shouldFocus&&!n.state.isValidating&&(n.focus(),n._shouldFocus=!1)},n.state={isValidating:!0,errorMessage:""},n._setBoundingRectFromProps(),n._operationId=0,n.props.embeddableService&&(n.props.embedDataSource.embedDataProvider.embeddableService=n.props.embeddableService),n._shouldFocus=!1,n._logSource=f._LogSource.create("HTMLEmbed"),n}return Object(s.__extends)(t,e),t._isSameEmbedDataSource=function(e,t){return e.type===r.DataProvider&&t.type===r.DataProvider?m(e.embedDataProvider.embeddableService)===m(t.embedDataProvider.embeddableService):e.type===t.type&&u.isEqual(e.embedServiceResult,t.embedServiceResult)},t.prototype.getErrorMessage=function(){return this.state.errorMessage},t.prototype.getMetadata=function(){return this._urlMetadata},t.prototype.UNSAFE_componentWillMount=function(){this._boundingRect&&this._startValidation(this.props)},t.prototype.componentDidMount=function(){if(!this._boundingRect){var e=this._getCurrentBoundingRect();if(e){if(e.width<=0&&e.height<=0)return this._setErrorMessageAndNotify(v.HTMLEmbedBoundingRectZero);this._boundingRect=e,this._startValidation(this.props)}}},t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(this._boundingRect&&(!t._isSameEmbedDataSource(this.props.embedDataSource,e.embedDataSource)||this.props.embedCode.embedCode!==e.embedCode.embedCode))if(this._shouldSkipValidation(e)){var n=this._getHTMLGeneratorProps(e);this._updateComponents(n,e)}else this._startValidation(e);this.props.isNarrowContainer!==e.isNarrowContainer&&this._htmlGenerator&&this._htmlGenerator.setMobileMode(e.isNarrowContainer),this.props.variantTheme!==e.variantTheme&&this._htmlGenerator&&this._htmlGenerator.setVariantTheme(e.variantTheme),this.props.altText!==e.altText&&this._htmlGenerator&&this._htmlGenerator.setAltText(e.altText),this._htmlGenerator&&this.props.boundingRect&&e.boundingRect&&(this.props.boundingRect.height!==e.boundingRect.height||this.props.boundingRect.width!==e.boundingRect.width)&&(this._htmlGenerator.setContainerRect(e.boundingRect),this._setBoundingRectFromProps(e))},t.prototype.componentDidUpdate=function(){if(!this._boundingRect){var e=this._getCurrentBoundingRect();!e||e.width<=0&&e.height<=0||e.width!==this._boundingRect.width&&(this._boundingRect=e,this._startValidation(this.props))}},t.prototype.render=function(){return c.createElement("div",{ref:this._createHtmlEmbedDivRef},this.state.isValidating?this._renderLoadingIndicator():this.state.errorMessage||!this._htmlGenerator?this._renderError():this._htmlGenerator.createHtmlElement())},t.prototype.focus=function(){this._htmlGenerator&&(this.state.isValidating?this._shouldFocus=!0:this._htmlGenerator.focus())},t.prototype._shouldSkipValidation=function(e){return e.isSkipValidationOn&&(e.embedCode.embedCodeType===a.VanillaHtml||e.embedDataSource.type===r.RawDataSource)},t.prototype._updateComponents=function(e,t){var n=this;this._htmlGenerator=P.createHtmlGenerator(e),this._htmlGenerator.setSuccessorValidator(t.htmlValidator);var a=++this._operationId;this._htmlGenerator.validate(this._htmlGenerator.getFilteredVanillaHtml()).then(function(i){if(a===n._operationId)return t.embedDataSource.type===r.DataProvider&&u.get(t.embedDataSource,"embedDataProvider.onEmbedResultChanged")&&t.embedDataSource.embedDataProvider.onEmbedResultChanged({Type:e.type,Html:e.vanillaHtml,ResponseCode:p.OK,ErrorMessage:"",EmbedMetadata:e.metadata}),n._setErrorMessageAndNotify(i.isValid?"":i.errorMessage)},function(e){if(a===n._operationId)return n._setErrorMessageAndNotify(e.errorMessage||e.toString())})},t.prototype._validate=function(e,t){if(e.metadata){var n=this._getWebUrlFromPreviewUrl(e.metadata.Thumbnail);if(n&&e.metadata.ListId&&e.metadata.SiteId&&e.metadata.UniqueId&&e.metadata.WebId){var a=this._getCurrentBoundingRect(),i={absoluteUrl:n,siteId:e.metadata.SiteId,webId:e.metadata.WebId,listId:e.metadata.ListId,uniqueId:e.metadata.UniqueId,width:a?a.width:void 0,fileType:e.metadata.Thumbnail&&d.ExtensionHelper.getExtension(e.metadata.Thumbnail)||"jpg",callerId:"htmlEmbed"};e.metadata.Thumbnail=d.ThumbnailUrlGenerator.getThumbnailUrl(i)}}try{if(e.metadata.Thumbnail&&e.metadata.Thumbnail.toLowerCase().indexOf("/getpreview.ashx")>-1){var r=new URL(e.metadata.Thumbnail);r.searchParams.has(d.PreviewHelper.GUID_FILE)&&r.searchParams.has(d.PreviewHelper.GUID_WEB)&&r.searchParams.has(d.PreviewHelper.GUID_SITE)&&(r.searchParams.set("v",String(Date.now())),e.metadata.Thumbnail=r.href)}}catch(e){f._TraceLogger.logError(this._logSource,e)}this._updateComponents(e,t)},t.prototype._getHTMLGeneratorProps=function(e){return e.embedCode.embedCodeType===a.VanillaHtml?{vanillaHtml:e.embedCode.embedCode,htmlEmbedRect:this._boundingRect,type:o.unknown,shouldScale:e.shouldScale,embedCodeShownType:e.embedCode.embedCodeShownType,className:e.className,isNarrowContainer:e.isNarrowContainer,qosPrefixName:e.qosPrefixName,variantTheme:this.props.variantTheme,altText:this.props.altText,isFlexNoWrap:this.props.isFlexNoWrap,isWhiteSpaceBreakSpaces:this.props.isWhiteSpaceBreakSpaces}:e.embedDataSource.type===r.RawDataSource?{vanillaHtml:e.embedDataSource.embedServiceResult.Html,originalUrl:e.embedCode.embedCode,htmlEmbedRect:this._boundingRect,type:e.embedDataSource.embedServiceResult.Type,metadata:e.embedDataSource.embedServiceResult.EmbedMetadata,shouldScale:e.shouldScale,embedCodeShownType:e.embedCode.embedCodeShownType,className:e.className,isNarrowContainer:e.isNarrowContainer,variantTheme:this.props.variantTheme,altText:this.props.altText,thumbnailOverlapText:e.thumbnailOverlapText,isFlexNoWrap:this.props.isFlexNoWrap,isWhiteSpaceBreakSpaces:this.props.isWhiteSpaceBreakSpaces}:{isEmbeddableServiceRequired:!0}},t.prototype._startValidation=function(e){var t=this;this.setState({isValidating:!0,errorMessage:""});var n=this._getHTMLGeneratorProps(e);if(n.isEmbeddableServiceRequired){var a=e.embedDataSource.embedDataProvider.embeddableService;if(!a)return this._setErrorMessageAndNotify(v.NotSettingEmbedableService);var i=++this._operationId;a.getEmbeddableHtmlCode().then(function(n){t._operationId===i&&(t._modifyServerResult(n),t._urlMetadata=n.EmbedMetadata,t._validate({vanillaHtml:n.Html,originalUrl:e.embedCode.embedCode,htmlEmbedRect:t._boundingRect,type:n.Type,metadata:n.EmbedMetadata,shouldScale:e.shouldScale,embedCodeShownType:e.embedCode.embedCodeShownType,className:e.className,isNarrowContainer:e.isNarrowContainer,qosPrefixName:e.qosPrefixName,titleMetaDataOverride:e.titleMetaDataOverride,variantTheme:t.props.variantTheme,altText:t.props.altText,isFlexNoWrap:t.props.isFlexNoWrap,isWhiteSpaceBreakSpaces:t.props.isWhiteSpaceBreakSpaces},e))}).catch(function(e){f._TraceLogger.logError(f._LogSource.create("HtmlEmbed"),e,"GetEmbeddableHtmlCode")})}else this._validate(n,e)},t.prototype._renderLoadingIndicator=function(){if(this.props.renderLoadingIndicator)return this.props.renderLoadingIndicator()},t.prototype._renderError=function(){if(this.props.renderError)return this.props.renderError(this.state.errorMessage)},t.prototype._setErrorMessageAndNotify=function(e){this.setState({isValidating:!1,errorMessage:e}),this.props.onNotifyRenderResult&&this.props.onNotifyRenderResult(e)},t.prototype._getCurrentBoundingRect=function(){if(this._boundingRect)return this._boundingRect;if(this._htmlEmbedDivDom){var e=this._htmlEmbedDivDom.getBoundingClientRect();return{width:Math.ceil(e.width),height:Math.ceil(e.height)}}},t.prototype._setBoundingRectFromProps=function(e){var t=e||this.props;t.boundingRect&&(t.boundingRect.width>0||t.boundingRect.height>0)&&(this._boundingRect=t.boundingRect)},t.prototype._getWebUrlFromPreviewUrl=function(e){if(e){var t=/\/_layouts\/15\/getpreview.ashx\?.*/i;return t.test(e)?e.substr(0,t.exec(e).index):void 0}},t.defaultProps={embedCode:void 0,embedDataSource:{type:r.DataProvider,embedDataProvider:{embeddableService:void 0,onEmbedResultChanged:void 0}}},t.validateDone="validateDone",t}(c.Component),U=n("vlQI"),F=n("X+PM"),H=function(){function e(e,t){var n=this;this._url=e,t.whenFinished(function(){n._httpClient=t.consume(U.SPHttpClient.serviceKey),n._pageContext=t.consume(F.PageContext.serviceKey),n._qosPrefix="SPEmbeddableService"})}return e.prototype.setQosPrefixStr=function(e){this._qosPrefix=e},e.prototype.getEmbeddableHtmlCode=function(e){var t=new C._QosMonitor(this._qosPrefix+".GetOEmbedIframeHtml"),n=1e3*(1+4*Math.random());return this._getEmbeddableHtmlCodeImpl(3,n,t,e)},e.prototype._getEmbeddableHtmlCodeImpl=function(e,t,n,a){var i,r=this,s=this._pageContext.web.absoluteUrl,c=new l.Uri(l.Uri.concatenate(s,"_api/SP.Publishing.EmbedService/EmbedData"));c.setQueryParameter("url",l.StringHelper.format("%27{0}%27",l.UriEncoding.encodeRestUriStringToken(this._url))),c.setQueryParameter("version","1"),(null==a?void 0:a.isBannerImageUrl)&&c.setQueryParameter("bannerImageUrl","true");var d=new Headers;return d.append("client-type",this._qosPrefix),this._httpClient.get(c.toString(),U.SPHttpClient.configurations.v1,{headers:d}).then(function(e){return i=e,r._checkStatus(e)}).then(function(e){return e.json()}).then(function(e){return n.writeSuccess(),Promise.resolve({Type:e.Type,Html:e.Html,ResponseCode:e.ResponseCode,EmbedServiceResponseCode:e.EmbedServiceResponseCode,ErrorMessage:e.ErrorMessage,EmbedMetadata:{CreatorName:e.CreatorName,DatePublishedAt:e.DatePublishedAt,Description:e.Description,PublisherName:e.PublisherName,Thumbnail:e.ThumbnailUrl,Title:e.Title,VideoId:e.VideoId,SiteId:e.SiteId,WebId:e.WebId,ListId:e.ListId,UniqueId:e.UniqueId,Url:e.Url,DecodedUrl:e.DecodedUrl,Type:e.Type,DurationInSeconds:e.DurationInSeconds}})}).catch(function(a){var s;return i&&(s=i.correlationId?i.correlationId.toString():""),--e<=0?(i&&403===i.status?n.writeExpectedFailure("AuthError",a,{correlationId:s}):n.writeUnexpectedFailure("GetOEmbedIframeHtmlFail",a,{correlationId:s}),Promise.resolve({Type:o.unknown,Html:"",ResponseCode:p.GetEmbedCodeError,ErrorMessage:a.message})):new Promise(function(e){return setTimeout(e,t)}).then(function(){return r._getEmbeddableHtmlCodeImpl(e,2*t,n)})})},e.prototype._checkStatus=function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(l.StringHelper.format("details: {0} | responseCode: {1}",JSON.stringify(e),e.status)))},e}(),R=function(){function e(){}return e.createEmbeddableService=function(e,t,n){var a=new H(e,n);return t&&a.setQosPrefixStr(t),a},e}(),N=function(){function e(e,t){var n=this;this._url=e,t.whenFinished(function(){n._httpClient=t.consume(U.SPHttpClient.serviceKey)}),this._qosPrefix="O365VideoEmbeddableService"}return e.prototype.setQosPrefixStr=function(e){this._qosPrefix=e},e.prototype.getEmbeddableHtmlCode=function(){var e=new C._QosMonitor(this._qosPrefix+".GetVideoEmbedCode"),t=l.Uri.concatenate(location.origin,"/portals/hub/_api/VideoService/GetVideoByURL?$Select=DefaultEmbedCode,ID,ChannelID,ThumbnailUrl");return this._httpClient.post(t,U.SPHttpClient.configurations.v1,{credentials:"include",body:JSON.stringify({videoFileRelativeUrl:this._url})}).then(this._checkStatus).then(function(e){return e.json()}).then(function(t){return e.writeSuccess(),Promise.resolve({Html:t.DefaultEmbedCode,Type:o.video,ErrorMessage:"",EmbedMetadata:{Thumbnail:t.ThumbnailUrl},ResponseCode:p.OK})}).catch(function(t){return e.writeUnexpectedFailure("GetEmbedCode"),Promise.resolve({Html:"",Type:o.video,ErrorMessage:v.InvalidVideoURL,ResponseCode:p.GetEmbedCodeError})})},e.prototype._checkStatus=function(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))},e}(),B=function(){function e(){}return e.getChidVidFromVideoUrl=function(t){var n={};if(""!==t){var a=e.getIDStartIndexFromVideoUrl(e.chidKey,t)+e.chidKey.length+1,i=e.getIDStartIndexFromVideoUrl(e.vidKey,t)+e.vidKey.length+1;n[e.chidKey]=t.substring(a,a+e._sizeOfGuid),n[e.vidKey]=t.substring(i,i+e._sizeOfGuid)}return n},e.generateVideoUrlForIframeCodeRest=function(t){var n=new l.Uri(t).getHost();if(n&&n!==location.hostname)return t;var a=e.getChidVidFromVideoUrl(t);return"PointPublishing.aspx?chid="+a[e.chidKey]+"&vid="+a[e.vidKey]},e.getIDStartIndexFromVideoUrl=function(e,t){var n=new RegExp(e+"=","i").exec(t);return n?n.index:-1},e.chidKey="chid",e.vidKey="vid",e._sizeOfGuid=36,e}()},ut3N:function(e,t){e.exports=f},vlQI:function(e,t){e.exports=p},y88i:function(e,t){e.exports=m}})});