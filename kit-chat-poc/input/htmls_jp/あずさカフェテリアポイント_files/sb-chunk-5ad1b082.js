(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-3sfile"],{"1DZO":function(e,t,r){"use strict";r.r(t);var o=r("wAGM"),i=r("GtFt"),n=r("3twC"),a=r("D59/"),c=r("oQg0"),s=r("cDcd");const l=Object(a.a)("pp-comp",()=>Promise.all([r.e("cpl-meetingpill"),r.e("cpl-search"),r.e(0),r.e("commands"),r.e("strings"),r.e("pp-comp"),r.e("fb-comp"),r.e("vendors~ans-people~cmd-deletepqh~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-ans~19412f03"),r.e("pro-3sfile2"),r.e("pro-feed"),r.e("stream"),r.e("pro-3sfile"),r.e("pro-3sapp"),r.e("pro-3stext"),r.e("pro-bingtag"),r.e(2),r.e("sug-news"),r.e(3),r.e("pol-eager"),r.e("cmd-openchat"),r.e("cmd-copyfileurl"),r.e("aria"),r.e("pro-3spers"),r.e("sug-copilot"),r.e(4),r.e("cpl-host"),r.e("cmd-deletepqh"),r.e(5),r.e("pro-kmtopic"),r.e("vendors~cpl-teachingmoments~debug~fb-comp~mp-comp~pp-comp~sc-comp~sug-pplkey~tp-comp"),r.e("warmup"),r.e("sug-person-answer"),r.e("pro-3s-pplkw"),r.e("cmd-copyemail"),r.e(1),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~cpl-host~cpl-invoker~cpl-no-submit~extract~602961cd"),r.e("sug-univ"),r.e("mp-comp"),r.e("pro-3sbm"),r.e("cmd-mailto"),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-answers-email~extracted-p~d245b82a"),r.e("ans-people~cmd-openpeoplecentricsb~cpl-answerproviderhost~extracted-people-answers-email~extracted-p~0faf3495"),r.e("pro-site-spnews"),r.e("cpl-answerproviderhost~cpl-host~cpl-invoker~cpl-no-submit~extracted-people-answers-email~extracted-p~7f628318"),r.e("cpl-answerproviderhost~cpl-exit~cpl-host~cpl-invoker~cpl-no-submit~pp-comp~stream"),r.e("pro-3sdoc")]).then(r.bind(null,"Elzn")),e=>e.default),p=Object(c.a)(l);class d extends s.Component{constructor(e){var t,r,o;super(e),this.state={personaPillData:(null===(o=null===(r=null===(t=this.props.instrumenter)||void 0===t?void 0:t.props)||void 0===r?void 0:r.scenarioContext)||void 0===o?void 0:o.personScope)||{}}}componentDidMount(){var e;const t=null===(e=this.props.instrumenter)||void 0===e?void 0:e.register(e=>{var t;e.hostAppInfo&&("person"!==e.hostAppInfo.scopeId&&"personAnswer"!==e.hostAppInfo.scopeId||!(null===(t=e.scenarioContext)||void 0===t?void 0:t.personScope)?this.setState({personaPillData:{}}):this.setState({personaPillData:e.scenarioContext.personScope}))});this.setState({instrumenterId:t})}render(){return this.state.personaPillData&&this.state.personaPillData.userPrincipalName?s.createElement(p,Object.assign({},this.props,{personaPillData:this.state.personaPillData||{}})):null}}var u=Object(n.a)("startButton","SearchBoxPersonaPill")(e=>s.createElement(d,Object.assign({},e)));t.default=Object(o.a)(i.n)(u)},ABrm:function(e,t,r){"use strict";t.a=function(e){for(var t=-1,r=null==e?0:e.length,o=0,i=[];++t<r;){var n=e[t];n&&(i[o++]=n)}return i}},WMEh:function(e,t,r){"use strict";function o(e){return function(t){var r=t.prefetchTimeSinceOrigin||performance.now.bind(performance),o=r();return n(0,o,t,e,r).catch((function(a){return i(a)?n(1,o,t,e,r).catch((function(e){return function(e,t,r){if(i(e)){var o=e;throw o.tokenAttemptCount=t,o.tokenFetchDuration=r,o}throw e}(e,2,r()-o)})):Promise.reject(a)}))}}function i(e){return!!e&&(401===e.status||0===e.status)}function n(e,t,r,o,i){if(!("token"in r)&&!("tokenProvider"in r))return Promise.reject(new Error("Token or token provider must be specified."));var n=-1;return"token"in r&&function(e){return!!e.token}(r)?o(r.token)(r).then((function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}})):r.tokenProvider({attempt:e}).then((function(e){return n=i()-t,o(e)(r)})).then((function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:n,xhr:t}}))}r.d(t,"a",(function(){return o}))},bzle:function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return v}));var o=r("+zb2"),i=r("UlRC"),n=r("rpSO"),a=r("KmCS"),c=r("F6lS"),s=r("POWj"),l=r("mGoP"),p=r("bs+K"),d=r("Q+QT"),u=r("ohlq"),m=r("xo1z"),f=r("qGDX"),h=r("q9uV");let b=class{constructor(e,t,r,o,i){this.config=e,this.fetcher=t,this.conversation=r,this.searchBox=o,this.context=i}getId(){return"FactFileSuggestionProvider"}createStream(e){var t,r;const o=null===(r=null===(t=this.context)||void 0===t?void 0:t.commanding.currentCommand.values[0])||void 0===r?void 0:r.customProps,n=null==o?void 0:o.EmailAddresses[0];if(!n)return i.Observable.fromArray([]);const a=null==o?void 0:o.logicalId,c=e.length>0?`from:${n} ${e}`:"from:"+n;return Object(f.b)(this.fetcher,"File",{searchText:c,entityTypes:Object(h.b)(this.config,e),scenario:Object(m.a)(Object(u.a)()),appOverride:Object(s.a)(),logicalSearchId:a,conversationId:this.conversation&&this.conversation.conversationId}).select(t=>{var r;const{AccessUrl:o,Author:i,AuthorEmail:n,DateCreated:a,DateModified:c,DateAccessed:s,FileExtension:u,FileName:m,FileSourceType:f,FileType:h,ModifiedBy:b,ModifiedByDisplayName:v,PropertyHits:y,SourceTitle:O,logProps:g,originalLogicalSearchId:j,entityType:T,From:x,SharedDateTime:S,UserRelationshipType:I}=t,D=Object(p.a)(m),P=Object(l.b)(Object(l.d)(e),"FileName",D,y),w=Object(l.a)({createdDate:a,authorDisplayName:i||(null===(r=null==x?void 0:x.EmailAddress)||void 0===r?void 0:r.Name)||"",authorEmail:n||"",dateModified:c,modifiedByDisplayName:v,propertyHits:y,searchText:e,lastAccessedDate:s,fileType:h,fileSourceType:f,modifiedBy:b,fromObject:x,sharedDateTime:S,userRelationshipType:I}),A=Object(d.a)(t);return{logProps:g,id:o,searchText:e,title:P,url:o+"?web=1",fileExtension:u,fileSourceType:f,fileType:h,displayText:P,lastModifiedTime:c,lastModifiedBy:v,lastModifiedByAccountName:b,parentSiteTitle:O,secondaryDisplayText:w,originalLogicalSearchId:j,entityType:T,displayTextRaw:D,tidbitIconName:null==A?void 0:A.icon,customProps:{tidbitIconLabel:null==A?void 0:A.label}}})}};b=Object(o.__decorate)([Object(h.a)({entityType:"File"}),Object(o.__param)(0,Object(n.a)("config")),Object(o.__param)(1,Object(n.a)("fetcher")),Object(o.__param)(2,Object(n.a)("conversation")),Object(o.__param)(3,Object(n.a)("searchBox")),Object(o.__param)(4,Object(n.a)("context"))],b),t.default=b;const v=Object(a.regs)(`${c.a}.${b.prototype.getId()}`,b)},"f/ur":function(e,t,r){"use strict";var o=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");t.a=function(e){return o.test(e)}},jfYR:function(e,t,r){"use strict";t.a=function(e,t){var r=-1,o=e.length;for(t||(t=Array(o));++r<o;)t[r]=e[r];return t}},"lzq+":function(e,t,r){"use strict";r.r(t),r.d(t,"KMSiteSuggestionEntity",(function(){return f})),r.d(t,"registration",(function(){return b}));var o=r("+zb2"),i=r("qArz"),n=r("UlRC"),a=r("rpSO"),c=r("KmCS"),s=r("F6lS"),l=r("AF84"),p=r("a7o/"),d=r("HTw2"),u=r("V34+"),m=r("lS1Q");const f="Site";let h=class{constructor(e,t){this.topicScope=e,this.context=t}getId(){return`KM${f}SuggestionProvider`}createStream(e){var t,r,o;const a=null===(t=this.context)||void 0===t?void 0:t.commanding.currentCommand.values[0].id;if(!a||!(null===(r=this.context)||void 0===r?void 0:r.instrumenter.props.serviceEnvInfo))return n.Observable.empty();const c=Object(d.a)(null===(o=this.context)||void 0===o?void 0:o.instrumenter.props.serviceEnvInfo);return Object(m.a)({topicId:a,environment:c,entity:f,filterSpec:u.b,searchText:e}).select(({Id:t,Title:r,Acronym:o,Color:n,Url:a})=>({entityType:"KM"+f,id:t,displayTexts:[{text:Object(p.c)([e],r),icon:{acronymIcon:{acronym:o,color:Object(i.a)(n,void 0,!0)},ariaLabel:Object(l.d)()}}],url:a}))}};h=Object(o.__decorate)([Object(o.__param)(0,Object(a.a)("topicScope")),Object(o.__param)(1,Object(a.a)("context"))],h),t.default=h;const b=Object(c.regs)(`${s.a}.${h.prototype.getId()}`,h)},qxrB:function(e,t,r){"use strict";var o=r("MMhY"),i=r("3AH6");t.a=function(e,t){var r=-1,n=Object(i.a)(e)?Array(e.length):[];return Object(o.a)(e,(function(e,o,i){n[++r]=t(e,o,i)})),n}},"uih/":function(e,t,r){"use strict";r.r(t),r.d(t,"registration",(function(){return y}));var o=r("+zb2"),i=r("rpSO"),n=r("KmCS"),a=r("F6lS"),c=r("POWj"),s=r("g+lP"),l=r("ohlq"),p=r("xo1z"),d=r("Xopu"),u=r("mGoP"),m=r("bs+K"),f=r("Q+QT"),h=r("qGDX"),b=r("q9uV");let v=class extends class{createStream(e){return Object(h.b)(this.fetcher,"File",{searchText:e,entityTypes:this.config?Object(b.b)(this.config,e):["File"],scenario:this.scenario,appOverride:this.appOverride,logicalSearchId:this.logicalId,conversationId:this.conversationId}).selectConcat(()=>this.personalUrl,(t,r)=>{var o;const{AccessUrl:i,Author:n,AuthorEmail:a,DateCreated:c,DateModified:s,DateAccessed:l,FileExtension:p,FileName:d,FileSourceType:h,FileType:b,ModifiedBy:v,ModifiedByDisplayName:y,PropertyHits:O,SourceTitle:g,logProps:j,originalLogicalSearchId:T,entityType:x,From:S,SharedDateTime:I,UserRelationshipType:D,SpoId:P,SPWebUrl:w,SpoUniqueId:A}=t,_=Object(m.a)(d),F=Object(u.b)(e,"FileName",_,O),M=Object(u.a)({createdDate:c,authorDisplayName:n||(null===(o=null==S?void 0:S.EmailAddress)||void 0===o?void 0:o.Name)||"",authorEmail:a||"",dateModified:s,modifiedByDisplayName:y,propertyHits:O,searchText:e,lastAccessedDate:l,fileType:b,fileSourceType:h,modifiedBy:v,fromObject:S,sharedDateTime:I,userRelationshipType:D}),k=Object(f.a)(t);return{logProps:j,id:P||i,searchText:e,title:F,url:i+"?web=1",fileExtension:p,fileSourceType:h,fileType:b,displayText:F,lastModifiedTime:s,lastModifiedBy:y,lastModifiedByAccountName:v,parentSiteTitle:g,secondaryDisplayText:M,sPWebUrl:w,uniqueId:A,originalLogicalSearchId:T,entityType:x,displayTextRaw:_,tidbitIconName:null==k?void 0:k.icon,customProps:{tidbitIconLabel:null==k?void 0:k.label}}})}}{constructor(e,t,r){super(),this.config=e,this.fetcher=t,this.conversation=r,this.scenario=Object(p.a)(Object(l.a)()),this.appOverride=Object(c.a)(),this.conversationId=this.conversation&&this.conversation.conversationId,this.logicalId=this.conversation&&this.conversation.getLogicalSearchId("sb"),this.personalUrl=Promise.resolve(Object(s.a)())}getId(){return"AutoSuggestFileSuggestionProvider"}};v=Object(o.__decorate)([Object(b.a)({entityType:"File"}),Object(o.__param)(0,Object(i.a)("config")),Object(o.__param)(1,Object(i.a)("fetcher")),Object(o.__param)(2,Object(i.a)("conversation"))],v);t.default=v;const y=Object(n.regs)(`${a.a}.${d.d}`,v)},"zt+T":function(e,t,r){"use strict";function o(e,t,r){var o=r.value,i=!1;return{configurable:!0,get:function(){if(i||o&&this===o.prototype||this.hasOwnProperty(t))return o;var e=o&&o.bind(this);return i=!0,Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e}),i=!1,e},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,enumerable:!0,value:e})}}}r.d(t,"a",(function(){return o}))}}]);