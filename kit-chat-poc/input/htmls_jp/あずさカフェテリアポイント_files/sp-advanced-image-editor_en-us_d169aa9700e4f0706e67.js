/*! For license information please see sp-advanced-image-editor_en-us_d169aa9700e4f0706e67.js.LICENSE.txt */
define("444abf08-e4b4-4d65-b726-5a576c37e469_0.1.0",["tslib","@ms/office-ui-fabric-react-bundle","@microsoft/sp-core-library","@ms/sp-edit-customer-promise","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics"],function(n,a,i,r,o,s,c,d,l,u){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={2:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({}[e]||e)+"_"+"none"+"_"+{0:"d0a1e6c1a7034bf24e03",1:"1a2f6e58e242ea315216",3:"a1b2ec2d8e6db1ce8100",4:"4a5ec54eaea40351be01"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp_444abf08_e4b4_4d65_b726_5a576c37e469_0_1_0=window.webpackJsonp_444abf08_e4b4_4d65_b726_5a576c37e469_0_1_0||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp\-advanced\-image\-editor_en-us_d169aa9700e4f0706e67\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"+JwG":function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a="NOT_FOUND",i=function(e,t){return e===t};function r(e,t){var n,r,o="object"==typeof t?t:{equalityCheck:t},s=o.equalityCheck,c=void 0===s?i:s,d=o.maxSize,l=void 0===d?1:d,u=o.resultEqualityCheck,f=function(e){return function(t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var a=t.length,i=0;i<a;i++)if(!e(t[i],n[i]))return!1;return!0}}(c),p=1===l?(n=f,{get:function(e){return r&&n(r.key,e)?r.value:a},put:function(e,t){r={key:e,value:t}},getEntries:function(){return r?[r]:[]},clear:function(){r=void 0}}):function(e,t){var n=[];function i(e){var i=n.findIndex(function(n){return t(e,n.key)});if(i>-1){var r=n[i];return i>0&&(n.splice(i,1),n.unshift(r)),r.value}return a}return{get:i,put:function(t,r){i(t)===a&&(n.unshift({key:t,value:r}),n.length>e&&n.pop())},getEntries:function(){return n},clear:function(){n=[]}}}(l,f);function m(){var t=p.get(arguments);if(t===a){if(t=e.apply(null,arguments),u){var n=p.getEntries(),i=n.find(function(e){return u(e.value,t)});i&&(t=i.value)}p.put(arguments,t)}return t}return m.clearCache=function(){return p.clear()},m}function o(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var n=t.map(function(e){return"function"==typeof e?"function "+(e.name||"unnamed")+"()":typeof e}).join(", ");throw new Error("createSelector expects all input-selectors to be functions, but received the following types: ["+n+"]")}return t}function s(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i=function(){for(var t=arguments.length,a=new Array(t),i=0;i<t;i++)a[i]=arguments[i];var r,s=0,c={memoizeOptions:void 0},d=a.pop();if("object"==typeof d&&(c=d,d=a.pop()),"function"!=typeof d)throw new Error("createSelector expects an output function after the inputs, but received: ["+typeof d+"]");var l=c,u=l.memoizeOptions,f=void 0===u?n:u,p=Array.isArray(f)?f:[f],m=o(a),_=e.apply(void 0,[function(){return s++,d.apply(null,arguments)}].concat(p)),h=e(function(){for(var e=[],t=m.length,n=0;n<t;n++)e.push(m[n].apply(null,arguments));return r=_.apply(null,e)});return Object.assign(h,{resultFunc:d,memoizedResultFunc:_,dependencies:m,lastResult:function(){return r},recomputations:function(){return s},resetRecomputations:function(){return s=0}}),h};return i}var c=s(r)},"0m5E":function(e,t,n){"use strict";e.exports=n("TFGW")},"17wl":function(e,t){e.exports=n},"25SK":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=!1},"3/f9":function(e,t,n){"use strict";var a=n("ak4t"),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return a.isMemo(e)?o:s[e.$$typeof]||i}s[a.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[a.Memo]=o;var d=Object.defineProperty,l=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,m=Object.prototype;e.exports=function e(t,n,a){if("string"!=typeof n){if(m){var i=p(n);i&&i!==m&&e(t,i,a)}var o=l(n);u&&(o=o.concat(u(n)));for(var s=c(t),_=c(n),h=0;h<o.length;++h){var b=o[h];if(!(r[b]||a&&a[b]||_&&_[b]||s&&s[b])){var g=f(n,b);try{d(t,b,g)}catch(e){}}}}return t}},"5pbq":function(e,t){e.exports=a},ALV6:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},CJ0j:function(e,t,n){"use strict";function a(e){return function(t){var n=t.dispatch,a=t.getState;return function(t){return function(i){return"function"==typeof i?i(n,a,e):t(i)}}}}var i=a();i.withExtraArgument=a,t.e=i},CP8q:function(e,t,n){"use strict";var a=n("fglE");n.o(a,"AnimationVariables")&&n.d(t,"AnimationVariables",function(){return a.AnimationVariables}),n.o(a,"FontWeights")&&n.d(t,"FontWeights",function(){return a.FontWeights}),n.o(a,"HighContrastSelector")&&n.d(t,"HighContrastSelector",function(){return a.HighContrastSelector}),n.o(a,"concatStyleSets")&&n.d(t,"concatStyleSets",function(){return a.concatStyleSets}),n.o(a,"getFocusStyle")&&n.d(t,"getFocusStyle",function(){return a.getFocusStyle}),n.o(a,"getGlobalClassNames")&&n.d(t,"getGlobalClassNames",function(){return a.getGlobalClassNames}),n.o(a,"getHighContrastNoAdjustStyle")&&n.d(t,"getHighContrastNoAdjustStyle",function(){return a.getHighContrastNoAdjustStyle}),n.o(a,"hiddenContentStyle")&&n.d(t,"hiddenContentStyle",function(){return a.hiddenContentStyle}),n.o(a,"normalize")&&n.d(t,"normalize",function(){return a.normalize})},M1bi:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_IconComponent},Oukv:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("a1Kd"),i=0,r=function(){function e(){}return e.getValue=function(e,t){var n=o();return void 0===n[e]&&(n[e]="function"==typeof t?t():t),n[e]},e.setValue=function(e,t){var n=o(),a=n.__callbacks__,i=n[e];if(t!==i){n[e]=t;var r={oldValue:i,value:t,key:e};for(var s in a)a.hasOwnProperty(s)&&a[s](r)}return t},e.addChangeListener=function(e){var t=e.__id__,n=s();t||(t=e.__id__=String(i++)),n[t]=e},e.removeChangeListener=function(e){delete s()[e.__id__]},e}();function o(){var e,t=Object(a.e)()||{};return t.__globalSettings__||(t.__globalSettings__=((e={}).__callbacks__={},e)),t.__globalSettings__}function s(){return o().__callbacks__}},TFGW:function(e,t,n){"use strict";var a=60103,i=60106,r=60107,o=60108,s=60114,c=60109,d=60110,l=60112,u=60113,f=60120,p=60115,m=60116,_=60121,h=60122,b=60117,g=60129,v=60131;if("function"==typeof Symbol&&Symbol.for){var y=Symbol.for;a=y("react.element"),i=y("react.portal"),r=y("react.fragment"),o=y("react.strict_mode"),s=y("react.profiler"),c=y("react.provider"),d=y("react.context"),l=y("react.forward_ref"),u=y("react.suspense"),f=y("react.suspense_list"),p=y("react.memo"),m=y("react.lazy"),_=y("react.block"),h=y("react.server.block"),b=y("react.fundamental"),g=y("react.debug_trace_mode"),v=y("react.legacy_hidden")}function S(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case a:switch(e=e.type){case r:case s:case o:case u:case f:return e;default:switch(e=e&&e.$$typeof){case d:case l:case m:case p:case c:return e;default:return t}}case i:return t}}}var D=c,I=a,x=l,C=r,O=m,w=p,E=i,A=s,L=o,k=u;t.ContextConsumer=d,t.ContextProvider=D,t.Element=I,t.ForwardRef=x,t.Fragment=C,t.Lazy=O,t.Memo=w,t.Portal=E,t.Profiler=A,t.StrictMode=L,t.Suspense=k,t.isAsyncMode=function(){return!1},t.isConcurrentMode=function(){return!1},t.isContextConsumer=function(e){return S(e)===d},t.isContextProvider=function(e){return S(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===a},t.isForwardRef=function(e){return S(e)===l},t.isFragment=function(e){return S(e)===r},t.isLazy=function(e){return S(e)===m},t.isMemo=function(e){return S(e)===p},t.isPortal=function(e){return S(e)===i},t.isProfiler=function(e){return S(e)===s},t.isStrictMode=function(e){return S(e)===o},t.isSuspense=function(e){return S(e)===u},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===s||e===g||e===o||e===u||e===f||e===v||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===p||e.$$typeof===c||e.$$typeof===d||e.$$typeof===l||e.$$typeof===b||e.$$typeof===_||e[0]===h)},t.typeOf=S},UWqr:function(e,t){e.exports=i},"UvD+":function(e,t){var n,a,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,d=[],l=!1,u=-1;function f(){l&&c&&(l=!1,c.length?d=c.concat(d):u=-1,d.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new m(e,t)),1!==d.length||l||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},YKZg:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}n.d(t,"e",function(){return h}),n.d(t,"t",function(){return m}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return _}),n.d(t,"i",function(){return u});var s="function"==typeof Symbol&&Symbol.observable||"@@observable",c=function(){return Math.random().toString(36).substring(7).split("").join(".")},d={INIT:"@@redux/INIT"+c(),REPLACE:"@@redux/REPLACE"+c(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+c()}};function l(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function u(e,t,n){var a;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(o(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(o(1));return n(u)(e,t)}if("function"!=typeof e)throw new Error(o(2));var i=e,r=t,c=[],f=c,p=!1;function m(){f===c&&(f=c.slice())}function _(){if(p)throw new Error(o(3));return r}function h(e){if("function"!=typeof e)throw new Error(o(4));if(p)throw new Error(o(5));var t=!0;return m(),f.push(e),function(){if(t){if(p)throw new Error(o(6));t=!1,m();var n=f.indexOf(e);f.splice(n,1),c=null}}}function b(e){if(!l(e))throw new Error(o(7));if(void 0===e.type)throw new Error(o(8));if(p)throw new Error(o(9));try{p=!0,r=i(r,e)}finally{p=!1}for(var t=c=f,n=0;n<t.length;n++)(0,t[n])();return e}function g(e){if("function"!=typeof e)throw new Error(o(10));i=e,b({type:d.REPLACE})}function v(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(o(11));function n(){e.next&&e.next(_())}return n(),{unsubscribe:t(n)}}})[s]=function(){return this},e}return b({type:d.INIT}),(a={dispatch:b,subscribe:h,getState:_,replaceReducer:g})[s]=v,a}function f(e){for(var t=Object.keys(e),n={},a=0;a<t.length;a++){var i=t[a];"function"==typeof e[i]&&(n[i]=e[i])}var r,s=Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:d.INIT}))throw new Error(o(12));if(void 0===n(void 0,{type:d.PROBE_UNKNOWN_ACTION()}))throw new Error(o(13))})}(n)}catch(e){r=e}return function(e,t){if(void 0===e&&(e={}),r)throw r;for(var a=!1,i={},c=0;c<s.length;c++){var d=s[c],l=n[d],u=e[d],f=l(u,t);if(void 0===f)throw t&&t.type,new Error(o(14));i[d]=f,a=a||f!==u}return(a=a||s.length!==Object.keys(e).length)?i:e}}function p(e,t){return function(){return t(e.apply(this,arguments))}}function m(e,t){if("function"==typeof e)return p(e,t);if("object"!=typeof e||null===e)throw new Error(o(16));var n={};for(var a in e){var i=e[a];"function"==typeof i&&(n[a]=p(i,t))}return n}function _(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),a=function(){throw new Error(o(15))},i={getState:n.getState,dispatch:function(){return a.apply(void 0,arguments)}},s=t.map(function(e){return e(i)});return a=_.apply(void 0,s)(n.dispatch),r(r({},n),{},{dispatch:a})}}}},Z95U:function(e,t){e.exports=r},a1Kd:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("25SK"),i=void 0;try{i=window}catch(e){}function r(e){if(!a.e&&void 0!==i){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:i}}},"aRo/":function(e,t,n){e.exports=n("bMS4")()},ak4t:function(e,t,n){"use strict";e.exports=n("mr3P")},ayVK:function(e,t,n){"use strict";n.r(t),n.d(t,"Provider",function(){return l}),n.d(t,"connectAdvanced",function(){return C}),n.d(t,"ReactReduxContext",function(){return r}),n.d(t,"connect",function(){return z}),n.d(t,"useDispatch",function(){return Q}),n.d(t,"createDispatchHook",function(){return q}),n.d(t,"useSelector",function(){return Z}),n.d(t,"createSelectorHook",function(){return J}),n.d(t,"useStore",function(){return W}),n.d(t,"createStoreHook",function(){return K}),n.d(t,"shallowEqual",function(){return w}),n.d(t,"batch",function(){return $.unstable_batchedUpdates});var a=n("cDcd"),i=n.n(a),r=(n("aRo/"),i.a.createContext(null)),o=function(e){e()},s={notify:function(){},get:function(){return[]}};function c(e,t){var n,a=s;function i(){c.onStateChange&&c.onStateChange()}function r(){var r,s,c;n||(n=t?t.addNestedSub(i):e.subscribe(i),r=o,s=null,c=null,a={clear:function(){s=null,c=null},notify:function(){r(function(){for(var e=s;e;)e.callback(),e=e.next})},get:function(){for(var e=[],t=s;t;)e.push(t),t=t.next;return e},subscribe:function(e){var t=!0,n=c={callback:e,next:null,prev:c};return n.prev?n.prev.next=n:s=n,function(){t&&null!==s&&(t=!1,n.next?n.next.prev=n.prev:c=n.prev,n.prev?n.prev.next=n.next:s=n.next)}}})}var c={addNestedSub:function(e){return r(),a.subscribe(e)},notifyNestedSubs:function(){a.notify()},handleChangeWrapper:i,isSubscribed:function(){return Boolean(n)},trySubscribe:r,tryUnsubscribe:function(){n&&(n(),n=void 0,a.clear(),a=s)},getListeners:function(){return a}};return c}var d="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?a.useLayoutEffect:a.useEffect,l=function(e){var t=e.store,n=e.context,o=e.children,s=Object(a.useMemo)(function(){var e=c(t);return{store:t,subscription:e}},[t]),l=Object(a.useMemo)(function(){return t.getState()},[t]);d(function(){var e=s.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),l!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}},[s,l]);var u=n||r;return i.a.createElement(u.Provider,{value:s},o)};function u(){return u=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u.apply(this,arguments)}function f(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}var p=n("3/f9"),m=n.n(p),_=n("0m5E"),h=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],b=["reactReduxForwardedRef"],g=[],v=[null,null];function y(e,t){var n=e[1];return[t.payload,n+1]}function S(e,t,n){d(function(){return e.apply(void 0,t)},n)}function D(e,t,n,a,i,r,o){e.current=a,t.current=i,n.current=!1,r.current&&(r.current=null,o())}function I(e,t,n,a,i,r,o,s,c,d){if(e){var l=!1,u=null,f=function(){if(!l){var e,n,f=t.getState();try{e=a(f,i.current)}catch(e){n=e,u=e}n||(u=null),e===r.current?o.current||c():(r.current=e,s.current=e,o.current=!0,d({type:"STORE_UPDATED",payload:{error:n}}))}};return n.onStateChange=f,n.trySubscribe(),f(),function(){if(l=!0,n.tryUnsubscribe(),n.onStateChange=null,u)throw u}}}var x=function(){return[null,0]};function C(e,t){void 0===t&&(t={});var n=t,o=n.getDisplayName,s=void 0===o?function(e){return"ConnectAdvanced("+e+")"}:o,d=n.methodName,l=void 0===d?"connectAdvanced":d,p=n.renderCountProp,C=void 0===p?void 0:p,O=n.shouldHandleStateChanges,w=void 0===O||O,E=n.storeKey,A=void 0===E?"store":E,L=(n.withRef,n.forwardRef),k=void 0!==L&&L,M=n.context,P=void 0===M?r:M,T=f(n,h),U=P;return function(t){var n=t.displayName||t.name||"Component",r=s(n),o=u({},T,{getDisplayName:s,methodName:l,renderCountProp:C,shouldHandleStateChanges:w,storeKey:A,displayName:r,wrappedComponentName:n,WrappedComponent:t}),d=T.pure,p=d?a.useMemo:function(e){return e()};function h(n){var r=Object(a.useMemo)(function(){var e=n.reactReduxForwardedRef,t=f(n,b);return[n.context,e,t]},[n]),s=r[0],d=r[1],l=r[2],m=Object(a.useMemo)(function(){return s&&s.Consumer&&Object(_.isContextConsumer)(i.a.createElement(s.Consumer,null))?s:U},[s,U]),h=Object(a.useContext)(m),C=Boolean(n.store)&&Boolean(n.store.getState)&&Boolean(n.store.dispatch);Boolean(h)&&Boolean(h.store);var O=C?n.store:h.store,E=Object(a.useMemo)(function(){return function(t){return e(t.dispatch,o)}(O)},[O]),A=Object(a.useMemo)(function(){if(!w)return v;var e=c(O,C?null:h.subscription),t=e.notifyNestedSubs.bind(e);return[e,t]},[O,C,h]),L=A[0],k=A[1],M=Object(a.useMemo)(function(){return C?h:u({},h,{subscription:L})},[C,h,L]),P=Object(a.useReducer)(y,g,x),T=P[0][0],F=P[1];if(T&&T.error)throw T.error;var H=Object(a.useRef)(),R=Object(a.useRef)(l),N=Object(a.useRef)(),B=Object(a.useRef)(!1),j=p(function(){return N.current&&l===R.current?N.current:E(O.getState(),l)},[O,T,l]);S(D,[R,H,B,l,j,N,k]),S(I,[w,O,L,E,R,H,B,N,k,F],[O,L,E]);var V=Object(a.useMemo)(function(){return i.a.createElement(t,u({},j,{ref:d}))},[d,t,j]);return Object(a.useMemo)(function(){return w?i.a.createElement(m.Provider,{value:M},V):V},[m,V,M])}var O=d?i.a.memo(h):h;if(O.WrappedComponent=t,O.displayName=h.displayName=r,k){var E=i.a.forwardRef(function(e,t){return i.a.createElement(O,u({},e,{reactReduxForwardedRef:t}))});return E.displayName=r,E.WrappedComponent=t,m()(E,t)}return m()(O,t)}}function O(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function w(e,t){if(O(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(var i=0;i<n.length;i++)if(!Object.prototype.hasOwnProperty.call(t,n[i])||!O(e[n[i]],t[n[i]]))return!1;return!0}function E(e){return function(t,n){var a=e(t,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function A(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function L(e,t){return function(t,n){n.displayName;var a=function(e,t){return a.dependsOnOwnProps?a.mapToProps(e,t):a.mapToProps(e)};return a.dependsOnOwnProps=!0,a.mapToProps=function(t,n){a.mapToProps=e,a.dependsOnOwnProps=A(e);var i=a(t,n);return"function"==typeof i&&(a.mapToProps=i,a.dependsOnOwnProps=A(i),i=a(t,n)),i},a}}var k=[function(e){return"function"==typeof e?L(e):void 0},function(e){return e?void 0:E(function(e){return{dispatch:e}})},function(e){return e&&"object"==typeof e?E(function(t){return function(e,t){var n={},a=function(a){var i=e[a];"function"==typeof i&&(n[a]=function(){return t(i.apply(void 0,arguments))})};for(var i in e)a(i);return n}(e,t)}):void 0}],M=[function(e){return"function"==typeof e?L(e):void 0},function(e){return e?void 0:E(function(){return{}})}];function P(e,t,n){return u({},n,e,t)}var T=[function(e){return"function"==typeof e?function(e){return function(t,n){n.displayName;var a,i=n.pure,r=n.areMergedPropsEqual,o=!1;return function(t,n,s){var c=e(t,n,s);return o?i&&r(c,a)||(a=c):(o=!0,a=c),a}}}(e):void 0},function(e){return e?void 0:function(){return P}}],U=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function F(e,t,n,a){return function(i,r){return n(e(i,r),t(a,r),r)}}function H(e,t,n,a,i){var r,o,s,c,d,l=i.areStatesEqual,u=i.areOwnPropsEqual,f=i.areStatePropsEqual,p=!1;return function(i,m){return p?function(i,p){var m,_,h=!u(p,o),b=!l(i,r,p,o);return r=i,o=p,h&&b?(s=e(r,o),t.dependsOnOwnProps&&(c=t(a,o)),d=n(s,c,o)):h?(e.dependsOnOwnProps&&(s=e(r,o)),t.dependsOnOwnProps&&(c=t(a,o)),d=n(s,c,o)):b?(m=e(r,o),_=!f(m,s),s=m,_&&(d=n(s,c,o)),d):d}(i,m):(s=e(r=i,o=m),c=t(a,o),d=n(s,c,o),p=!0,d)}}function R(e,t){var n=t.initMapStateToProps,a=t.initMapDispatchToProps,i=t.initMergeProps,r=f(t,U),o=n(e,r),s=a(e,r),c=i(e,r);return(r.pure?H:F)(o,s,c,e,r)}var N=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function B(e,t,n){for(var a=t.length-1;a>=0;a--){var i=t[a](e);if(i)return i}return function(t,a){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+a.wrappedComponentName+".")}}function j(e,t){return e===t}function V(e){var t=void 0===e?{}:e,n=t.connectHOC,a=void 0===n?C:n,i=t.mapStateToPropsFactories,r=void 0===i?M:i,o=t.mapDispatchToPropsFactories,s=void 0===o?k:o,c=t.mergePropsFactories,d=void 0===c?T:c,l=t.selectorFactory,p=void 0===l?R:l;return function(e,t,n,i){void 0===i&&(i={});var o=i,c=o.pure,l=void 0===c||c,m=o.areStatesEqual,_=void 0===m?j:m,h=o.areOwnPropsEqual,b=void 0===h?w:h,g=o.areStatePropsEqual,v=void 0===g?w:g,y=o.areMergedPropsEqual,S=void 0===y?w:y,D=f(o,N),I=B(e,r,"mapStateToProps"),x=B(t,s,"mapDispatchToProps"),C=B(n,d,"mergeProps");return a(p,u({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:I,initMapDispatchToProps:x,initMergeProps:C,pure:l,areStatesEqual:_,areOwnPropsEqual:b,areStatePropsEqual:v,areMergedPropsEqual:S},D))}}var z=V();function G(){return Object(a.useContext)(r)}function K(e){void 0===e&&(e=r);var t=e===r?G:function(){return Object(a.useContext)(e)};return function(){return t().store}}var W=K();function q(e){void 0===e&&(e=r);var t=e===r?W:K(e);return function(){return t().dispatch}}var Q=q(),Y=function(e,t){return e===t};function J(e){void 0===e&&(e=r);var t=e===r?G:function(){return Object(a.useContext)(e)};return function(e,n){void 0===n&&(n=Y);var i=t(),r=function(e,t,n,i){var r,o=Object(a.useReducer)(function(e){return e+1},0)[1],s=Object(a.useMemo)(function(){return c(n,i)},[n,i]),l=Object(a.useRef)(),u=Object(a.useRef)(),f=Object(a.useRef)(),p=Object(a.useRef)(),m=n.getState();try{if(e!==u.current||m!==f.current||l.current){var _=e(m);r=void 0!==p.current&&t(_,p.current)?p.current:_}else r=p.current}catch(e){throw l.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+l.current.stack+"\n\n"),e}return d(function(){u.current=e,f.current=m,p.current=r,l.current=void 0}),d(function(){function e(){try{var e=n.getState();if(e===f.current)return;var a=u.current(e);if(t(a,p.current))return;p.current=a,f.current=e}catch(e){l.current=e}o()}return s.onStateChange=e,s.trySubscribe(),e(),function(){return s.tryUnsubscribe()}},[n,s]),r}(e,n,i.store,i.subscription);return Object(a.useDebugValue)(r),r}}var X,Z=J(),$=n("faye");X=$.unstable_batchedUpdates,o=X},"b+rg":function(e,t,n){"use strict";n.r(t),t.default=n.p+"eraserCursorFallback_dadc9876594b85a5ee3b073d5020d399.cur"},bMS4:function(e,t,n){"use strict";var a=n("yHxl");function i(){}function r(){}r.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,r,o){if(o!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:i};return n.PropTypes=n,n}},bwt4:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_ResponsiveModeIndex},cDcd:function(e,t){e.exports=o},etOd:function(e,t,n){"use strict";function a(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function i(e){return!!e&&!!e[K]}function r(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===W}(e)||Array.isArray(e)||!!e[G]||!!(null===(t=e.constructor)||void 0===t?void 0:t[G])||u(e)||f(e))}function o(e,t,n){void 0===n&&(n=!1),0===s(e)?(n?Object.keys:q)(e).forEach(function(a){n&&"symbol"==typeof a||t(a,e[a],e)}):e.forEach(function(n,a){return t(a,n,e)})}function s(e){var t=e[K];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:u(e)?2:f(e)?3:0}function c(e,t){return 2===s(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function d(e,t,n){var a=s(e);2===a?e.set(t,n):3===a?e.add(n):e[t]=n}function l(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function u(e){return B&&e instanceof Map}function f(e){return j&&e instanceof Set}function p(e){return e.o||e.t}function m(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=Q(e);delete t[K];for(var n=q(t),a=0;a<n.length;a++){var i=n[a],r=t[i];!1===r.writable&&(r.writable=!0,r.configurable=!0),(r.get||r.set)&&(t[i]={configurable:!0,writable:!0,enumerable:r.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function _(e,t){return void 0===t&&(t=!1),b(e)||i(e)||!r(e)||(s(e)>1&&(e.set=e.add=e.clear=e.delete=h),Object.freeze(e),t&&o(e,function(e,t){return _(t,!0)},!0)),e}function h(){a(2)}function b(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function g(e){var t=Y[e];return t||a(18,e),t}function v(){return R}function y(e,t){t&&(g("Patches"),e.u=[],e.s=[],e.v=t)}function S(e){D(e),e.p.forEach(x),e.p=null}function D(e){e===R&&(R=e.l)}function I(e){return R={p:[],l:R,h:e,m:!0,_:0}}function x(e){var t=e[K];0===t.i||1===t.i?t.j():t.O=!0}function C(e,t){t._=t.p.length;var n=t.p[0],i=void 0!==e&&e!==n;return t.h.g||g("ES5").S(t,e,i),i?(n[K].P&&(S(t),a(4)),r(e)&&(e=O(t,e),t.l||E(t,e)),t.u&&g("Patches").M(n[K].t,e,t.u,t.s)):e=O(t,n,[]),S(t),t.u&&t.v(t.u,t.s),e!==z?e:void 0}function O(e,t,n){if(b(t))return t;var a=t[K];if(!a)return o(t,function(i,r){return w(e,a,t,i,r,n)},!0),t;if(a.A!==e)return t;if(!a.P)return E(e,a.t,!0),a.t;if(!a.I){a.I=!0,a.A._--;var i=4===a.i||5===a.i?a.o=m(a.k):a.o,r=i,s=!1;3===a.i&&(r=new Set(i),i.clear(),s=!0),o(r,function(t,r){return w(e,a,i,t,r,n,s)}),E(e,i,!1),n&&e.u&&g("Patches").N(a,n,e.u,e.s)}return a.o}function w(e,t,n,a,o,s,l){if(i(o)){var u=O(e,o,s&&t&&3!==t.i&&!c(t.R,a)?s.concat(a):void 0);if(d(n,a,u),!i(u))return;e.m=!1}else l&&n.add(o);if(r(o)&&!b(o)){if(!e.h.D&&e._<1)return;O(e,o),t&&t.A.l||E(e,o)}}function E(e,t,n){void 0===n&&(n=!1),!e.l&&e.h.D&&e.m&&_(t,n)}function A(e,t){var n=e[K];return(n?p(n):e)[t]}function L(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var a=Object.getOwnPropertyDescriptor(n,t);if(a)return a;n=Object.getPrototypeOf(n)}}function k(e){e.P||(e.P=!0,e.l&&k(e.l))}function M(e){e.o||(e.o=m(e.t))}function P(e,t,n){var a=u(t)?g("MapSet").F(t,n):f(t)?g("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),a={i:n?1:0,A:t?t.A:v(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=a,r=J;n&&(i=[a],r=X);var o=Proxy.revocable(i,r),s=o.revoke,c=o.proxy;return a.k=c,a.j=s,c}(t,n):g("ES5").J(t,n);return(n?n.A:v()).p.push(a),a}function T(e){return i(e)||a(22,e),function e(t){if(!r(t))return t;var n,a=t[K],i=s(t);if(a){if(!a.P&&(a.i<4||!g("ES5").K(a)))return a.t;a.I=!0,n=U(t,i),a.I=!1}else n=U(t,i);return o(n,function(t,i){a&&function(e,t){return 2===s(e)?e.get(t):e[t]}(a.t,t)===i||d(n,t,e(i))}),3===i?new Set(n):n}(e)}function U(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return m(e)}function F(){function e(e,t){var n=r[e];return n?n.enumerable=t:r[e]=n={configurable:!0,enumerable:t,get:function(){var t=this[K];return J.get(t,e)},set:function(t){var n=this[K];J.set(n,e,t)}},n}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][K];if(!i.P)switch(i.i){case 5:a(i)&&k(i);break;case 4:n(i)&&k(i)}}}function n(e){for(var t=e.t,n=e.k,a=q(n),i=a.length-1;i>=0;i--){var r=a[i];if(r!==K){var o=t[r];if(void 0===o&&!c(t,r))return!0;var s=n[r],d=s&&s[K];if(d?d.t!==o:!l(s,o))return!0}}var u=!!t[K];return a.length!==q(t).length+(u?0:1)}function a(e){var t=e.k;if(t.length!==e.t.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);if(n&&!n.get)return!0;for(var a=0;a<t.length;a++)if(!t.hasOwnProperty(a))return!0;return!1}var r={};!function(e,t){Y.ES5||(Y.ES5=t)}(0,{J:function(t,n){var a=Array.isArray(t),i=function(t,n){if(t){for(var a=Array(n.length),i=0;i<n.length;i++)Object.defineProperty(a,""+i,e(i,!0));return a}var r=Q(n);delete r[K];for(var o=q(r),s=0;s<o.length;s++){var c=o[s];r[c]=e(c,t||!!r[c].enumerable)}return Object.create(Object.getPrototypeOf(n),r)}(a,t),r={i:a?5:4,A:n?n.A:v(),P:!1,I:!1,R:{},l:n,t:t,k:i,o:null,O:!1,C:!1};return Object.defineProperty(i,K,{value:r,writable:!0}),i},S:function(e,n,r){r?i(n)&&n[K].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var n=t[K];if(n){var i=n.t,r=n.k,s=n.R,d=n.i;if(4===d)o(r,function(t){t!==K&&(void 0!==i[t]||c(i,t)?s[t]||e(r[t]):(s[t]=!0,k(n)))}),o(i,function(e){void 0!==r[e]||c(r,e)||(s[e]=!1,k(n))});else if(5===d){if(a(n)&&(k(n),s.length=!0),r.length<i.length)for(var l=r.length;l<i.length;l++)s[l]=!1;else for(var u=i.length;u<r.length;u++)s[u]=!0;for(var f=Math.min(r.length,i.length),p=0;p<f;p++)r.hasOwnProperty(p)||(s[p]=!0),void 0===s[p]&&e(r[p])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?n(e):a(e)}})}n.d(t,"e",function(){return T}),n.d(t,"n",function(){return F}),n.d(t,"a",function(){return i}),n.d(t,"i",function(){return r});var H,R,N="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),B="undefined"!=typeof Map,j="undefined"!=typeof Set,V="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,z=N?Symbol.for("immer-nothing"):((H={})["immer-nothing"]=!0,H),G=N?Symbol.for("immer-draftable"):"__$immer_draftable",K=N?Symbol.for("immer-state"):"__$immer_state",W=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),q="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,Q=Object.getOwnPropertyDescriptors||function(e){var t={};return q(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},Y={},J={get:function(e,t){if(t===K)return e;var n=p(e);if(!c(n,t))return function(e,t,n){var a,i=L(t,n);return i?"value"in i?i.value:null===(a=i.get)||void 0===a?void 0:a.call(e.k):void 0}(e,n,t);var a=n[t];return e.I||!r(a)?a:a===A(e.t,t)?(M(e),e.o[t]=P(e.A.h,a,e)):a},has:function(e,t){return t in p(e)},ownKeys:function(e){return Reflect.ownKeys(p(e))},set:function(e,t,n){var a=L(p(e),t);if(null==a?void 0:a.set)return a.set.call(e.k,n),!0;if(!e.P){var i=A(p(e),t),r=null==i?void 0:i[K];if(r&&r.t===n)return e.o[t]=n,e.R[t]=!1,!0;if(l(n,i)&&(void 0!==n||c(e.t,t)))return!0;M(e),k(e)}return e.o[t]===n&&(void 0!==n||t in e.o)||Number.isNaN(n)&&Number.isNaN(e.o[t])||(e.o[t]=n,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==A(e.t,t)||t in e.t?(e.R[t]=!1,M(e),k(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=p(e),a=Reflect.getOwnPropertyDescriptor(n,t);return a?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:a.enumerable,value:n[t]}:a},defineProperty:function(){a(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){a(12)}},X={};o(J,function(e,t){X[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),X.deleteProperty=function(e,t){return X.set.call(this,e,t,void 0)},X.set=function(e,t,n){return J.set.call(this,e[0],t,n,e[0])};var Z=function(){function e(e){var t=this;this.g=V,this.D=!0,this.produce=function(e,n,i){if("function"==typeof e&&"function"!=typeof n){var o=n;n=e;var s=t;return function(e){var t=this;void 0===e&&(e=o);for(var a=arguments.length,i=Array(a>1?a-1:0),r=1;r<a;r++)i[r-1]=arguments[r];return s.produce(e,function(e){var a;return(a=n).call.apply(a,[t,e].concat(i))})}}var c;if("function"!=typeof n&&a(6),void 0!==i&&"function"!=typeof i&&a(7),r(e)){var d=I(t),l=P(t,e,void 0),u=!0;try{c=n(l),u=!1}finally{u?S(d):D(d)}return"undefined"!=typeof Promise&&c instanceof Promise?c.then(function(e){return y(d,i),C(e,d)},function(e){throw S(d),e}):(y(d,i),C(c,d))}if(!e||"object"!=typeof e){if(void 0===(c=n(e))&&(c=e),c===z&&(c=void 0),t.D&&_(c,!0),i){var f=[],p=[];g("Patches").M(e,c,f,p),i(f,p)}return c}a(21,e)},this.produceWithPatches=function(e,n){if("function"==typeof e)return function(n){for(var a=arguments.length,i=Array(a>1?a-1:0),r=1;r<a;r++)i[r-1]=arguments[r];return t.produceWithPatches(n,function(t){return e.apply(void 0,[t].concat(i))})};var a,i,r=t.produce(e,n,function(e,t){a=e,i=t});return"undefined"!=typeof Promise&&r instanceof Promise?r.then(function(e){return[e,a,i]}):[r,a,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){r(e)||a(8),i(e)&&(e=T(e));var t=I(this),n=P(this,e,void 0);return n[K].C=!0,D(t),n},t.finishDraft=function(e,t){var n=(e&&e[K]).A;return y(n,t),C(void 0,n)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!V&&a(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var a=t[n];if(0===a.path.length&&"replace"===a.op){e=a.value;break}}n>-1&&(t=t.slice(n+1));var r=g("Patches").$;return i(e)?r(e,t):this.produce(e,function(e){return r(e,t)})},e}(),$=new Z,ee=$.produce;$.produceWithPatches.bind($),$.setAutoFreeze.bind($),$.setUseProxies.bind($),$.applyPatches.bind($),$.createDraft.bind($),$.finishDraft.bind($),t.t=ee},faye:function(e,t){e.exports=s},fglE:function(e,t){e.exports=c},fxVk:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_Icon},"hiL/":function(e,t){e.exports=d},i7XZ:function(e,t,n){"use strict";(function(e,a){n.d(t,"e",function(){return D}),n.d(t,"t",function(){return I}),n.d(t,"n",function(){return C});var i,r=n("etOd"),o=(n("+JwG"),n("YKZg")),s=n("CJ0j"),c=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e,t){for(var n=0,a=t.length,i=e.length;n<a;n++,i++)e[i]=t[n];return e},l=Object.defineProperty,u=Object.defineProperties,f=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,h=function(e,t,n){return t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},b=function(e,t){for(var n in t||(t={}))m.call(t,n)&&h(e,n,t[n]);if(p)for(var a=0,i=p(t);a<i.length;a++)n=i[a],_.call(t,n)&&h(e,n,t[n]);return e},g=function(e,t){return u(e,f(t))},v="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?o.a:o.a.apply(null,arguments)};"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var y=function(e){function t(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var i=e.apply(this,n)||this;return Object.setPrototypeOf(i,t.prototype),i}return c(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,d([void 0],e[0].concat(this)))):new(t.bind.apply(t,d([void 0],e.concat(this))))},t}(Array);function S(e){return Object(r.i)(e)?Object(r.t)(e,function(){}):e}function D(e){var t,n=function(e){return function(e){void 0===e&&(e={});var t=e.thunk,n=void 0===t||t,a=(e.immutableCheck,e.serializableCheck,new y);return n&&("boolean"==typeof n?a.push(s.e):a.push(s.e.withExtraArgument(n.extraArgument))),a}(e)},a=e||{},i=a.reducer,r=void 0===i?void 0:i,c=a.middleware,l=void 0===c?n():c,u=a.devTools,f=void 0===u||u,p=a.preloadedState,m=void 0===p?void 0:p,_=a.enhancers,h=void 0===_?void 0:_;if("function"==typeof r)t=r;else{if(!function(e){if("object"!=typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var n=t;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}(r))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=Object(o.n)(r)}var g=l;"function"==typeof g&&(g=g(n));var S=o.e.apply(void 0,g),D=o.a;f&&(D=v(b({trace:!1},"object"==typeof f&&f)));var I=[S];Array.isArray(h)?I=d([S],h):"function"==typeof h&&(I=h(I));var x=D.apply(void 0,I);return Object(o.i)(t,m,x)}function I(e,t){function n(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];if(t){var i=t.apply(void 0,n);if(!i)throw new Error("prepareAction did not return an object");return b(b({type:e,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:e,payload:n[0]}}return n.toString=function(){return""+e},n.type=e,n.match=function(t){return t.type===e},n}function x(e){var t,n={},a=[],i={addCase:function(e,t){var a="string"==typeof e?e:e.type;if(a in n)throw new Error("addCase cannot be called with two reducers for the same action type");return n[a]=t,i},addMatcher:function(e,t){return a.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[n,a,t]}function C(e){var t=e.name;if(!t)throw new Error("`name` is a required option for createSlice");var n,a="function"==typeof e.initialState?e.initialState:S(e.initialState),i=e.reducers||{},o=Object.keys(i),s={},c={},l={};function u(){var t="function"==typeof e.extraReducers?x(e.extraReducers):[e.extraReducers],n=t[0],i=void 0===n?{}:n,o=t[1],s=void 0===o?[]:o,l=t[2],u=void 0===l?void 0:l,f=b(b({},i),c);return function(e,t,n,a){void 0===n&&(n=[]);var i,o=x(t),s=o[0],c=o[1],l=o[2];if("function"==typeof e)i=function(){return S(e())};else{var u=S(e);i=function(){return u}}function f(e,t){void 0===e&&(e=i());var n=d([s[t.type]],c.filter(function(e){return(0,e.matcher)(t)}).map(function(e){return e.reducer}));return 0===n.filter(function(e){return!!e}).length&&(n=[l]),n.reduce(function(e,n){if(n){var a;if(Object(r.a)(e))return void 0===(a=n(e,t))?e:a;if(Object(r.i)(e))return Object(r.t)(e,function(e){return n(e,t)});if(void 0===(a=n(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return a}return e},e)}return f.getInitialState=i,f}(a,function(e){for(var t in f)e.addCase(t,f[t]);for(var n=0,a=s;n<a.length;n++){var i=a[n];e.addMatcher(i.matcher,i.reducer)}u&&e.addDefaultCase(u)})}return o.forEach(function(e){var n,a,r=i[e],o=t+"/"+e;"reducer"in r?(n=r.reducer,a=r.prepare):n=r,s[e]=n,c[o]=n,l[e]=a?I(o,a):I(o)}),{name:t,reducer:function(e,t){return n||(n=u()),n(e,t)},actions:l,caseReducers:s,getInitialState:function(){return n||(n=u()),n.getInitialState()}}}var O=["name","message","stack","code"],w=function(e,t){this.payload=e,this.meta=t},E=function(e,t){this.payload=e,this.meta=t},A=function(e){if("object"==typeof e&&null!==e){for(var t={},n=0,a=O;n<a.length;n++){var i=a[n];"string"==typeof e[i]&&(t[i]=e[i])}return t}return{message:String(e)}};function L(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}!function(){function e(e,t,n){var a=I(e+"/fulfilled",function(e,t,n,a){return{payload:e,meta:g(b({},a||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})}}),i=I(e+"/pending",function(e,t,n){return{payload:void 0,meta:g(b({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})}}),r=I(e+"/rejected",function(e,t,a,i,r){return{payload:i,error:(n&&n.serializeError||A)(e||"Rejected"),meta:g(b({},r||{}),{arg:a,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}}),o="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign(function(e){return function(s,c,d){var l,u=(null==n?void 0:n.idGenerator)?n.idGenerator(e):function(e){void 0===e&&(e=21);for(var t="",n=e;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),f=new o;function p(e){l=e,f.abort()}var m=function(){return o=this,null,m=function(){var o,m,_,h,b,g;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(v){switch(v.label){case 0:return v.trys.push([0,4,,5]),null===(y=h=null==(o=null==n?void 0:n.condition)?void 0:o.call(n,e,{getState:c,extra:d}))||"object"!=typeof y||"function"!=typeof y.then?[3,2]:[4,h];case 1:h=v.sent(),v.label=2;case 2:if(!1===h||f.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return b=new Promise(function(e,t){return f.signal.addEventListener("abort",function(){return t({name:"AbortError",message:l||"Aborted"})})}),s(i(u,e,null==(m=null==n?void 0:n.getPendingMeta)?void 0:m.call(n,{requestId:u,arg:e},{getState:c,extra:d}))),[4,Promise.race([b,Promise.resolve(t(e,{dispatch:s,getState:c,extra:d,requestId:u,signal:f.signal,abort:p,rejectWithValue:function(e,t){return new w(e,t)},fulfillWithValue:function(e,t){return new E(e,t)}})).then(function(t){if(t instanceof w)throw t;return t instanceof E?a(t.payload,u,e,t.meta):a(t,u,e)})])];case 3:return _=v.sent(),[3,5];case 4:return g=v.sent(),_=g instanceof w?r(null,u,e,g.payload,g.meta):r(g,u,e),[3,5];case 5:return n&&!n.dispatchConditionRejection&&r.match(_)&&_.meta.condition||s(_),[2,_]}var y})},new Promise(function(e,t){var n=function(e){try{i(m.next(e))}catch(e){t(e)}},a=function(e){try{i(m.throw(e))}catch(e){t(e)}},i=function(t){return t.done?e(t.value):Promise.resolve(t.value).then(n,a)};i((m=m.apply(o,null)).next())});var o,m}();return Object.assign(m,{abort:p,requestId:u,arg:e,unwrap:function(){return m.then(L)}})}},{pending:i,rejected:r,fulfilled:a,typePrefix:e})}e.withTypes=function(){return e}}(),Object.assign;var k="listenerMiddleware";I(k+"/add"),I(k+"/removeAll"),I(k+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:void 0!==a?a:globalThis),"undefined"!=typeof window&&window.requestAnimationFrame&&window.requestAnimationFrame,Object(r.n)()}).call(this,n("UvD+"),n("ALV6"))},jOlS:function(e,t){e.exports=l},kPO2:function(e){e.exports=JSON.parse('{"o":"Light","t":"Color","s":"Light Adjustments","n":"Color Adjustments","e":"Brightness","i":"Exposure","a":"Contrast","r":"Highlights","l":"Shadows","d":"Saturation","m":"Warmth","b":"Tint","g":"Vignette","c":"{0} value at {1}. Swipe down then up to access the respective value slider.","f":"{0} value at {1}","u":"{0}. {1}","p":" Drag on slider or use arrow keys to change {0} value","h":"Double tap to select then swipe down then up to select respective value slider","_":"{0} value at {1}","D":"Aspect ratios","y":"Free","S":"Free aspect ratio","I":"Original","x":"Original aspect ratio","w":"Square","E":"Square aspect ratio","O":"{0} : {1}","C":"{0} by {1} aspect ratio","A":"Click or select Enter to see more aspect ratio options","v":"Changed to {0}","Ge":"Flip to portrait","Ke":"Flip to portrait","Ve":"Flip to landscape","ze":"Flip to landscape","N":"Auto Enhance","U":"Generating auto enhance","L":"Applied auto enhance with {0} intensity","j":"Removed auto enhance","R":"Intensity","H":"Auto enhance intensity","P":"Install add-on for Auto Enhance ({0} MB)","T":"Installing add-on ({0} MB)","V":"Retry to install add-on for Auto Enhance","F":"Install Auto Enhance add-on","z":"Retry to install Auto Enhance add-on","k":"Auto Enhance is applied to the image","B":"Auto enhance is not applied to the image","M":"Please save your current work and open the file in the editor again to use auto-enhance","X":"Top left crop handle. Corner pixel position is {0} from the left {1} from the top.","Z":"Top right crop handle. Corner pixel position is {0} from the left {1} from the top.","G":"Bottom left crop handle. Corner pixel position is {0} from the left {1} from the top.","K":"Bottom right crop handle. Corner pixel position is {0} from the left {1} from the top.","W":"Drag handle or use arrow keys to crop the image","q":"Drag the image or use the arrow keys to move image in crop region","J":"Drag the image or use the arrow keys to move image in crop region","Y":"Left {0} Top {1} pixels","Q":"Left {0} Top {1} pixels. Cannot move any further in current direction.","ae":"Viewing Original","ie":"Viewing original image","re":"{0} percent zoom","te":"{0} x {1}","$":"{0} by {1} pixels","ee":"Dimension is {0} by {1} pixels","ne":"{2} to {3} aspect ratio; dimension is {0} by {1} pixels","fe":"Intensity","ue":"{0} intensity","Ae":"Original","_e":"Burn","he":"B&W","be":"Black and White","ge":"B&W Cool","ve":"Black and White Cool","ye":"B&W High Contrast","Se":"Black and White High Contrast","De":"B&W Warm","Ie":"Black and White Warm","Ce":"Cool Light","xe":"Calm","Oe":"Dramatic Cool","we":"Film","Ee":"Golden","Le":"Punch","ke":"Radiate","Me":"Vintage","Pe":"Vivid Cool","Te":"Warm Contrast","ce":"{0} filter has been applied","de":"{0} filter at {1} percent intensity has been applied","pe":"{0} filter has been applied. Swipe down then up to access the respective value slider.","me":"{0} filter at {1} percent intensity has been applied. Swipe down then up to access the respective value slider.","le":"Filters","Ue":"Drag on slider or use arrow keys to change {0} value","Re":"Double tap to select then swipe down then up to select respective value slider","Fe":"{0} filter is in focus but not selected. {1} filter is currently selected at value of {2}","He":"{0} filter is in focus but not selected. Original filter currently selected","se":"{0} filter is currently selected at value of {1}.","oe":"Original is selected","Ye":"Done","bn":"Click and hold or double tap and hold to view the original image","_n":"Click and hold on image to view the original image. Alternatively, double tap on image then hold to view the original image","hn":"No adjustments have been made or filter applied to the image","gn":"Left {0} Top {1} pixels","Sn":"Crop","yn":"Adjustment","Dn":"Filter","xn":"Markup","Cn":"Retouch","In":"Photo in-painting","vn":"{0} tab is in focus and you are at {1} screen currently","wn":"Rotate image 90 degrees counter-clockwise","En":"Rotate counter-clockwise","An":"Rotated 90 degrees counter-clockwise","Ln":"Rotate image 90 degrees clockwise","kn":"Rotate clockwise","Mn":"Rotated 90 degrees clockwise","Pn":"Manual rotate","On":"°","Tn":"Drag or use arrow keys to rotate the image","Ne":"Flip image horizontally","Be":"Flip image horizontally","je":"Flipped image horizontally","We":"Flip image vertically","qe":"Flip image vertically","Qe":"Flipped image vertically","Zn":"Save","ra":"Save options for your image","na":"Save","aa":"Save","_a":"More save options","ia":"Image will be overwritten with the latest edits","$n":"Save as copy","ea":"Save as copy","ta":"Create a new image with the applied edits","Qn":"Reset","Xn":"Reset all edits performed on the image","Yn":"Reset","Jn":"Image edits were reset","ma":"Reset image?","pa":"This will remove all edits made to this image.","la":"Close","fa":"Reset","ua":"Reset","da":"Cancel","ca":"Cancel","Sa":"Zoom level","ya":"Zoom into the image","va":"Zoom in","Ia":"Zoom out of the image","Da":"Zoom out","Gn":"Done","Kn":"Done","Wn":"Done","jn":"Cancel","Vn":"Cancel","zn":"Cancel all edits and return to previous screen","qn":"Fit to window","ga":"Actual size","ha":"Undo","ba":"Undo (Ctrl + Z)","oa":"Redo","sa":"Redo (Ctrl + Y)","Ca":"{0} {1} color adjustment","xa":"{0} auto enhance","Oa":"{0} {1} filter","Aa":"{0} ink stroke","Ea":"{0} erase ink stroke","wa":"{0} clear all ink strokes","Ma":"{0} cropping operation on the image","ka":"{0} aspect ratio change on the image","Pa":"{0} flip","Ta":"{0} rotation","La":"{0} a spot fix","Bn":" Tap on a spot or blemish to fix it.","Un":"Spot fix","Fn":"Left mouse click or tap on a spot or blemish to fix it. To navigate around the image hold right mouse click then drag.","Hn":"Spot fix","Nn":"Drag on slider or use arrow keys to change size","Rn":"Size","Jt":"Pen","Yt":"Pen","Qt":"Select and drag on image to add an ink stroke. Select this button again to change ink properties.","zt":"Remove ink strokes","Vt":"Remove ink strokes","jt":"Select and drag over ink to remove ink strokes.","Wt":"Highlighter","Kt":"Highlighter","Gt":"Select and drag on image to add an ink stroke. Select this button again to change ink properties.","Nt":"Clear all ink strokes","Rt":"Clear all ink strokes","Zt":"Thickness","$e":"Close","at":"Clear all ink strokes?","nt":"All ink strokes applied to the image will be permanently removed.","tt":"Confirm","et":"Confirm","Ze":"Cancel","Xe":"Cancel","Ft":"{0}: {1}, {2}: {3}, {4}","Ht":"{0}: {1}, {2}: {3}, {4} with {5}","$t":"Select again to change ink properties.","Pt":"Stroke Thickness","Mt":"Slider to pick the thickness of the selected brush.","Je":"Added an ink stroke to image, {0}, {1}, thickness {2}","tn":"Removed {0} out of {1} ink strokes","it":"Cleared all ink strokes","kt":"Pen thickness.","Lt":"Highlighter thickness.","Tt":"Drag on slider or use arrow keys to change stroke thickness","Ut":"Markup Toolbar","lt":"Dark Yellow","ht":"Light Orange","gt":"Orange","yt":"Red","ct":"Dark Purple","vt":"Purple","bt":"Magenta","dt":"Dark Red","pt":"Light Blue","ot":"Blue","st":"Dark Blue","_t":"Light Green","ft":"Green","mt":"Light Gray","ut":"Gray","rt":"Black","St":"Colors","en":"No Arrow","cn":"Plain straight line","sn":"Create a plain straight line","nn":"Single Arrow","ln":"Straight line with arrow","dn":"Create a straight line with an arrow at one end","Dt":"Double Arrow","rn":"Straight Line with double arrows","an":"Create a straight line with arrows at both ends","wt":"Plain freehand line","Ot":"Create a plain line by freehand","At":"Freehand line with arrow","Et":"Create a freehand line with an arrow at one end","xt":"Freehand Line with double arrows","It":"Create a freehand line with arrows at both ends","qt":"no arrow","Xt":"arrow end","Bt":"double arrow ends","un":"Straight line","fn":"Activate and draw straight-line fast by holding Shift while left mouse click and drag.","pn":"Hold at end of a stroke to convert into a straight line.","Ct":"Freehand line","on":"Straight line","mn":"Type something"}')},mr3P:function(e,t,n){"use strict";var a="function"==typeof Symbol&&Symbol.for,i=a?Symbol.for("react.element"):60103,r=a?Symbol.for("react.portal"):60106,o=a?Symbol.for("react.fragment"):60107,s=a?Symbol.for("react.strict_mode"):60108,c=a?Symbol.for("react.profiler"):60114,d=a?Symbol.for("react.provider"):60109,l=a?Symbol.for("react.context"):60110,u=a?Symbol.for("react.async_mode"):60111,f=a?Symbol.for("react.concurrent_mode"):60111,p=a?Symbol.for("react.forward_ref"):60112,m=a?Symbol.for("react.suspense"):60113,_=a?Symbol.for("react.suspense_list"):60120,h=a?Symbol.for("react.memo"):60115,b=a?Symbol.for("react.lazy"):60116,g=a?Symbol.for("react.block"):60121,v=a?Symbol.for("react.fundamental"):60117,y=a?Symbol.for("react.responder"):60118,S=a?Symbol.for("react.scope"):60119;function D(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case u:case f:case o:case c:case s:case m:return e;default:switch(e=e&&e.$$typeof){case l:case p:case b:case h:case d:return e;default:return t}}case r:return t}}}function I(e){return D(e)===f}t.AsyncMode=u,t.ConcurrentMode=f,t.ContextConsumer=l,t.ContextProvider=d,t.Element=i,t.ForwardRef=p,t.Fragment=o,t.Lazy=b,t.Memo=h,t.Portal=r,t.Profiler=c,t.StrictMode=s,t.Suspense=m,t.isAsyncMode=function(e){return I(e)||D(e)===u},t.isConcurrentMode=I,t.isContextConsumer=function(e){return D(e)===l},t.isContextProvider=function(e){return D(e)===d},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return D(e)===p},t.isFragment=function(e){return D(e)===o},t.isLazy=function(e){return D(e)===b},t.isMemo=function(e){return D(e)===h},t.isPortal=function(e){return D(e)===r},t.isProfiler=function(e){return D(e)===c},t.isStrictMode=function(e){return D(e)===s},t.isSuspense=function(e){return D(e)===m},t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===o||e===f||e===c||e===s||e===m||e===_||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===h||e.$$typeof===d||e.$$typeof===l||e.$$typeof===p||e.$$typeof===v||e.$$typeof===y||e.$$typeof===S||e.$$typeof===g)},t.typeOf=D},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"AdvancedEditor",function(){return HL}),n.d(t,"ADVANCED_EDITOR_TWO_BY_ONE_ASPECT_ICON_NAME",function(){return FL}),n.d(t,"AdvancedCropper",function(){return GL});var a={};n.r(a),n.d(a,"tile",function(){return x3}),n.d(a,"selectable",function(){return C3}),n.d(a,"selected",function(){return O3}),n.d(a,"isFluentStyling",function(){return w3}),n.d(a,"name",function(){return E3}),n.d(a,"hasBackgroundFrame",function(){return A3}),n.d(a,"invokable",function(){return L3}),n.d(a,"label",function(){return k3}),n.d(a,"description",function(){return M3}),n.d(a,"link",function(){return P3}),n.d(a,"foreground",function(){return T3}),n.d(a,"foregroundHide",function(){return U3}),n.d(a,"hasForegroundFrame",function(){return F3}),n.d(a,"check",function(){return H3}),n.d(a,"uninvokable",function(){return R3}),n.d(a,"showCheck",function(){return N3}),n.d(a,"background",function(){return B3}),n.d(a,"backgroundHide",function(){return j3}),n.d(a,"aboveNameplate",function(){return V3}),n.d(a,"content",function(){return z3}),n.d(a,"nameplate",function(){return G3}),n.d(a,"activity",function(){return K3}),n.d(a,"signal",function(){return W3}),n.d(a,"storageSignal",function(){return q3}),n.d(a,"socialSignal",function(){return Q3}),n.d(a,"lifecycleSignal",function(){return Y3}),n.d(a,"isLarge",function(){return J3}),n.d(a,"isSmall",function(){return X3}),n.d(a,"hasBackground",function(){return Z3}),n.d(a,"onlyOnHover",function(){return $3}),n.d(a,"showBackground",function(){return e2}),n.d(a,"disabled",function(){return t2});var i={};n.r(i),n.d(i,"signal",function(){return n2}),n.d(i,"dark",function(){return a2}),n.d(i,"selected",function(){return i2});var r={};n.r(r),n.d(r,"root",function(){return r2}),n.d(r,"rootIsChecked",function(){return o2}),n.d(r,"check",function(){return s2}),n.d(r,"checkHost",function(){return c2}),n.d(r,"circle",function(){return d2});var o=n("17wl"),s=n("cDcd"),c=n.n(s),d=function(e){return void 0,void 0,n=function(){return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(t){return[2,new Promise(function(t,n){var a=new Image;a.onload=function(){t(a)},a.onerror=function(e){n(e)},a.decoding=a.decoding||"auto",a.crossOrigin="Anonymous",a.src=e})]})},new((t=void 0)||(t=Promise))(function(e,a){function i(e){try{o(n.next(e))}catch(e){a(e)}}function r(e){try{o(n.throw(e))}catch(e){a(e)}}function o(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t(function(e){e(a)})).then(i,r)}o((n=n.apply(undefined,[])).next())});var t,n};function l(e){var t=this,n=Object(s.useState)(null),a=n[0],i=n[1],r=Object(s.useCallback)(function(e){var n,a,r;n=t,r=function(){var t;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(n){switch(n.label){case 0:return e?[4,d(e)]:[3,2];case 1:t=n.sent(),i(t),n.label=2;case 2:return[2]}})},new((a=void 0)||(a=Promise))(function(e,t){function i(e){try{s(r.next(e))}catch(e){t(e)}}function o(e){try{s(r.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a(function(e){e(n)})).then(i,o)}s((r=r.apply(n,[])).next())})},[]);return Object(s.useEffect)(function(){r(e)},[r,e]),[a,r]}var u=n("5pbq"),f=Object(u.createTheme)({palette:{themePrimary:"#2899f5",themeLighterAlt:"#02060a",themeLighter:"#092c47",themeLight:"#043862",themeTertiary:"#004c87",themeSecondary:"#007bd4",themeDarkAlt:"#3aa0f3",themeDark:"#6cb8f6",themeDarker:"#82c7ff",neutralLighterAlt:"#1b1a19",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralPrimaryAlt:"#c8c6c4",neutralPrimary:"#f3f2f1",neutralDark:"#faf9f8",black:"#ffffff",white:"#000000"}}),p=Object(u.createTheme)({}),m={flexBasis:"100%",margin:"10px 0px",padding:"0px 16px"},_=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),h=function(e){function t(t){return e.call(this,"Unhandled value: ".concat(t))||this}return _(t,e),t}(Error),b=function(){return b=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b.apply(this,arguments)},g={width:8,height:9},v={width:8,height:11};function y(e){var t=function(e){return{fontSize:"0px",position:"absolute",zIndex:1,margin:"2px",color:e.palette.neutralDark,fill:e.palette.neutralDark}}(e);return{singleArrow:{root:b(b(b({},t),g),{top:8,right:4})},doubleArrow:{root:b(b(b({},t),v),{top:8,right:4})}}}var S=function(){return S=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},S.apply(this,arguments)};function D(e){return{inkStylePicker:{inkColorPickerStyles:{container:{marginLeft:"-8px",marginRight:"-8px"}},containerStyles:{width:"176px"},getContentWrapperStyle:w,strokeShapePickerStyles:{container:S(S({},O(e)),{justifyContent:"flex-start",columnGap:"8px"}),iconLabelButton:{root:{marginTop:"8px"}}}},canvasContainer:{top:"50%",bottom:"inherit",transform:"translateY(-50%)"},container:{padding:"8px 0",borderRadius:"8px"},inkToolsContainer:{flexDirection:"column",width:"56px"}}}var I={markupToolbarPosition:"Left",canvasContainer:{left:"0",right:"inherit",marginLeft:"24px",marginRight:"inherit"},markupToolbarButton:{root:{transform:"rotate(90deg)"}}},x={root:{left:4}},C={markupToolbarPosition:"Right",canvasContainer:{left:"inherit",right:"0",marginLeft:"inherit",marginRight:"24px"},markupToolbarButton:{root:{transform:"rotate(270deg)"}},markupToolbarArrowIconStyle:{singleArrow:x,doubleArrow:x}};function O(e){return{borderTop:"1px solid ".concat(e.palette.neutralTertiaryAlt),paddingTop:"8px"}}function w(e,t){return void 0===t&&(t=!1),{minHeight:"260px",height:e?"auto":t?"280px":"320px",padding:"0px 10px"}}var E,A=n("vNcA"),L={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(E||(E={}));var k,M,P,T,U,F={elevation4:E.depth4,elevation8:E.depth8,elevation16:E.depth16,elevation64:E.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},H=n("fglE");!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(k||(k={})),function(e){e.Arabic="'".concat(k.Arabic,"'"),e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'".concat(k.Cyrillic,"'"),e.EastEuropean="'".concat(k.EastEuropean,"'"),e.Greek="'".concat(k.Greek,"'"),e.Hebrew="'".concat(k.Hebrew,"'"),e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'".concat(k.Selawik,"'"),e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'".concat(k.Vietnamese,"'"),e.WestEuropean="'".concat(k.WestEuropean,"'"),e.Armenian="'".concat(k.Armenian,"'"),e.Georgian="'".concat(k.Georgian,"'")}(M||(M={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(P||(P={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(T||(T={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(U||(U={}));var R="'Segoe UI', '".concat(k.WestEuropean,"'"),N={ar:M.Arabic,bg:M.Cyrillic,cs:M.EastEuropean,el:M.Greek,et:M.EastEuropean,he:M.Hebrew,hi:M.Hindi,hr:M.EastEuropean,hu:M.EastEuropean,ja:M.Japanese,kk:M.EastEuropean,ko:M.Korean,lt:M.EastEuropean,lv:M.EastEuropean,pl:M.EastEuropean,ru:M.Cyrillic,sk:M.EastEuropean,"sr-latn":M.EastEuropean,th:M.Thai,tr:M.EastEuropean,uk:M.Cyrillic,vi:M.Vietnamese,"zh-hans":M.ChineseSimplified,"zh-hant":M.ChineseTraditional,hy:M.Armenian,ka:M.Georgian};function B(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var j,V,z,G,K,W=(j=function(e){for(var t in N)if(N.hasOwnProperty(t)&&e&&0===t.indexOf(e))return N[t];return R}(Object(A.getLanguage)()),V="".concat(j,", ").concat("'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif"),{tiny:B(P.mini,T.regular,V),xSmall:B(P.xSmall,T.regular,V),small:B(P.small,T.regular,V),smallPlus:B(P.smallPlus,T.regular,V),medium:B(P.medium,T.regular,V),mediumPlus:B(P.mediumPlus,T.regular,V),large:B(P.large,T.regular,V),xLarge:B(P.xLarge,T.semibold,V),xLargePlus:B(P.xLargePlus,T.semibold,V),xxLarge:B(P.xxLarge,T.semibold,V),xxLargePlus:B(P.xxLargePlus,T.semibold,V),superLarge:B(P.superLarge,T.semibold,V),mega:B(P.mega,T.semibold,V)});function q(e,t,n,a){e="'".concat(e,"'");var i=void 0!==a?"local('".concat(a,"'),"):"";Object(H.fontFace)({fontFamily:e,src:i+"url('".concat(t,".woff2') format('woff2'),")+"url('".concat(t,".woff') format('woff')"),fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function Q(e,t,n,a,i){void 0===a&&(a="segoeui");var r="".concat(e,"/").concat(n,"/").concat(a);q(t,r+"-light",T.light,i&&i+" Light"),q(t,r+"-semilight",T.semilight,i&&i+" SemiLight"),q(t,r+"-regular",T.regular,i),q(t,r+"-semibold",T.semibold,i&&i+" SemiBold"),q(t,r+"-bold",T.bold,i&&i+" Bold")}function Y(e,t,n,a,i){return void 0===i&&(i=!1),function(e,t){var n="";return!0===t&&(n=" /* @deprecated */"),e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(J(e,t,Object(o.__assign)({primaryButtonBorder:"transparent",errorText:a?"#F1707B":"#a4262c",messageText:a?"#F3F2F1":"#323130",messageLink:a?"#6CB8F6":"#005A9E",messageLinkHovered:a?"#82C7FF":"#004578",infoIcon:a?"#C8C6C4":"#605e5c",errorIcon:a?"#F1707B":"#A80000",blockingIcon:a?"#442726":"#FDE7E9",warningIcon:a?"#C8C6C4":"#797775",severeWarningIcon:a?"#FCE100":"#D83B01",successIcon:a?"#92C353":"#107C10",infoBackground:a?"#323130":"#f3f2f1",errorBackground:a?"#442726":"#FDE7E9",blockingBackground:a?"#442726":"#FDE7E9",warningBackground:a?"#433519":"#FFF4CE",severeWarningBackground:a?"#4F2A0F":"#FED9CC",successBackground:a?"#393D1B":"#DFF6DD",warningHighlight:a?"#fff100":"#ffb900",successText:a?"#92c353":"#107C10"},n),a),i)}function J(e,t,n,a,i){void 0===i&&(i=!1);var r={},s=e||{},c=s.white,d=s.black,l=s.themePrimary,u=s.themeDark,f=s.themeDarker,p=s.themeDarkAlt,m=s.themeLighter,_=s.neutralLight,h=s.neutralLighter,b=s.neutralDark,g=s.neutralQuaternary,v=s.neutralQuaternaryAlt,y=s.neutralPrimary,S=s.neutralSecondary,D=s.neutralSecondaryAlt,I=s.neutralTertiary,x=s.neutralTertiaryAlt,C=s.neutralLighterAlt,O=s.accent;return c&&(r.bodyBackground=c,r.bodyFrameBackground=c,r.accentButtonText=c,r.buttonBackground=c,r.primaryButtonText=c,r.primaryButtonTextHovered=c,r.primaryButtonTextPressed=c,r.inputBackground=c,r.inputForegroundChecked=c,r.listBackground=c,r.menuBackground=c,r.cardStandoutBackground=c),d&&(r.bodyTextChecked=d,r.buttonTextCheckedHovered=d),l&&(r.link=l,r.primaryButtonBackground=l,r.inputBackgroundChecked=l,r.inputIcon=l,r.inputFocusBorderAlt=l,r.menuIcon=l,r.menuHeader=l,r.accentButtonBackground=l),u&&(r.primaryButtonBackgroundPressed=u,r.inputBackgroundCheckedHovered=u,r.inputIconHovered=u),f&&(r.linkHovered=f),p&&(r.primaryButtonBackgroundHovered=p),m&&(r.inputPlaceholderBackgroundChecked=m),_&&(r.bodyBackgroundChecked=_,r.bodyFrameDivider=_,r.bodyDivider=_,r.variantBorder=_,r.buttonBackgroundCheckedHovered=_,r.buttonBackgroundPressed=_,r.listItemBackgroundChecked=_,r.listHeaderBackgroundPressed=_,r.menuItemBackgroundPressed=_,r.menuItemBackgroundChecked=_),h&&(r.bodyBackgroundHovered=h,r.buttonBackgroundHovered=h,r.buttonBackgroundDisabled=h,r.buttonBorderDisabled=h,r.primaryButtonBackgroundDisabled=h,r.disabledBackground=h,r.listItemBackgroundHovered=h,r.listHeaderBackgroundHovered=h,r.menuItemBackgroundHovered=h),g&&(r.primaryButtonTextDisabled=g,r.disabledSubtext=g),v&&(r.listItemBackgroundCheckedHovered=v),I&&(r.disabledBodyText=I,r.variantBorderHovered=(null==n?void 0:n.variantBorderHovered)||I,r.buttonTextDisabled=I,r.inputIconDisabled=I,r.disabledText=I),y&&(r.bodyText=y,r.actionLink=y,r.buttonText=y,r.inputBorderHovered=y,r.inputText=y,r.listText=y,r.menuItemText=y),C&&(r.bodyStandoutBackground=C,r.defaultStateBackground=C),b&&(r.actionLinkHovered=b,r.buttonTextHovered=b,r.buttonTextChecked=b,r.buttonTextPressed=b,r.inputTextHovered=b,r.menuItemTextHovered=b),S&&(r.bodySubtext=S,r.focusBorder=S,r.inputBorder=S,r.smallInputBorder=S,r.inputPlaceholderText=S),D&&(r.buttonBorder=D),x&&(r.disabledBodySubtext=x,r.disabledBorder=x,r.buttonBackgroundChecked=x,r.menuDivider=x),O&&(r.accentButtonBackground=O),(null==t?void 0:t.elevation4)&&(r.cardShadow=t.elevation4),!a&&(null==t?void 0:t.elevation8)?r.cardShadowHovered=t.elevation8:r.variantBorderHovered&&(r.cardShadowHovered="0 0 1px "+r.variantBorderHovered),Object(o.__assign)(Object(o.__assign)({},r),n)}!function(e){if(e){var t="".concat(e,"/fonts");Q(t,k.Thai,"leelawadeeui-thai","leelawadeeui"),Q(t,k.Arabic,"segoeui-arabic"),Q(t,k.Cyrillic,"segoeui-cyrillic"),Q(t,k.EastEuropean,"segoeui-easteuropean"),Q(t,k.Greek,"segoeui-greek"),Q(t,k.Hebrew,"segoeui-hebrew"),Q(t,k.Vietnamese,"segoeui-vietnamese"),Q(t,k.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),Q(t,M.Selawik,"selawik","selawik"),Q(t,k.Armenian,"segoeui-armenian"),Q(t,k.Georgian,"segoeui-georgian"),q("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-semilight"),T.light),q("Leelawadee UI Web","".concat(t,"/leelawadeeui-thai/leelawadeeui-bold"),T.semibold)}}((K=null===(z=Object(A.getWindow)())||void 0===z?void 0:z.FabricConfig,null!==(G=null==K?void 0:K.fontBaseUrl)&&void 0!==G?G:"https://res-1.cdn.office.net/files/fabric-cdn-prod_20221209.001/assets"));var X={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},Z=s.createContext(void 0),$=function(){var e=Object(s.useContext)(Z),t=Object(A.useCustomizationSettings)(["theme"]).theme;return e||t||function(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted;return function(e,t){var n,a,i;void 0===t&&(t={});var r=Object(A.merge)({},e,t,{semanticColors:J(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(a=t.palette)||void 0===a?void 0:a.accent)&&(r.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var o=0,s=Object.keys(r.fonts);o<s.length;o++){var c=s[o];r.fonts[c]=Object(A.merge)(r.fonts[c],t.defaultFontStyle,null===(i=null==t?void 0:t.fonts)||void 0===i?void 0:i[c])}return r}({palette:L,effects:F,fonts:W,spacing:X,isInverted:n,disableGlobalClassNames:!1,semanticColors:Y(L,F,void 0,n,t),rtl:void 0},e)}({})},ee=n("ayVK"),te=n("i7XZ"),ne=Object(te.t)("edit/handlePointerDown"),ae=Object(te.t)("edit/handlePointerUp"),ie=Object(te.t)("edit/handlePointerMove"),re=Object(te.t)("edit/handlePointerEnter"),oe=Object(te.t)("edit/handlePointerLeave"),se=Object(te.t)("edit/resetEdits"),ce=Object(te.t)("edit/setEdits"),de=Object(te.t)("edit/requestTexturePatch"),le=Date.now(),ue=le;function fe(){var e=le+window.performance.now();return e<=ue&&(e=ue+1e-6),ue=e,e}var pe=Object(te.t)("edit/undo"),me=Object(te.t)("edit/redo"),_e=Object(te.t)("edit/removeStackItems"),he=Object(te.t)("edit/clearRedo"),be=Object(te.t)("edit/collapseStackItems");function ge(e,t,n,a){return{id:e,undoPayload:t,redoPayload:n,sequence:fe(),sequentialDuplicateAction:a}}function ve(e,t,n){return n?t.find(function(t,a){return t.sequence===e&&a===n}):t.find(function(t){return t.sequence===e})}function ye(e,t,n){var a=ve(e,t,t.length-1);a&&(t.pop(),a.sequence=fe()),n(a)}function Se(e,t){var n=t.undoReducer,a=t.redoReducer,i=t.removeItemsReducer,r=t.collapseItemsReducer,o=t.afterClearRedoStacksReducer;e.addCase(pe,function(e,t){ye(t.payload.timestamp,e.undoRedoStack.undoStack,function(t){t&&n(e,t)})}).addCase(me,function(e,t){ye(t.payload.timestamp,e.undoRedoStack.redoStack,function(t){t&&a(e,t)})}).addCase(_e,function(e,t){var n,a,r,o;n=t.payload,a=e.undoRedoStack.undoStack,r=function(t){i(e,t)},o=function(e,t){for(var n=[],a=0,i=e;a<i.length;a++){var r=ve(i[a],t);r&&n.push(r)}return n}(n,a).map(function(e){return e.sequence}),o.length>0&&r(a.filter(function(e){return!o.includes(e.sequence)}))}).addCase(he,function(e,t){e.undoRedoStack.redoStack.length=0,o&&o(e)}).addCase(be,function(e,t){var n,a,i,o,s;n={start:t.payload.start,end:t.payload.end},a=e.undoRedoStack.undoStack,i=function(n){r(e,t,n)},o=ve(n.start,a),s=ve(n.end,a),o&&s?i({sequence:fe(),id:o.id,sequentialDuplicateAction:s.sequentialDuplicateAction,undoPayload:o.undoPayload,redoPayload:s.redoPayload}):(o&&i(o),s&&i(s))})}var De,Ie={undoReducer:function(e,t){e.undoRedoStack.redoStack.push(t),e[t.undoPayload.adjustmentKey]=t.undoPayload.adjustmentValue},redoReducer:function(e,t){e.undoRedoStack.undoStack.push(t),e[t.redoPayload.adjustmentKey]=t.redoPayload.adjustmentValue},removeItemsReducer:function(e,t){e.undoRedoStack.undoStack=t},collapseItemsReducer:function(e,t,n){e.undoRedoStack.undoStack=e.undoRedoStack.undoStack.filter(function(e){return e.sequence!==t.payload.start&&e.sequence!==t.payload.end}),e.undoRedoStack.undoStack.push(n)}};!function(e){e.Brightness="brightness",e.Exposure="exposure",e.Contrast="contrast",e.Highlights="highlights",e.Shadows="shadows",e.Saturation="saturation",e.Temperature="temperature",e.Tint="tint",e.Vignette="vignette"}(De||(De={}));var xe,Ce={sliderMinValue:-100,sliderMaxValue:100,sliderStepValue:1,sliderValueFormat:function(e){return e.toFixed(0)},sliderDeadZoneOffset:4};function Oe(e,t){return{iconName:e,configuration:t||Ce}}var we,Ee=((xe={})[De.Exposure]=Oe("Exposure-Havana"),xe[De.Brightness]=Oe("Brightness-Havana"),xe[De.Contrast]=Oe("Contrast-Havana"),xe[De.Highlights]=Oe("Highlights-Havana"),xe[De.Shadows]=Oe("Shadows-Havana"),xe[De.Saturation]=Oe("Saturation-Havana"),xe[De.Temperature]=Oe("Temperature-Havana"),xe[De.Tint]=Oe("Tint-Havana"),xe[De.Vignette]=Oe("Vignette-Havana"),xe);!function(e){e.Version1="Version 1",e.Test="Test",e.Latest="Version 1"}(we||(we={}));var Ae,Le,ke,Me=function(){return Me=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Me.apply(this,arguments)},Pe=Me(Me({},(Ae={},Object.values(De).forEach(function(e){Ae[e]=.5}),Ae)),{version:we.Latest,maskLevel:0}),Te=Me(Me({},Pe),{undoRedoStack:{undoStack:[],redoStack:[],id:"colorAdjustmentUndoRedoStack"},disableUndoOverride:!1,disableRedoOverride:!1}),Ue=function(){return Ue=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ue.apply(this,arguments)};function Fe(e,t){return t?Ue(Ue({},e),t):e}function He(e,t){var n=function(e,t){return(n=t)instanceof Object&&!(n instanceof Array)?Object.keys(n).sort().reduce(function(e,t){return e[t]=n[t],e},{}):n;var n};return JSON.stringify(e,n)!==JSON.stringify(t,n)}!function(e){e[e.KeepAll=0]="KeepAll",e[e.KeepFirst=1]="KeepFirst",e[e.KeepLast=2]="KeepLast"}(Le||(Le={}));var Re,Ne=((ke={})[De.Brightness]="colorAdjustmentBrightness",ke[De.Exposure]="colorAdjustmentExposure",ke[De.Contrast]="colorAdjustmentContrast",ke[De.Highlights]="colorAdjustmentHighlights",ke[De.Shadows]="colorAdjustmentShadows",ke[De.Saturation]="colorAdjustmentSaturation",ke[De.Temperature]="colorAdjustmentTemperature",ke[De.Tint]="colorAdjustmentTint",ke[De.Vignette]="colorAdjustmentVignette",ke),Be=function(){return Be=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Be.apply(this,arguments)},je=Object(te.n)({name:"colorAdjustments",initialState:Te,reducers:{setAdjustmentValue:function(e,t){!function(e,t){if(e.undoPayload||(e.undoPayload={adjustmentKey:t.payload.adjustmentKey,adjustmentValue:e[t.payload.adjustmentKey]},e.disableUndoOverride=!0,e.disableRedoOverride=!0),e[t.payload.adjustmentKey]=t.payload.adjustmentValue,t.payload.isUndoRedoable){var n={adjustmentKey:t.payload.adjustmentKey,adjustmentValue:t.payload.adjustmentValue};if(He(e.undoPayload,n)){var a=ge(Ne[t.payload.adjustmentKey],e.undoPayload,n,Le.KeepAll);e.undoRedoStack.undoStack.push(a)}e.undoPayload=void 0,e.disableUndoOverride=!1,e.disableRedoOverride=!1}}(e,t)},setAllAdjustments:function(e,t){return Fe(e,t.payload)},setAdjustmentVersion:function(e,t){e.version=t.payload},setMaskLevel:function(e,t){e.maskLevel=t.payload}},extraReducers:function(e){e.addCase(se,function(e,t){return Be({},Te)}).addCase(ce,function(e,t){return Fe(e,t.payload.adjustments)}),Se(e,Ie)}}),Ve=(Re=je.actions).setAdjustmentValue,ze=(Re.setAllAdjustments,Re.setAdjustmentVersion,Re.setMaskLevel,je.reducer);function Ge(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n+0}function Ke(e){return-Math.round(-e)}var We=function(){return We=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},We.apply(this,arguments)};function qe(e,t,n){return function(e,t){var n=We(We({},t),{numberingSystem:"latn"});return new Intl.NumberFormat(e,n)}(t,n).format(e+0)}function Qe(e){return qe(1.1,e).substring(1,2)}function Ye(e){return"."===e}function Je(e,t,n){return qe(e,t,function(e){return{style:"percent",minimumFractionDigits:e,maximumFractionDigits:e}}(n))}var Xe=function(e){var t=e.strings,n=e.locales;return{strings:t,localizeNumber:function(e){return qe(e,n)},localizeNumberDecimalSeparatorOnly:function(e,t){return function(e,t,n){var a=Qe(t),i=void 0===n?e.toString():Ge(e,n).toString();return Ye(a)?i:i.replace(".",a)}(e,n,t)},delocalizeNumberDecimalSeparatorOnly:function(e){return function(e,t){var n=Qe(t);return Ye(n)?+e:+e.replace(n,".")}(e,n)},getDecimalSeparator:function(){return Qe(n)},isPercentSignLeading:function(){return function(e){return null!==Je(.1,e,0).match(/\d$/)}(n)},localizePercentage:function(e,t){return Je(e,n,t)}}},Ze=Object(s.createContext)(Xe({strings:{adjustment_light:"Light",adjustment_color:"Color",adjustment_lightAriaLandmark:"Light Adjustments",adjustment_colorAriaLandmark:"Color Adjustments",adjustment_brightness:"Brightness",adjustment_exposure:"Exposure",adjustment_contrast:"Contrast",adjustment_highlights:"Highlights",adjustment_shadows:"Shadows",adjustment_saturation:"Saturation",adjustment_temperature:"Warmth",adjustment_tint:"Tint",adjustment_vignette:"Vignette",adjustment_mobileChangedAriaLive:"{0} value at {1}. Swipe down then up to access the respective value slider.",adjustment_sliderChangedAriaLive:"{0} value at {1}",adjustment_sliderAriaLabelFormatString:"{0}.{1}",adjustment_sliderTooltip:" Drag on slider or use arrow keys to change {0} value",adjustment_tileMobileTooltip:"Double tap to select then swipe down then up to select respective value slider",adjustment_tileMobileAriaLabel:"{0} value at {1}",aspectRatio_listTitle:"Aspect ratios",aspectRatio_freeform:"Free",aspectRatio_freeformAriaLabel:"Free aspect ratio",aspectRatio_original:"Original",aspectRatio_originalAriaLabel:"Original aspect ratio",aspectRatio_square:"Square",aspectRatio_squareAriaLabel:"Square aspect ratio",aspectRatio_ratioLabelFormatString:"{0} : {1}",aspectRatio_ratioAriaLabelFormatString:"{0} by {1} aspect ratio",aspectRatio_tooltip:"Click or select Enter to see more aspect ratio options",aspectRatio_changedAriaLive:"Changed to {0}",flip_portrait:"Flip to portrait",flip_portraitAriaLabel:"Flip to portrait",flip_landscape:"Flip to landscape",flip_landscapeAriaLabel:"Flip to landscape",autoEnhance_name:"Auto Enhance",autoEnhance_generatingAriaLive:"Generating auto enhance",autoEnhance_appliedAriaLive:"Applied auto enhance with {0} intensity",autoEnhance_removedAriaLive:"Removed auto enhance",autoEnhance_intensitySliderHeader:"Intensity",autoEnhance_intensitySliderAriaLabel:"Auto Enhance intensity",autoEnhance_downloadButton:"Install add-on for Auto Enhance ({0} MB)",autoEnhance_downloadingStatus:"Installing add-on ({0} MB)",autoEnhance_retryDownloadButton:"Retry to install add-on for Auto Enhance",autoEnhance_installTooltip:"Install Auto Enhance add-on",autoEnhance_retryInstallTooltip:"Retry to install Auto Enhance add-on",autoEnhance_appliedTooltip:"Auto Enhance is applied to the image",autoEnhance_notAppliedTooltip:"Auto enhance is not applied to the image",autoEnhance_disabledBySpotFixTooltip:"Please save your current work and open the file in the editor again to use auto-enhance",crop_topLeftCornerAriaLabel:"Top left crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_topRightCornerAriaLabel:"Top right crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_bottomLeftCornerAriaLabel:"Bottom left crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_bottomRightCornerAriaLabel:"Bottom right crop handle. Corner pixel position is {0} from the left {1} from the top.",crop_cornerTooltip:"Drag handle or use arrow keys to crop the image",crop_rectangleAriaLabel:"Drag the image or use the arrow keys to move image in crop region",crop_rectangleTooltip:"Drag the image or use the arrow keys to move image in crop region",crop_rectanglePositionAriaLive:"Left {0} Top {1} pixels",crop_rectangleCannotMoveInCurrentDirectionAriaLive:"Left {0} Top {1} pixels. Cannot move any further in current direction.",editor_viewingOriginal:"Viewing Original",editor_viewingOriginalAriaLive:"Viewing original image",editor_zoomPercentAriaLive:"{0} percent zoom",editor_imageDimensionLabelFormatString:"{0} x {1}",editor_imageDimensionAriaLabelFormatString:"{0} by {1} pixels",editor_imageDimensionAriaLive:"Dimension is {0} by {1} pixels",editor_imageDimensionWithAspectRatioAriaLive:"{2} to {3} aspect ratio; dimension is {0} by {1} pixels",filter_listTitle:"Filters",filter_intensitySliderHeader:"Intensity",filter_intensitySliderAriaLabelFormatString:"{0} intensity.{1}",filter_nameOriginal:"Original",filter_nameBurn:"Burn",filter_nameBw:"B&W",filter_nameBwAriaLabel:"Black and White",filter_nameBwCool:"B&W Cool",filter_nameBwCoolAriaLabel:"Black and White Cool",filter_nameBwHighContrast:"B&W High Contrast",filter_nameBwHighContrastAriaLabel:"Black and White High Contrast",filter_nameBwWarm:"B&W Warm",filter_nameBwWarmAriaLabel:"Black and White Warm",filter_nameCoolLight:"Cool Light",filter_nameCalm:"Calm",filter_nameDramaticCool:"Dramatic Cool",filter_nameFilm:"Film",filter_nameGolden:"Golden",filter_namePunch:"Punch",filter_nameRadiate:"Radiate",filter_nameVintage:"Vintage",filter_nameVividCool:"Vivid Cool",filter_nameWarmContrast:"Warm Contrast",filter_changedAriaLive:"{0} filter has been applied",filter_changedAriaLiveWithIntensity:"{0} filter at {1} percent intensity has been applied",filter_mobileChangedAriaLive:"{0} filter has been applied. Swipe down then up to access the respective value slider.",filter_mobileChangedAriaLiveWithIntensity:"{0} filter at {1} percent intensity has been applied. Swipe down then up to access the respective value slider.",filter_filtersAriaLandmark:"Filters",filter_sliderTooltip:" Drag on slider or use arrow keys to change {0} value",filter_tileMobileTooltip:"Double tap to select then swipe down then up to select respective value slider",filter_tileAriaLabel:"{0} filter is in focus but not selected. {1} filter is currently selected at value of {2}",filter_tileAriaLabelWhenOriginalFilterIsSelected:"{0} filter is in focus but not selected. Original filter currently selected",filter_activeTileAriaLabel:"{0} filter is currently selected at value of {1}.",filter_activeOriginalFilterAriaLabel:"Original is selected",footer_done:"Done",nonCrop_imageTooltip:"Click and hold or double tap and hold to view the original image",nonCrop_imageAriaLabelWithEdits:"Click and hold on image to view the original image. Alternatively, double tap on image then hold to view the original image",nonCrop_imageAriaLabelWithoutEdits:"No adjustments have been made or filter applied to the image",nonCrop_panViewPositionAriaLive:"Left {0} Top {1} pixels",pivot_crop:"Crop",pivot_adjustment:"Adjustment",pivot_filter:"Filter",pivot_markup:"Markup",pivot_retouch:"Retouch",pivot_inpaint:"Photo in-painting",pivot_AriaLabel:"{0} tab is in focus and you are at {1} screen currently",rotate_left90:"Rotate image 90 degrees counter-clockwise",rotate_left90AriaLabel:"Rotate counter-clockwise",rotate_left90FinishedAriaLive:"Rotated 90 degrees counter-clockwise",rotate_right90:"Rotate image 90 degrees clockwise",rotate_right90AriaLabel:"Rotate clockwise",rotate_right90FinishedAriaLive:"Rotated 90 degrees clockwise",rotate_sliderAriaLabel:"Manual rotate",rotate_degree:"°",rotate_sliderTooltip:"Drag or use arrow keys to rotate the image",flip_horizontal:"Flip image horizontally",flip_horizontalAriaLabel:"Flip image horizontally",flip_horizontalFinishedAriaLive:"Flipped image horizontally",flip_vertical:"Flip image vertically",flip_verticalAriaLabel:"Flip image vertically",flip_verticalFinishedAriaLive:"Flipped image vertically",toolbar_imageSave:"Save",toolbar_imageSaveTooltip:"Save options for your image",toolbar_imageSaveAsOriginal:"Save",toolbar_imageSaveAsOriginalAriaLabel:"Save",toolbar_saveMenuSplitButtonAriaLabel:"More save options",toolbar_imageSaveAsOriginalTooltip:"Image will be overwritten with the latest edits",toolbar_imageSaveAsCopy:"Save as copy",toolbar_imageSaveAsCopyAriaLabel:"Save as copy",toolbar_imageSaveAsCopyTooltip:"Create a new image with the applied edits",toolbar_imageReset:"Reset",toolbar_imageResetTooltip:"Reset all edits performed on the image",toolbar_imageResetAriaLabel:"Reset",toolbar_imageResetFinishedAriaLive:"Image edits were reset",toolbar_resetConfirmDialogContentTitle:"Reset image?",toolbar_resetConfirmDialogContentSubText:"This will remove all edits made to this image.",toolbar_resetConfirmDialogCloseButtonAriaLabel:"Close",toolbar_resetConfirmDialogConfirmText:"Reset",toolbar_resetConfirmDialogConfirmAriaLabel:"Reset",toolbar_resetConfirmDialogCancelText:"Cancel",toolbar_resetConfirmDialogCancelAriaLabel:"Cancel",toolbar_zoomLevelAriaLabel:"Zoom level",toolbar_zoomInTooltip:"Zoom into the image",toolbar_zoomInAriaLabel:"Zoom in",toolbar_zoomOutTooltip:"Zoom out of the image",toolbar_zoomOutAriaLabel:"Zoom out",toolbar_done:"Done",toolbar_doneAriaLabel:"Done",toolbar_doneTooltip:"Done",toolbar_cancel:"Cancel",toolbar_cancelAriaLabel:"Cancel",toolbar_cancelTooltip:"Cancel all edits and return to previous screen",toolbar_fitToViewTooltip:"Fit to window",toolbar_viewActualSizeTooltip:"Actual size",toolbar_undo:"Undo",toolbar_undoAriaLabel:"Undo (Ctrl + Z)",toolbar_redo:"Redo",toolbar_redoAriaLabel:"Redo (Ctrl + Y)",undoRedo_colorAdjustmentsAriaLive:"{0} {1} color adjustment",undoRedo_autoEnhanceAriaLive:"{0} auto enhance",undoRedo_filterAriaLive:"{0} {1} filter",undoRedo_markupInkContentAriaLive:"{0} ink stroke",undoRedo_markupEraseContentAriaLive:"{0} erase ink stroke",undoRedo_markupClearAllMarkupContentAriaLive:"{0} clear all markup",undoRedo_transformCropAriaLive:"{0} cropping operation on the image",undoRedo_transformAspectRatioAriaLive:"{0} aspect ratio change on the image",undoRedo_transformMirrorImageAriaLive:"{0} flip",undoRedo_transformRotationAriaLive:"{0} rotation",undoRedo_spotFixAriaLive:"{0} a spot fix",spotFix_toastText:" Tap on a spot or blemish to fix it.",spotFix_calloutHeaderText:"Spot fix",spotFix_calloutMainText:"Left mouse click or tap on a spot or blemish to fix it. To navigate around the image hold right mouse click then drag.",spotFix_header:"Spot fix",spotFix_sizeSliderTooltip:"Drag on slider or use arrow keys to change size",spotFix_sizeSliderHeader:"Size"},locales:void 0})),$e=n("jOlS");Object($e.loadStyles)([{rawString:".actionsPaneContainer_0f4047fc{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.actionsPaneBody_0f4047fc{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow-y:auto;padding:0 16px}"}]);var et=function(){return et=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},et.apply(this,arguments)},tt=Object(s.memo)(function(e){var t=e.header,n=e.children,a=e.footer,i=e.size,r=e.containerId,o=e.styles,s=void 0===o?{}:o;return c.a.createElement("div",{id:r,className:Object(u.mergeStyles)("actionsPaneContainer_0f4047fc",s.container,et({},i))},t&&c.a.createElement("div",{className:Object(u.mergeStyles)(s.header)},t),c.a.createElement("div",{className:Object(u.mergeStyles)("actionsPaneBody_0f4047fc",s.body)},n),a&&c.a.createElement("div",{className:Object(u.mergeStyles)(s.footer)},a))});Object($e.loadStyles)([{rawString:".sectionHeader_7b43c21b{font-size:16px;font-weight:500;line-height:42px;margin:25px 0 6px 0}.sectionFooter_7b43c21b{height:38px}"}]);var nt="sectionHeader_7b43c21b",at=Object(u.classNamesFunction)({cacheSize:100}),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.as,n=void 0===t?"label":t,a=e.children,i=e.className,r=e.disabled,c=e.styles,d=e.required,l=e.theme,f=at(c,{className:i,disabled:r,required:d,theme:l});return s.createElement(n,Object(o.__assign)({},Object(u.getNativeProps)(this.props,u.divProperties),{className:f.root}),a)},t}(s.Component),rt=Object(u.styled)(it,function(e){var t,n=e.theme,a=e.className,i=e.disabled,r=e.required,s=n.semanticColors,c=u.FontWeights.semibold,d=s.bodyText,l=s.disabledBodyText,f=s.errorText;return{root:["ms-Label",n.fonts.medium,{fontWeight:c,color:d,boxSizing:"border-box",boxShadow:"none",margin:0,display:"block",padding:"5px 0",wordWrap:"break-word",overflowWrap:"break-word"},i&&{color:l,selectors:(t={},t[u.HighContrastSelector]=Object(o.__assign)({color:"GrayText"},Object(u.getHighContrastNoAdjustStyle)()),t)},r&&{selectors:{"::after":{content:"' *'",color:f,paddingRight:12}}},a]}},void 0,{scope:"Label"});function ot(e){var t=s.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}var st=function(){var e=ot({});return s.useEffect(function(){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var a=n[t];clearTimeout(a)}}},[e]),ot({setTimeout:function(t,n){var a=setTimeout(t,n);return e[a]=1,a},clearTimeout:function(t){delete e[t],clearTimeout(t)}})};function ct(e,t,n){var a=s.useState(t),i=a[0],r=a[1],o=ot(void 0!==e),c=o?e:i,d=s.useRef(c),l=s.useRef(n);s.useEffect(function(){d.current=c,l.current=n});var u=ot(function(){return function(e,t){var n="function"==typeof e?e(d.current):e;l.current&&l.current(t,n),o||r(n)}});return[c,u]}function dt(e,t){var n=s.useRef(t);return n.current||(n.current=Object(A.getId)(e)),n.current}var lt=Object(A.classNamesFunction)(),ut=function(e){return function(t){var n;return(n={})[e]="".concat(t,"%"),n}},ft=function(e,t,n){return n===t?0:(e-t)/(n-t)*100},pt=s.forwardRef(function(e,t){var n=function(e,t){var n=e.step,a=void 0===n?1:n,i=e.className,r=e.disabled,c=void 0!==r&&r,d=e.label,l=e.max,u=void 0===l?10:l,f=e.min,p=void 0===f?0:f,m=e.showValue,_=void 0===m||m,h=e.buttonProps,b=void 0===h?{}:h,g=e.vertical,v=void 0!==g&&g,y=e.snapToStep,S=e.valueFormat,D=e.styles,I=e.theme,x=e.originFromZero,C=e["aria-labelledby"],O=e.ariaLabel,w=void 0===O?e["aria-label"]:O,E=e.ranged,L=e.onChange,k=e.onChanged,M=s.useRef([]),P=st(),T=P.setTimeout,U=P.clearTimeout,F=s.useRef(null),H=ct(e.value,e.defaultValue,function(e,t){return null==L?void 0:L(t,E?[K.latestLowerValue,t]:void 0,e)}),R=H[0],N=H[1],B=ct(e.lowerValue,e.defaultLowerValue,function(e,t){return null==L?void 0:L(K.latestValue,[t,K.latestValue],e)}),j=B[0],V=B[1],z=Math.max(p,Math.min(u,R||0)),G=Math.max(p,Math.min(z,j||0)),K=ot({onKeyDownTimer:-1,isAdjustingLowerValue:!1,latestValue:z,latestLowerValue:G});K.latestValue=z,K.latestLowerValue=G;var W=dt("Slider",e.id||(null==b?void 0:b.id)),q=lt(D,{className:i,disabled:c,vertical:v,showTransitions:!y&&!K.isBetweenSteps,showValue:_,ranged:E,theme:I}),Q=(u-p)/a,Y=function(){U(K.onKeyDownTimer),K.onKeyDownTimer=-1},J=function(e){Y(),k&&(K.onKeyDownTimer=T(function(){k(e,K.latestValue,E?[K.latestLowerValue,K.latestValue]:void 0)},1e3))},X=function(t){var n=e.ariaValueText;if(void 0!==t)return n?n(t):t.toString()},Z=function(e,t,n){t=Math.min(u,Math.max(p,t)),n=void 0!==n?Math.min(u,Math.max(p,n)):void 0;var i=0;if(isFinite(a))for(;Math.round(a*Math.pow(10,i))/Math.pow(10,i)!==a;)i++;var r=parseFloat(t.toFixed(i));K.isBetweenSteps=void 0!==n&&n!==r,E?K.isAdjustingLowerValue&&(x?r<=0:r<=K.latestValue)?V(r,e):!K.isAdjustingLowerValue&&(x?r>=0:r>=K.latestLowerValue)&&N(r,e):N(r,e)},$=function(e,t){var n=0;switch(e.type){case"mousedown":case"mousemove":n=t?e.clientY:e.clientX;break;case"touchstart":case"touchmove":n=t?e.touches[0].clientY:e.touches[0].clientX}return n},ee=function(t){var n,a=F.current.getBoundingClientRect(),i=(e.vertical?a.height:a.width)/Q;if(e.vertical){var r=$(t,e.vertical);n=(a.bottom-r)/i}else{var o=$(t,e.vertical);n=(Object(A.getRTL)(e.theme)?a.right-o:o-a.left)/i}return n},te=function(e,t){var n=ee(e),i=p+a*n,r=p+a*Math.round(n);Z(e,r,i),t||(e.preventDefault(),e.stopPropagation())},ne=function(e){if(E){var t=ee(e),n=p+a*t;K.isAdjustingLowerValue=n<=K.latestLowerValue||n-K.latestLowerValue<=K.latestValue-n}"mousedown"===e.type?M.current.push(Object(A.on)(window,"mousemove",te,!0),Object(A.on)(window,"mouseup",ae,!0)):"touchstart"===e.type&&M.current.push(Object(A.on)(window,"touchmove",te,!0),Object(A.on)(window,"touchend",ae,!0)),te(e,!0)},ae=function(e){K.isBetweenSteps=void 0,null==k||k(e,K.latestValue,E?[K.latestLowerValue,K.latestValue]:void 0),ie()},ie=s.useCallback(function(){M.current.forEach(function(e){return e()}),M.current=[]},[]);s.useEffect(function(){return ie},[ie]);var re=s.useRef(null),oe=s.useRef(null),se=s.useRef(null);!function(e,t,n,a){s.useImperativeHandle(e.componentRef,function(){return{get value(){return n},get range(){return a},focus:function(){var e;null===(e=t.current)||void 0===e||e.focus()}}},[a,t,n])}(e,se,z,E?[G,z]:void 0);var ce=ut(v?"bottom":Object(A.getRTL)(e.theme)?"right":"left"),de=ut(v?"height":"width"),le=x?0:p,ue=ft(z,p,u),fe=ft(G,p,u),pe=ft(le,p,u),me=E?ue-fe:Math.abs(pe-ue),_e=Math.min(100-ue,100-pe),he=E?fe:Math.min(ue,pe),be={className:q.root,ref:t},ge={className:q.titleLabel,children:d,disabled:c,htmlFor:w?void 0:W},ve=_?{className:q.valueLabel,children:S?S(z):z,disabled:c,htmlFor:c?W:void 0}:void 0,ye=E&&_?{className:q.valueLabel,children:S?S(G):G,disabled:c}:void 0,Se=x?{className:q.zeroTick,style:ce(pe)}:void 0,De={className:Object(A.css)(q.lineContainer,q.activeSection),style:de(me)},Ie={className:Object(A.css)(q.lineContainer,q.inactiveSection),style:de(_e)},xe={className:Object(A.css)(q.lineContainer,q.inactiveSection),style:de(he)},Ce=Object(o.__assign)({"aria-disabled":c,role:"slider",tabIndex:c?void 0:0},{"data-is-focusable":!c}),Oe=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({id:W,className:Object(A.css)(q.slideBox,b.className),ref:se},!c&&{onMouseDown:ne,onTouchStart:ne,onKeyDown:function(t){var n=K.isAdjustingLowerValue?K.latestLowerValue:K.latestValue,i=0;switch(t.which){case Object(A.getRTLSafeKeyCode)(A.KeyCodes.left,e.theme):case A.KeyCodes.down:i=-a,Y(),J(t);break;case Object(A.getRTLSafeKeyCode)(A.KeyCodes.right,e.theme):case A.KeyCodes.up:i=a,Y(),J(t);break;case A.KeyCodes.home:n=p,Y(),J(t);break;case A.KeyCodes.end:n=u,Y(),J(t);break;default:return}Z(t,n+i),t.preventDefault(),t.stopPropagation()}}),b&&Object(A.getNativeProps)(b,A.divProperties,["id","className"])),!E&&Object(o.__assign)(Object(o.__assign)({},Ce),{"aria-valuemin":p,"aria-valuemax":u,"aria-valuenow":z,"aria-valuetext":X(z),"aria-label":w||d,"aria-labelledby":C})),we=c?{}:{onFocus:function(e){K.isAdjustingLowerValue=e.target===re.current}},Ee=Object(o.__assign)({ref:oe,className:q.thumb,style:ce(ue)},E&&Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Ce),we),{id:"max-".concat(W),"aria-valuemin":G,"aria-valuemax":u,"aria-valuenow":z,"aria-valuetext":X(z),"aria-label":"max ".concat(w||d)})),Ae=E?Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({ref:re,className:q.thumb,style:ce(fe)},Ce),we),{id:"min-".concat(W),"aria-valuemin":p,"aria-valuemax":z,"aria-valuenow":G,"aria-valuetext":X(G),"aria-label":"min ".concat(w||d)}):void 0;return{root:be,label:ge,sliderBox:Oe,container:{className:q.container},valueLabel:ve,lowerValueLabel:ye,thumb:Ee,lowerValueThumb:Ae,zeroTick:Se,activeTrack:De,topInactiveTrack:Ie,bottomInactiveTrack:xe,sliderLine:{ref:F,className:q.line}}}(e,t);return s.createElement("div",Object(o.__assign)({},n.root),n&&s.createElement(rt,Object(o.__assign)({},n.label)),s.createElement("div",Object(o.__assign)({},n.container),e.ranged&&(e.vertical?n.valueLabel&&s.createElement(rt,Object(o.__assign)({},n.valueLabel)):n.lowerValueLabel&&s.createElement(rt,Object(o.__assign)({},n.lowerValueLabel))),s.createElement("div",Object(o.__assign)({},n.sliderBox),s.createElement("div",Object(o.__assign)({},n.sliderLine),e.ranged&&s.createElement("span",Object(o.__assign)({},n.lowerValueThumb)),s.createElement("span",Object(o.__assign)({},n.thumb)),n.zeroTick&&s.createElement("span",Object(o.__assign)({},n.zeroTick)),s.createElement("span",Object(o.__assign)({},n.bottomInactiveTrack)),s.createElement("span",Object(o.__assign)({},n.activeTrack)),s.createElement("span",Object(o.__assign)({},n.topInactiveTrack)))),e.ranged&&e.vertical?n.lowerValueLabel&&s.createElement(rt,Object(o.__assign)({},n.lowerValueLabel)):n.valueLabel&&s.createElement(rt,Object(o.__assign)({},n.valueLabel))),s.createElement(A.FocusRects,null))});pt.displayName="SliderBase";var mt=n("CP8q"),_t={root:"ms-Slider",enabled:"ms-Slider-enabled",disabled:"ms-Slider-disabled",row:"ms-Slider-row",column:"ms-Slider-column",container:"ms-Slider-container",slideBox:"ms-Slider-slideBox",line:"ms-Slider-line",thumb:"ms-Slider-thumb",activeSection:"ms-Slider-active",inactiveSection:"ms-Slider-inactive",valueLabel:"ms-Slider-value",showValue:"ms-Slider-showValue",showTransitions:"ms-Slider-showTransitions",zeroTick:"ms-Slider-zeroTick"},ht=Object(A.styled)(pt,function(e){var t,n,a,i,r,s,c,d,l,u,f,p,m,_=e.className,h=e.titleLabelClassName,b=e.theme,g=e.vertical,v=e.disabled,y=e.showTransitions,S=e.showValue,D=e.ranged,I=b.semanticColors,x=b.palette,C=Object(mt.getGlobalClassNames)(_t,b),O=I.inputBackgroundCheckedHovered,w=I.inputBackgroundChecked,E=x.neutralSecondaryAlt,L=x.neutralPrimary,k=x.neutralSecondaryAlt,M=I.disabledText,P=I.disabledBackground,T=I.inputBackground,U=I.smallInputBorder,F=I.disabledBorder,H=!v&&{backgroundColor:O,selectors:(t={},t[mt.HighContrastSelector]={backgroundColor:"Highlight"},t)},R=!v&&{backgroundColor:E,selectors:(n={},n[mt.HighContrastSelector]={borderColor:"Highlight"},n)},N=!v&&{backgroundColor:w,selectors:(a={},a[mt.HighContrastSelector]={backgroundColor:"Highlight"},a)},B=!v&&{border:"2px solid ".concat(O),selectors:(i={},i[mt.HighContrastSelector]={borderColor:"Highlight"},i)},j=!e.disabled&&{backgroundColor:I.inputPlaceholderBackgroundChecked,selectors:(r={},r[mt.HighContrastSelector]={backgroundColor:"Highlight"},r)};return{root:Object(o.__spreadArray)(Object(o.__spreadArray)(Object(o.__spreadArray)(Object(o.__spreadArray)(Object(o.__spreadArray)([C.root,b.fonts.medium,{userSelect:"none"},g&&{marginRight:8}],[v?void 0:C.enabled],!1),[v?C.disabled:void 0],!1),[g?void 0:C.row],!1),[g?C.column:void 0],!1),[_],!1),titleLabel:[{padding:0},h],container:[C.container,{display:"flex",flexWrap:"nowrap",alignItems:"center"},g&&{flexDirection:"column",height:"100%",textAlign:"center",margin:"8px 0"}],slideBox:Object(o.__spreadArray)(Object(o.__spreadArray)([C.slideBox,!D&&Object(mt.getFocusStyle)(b),{background:"transparent",border:"none",flexGrow:1,lineHeight:28,display:"flex",alignItems:"center",selectors:(s={},s[":active .".concat(C.activeSection)]=H,s[":hover .".concat(C.activeSection)]=N,s[":active .".concat(C.inactiveSection)]=R,s[":hover .".concat(C.inactiveSection)]=R,s[":active .".concat(C.thumb)]=B,s[":hover .".concat(C.thumb)]=B,s[":active .".concat(C.zeroTick)]=j,s[":hover .".concat(C.zeroTick)]=j,s[mt.HighContrastSelector]={forcedColorAdjust:"none"},s)},g?{height:"100%",width:28,padding:"8px 0"}:{height:28,width:"auto",padding:"0 8px"}],[S?C.showValue:void 0],!1),[y?C.showTransitions:void 0],!1),thumb:[C.thumb,D&&Object(mt.getFocusStyle)(b,{inset:-4}),{borderWidth:2,borderStyle:"solid",borderColor:U,borderRadius:10,boxSizing:"border-box",background:T,display:"block",width:16,height:16,position:"absolute"},g?{left:-6,margin:"0 auto",transform:"translateY(8px)"}:{top:-6,transform:Object(A.getRTL)(b)?"translateX(50%)":"translateX(-50%)"},y&&{transition:"left ".concat(mt.AnimationVariables.durationValue3," ").concat(mt.AnimationVariables.easeFunction1)},v&&{borderColor:F,selectors:(c={},c[mt.HighContrastSelector]={borderColor:"GrayText"},c)}],line:[C.line,{display:"flex",position:"relative"},g?{height:"100%",width:4,margin:"0 auto",flexDirection:"column-reverse"}:{width:"100%"}],lineContainer:[{borderRadius:4,boxSizing:"border-box"},g?{width:4,height:"100%"}:{height:4,width:"100%"}],activeSection:[C.activeSection,{background:L,selectors:(d={},d[mt.HighContrastSelector]={backgroundColor:"WindowText"},d)},y&&{transition:"width ".concat(mt.AnimationVariables.durationValue3," ").concat(mt.AnimationVariables.easeFunction1)},v&&{background:M,selectors:(l={},l[mt.HighContrastSelector]={backgroundColor:"GrayText",borderColor:"GrayText"},l)}],inactiveSection:[C.inactiveSection,{background:k,selectors:(u={},u[mt.HighContrastSelector]={border:"1px solid WindowText"},u)},y&&{transition:"width ".concat(mt.AnimationVariables.durationValue3," ").concat(mt.AnimationVariables.easeFunction1)},v&&{background:P,selectors:(f={},f[mt.HighContrastSelector]={borderColor:"GrayText"},f)}],zeroTick:[C.zeroTick,{position:"absolute",background:I.disabledBorder,selectors:(p={},p[mt.HighContrastSelector]={backgroundColor:"WindowText"},p)},e.disabled&&{background:I.disabledBackground,selectors:(m={},m[mt.HighContrastSelector]={backgroundColor:"GrayText"},m)},e.vertical?{width:"16px",height:"1px",transform:Object(A.getRTL)(b)?"translateX(6px)":"translateX(-6px)"}:{width:"1px",height:"16px",transform:"translateY(-6px)"}],valueLabel:[C.valueLabel,{flexShrink:1,width:30,lineHeight:"1"},g?{margin:"0 auto",whiteSpace:"nowrap",width:40}:{margin:"0 8px",whiteSpace:"nowrap",width:40}]}},void 0,{scope:"Slider"});function bt(e){return{activeSection:{backgroundColor:e.palette.neutralPrimary},container:{},inactiveSection:{backgroundColor:e.palette.neutralTertiaryAlt},line:{},lineContainer:{},root:{},slideBox:{margin:"0px -12px",padding:"0px 12px","&:hover":{".ms-Slider-active":{backgroundColor:e.palette.neutralPrimary},".ms-Slider-inactive":{backgroundColor:e.palette.neutralTertiaryAlt},".ms-Slider-thumb":{border:"none"}},"&:active":{".ms-Slider-active":{backgroundColor:e.palette.neutralPrimary},".ms-Slider-inactive":{backgroundColor:e.palette.neutralTertiaryAlt},".ms-Slider-thumb":{border:"none"}}},thumb:{border:"none",background:e.palette.neutralPrimary},titleLabel:{visibility:"hidden"},valueLabel:{},zeroTick:{display:"none"}}}var gt=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};function vt(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,function(n,a){if(void 0===t[a])throw new Error("Argument at index ".concat(a," is undefined. String is ").concat(e,". Max index provided was ").concat(t.length-1,"."));return t[a]})}function yt(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=n.map(function(e){return t(e)});return vt.apply(void 0,gt([e],i,!1))}function St(e,t){return void 0===t&&(t=!1),function(n){var a="adjustment_".concat(n),i=t?vt(e.adjustment_sliderTooltip,e[a]):"";return{key:n,text:e[a],ariaLabel:vt(e.adjustment_sliderAriaLabelFormatString,e[a],i)}}}function Dt(){return"".concat(1e7,"-").concat(1e3,"-").concat(4e3,"-").concat(8e3,"-").concat(1e11).replace(/[018]/g,function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)})}var It=function(e,t){var n;return function(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];return new Promise(function(i){n&&window.clearTimeout(n),n=window.setTimeout(function(){return i(e.apply(void 0,a))},t)})}},xt=function(){return xt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xt.apply(this,arguments)},Ct=function(e){var t=Dt(),n=[];return{updateSessionId:function(){t=Dt(),n=[]},startTimedTelemetryEvent:function(a,i){var r=Dt();return n.push({id:r,startTimeMs:Date.now(),timeoutMs:i,eventData:a}),i>0&&setTimeout(function(){var a=n.find(function(e){return e.id===r});if(a){var i={name:a.eventData.name+"_timed_out",sessionId:t,isIntentional:!1,timeOut:a.timeoutMs};e(i),n=n.filter(function(e){return e.id!==a.id})}},i),r},endTimedTelemetryEvent:function(t){var a=n.find(function(e){return e.id===t});if(a){var i=xt(xt({},a.eventData),{timeConsumedInMs:Date.now()-a.startTimeMs});e(i)}n=n.filter(function(e){return e.id!==t})},getTelemetryEventData:function(e,n){return xt({name:e,sessionId:t,isIntentional:!0},n)},logEditorActivityEvent:function(n){return e(Ot(t,n))},logCropEvent:It(function(n){return e(wt(t,n))},1e3),logRotateEvent:It(function(n){return e(Et(t,xt(xt({},n),{angle:Ge(n.angle,8)})))},1e3),logEditResetEvent:function(n){return e(At(t,n))},logZoomEvent:It(function(n){return e(Lt(t,n))},1e3),logAspectRatioEvent:function(n){return e(kt(t,n))},logFlipEvent:function(n){return e(Mt(t,n))},logAdjustmentEvent:It(function(n){return e(Pt(t,n))},1e3),logCancelEvent:function(n){return e(Tt(t,n))},logPageLoadTimeEvent:function(n){return e(Ut(t,n))},logSessionStatistics:function(n){return e(Ft(t,n))},logErrorEvent:function(n){return e(Ht(t,n))},logWarningEvent:function(n){return e(Rt(t,n))},logSaveEvent:function(n){return e(Nt(t,n))},logFailedToGetEditedImageEvent:function(){return e(Bt(t))},logRecenterEvent:function(){return e(jt(t))},logMarkupSummaryEvent:function(n){return e(Vt(t,n))},logMaxTextureSizeEvent:function(n){return e(zt(t,n))},logMarkupToolSelectEvent:It(function(n){return e(Gt(t,n))},500),logInkBrushUpdateEvent:It(function(n){return e(Kt(t,n))},1e3),logEditorActivityChangePrepareTimeEvent:function(n){return e(Wt(t,n))},logClearAllMarkupEvent:function(n){return e(qt(t,n))},logAutoEnhanceRequestedEvent:function(n){return e(Qt(t,n))},logAutoEnhanceInstallRequestedEvent:function(n){return e(Yt(t,n))},logUndoRedoEvent:function(n){return e(Jt(t,n))},logTexturePatchCreationError:function(n){return e(Xt(t,n))}}},Ot=function(e,t){return xt({name:"EditorActivityChange",isIntentional:!0,sessionId:e},t)},wt=function(e,t){return xt({name:"Crop",isIntentional:!0,sessionId:e},t)},Et=function(e,t){return xt({name:"Rotate",isIntentional:!0,sessionId:e},t)},At=function(e,t){return xt({name:"EditReset",isIntentional:!0,sessionId:e},t)},Lt=function(e,t){return xt({name:"Zoom",isIntentional:!0,sessionId:e},t)},kt=function(e,t){return xt({name:"AspectRatio",isIntentional:!0,sessionId:e},t)},Mt=function(e,t){return xt({name:"Flip",isIntentional:!0,sessionId:e},t)},Pt=function(e,t){return xt({name:"Adjustment",isIntentional:!0,sessionId:e},t)},Tt=function(e,t){return xt({name:"Cancel",isIntentional:!0,sessionId:e},t)},Ut=function(e,t){return xt({name:"PageLoadTime",isIntentional:!1,sessionId:e},t)},Ft=function(e,t){return xt({name:"SessionStatistics",isIntentional:!1,sessionId:e},t)},Ht=function(e,t){return xt({name:"Error",isIntentional:!1,sessionId:e},t)},Rt=function(e,t){return xt({name:"Warning",isIntentional:!1,sessionId:e},t)},Nt=function(e,t){return xt({name:"Save",isIntentional:!0,sessionId:e},t)},Bt=function(e){return{name:"GetEditedImageFailure",isIntentional:!1,sessionId:e}},jt=function(e){return{sessionId:e,name:"Recenter",isIntentional:!0}},Vt=function(e,t){return xt({name:"MarkupSummary",isIntentional:!0,sessionId:e},t)},zt=function(e,t){return xt({name:"MaxTextureSize",isIntentional:!1,sessionId:e},t)},Gt=function(e,t){return xt({name:"MarkupToolSelect",isIntentional:!0,sessionId:e},t)},Kt=function(e,t){return xt({name:"InkBrushUpdate",isIntentional:!0,sessionId:e},t)},Wt=function(e,t){return xt({name:"EditorActivityChangePrepareTime",isIntentional:!0,sessionId:e},t)},qt=function(e,t){return xt({name:"ClearAllMarkup",isIntentional:!0,sessionId:e},t)},Qt=function(e,t){return xt({name:"AutoEnhanceRequested",isIntentional:!0,sessionId:e},t)},Yt=function(e,t){return xt({name:"AutoEnhanceInstallRequested",isIntentional:!0,sessionId:e},t)},Jt=function(e,t){return xt({name:"UndoRedo",isIntentional:!0,sessionId:e},t)},Xt=function(e,t){return xt({name:"TexturePatchCreationError",isIntentional:!1,sessionId:e},t)},Zt=Object(s.createContext)(Ct(function(e){}));Object($e.loadStyles)([{rawString:".sliderHeaderContainer_9dab0d57{position:relative;height:42px;font-size:14px;line-height:42px;letter-spacing:0}"}]),Object($e.loadStyles)([{rawString:".headerContainer_f63b6e20{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.headerContainer_f63b6e20 .name_f63b6e20{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-margin-end:auto;margin-inline-end:auto}"}]);var $t=n("fxVk"),en=function(e){var t=e.value,n=e.valueFormatter,a=e.label,i=e.iconName,r=e.styles,o=$().palette.neutralPrimary,d=Object(s.useMemo)(function(){var e={root:{fill:o,fontSize:"16px",height:"16px",width:"16px",lineHeight:"16px",marginRight:"8px"}};return Object(u.concatStyleSets)(e,null==r?void 0:r.icon)},[o,null==r?void 0:r.icon]);return c.a.createElement("div",{className:"headerContainer_f63b6e20"},c.a.createElement("span",{className:"name_f63b6e20"},!!i&&c.a.createElement($t.Icon,{iconName:i,styles:d}),!!a&&a),c.a.createElement("span",{style:null==r?void 0:r.valueText},n?n(t):t))};function tn(e,t,n){return e*(1-n)+t*n}function nn(e,t,n){var a=(n-e)/(t-e);return Math.min(Math.max(a,0),1)}function an(e,t){return function(n){return tn(e,t,n)}}Object($e.loadStyles)([{rawString:".valueWrapper_61cd23c6{position:absolute}"}]);var rn=function(e){var t,n,a=e.value,i=e.maxValue,r=e.minValue,o=e.valueFormatter,d=e.styles,l=e.shouldShow,f=Object(s.useRef)(null),p=$(),m=Object(s.useMemo)(function(){var e=Object(u.getRTL)(p),t=function(e,t,n){return 100*nn(t,n,e)}(a,r,i);return e?{right:"".concat(t,"%"),transform:"translate(50%)"}:{left:"".concat(t,"%"),transform:"translate(-50%)"}},[a,i,r,p]);return t=f,n=!l,Object(s.useEffect)(function(){var e=t.current;if(e){if(n){var a=setTimeout(function(){e.hidden=!0},3e3);return function(){clearTimeout(a)}}e.hidden=!1}},[n,t,3e3]),c.a.createElement("span",{className:Object(u.mergeStyles)("valueWrapper_61cd23c6",d),style:m,ref:f,"data-test-id":"slider-value"},o?o(a):a)},on=function(){return on=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},on.apply(this,arguments)},sn=Object(s.forwardRef)(function(e,t){var n=e.layout,a=e.headerProps,i=e.styles,r="Labeled"===n,o=Object(u.mergeStyles)("sliderHeaderContainer_9dab0d57",null==i?void 0:i.containerClassName);return c.a.createElement("div",{className:o,style:null==i?void 0:i.container,ref:t,"aria-hidden":!0},r?c.a.createElement(en,on({},a,{styles:null==i?void 0:i.labelValueHeader})):c.a.createElement(rn,on({},a,{styles:null==i?void 0:i.valueHeader})))});sn.displayName="SliderHeader";var cn=function(){return cn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},cn.apply(this,arguments)};function dn(e){return{top:Math.round(e.top),left:Math.round(e.left),width:Math.round(Math.max(1,e.width)),height:Math.round(Math.max(1,e.height))}}var ln,un,fn={top:0,left:0,width:1,height:1};function pn(e,t){return e.x>=t.left&&e.x<=t.left+t.width&&e.y>=t.top&&e.y<=t.top+t.height}function mn(e,t){return pn({x:e.left,y:e.top},t)&&pn({x:e.left+e.width,y:e.top+e.height},t)}function _n(e){return{x:e.left+e.width/2,y:e.top+e.height/2}}function hn(e,t){var n=Math.max(e.left,t.left),a=Math.min(e.left+e.width,t.left+t.width),i=Math.max(e.top,t.top),r=Math.min(e.top+e.height,t.top+t.height);if(a>=n&&r>=i)return{left:n,top:i,width:a-n,height:r-i}}function bn(e,t,n){return void 0===n?e.top===t.top&&e.left===t.left&&e.width===t.width&&e.height===t.height:Ge(e.top,n)===Ge(t.top,n)&&Ge(e.left,n)===Ge(t.left,n)&&Ge(e.width,n)===Ge(t.width,n)&&Ge(e.height,n)===Ge(t.height,n)}function gn(e,t){return e.width<t.width||e.height<t.height}function vn(e,t,n){return e.width>=t&&e.height>=(void 0===n?t:n)}!function(e){e.Right="Right",e.Left="Left",e.Up="Up",e.Down="Down",e.None="None"}(ln||(ln={})),function(e){e[e.None=-1]="None",e[e.TopLeft=0]="TopLeft",e[e.TopCenter=1]="TopCenter",e[e.TopRight=2]="TopRight",e[e.SideLeft=3]="SideLeft",e[e.Center=4]="Center",e[e.SideRight=5]="SideRight",e[e.BottomLeft=6]="BottomLeft",e[e.BottomCenter=7]="BottomCenter",e[e.BottomRight=8]="BottomRight"}(un||(un={}));var yn=function(){return yn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},yn.apply(this,arguments)};function Sn(e){switch(e){case"ArrowRight":case"ArrowLeft":case"ArrowUp":case"ArrowDown":return!0;default:return!1}}function Dn(e){return"ArrowRight"===e||"ArrowLeft"===e}function In(e){switch(e){case"Slow":return 1;case"Fast":return 10;case"SuperFast":return 50;default:return 0}}function xn(e){switch(e){case"ArrowRight":return ln.Right;case"ArrowLeft":return ln.Left;case"ArrowUp":return ln.Up;case"ArrowDown":return ln.Down;default:return ln.None}}function Cn(e,t,n,a){var i=yn({},e);switch(t){case ln.Right:n===un.TopLeft||n===un.BottomLeft?(i.left=e.width<a?e.left+e.width:e.left+a,i.width=e.width-a):n===un.TopRight||n===un.BottomRight?i.width=e.width+a:n===un.Center&&(i.left=e.left+a);break;case ln.Left:n===un.TopRight||n===un.BottomRight?i.width=e.width-a:n===un.TopLeft||n===un.BottomLeft?(i.left=e.left-a,i.width=e.width+a):n===un.Center&&(i.left=e.left-a);break;case ln.Down:n===un.TopLeft||n===un.TopRight?(i.top=e.height<a?e.top+e.height:e.top+a,i.height=e.height-a):n===un.BottomLeft||n===un.BottomRight?i.height=e.height+a:n===un.Center&&(i.top=e.top+a);break;case ln.Up:n===un.BottomLeft||n===un.BottomRight?i.height=e.height-a:n===un.TopLeft||n===un.TopRight?(i.top=e.top-a,i.height=e.height+a):n===un.Center&&(i.top=e.top-a)}return dn(i)}function On(){return document.body.className.indexOf("ms-Fabric--isFocusVisible")>-1}function wn(e){return e.shiftKey&&Sn(e.key)}function En(e){return Sn(e.key)||wn(e)}function An(e){return e.shiftKey&&Dn(e.key)}function Ln(e){return Dn(e.key)||An(e)}function kn(e,t){return Object(u.getRTL)(t)&&("ArrowLeft"===e?e="ArrowRight":"ArrowRight"===e&&(e="ArrowLeft")),e}var Mn=n("tj93"),Pn=n.n(Mn),Tn=.5;function Un(e,t,n){return Math.round(tn(t,n,e))}function Fn(e,t,n,a){var i;if(e<-a){var r=nn(t,-a,e);i=tn(0,Tn,r)}else if(e>a){var o=nn(a,n,e);i=tn(Tn,1,o)}else i=Tn;return i}function Hn(e){var t="Keyboard";return e instanceof MouseEvent?t="Mouse":e.touches&&(t="Touch"),t}var Rn=c.a.memo(function(e){var t=e.adjustmentKey,n=e.layout,a=e.onChangeNotify,i=e.onChangedNotify,r=e.normalizedValue,o=e.styles,d=e.hideSliderValueAfterInactivity,l=e.shouldShowTooltip,f=void 0===l||l,p=e.setAriaAnnouncement,m=Ee[t].configuration,_=m.sliderMinValue,h=m.sliderMaxValue,b=m.sliderStepValue,g=m.sliderDeadZoneOffset,v=function(e){return Ee[e].iconName}(t),y=Object(s.useContext)(Ze).strings,S=St(y,f)(t),D=S.text,I=S.ariaLabel,x=vt(y.adjustment_sliderTooltip,D),C=Object(s.useContext)(Zt).logAdjustmentEvent,O=$(),w=Object(u.getRTL)(O),E=Object(s.useState)(!1),A=E[0],L=E[1],k=function(e){var t=Object(s.useContext)(Ze).strings;return function(n,a){var i=St(t)(n).ariaLabel;e(vt(t.adjustment_sliderChangedAriaLive,i,a))}}(p),M=Object(s.useRef)(null),P=_-g,T=h+g,U=function(e){var t=Object(s.useState)(!0),n=t[0],a=t[1],i=Object(s.useMemo)(function(){return e?new Pn.a(e,{recognizers:[[Pn.a.Pan,{direction:Pn.a.DIRECTION_ALL}]],touchAction:"pan-y"}):null},[e]);return Object(s.useEffect)(function(){if(i&&e){var t=function(){a(!0)},n=function(){a(!1)};return i.on("panleft panright panend",t),i.on("panup pandown",n),e.addEventListener("touchend",t,{passive:!0}),e.addEventListener("touchstart",n,{passive:!0}),function(){i.off("panleft panright panend",t),i.off("panup pandown",n),e.removeEventListener("touchend",t),e.removeEventListener("touchstart",n)}}},[i,e]),{shouldUpdateSlider:n}}(M.current).shouldUpdateSlider,F=Object(s.useMemo)(function(){return function(e,t,n,a){return e<Tn?tn(t,-a,nn(0,Tn,e)):e>Tn?tn(a,n,nn(Tn,1,e)):0}(r,P,T,g)},[P,T,r,g]),H=Object(s.useCallback)(function(e){if(U){var n=Fn(e,P,T,g);L(!0),a({adjustmentKey:t,adjustmentValue:n,isUndoRedoable:!1})}},[t,a,P,T,g,U]);function R(e){var t=Fn(e,P,T,g);return String(Un(t,_,h))}Object(s.useEffect)(function(){var e=function(e){if(En(e)){var n=xn(e.key);if(.5===r&&n!==ln.None){var i=Fn(n===ln.Right&&!w||n===ln.Up||n===ln.Left&&w?g+.1:-g-.1,P,T,g);a({adjustmentKey:t,adjustmentValue:i,isUndoRedoable:!1})}}},n=M.current;if(n)return n.addEventListener("keydown",e),function(){n.removeEventListener("keydown",e)}},[t,r,M,a,T,P,g,w,A]);var N={value:F,maxValue:T,minValue:P,valueFormatter:R,label:D,iconName:v,shouldShow:A||!d},B=Object(s.useMemo)(function(){var e;return Object(u.concatStyleSets)(bt(O),null===(e=null==o?void 0:o.getSliderStyles)||void 0===e?void 0:e.call(o,O))},[o,O]),j=Object(s.useMemo)(function(){var e=null==o?void 0:o.getSliderHeaderStyles;return"function"==typeof e?e(O):e},[o,O]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(sn,{headerProps:N,layout:n,styles:j}),c.a.createElement("div",{ref:M},c.a.createElement(ht,{min:P,max:T,step:b,value:F,showValue:!1,originFromZero:!0,onChanged:function(e,n){var a=Fn(n,P,T,g);i({adjustmentKey:t,adjustmentValue:a,isUndoRedoable:!0}),C({adjustmentKey:t,value:a,inputType:Hn(e)}),L(!1),k(t,String(Un(a,_,h)))},onChange:H,styles:B,"aria-label":I,ariaValueText:R,buttonProps:{title:f?x:void 0}})))}),Nn=function(){return Nn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Nn.apply(this,arguments)},Bn=Object(s.memo)(function(e){var t=Object(s.useRef)(void 0),n=Object(s.useRef)(void 0),a=Object(s.useCallback)(function(a){t.current&&a.adjustmentKey!==t.current&&(n.current&&e.setAdjustmentValue(Nn(Nn({},n.current),{isUndoRedoable:!0})),t.current=void 0,n.current=void 0),t.current=a.adjustmentKey,n.current=a,e.setAdjustmentValue(a)},[t,n,e]),i=Object(s.useCallback)(function(a){var i,r;(null===(i=n.current)||void 0===i?void 0:i.adjustmentKey)===a.adjustmentKey&&(null===(r=n.current)||void 0===r?void 0:r.adjustmentValue)===a.adjustmentValue?n.current&&e.setAdjustmentValue(Nn(Nn({},n.current),{isUndoRedoable:!0})):e.setAdjustmentValue(a),t.current=void 0,n.current=void 0},[n,e]);return c.a.createElement(c.a.Fragment,null,e.adjustmentKeys.map(function(t){return c.a.createElement(Rn,{key:t,adjustmentKey:t,layout:"Labeled",styles:e.styles,normalizedValue:e[t],onChangeNotify:a,onChangedNotify:i,setAriaAnnouncement:e.setAriaAnnouncement})}))});function jn(e,t){return function(e,t){var n={};return t.forEach(function(t){!function(e,t,n){Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}(e,n,t)}),n}(e,Object.values(t))}var Vn,zn=function(){return zn=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},zn.apply(this,arguments)},Gn=[De.Brightness,De.Exposure,De.Contrast,De.Highlights,De.Shadows,De.Vignette],Kn=[De.Saturation,De.Temperature,De.Tint],Wn=Object(s.memo)(function(e){var t,n,a,i=Object(s.useContext)(Ze).strings,r=zn(zn({},jn(e,De)),{styles:null===(t=e.styles)||void 0===t?void 0:t.adjustmentSlider,setAdjustmentValue:e.setAdjustmentValue,setAriaAnnouncement:e.setAriaAnnouncement});return c.a.createElement(tt,{size:e.size,styles:e.styles,header:e.header,footer:e.footer},e.children,c.a.createElement("section",{"aria-label":i.adjustment_lightAriaLandmark},c.a.createElement("div",{className:nt,style:null===(n=e.styles)||void 0===n?void 0:n.sectionHeader},i.adjustment_light),c.a.createElement(Bn,zn({},r,{adjustmentKeys:Gn}))),c.a.createElement("section",{"aria-label":i.adjustment_colorAriaLandmark},c.a.createElement("div",{className:nt,style:null===(a=e.styles)||void 0===a?void 0:a.sectionHeader},i.adjustment_color),c.a.createElement(Bn,zn({},r,{adjustmentKeys:Kn})),c.a.createElement("div",{className:"sectionFooter_7b43c21b"})))}),qn=Object.freeze({width:0,height:0}),Qn={ariaAnnouncementMessage:void 0,ariaAnnouncementScenario:void 0},Yn=Object(te.n)({name:"AriaAnnouncementState",initialState:Qn,reducers:{setAriaAnnouncement:function(e,t){!function(e,t){var n;e.ariaAnnouncementMessage=e.ariaAnnouncementMessage===(n=t)?n+"​":n}(e,t.payload)},setAriaAnnouncementScenario:function(e,t){!function(e,t){e.ariaAnnouncementScenario=t}(e,t.payload)}}}),Jn=(Vn=Yn.actions).setAriaAnnouncement,Xn=Vn.setAriaAnnouncementScenario,Zn=Yn.reducer,$n=function(){return $n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$n.apply(this,arguments)},ea={setAdjustmentValue:Ve,setAriaAnnouncement:Jn},ta=Object(ee.connect)(function(e){var t=e.uiState.numberOfResets;return $n($n({},jn(e.colorAdjustments,De)),{key:t})},ea)(Wn),na=100,aa=255,ia=100,ra=/^[\da-f]{0,6}$/i,oa=/^\d{0,3}$/;function sa(e,t,n){var a=[],i=(n/=100)*(t/=100),r=e/60,o=i*(1-Math.abs(r%2-1)),s=n-i;switch(Math.floor(r)){case 0:a=[i,o,0];break;case 1:a=[o,i,0];break;case 2:a=[0,i,o];break;case 3:a=[0,o,i];break;case 4:a=[o,0,i];break;case 5:a=[i,0,o]}return{r:Math.round(aa*(a[0]+s)),g:Math.round(aa*(a[1]+s)),b:Math.round(aa*(a[2]+s))}}function ca(e){if(e){var t=e.match(/^rgb(a?)\(([\d., ]+)\)$/);if(t){var n=!!t[1],a=n?4:3,i=t[2].split(/ *, */).map(Number);if(i.length===a)return{r:i[0],g:i[1],b:i[2],a:n?100*i[3]:ia}}}}function da(e,t,n){return void 0===n&&(n=0),e<n?n:e>t?t:e}function la(e,t,n){return[ua(e),ua(t),ua(n)].join("")}function ua(e){var t=(e=da(e,aa)).toString(16);return 1===t.length?"0"+t:t}function fa(e,t,n,a,i){return a===ia||"number"!=typeof a?"#".concat(i):"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(a/ia,")")}function pa(e){var t=e.a,n=void 0===t?ia:t,a=e.b,i=e.g,r=e.r,o=function(e,t,n){var a=NaN,i=Math.max(e,t,n),r=i-Math.min(e,t,n);return 0===r?a=0:e===i?a=(t-n)/r%6:t===i?a=(n-e)/r+2:n===i&&(a=(e-t)/r+4),(a=Math.round(60*a))<0&&(a+=360),{h:a,s:Math.round(100*(0===i?0:r/i)),v:Math.round(i/aa*100)}}(r,i,a),s=o.h,c=o.s,d=o.v,l=la(r,i,a);return{a:n,b:a,g:i,h:s,hex:l,r:r,s:c,str:fa(r,i,a,n,l),v:d,t:ia-n}}function ma(e){var t=function(e){if(e)return ca(e)||function(e){if("#"===e[0]&&7===e.length&&/^#[\da-fA-F]{6}$/.test(e))return{r:parseInt(e.slice(1,3),16),g:parseInt(e.slice(3,5),16),b:parseInt(e.slice(5,7),16),a:ia}}(e)||function(e){if("#"===e[0]&&4===e.length&&/^#[\da-fA-F]{3}$/.test(e))return{r:parseInt(e[1]+e[1],16),g:parseInt(e[2]+e[2],16),b:parseInt(e[3]+e[3],16),a:ia}}(e)||function(e){var t,n,a,i,r,o=e.match(/^hsl(a?)\(([\d., ]+)\)$/);if(o){var s=!!o[1],c=s?4:3,d=o[2].split(/ *, */).map(Number);if(d.length===c){var l=sa((n=d[0],a=d[1],i=d[2],r=i+(a*=(i<50?i:100-i)/100),t={h:n,s:0===r?0:2*a/r*100,v:r}).h,t.s,t.v);return l.a=s?100*d[3]:ia,l}}}(e)||function(e){if("undefined"!=typeof document){var t=document.createElement("div");t.style.backgroundColor=e,t.style.position="absolute",t.style.top="-9999px",t.style.left="-9999px",t.style.height="1px",t.style.width="1px",document.body.appendChild(t);var n=getComputedStyle(t),a=n&&n.backgroundColor;if(document.body.removeChild(t),"rgba(0, 0, 0, 0)"!==a&&"transparent"!==a)return ca(a);switch(e.trim()){case"transparent":case"#0000":case"#00000000":return{r:0,g:0,b:0,a:0}}}}(e)}(e);if(t)return Object(o.__assign)(Object(o.__assign)({},pa(t)),{str:e})}Object($e.loadStyles)([{rawString:".display_09eb8103{position:absolute;z-index:2;-webkit-transform:translateX(-50%);transform:translateX(-50%);border-radius:2px;font-size:14px;line-height:20px;padding:4px 8px;pointer-events:none;text-align:center;opacity:0}.visible_09eb8103{opacity:1;-webkit-transition:opacity .25s;transition:opacity .25s}"}]);var _a=function(){return _a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_a.apply(this,arguments)},ha=c.a.memo(function(e){var t,n=e.children,a=e.visible,i=void 0!==a&&a,r=e.style,o=void 0===r?{}:r,s=$(),d=Object(u.css)("display_09eb8103",i&&"visible_09eb8103"),l=ma(s.palette.white);return c.a.createElement("div",{className:d,style:_a({color:"".concat(s.palette.neutralPrimary),background:l&&(t=l,.6,"rgba(".concat(t.r,", ").concat(t.g,", ").concat(t.b,", ").concat(.6,")"))},o),"data-test-id":"aspect_ratio_display","aria-hidden":i?"false":"true"},n)}),ba=c.a.memo(function(e){var t=e.aspectRatioDisplay,n=e.position,a=e.opacity,i=Object(s.useContext)(Ze),r=i.localizeNumber,o=i.strings,d=a>0,l=Object(s.useMemo)(function(){return d?yt(o.aspectRatio_ratioLabelFormatString,r,t.x,t.y):""},[t,r,o,d]),u=Object(s.useMemo)(function(){return d?yt(o.aspectRatio_ratioAriaLabelFormatString,r,t.x,t.y):""},[t,r,o,d]);return c.a.createElement(ha,{style:{top:n.y,left:n.x,transform:"translateX(-50%)",opacity:a},visible:d},c.a.createElement("span",{"aria-label":u},l))}),ga=n("+JwG"),va="FreeformAspect-Havana",ya="OriginalAspect-Havana",Sa="TwoByOneAspect-Havana";function Da(e){return"None"===e.name&&e.iconName===va&&void 0===e.ratio}function Ia(e){return void 0!==e.ratio&&void 0!==e.ratio}var xa=180/Math.PI,Ca={x:0,y:0};function Oa(e,t){return e.x*t.x+e.y*t.y}function wa(e){return Math.hypot(e.x,e.y)}function Ea(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Aa(e){return e.reduce(function(e,t){return Ea(e,t)},Ca)}function La(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ka(e){var t=wa(e);if(0===t)throw new RangeError("Invalid Vector: Vector length is 0");return{x:e.x/t,y:e.y/t}}function Ma(e,t){return{x:e.x*t,y:e.y*t}}function Pa(e){return{x:Math.round(e.x),y:Math.round(e.y)}}function Ta(e){return{x:Ge(e.x,0),y:Ge(e.y,0)}}function Ua(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function Fa(e,t){if(0===t.x||0===t.y)throw new RangeError("Invalid divisor vector.  Elements must be non-zero.");return{x:e.x/t.x,y:e.y/t.y}}function Ha(e,t){return{x:e.x*t.x,y:e.y*t.y}}function Ra(e,t){return e.x===t.x&&e.y===t.y}function Na(e){return e.x>=0&&e.x<=1&&e.y>=0&&e.y<=1}function Ba(e,t){return wa(La(e,t))}function ja(e,t,n){return 0===Ge(t-e,n)}function Va(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function za(e){return void 0===e&&(e=0),[-1,0,2*e,0,1,0]}function Ga(e){return void 0===e&&(e=0),[1,0,0,0,-1,2*e]}function Ka(e,t){return void 0===t&&(t=e),[e,0,0,0,t,0]}function Wa(e,t,n,a){return void 0===n&&(n=0),void 0===a&&(a=0),[e,0,(e-1)*-n,0,t,(t-1)*-a]}function qa(e,t){return[1,0,e,0,1,t]}function Qa(e){return[e[0],e[1],Math.round(e[2]),e[3],e[4],Math.round(e[5])]}function Ya(e){var t=e*Math.PI/180,n=Math.cos(t),a=Math.sin(t);return[n,-a,0,a,n,0]}function Ja(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=0),ci(qa(t,n),Ya(e),qa(-t,-n))}function Xa(e){return(t=Math.atan2(e[4],e[1])*xa-90)>180?t-=360:t<=-180&&(t+=360),t;var t}function Za(e){return e[0]*e[4]-e[1]*e[3]}function $a(e){return 0!==Za(e)}function ei(e){var t=Za(e);if(0===t)throw new RangeError("Invalid Matrix: determinant is zero");var n=1/t,a=e[0],i=e[1],r=e[2],o=e[3],s=e[4],c=e[5];return[s*n,-i*n,(i*c-r*s)*n,-o*n,a*n,(r*o-a*c)*n]}function ti(e,t){return{x:t.x*e[0]+t.y*e[1]+e[2],y:t.x*e[3]+t.y*e[4]+e[5]}}function ni(e){return{x:e[0],y:e[3]}}function ai(e){return{x:e[1],y:e[4]}}function ii(e){return ka(ni(e))}function ri(e){return ka(ai(e))}function oi(e){return[{x:e[2],y:e[5]},{x:e[0]+e[2],y:e[3]+e[5]},{x:e[0]+e[1]+e[2],y:e[3]+e[4]+e[5]},{x:e[1]+e[2],y:e[4]+e[5]}]}function si(e,t){return ti(ei(e),t)}function ci(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.reduceRight(function(e,t){return[t[0]*e[0]+t[1]*e[3],t[0]*e[1]+t[1]*e[4],t[0]*e[2]+t[1]*e[5]+t[2],t[3]*e[0]+t[4]*e[3],t[3]*e[1]+t[4]*e[4],t[3]*e[2]+t[4]*e[5]+t[5]]},[1,0,0,0,1,0])}function di(e){return li(e,1,1)}function li(e,t,n){if(0===t)throw new RangeError("Width cannot be 0");if(0===n)throw new RangeError("Height cannot be 0");var a=Za(e=ci(Ka(1/t,1/n),e));return Math.sqrt(Math.abs(a))}function ui(e,t,n){return e.every(function(e,a){return ja(e,t[a],n)})}function fi(e,t){return e.every(function(e,n){return e===t[n]})}function pi(e){return{x:e[2],y:e[5]}}function mi(e,t){var n=ni(e),a=ai(e),i=pi(e),r=ii(e),o=ri(e),s=wa(n),c=Ma(n,(s+2*t)/s),d=wa(a),l=Ma(a,(d+2*t)/d),u=La(i,Ea(Ma(r,t),Ma(o,t)));return[c.x,l.x,u.x,c.y,l.y,u.y]}function _i(e){if(6!==e.length)throw new TypeError("Invalid number array: must contain 6 elements");return[e[0],e[1],e[2],e[3],e[4],e[5]]}function hi(e){return[e[0],e[3],e[1],e[4],e[2],e[5]]}function bi(e){return[e[0],e[2],e[4],e[1],e[3],e[5]]}function gi(e){var t=Ka(e.width,e.height);return ci(qa(e.left,e.top),t)}function vi(e){var t=oi(e),n=Math.min.apply(Math,t.map(function(e){return e.x})),a=Math.min.apply(Math,t.map(function(e){return e.y}));return{left:n,top:a,width:Math.max.apply(Math,t.map(function(e){return e.x}))-n,height:Math.max.apply(Math,t.map(function(e){return e.y}))-a}}function yi(e){var t=vi(e);return{x:t.width,y:t.height}}function Si(e){return yi(ci(Ya(-Xa(e)),e))}function Di(e){return ti(e,{x:.5,y:.5})}function Ii(e,t,n){var a=Di(t);return ci(Ja(e,a.x,a.y),n)}function xi(e){return gi(function(e){var t=Di(e),n=vi(e);return{top:t.y-n.width/2,left:t.x-n.height/2,width:n.height,height:n.width}}(e))}function Ci(e,t,n,a){var i=e,r=n,o=a,s=La(t,i),c=La(r,o),d=La(r,i),l=[s.x,c.x,0,s.y,c.y,0];if($a(l)){var u=si(l,d),f=u.x,p=u.y;if(p>=0&&p<=1&&f>0)return f}}function Oi(e,t,n,a){for(var i=a/2,r=[t-i,t+i,t+n-i,t+n+i],o=0;o<3;o++)if(e>=r[o]&&e<=r[o+1])return o;return-1}function wi(e){return e%3-1}function Ei(e){return Math.floor(e/3)-1}function Ai(e,t,n){var a=t.left,i=t.width,r=t.top,o=t.height,s=Oi(e.x,a,i,n);if(-1===s)return-1;var c=Oi(e.y,r,o,n);return-1===c?-1:3*c+s}function Li(e){return{x:(wi(e)+1)/2,y:(Ei(e)+1)/2}}function ki(e,t){return Math.floor(e*t)}function Mi(e,t){return e*t}var Pi=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};function Ti(e,t){var n=oi(e),a=n[0],i=n[1],r=n[2],o=n[3],s=oi(t),c=s[0],d=s[1],l=s[2],u=s[3],f=wa(La(d,c)),p=wa(La(u,c));if(0===f||0===p){var m=Ma(La(l,c),.5),_=Ma(La(r,a),.5),h=La(m,_);return{tx:h.x,ty:h.y,scale:0}}var b=ka(La(d,c)),g={x:-b.y,y:b.x},v={x:Oa(a,b),y:Oa(a,g)},y={x:Oa(i,b),y:Oa(i,g)},S={x:Oa(r,b),y:Oa(r,g)},D={x:Oa(o,b),y:Oa(o,g)},I=Math.min(v.x,y.x,S.x,D.x),x=Math.min(v.y,y.y,S.y,D.y),C=Math.max(v.x,y.x,S.x,D.x),O=Math.max(v.y,y.y,S.y,D.y)-x,w=C-I,E=wa(La(d,c)),A=wa(La(u,c)),L=Math.min(E/w,A/O),k=ci(Ka(L,L),e),M=ti(k,{x:0,y:0}),P=Ua(ti(k,{x:1,y:1}),M),T=La(Ua(l,c),P);return{tx:T.x,ty:T.y,scale:L}}var Ui={horizontalTopLeftToRight:{fixedEnd:un.TopLeft,freeEnd:un.TopRight},horizontalTopRightToLeft:{fixedEnd:un.TopRight,freeEnd:un.TopLeft},horizontalBottomLeftToRight:{fixedEnd:un.BottomLeft,freeEnd:un.BottomRight},horizontalBottomRightToLeft:{fixedEnd:un.BottomRight,freeEnd:un.BottomLeft},verticalLeftTopToBottom:{fixedEnd:un.TopLeft,freeEnd:un.BottomLeft},verticalLeftBottomToTop:{fixedEnd:un.BottomLeft,freeEnd:un.TopLeft},verticalRightTopToBottom:{fixedEnd:un.TopRight,freeEnd:un.BottomRight},verticalRightBottomToTop:{fixedEnd:un.BottomRight,freeEnd:un.TopRight},diagonalTopLeftToBottomRight:{fixedEnd:un.TopLeft,freeEnd:un.BottomRight},diagonalBottomRightToTopLeft:{fixedEnd:un.BottomRight,freeEnd:un.TopLeft},diagonalTopRightToBottomLeft:{fixedEnd:un.TopRight,freeEnd:un.BottomLeft},diagonalBottomLeftToTopRight:{fixedEnd:un.BottomLeft,freeEnd:un.TopRight}},Fi={leftToRight:[Ui.horizontalTopLeftToRight,Ui.horizontalBottomLeftToRight],rightToLeft:[Ui.horizontalTopRightToLeft,Ui.horizontalBottomRightToLeft],topToBottom:[Ui.verticalLeftTopToBottom,Ui.verticalRightTopToBottom],bottomToTop:[Ui.verticalLeftBottomToTop,Ui.verticalRightBottomToTop],fromTopLeft:[Ui.horizontalTopLeftToRight,Ui.verticalLeftTopToBottom,Ui.diagonalTopLeftToBottomRight],fromTopRight:[Ui.horizontalTopRightToLeft,Ui.verticalRightTopToBottom,Ui.diagonalTopRightToBottomLeft],fromBottomLeft:[Ui.verticalLeftBottomToTop,Ui.horizontalBottomLeftToRight,Ui.diagonalBottomLeftToTopRight],fromBottomRight:[Ui.verticalRightBottomToTop,Ui.horizontalBottomRightToLeft,Ui.diagonalBottomRightToTopLeft]};function Hi(e,t,n,a,i,r){var o,s,c=(s=n,[Math.round(s[0]),Math.round(s[1]),Math.round(s[2]),Math.round(s[3]),Math.round(s[4]),Math.round(s[5])]),d=oi(c);return e.forEach(function(e){var n=null!=o?o:t,s=function(e,t,n,a,i,r,o){for(var s=ti(e,Li(a.fixedEnd)),c=ti(e,Li(a.freeEnd)),d=0,l=void 0,u=0;u<n.length;u++){var f=Ci(s,c,n[u],n[(u+1)%n.length]);void 0!==f&&Na(si(t,Ea(s,Ma(La(c,s),.5*f))))&&(d=Math.max(d,f))}return d<1&&d>0&&(l=function(e,t,n,a,i,r,o){var s=Da(e),c=t.x===n.x,d=t.y===n.y,l=s&&c?1:r,u=s&&d?1:r,f=t.x,p=t.y,m=vi(a);return i===un.TopCenter||i===un.BottomCenter?s?l=1:(f=m.left+m.width/2,l-=1-r,u-=1-r):i!==un.SideLeft&&i!==un.SideRight||(s?u=1:(p=m.top+m.height/2,l-=1-r,u-=1-r)),o===ln.Right||o===ln.Left?u=1:o!==ln.Up&&o!==ln.Down||(l=1),Wa(l,u,f,p)}(i,s,c,e,r,d,o)),l}(n,c,d,e,a,i,r);void 0!==s&&(o=ci(s,n))}),o}function Ri(e,t){var n=ei(e),a=oi(t).map(function(e){return ti(n,e)}).reduce(function(e,t){var n=0;t.x<0?n=-t.x:t.x>1&&(n=1-t.x);var a=0;return t.y<0?a=-t.y:t.y>1&&(a=1-t.y),Math.abs(n)>Math.abs(e.x)&&(e.x=n),Math.abs(a)>Math.abs(e.y)&&(e.y=a),e},{x:0,y:0}),i=pi(e);return La(ti(e,a),i)}function Ni(e,t,n,a){var i=Va(e),r=Da(n),o=null;switch(a){case un.TopLeft:o=Fi.fromBottomRight;break;case un.TopCenter:o=r?Fi.bottomToTop:Pi(Pi([],Fi.fromBottomRight,!0),Fi.fromBottomLeft,!0);break;case un.TopRight:o=Fi.fromBottomLeft;break;case un.SideLeft:o=r?Fi.rightToLeft:Pi(Pi([],Fi.fromBottomRight,!0),Fi.fromTopRight,!0);break;case un.Center:var s=Ri(t,e);i=ci(qa(s.x,s.y),e);break;case un.SideRight:o=r?Fi.leftToRight:Pi(Pi([],Fi.fromBottomLeft,!0),Fi.fromTopLeft,!0);break;case un.BottomLeft:o=Fi.fromTopRight;break;case un.BottomCenter:o=r?Fi.topToBottom:Pi(Pi([],Fi.fromTopLeft,!0),Fi.fromTopRight,!0);break;case un.BottomRight:o=Fi.fromTopLeft}return o&&(i=Hi(o,e,t,n,a)),i?gi(dn(vi(i))):e}function Bi(e,t){var n=oi(e),a=oi(t),i=Ua(n[2],n[0]);if(Na(si(t,i))){var r=Number.MAX_VALUE;return n.forEach(function(e){for(var t=0;t<a.length;t++){var n=Ci(i,e,a[t],a[(t+1)%a.length]);void 0!==n&&(r=Math.min(r,n))}}),r===Number.MAX_VALUE?void 0:r}}function ji(e,t,n){var a=Bi(e,t);if(void 0!==a){if(a<1){var i=Di(e);return gi(dn(vi(ci(Wa(a,a,i.x,i.y),e))))}return e}var r=Ti(n,t),o=r.tx,s=r.ty,c=n,d=Ka(r.scale);return ci(qa(o,s),d,c)}function Vi(e){return e!==un.None&&e!==un.Center}var zi=function(e,t,n){return Math.min(Math.max(e,t),n)},Gi=function(){return Gi=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gi.apply(this,arguments)};function Ki(e){var t=Pa(yi(e));return t.x/t.y}function Wi(e,t,n,a){var i=null;if(function(e){return"Original"===e.name&&e.iconName===ya&&void 0===e.ratio}(e))i=a?n.y/n.x:n.x/n.y;else if(Da(e)){var r=vi(t);i=r.width/r.height}else Ia(e)&&(i=e.ratio.x/e.ratio.y);if(null===i)throw new Error("Type of ".concat(e.name," aspectRatio was not handled in getConstrainedAspectRatio()"));return i}function qi(e,t){return t.reduce(function(t,n){if(Ia(n)){var a=t.x/t.y,i=n.ratio.x/n.ratio.y;return Math.abs(i-e)<Math.abs(a-e)&&(t=Gi({},n.ratio)),t}return t},{x:1,y:1})}function Qi(e,t,n){var a=Gi({},e),i=Math.hypot(e.width,e.height),r=Ma(ka({x:t,y:1}),i);if(a.width=r.x,a.height=r.y,void 0!==n){var o=wi(n),s=Ei(n);-1===o?a.left+=e.width-a.width:0===o&&(a.left+=(e.width-a.width)/2),-1===s?a.top+=e.height-a.height:0===s&&(a.top+=(e.height-a.height)/2)}return a}function Yi(e,t){return Math.abs(t.x/t.y-e)<.01}function Ji(e,t,n){if(e.isActive){if(void 0===e.startTime)return{startTime:t,isActive:!0};if(Xi(e,t,n)>=1)return{startTime:void 0,isActive:!1}}return e}function Xi(e,t,n){return e.isActive?void 0!==e.startTime?nn(e.startTime,e.startTime+n,t):0:1}var Zi=function(e){return e},$i=function(e){return.5+.5*Math.sin(-Math.PI/2+e*Math.PI)},er=function(){return er=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},er.apply(this,arguments)};function tr(e,t,n,a){return void 0===e&&(e=void 0),void 0===t&&(t=void 0),void 0===n&&(n=void 0),void 0===a&&(a={startTime:void 0,isActive:!1}),er(er({},a),{startMatrix:e?Va(e):[1,0,0,0,1,0],endMatrix:t?Va(t):[1,0,0,0,1,0],animatedMatrix:n?Va(n):void 0})}function nr(){return tr()}function ar(e,t,n){return e.isActive&&e.animatedMatrix&&(t=e.animatedMatrix),tr(t=Qa(t),n=Qa(n),t,{startTime:void 0,isActive:!0})}function ir(e,t,n,a){void 0===a&&(a=Zi);var i,r,o,s=Ji(e,t,n);if(s.isActive){var c=Xi(e,t,n),d=(i=e.startMatrix,r=e.endMatrix,o=a(c),[tn(i[0],r[0],o),tn(i[1],r[1],o),tn(i[2],r[2],o),tn(i[3],r[3],o),tn(i[4],r[4],o),tn(i[5],r[5],o)]);return tr(e.startMatrix,e.endMatrix,d,s)}return nr()}var rr=function(){return rr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},rr.apply(this,arguments)};function or(e,t){return void 0===e&&(e=void 0),void 0===t&&(t={startTime:void 0,isActive:!1}),rr(rr({},t),{numGridLines:e})}function sr(e){return or(e,{startTime:void 0,isActive:!0})}var cr,dr,lr=function(e){return{left:e,right:e,top:e,bottom:e}};function ur(e,t,n){var a=function(e,t){return{left:Math.round(t.left*e),right:Math.round(t.right*e),top:Math.round(t.top*e),bottom:Math.round(t.bottom*e)}}(t,n);return{top:a.top,left:a.left,width:Math.max(1,e.x-a.left-a.right),height:Math.max(1,e.y-a.top-a.bottom)}}!function(e){e[e.usingNineSliceCropHandles=0]="usingNineSliceCropHandles",e[e.selectingFirstCorner=1]="selectingFirstCorner",e[e.selectingSecondCorner=2]="selectingSecondCorner",e[e.draggingView=3]="draggingView",e[e.draggingImage=4]="draggingImage",e[e.rotating=5]="rotating",e[e.zoomToCrop=6]="zoomToCrop",e[e.keyboardCropping=7]="keyboardCropping",e[e.keyboardRotating=8]="keyboardRotating",e[e.none=9]="none",e[e.disabled=10]="disabled"}(cr||(cr={})),function(e){e[e.none=0]="none",e[e.fitCropRectInView=1]="fitCropRectInView",e[e.fitImageInView=2]="fitImageInView",e[e.actualSize=3]="actualSize"}(dr||(dr={}));var fr=function(e,t){return function(){var n=Ti(t,gi(e)),a=n.tx,i=n.ty,r=n.scale,o=Ka(r),s=ci(qa(a,i),o);if(r>50){var c=50/r,d=_n(e);return ci(Wa(c,c,d.x,d.y),s)}return s}},pr=5/95;function mr(e,t,n){return ci(function(e,t,n,a,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var o=li(e,1,1);if(0===o)throw new RangeError("Invalid Matrix");var s=t/o;return Wa(s,s,i,r)}(e,t,0,0,n.x,n.y),e)}function _r(e,t){void 0===t&&(t=!1),e.image.loadedPixelSize||(t=!1);var n=e.pointer.pointerDowns.length>0&&Vi(e.cropInteraction.activeHandleIndex),a=function(e,t,n,a,i){var r;return Qa(((r={})[dr.none]=function(e){return function(){return e}}(i),r[dr.fitCropRectInView]=fr(t,n),r[dr.fitImageInView]=fr(t,a),r[dr.actualSize]=function(e,t){return function(){var n=_n(e);return mr(t,1,n)}}(t,i),r)[e]())}(e.view.viewFitting.mode,ur(e.view.viewportPixelSize,e.device.pixelRatio,e.view.viewFitting.marginCssPixels),function(e,t,n){if(e){var a=vi(t);return n.width<a.width&&n.height>a.height&&(a.top=n.top,a.height=n.height),n.height<a.height&&n.width>a.width&&(a.left=n.left,a.width=n.width),gi(a)}return Va(t)}(n,e.cropInteraction.uvToWorld,e.cropInteraction.rectAtStartOfResize),e.image._preciseUvToWorld,e.view.worldToView);t?(e.animations.needsFrameTick=!0,e.animations.worldToView=ar(e.animations.worldToView,e.view.worldToView,a)):e.animations.worldToView=nr(),e.view.worldToView=a}function hr(e){_r(e,!0)}function br(e,t){var n=Ti(e.cropInteraction.uvToWorld,gi(ur(e.view.viewportPixelSize,e.device.pixelRatio,e.view.viewFitting.marginCssPixels))).scale,a=function(e,t){return zi(e,t,50)}(t,n);return{zoomScaleToFitCroppedImageInView:n,zoomLevel:a,zoomIsMinimum:a<=n,zoomIsMaximum:50===a}}function gr(e,t,n){var a=vi(ci(e,t)),i=a.left,r=a.top,o=a.width,s=a.height,c=n.x/2-i,d=n.y/2-r,l=c-o,u=d-s;return{x:c<0?c:l>0?l:0,y:d<0?d:u>0?u:0}}function vr(e,t,n,a,i){void 0===i&&(i=!1);var r=br(e,t);if(a&&a.logZoomEvent({zoomLevel:r.zoomLevel/r.zoomScaleToFitCroppedImageInView}),r.zoomIsMinimum)return e.view.viewFitting.mode=dr.fitCropRectInView,hr(e),r;e.view.viewFitting.mode=dr.none;var o=mr(e.view.worldToView,r.zoomLevel,n),s=gr(o,e.cropInteraction.uvToWorld,e.view.viewportPixelSize),c=Qa(ci(qa(s.x,s.y),o));return i?(e.animations.needsFrameTick=!0,e.animations.worldToView=ar(e.animations.worldToView,e.view.worldToView,c)):e.animations.worldToView=nr(),e.view.worldToView=c,r}function yr(e,t){t=zi(t,0,1),t*=e.length-1;var n=Math.floor(t),a=Math.ceil(t);return t===n?e[n]:tn(e[n],e[a],nn(n,a,t))}function Sr(e){return e===cr.zoomToCrop||e===cr.keyboardCropping||e===cr.keyboardRotating}function Dr(e,t,n){return ti(ei(ci(t,Qa(n))),e)}var Ir,xr=function(){return xr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xr.apply(this,arguments)};function Cr(e,t,n){return 0!==di(t)&&pn(Dr(e,t,n),fn)}function Or(e,t){return(3*e+8)/t}function wr(e,t){return Or(e,di(t))}function Er(e){var t=function(t,n){return e>t&&e<=n};return t(-45,45)?e:t(45,135)?e-90:t(-135,-45)?e+90:t(135,180)?e-180:e+180}function Ar(e,t){var n=e+t;return n>180?-360+n:n<=-180?360+n:n}!function(e){e[e.Clockwise=0]="Clockwise",e[e.CounterClockwise=1]="CounterClockwise"}(Ir||(Ir={}));var Lr,kr=function(){return kr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},kr.apply(this,arguments)};function Mr(e,t){void 0===t&&(t=Lr.unspecified);var n=Va(e),a=kr({uvToWorld:n},function(e,t){var n={};return t!==Lr.userIsRotating&&(n._uvToWorldBeforeRotate=Va(e)),t!==Lr.userIsZoomingToCrop&&(n._uvToWorldBeforeZoomToCrop=Va(e)),t!==Lr.userIsChangingAspectRatio&&(n._lastUvToWorldNotSetByAspectRatioChange=Va(e)),n}(n,t));return a}function Pr(e,t,n){void 0===n&&(n=Lr.unspecified),e.cropInteraction=kr(kr({},e.cropInteraction),Mr(t,n))}function Tr(e,t){return void 0===t&&(t=Lr.unspecified),Mr(gi(e),t)}function Ur(e,t,n){void 0===n&&(n=Lr.unspecified),Pr(e,gi(t),n)}function Fr(e,t){return!e||Na(t)}function Hr(e){e.mouseWheelScrollCount=eo,e.savedStates.savedWhenMouseWheelCroppingStart=void 0}function Rr(e){e.cropUiDisplay.areCropOverlaysVisible=!1,e.animations.needsFrameTick=!0,e.animations.dismissCropOverlays={startTime:void 0,isActive:!0}}!function(e){e[e.userIsRotating=0]="userIsRotating",e[e.userIsZoomingToCrop=1]="userIsZoomingToCrop",e[e.userIsChangingAspectRatio=2]="userIsChangingAspectRatio",e[e.unspecified=3]="unspecified"}(Lr||(Lr={}));var Nr=function(){return Nr=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Nr.apply(this,arguments)};function Br(e,t,n){return Mr(Ni(t,e.image._preciseUvToWorld,e.cropInteraction.aspectRatio,n),Lr.userIsZoomingToCrop)}function jr(e,t){var n=vi(e.cropInteraction.uvToWorld),a=t>0,i=wr(ki(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),e.view.worldToView),r=vi(e.cropInteraction._uvToWorldBeforeZoomToCrop),o=r.width/r.height,s=function(e,t,n,a,i,r,o,s){var c=!Da(t),d=vi(n),l=yi(n),u=vi(a),f=yi(a),p=Ma(l,e),m=La(f,l),_=Fa(m,p),h=p.x>m.x?_.x:1,b=p.y>m.y?_.y:1,g=Ma(p,Math.min(h,b)),v=Ma(g,.5),y=La({x:d.left,y:d.top},v),S=Ea({x:u.left,y:u.top},f),D=Ea(l,g),I=f.y===l.x&&v.x>0,x=f.x===l.y&&v.y>0,C=zi(Ke(y.x),u.left,S.x),O=zi(Ke(y.y),u.top,S.y),w=I?d.left:C,E=x?d.top:O,A={left:w,top:E,width:zi(D.x,i,u.left+f.x-w),height:zi(D.y,i,u.top+f.y-E)},L=gi(A);return Qi(A,c?Wi(t,L,s,o):r)}(t,e.cropInteraction.aspectRatio,e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,i,o,e.cropInteraction.shouldInvertOriginalAspectRatio,e.image.originalPixelSize),c=Tr(function(e,t){return{top:Math.round(e.top),left:Math.round(e.left),width:t?Math.ceil(Math.max(1,e.width)):Math.floor(Math.max(1,e.width)),height:t?Math.ceil(Math.max(1,e.height)):Math.floor(Math.max(1,e.height))}}(s,a),Lr.userIsZoomingToCrop);return e.cropInteraction.shouldConstrainInImage&&a&&(Er(Xa(e.image._preciseUvToWorld))>0?(c=Nr(Nr({},c),Br(e,c.uvToWorld,un.TopRight)),c=Nr(Nr({},c),Br(e,c.uvToWorld,un.BottomLeft))):(c=Nr(Nr({},c),Br(e,c.uvToWorld,un.TopLeft)),c=Nr(Nr({},c),Br(e,c.uvToWorld,un.BottomRight))),gn(vi(c.uvToWorld),n)&&(c=Nr(Nr({},c),Tr(n,Lr.userIsZoomingToCrop)))),c}function Vr(e,t,n,a){if(0!==t){var i=jr(e,t);a&&a.logZoomEvent({zoomLevel:t}),Object.assign(e.cropInteraction,i),e.view.viewFitting.mode=dr.fitCropRectInView,n&&(e.animations.needsFrameTick=!0,e.cropInteraction.mode!==cr.zoomToCrop&&(e.cropInteraction.mode=cr.zoomToCrop,e.animations.gridLineVisibility=sr(2),e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}),e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0},e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0}),Rr(e),_r(e)}}var zr="zoomToCrop",Gr="rotateWithRotationBar",Kr="cropWithCropHandles";function Wr(e){var t=e.width,n=e.height,a=e.x,i=e.y,r=e.rotation;return ci(qa(a,i),Ya(r),Ka(t,n))}function qr(e){var t=e[0]*e[4]-e[1]*e[3]<0?-1:1,n=pi(e),a=n.x,i=n.y;return{width:Math.hypot(e[0],e[3])*t,height:Math.hypot(e[1],e[4]),rotation:Xa(e),x:a,y:i}}function Qr(e,t){var n,a=t.image._preciseUvToWorld,i=null===(n=t.cropInteraction)||void 0===n?void 0:n.uvToWorld,r=La({x:e.cropRectangle.left,y:e.cropRectangle.top},pi(i)),o=qa(r.x,r.y),s=ui(ci(o,a),Wr(e.imageTransform),5);return ui(ci(o,i),gi(e.cropRectangle),5)&&s}function Yr(e,t){var n={};for(var a in e)-1===t.indexOf(a)&&e.hasOwnProperty(a)&&(n[a]=e[a]);return n}function Jr(e,t){e.image._preciseUvToWorld=t._preciseUvToWorld,e.cropInteraction.uvToWorld=t.uvToWorld,e.cropInteraction._uvToWorldBeforeRotate=t._uvToWorldBeforeRotate,e.cropInteraction._uvToWorldBeforeZoomToCrop=t._uvToWorldBeforeZoomToCrop,e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange=t._lastUvToWorldNotSetByAspectRatioChange,e.cropInteraction.aspectRatio=t.aspectRatio,e.cropInteraction.shouldInvertOriginalAspectRatio=t.shouldInvertOriginalAspectRatio,e.cropInteraction.rectBottomRightInImageUv=t.rectBottomRightInImageUv,e.cropInteraction.rectTopLeftInImageUv=t.rectTopLeftInImageUv}function Xr(e){return{_preciseUvToWorld:e.image._preciseUvToWorld,uvToWorld:e.cropInteraction.uvToWorld,_uvToWorldBeforeRotate:e.cropInteraction._uvToWorldBeforeRotate,_uvToWorldBeforeZoomToCrop:e.cropInteraction._uvToWorldBeforeZoomToCrop,_lastUvToWorldNotSetByAspectRatioChange:e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange,aspectRatio:e.cropInteraction.aspectRatio,shouldInvertOriginalAspectRatio:e.cropInteraction.shouldInvertOriginalAspectRatio,rectTopLeftInImageUv:e.cropInteraction.rectTopLeftInImageUv,rectBottomRightInImageUv:e.cropInteraction.rectBottomRightInImageUv,incrementingIdOfPointerThatIsDown:e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown}}function Zr(e,t){if(!t)return!1;var n=t,a=Xr(e);if(!He(Yr(n,["_preciseUvToWorld"]),Yr(a,["_preciseUvToWorld"])))return!1;var i,r={cropInteraction:{aspectRatio:(i=n).aspectRatio,uvToWorld:i.uvToWorld},image:{_preciseUvToWorld:i._preciseUvToWorld}},o=function(e){return{imageTransform:qr(e.image._preciseUvToWorld),cropRectangle:vi(e.cropInteraction.uvToWorld)}}(e);return!Qr(o,r)}function $r(e,t,n){if(Zr(e,t)){var a=ge(n,t,Xr(e),Le.KeepAll);e.undoRedoStack.undoStack.push(a)}}var eo=2,to="Crop",no="Adjustment",ao="Filter",io="Markup",ro="Retouch",oo="InPaint",so=to;function co(e,t){if(t){switch(t){case to:e.cropInteraction.mode=cr.none,e.cropInteraction.enableZoomToCrop=!0,e.view.enableZoomToView=!1,e.view.viewFitting.mode=dr.fitCropRectInView,e.cropInteraction.enableLeftMouseDraggingView=!0;break;case ao:case no:case oo:e.cropInteraction.mode=cr.disabled,e.cropInteraction.enableZoomToCrop=!1,e.view.enableZoomToView=!0,e.cropInteraction.enableLeftMouseDraggingView=!0;break;case io:e.cropInteraction.mode=cr.disabled,e.cropInteraction.enableZoomToCrop=!1,e.view.enableZoomToView=!1,e.cropInteraction.enableLeftMouseDraggingView=!1,e.view.viewFitting.mode=dr.fitCropRectInView;break;case ro:e.cropInteraction.mode=cr.disabled,e.cropInteraction.enableZoomToCrop=!1,e.view.enableZoomToView=!0,e.cropInteraction.enableLeftMouseDraggingView=!1}t===oo&&(e.view.viewFitting.mode=dr.fitCropRectInView),e.view.animateViewWhenViewportIsResized=!0}}var lo={name:"None",ratio:void 0,iconName:va},uo={name:"Original",ratio:void 0,iconName:ya},fo={name:"Square",ratio:{x:1,y:1},iconName:"SquareAspect-Havana"},po={name:"NineBySixteen",ratio:{x:9,y:16},iconName:"NineBySixteenAspect-Havana"},mo={name:"SixteenByNine",ratio:{x:16,y:9},iconName:"SixteenByNineAspect-Havana"},_o={name:"FourByThree",ratio:{x:4,y:3},iconName:"FourByThreeAspect-Havana"},ho={name:"TwoByThree",ratio:{x:2,y:3},iconName:"TwoByThreeAspect-Havana"},bo={name:"ThreeByTwo",ratio:{x:3,y:2},iconName:"ThreeByTwoAspect-Havana"},go=[lo,uo,fo,po,mo,{name:"FourByFive",ratio:{x:4,y:5},iconName:"FourByFiveAspect-Havana"},{name:"FiveByFour",ratio:{x:5,y:4},iconName:"FiveByFourAspect-Havana"},{name:"ThreeByFour",ratio:{x:3,y:4},iconName:"ThreeByFourAspect-Havana"},_o,ho,bo,{name:"OneByTwo",ratio:{x:1,y:2},iconName:"OneByTwoAspect-Havana"},{name:"TwoByOne",ratio:{x:2,y:1},iconName:Sa}],vo=window.devicePixelRatio||1,yo=cr.none,So=dr.fitCropRectInView,Do=lo,Io={userDefinedDefaults:void 0,image:{originalPixelSize:{x:1,y:1},_preciseUvToWorld:[1,0,0,0,1,0],loadedPixelSize:void 0},view:{worldToView:[1,0,0,0,1,0],viewFitting:{mode:So,marginCssPixels:lr(0)},viewportPixelSize:{x:1,y:1},allowDraggingView:!1,viewportCssSize:{width:"100%",height:"100%"},enableZoomToView:!1,animateViewWhenViewportIsResized:!1},cropUiDisplay:{handleSizeCss:28,handleHitAreaSizeCss:50,areCropOverlaysVisible:!1},cropInteraction:{mode:yo,activeHandleIndex:un.None,focusedHandleIndex:un.None,isKeyboardFocused:!1,rectAtStartOfResize:{top:0,left:0,width:0,height:0},uvToWorld:[1,0,0,0,1,0],_uvToWorldBeforeRotate:[1,0,0,0,1,0],_uvToWorldBeforeZoomToCrop:[1,0,0,0,1,0],_lastUvToWorldNotSetByAspectRatioChange:[1,0,0,0,1,0],aspectRatio:Do,aspectRatiosList:go,shouldInvertOriginalAspectRatio:!1,rectTopLeftInImageUv:{x:0,y:0},rectBottomRightInImageUv:{x:1,y:1},shouldConstrainInImage:!0,allowDraggingImageOutsideRect:!0,enableZoomToCrop:!0,enableLeftMouseDraggingView:!0},rotationUi:{isKeyboardFocused:!1,deadZoneCenterPos:0,rotationBarPointer:{movePos:{x:0,y:0},incrementingIdOfPointerThatIsDown:void 0}},device:{pixelRatio:vo},pointer:{movePos:{x:0,y:0},pointerDowns:[],preventShift:!1,offset:{x:0,y:0},imageUvGrabPosition:{x:0,y:0},downPos:{x:0,y:0},maxDragDistance:0,downOffsetFromCropHandleCenter:{x:0,y:0}},animations:{needsFrameTick:!1,currentTime:0,outsideCropVisibility:{startTime:void 0,isActive:!1},gridLineVisibility:or(),dismissGridLineVisibility:{startTime:void 0,isActive:!1},dismissOutsideCropVisibility:{startTime:void 0,isActive:!1},worldToView:tr(),image:tr(),crop:tr(),transitionToViewingOriginal:{startTime:void 0,isActive:!1},dismissCropOverlays:{startTime:void 0,isActive:!1}},touch:{scale:1,isDown:!1,downCenterPos:{x:0,y:0}},undoRedoStack:{undoStack:[],redoStack:[],id:"transformToolsUndoRedoStack"},savedStates:{},lastKeyboardShiftingMode:1,mouseWheelScrollCount:eo};function xo(e){var t=Ka(e.x,e.y);return{image:{_preciseUvToWorld:t},cropInteraction:{uvToWorld:t,aspectRatio:Do}}}co(Io,so);var Co=function(e){return e.transformTools},Oo=function(e){return e.transformTools.cropInteraction.uvToWorld},wo=function(e){return e.transformTools.cropInteraction.enableZoomToCrop},Eo=function(e){return e.transformTools.animations.crop.animatedMatrix||Oo(e)},Ao=function(e){return e.transformTools.cropInteraction.mode},Lo=function(e){return e.transformTools.cropInteraction.mode},ko=function(e){return e.transformTools.cropInteraction.activeHandleIndex},Mo=function(e){return e.transformTools.cropInteraction.aspectRatio},Po=function(e){return e.transformTools.cropInteraction.shouldInvertOriginalAspectRatio},To=function(e){return e.transformTools.view.worldToView},Uo=function(e){return e.transformTools.view.viewportPixelSize},Fo=function(e){return e.transformTools.view.viewFitting.mode},Ho=function(e){return e.transformTools.view.enableZoomToView},Ro=function(e){return e.transformTools.device.pixelRatio},No=function(e){return e.transformTools.image._preciseUvToWorld},Bo=function(e){return!!e.transformTools.image.loadedPixelSize},jo=function(e){return e.transformTools.image.loadedPixelSize},Vo=function(e){return e.transformTools.image.originalPixelSize},zo=function(e){return e.transformTools.pointer.movePos},Go=function(e){return e.transformTools.pointer.pointerDowns.length>0},Ko=function(e){return e.transformTools.animations.worldToView.animatedMatrix},Wo=function(e){return e.transformTools.animations.transitionToViewingOriginal.isActive},qo=function(e){return{imageMatrix:No(e),cropMatrix:Oo(e),originalImageSize:Vo(e),aspectRatio:Mo(e),shouldInvertOriginalAspectRatio:Po(e),undoRedoStack:e.transformTools.undoRedoStack}},Qo=Object(ga.e)([Oo,function(e){return e.transformTools.cropInteraction.aspectRatiosList}],function(e,t){return qi(Ki(e),t)}),Yo=Object(ga.e)([Mo,Qo],function(e,t){return Ia(e)?e.ratio:t}),Jo=Object(ga.e)([Eo,To,Ko,Ro],function(e,t,n,a){return vi(ci(Ka(1/a),n||t,e))}),Xo=Object(ga.e)([Jo],function(e){return{x:e.left+e.width/2,y:e.top+8}}),Zo=[1,1,1,1,1,0],$o=function(e){if(e.transformTools.cropUiDisplay.areCropOverlaysVisible)return 1;var t=Xi(e.transformTools.animations.dismissCropOverlays,e.transformTools.animations.currentTime,3e3);return yr(Zo,t)},es=Object(ga.e)([Qo,Oo,$o],function(e,t,n){return Yi(Ki(t),e)?n:0}),ts=Object(ee.connect)(function(e){return{aspectRatioDisplay:Yo(e),position:Xo(e),opacity:es(e)}},{})(ba),ns={auto:!0,scroll:!0,hidden:!0};function as(e){var t=getComputedStyle(e);return ns[t.overflow]||ns[t.overflowY]||ns[t.overflowX]}var is,rs,os,ss="editorActivityPrepareMark";!function(e){e.NoArrow="NoArrow",e.SingleArrow="SingleArrow",e.DoubleArrow="DoubleArrow"}(is||(is={})),function(e){e.FreeHand="FreeHand",e.StraightLine="StraightLine"}(rs||(rs={})),function(e){e.Pen="Pen",e.Highlighter="Highlighter"}(os||(os={}));var cs,ds=function(e){return Object.keys(os).includes(e)},ls="#fed430",us="#0078d7",fs="#ebebeb",ps="#1f1f1f",ms={pen1:{thicknessInCssPixels:4,htmlColor:us,inkType:os.Pen,strokeShape:{arrowMode:is.NoArrow,lineMode:rs.FreeHand}},pen2:{thicknessInCssPixels:4,htmlColor:ps,inkType:os.Pen,strokeShape:{arrowMode:is.NoArrow,lineMode:rs.FreeHand}},highlighter:{thicknessInCssPixels:16,htmlColor:ls,inkType:os.Highlighter,strokeShape:{arrowMode:is.NoArrow,lineMode:rs.FreeHand}}},_s=Object.keys(ms)[0],hs="Pen",bs="Highlighter",gs="Eraser",vs="Text",ys=function(){return ys=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ys.apply(this,arguments)},Ss={showAspectRatioOptions:!1,activeAdjustmentKey:void 0,activeEditorActivity:so,activeEditorActivityInputType:"",nextEditorActivity:"",waitingForActiveEditorActivityToComplete:!1,waitingForMarkupOverlayTexture:!1,shouldWaitFromMarkupActivity:!1,numberOfResets:0,isViewingOriginal:!1,markupUiState:{activeInkBrushId:_s,inkBrushes:ms,activeMarkupToolType:hs,previousActiveMarkupToolType:void 0,showInkStylePicker:!1,strokeShapeTipVisibilityState:"notShown",markupCursorScreenPosition:{x:0,y:0},isKeyboardInputActive:!1,linePreviewCoords:{startPoint:void 0,endPoint:void 0}},userFacingErrorMessages:[]},Ds=Object(te.n)({name:"EditorUiState",initialState:Ss,reducers:{setShowAspectRatioOptions:function(e,t){e.showAspectRatioOptions=t.payload},setActiveAdjustment:function(e,t){e.activeAdjustmentKey=t.payload},prepareEditorActivityChange:function(e,t){var n,a=t.payload,i=a.nextEditorActivity,r=a.inputType;i&&e.activeEditorActivity!==i&&(e.activeEditorActivity===io&&e.shouldWaitFromMarkupActivity&&(e.waitingForActiveEditorActivityToComplete=!0),e.nextEditorActivity=i,performance.clearMarks(ss),performance.mark(ss),n=e.nextEditorActivity,performance.clearMarks(n),performance.mark(n)),r&&(e.activeEditorActivityInputType=r)},setActiveEditorActivity:function(e,t){if(t.telemetry){var n=function(){var e=performance.getEntriesByName(ss);if(1===e.length){var t=performance.now()-e[0].startTime;return performance.clearMarks(ss),t}}();n&&t.payload&&t.telemetry.logEditorActivityChangePrepareTimeEvent({fromEditorActivityName:e.activeEditorActivity,prepareTimeInMs:n,toEditorActivityName:t.payload})}t.payload&&(e.activeEditorActivity=t.payload,e.isViewingOriginal=!1,e.nextEditorActivity="",t.payload!==ro&&"showing"===e.markupUiState.strokeShapeTipVisibilityState&&(e.markupUiState.strokeShapeTipVisibilityState="alreadyShown"))},handleOverlayTextureLoaded:function(e,t){e.waitingForActiveEditorActivityToComplete=!1,e.waitingForMarkupOverlayTexture=!1},setWaitingForMarkupOverlayTexture:function(e,t){e.waitingForMarkupOverlayTexture=t.payload},setWaitingFromMarkupActivity:function(e,t){e.shouldWaitFromMarkupActivity=t.payload},setIsViewingOriginal:function(e,t){e.isViewingOriginal=t.payload},setActiveMarkupInkBrushId:function(e,t){e.markupUiState.activeInkBrushId=t.payload},setInkBrushes:function(e,t){e.markupUiState.inkBrushes=t.payload},setInkBrush:function(e,t){!function(e,t,n){e.markupUiState.inkBrushes[n]=t}(e,t.payload.inkBrush,t.payload.id);var n=t.payload.inkBrush,a=n.htmlColor,i=n.inkType,r=n.thicknessInCssPixels,o=n.strokeShape,s=o.lineMode,c=o.arrowMode,d=void 0===c?is.NoArrow:c;t.telemetry&&t.telemetry.logInkBrushUpdateEvent({color:a,inkType:i,thicknessInCssPixels:r,lineMode:s,arrowMode:d})},setInkBrushVisibility:function(e,t){e.markupUiState.inkBrushes[t.payload.inkBrushId].isInkBrushvisible=t.payload.isInkBrushVisible},setActiveMarkupToolType:function(e,t){e.markupUiState.previousActiveMarkupToolType=e.markupUiState.activeMarkupToolType,e.markupUiState.activeMarkupToolType=t.payload,t.telemetry&&t.telemetry.logMarkupToolSelectEvent({activeMarkupToolType:t.payload})},setActiveMarkupToolTypeWithoutTelemetry:function(e,t){e.markupUiState.previousActiveMarkupToolType=e.markupUiState.activeMarkupToolType,e.markupUiState.activeMarkupToolType=t.payload},setShowInkStylePicker:function(e,t){e.markupUiState.showInkStylePicker=t.payload},setUiState:function(e,t){return ys(ys({},e),t.payload)},resetUiState:function(e,t){return ys({},Ss)},setStrokeShapeTipVisibilityState:function(e,t){e.markupUiState.strokeShapeTipVisibilityState=t.payload},addUserFacingErrorMessage:function(e,t){e.userFacingErrorMessages.push(t.payload)},removeUserFacingErrorMessage:function(e,t){e.userFacingErrorMessages=e.userFacingErrorMessages.filter(function(e){return e.id!==t.payload})},setMarkupCursorScreenPosition:function(e,t){e.markupUiState.markupCursorScreenPosition=t.payload},moveMarkupCursorScreenPositionBy:function(e,t){e.markupUiState.isKeyboardInputActive=!0;var n=t.payload;e.markupUiState.markupCursorScreenPosition=Ea(e.markupUiState.markupCursorScreenPosition,ys({x:0,y:0},n))},setIsKeyboardInputActive:function(e,t){e.markupUiState.isKeyboardInputActive=t.payload},setLinePreviewCoords:function(e,t){e.markupUiState.linePreviewCoords=t.payload}},extraReducers:function(e){e.addCase(se,function(e,t){e.numberOfResets+=1}).addCase(ne,function(e,t){!t.payload.isPrimaryButtonDownOrTouchDown||e.activeEditorActivity!==no&&e.activeEditorActivity!==ao||(e.isViewingOriginal=!0)}).addCase(ae,function(e,t){e.isViewingOriginal=!1}).addCase(Ve,function(e,t){e.activeEditorActivity===ro&&(e.activeEditorActivity=no)})}}),Is=(cs=Ds.actions).setShowAspectRatioOptions,xs=cs.setActiveAdjustment,Cs=cs.prepareEditorActivityChange,Os=cs.setActiveEditorActivity,ws=cs.handleOverlayTextureLoaded,Es=cs.setWaitingForMarkupOverlayTexture,As=cs.setWaitingFromMarkupActivity,Ls=cs.setIsViewingOriginal,ks=cs.setUiState,Ms=cs.resetUiState,Ps=cs.setActiveMarkupInkBrushId,Ts=cs.setInkBrushes,Us=cs.setInkBrush,Fs=cs.setActiveMarkupToolType,Hs=cs.setActiveMarkupToolTypeWithoutTelemetry,Rs=cs.setShowInkStylePicker,Ns=cs.setStrokeShapeTipVisibilityState,Bs=cs.addUserFacingErrorMessage,js=cs.removeUserFacingErrorMessage,Vs=cs.setMarkupCursorScreenPosition,zs=cs.moveMarkupCursorScreenPositionBy,Gs=cs.setIsKeyboardInputActive,Ks=cs.setLinePreviewCoords,Ws=cs.setInkBrushVisibility,qs=Ds.reducer,Qs=c.a.memo(function(e){var t=e.nextEditorActivity,n=e.waitingForActiveEditorActivityToComplete,a=e.setActiveEditorActivity;return Object(s.useEffect)(function(){n||""===t||a(t)},[t,a,n]),null}),Ys={setActiveEditorActivity:Os},Js=Object(ee.connect)(function(e){return{nextEditorActivity:e.uiState.nextEditorActivity,waitingForActiveEditorActivityToComplete:e.uiState.waitingForActiveEditorActivityToComplete}},Ys)(Qs);function Xs(e){var t="Mouse";return e.nativeEvent instanceof PointerEvent&&(t=Zs(e.nativeEvent)),t}function Zs(e){var t="";switch(e.pointerType){case"touch":t="Touch";break;case"pen":t="Pen";break;case"mouse":t="Mouse";break;default:0===e.screenX&&0===e.screenY&&(t="Keyboard")}return t}function $s(e,t){void 0===t&&(t=null);var n,a=s.useRef({ref:(n=function(e){a.ref.current!==e&&(a.cleanup&&(a.cleanup(),a.cleanup=void 0),a.ref.current=e,null!==e&&(a.cleanup=a.callback(e)))},n.current=t,n),callback:e}).current;return a.callback=e,a.ref}var ec=n("M1bi"),tc=function(e){function t(t){var n=e.call(this,t)||this;return Object(A.initializeComponentRef)(n),Object(A.warnDeprecations)("PivotItem",t,{linkText:"headerText"}),n}return Object(o.__extends)(t,e),t.prototype.render=function(){return s.createElement("div",Object(o.__assign)({},Object(A.getNativeProps)(this.props,A.divProperties)),this.props.children)},t}(s.Component),nc=Object(A.classNamesFunction)(),ac=function(e,t){var n={links:[],keyToIndexMapping:{},keyToTabIdMapping:{}};return s.Children.forEach(s.Children.toArray(e.children),function(a,i){if(ic(a)){var r=a.props,s=r.linkText,c=Object(o.__rest)(r,["linkText"]),d=a.props.itemKey||i.toString();n.links.push(Object(o.__assign)(Object(o.__assign)({headerText:s},c),{itemKey:d})),n.keyToIndexMapping[d]=i,n.keyToTabIdMapping[d]=function(e,t,n,a){return e.getTabId?e.getTabId(n,a):t+"-Tab".concat(a)}(e,t,d,i)}else a&&Object(A.warn)("The children of a Pivot component must be of type PivotItem to be rendered.")}),n},ic=function(e){var t;return s.isValidElement(e)&&(null===(t=e.type)||void 0===t?void 0:t.name)===tc.name},rc=s.forwardRef(function(e,t){var n,a=s.useRef(null),i=s.useRef(null),r=dt("Pivot"),c=ct(e.selectedKey,e.defaultSelectedKey),d=c[0],l=c[1],f=e.componentRef,p=e.theme,m=e.linkSize,_=e.linkFormat,h=e.overflowBehavior,b=e.overflowAriaLabel,g=e.focusZoneProps,v=e.overflowButtonAs,y={"aria-label":e["aria-label"],"aria-labelledby":e["aria-labelledby"]},S=Object(A.getNativeProps)(e,A.divProperties,["aria-label","aria-labelledby"]),D=ac(e,r);s.useImperativeHandle(f,function(){return{focus:function(){var e;null===(e=a.current)||void 0===e||e.focus()}}});var I=function(e){if(!e)return null;var t=e.itemCount,a=e.itemIcon,i=e.headerText;return s.createElement("span",{className:n.linkContent},void 0!==a&&s.createElement("span",{className:n.icon},s.createElement(ec.Icon,{iconName:a})),void 0!==i&&s.createElement("span",{className:n.text}," ",e.headerText),void 0!==t&&s.createElement("span",{className:n.count}," (",t,")"))},x=function(e,t,a,i){var r,c=t.itemKey,d=t.headerButtonProps,l=t.onRenderItemLink,f=e.keyToTabIdMapping[c],p=a===c;r=l?l(t,I):I(t);var m=t.headerText||"";m+=t.itemCount?" ("+t.itemCount+")":"",m+=t.itemIcon?" xx":"";var _=t.role&&"tab"!==t.role?{role:t.role}:{role:"tab","aria-selected":p};return s.createElement(u.CommandButton,Object(o.__assign)({},d,_,{id:f,key:c,className:Object(A.css)(i,p&&n.linkIsSelected),onClick:function(e){return C(c,e)},onKeyDown:function(e){return O(c,e)},"aria-label":t.ariaLabel,name:t.headerText,keytipProps:t.keytipProps,"data-content":m}),r)},C=function(e,t){t.preventDefault(),w(e,t)},O=function(e,t){t.which===A.KeyCodes.enter&&(t.preventDefault(),w(e))},w=function(t,n){var a;if(l(t),D=ac(e,r),e.onLinkClick&&D.keyToIndexMapping[t]>=0){var o=D.keyToIndexMapping[t],c=s.Children.toArray(e.children)[o];ic(c)&&e.onLinkClick(c,n)}null===(a=i.current)||void 0===a||a.dismissMenu()};n=nc(e.styles,{theme:p,linkSize:m,linkFormat:_});var E,L=null===(E=d)||void 0!==E&&void 0!==D.keyToIndexMapping[E]?d:D.links.length?D.links[0].itemKey:void 0,k=L?D.keyToIndexMapping[L]:0,M=D.links.map(function(e){return x(D,e,L,n.link)}),P=s.useMemo(function(){return{items:[],alignTargetEdge:!0,directionalHint:u.DirectionalHint.bottomRightEdge}},[]),T=function(e){var t=e.onOverflowItemsChanged,n=e.rtl,a=e.pinnedIndex,i=s.useRef(),r=s.useRef(),o=$s(function(e){var t=function(e,t){if("undefined"!=typeof ResizeObserver){var n=new ResizeObserver(t);return Array.isArray(e)?e.forEach(function(e){return n.observe(e)}):n.observe(e),function(){return n.disconnect()}}var a=function(){return t(void 0)},i=Object(A.getWindow)(Array.isArray(e)?e[0]:e);if(!i)return function(){};var r=i.requestAnimationFrame(a);return i.addEventListener("resize",a,!1),function(){i.cancelAnimationFrame(r),i.removeEventListener("resize",a,!1)}}(e,function(t){r.current=t?t[0].contentRect.width:e.clientWidth,i.current&&i.current()});return function(){t(),r.current=void 0}}),c=$s(function(e){return o(e.parentElement),function(){return o(null)}});return Object(A.useIsomorphicLayoutEffect)(function(){var e=o.current,s=c.current;if(e&&s){for(var d=[],l=0;l<e.children.length;l++){var u=e.children[l];u instanceof HTMLElement&&u!==s&&d.push(u)}var f=[],p=0;i.current=function(){var e=r.current;if(void 0!==e){for(var t=d.length-1;t>=0;t--){if(void 0===f[t]){var i=n?e-d[t].offsetLeft:d[t].offsetLeft+d[t].offsetWidth;t+1<d.length&&t+1===a&&(p=f[t+1]-i),t===d.length-2&&(p+=s.offsetWidth),f[t]=i+p}if(e>f[t])return void _(t+1)}_(0)}};var m=d.length,_=function(e){m!==e&&(m=e,t(e,d.map(function(t,n){return{ele:t,isOverflowing:n>=e&&n!==a}})))},h=void 0;if(void 0!==r.current){var b=Object(A.getWindow)(e);if(b){var g=b.requestAnimationFrame(i.current);h=function(){return b.cancelAnimationFrame(g)}}}return function(){h&&h(),_(d.length),i.current=void 0}}}),{menuButtonRef:c}}({onOverflowItemsChanged:function(e,t){t.forEach(function(e){var t=e.ele,n=e.isOverflowing;return t.dataset.isOverflowing="".concat(n)}),P.items=D.links.slice(e).filter(function(e){return e.itemKey!==L}).map(function(t,a){return t.role="menuitem",{key:t.itemKey||"".concat(e+a),onRender:function(){return x(D,t,L,n.linkInMenu)}}})},rtl:Object(A.getRTL)(p),pinnedIndex:k}).menuButtonRef,U=v||u.CommandButton;return s.createElement("div",Object(o.__assign)({ref:t},S),s.createElement(u.FocusZone,Object(o.__assign)({componentRef:a,role:"tablist"},y,{direction:u.FocusZoneDirection.horizontal},g,{className:Object(A.css)(n.root,null==g?void 0:g.className)}),M,"menu"===h&&s.createElement(U,{className:Object(A.css)(n.link,n.overflowMenuButton),elementRef:T,componentRef:i,menuProps:P,menuIconProps:{iconName:"More",style:{color:"inherit"}},ariaLabel:b,role:"tab"})),L&&D.links.map(function(t){return(!0===t.alwaysRender||L===t.itemKey)&&function(t,a){if(e.headersOnly||!t)return null;var i=D.keyToIndexMapping[t],r=D.keyToTabIdMapping[t];return s.createElement("div",{role:"tabpanel",hidden:!a,key:t,"aria-hidden":!a,"aria-labelledby":r,className:n.itemContainer},s.Children.toArray(e.children)[i])}(t.itemKey,L===t.itemKey)}))});rc.displayName="Pivot";var oc={count:"ms-Pivot-count",icon:"ms-Pivot-icon",linkIsSelected:"is-selected",link:"ms-Pivot-link",linkContent:"ms-Pivot-linkContent",root:"ms-Pivot",rootIsLarge:"ms-Pivot--large",rootIsTabs:"ms-Pivot--tabs",text:"ms-Pivot-text",linkInMenu:"ms-Pivot-linkInMenu",overflowMenuButton:"ms-Pivot-overflowMenuButton"},sc=function(e,t,n){var a,i,r;void 0===n&&(n=!1);var s=e.linkSize,c=e.linkFormat,d=e.theme,l=d.semanticColors,u=d.fonts,f="large"===s,p="tabs"===c;return[u.medium,{color:l.actionLink,padding:"0 8px",position:"relative",backgroundColor:"transparent",border:0,borderRadius:0,selectors:{":hover":{backgroundColor:l.buttonBackgroundHovered,color:l.buttonTextHovered,cursor:"pointer"},":active":{backgroundColor:l.buttonBackgroundPressed,color:l.buttonTextHovered},":focus":{outline:"none"}}},!n&&[{display:"inline-block",lineHeight:44,height:44,marginRight:8,textAlign:"center",selectors:(a={},a[".".concat(A.IsFocusVisibleClassName," &:focus")]={outline:"1px solid ".concat(l.focusBorder)},a[".".concat(A.IsFocusVisibleClassName," &:focus:after")]={content:"attr(data-content)",position:"relative",border:0},a[":before"]={backgroundColor:"transparent",bottom:0,content:'""',height:2,left:8,position:"absolute",right:8,transition:"left ".concat(mt.AnimationVariables.durationValue2," ").concat(mt.AnimationVariables.easeFunction2,",\n                        right ").concat(mt.AnimationVariables.durationValue2," ").concat(mt.AnimationVariables.easeFunction2)},a[":after"]={color:"transparent",content:"attr(data-content)",display:"block",fontWeight:mt.FontWeights.bold,height:1,overflow:"hidden",visibility:"hidden"},a)},f&&{fontSize:u.large.fontSize},p&&[{marginRight:0,height:44,lineHeight:44,backgroundColor:l.buttonBackground,padding:"0 10px",verticalAlign:"top",selectors:(i={":focus":{outlineOffset:"-2px"}},i[".".concat(A.IsFocusVisibleClassName," &:focus::before")]={height:"auto",background:"transparent",transition:"none"},i["&:hover, &:focus"]={color:l.buttonTextCheckedHovered},i["&:active, &:hover"]={color:l.primaryButtonText,backgroundColor:l.primaryButtonBackground},i["&.".concat(t.linkIsSelected)]={backgroundColor:l.primaryButtonBackground,color:l.primaryButtonText,fontWeight:mt.FontWeights.regular,selectors:(r={":before":{backgroundColor:"transparent",transition:"none",position:"absolute",top:0,left:0,right:0,bottom:0,content:'""',height:0},":hover":{backgroundColor:l.primaryButtonBackgroundHovered,color:l.primaryButtonText},":active":{backgroundColor:l.primaryButtonBackgroundPressed,color:l.primaryButtonText}},r[mt.HighContrastSelector]=Object(o.__assign)({fontWeight:mt.FontWeights.semibold,color:"HighlightText",background:"Highlight"},Object(mt.getHighContrastNoAdjustStyle)()),r)},i[".".concat(A.IsFocusVisibleClassName," &.").concat(t.linkIsSelected,":focus")]={outlineColor:l.primaryButtonText},i)}]]]},cc=Object(A.styled)(rc,function(e){var t,n,a,i,r=e.className,s=e.linkSize,c=e.linkFormat,d=e.theme,l=d.semanticColors,u=d.fonts,f=Object(mt.getGlobalClassNames)(oc,d),p="large"===s,m="tabs"===c;return{root:[f.root,u.medium,mt.normalize,{position:"relative",color:l.link,whiteSpace:"nowrap"},p&&f.rootIsLarge,m&&f.rootIsTabs,r],itemContainer:{selectors:{"&[hidden]":{display:"none"}}},link:Object(o.__spreadArray)(Object(o.__spreadArray)([f.link],sc(e,f),!0),[(t={},t["&[data-is-overflowing='true']"]={display:"none"},t)],!1),overflowMenuButton:[f.overflowMenuButton,(n={visibility:"hidden",position:"absolute",right:0},n[".".concat(f.link,"[data-is-overflowing='true'] ~ &")]={visibility:"visible",position:"relative"},n)],linkInMenu:Object(o.__spreadArray)(Object(o.__spreadArray)([f.linkInMenu],sc(e,f,!0),!0),[{textAlign:"left",width:"100%",height:36,lineHeight:36}],!1),linkIsSelected:[f.link,f.linkIsSelected,{fontWeight:mt.FontWeights.semibold,selectors:(a={":before":{backgroundColor:l.inputBackgroundChecked,selectors:(i={},i[mt.HighContrastSelector]={backgroundColor:"Highlight"},i)},":hover::before":{left:0,right:0}},a[mt.HighContrastSelector]={color:"Highlight"},a)}],linkContent:[f.linkContent,{flex:"0 1 100%",selectors:{"& > * ":{marginLeft:4},"& > *:first-child":{marginLeft:0}}}],text:[f.text,{display:"inline-block",verticalAlign:"top"}],count:[f.count,{display:"inline-block",verticalAlign:"top"}],icon:f.icon}},void 0,{scope:"Pivot"}),dc=function(){return dc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},dc.apply(this,arguments)},lc=c.a.memo(function(e){var t=e.activeEditorActivity,n=e.pivotItems,a=e.styles,i=e.showHeaderText,r=void 0===i||i,o=e.onChange,d=Object(s.useContext)(Zt).logWarningEvent,l=Object(s.useContext)(Ze).strings,f=Object(s.useRef)({}),p=Object(s.useRef)(null),m=n.find(function(e){return e.itemKey===t})||n[0],_=Object(s.useCallback)(function(e,n){e&&(e.props.itemKey||d({id:"InvalidPivotKey",message:"Missing pivot key on ControlPivot click. Current active pivot is ".concat(t)}),o({pivotKey:e.props.itemKey,inputType:n?Xs(n):"Keyboard"}))},[o,d,t]),h=function(e,t){var n=$();return Object(s.useCallback)(function(a){if(!a)return null;var i=a.itemCount,r=a.itemIcon,o=a.headerText,s=Object(u.classNamesFunction)()(e,{theme:n});return c.a.createElement("span",{ref:function(e){t.current&&a.itemKey&&(t.current[a.itemKey]=e)},className:s.linkContent,title:a.ariaLabel},void 0!==r&&c.a.createElement("span",{className:s.icon},c.a.createElement($t.FontIcon,{iconName:r})),void 0!==o&&c.a.createElement("span",{className:s.text}," ",a.headerText),void 0!==i&&c.a.createElement("span",{className:s.count}," (",i,")"))},[t,e,n])}(a,f);return function(e,t){Object(s.useEffect)(function(){var n,a;t.current&&function(e,t){if(e){var n=function(e){for(var t=null==e?void 0:e.parentElement;t;){if(as(t))return t;t=t.parentElement}return null}(e);if(n){var a=e.getBoundingClientRect(),i=n.getBoundingClientRect();if(mn(a,i))return;n.scrollTo(e.offsetLeft+a.width/2-i.width/2,e.offsetTop+a.height/2-i.height/2)}}}(null===(a=null===(n=t.current[e])||void 0===n?void 0:n.parentElement)||void 0===a?void 0:a.parentElement)},[e,t])}(t,f),Object(s.useEffect)(function(){var e=function(e){e.ctrlKey&&e.preventDefault()},t=null==p?void 0:p.current;if(t)return t.addEventListener("keydown",e),function(){t.removeEventListener("keydown",e)}},[p]),c.a.createElement(c.a.Fragment,null,c.a.createElement(Js,null),c.a.createElement(cc,{selectedKey:t,onLinkClick:_,headersOnly:!0,styles:a,ref:p},n.map(function(e){var t=r?l[e.localizationKey]:"";return c.a.createElement(tc,dc({key:e.itemKey},e,{headerText:t,ariaLabel:vt(l.pivot_AriaLabel,l[e.localizationKey],l[m.localizationKey]),onRenderItemLink:h,headerButtonProps:{"data-test-id":l[e.localizationKey]}}))})))}),uc=n("YKZg"),fc=Object(ee.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}},function(e){return Object(uc.t)({onChange:function(e){var t=e.inputType,n=e.pivotKey;return Cs({nextEditorActivity:n,inputType:t})}},e)})(lc);var pc=function(){return pc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pc.apply(this,arguments)};function mc(e){var t=Qa(e.image._preciseUvToWorld);e.cropInteraction.rectTopLeftInImageUv=si(t,ti(e.cropInteraction.uvToWorld,{x:0,y:0})),e.cropInteraction.rectBottomRightInImageUv=si(t,ti(e.cropInteraction.uvToWorld,{x:1,y:1}))}function _c(e,t,n,a){void 0===a&&(a=!1),a?(e.needsFrameTick=!0,e.image=ar(e.image,t,n)):e.image=nr()}function hc(e,t,n){return ci(t(n),e)}function bc(e){return e.animations.image.isActive}function gc(e,t){var n=!bc(e);_c(e.animations,e.image._preciseUvToWorld,t,n),e.animations.crop=nr(),e.image._preciseUvToWorld=t,mc(e),Rr(e)}function vc(e,t){e.image._preciseUvToWorld=Ii(t,e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld),e.animations.image=nr(),e.animations.crop=nr(),e.cropInteraction.shouldConstrainInImage&&Pr(e,ji(e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld),Lr.userIsRotating),mc(e)}function yc(e,t,n,a){return e.x+a/45*t+n*Math.sign(a)}function Sc(e,t){var n;vc(e,(n=Er(Xa(e.image._preciseUvToWorld)),zi(t,Oc,Cc)-n)),Rr(e)}function Dc(e){var t=e.undoRedoStack.undoStack.pop();t&&(t.sequentialDuplicateAction===Le.KeepLast&&(t.sequentialDuplicateAction=Le.KeepAll),e.undoRedoStack.undoStack.push(t))}function Ic(e,t,n){var a;if(e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown){if(n){var i=Xa(e.image._preciseUvToWorld);n.logRotateEvent({angle:i,inputType:t})}e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown=void 0,e.animations.needsFrameTick=!0,e.animations.gridLineVisibility=sr(8),e.cropInteraction.mode=yo,(null===(a=e.undoRedoStack.undoStack[e.undoRedoStack.undoStack.length-1])||void 0===a?void 0:a.id)===Gr&&Dc(e)}}var xc=function(){return xc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xc.apply(this,arguments)},Cc=45-1e-12,Oc=-44.999999999999,wc=function(){return wc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},wc.apply(this,arguments)};function Ec(e,t,n){var a=La(e,t);return Qa(ci(qa(a.x,a.y),n))}function Ac(e){var t=e.cropUiDisplay.areCropOverlaysVisible,n=function(e){return e.cropInteraction.mode===cr.usingNineSliceCropHandles||e.cropInteraction.mode===cr.keyboardCropping||e.cropInteraction.mode===cr.zoomToCrop||e.cropInteraction.mode===cr.selectingSecondCorner||e.cropInteraction.isKeyboardFocused&&e.cropInteraction.focusedHandleIndex!==un.Center&&e.cropInteraction.focusedHandleIndex!==un.None||!!e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown||e.rotationUi.isKeyboardFocused}(e);e.cropUiDisplay.areCropOverlaysVisible=n,!n&&t&&Rr(e)}function Lc(e,t){return t||!Da(e.cropInteraction.aspectRatio)?Wi(e.cropInteraction.aspectRatio,e.cropInteraction.uvToWorld,e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio):void 0}function kc(e,t){e.view.worldToView=Ec(t,e.pointer.movePos,e.view.worldToView),e.animations.worldToView=nr(),e.view.viewFitting.mode=dr.none}function Mc(e,t,n,a,i){var r=ti(ei(ci(e,t)),i),o=ti(t,a),s=La(ti(t,r),o),c=La(s,Ri(ci(qa(s.x,s.y),t),n));return 0===c.x&&0===c.y?t:ci(qa(c.x,c.y),t)}function Pc(e,t){var n=un.TopLeft;return e.x<=t.x?n=e.y<=t.y?un.BottomRight:un.TopRight:e.y<=t.y&&(n=un.BottomLeft),n}function Tc(e,t,n){vr(e,t,Ma(e.view.viewportPixelSize,.5),n,!0)}function Uc(e,t,n,a){return!!e&&(n.handlePosition===un.Center||(r=e,(i=t).width===r.width&&i.height===r.height||!function(e,t){switch(t){case ln.Up:return[un.BottomLeft,un.BottomCenter,un.BottomRight].indexOf(e)>=0;case ln.Left:return[un.TopRight,un.SideRight,un.BottomRight].indexOf(e)>=0;case ln.Down:return[un.TopLeft,un.TopCenter,un.TopRight].indexOf(e)>=0;case ln.Right:return[un.TopLeft,un.SideLeft,un.BottomLeft].indexOf(e)>=0}return!1}(n.handlePosition,n.direction)?gn(t,e):gn(e,t)&&vn(e,a)));var i,r}function Fc(e,t,n,a,i){for(var r=n.direction,o=n.handlePosition,s=n.cropShiftingValue,c=i-s<0?-1:1,d=s;(i-d)*c>=0;d+=c){var l=Cn(t,r,o,d),u=dn(Qi(l,Wi(e.cropInteraction.aspectRatio,gi(l),e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio),o));if(Uc(u,t,n,a))return u}}function Hc(e){var t=gr(e.view.worldToView,e.cropInteraction.uvToWorld,e.view.viewportPixelSize);if(0!==t.x||0!==t.y){var n=Qa(ci(qa(t.x,t.y),e.view.worldToView));e.animations.needsFrameTick=!0,e.animations.worldToView=ar(e.animations.worldToView,e.view.worldToView,n),e.view.worldToView=n}}function Rc(e){return e.filter(function(e){return e.isTouch}).length}function Nc(e,t,n){void 0===n&&(n=!0),e.cropInteraction.aspectRatio!==t&&Rr(e),e.cropInteraction.aspectRatio=t;var a=Va(e.cropInteraction.uvToWorld);Ur(e,function(e,t,n){var a=vi(e),i=Di(e),r=Math.hypot(a.width,a.height),o=Ma(ka({x:n,y:1}),r),s=a.width/o.x,c=a.height/o.y,d={left:i.x-o.x/2,top:i.y-o.y/2,width:o.x,height:o.y},l=gi(d),u=Bi(l,t);if(void 0!==u&&(u<=s||u<=c)){var f=qa(-i.x,-i.y),p=Ka(u);return dn(vi(ci(qa(i.x,i.y),p,f,l)))}return dn(d)}(e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange,e.image._preciseUvToWorld,Wi(t,e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange,e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio)),Lr.userIsChangingAspectRatio);var i=Va(e.cropInteraction.uvToWorld);e.animations.crop=n?ar(e.animations.crop,a,i):nr(),_r(e,n)}function Bc(e,t){void 0===t&&(t=!1);var n=e.userDefinedDefaults||xo(e.image.originalPixelSize),a=n.image._preciseUvToWorld,i=n.cropInteraction.uvToWorld;!function(e,t,n,a){void 0===a&&(a=!1),a?(e.needsFrameTick=!0,e.crop=ar(e.crop,t,n)):e.crop=nr()}(e.animations,e.cropInteraction.uvToWorld,i,t),Pr(e,i,Lr.userIsRotating),_c(e.animations,e.image._preciseUvToWorld,a,t),e.image._preciseUvToWorld=a,mc(e),e.view.viewFitting.mode=So,t?hr(e):_r(e),e.cropInteraction.shouldInvertOriginalAspectRatio=!1,Nc(e,n.cropInteraction.aspectRatio,t)}var jc=function(){return jc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},jc.apply(this,arguments)},Vc=function(){return Vc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vc.apply(this,arguments)},zc=function(){return zc=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},zc.apply(this,arguments)};function Gc(e,t){e.image.originalPixelSize=zc({},t.originalImageSize);var n=Wr(t.imageTransform);return Pr(e,gi(t.cropRectangle),Lr.unspecified),_c(e.animations,e.image._preciseUvToWorld,n),e.image._preciseUvToWorld=n,e.animations.crop=nr(),mc(e),_r(e,!1),e.cropInteraction.aspectRatio=t.aspectRatio,e.cropInteraction.shouldInvertOriginalAspectRatio=t.shouldInvertOriginalAspectRatio||!1,e.undoRedoStack=t.undoRedoStack,e}var Kc={undoReducer:function(e,t){e.undoRedoStack.redoStack.push(t),Jr(e,t.undoPayload),Hr(e),_r(e)},redoReducer:function(e,t){e.undoRedoStack.undoStack.push(t),Jr(e,t.redoPayload),Hr(e),_r(e)},removeItemsReducer:function(e,t){e.undoRedoStack.undoStack=t},collapseItemsReducer:function(e,t,n){e.undoRedoStack.undoStack=e.undoRedoStack.undoStack.filter(function(e){return e.sequence!==t.payload.start&&e.sequence!==t.payload.end}),e.undoRedoStack.undoStack.push(n)}},Wc=function(e,t,n){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(null==e||null==t)return!1;if("boolean"==typeof e||"string"==typeof e)return e===t;if("number"==typeof e&&"number"==typeof t)return ja(e,t,n);for(var a=Object.keys(e),i=Object.keys(t),r=a.concat(i.filter(function(e){return!a.includes(e)})),o=0;o<r.length;o++){var s=r[o];if(!Wc(e[s],t[s],n))return!1}return!0};function qc(e,t,n,a){var i=Xr(e);t();var r=Xr(e);if(!Wc(i,r,5)){var o=ge(n,i,r,a);return e.undoRedoStack.undoStack.push(o),o}}var Qc,Yc=Object(te.n)({name:"transformToolsState",initialState:Io,reducers:{setResolutionScaling:function(e,t){!function(e,t){var n,a,i,r,o,s,c,d,l,u,f,p;e.image._preciseUvToWorld=(s=e.image._preciseUvToWorld,c=t,d=e.image.originalPixelSize,p=Fa(Si(s),d),l=s,u=Fa(c,p),ci(Ja(f=Xa(l),0,0),Ka(u.x,u.y),Ja(-f,0,0),l)),e.animations.image=nr(),e.animations.crop=nr(),e.cropInteraction.uvToWorld=(n=Qa(e.image._preciseUvToWorld),a=e.cropInteraction.rectTopLeftInImageUv,i=e.cropInteraction.rectBottomRightInImageUv,r=ti(n,a),o=ti(n,i),gi(dn({left:Math.min(r.x,o.x),top:Math.min(r.y,o.y),width:Math.abs(o.x-r.x),height:Math.abs(o.y-r.y)}))),e.cropInteraction._uvToWorldBeforeRotate=Va(e.cropInteraction.uvToWorld),_r(e)}(e,t.payload)},handleImageTextureLoaded:function(e,t){!function(e,t){t.resetEditsOnSizeChange&&function(e,t){e.image.originalPixelSize.x===t.x&&e.image.originalPixelSize.y===t.y||(e.image.originalPixelSize=Vc({},t),Bc(e),Rr(e))}(e,t.sizeInPixels),e.image.loadedPixelSize=t.sizeInPixels}(e,t.payload)},setCanvasPixelSize:function(e,t){!function(e,t,n){var a,i,r,o;e.view.worldToView=Qa((a=e.view.worldToView,i=e.view.viewportPixelSize,r=t,o=di(a),ci(a,qa((r.x-i.x)/2/o,(r.y-i.y)/2/o)))),e.view.viewportPixelSize=pc({},t),e.view.viewportCssSize=pc({},n),_r(e,e.view.animateViewWhenViewportIsResized),$a(e.view.worldToView)||(e.view.worldToView=[1,0,0,0,1,0])}(e,t.payload.pixelSize,t.payload.cssSize)},adjustCropRect:function(e,t){e.savedStates.savedWhenKeyboardCroppingStart||(e.savedStates.savedWhenKeyboardCroppingStart=Xr(e)),function(e,t,n){var a=t.direction,i=t.handlePosition,r=t.cropShiftingValue,o=vi(e.cropInteraction.uvToWorld),s=Or(ki(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),50),c=o;r>=1&&(c=Fc(e,o,t,s,1)||c),Uc(c,o,t,s)||(c=Fc(e,o,t,s,Math.ceil(Lc(e,!1)||1))||c),Uc(c,o,t,s)&&(Ur(e,c),e.cropInteraction.focusedHandleIndex=i,e.cropInteraction.shouldConstrainInImage&&Pr(e,function(e,t,n,a,i){var r=Va(e);if(a===un.Center){var o=Ri(t,e);return ci(qa(o.x,o.y),e)}var s=function(e,t){switch(t){case ln.Up:if([un.TopLeft,un.TopRight,un.Center].includes(e))return Fi.bottomToTop;break;case ln.Left:if([un.TopLeft,un.BottomLeft,un.Center].includes(e))return Fi.rightToLeft;break;case ln.Right:if([un.TopRight,un.BottomRight,un.Center].includes(e))return Fi.leftToRight;break;case ln.Down:if([un.BottomLeft,un.BottomRight,un.Center].includes(e))return Fi.topToBottom}return[]}(a,i);return s.length>0&&(r=Hi(s,e,t,n,a,i)||r),gi(dn(vi(r)))}(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatio,e.cropInteraction.focusedHandleIndex,a)),mc(e),null==n||n.logCropEvent({inputType:t.inputType}),e.animations.needsFrameTick=!0,e.cropInteraction.mode!==cr.keyboardCropping&&(e.cropInteraction.mode=cr.keyboardCropping,e.animations.gridLineVisibility=sr(2),e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}),e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0},e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0},Ac(e),_r(e))}(e,t.payload,t.telemetry)},adjustCropRectOnKeyUp:function(e,t){var n=e.savedStates.savedWhenKeyboardCroppingStart;n?($r(e,n,Kr),e.savedStates.savedWhenKeyboardCroppingStart=void 0):Dc(e)},panView:function(e,t){!function(e,t){if(e.view.viewFitting.mode!==dr.fitCropRectInView){var n=t.direction,a=t.adjustmentCanvasShiftingValue,i=function(e){switch(e){case ln.Left:return{x:1,y:0};case ln.Right:return{x:-1,y:0};case ln.Down:return{x:0,y:-1};case ln.Up:return{x:0,y:1};default:return{x:0,y:0}}}(n),r=Ma(i,a),o=qa(r.x,r.y);e.view.worldToView=Qa(ci(o,e.view.worldToView)),e.animations.worldToView=nr(),e.view.viewFitting.mode=dr.none,Hc(e)}}(e,t.payload)},setFocusedCropHandle:function(e,t){!function(e,t){var n=t.handlePosition,a=t.isKeyboardFocused;e.cropInteraction.focusedHandleIndex=n,e.cropInteraction.isKeyboardFocused=!!a,Ac(e)}(e,t.payload)},handleMouseWheel:function(e,t){!function(e,t,n){var a=t.deltaY,i=t.deltaMode,r=t.mousePhysicalPixelPos,o=t.ctrlKey;if(0!==a)if(!e.cropInteraction.enableZoomToCrop||!Cr(r,e.view.worldToView,e.cropInteraction.uvToWorld)||e.view.viewFitting.mode===dr.none||o&&e.view.enableZoomToView){if(e.view.enableZoomToView){var s=function(e,t,n){var a=t===WheelEvent.DOM_DELTA_PIXEL?e:40*e,i=1+.1*Math.abs(a/100),r=di(n);return e>0?r/i:r*i}(a,i,e.view.worldToView);vr(e,s,r,n)}}else if(e.mouseWheelScrollCount++,e.savedStates.savedWhenMouseWheelCroppingStart||(e.savedStates.savedWhenMouseWheelCroppingStart=Xr(e)),Vr(e,(a<0?.05:pr)*(a/100),!0,n),0==(e.mouseWheelScrollCount%=3)){var c=e.savedStates.savedWhenMouseWheelCroppingStart;if(Zr(e,c)){var d=Xr(e),l=ge(zr,c,d,Le.KeepAll);e.undoRedoStack.undoStack.push(l),e.savedStates.savedWhenMouseWheelCroppingStart=void 0}}}(e,t.payload,t.telemetry)},handleMirrorXClick:function(e){qc(e,function(){!function(e){var t=Di(e.cropInteraction.uvToWorld).x;gc(e,hc(e.image._preciseUvToWorld,za,t))}(e)},"mirrorImageX",Le.KeepAll)},handleMirrorYClick:function(e){qc(e,function(){!function(e){var t=Di(e.cropInteraction.uvToWorld).y;gc(e,hc(e.image._preciseUvToWorld,Ga,t))}(e)},"mirrorImageY",Le.KeepAll)},setDefaultEdits:function(e,t){!function(e,t){e.userDefinedDefaults=function(e,t){var n=Ka(t.x,t.y);return{cropInteraction:{aspectRatio:e.aspectRatio||Do,uvToWorld:e.cropRectangle?gi(e.cropRectangle):n},image:{_preciseUvToWorld:e.imageTransform?Wr(e.imageTransform):n}}}(t,e.image.originalPixelSize)}(e,t.payload)},handleZoomChange:function(e,t){Tc(e,t.payload,t.telemetry)},handleZoomDeltaChange:function(e,t){qc(e,function(){!function(e,t,n){e.cropInteraction.enableZoomToCrop?Vr(e,t,!0,n):e.view.enableZoomToView&&Tc(e,function(e,t){return e*(1-t)}(di(e.view.worldToView),t))}(e,t.payload,t.telemetry)},zr,Le.KeepAll)},handleSetRotation:function(e,t){!function(e,t){vc(e,t-Xa(e.image._preciseUvToWorld)),_r(e)}(e,t.payload)},handleTouchDown:function(e,t){!function(e,t){e.view.allowDraggingView&&(e.cropInteraction.mode=cr.draggingView),e.pointer.movePos=t.center,e.pointer.imageUvGrabPosition=Dr(t.center,e.view.worldToView,e.image._preciseUvToWorld),e.touch.downCenterPos=t.center,e.touch.scale=1,e.touch.isDown=!0}(e,t.payload)},handleTouchMove:function(e,t){qc(e,function(){!function(e,t,n){if(e.touch.isDown){var a=t.center,i=t.scale;if(e.cropInteraction.enableZoomToCrop&&Cr(e.touch.downCenterPos,e.view.worldToView,e.cropInteraction.uvToWorld)&&e.view.viewFitting.mode!==dr.none){var r=e.touch.scale-i;e.image._preciseUvToWorld=Mc(e.view.worldToView,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld,e.pointer.imageUvGrabPosition,a),Vr(e,r,!1,n),e.cropInteraction.mode=cr.draggingImage}else if(e.view.enableZoomToView){var o=i/e.touch.scale;e.view.worldToView=Ec(a,e.pointer.movePos,e.view.worldToView),vr(e,di(e.view.worldToView)*o,a,n).zoomIsMinimum&&_r(e),e.cropInteraction.mode=cr.draggingView}e.touch.scale=i,e.pointer.movePos=a}}(e,t.payload,t.telemetry)},"pinchToCrop",Le.KeepLast)},handleTouchUp:function(e,t){!function(e,t){e.touch.isDown=!1}(e,t.payload)},recenterView:function(e,t){!function(e,t){e.view.viewFitting.mode=dr.fitCropRectInView,hr(e),t&&t.logRecenterEvent()}(e,t.telemetry)},setCropHandleSizeCss:function(e,t){!function(e,t){var n=t.handleSizeCss,a=t.handleHitAreaSizeCss;e.cropUiDisplay.handleSizeCss=n,e.cropUiDisplay.handleHitAreaSizeCss=a}(e,t.payload)},setCssToPhysicalPixelRatio:function(e,t){!function(e,t){e.device.pixelRatio=t}(e,t.payload)},setShouldConstrainCropInImage:function(e,t){!function(e,t){e.cropInteraction.shouldConstrainInImage=t,e.cropInteraction.shouldConstrainInImage&&Pr(e,ji(e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld))}(e,t.payload)},handleFrameTick:function(e,t){!function(e,t){var n;e.animations=function(e,t){var n=e.outsideCropVisibility,a=e.gridLineVisibility,i=e.dismissGridLineVisibility,r=e.dismissOutsideCropVisibility,o=e.transitionToViewingOriginal,s=e.worldToView,c=e.image,d=e.crop,l=e.dismissCropOverlays,u=Ji(n,t,100),f=function(e,t,n){var a=Ji(e,t,100);return a.isActive?or(e.numGridLines,a):or()}(a,t),p=Ji(i,t,400),m=Ji(r,t,400),_=Ji(o,t,300),h=ir(s,t,100,$i),b=ir(c,t,100,$i),g=ir(d,t,100,$i),v=Ji(l,t,3e3);return{needsFrameTick:u.isActive||f.isActive||p.isActive||m.isActive||o.isActive||h.isActive||b.isActive||g.isActive||v.isActive,outsideCropVisibility:u,gridLineVisibility:f,dismissGridLineVisibility:p,dismissOutsideCropVisibility:m,transitionToViewingOriginal:_,worldToView:h,image:b,crop:g,dismissCropOverlays:v,currentTime:t}}(e.animations,t),e.view.animateViewWhenViewportIsResized&&!e.animations.worldToView.isActive&&(e.view.animateViewWhenViewportIsResized=!1),!Sr(e.cropInteraction.mode)||(n=e.animations).dismissGridLineVisibility.isActive||n.dismissOutsideCropVisibility.isActive||(e.cropInteraction.mode=yo)}(e,t.payload)},setViewFittingMode:function(e,t){!function(e,t){e.view.viewFitting.mode=t,hr(e)}(e,t.payload)},setViewFittingMarginCssPixels:function(e,t){!function(e,t,n){e.view.viewFitting.marginCssPixels=jc({},t),_r(e,n)}(e,t.payload.marginCssPixels,t.payload.shouldAnimate)},setAllowDraggingImageOutsideCropRect:function(e,t){!function(e,t){e.cropInteraction.allowDraggingImageOutsideRect=t}(e,t.payload)},setAllowDraggingView:function(e,t){!function(e,t){e.view.allowDraggingView=t}(e,t.payload)},setEnableZoomToView:function(e,t){!function(e,t){e.view.enableZoomToView=t}(e,t.payload)},setEnableZoomToCrop:function(e,t){!function(e,t){e.cropInteraction.enableZoomToCrop=t}(e,t.payload)},rotateCropAndImageBy90:function(e,t){qc(e,function(){!function(e,t){var n=!bc(e),a=t===Ir.Clockwise?90:-90,i=Ii(a,e.cropInteraction._uvToWorldBeforeRotate,e.image._preciseUvToWorld);n?(e.animations.needsFrameTick=!0,e.animations.image=ar(e.animations.image,e.image._preciseUvToWorld,i)):e.animations.image=nr(),e.image._preciseUvToWorld=i,e.cropInteraction.aspectRatio=function(e,t){var n=e;if(Ia(e)){var a=e.ratio;t.forEach(function(e){Ia(e)&&e.ratio.x===a.y&&e.ratio.y===a.x&&(n=e)})}return n}(e.cropInteraction.aspectRatio,e.cropInteraction.aspectRatiosList);var r=Ii(a,e.cropInteraction._uvToWorldBeforeRotate,e.cropInteraction.uvToWorld);e.animations.crop=n?ar(e.animations.crop,e.cropInteraction.uvToWorld,r):nr(),e.cropInteraction.shouldInvertOriginalAspectRatio=!e.cropInteraction.shouldInvertOriginalAspectRatio,function(e){e.cropInteraction.uvToWorld=xi(e.cropInteraction.uvToWorld),e.cropInteraction._uvToWorldBeforeRotate=xi(e.cropInteraction._uvToWorldBeforeRotate),e.cropInteraction._uvToWorldBeforeZoomToCrop=xi(e.cropInteraction._uvToWorldBeforeZoomToCrop),e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange=xi(e.cropInteraction._lastUvToWorldNotSetByAspectRatioChange)}(e),mc(e),Rr(e),_r(e,n)}(e,t.payload)},"rotateCropBy90",Le.KeepAll)},startWindowSelectionMode:function(e){e.cropInteraction.mode=cr.selectingFirstCorner},handleRotationBarPointerUp:function(e,t){Ic(e,t.payload.inputType,t.telemetry)},handleRotationBarPointerMove:function(e,t){e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown&&function(e,t){if(void 0!==t){var n=e.undoRedoStack.undoStack.findIndex(function(e){return e.undoPayload.incrementingIdOfPointerThatIsDown===t.redoPayload.incrementingIdOfPointerThatIsDown&&Wc(e.undoPayload,t.redoPayload,5)});n>=0&&(e.undoRedoStack.undoStack=e.undoRedoStack.undoStack.slice(0,n))}}(e,qc(e,function(){!function(e,t){if(e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown&&!t.isPrimaryButtonDownOrTouchDown&&Ic(e,t.inputType),e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown){var n=t.pointerPhysicalPixelPos,a=Er(Xa(e.image._preciseUvToWorld)),i=544*e.device.pixelRatio,r=function(e,t,n,a,i){var r=a-n.x;if(Math.abs(r)<28)return 0;var o=(t.x-n.x)/i;return e+Math.min(Math.abs(o),1)*(o<0?Oc:Cc)}(a,e.rotationUi.rotationBarPointer.movePos,n,e.rotationUi.deadZoneCenterPos,i);e.rotationUi.deadZoneCenterPos=function(e,t,n,a,i){return t>=Cc||t<=Oc?yc(n,i,28,e):a}(a,r,n,e.rotationUi.deadZoneCenterPos,i),Sc(e,r),e.rotationUi.rotationBarPointer.movePos=xc({},n),_r(e)}}(e,t.payload)},Gr,Le.KeepLast))},handleRotationBarPointerDown:function(e,t){!function(e,t){var n=t.pointerPhysicalPixelPos,a=e.rotationUi.rotationBarPointer,i=e.device.pixelRatio;a.incrementingIdOfPointerThatIsDown=fe(),a.movePos=wc({},n),e.rotationUi.deadZoneCenterPos=yc(n,544*i,28,Er(Xa(e.image._preciseUvToWorld))),e.cropInteraction.mode=cr.rotating,e.animations.needsFrameTick=!0,e.animations.gridLineVisibility=sr(8)}(e,t.payload)},setRotationBarIsKeyboardFocused:function(e,t){!function(e,t){e.rotationUi.isKeyboardFocused=t,Ac(e)}(e,t.payload)},adjustRotationOnKeyDown:function(e,t){e.savedStates.savedWhenKeyboardRotatingStart||(e.savedStates.savedWhenKeyboardRotatingStart=Xr(e)),function(e,t,n){var a=t.direction,i=t.sliderShiftingValue,r=function(e,t,n){switch(e){case ln.Right:return t+n;case ln.Left:return t-n;default:return t}}(a,Er(Xa(e.image._preciseUvToWorld)),i);Sc(e,r),null==n||n.logRotateEvent({angle:r,inputType:t.inputType}),e.animations.needsFrameTick=!0,e.cropInteraction.mode!==cr.keyboardRotating&&(e.cropInteraction.mode=cr.keyboardRotating,e.animations.gridLineVisibility=sr(8),e.animations.outsideCropVisibility={startTime:void 0,isActive:!0}),e.animations.dismissGridLineVisibility={startTime:void 0,isActive:!0},e.animations.dismissOutsideCropVisibility={startTime:void 0,isActive:!0},_r(e)}(e,t.payload,t.telemetry)},adjustRotationOnKeyUp:function(e,t){var n=e.savedStates.savedWhenKeyboardRotatingStart;n?($r(e,n,Gr),e.savedStates.savedWhenKeyboardRotatingStart=void 0):Dc(e)},abortCurrentMode:function(e){e.cropInteraction.mode!==cr.selectingFirstCorner&&e.cropInteraction.mode!==cr.selectingSecondCorner||(e.cropInteraction.mode=yo,hr(e))},setAspectRatio:function(e,t){qc(e,function(){Nc(e,t.payload)},"setAspectRatio",Le.KeepAll)},setSessionFullImageSize:function(e,t){!function(e,t){var n;if(t){var a=Ka(t.x,t.y);Gc(e,{imageTransform:qr(a),cropRectangle:vi(a),originalImageSize:t,aspectRatio:(null===(n=e.userDefinedDefaults)||void 0===n?void 0:n.cropInteraction.aspectRatio)||Do,shouldInvertOriginalAspectRatio:!1,undoRedoStack:e.undoRedoStack})}}(e,t.payload)},handleCleanupCanvasPointers:function(e){!function(e){e.pointer.pointerDowns=[]}(e)},handleCleanupRotationBarPointer:function(e){!function(e){e.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown=void 0}(e)}},extraReducers:function(e){e.addCase(ne,function(e,t){e.savedStates.savedWhenPointerCroppingStart||e.cropInteraction.activeHandleIndex===un.None||(e.savedStates.savedWhenPointerCroppingStart=Xr(e)),function(e,t){if(t.isPrimaryButtonDownOrTouchDown||t.isMiddleButtonDown||t.isRightButtonDown){var n=e.pointer.pointerDowns.length>0;if(e.pointer.pointerDowns=e.pointer.pointerDowns.concat({pointerId:t.pointerId,isTouch:t.isTouch}),!n){e.cropInteraction.isKeyboardFocused=!1;var a=t.pointerPhysicalPixelPos;e.pointer.imageUvGrabPosition=Dr(a,e.view.worldToView,e.image._preciseUvToWorld),e.pointer.downPos=a,e.pointer.maxDragDistance=0;var i=vi(ci(e.view.worldToView,e.cropInteraction.uvToWorld)),r=Mi(e.cropUiDisplay.handleHitAreaSizeCss,e.device.pixelRatio);if(e.cropInteraction.activeHandleIndex=Ai(a,i,r),e.cropInteraction.mode=function(e,t,n,a){switch(e.mode){case cr.selectingFirstCorner:if(Fr(e.shouldConstrainInImage,t))return cr.selectingSecondCorner;break;case cr.zoomToCrop:case cr.keyboardCropping:case cr.keyboardRotating:case cr.none:return n?a?cr.draggingView:cr.none:e.activeHandleIndex!==un.None||pn(t,fn)?e.activeHandleIndex===un.Center||e.activeHandleIndex===un.None&&e.allowDraggingImageOutsideRect&&pn(t,fn)?cr.draggingImage:cr.usingNineSliceCropHandles:a?cr.draggingView:cr.none}return e.mode}(e.cropInteraction,e.pointer.imageUvGrabPosition,t.ctrlKey,e.view.allowDraggingView),e.cropInteraction.mode===cr.selectingSecondCorner){var o=si(e.view.worldToView,a);Ur(e,dn({left:o.x,top:o.y,width:1,height:1})),mc(e)}else e.cropInteraction.mode===cr.usingNineSliceCropHandles&&(e.cropInteraction.focusedHandleIndex=e.cropInteraction.activeHandleIndex,e.cropInteraction.activeHandleIndex!==un.None&&(e.pointer.downOffsetFromCropHandleCenter=La(a,(s=e.cropInteraction.activeHandleIndex,d=(c=i).left,l=c.width,u=c.top,f=c.height,p=Ei(s),{x:d+(wi(s)+1)*(l/2),y:u+(p+1)*(f/2)}))),e.cropInteraction.rectAtStartOfResize=vi(e.cropInteraction.uvToWorld));e.cropInteraction.mode!==cr.draggingView&&e.cropInteraction.mode!==cr.none&&e.cropInteraction.mode!==cr.disabled&&(e.animations.needsFrameTick=!0,e.animations.outsideCropVisibility={startTime:void 0,isActive:!0},e.animations.gridLineVisibility=sr(2)),e.cropInteraction.mode===cr.disabled&&(e.animations.transitionToViewingOriginal={startTime:void 0,isActive:!0},e.animations.needsFrameTick=!0),e.pointer.movePos=a,Ac(e)}}var s,c,d,l,u,f,p}(e,t.payload)}).addCase(ae,function(e,t){var n=e.savedStates.savedWhenPointerCroppingStart;n?($r(e,n,Kr),e.savedStates.savedWhenPointerCroppingStart=void 0):Dc(e),function(e,t,n,a){if(0!==e.pointer.pointerDowns.length&&e.pointer.pointerDowns.some(function(e){return e.pointerId===t})){var i,r,o,s,c,d,l=(i=e.pointer.pointerDowns,r=t,o=Rc(i),d=(c=Rc(s=i.filter(function(e){return e.pointerId!==r})))<o,1===s.length&&1===c&&d);if(e.pointer.pointerDowns=e.pointer.pointerDowns.filter(function(e){return e.pointerId!==t}),l)e.pointer.preventShift=!0;else if(!(e.pointer.pointerDowns.length>0)){if(e.pointer.offset={x:0,y:0},a&&e.cropInteraction.mode!==cr.none&&e.cropInteraction.mode!==cr.disabled){var u=vi(e.cropInteraction.uvToWorld);bn(e.cropInteraction.rectAtStartOfResize,u)||a.logCropEvent({inputType:n})}e.cropInteraction.mode!==cr.draggingView&&e.cropInteraction.mode!==cr.none&&e.cropInteraction.mode!==cr.disabled&&(e.animations.needsFrameTick=!0,e.animations.outsideCropVisibility={startTime:void 0,isActive:!0},e.animations.gridLineVisibility=sr(2)),e.cropInteraction.mode===cr.selectingSecondCorner&&(e.view.viewFitting.mode=dr.fitCropRectInView),e.cropInteraction.mode===cr.draggingView||e.cropInteraction.mode===cr.disabled?(Hc(e),e.cropInteraction.mode=cr.disabled):(hr(e),e.cropInteraction.mode=yo),Ac(e)}}}(e,t.payload.pointerId,t.payload.inputType,t.telemetry)}).addCase(ie,function(e,t){!function(e,t){!function(e,t){var n=e.cropInteraction.uvToWorld;e.cropInteraction.uvToWorld=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([],n,!0),t(),fi(e.cropInteraction.uvToWorld,n)&&(e.cropInteraction.uvToWorld=n)}(e,function(){if(!(e.pointer.pointerDowns.length>1)){if(1===e.pointer.pointerDowns.length&&e.pointer.pointerDowns[0].pointerId!==t.pointerId)return;var n=t.pointerPhysicalPixelPos;e.pointer.preventShift&&(e.cropInteraction.mode!==cr.draggingView&&e.cropInteraction.mode!==cr.draggingImage||(e.pointer.offset=La(e.pointer.movePos,n)),e.pointer.preventShift=!1);var a=Ea(n,e.pointer.offset);switch(e.cropInteraction.mode){case cr.disabled:!function(e,t){e.pointer.pointerDowns.length>0&&e.animations.transitionToViewingOriginal.isActive&&e.view.viewFitting.mode!==dr.fitCropRectInView&&(e.cropInteraction.mode=cr.draggingView,e.animations.transitionToViewingOriginal={startTime:void 0,isActive:!1},kc(e,t))}(e,a);break;case cr.draggingView:(t.isMiddleButtonDown||t.isRightButtonDown||t.isPrimaryButtonDownOrTouchDown&&e.cropInteraction.enableLeftMouseDraggingView)&&kc(e,a);break;case cr.zoomToCrop:case cr.keyboardCropping:case cr.keyboardRotating:case cr.none:!function(e,t){var n,a=Mi(e.cropUiDisplay.handleHitAreaSizeCss,e.device.pixelRatio);e.cropInteraction.activeHandleIndex=(n=a,Ai(t,vi(ci(e.view.worldToView,e.cropInteraction.uvToWorld)),n))}(e,a);break;case cr.usingNineSliceCropHandles:!function(e,t,n){if(e.cropInteraction.activeHandleIndex!==un.Center){var a=vi(e.cropInteraction.uvToWorld),i=La(t,e.pointer.downOffsetFromCropHandleCenter),r=si(e.view.worldToView,i),o=function(e,t,n){var a=vi(e.cropInteraction.uvToWorld),i=vi(e.image._preciseUvToWorld),r=wr(ki(e.cropUiDisplay.handleSizeCss,e.device.pixelRatio),e.view.worldToView);return function(e,t,n,a,i,r,o,s){if(-1===n)return e;var c=xr({},e),d=a.x,l=a.y,u=Ei(n),f=wi(n);if(0===f&&0===u){d=Math.max(t.left+e.width/2,d),d=Math.min(t.left+t.width-e.width/2,d),l=Math.max(t.top+e.height/2,l),l=Math.min(t.top+t.height-e.height/2,l);var p=d-(e.left+e.width/2),m=l-(e.top+e.height/2);c.left+=p,c.top+=m}else d=Math.max(t.left,d),d=Math.min(t.left+t.width,d),l=Math.max(t.top,l),l=Math.min(t.top+t.height,l),d-=e.left,l-=e.top,-1===f?(d=Math.min(d,c.width-r),c.left=d+e.left,c.width=c.width-d):1===f&&(d=Math.max(d,r),c.width=d),-1===u?(l=Math.min(l,c.height-r),c.top=l+e.top,c.height=c.height-l):1===u&&(l=Math.max(l,r),c.height=l),c=s?Qi(c,s,n):function(e,t,n,a,i,r,o,s){var c=qi(t.width/t.height,s),d=c.x/c.y,l=dn(t),u=zi(i.x,l.left,l.left+l.width),f=zi(i.y,l.top,l.top+l.height),p=1,m=1;l.width!==e.width&&(p=Math.max(p,Math.min(Math.round(u+a)-(r?l.left:l.width+l.left),n.width-t.width))),l.height!==e.height&&(m=Math.max(m,Math.min(Math.round(f+a)-(o?l.top:l.height+l.top),n.height-t.height)));for(var _=0;_<p;_++)for(var h=0;h<m;h++)if(Math.abs((l.width+_)/(l.height+h)-d)<1e-6)return r&&(l.left-=_),o&&(l.top-=h),l.width+=_,l.height+=h,l;return t}(e,c,t,i,a,-1===f,-1===u,o);var _=dn(c);return vn(_,r)?_:e}(a,i,e.cropInteraction.activeHandleIndex,t,1/li(e.view.worldToView,1,1),r,e.cropInteraction.aspectRatiosList,Lc(e,n))}(e,r,n);if(!bn(o,a)){if(Ur(e,o),e.cropInteraction.shouldConstrainInImage&&(Pr(e,Ni(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatio,e.cropInteraction.activeHandleIndex)),gn(vi(e.cropInteraction.uvToWorld),a)))switch(e.cropInteraction.activeHandleIndex){case un.BottomCenter:r.y>a.top+a.height&&Ur(e,a);break;case un.TopCenter:r.y<a.top&&Ur(e,a);break;case un.SideLeft:r.x<a.left&&Ur(e,a);break;case un.SideRight:r.x>a.left+a.width&&Ur(e,a)}mc(e);var s=vi(e.cropInteraction.uvToWorld);(s.width>e.cropInteraction.rectAtStartOfResize.width||s.height>e.cropInteraction.rectAtStartOfResize.height)&&_r(e)}Ac(e)}}(e,a,t.shiftKey);break;case cr.draggingImage:!function(e,t){e.image._preciseUvToWorld=Mc(e.view.worldToView,e.image._preciseUvToWorld,e.cropInteraction.uvToWorld,e.pointer.imageUvGrabPosition,t),e.animations.image=nr(),e.animations.crop=nr(),mc(e)}(e,a);break;case cr.selectingFirstCorner:break;case cr.selectingSecondCorner:!function(e,t){var n,a,i,r=ti(e.image._preciseUvToWorld,e.pointer.imageUvGrabPosition),o=si(e.view.worldToView,t);e.cropInteraction.shouldConstrainInImage&&(n=o,(i=si(a=e.image._preciseUvToWorld,n)).x=zi(i.x,0,1),i.y=zi(i.y,0,1),o=ti(a,i));var s,c,d,l,u,f,p=(s=r,c=o,d=Math.min(s.x,c.x),l=Math.min(s.y,c.y),u=Math.max(s.x,c.x),f=Math.max(s.y,c.y),dn({left:d,top:l,width:Math.max(1,u-d),height:Math.max(1,f-l)}));Ur(e,p=Qi(p,Wi(e.cropInteraction.aspectRatio,gi(p),e.image.originalPixelSize,e.cropInteraction.shouldInvertOriginalAspectRatio),Pc(r,o))),e.cropInteraction.shouldConstrainInImage&&Pr(e,Ni(e.cropInteraction.uvToWorld,e.image._preciseUvToWorld,e.cropInteraction.aspectRatio,Pc(r,o))),mc(e)}(e,a)}if(e.pointer.movePos=a,e.pointer.pointerDowns.length>0){var i=Ba(e.pointer.downPos,e.pointer.movePos);e.pointer.maxDragDistance=Math.max(i,e.pointer.maxDragDistance)}}})}(e,t.payload)}).addCase(Os,function(e,t){co(e,t.payload)}).addCase(ks,function(e,t){co(e,t.payload.activeEditorActivity)}).addCase(Ms,function(e,t){co(e,Ss.activeEditorActivity)}).addCase(xs,function(e){hr(e)}).addCase(se,function(e,t){!function(e,t){void 0===t&&(t=!1),Bc(e,t),Rr(e),Hr(e),e.savedStates={},e.undoRedoStack=Io.undoRedoStack}(e,t.payload)}).addCase(ce,function(e,t){Gc(e,t.payload.transforms)}),Se(e,Kc)}}),Jc=(Qc=Yc.actions).handleFrameTick,Xc=Qc.setCanvasPixelSize,Zc=(Qc.setResolutionScaling,Qc.handleImageTextureLoaded),$c=Qc.handleMouseWheel,ed=Qc.handleMirrorXClick,td=Qc.handleMirrorYClick,nd=Qc.setDefaultEdits,ad=(Qc.handleZoomChange,Qc.handleZoomDeltaChange),id=(Qc.handleSetRotation,Qc.handleTouchDown),rd=Qc.handleTouchMove,od=Qc.handleTouchUp,sd=Qc.handleCleanupCanvasPointers,cd=Qc.handleCleanupRotationBarPointer,dd=Qc.recenterView,ld=Qc.setCropHandleSizeCss,ud=Qc.setCssToPhysicalPixelRatio,fd=(Qc.setShouldConstrainCropInImage,Qc.setViewFittingMode,Qc.setViewFittingMarginCssPixels),pd=(Qc.setAllowDraggingImageOutsideCropRect,Qc.setAllowDraggingView,Qc.setEnableZoomToView,Qc.setEnableZoomToCrop,Qc.rotateCropAndImageBy90),md=(Qc.startWindowSelectionMode,Qc.handleRotationBarPointerUp),_d=Qc.handleRotationBarPointerMove,hd=Qc.handleRotationBarPointerDown,bd=Qc.setRotationBarIsKeyboardFocused,gd=Qc.abortCurrentMode,vd=Qc.setAspectRatio,yd=Qc.adjustCropRect,Sd=Qc.adjustCropRectOnKeyUp,Dd=Qc.adjustRotationOnKeyDown,Id=Qc.adjustRotationOnKeyUp,xd=Qc.setFocusedCropHandle,Cd=Qc.panView,Od=Qc.setSessionFullImageSize,wd=Yc.reducer,Ed=Object(ga.e)([function(e){return e.transformTools.animations.gridLineVisibility.numGridLines},Ao],function(e,t){return function(e,t){if(e)return e;switch(t){case cr.keyboardRotating:case cr.rotating:return 8;case cr.usingNineSliceCropHandles:case cr.selectingSecondCorner:case cr.draggingImage:case cr.keyboardCropping:case cr.zoomToCrop:return 2;default:return 0}}(e,t)}),Ad=Object(ga.e)([function(e){return Xi(e.transformTools.animations.gridLineVisibility,e.transformTools.animations.currentTime,100)},function(e){return Xi(e.transformTools.animations.dismissGridLineVisibility,e.transformTools.animations.currentTime,400)},function(e){return Go(e)||!!e.transformTools.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown},To,Oo,Ao],function(e,t,n,a,i,r){return function(e,t,n,a,i,r){return function(e,t,n){var a=e||Sr(n);return tn(a?0:.75,a?.75:0,t)}(e,a,r)*function(e,t){return Sr(t)?yr([1,1,1,1,0],e):1}(i,r)*function(e){return nn(8,3,di(e))}(t)*function(e,t){var n=vi(ci(e,t));return nn(50,80,Math.min(n.height,n.width))}(t,n)}(n,a,i,e,t,r)}),Ld=c.a.createContext({textures:{main:null,blend:null,overlay:null,mask:null},shouldUseFakeMipMaps:!1});function kd(e){return function(t){return t.split("@").join("_"+e)}}var Md=function(){function e(e){void 0===e&&(e=[]),this._effects=[],this._effects=e}return e.prototype.getShaderProgramName=function(){return this._effects.reduce(function(e,t){return e+" "+t.getName()},"image")},e.prototype.getUniformNames=function(){var e=[];return this._effects.forEach(function(t,n){e=e.concat(t.getUniformNames(kd(n)))}),e},e.prototype.getSamplerNames=function(){var e=[];return this._effects.forEach(function(t,n){t.getSamplerNames&&(e=e.concat(t.getSamplerNames(kd(n))))}),e},e.prototype.getEffects=function(){return this._effects},e.prototype.registerEffect=function(e){this.unRegisterEffect(e),this._effects.push(e)},e.prototype.unRegisterEffect=function(e){this._effects=this._effects.filter(function(t){return t.getName()!==e.getName()})},e.prototype.getHeaderCode=function(){var e=this._effects.reduce(function(e,t,n){return t.getFunctions(kd(n)).forEach(function(t){e[t]=""}),e},{});return"// functions -- \n"+Object.keys(e).join("\n\n")+this._effects.reduce(function(e,t,n){return e+t.getHeaderCode(kd(n))},"// shader effects -- \n")},e.prototype.getBodyCode=function(){return this._effects.reduce(function(e,t,n){return e+t.getShaderFunctionBody(kd(n))},"// shader effects -- \n")},e.prototype.onBeforeBabylonRender=function(e){this._effects.forEach(function(t,n){t.onBeforeBabylonRender(e,kd(n))})},e}(),Pd="\n#ifndef HSV2RGB\n#define HSV2RGB\nvec3  hsv2rgb( in vec3 c )\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n#endif\n",Td="\n#ifndef RGB2HSV\n#define RGB2HSV\nvec3 rgb2hsv( in vec3 c )\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n#endif\n",Ud="\n#ifndef GAMMALINEARSPACE\n#define GAMMALINEARSPACE\n\nconst float LinearEncodePowerApprox = 2.2;\nconst float GammaEncodePowerApprox = 1.0 / LinearEncodePowerApprox;\n\nvec3 toLinearSpace(vec3 color)\n{\n    return pow(color, vec3(LinearEncodePowerApprox));\n}\n\nvec3 toGammaSpace(vec3 color)\n{\n    return pow(color, vec3(GammaEncodePowerApprox));\n}\n#endif\n",Fd=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},Hd="textureSampler",Rd="uv",Nd="uScreenPixelPos",Bd="uTransform",jd="uTransformInverse",Vd="uDisplaySize",zd="uColorOverrideLevel",Gd="uColorOverride",Kd="secondaryBlendTextureSampler",Wd="uSecondaryBlend",qd="secondaryOverlayTextureSampler",Qd="uOverlayTextureAlpha",Yd="uMaskTextureSampler",Jd="uIsRenderingForExport",Xd="uFakeMipMapsEnabled",Zd="uMaskVisualizationColor",$d="position",el=[Gd,zd,Vd,Hd,Nd,Bd,jd,Rd,Kd,Wd,qd,Qd,Yd,Jd,Xd,Zd],tl=[$d],nl=[Hd,Kd,qd,Yd],al="ENABLE_SECONDARY_BLEND",il="ENABLE_FAKE_MIP_MAPS_EFFECT",rl=function(e){var t=e.getShaderProgramName();return Object(s.useMemo)(function(){return{name:t,attributeNames:tl,uniformNames:Fd(Fd([],e.getUniformNames(),!0),el,!0),samplerNames:Fd(Fd([],e.getSamplerNames(),!0),nl,!0),vertexShader:(l=Nd,u=Vd,f=Bd,p=jd,m=$d,"\n    #ifdef GL_ES\n    precision highp float;\n    #endif\n\n    attribute vec4 ".concat(m,";\n    varying highp vec2 ").concat(l,";\n    uniform vec2 ").concat(u,";\n    uniform mat3 ").concat(f,";\n    uniform mat3 ").concat(p,";\n    varying vec3 uvPosition;\n\n    void main(void) {\n      vec3 pos = vec3(").concat(m,".x* 0.5 + 0.5, ").concat(m,".y* 0.5 + 0.5, 1.0) * ").concat(f,";\n\n      ").concat(l," = pos.xy;\n      uvPosition = vec3(").concat(l,".x, ").concat(l,".y,1.0) * ").concat(p,";\n\n      //convert to GL coordinates.\n      pos.x = (pos.x / ").concat(u,".x) * 2.0 - 1.0;\n      pos.y = (-pos.y /").concat(u,".y) * 2.0 + 1.0;\n\n      gl_Position = vec4(pos.x,pos.y,0.0,1.0);\n    }\n  ")),fragmentShader:(n=e.getHeaderCode(),a=e.getBodyCode(),i=Hd,r=zd,o=Gd,s=Kd,c=Wd,d=Jd,"\n    #ifdef GL_ES\n    precision highp float;\n    #endif\n    varying highp vec2 ".concat(Nd,";\n    uniform sampler2D ").concat(i,";\n    uniform vec4 ").concat(o,";\n    uniform float ").concat(r,";\n    uniform mat3 ").concat("uTransform",";\n    uniform mat3 ").concat("uTransformInverse",";\n    uniform vec2 ").concat("uDisplaySize",";\n    uniform float ").concat(d,";\n    varying vec3 uvPosition;\n    ").concat(n,"\n\n    ").concat(Ud,"\n\n    #ifdef ").concat(al,"\n      uniform sampler2D ").concat(s,";\n      uniform float ").concat(c,";\n    #endif\n\n    #ifdef ").concat(il,"\n        uniform float ").concat(Xd,";\n    #endif\n\n    vec4 sampleTexture(sampler2D sampler, vec2 uv){\n      #ifdef ").concat(il,"\n        if(").concat(Xd,"==0.0 || ").concat(d,"==1.0){\n          return texture2D(sampler,uv);\n        }else{\n          vec3 originOffset = vec3(0.,0.,1.0) * ").concat(jd,";\n          vec3 uvOffset3 = vec3(0.5,0.5,1.0) * ").concat(jd,";\n          uvOffset3 -= originOffset;\n          vec2 uvOffset = uvOffset3.xy;\n          vec2 diagonalOffset = vec2(uvOffset.x,-uvOffset.y);\n          return 0.2 * (  texture2D(sampler,uv)\n                           + texture2D(sampler,uv - uvOffset) \n                           + texture2D(sampler,uv + uvOffset)\n                           + texture2D(sampler,uv + diagonalOffset)\n                           + texture2D(sampler,uv - diagonalOffset)\n                           );\n        }\n      #else\n        return texture2D(sampler,uv);\n      #endif\n    }\n\n    vec4 getTextureColor(vec2 uv){\n      #ifdef ").concat(al,"\n        if(").concat(c," == 0.){\n          return sampleTexture(").concat(i,", uv);\n        }\n        return mix(sampleTexture(").concat(i,", uv),sampleTexture(").concat(s,", uv),").concat(c,");\n      #else\n        return sampleTexture(").concat(i,", uv);\n      #endif\n    }\n\n    void main(void) {\n\n        float finalAlphaMultiply = 1.;\n        float overlayTextureAlphaOverride = 1.;\n        vec3 ").concat("uv"," = uvPosition;\n        gl_FragColor = getTextureColor(").concat("uv",".xy);\n        gl_FragColor = mix(gl_FragColor,").concat(o,",").concat(r,");\n\n        // effect 'body' code is inserted here.\n        // effect can can modify the above variables.\n        ").concat(a,"\n\n      gl_FragColor.a *= finalAlphaMultiply;\n    }\n  "))};var n,a,i,r,o,s,c,d,l,u,f,p,m},[e,t])},ol=function(e){return Object(s.useMemo)(function(){return e||new Md},[e])},sl=[0,0,0,1],cl=[1,0,0,1],dl=[0,0,0,0];function ll(e){return{x:e[0],y:e[1],z:e[2],w:e[3]}}var ul=new Map([[1,{angle:0,mirror:!1}],[2,{angle:0,mirror:!0}],[3,{angle:180,mirror:!1}],[4,{angle:180,mirror:!0}],[5,{angle:-90,mirror:!0}],[6,{angle:90,mirror:!1}],[7,{angle:90,mirror:!0}],[8,{angle:-90,mirror:!1}]]);function fl(e,t,n){void 0===t&&(t={x:1,y:1}),void 0===n&&(n=t);var a=ul.get(e),i=a.angle,r=a.mirror,o=ci(Ya(i),r?za():[1,0,0,0,1,0],Ka(t.x,t.y)),s=ti(o,{x:0,y:0}),c=ti(o,{x:n.x,y:0}),d=ti(o,{x:n.x,y:n.y}),l=ti(o,{x:0,y:n.y});return ci(qa(-Math.min(s.x,c.x,d.x,l.x),-Math.min(s.y,c.y,d.y,l.y)),o)}function pl(e){var t=ul.get(e).angle;return 90===Math.abs(t)}function ml(e,t){return void 0===e&&(e=1),ci(t,fl(e))}var _l=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};function hl(e,t,n,a,i,r,o,s){void 0===s&&(s=!1);var c=null==i?void 0:i.main,d=ml(null==c?void 0:c.orientation,e);c&&0!==c.parts.length?c.parts.forEach(function(e,l){var u,f,p,m,_,h,b=ci(d,qa(e.rect.left/c.width,e.rect.top/c.height),Ka(e.rect.width/c.width,e.rect.height/c.height)),g=e.texture;if(!g)throw new Error("texture part is missing texture");bl(b,t,s,n,a,{main:g,blend:(null===(f=null===(u=null==i?void 0:i.blend)||void 0===u?void 0:u.parts[l])||void 0===f?void 0:f.texture)||null,overlay:(null===(m=null===(p=null==i?void 0:i.overlay)||void 0===p?void 0:p.parts[l])||void 0===m?void 0:m.texture)||null,mask:(null===(h=null===(_=null==i?void 0:i.mask)||void 0===_?void 0:_.parts[l])||void 0===h?void 0:h.texture)||null},r,o)}):bl(d,t,s,n,a,void 0,r,o)}var bl=function(e,t,n,a,i,r,o,s){var c,d;if((null==i?void 0:i.effect.isReady())&&i&&o&&s&&$a(e)){var l=i.effect;if(s.applyEffectWrapper(i),l.setFloat2(Vd,(null===(c=o.getRenderingCanvas())||void 0===c?void 0:c.width)||0,(null===(d=o.getRenderingCanvas())||void 0===d?void 0:d.height)||0),l.setMatrix3x3(Bd,new Float32Array(_l(_l([],e,!0),[0,0,1],!1))),l.setMatrix3x3(jd,new Float32Array(_l(_l([],ei(e),!0),[0,0,1],!1))),l.setFloat(Jd,n?1:0),null==r?void 0:r.main)l.setTexture(Hd,r.main),(null==r?void 0:r.blend)&&l.setTexture(Kd,r.blend),(null==r?void 0:r.overlay)&&l.setTexture(qd,r.overlay),(null==r?void 0:r.mask)&&l.setTexture(Yd,r.mask),l.setFloat(zd,0);else{var u=a||sl;l.setVector4(Gd,ll(u)),l.setFloat(zd,1)}t.onBeforeBabylonRender(l),(null==r?void 0:r.overlay)||l.setFloat(Qd,0),(null==r?void 0:r.mask)||l.setFloat4.apply(l,_l([Zd],dl,!1)),s.render(i)}},gl=c.a.createContext({canvasContextIsValid:!1});function vl(e){var t=Object(s.useState)(void 0),n=t[0],a=t[1],i=Object(s.useContext)(gl).effectWrapperManager,r=Object(s.useRef)(!0);return r.current=!0,Object(s.useLayoutEffect)(function(){return function(){r.current=!1}},[]),Object(s.useLayoutEffect)(function(){i&&i.getEffectWrapper(e).then(function(e){r.current&&a(e)},function(e){throw new Error(e)})},[e,i]),n}var yl=0;function Sl(){return yl++}var Dl=function(){function e(){this._needsRender=!1,this._isRendering=!1,this._renderers=new Map}return e.prototype.register=function(e,t,n){this._renderers.set(e,{func:t,zIndex:n}),this._needsRender=!0},e.prototype.unregister=function(e){this._renderers.delete(e),this._needsRender=!0},e.prototype.requestRender=function(){this._needsRender=!0},e.prototype.startRendering=function(){this._isRendering||(this._isRendering=!0,this._renderNextFrame())},e.prototype.stopRendering=function(){this._isRendering=!1},e.prototype.renderNow=function(){this._render()},e.prototype._render=function(){var e=[];this._renderers.forEach(function(t){e.push(t)}),e.sort(function(e,t){return e.zIndex-t.zIndex}),e.forEach(function(e){return e.func()})},e.prototype._renderNextFrame=function(){var e=this;this._isRendering&&(this._needsRender&&(this._render(),this._needsRender=!1),window.requestAnimationFrame(function(){e._renderNextFrame()}))},e}(),Il=Object(s.createContext)({renderList:new Dl}),xl=c.a.memo(function(e){var t=Object(s.useMemo)(function(){return{renderList:new Dl}},[]);return Object(s.useEffect)(function(){return t.renderList.startRendering(),function(){t.renderList.stopRendering()}},[t]),c.a.createElement(Il.Provider,{value:t},e.children)}),Cl=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};function Ol(e,t){var n=Object(s.useContext)(Il).renderList;Object(s.useLayoutEffect)(function(){if(n){var a=Sl();return n.register(a,e,t),function(){n.unregister(a)}}},[n,e,t]),Object(s.useLayoutEffect)(function(){n&&n.requestRender()},[n])}function wl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object(s.useContext)(Il).renderList;Object(s.useLayoutEffect)(function(){n&&n.requestRender()},Cl([n],e,!0))}function El(e){void 0===e&&(e=[0,0,0,0,0,0]);var t=Object(s.useContext)(Il).renderList,n=e[0],a=e[1],i=e[2],r=e[3],o=e[4],c=e[5];Object(s.useLayoutEffect)(function(){t&&t.requestRender()},[t,n,a,i,r,o,c])}function Al(e){var t=Object(s.useContext)(Il).renderList;Object(s.useLayoutEffect)(function(){t&&t.requestRender()},[t,e.x,e.y])}var Ll=function(e){var t=e.zIndex,n=e.color,a=e.transform,i=Object(s.useContext)(gl),r=i.engine,o=i.effectRenderer,c=Object(s.useContext)(Ld),d=c.registry,l=c.textures;if(!d)throw new Error("effect registry not found on ImageEffectContext.Provider");var u=function(e,t,n,a,i,r,o){var c=Object(s.useRef)(e);return c.current=e,Object(s.useCallback)(function(){hl(c.current,t,n,a,i,r,o)},[t,n,a,i,r,o])}(a,d,n,vl(rl(d)),l,r,o);return Ol(u,t),El(a),null},kl=function(){return kl=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},kl.apply(this,arguments)},Ml=c.a.memo(function(e){var t=ol();return c.a.createElement(Ld.Provider,{value:{registry:t,shouldUseFakeMipMaps:!1}},e.children,c.a.createElement(Ll,kl({},e)))}),Pl=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},Tl=function(){function e(){this._visible=!1,this._shadowSize=3,this._cropTransform=[1,0,0,0,1,0],this._handleTransform=[1,0,0,0,1,0]}return e.prototype.setVisible=function(e){this._visible=e},e.prototype.setShadowSize=function(e){this._shadowSize=e},e.prototype.setCropTransform=function(e){this._cropTransform=e},e.prototype.setHandleTransform=function(e){this._handleTransform=e},e.prototype.getName=function(){return"CropHandleShapeShader"},e.prototype.getUniformNames=function(e){return[e("uVisible@"),e("uShadowSize@"),e("uCropTransformInverse@"),e("uHandleTransformInverse@")]},e.prototype.getFunctions=function(){return["\nfloat inTransform(mat3 posToUv, vec2 pixelPos){\n  vec3 uv = vec3(pixelPos, 1.) * posToUv;\n  if(uv.x < 0. || uv.x > 1. || uv.y < 0. || uv.y > 1.) {\n    return 0.;\n  }\n  return 1.;\n}\n","\nfloat handleShape(in vec2 pixelPos, mat3 handleTransform, mat3 cropTransform) {\n  float inCrop = inTransform(cropTransform, pixelPos);\n  float inHandleRect = inTransform(handleTransform, pixelPos);\n  return clamp(inHandleRect - inCrop, 0., 1.);\n}\n","\nfloat shadowLevel(vec2 shadowPos, mat3 handleTransform, mat3 cropTransform) {\n  #define shadowSamples 15\n  float angle = 0.;\n  float total = 0.;\n  float fSamples = float(shadowSamples);\n\n  for(int i = 0; i < shadowSamples; i++) {\n    float normalizedRadius = sqrt(float(i + 1) / fSamples);\n    float r = 5. * normalizedRadius;\n    vec2 sampleDir = vec2(cos(angle), sin(angle));\n    total += handleShape(shadowPos + sampleDir * r, handleTransform, cropTransform);\n    angle += 2.39996;\n  }\n\n  return total / fSamples;\n}\n","\nvec4 cropHandle(in vec4 handleColor, in vec2 pixelPos, mat3 handleTransform, mat3 cropTransform, float shadowSize) {\n  vec4 fragColor = vec4(0.);\n  vec2 shadowOffset = vec2(0., 3.);\n  vec4 shadowColor = vec4(vec3(0.), 0.33);\n\n  float inHandle = handleShape(pixelPos, handleTransform, cropTransform);\n  if(inHandle >= 1. ) { //if we are in the shape, no need to calculate the shadow.\n      return mix(fragColor, handleColor, handleColor.a);\n  } else {\n    vec2 shadowPos = pixelPos - shadowOffset;\n    float shadowBlend = shadowLevel(shadowPos, handleTransform, cropTransform);\n    return mix(fragColor, shadowColor, shadowBlend);\n  }\n}\n"]},e.prototype.getHeaderCode=function(e){return e("//CropHandleShapeShader effect---\n        uniform float uVisible@;\n        uniform float uShadowSize@;\n        uniform mat3 uCropTransformInverse@;\n        uniform mat3 uHandleTransformInverse@;\n    ")},e.prototype.getShaderFunctionBody=function(e){return e("//CropHandleShapeShader effect---\n        gl_FragColor = cropHandle(gl_FragColor,".concat(Nd,".xy,uHandleTransformInverse@,uCropTransformInverse@,uShadowSize@);\n        gl_FragColor.a = gl_FragColor.a * uVisible@;\n        "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uVisible@"),this._visible?1:0),e.setFloat(t("uShadowSize@"),this._shadowSize),e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(Pl(Pl([],ei(this._cropTransform),!0),[0,0,1],!1))),e.setMatrix3x3(t("uHandleTransformInverse@"),new Float32Array(Pl(Pl([],ei(this._handleTransform),!0),[0,0,1],!1)))},e}();function Ul(e){var t=Object(s.useContext)(Ld).registry;if(!t)throw new Error("effectRegistry missing in useRegisterShaderEffect");var n=Object(s.useRef)();n.current!==e&&(n.current&&t.unRegisterEffect(n.current),t.registerEffect(e),n.current=e),Object(s.useLayoutEffect)(function(){return function(){t.unRegisterEffect(e)}},[e,t])}var Fl=function(e){var t=e.visible,n=e.shadowSize,a=e.cropTransform,i=e.handleTransform,r=Object(s.useMemo)(function(){return new Tl},[]);return r.setVisible(t),r.setShadowSize(n),r.setCropTransform(a),r.setHandleTransform(i),wl(t),Ul(r),null},Hl=function(e){if(e){var t=ma(e);return t&&[t.r/255,t.g/255,t.b/255,t.a||1]}};function Rl(e){return Object(s.useMemo)(function(){var t=Hl(e),n=dl;return t&&(n=[t[0],t[1],t[2],1]),n},[e])}var Nl=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.toString=function(){return"{W: ".concat(this.width,", H: ").concat(this.height,"}")},e.prototype.getClassName=function(){return"Size"},e.prototype.getHashCode=function(){return 397*(0|this.width)^(0|this.height)},e.prototype.copyFrom=function(e){this.width=e.width,this.height=e.height},e.prototype.copyFromFloats=function(e,t){return this.width=e,this.height=t,this},e.prototype.set=function(e,t){return this.copyFromFloats(e,t)},e.prototype.multiplyByFloats=function(t,n){return new e(this.width*t,this.height*n)},e.prototype.clone=function(){return new e(this.width,this.height)},e.prototype.equals=function(e){return!!e&&this.width===e.width&&this.height===e.height},Object.defineProperty(e.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),e.Zero=function(){return new e(0,0)},e.prototype.add=function(t){return new e(this.width+t.width,this.height+t.height)},e.prototype.subtract=function(t){return new e(this.width-t.width,this.height-t.height)},e.Lerp=function(t,n,a){return new e(t.width+(n.width-t.width)*a,t.height+(n.height-t.height)*a)},e}(),Bl=function(){function e(e){this._wrapU=1,this._wrapV=1,this.wrapR=1,this.anisotropicFilteringLevel=4,this.delayLoadState=0,this._texture=null,this._engine=null,this._cachedSize=Nl.Zero(),this._cachedBaseSize=Nl.Zero(),this._initialSamplingMode=2,this._texture=e,this._texture&&(this._engine=this._texture.getEngine())}return Object.defineProperty(e.prototype,"wrapU",{get:function(){return this._wrapU},set:function(e){this._wrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapV",{get:function(){return this._wrapV},set:function(e){this._wrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinatesMode",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCube",{get:function(){return!!this._texture&&this._texture.isCube},set:function(e){this._texture&&(this._texture.isCube=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"is3D",{get:function(){return!!this._texture&&this._texture.is3D},set:function(e){this._texture&&(this._texture.is3D=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"is2DArray",{get:function(){return!!this._texture&&this._texture.is2DArray},set:function(e){this._texture&&(this._texture.is2DArray=e)},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"ThinTexture"},e.prototype.isReady=function(){return 4===this.delayLoadState?(this.delayLoad(),!1):!!this._texture&&this._texture.isReady},e.prototype.delayLoad=function(){},e.prototype.getInternalTexture=function(){return this._texture},e.prototype.getSize=function(){if(this._texture){if(this._texture.width)return this._cachedSize.width=this._texture.width,this._cachedSize.height=this._texture.height,this._cachedSize;if(this._texture._size)return this._cachedSize.width=this._texture._size,this._cachedSize.height=this._texture._size,this._cachedSize}return this._cachedSize},e.prototype.getBaseSize=function(){return this.isReady()&&this._texture?this._texture._size?(this._cachedBaseSize.width=this._texture._size,this._cachedBaseSize.height=this._texture._size,this._cachedBaseSize):(this._cachedBaseSize.width=this._texture.baseWidth,this._cachedBaseSize.height=this._texture.baseHeight,this._cachedBaseSize):(this._cachedBaseSize.width=0,this._cachedBaseSize.height=0,this._cachedBaseSize)},Object.defineProperty(e.prototype,"samplingMode",{get:function(){return this._texture?this._texture.samplingMode:this._initialSamplingMode},enumerable:!1,configurable:!0}),e.prototype.updateSamplingMode=function(e){this._texture&&this._engine&&this._engine.updateTextureSamplingMode(e,this._texture)},e.prototype.releaseInternalTexture=function(){this._texture&&(this._texture.dispose(),this._texture=null)},e.prototype.dispose=function(){this._texture&&(this.releaseInternalTexture(),this._engine=null)},e}(),jl=function(e,t){return jl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},jl(e,t)},Vl=function(){return Vl=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vl.apply(this,arguments)},zl=function(){function e(){}return e.ALPHA_COMBINE=2,e.TEXTURE_CLAMP_ADDRESSMODE=0,e.TEXTURE_DEFAULT_ANISOTROPIC_FILTERING_LEVEL=4,e.TEXTUREFORMAT_RGB=4,e.TEXTUREFORMAT_RGBA=5,e.TEXTURETYPE_UNSIGNED_BYTE=0,e.TEXTURE_TRILINEAR_SAMPLINGMODE=3,e.MATERIAL_LineListDrawMode=4,e.MATERIAL_LineLoopDrawMode=5,e}(),Gl=function(e){function t(n,a){var i=e.call(this,null)||this;return a=Vl(Vl({},t.DefaultOptions),a),i._generateMipMaps=a.generateMipMaps,i._samplingMode=a.samplingMode,i._engine=a.engine,i.element=n,i.anisotropicFilteringLevel=1,i._createInternalTexture(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}jl(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype._createInternalTexture=function(){var e,t;e=this.element.width,t=this.element.height;var n=this._engine;n&&(this._texture=n.createDynamicTexture(e,t,this._generateMipMaps,this._samplingMode)),this.update()},t.prototype.update=function(){var e=this._engine;if(null!=this._texture&&null!=e){var t=this.element;e.updateDynamicTexture(this._texture,t,!0,!1)}},t.DefaultOptions={generateMipMaps:!1,samplingMode:zl.TEXTURE_TRILINEAR_SAMPLINGMODE,engine:null},t}(Bl),Kl=function(){function e(){this.references=0,this.capacity=0,this.is32Bits=!1,this.uniqueId=e._Counter++}return Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0}),e._Counter=0,e}(),Wl=function(){function e(){}return e.Slice=function(e,t,n){return e.slice?e.slice(t,n):Array.prototype.slice.call(e,t,n)},e.SliceToArray=function(e,t,n){return Array.isArray(e)?e.slice(t,n):Array.prototype.slice.call(e,t,n)},e}(),ql=function(){function e(e,t,n,a,i,r,o,s){void 0===a&&(a=0),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),this._isAlreadyOwned=!1,e.getScene?this._engine=e.getScene().getEngine():this._engine=e,this._updatable=n,this._instanced=r,this._divisor=s||1,t instanceof Kl?(this._data=null,this._buffer=t):(this._data=t,this._buffer=null),this.byteStride=o?a:a*Float32Array.BYTES_PER_ELEMENT,i||this.create()}return e.prototype.createVertexBuffer=function(e,t,n,a,i,r,o){void 0===r&&(r=!1);var s=r?t:t*Float32Array.BYTES_PER_ELEMENT,c=a?r?a:a*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new Ql(this._engine,this,e,this._updatable,!0,c,void 0===i?this._instanced:i,s,n,void 0,void 0,!0,this._divisor||o)},e.prototype.isUpdatable=function(){return this._updatable},e.prototype.getData=function(){return this._data},e.prototype.getBuffer=function(){return this._buffer},e.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},e.prototype.create=function(e){void 0===e&&(e=null),!e&&this._buffer||(e=e||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e),this._data=e):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(e),this._data=e):this._buffer=this._engine.createVertexBuffer(e))},e.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},e.prototype.update=function(e){this.create(e)},e.prototype.updateDirectly=function(e,t,n,a){void 0===a&&(a=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,e,a?t:t*Float32Array.BYTES_PER_ELEMENT,n?n*this.byteStride:void 0),this._data=0===t&&void 0===n?e:null)},e.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},e.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null,this._data=null)},e}(),Ql=function(){function e(t,n,a,i,r,o,s,c,d,l,u,f,p,m){if(void 0===u&&(u=!1),void 0===f&&(f=!1),void 0===p&&(p=1),void 0===m&&(m=!1),n instanceof ql?(this._buffer=n,this._ownsBuffer=m):(this._buffer=new ql(t,n,i,o,r,s,f),this._ownsBuffer=!0),this.uniqueId=e._Counter++,this._kind=a,null==l){var _=this.getData();this.type=e.FLOAT,_ instanceof Int8Array?this.type=e.BYTE:_ instanceof Uint8Array?this.type=e.UNSIGNED_BYTE:_ instanceof Int16Array?this.type=e.SHORT:_ instanceof Uint16Array?this.type=e.UNSIGNED_SHORT:_ instanceof Int32Array?this.type=e.INT:_ instanceof Uint32Array&&(this.type=e.UNSIGNED_INT)}else this.type=l;var h=e.GetTypeByteLength(this.type);f?(this._size=d||(o?o/h:e.DeduceStride(a)),this.byteStride=o||this._buffer.byteStride||this._size*h,this.byteOffset=c||0):(this._size=d||o||e.DeduceStride(a),this.byteStride=o?o*h:this._buffer.byteStride||this._size*h,this.byteOffset=(c||0)*h),this.normalized=u,this._instanced=void 0!==s&&s,this._instanceDivisor=s?p:0,this._computeHashCode()}return Object.defineProperty(e.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(e){this._instanceDivisor=e,this._instanced=0!=e,this._computeHashCode()},enumerable:!1,configurable:!0}),e.prototype._computeHashCode=function(){this.hashCode=(this.type-5120<<0)+((this.normalized?1:0)<<3)+(this._size<<4)+((this._instanced?1:0)<<6)+(this.byteStride<<12)},e.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},e.prototype.getKind=function(){return this._kind},e.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},e.prototype.getData=function(){return this._buffer.getData()},e.prototype.getFloatData=function(t,n){var a=this.getData();if(!a)return null;var i=this.getSize()*e.GetTypeByteLength(this.type),r=t*this.getSize();if(this.type!==e.FLOAT||this.byteStride!==i){var o=new Float32Array(r);return this.forEach(r,function(e,t){return o[t]=e}),o}if(!(a instanceof Array||a instanceof Float32Array)||0!==this.byteOffset||a.length!==r){if(a instanceof Array){var s=this.byteOffset/4;return Wl.Slice(a,s,s+r)}if(a instanceof ArrayBuffer)return new Float32Array(a,this.byteOffset,r);if(s=a.byteOffset+this.byteOffset,n){var c=new Float32Array(r),d=new Float32Array(a.buffer,s,r);return c.set(d),c}var l=s%4;return l&&(s=Math.max(0,s-l)),new Float32Array(a.buffer,s,r)}return n?Wl.Slice(a):a},e.prototype.getBuffer=function(){return this._buffer.getBuffer()},e.prototype.getStrideSize=function(){return this.byteStride/e.GetTypeByteLength(this.type)},e.prototype.getOffset=function(){return this.byteOffset/e.GetTypeByteLength(this.type)},e.prototype.getSize=function(t){return void 0===t&&(t=!1),t?this._size*e.GetTypeByteLength(this.type):this._size},e.prototype.getIsInstanced=function(){return this._instanced},e.prototype.getInstanceDivisor=function(){return this._instanceDivisor},e.prototype.create=function(e){this._buffer.create(e)},e.prototype.update=function(e){this._buffer.update(e)},e.prototype.updateDirectly=function(e,t,n){void 0===n&&(n=!1),this._buffer.updateDirectly(e,t,void 0,n)},e.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},e.prototype.forEach=function(t,n){e.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,t,this.normalized,n)},e.DeduceStride=function(t){switch(t){case e.UVKind:case e.UV2Kind:case e.UV3Kind:case e.UV4Kind:case e.UV5Kind:case e.UV6Kind:return 2;case e.NormalKind:case e.PositionKind:return 3;case e.ColorKind:case e.MatricesIndicesKind:case e.MatricesIndicesExtraKind:case e.MatricesWeightsKind:case e.MatricesWeightsExtraKind:case e.TangentKind:return 4;default:throw new Error("Invalid kind '"+t+"'")}},e.GetTypeByteLength=function(t){switch(t){case e.BYTE:case e.UNSIGNED_BYTE:return 1;case e.SHORT:case e.UNSIGNED_SHORT:return 2;case e.INT:case e.UNSIGNED_INT:case e.FLOAT:return 4;default:throw new Error("Invalid type '".concat(t,"'"))}},e.ForEach=function(t,n,a,i,r,o,s,c){if(t instanceof Array)for(var d=n/4,l=a/4,u=0;u<o;u+=i){for(var f=0;f<i;f++)c(t[d+f],u+f);d+=l}else{var p=t instanceof ArrayBuffer?new DataView(t):new DataView(t.buffer,t.byteOffset,t.byteLength),m=e.GetTypeByteLength(r);for(u=0;u<o;u+=i){var _=n;for(f=0;f<i;f++)c(e._GetFloatValue(p,r,_,s),u+f),_+=m;n+=a}}},e._GetFloatValue=function(t,n,a,i){switch(n){case e.BYTE:var r=t.getInt8(a);return i&&(r=Math.max(r/127,-1)),r;case e.UNSIGNED_BYTE:return r=t.getUint8(a),i&&(r/=255),r;case e.SHORT:return r=t.getInt16(a,!0),i&&(r=Math.max(r/32767,-1)),r;case e.UNSIGNED_SHORT:return r=t.getUint16(a,!0),i&&(r/=65535),r;case e.INT:return t.getInt32(a,!0);case e.UNSIGNED_INT:return t.getUint32(a,!0);case e.FLOAT:return t.getFloat32(a,!0);default:throw new Error("Invalid component type ".concat(n))}},e._Counter=0,e.BYTE=5120,e.UNSIGNED_BYTE=5121,e.SHORT=5122,e.UNSIGNED_SHORT=5123,e.INT=5124,e.UNSIGNED_INT=5125,e.FLOAT=5126,e.PositionKind="position",e.NormalKind="normal",e.TangentKind="tangent",e.UVKind="uv",e.UV2Kind="uv2",e.UV3Kind="uv3",e.UV4Kind="uv4",e.UV5Kind="uv5",e.UV6Kind="uv6",e.ColorKind="color",e.ColorInstanceKind="instanceColor",e.MatricesIndicesKind="matricesIndices",e.MatricesWeightsKind="matricesWeights",e.MatricesIndicesExtraKind="matricesIndicesExtra",e.MatricesWeightsExtraKind="matricesWeightsExtra",e}(),Yl=function(){function e(e,t,n,a){this.x=e,this.y=t,this.width=n,this.height=a}return e.prototype.toGlobal=function(t,n){return new e(this.x*t,this.y*n,this.width*t,this.height*n)},e.prototype.toGlobalToRef=function(e,t,n){return n.x=this.x*e,n.y=this.y*t,n.width=this.width*e,n.height=this.height*t,this},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}(),Jl=function(){function e(e,t,n,a){void 0===t&&(t=!1),this.initialize(e,t,n,a)}return e.prototype.initialize=function(e,t,n,a){return void 0===t&&(t=!1),this.mask=e,this.skipNextObservers=t,this.target=n,this.currentTarget=a,this},e}(),Xl=function(e,t,n){void 0===n&&(n=null),this.callback=e,this.mask=t,this.scope=n,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1},Zl=(function(){function e(){}e.prototype.dispose=function(){if(this._observers&&this._observables)for(var e=0;e<this._observers.length;e++)this._observables[e].remove(this._observers[e]);this._observers=null,this._observables=null},e.Watch=function(t,n,a,i){void 0===a&&(a=-1),void 0===i&&(i=null);var r=new e;r._observers=new Array,r._observables=t;for(var o=0,s=t;o<s.length;o++){var c=s[o].add(n,a,!1,i);c&&r._observers.push(c)}return r}}(),function(){function e(e){this._observers=new Array,this._eventState=new Jl(0),e&&(this._onObserverAdded=e)}return e.FromPromise=function(t,n){var a=new e;return t.then(function(e){a.notifyObservers(e)}).catch(function(e){if(!n)throw e;n.notifyObservers(e)}),a},Object.defineProperty(e.prototype,"observers",{get:function(){return this._observers},enumerable:!1,configurable:!0}),e.prototype.add=function(e,t,n,a,i){if(void 0===t&&(t=-1),void 0===n&&(n=!1),void 0===a&&(a=null),void 0===i&&(i=!1),!e)return null;var r=new Xl(e,t,a);return r.unregisterOnNextCall=i,n?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r},e.prototype.addOnce=function(e){return this.add(e,void 0,void 0,void 0,!0)},e.prototype.remove=function(e){return!!e&&-1!==this._observers.indexOf(e)&&(this._deferUnregister(e),!0)},e.prototype.removeCallback=function(e,t){for(var n=0;n<this._observers.length;n++){var a=this._observers[n];if(!(a._willBeUnregistered||a.callback!==e||t&&t!==a.scope))return this._deferUnregister(a),!0}return!1},e.prototype._deferUnregister=function(e){var t=this;e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(function(){t._remove(e)},0)},e.prototype._remove=function(e){if(!e)return!1;var t=this._observers.indexOf(e);return-1!==t&&(this._observers.splice(t,1),!0)},e.prototype.makeObserverTopPriority=function(e){this._remove(e),this._observers.unshift(e)},e.prototype.makeObserverBottomPriority=function(e){this._remove(e),this._observers.push(e)},e.prototype.notifyObservers=function(e,t,n,a,i){if(void 0===t&&(t=-1),!this._observers.length)return!0;var r=this._eventState;r.mask=t,r.target=n,r.currentTarget=a,r.skipNextObservers=!1,r.lastReturnValue=e,r.userInfo=i;for(var o=0,s=this._observers;o<s.length;o++){var c=s[o];if(!c._willBeUnregistered&&(c.mask&t&&(c.scope?r.lastReturnValue=c.callback.apply(c.scope,[e,r]):r.lastReturnValue=c.callback(e,r),c.unregisterOnNextCall&&this._deferUnregister(c)),r.skipNextObservers))return!1}return!0},e.prototype.notifyObserversWithPromise=function(e,t,n,a,i){var r=this;void 0===t&&(t=-1);var o=Promise.resolve(e);if(!this._observers.length)return o;var s=this._eventState;return s.mask=t,s.target=n,s.currentTarget=a,s.skipNextObservers=!1,s.userInfo=i,this._observers.forEach(function(n){s.skipNextObservers||n._willBeUnregistered||n.mask&t&&(o=n.scope?o.then(function(t){return s.lastReturnValue=t,n.callback.apply(n.scope,[e,s])}):o.then(function(t){return s.lastReturnValue=t,n.callback(e,s)}),n.unregisterOnNextCall&&r._deferUnregister(n))}),o.then(function(){return e})},e.prototype.notifyObserver=function(e,t,n){if(void 0===n&&(n=-1),!e._willBeUnregistered){var a=this._eventState;a.mask=n,a.skipNextObservers=!1,e.callback(t,a),e.unregisterOnNextCall&&this._deferUnregister(e)}},e.prototype.hasObservers=function(){return this._observers.length>0},e.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},e.prototype.clone=function(){var t=new e;return t._observers=this._observers.slice(0),t},e.prototype.hasSpecificMask=function(e){void 0===e&&(e=-1);for(var t=0,n=this._observers;t<n.length;t++){var a=n[t];if(a.mask&e||a.mask===e)return!0}return!1},e}());function $l(){return"undefined"!=typeof window}function eu(){return"undefined"!=typeof navigator}function tu(){return"undefined"!=typeof document}function nu(e){for(var t="",n=e.firstChild;n;)3===n.nodeType&&(t+=n.textContent),n=n.nextSibling;return t}var au,iu,ru={IsWindowObjectExist:$l,IsNavigatorAvailable:eu,IsDocumentAvailable:tu,GetDOMTextContent:nu},ou=function(){function e(){}return e._CheckLimit=function(t,n){var a=e._LogLimitOutputs[t];return a?a.current++:(a={limit:n,current:1},e._LogLimitOutputs[t]=a),a.current<=a.limit},e._GenerateLimitMessage=function(t,n){var a=e._LogLimitOutputs[t];if(a&&e.MessageLimitReached&&a.current===a.limit)switch(n){case 0:e.Log(e.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,"log"));break;case 1:e.Warn(e.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,"warning"));break;case 2:e.Error(e.MessageLimitReached.replace(/%LIMIT%/g,""+a.limit).replace(/%TYPE%/g,"error"))}},e._AddLogEntry=function(t){e._LogCache=t+e._LogCache,e.OnNewCacheEntry&&e.OnNewCacheEntry(t)},e._FormatMessage=function(e){var t=function(e){return e<10?"0"+e:""+e},n=new Date;return"["+t(n.getHours())+":"+t(n.getMinutes())+":"+t(n.getSeconds())+"]: "+e},e._LogDisabled=function(e,t){},e._LogEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var a=e._FormatMessage(t);console.log("BJS - "+a);var i="<div style='color:white'>"+a+"</div><br>";e._AddLogEntry(i),e._GenerateLimitMessage(t,0)}},e._WarnDisabled=function(e,t){},e._WarnEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var a=e._FormatMessage(t);console.warn("BJS - "+a);var i="<div style='color:orange'>"+t+"</div><br>";e._AddLogEntry(i),e._GenerateLimitMessage(t,1)}},e._ErrorDisabled=function(e,t){},e._ErrorEnabled=function(t,n){if(void 0===n||e._CheckLimit(t,n)){var a=e._FormatMessage(t);e.errorsCount++,console.error("BJS - "+a);var i="<div style='color:red'>"+a+"</div><br>";e._AddLogEntry(i),e._GenerateLimitMessage(t,2)}},Object.defineProperty(e,"LogCache",{get:function(){return e._LogCache},enumerable:!1,configurable:!0}),e.ClearLogCache=function(){e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0},Object.defineProperty(e,"LogLevels",{set:function(t){(t&e.MessageLogLevel)===e.MessageLogLevel?e.Log=e._LogEnabled:e.Log=e._LogDisabled,(t&e.WarningLogLevel)===e.WarningLogLevel?e.Warn=e._WarnEnabled:e.Warn=e._WarnDisabled,(t&e.ErrorLogLevel)===e.ErrorLogLevel?e.Error=e._ErrorEnabled:e.Error=e._ErrorDisabled},enumerable:!1,configurable:!0}),e.NoneLogLevel=0,e.MessageLogLevel=1,e.WarningLogLevel=2,e.ErrorLogLevel=4,e.AllLogLevel=7,e.MessageLimitReached="Too many %TYPE%s (%LIMIT%), no more %TYPE%s will be reported for this message.",e._LogCache="",e._LogLimitOutputs={},e.errorsCount=0,e.Log=e._LogEnabled,e.Warn=e._WarnEnabled,e.Error=e._ErrorEnabled,e}(),su=function(e,t){return!!e&&0===e.indexOf(t)},cu=function(e){return atob(e)},du=function(){function e(){this.children=[]}return e.prototype.isValid=function(e){return!0},e.prototype.process=function(e,t){var n="";if(this.line){var a=this.line,i=t.processor;i&&(i.lineProcessor&&(a=i.lineProcessor(a,t.isFragment,t.processingContext)),i.attributeProcessor&&su(this.line,"attribute")?a=i.attributeProcessor(this.line,e,t.processingContext):i.varyingProcessor&&su(this.line,"varying")?a=i.varyingProcessor(this.line,t.isFragment,e,t.processingContext):i.uniformProcessor&&i.uniformRegexp&&i.uniformRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(a=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):i.uniformBufferProcessor&&i.uniformBufferRegexp&&i.uniformBufferRegexp.test(this.line)?t.lookForClosingBracketForUniformBuffer||(a=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0):i.textureProcessor&&i.textureRegexp&&i.textureRegexp.test(this.line)?a=i.textureProcessor(this.line,t.isFragment,e,t.processingContext):(i.uniformProcessor||i.uniformBufferProcessor)&&su(this.line,"uniform")&&!t.lookForClosingBracketForUniformBuffer&&(/uniform\s+(?:(?:highp)?|(?:lowp)?)\s*(\S+)\s+(\S+)\s*;/.test(this.line)?i.uniformProcessor&&(a=i.uniformProcessor(this.line,t.isFragment,e,t.processingContext)):i.uniformBufferProcessor&&(a=i.uniformBufferProcessor(this.line,t.isFragment,t.processingContext),t.lookForClosingBracketForUniformBuffer=!0)),t.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(t.lookForClosingBracketForUniformBuffer=!1,i.endOfUniformBufferProcessor&&(a=i.endOfUniformBufferProcessor(this.line,t.isFragment,t.processingContext)))),n+=a+"\r\n"}return this.children.forEach(function(a){n+=a.process(e,t)}),this.additionalDefineKey&&(e[this.additionalDefineKey]=this.additionalDefineValue||"true"),n},e}(),lu=function(){function e(){}return Object.defineProperty(e.prototype,"currentLine",{get:function(){return this._lines[this.lineIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canRead",{get:function(){return this.lineIndex<this._lines.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lines",{set:function(e){this._lines=[];for(var t=0,n=e;t<n.length;t++){var a=n[t];if("#"!==a[0])for(var i=a.split(";"),r=0;r<i.length;r++){var o=i[r];(o=o.trim())&&this._lines.push(o+(r!==i.length-1?";":""))}else this._lines.push(a)}},enumerable:!1,configurable:!0}),e}(),uu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.process=function(e,t){for(var n=0;n<this.children.length;n++){var a=this.children[n];if(a.isValid(e))return a.process(e,t)}return""},t}(du),fu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.isValid=function(e){return this.testExpression.isTrue(e)},t}(du),pu=function(){function e(){}return e.prototype.isTrue=function(e){return!0},e.postfixToInfix=function(t){for(var n=[],a=0,i=t;a<i.length;a++){var r=i[a];if(void 0===e._OperatorPriority[r])n.push(r);else{var o=n[n.length-1],s=n[n.length-2];n.length-=2,n.push("(".concat(s).concat(r).concat(o,")"))}}return n[n.length-1]},e.infixToPostfix=function(t){for(var n=[],a=-1,i=function(){""!==(d=d.trim())&&(n.push(d),d="")},r=function(t){a<e._Stack.length-1&&(e._Stack[++a]=t)},o=function(){return e._Stack[a]},s=function(){return-1===a?"!!INVALID EXPRESSION!!":e._Stack[a--]},c=0,d="";c<t.length;){var l=t.charAt(c),u=c<t.length-1?t.substr(c,2):"";if("("===l)d="",r(l);else if(")"===l){for(i();-1!==a&&"("!==o();)n.push(s());s()}else if(e._OperatorPriority[u]>1){for(i();-1!==a&&e._OperatorPriority[o()]>=e._OperatorPriority[u];)n.push(s());r(u),c++}else d+=l;c++}for(i();-1!==a;)"("===o()?s():n.push(s());return n},e._OperatorPriority={")":0,"(":1,"||":2,"&&":3},e._Stack=["","","","","","","","","","","","","","","","","","","",""],e}(),mu=function(e){function t(t,n){void 0===n&&(n=!1);var a=e.call(this)||this;return a.define=t,a.not=n,a}return Object(o.__extends)(t,e),t.prototype.isTrue=function(e){var t=void 0!==e[this.define];return this.not&&(t=!t),t},t}(pu),_u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)||this.rightOperand.isTrue(e)},t}(pu),hu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.isTrue=function(e){return this.leftOperand.isTrue(e)&&this.rightOperand.isTrue(e)},t}(pu),bu=function(e){function t(t,n,a){var i=e.call(this)||this;return i.define=t,i.operand=n,i.testValue=a,i}return Object(o.__extends)(t,e),t.prototype.isTrue=function(e){var t=e[this.define];void 0===t&&(t=this.define);var n=!1,a=parseInt(t),i=parseInt(this.testValue);switch(this.operand){case">":n=a>i;break;case"<":n=a<i;break;case"<=":n=a<=i;break;case">=":n=a>=i;break;case"==":n=a===i}return n},t}(pu);function gu(e){return"".concat(e," needs to be imported before as it contains a side-effect required by your code.")}(iu=au||(au={}))[iu.GLSL=0]="GLSL",iu[iu.WGSL=1]="WGSL";var vu=/defined\s*?\((.+?)\)/g,yu=/defined\s*?\[(.+?)\]/g,Su=function(){function e(){}return e.Initialize=function(e){e.processor&&e.processor.initializeShaders&&e.processor.initializeShaders(e.processingContext)},e.Process=function(e,t,n,a){var i,r=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var i=r._ProcessShaderConversion(e,t,a);n(i)})},e.PreProcess=function(e,t,n,a){var i,r=this;(null===(i=t.processor)||void 0===i?void 0:i.preProcessShaderCode)&&(e=t.processor.preProcessShaderCode(e,t.isFragment)),this._ProcessIncludes(e,t,function(e){t.processCodeAfterIncludes&&(e=t.processCodeAfterIncludes(t.isFragment?"fragment":"vertex",e));var i=r._ApplyPreProcessing(e,t,a);n(i)})},e.Finalize=function(e,t,n){return n.processor&&n.processor.finalizeShaders?n.processor.finalizeShaders(e,t,n.processingContext):{vertexCode:e,fragmentCode:t}},e._ProcessPrecision=function(e,t){var n;if(null===(n=t.processor)||void 0===n?void 0:n.noPrecision)return e;var a=t.shouldUseHighPrecisionShader;return-1===e.indexOf("precision highp float")?e=a?"precision highp float;\n"+e:"precision mediump float;\n"+e:a||(e=e.replace("precision highp float","precision mediump float")),e},e._ExtractOperation=function(e){var t=/defined\((.+)\)/.exec(e);if(t&&t.length)return new mu(t[1].trim(),"!"===e[0]);for(var n="",a=0,i=0,r=["==",">=","<=","<",">"];i<r.length&&(n=r[i],!((a=e.indexOf(n))>-1));i++);if(-1===a)return new mu(e);var o=e.substring(0,a).trim(),s=e.substring(a+n.length).trim();return new bu(o,n,s)},e._BuildSubExpression=function(e){e=e.replace(vu,"defined[$1]");for(var t=[],n=0,a=pu.infixToPostfix(e);n<a.length;n++){var i=a[n];if("||"!==i&&"&&"!==i)t.push(i);else if(t.length>=2){var r=t[t.length-1],o=t[t.length-2];t.length-=2;var s="&&"==i?new hu:new _u;"string"==typeof r&&(r=r.replace(yu,"defined($1)")),"string"==typeof o&&(o=o.replace(yu,"defined($1)")),s.leftOperand="string"==typeof o?this._ExtractOperation(o):o,s.rightOperand="string"==typeof r?this._ExtractOperation(r):r,t.push(s)}}var c=t[t.length-1];return"string"==typeof c&&(c=c.replace(yu,"defined($1)")),"string"==typeof c?this._ExtractOperation(c):c},e._BuildExpression=function(e,t){var n=new fu,a=e.substring(0,t),i=e.substring(t);return i=i.substring(0,(i.indexOf("//")+1||i.length+1)-1).trim(),n.testExpression="#ifdef"===a?new mu(i):"#ifndef"===a?new mu(i,!0):this._BuildSubExpression(i),n},e._MoveCursorWithinIf=function(e,t,n){for(var a=e.currentLine;this._MoveCursor(e,n);){var i=(a=e.currentLine).substring(0,5).toLowerCase();if("#else"===i){var r=new du;return t.children.push(r),void this._MoveCursor(e,r)}if("#elif"===i){var o=this._BuildExpression(a,5);t.children.push(o),n=o}}},e._MoveCursor=function(e,t){for(;e.canRead;){e.lineIndex++;var n=e.currentLine,a=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(n);if(a&&a.length)switch(a[0]){case"#ifdef":var i=new uu;t.children.push(i);var r=this._BuildExpression(n,6);i.children.push(r),this._MoveCursorWithinIf(e,i,r);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":i=new uu,t.children.push(i),r=this._BuildExpression(n,7),i.children.push(r),this._MoveCursorWithinIf(e,i,r);break;case"#if":i=new uu,r=this._BuildExpression(n,3),t.children.push(i),i.children.push(r),this._MoveCursorWithinIf(e,i,r)}else{var o=new du;if(o.line=n,t.children.push(o),"#"===n[0]&&"d"===n[1]){var s=n.replace(";","").split(" ");o.additionalDefineKey=s[1],3===s.length&&(o.additionalDefineValue=s[2])}}}return!1},e._EvaluatePreProcessors=function(e,t,n){var a=new du,i=new lu;return i.lineIndex=-1,i.lines=e.split("\n"),this._MoveCursor(i,a),a.process(t,n)},e._PreparePreProcessors=function(e,t){for(var n,a={},i=0,r=e.defines;i<r.length;i++){var o=r[i].replace("#define","").replace(";","").trim().split(" ");a[o[0]]=o.length>1?o[1]:""}return(null===(n=e.processor)||void 0===n?void 0:n.shaderLanguage)===au.GLSL&&(a.GL_ES="true"),a.__VERSION__=e.version,a[e.platformName]="true",t._getGlobalDefines(a),a},e._ProcessShaderConversion=function(e,t,n){var a=this._ProcessPrecision(e,t);if(!t.processor)return a;if(t.processor.shaderLanguage===au.GLSL&&-1!==a.indexOf("#version 3"))return a.replace("#version 300 es","");var i=t.defines,r=this._PreparePreProcessors(t,n);return t.processor.preProcessor&&(a=t.processor.preProcessor(a,i,t.isFragment,t.processingContext)),a=this._EvaluatePreProcessors(a,r,t),t.processor.postProcessor&&(a=t.processor.postProcessor(a,i,t.isFragment,t.processingContext,n)),n._features.needShaderCodeInlining&&(a=n.inlineShaderCode(a)),a},e._ApplyPreProcessing=function(e,t,n){var a,i,r=e,o=t.defines,s=this._PreparePreProcessors(t,n);return(null===(a=t.processor)||void 0===a?void 0:a.preProcessor)&&(r=t.processor.preProcessor(r,o,t.isFragment,t.processingContext)),r=this._EvaluatePreProcessors(r,s,t),(null===(i=t.processor)||void 0===i?void 0:i.postProcessor)&&(r=t.processor.postProcessor(r,o,t.isFragment,t.processingContext,n)),n._features.needShaderCodeInlining&&(r=n.inlineShaderCode(r)),r},e._ProcessIncludes=function(t,n,a){for(var i=this,r=/#include\s?<(.+)>(\((.*)\))*(\[(.*)\])*/g,o=r.exec(t),s=new String(t),c=!1,d=function(){var d=o[1];if(-1!==d.indexOf("__decl__")&&(d=d.replace(/__decl__/,""),n.supportsUniformBuffers&&(d=(d=d.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo")),d+="Declaration"),!n.includesShadersStore[d]){var l=n.shadersRepository+"ShadersInclude/"+d+".fx";return e._FileToolsLoadFile(l,function(e){n.includesShadersStore[d]=e,i._ProcessIncludes(s,n,a)}),{value:void 0}}var u=n.includesShadersStore[d];if(o[2])for(var f=o[3].split(","),p=0;p<f.length;p+=2){var m=new RegExp(f[p],"g"),_=f[p+1];u=u.replace(m,_)}if(o[4]){var h=o[5];if(-1!==h.indexOf("..")){var b=h.split(".."),g=parseInt(b[0]),v=parseInt(b[1]),y=u.slice(0);u="",isNaN(v)&&(v=n.indexParameters[b[1]]);for(var S=g;S<v;S++)n.supportsUniformBuffers||(y=y.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"})),u+=y.replace(/\{X\}/g,S.toString())+"\n"}else n.supportsUniformBuffers||(u=u.replace(/light\{X\}.(\w*)/g,function(e,t){return t+"{X}"})),u=u.replace(/\{X\}/g,h)}s=s.replace(o[0],u),c=c||u.indexOf("#include<")>=0||u.indexOf("#include <")>=0,o=r.exec(t)};null!=o;){var l=d();if("object"==typeof l)return l.value}c?this._ProcessIncludes(s.toString(),n,a):a(s)},e._FileToolsLoadFile=function(e,t,n,a,i,r){throw gu("FileTools")},e}(),Du=function(){function e(){}return e.GetShadersRepository=function(t){return void 0===t&&(t=au.GLSL),t===au.GLSL?e.ShadersRepository:e.ShadersRepositoryWGSL},e.GetShadersStore=function(t){return void 0===t&&(t=au.GLSL),t===au.GLSL?e.ShadersStore:e.ShadersStoreWGSL},e.GetIncludesShadersStore=function(t){return void 0===t&&(t=au.GLSL),t===au.GLSL?e.IncludesShadersStore:e.IncludesShadersStoreWGSL},e.ShadersRepository="src/Shaders/",e.ShadersStore={},e.IncludesShadersStore={},e.ShadersRepositoryWGSL="src/ShadersWGSL/",e.ShadersStoreWGSL={},e.IncludesShadersStoreWGSL={},e}(),Iu=function(){function e(t,n,a,i,r,o,s,c,d,l,u,f){void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===u&&(u=""),void 0===f&&(f=au.GLSL);var p,m,_,h=this;this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new Zl,this.onErrorObservable=new Zl,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._bonesComputationForcedToCPU=!1,this._uniformBuffersNames={},this._multiTarget=!1,this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._pipelineContext=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this.name=t,this._key=u;var b,g,v=void 0,y=null;if(n.attributes){var S=n;if(this._engine=a,this._attributesNames=S.attributes,this._uniformsNames=S.uniformsNames.concat(S.samplers),this._samplerList=S.samplers.slice(),this.defines=S.defines,this.onError=S.onError,this.onCompiled=S.onCompiled,this._fallbacks=S.fallbacks,this._indexParameters=S.indexParameters,this._transformFeedbackVaryings=S.transformFeedbackVaryings||null,this._multiTarget=!!S.multiTarget,this._shaderLanguage=null!==(p=S.shaderLanguage)&&void 0!==p?p:au.GLSL,S.uniformBuffersNames){this._uniformBuffersNamesList=S.uniformBuffersNames.slice();for(var D=0;D<S.uniformBuffersNames.length;D++)this._uniformBuffersNames[S.uniformBuffersNames[D]]=D}y=null!==(m=S.processFinalCode)&&void 0!==m?m:null,v=null!==(_=S.processCodeAfterIncludes)&&void 0!==_?_:void 0}else this._engine=r,this.defines=null==o?"":o,this._uniformsNames=a.concat(i),this._samplerList=i?i.slice():[],this._attributesNames=n,this._uniformBuffersNamesList=[],this._shaderLanguage=f,this.onError=d,this.onCompiled=c,this._indexParameters=l,this._fallbacks=s;this._attributeLocationByName={},this.uniqueId=e._UniqueIdSeed++;var I=$l()?this._engine.getHostDocument():null;t.vertexSource?b="source:"+t.vertexSource:t.vertexElement?(b=I?I.getElementById(t.vertexElement):null)||(b=t.vertexElement):b=t.vertex||t,t.fragmentSource?g="source:"+t.fragmentSource:t.fragmentElement?(g=I?I.getElementById(t.fragmentElement):null)||(g=t.fragmentElement):g=t.fragment||t,this._processingContext=this._engine._getShaderProcessingContext(this._shaderLanguage);var x={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._getShaderProcessor(this._shaderLanguage),supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:Du.GetShadersRepository(this._shaderLanguage),includesShadersStore:Du.GetIncludesShadersStore(this._shaderLanguage),version:(100*this._engine.version).toString(),platformName:this._engine.shaderPlatformName,processingContext:this._processingContext,isNDCHalfZRange:this._engine.isNDCHalfZRange,useReverseDepthBuffer:this._engine.useReverseDepthBuffer,processCodeAfterIncludes:v},C=[void 0,void 0],O=function(){if(C[0]&&C[1]){x.isFragment=!0;var e=C[0],n=C[1];Su.Process(n,x,function(n){y&&(n=y("fragment",n));var a=Su.Finalize(e,n,x);h._useFinalCode(a.vertexCode,a.fragmentCode,t)},h._engine)}};this._loadShader(b,"Vertex","",function(e){Su.Initialize(x),Su.Process(e,x,function(t){h._rawVertexSourceCode=e,y&&(t=y("vertex",t)),C[0]=t,O()},h._engine)}),this._loadShader(g,"Fragment","Pixel",function(e){h._rawFragmentSourceCode=e,C[1]=e,O()})}return Object.defineProperty(e,"ShadersRepository",{get:function(){return Du.ShadersRepository},set:function(e){Du.ShadersRepository=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new Zl),this._onBindObservable},enumerable:!1,configurable:!0}),e.prototype._useFinalCode=function(e,t,n){if(n){var a=n.vertexElement||n.vertex||n.spectorName||n,i=n.fragmentElement||n.fragment||n.spectorName||n;this._vertexSourceCode=(this._shaderLanguage===au.WGSL?"//":"")+"#define SHADER_NAME vertex:"+a+"\n"+e,this._fragmentSourceCode=(this._shaderLanguage===au.WGSL?"//":"")+"#define SHADER_NAME fragment:"+i+"\n"+t}else this._vertexSourceCode=e,this._fragmentSourceCode=t;this._prepareEffect()},Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),e.prototype.isReady=function(){try{return this._isReadyInternal()}catch(e){return!1}},e.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady},e.prototype.getEngine=function(){return this._engine},e.prototype.getPipelineContext=function(){return this._pipelineContext},e.prototype.getAttributesNames=function(){return this._attributesNames},e.prototype.getAttributeLocation=function(e){return this._attributes[e]},e.prototype.getAttributeLocationByName=function(e){return this._attributeLocationByName[e]},e.prototype.getAttributesCount=function(){return this._attributes.length},e.prototype.getUniformIndex=function(e){return this._uniformsNames.indexOf(e)},e.prototype.getUniform=function(e){return this._uniforms[e]},e.prototype.getSamplers=function(){return this._samplerList},e.prototype.getUniformNames=function(){return this._uniformsNames},e.prototype.getUniformBuffersNames=function(){return this._uniformBuffersNamesList},e.prototype.getIndexParameters=function(){return this._indexParameters},e.prototype.getCompilationError=function(){return this._compilationError},e.prototype.allFallbacksProcessed=function(){return this._allFallbacksProcessed},e.prototype.executeWhenCompiled=function(e){var t=this;this.isReady()?e(this):(this.onCompileObservable.add(function(t){e(t)}),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout(function(){t._checkIsReady(null)},16))},e.prototype._checkIsReady=function(e){var t=this;try{if(this._isReadyInternal())return}catch(t){return void this._processCompilationErrors(t,e)}setTimeout(function(){t._checkIsReady(e)},16)},e.prototype._loadShader=function(e,t,n,a){if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)a(nu(e));else if("source:"!==e.substr(0,7))if("base64:"!==e.substr(0,7)){var i,r=Du.GetShadersStore(this._shaderLanguage);r[e+t+"Shader"]?a(r[e+t+"Shader"]):n&&r[e+n+"Shader"]?a(r[e+n+"Shader"]):(i="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:Du.GetShadersRepository(this._shaderLanguage)+e,this._engine._loadFile(i+"."+t.toLowerCase()+".fx",a))}else a(window.atob(e.substr(7)));else a(e.substr(7))},Object.defineProperty(e.prototype,"vertexSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getVertexShaderCode())&&void 0!==t?t:this._vertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragmentSourceCode",{get:function(){var e,t;return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:null!==(t=null===(e=this._pipelineContext)||void 0===e?void 0:e._getFragmentShaderCode())&&void 0!==t?t:this._fragmentSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawVertexSourceCode",{get:function(){return this._rawVertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rawFragmentSourceCode",{get:function(){return this._rawFragmentSourceCode},enumerable:!1,configurable:!0}),e.prototype._rebuildProgram=function(e,t,n,a){var i=this;this._isReady=!1,this._vertexSourceCodeOverride=e,this._fragmentSourceCodeOverride=t,this.onError=function(e,t){a&&a(t)},this.onCompiled=function(){var e=i.getEngine().scenes;if(e)for(var t=0;t<e.length;t++)e[t].markAllMaterialsAsDirty(63);i._pipelineContext._handlesSpectorRebuildCallback(n)},this._fallbacks=null,this._prepareEffect()},e.prototype._prepareEffect=function(){var e=this,t=this._attributesNames,n=this.defines,a=this._pipelineContext;this._isReady=!1;try{var i=this._engine;this._pipelineContext=i.createPipelineContext(this._processingContext),this._pipelineContext._name=this._key;var r=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?i._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,this._rawVertexSourceCode,this._rawFragmentSourceCode,r,null,this._transformFeedbackVaryings,this._key):i._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,this._rawVertexSourceCode,this._rawFragmentSourceCode,r,n,this._transformFeedbackVaryings,this._key),i._executeWhenRenderingStateIsCompiled(this._pipelineContext,function(){if(e._attributes=[],e._pipelineContext._fillEffectInformation(e,e._uniformBuffersNames,e._uniformsNames,e._uniforms,e._samplerList,e._samplers,t,e._attributes),t)for(var n=0;n<t.length;n++){var r=t[n];e._attributeLocationByName[r]=e._attributes[n]}i.bindSamplers(e),e._compilationError="",e._isReady=!0,e.onCompiled&&e.onCompiled(e),e.onCompileObservable.notifyObservers(e),e.onCompileObservable.clear(),e._fallbacks&&e._fallbacks.unBindMesh(),a&&e.getEngine()._deletePipelineContext(a)}),this._pipelineContext.isAsync&&this._checkIsReady(a)}catch(e){this._processCompilationErrors(e,a)}},e.prototype._getShaderCodeAndErrorLine=function(e,t,n){var a=n?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,i=null;if(t&&e){var r=t.match(a);if(r&&2===r.length){var o=parseInt(r[1]),s=e.split("\n",-1);s.length>=o&&(i="Offending line [".concat(o,"] in ").concat(n?"fragment":"vertex"," code: ").concat(s[o-1]))}}return[e,i]},e.prototype._processCompilationErrors=function(t,n){var a,i,r,o,s;void 0===n&&(n=null),this._compilationError=t.message;var c=this._attributesNames,d=this._fallbacks;if(ou.Error("Unable to compile effect:"),ou.Error("Uniforms: "+this._uniformsNames.map(function(e){return" "+e})),ou.Error("Attributes: "+c.map(function(e){return" "+e})),ou.Error("Defines:\r\n"+this.defines),e.LogShaderCodeOnCompilationError){var l=null,u=null,f=null;(null===(r=this._pipelineContext)||void 0===r?void 0:r._getVertexShaderCode())&&(f=(a=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1))[0],l=a[1],f&&(ou.Error("Vertex code:"),ou.Error(f))),(null===(o=this._pipelineContext)||void 0===o?void 0:o._getFragmentShaderCode())&&(f=(i=this._getShaderCodeAndErrorLine(null===(s=this._pipelineContext)||void 0===s?void 0:s._getFragmentShaderCode(),this._compilationError,!0))[0],u=i[1],f&&(ou.Error("Fragment code:"),ou.Error(f))),l&&ou.Error(l),u&&ou.Error(u)}ou.Error("Error: "+this._compilationError),n&&(this._pipelineContext=n,this._isReady=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)),d?(this._pipelineContext=null,d.hasMoreFallbacks?(this._allFallbacksProcessed=!1,ou.Error("Trying next fallback."),this.defines=d.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):this._allFallbacksProcessed=!0},Object.defineProperty(e.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!1,configurable:!0}),e.prototype._bindTexture=function(e,t){this._engine._bindTexture(this._samplers[e],t,e)},e.prototype.setTexture=function(e,t){this._engine.setTexture(this._samplers[e],this._uniforms[e],t,e)},e.prototype.setDepthStencilTexture=function(e,t){this._engine.setDepthStencilTexture(this._samplers[e],this._uniforms[e],t,e)},e.prototype.setTextureArray=function(e,t){var n=e+"Ex";if(-1===this._samplerList.indexOf(n+"0")){for(var a=this._samplerList.indexOf(e),i=1;i<t.length;i++){var r=n+(i-1).toString();this._samplerList.splice(a+i,0,r)}for(var o=0,s=0,c=this._samplerList;s<c.length;s++){var d=c[s];this._samplers[d]=o,o+=1}}this._engine.setTextureArray(this._samplers[e],this._uniforms[e],t,e)},e.prototype.setTextureFromPostProcess=function(e,t){this._engine.setTextureFromPostProcess(this._samplers[e],t,e)},e.prototype.setTextureFromPostProcessOutput=function(e,t){this._engine.setTextureFromPostProcessOutput(this._samplers[e],t,e)},e.prototype.bindUniformBuffer=function(t,n){var a=this._uniformBuffersNames[n];void 0===a||e._BaseCache[a]===t&&this._engine._features.useUBOBindingCache||(e._BaseCache[a]=t,this._engine.bindUniformBufferBase(t,a,n))},e.prototype.bindUniformBlock=function(e,t){this._engine.bindUniformBlock(this._pipelineContext,e,t)},e.prototype.setInt=function(e,t){return this._pipelineContext.setInt(e,t),this},e.prototype.setInt2=function(e,t,n){return this._pipelineContext.setInt2(e,t,n),this},e.prototype.setInt3=function(e,t,n,a){return this._pipelineContext.setInt3(e,t,n,a),this},e.prototype.setInt4=function(e,t,n,a,i){return this._pipelineContext.setInt4(e,t,n,a,i),this},e.prototype.setIntArray=function(e,t){return this._pipelineContext.setIntArray(e,t),this},e.prototype.setIntArray2=function(e,t){return this._pipelineContext.setIntArray2(e,t),this},e.prototype.setIntArray3=function(e,t){return this._pipelineContext.setIntArray3(e,t),this},e.prototype.setIntArray4=function(e,t){return this._pipelineContext.setIntArray4(e,t),this},e.prototype.setFloatArray=function(e,t){return this._pipelineContext.setArray(e,t),this},e.prototype.setFloatArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},e.prototype.setFloatArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},e.prototype.setFloatArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},e.prototype.setArray=function(e,t){return this._pipelineContext.setArray(e,t),this},e.prototype.setArray2=function(e,t){return this._pipelineContext.setArray2(e,t),this},e.prototype.setArray3=function(e,t){return this._pipelineContext.setArray3(e,t),this},e.prototype.setArray4=function(e,t){return this._pipelineContext.setArray4(e,t),this},e.prototype.setMatrices=function(e,t){return this._pipelineContext.setMatrices(e,t),this},e.prototype.setMatrix=function(e,t){return this._pipelineContext.setMatrix(e,t),this},e.prototype.setMatrix3x3=function(e,t){return this._pipelineContext.setMatrix3x3(e,t),this},e.prototype.setMatrix2x2=function(e,t){return this._pipelineContext.setMatrix2x2(e,t),this},e.prototype.setFloat=function(e,t){return this._pipelineContext.setFloat(e,t),this},e.prototype.setBool=function(e,t){return this._pipelineContext.setInt(e,t?1:0),this},e.prototype.setVector2=function(e,t){return this._pipelineContext.setVector2(e,t),this},e.prototype.setFloat2=function(e,t,n){return this._pipelineContext.setFloat2(e,t,n),this},e.prototype.setVector3=function(e,t){return this._pipelineContext.setVector3(e,t),this},e.prototype.setFloat3=function(e,t,n,a){return this._pipelineContext.setFloat3(e,t,n,a),this},e.prototype.setVector4=function(e,t){return this._pipelineContext.setVector4(e,t),this},e.prototype.setFloat4=function(e,t,n,a,i){return this._pipelineContext.setFloat4(e,t,n,a,i),this},e.prototype.setColor3=function(e,t){return this._pipelineContext.setColor3(e,t),this},e.prototype.setColor4=function(e,t,n){return this._pipelineContext.setColor4(e,t,n),this},e.prototype.setDirectColor4=function(e,t){return this._pipelineContext.setDirectColor4(e,t),this},e.prototype.dispose=function(){this._pipelineContext&&this._pipelineContext.dispose(),this._engine._releaseEffect(this)},e.RegisterShader=function(e,t,n,a){void 0===a&&(a=au.GLSL),t&&(Du.GetShadersStore(a)["".concat(e,"PixelShader")]=t),n&&(Du.GetShadersStore(a)["".concat(e,"VertexShader")]=n)},e.ResetCache=function(){e._BaseCache={}},e.LogShaderCodeOnCompilationError=!0,e._UniqueIdSeed=0,e._BaseCache={},e.ShadersStore=Du.ShadersStore,e.IncludesShadersStore=Du.IncludesShadersStore,e}(),xu=function(){function e(e,t){void 0===t&&(t=!0),this.effect=null,this.defines=null,this.drawContext=e.createDrawContext(),t&&(this.materialContext=e.createMaterialContext())}return e.IsWrapper=function(e){return void 0===e.getPipelineContext},e.GetEffect=function(e){return void 0===e.getPipelineContext?e.effect:e},e.prototype.setEffect=function(e,t,n){var a;void 0===n&&(n=!0),this.effect=e,void 0!==t&&(this.defines=t),n&&(null===(a=this.drawContext)||void 0===a||a.reset())},e.prototype.dispose=function(){var e;null===(e=this.drawContext)||void 0===e||e.dispose()},e}();Du.ShadersStore.postprocessVertexShader="attribute vec2 position;\nuniform vec2 scale;\nvarying vec2 vUV;\nconst vec2 madd=vec2(0.5,0.5);\n#define CUSTOM_VERTEX_DEFINITIONS\nvoid main(void) {\n#define CUSTOM_VERTEX_MAIN_BEGIN\nvUV=(position*madd+madd)*scale;\ngl_Position=vec4(position,0.0,1.0);\n#define CUSTOM_VERTEX_MAIN_END\n}";var Cu,Ou,wu=function(){function e(t,n){var a;void 0===n&&(n=e._DefaultOptions);var i=this;this._engine=t,this._fullscreenViewport=new Yl(0,0,1,1),n=Object(o.__assign)(Object(o.__assign)({},e._DefaultOptions),n),this._vertexBuffers=((a={})[Ql.PositionKind]=new Ql(t,n.positions,Ql.PositionKind,!1,!1,2),a),this._indexBuffer=t.createIndexBuffer(n.indices),this._onContextRestoredObserver=t.onContextRestoredObservable.add(function(){for(var e in i._indexBuffer=t.createIndexBuffer(n.indices),i._vertexBuffers)i._vertexBuffers[e]._rebuild()})}return e.prototype.setViewport=function(e){void 0===e&&(e=this._fullscreenViewport),this._engine.setViewport(e)},e.prototype.bindBuffers=function(e){this._engine.bindBuffers(this._vertexBuffers,this._indexBuffer,e)},e.prototype.applyEffectWrapper=function(e){this._engine.depthCullingState.depthTest=!1,this._engine.stencilState.stencilTest=!1,this._engine.enableEffect(e._drawWrapper),this.bindBuffers(e.effect),e.onApplyObservable.notifyObservers({})},e.prototype.restoreStates=function(){this._engine.depthCullingState.depthTest=!0,this._engine.stencilState.stencilTest=!0},e.prototype.draw=function(){this._engine.drawElementsType(0,0,6)},e.prototype._isRenderTargetTexture=function(e){return void 0!==e.renderTarget},e.prototype.render=function(e,t){if(void 0===t&&(t=null),e.effect.isReady()){this.setViewport();var n=null===t?null:this._isRenderTargetTexture(t)?t.renderTarget:t;n&&this._engine.bindFramebuffer(n),this.applyEffectWrapper(e),this.draw(),n&&this._engine.unBindFramebuffer(n),this.restoreStates()}},e.prototype.dispose=function(){var e=this._vertexBuffers[Ql.PositionKind];e&&(e.dispose(),delete this._vertexBuffers[Ql.PositionKind]),this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._onContextRestoredObserver&&(this._engine.onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null)},e._DefaultOptions={positions:[1,1,-1,1,-1,-1,1,-1],indices:[0,1,2,0,2,3]},e}(),Eu=function(){function e(e){var t,n=this;this.onApplyObservable=new Zl;var a=e.uniformNames||[];e.vertexShader?t={fragmentSource:e.fragmentShader,vertexSource:e.vertexShader,spectorName:e.name||"effectWrapper"}:(a.push("scale"),t={fragmentSource:e.fragmentShader,vertex:"postprocess",spectorName:e.name||"effectWrapper"},this.onApplyObservable.add(function(){n.effect.setFloat2("scale",1,1)}));var i=e.defines?e.defines.join("\n"):"";this._drawWrapper=new xu(e.engine),e.useShaderStore?(t.fragment=t.fragmentSource,t.vertex||(t.vertex=t.vertexSource),delete t.fragmentSource,delete t.vertexSource,this.effect=e.engine.createEffect(t,e.attributeNames||["position"],a,e.samplerNames,i,void 0,e.onCompiled,void 0,void 0,e.shaderLanguage)):(this.effect=new Iu(t,e.attributeNames||["position"],a,e.samplerNames,e.engine,i,void 0,e.onCompiled,void 0,void 0,void 0,e.shaderLanguage),this._onContextRestoredObserver=e.engine.onContextRestoredObservable.add(function(){n.effect._pipelineContext=null,n.effect._wasPreviouslyReady=!1,n.effect._prepareEffect()}))}return Object.defineProperty(e.prototype,"effect",{get:function(){return this._drawWrapper.effect},set:function(e){this._drawWrapper.effect=e},enumerable:!1,configurable:!0}),e.prototype.dispose=function(){this._onContextRestoredObserver&&(this.effect.getEngine().onContextRestoredObservable.remove(this._onContextRestoredObserver),this._onContextRestoredObserver=null),this.effect.dispose()},e}(),Au=function(){function e(){}return Object.defineProperty(e,"LastCreatedEngine",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastCreatedScene",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0}),e.Instances=new Array,e._LastCreatedScene=null,e.UseFallbackTexture=!0,e.FallbackTexture="",e}(),Lu=function(){function e(e){void 0===e&&(e=!0),this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,e&&this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zOffset",{get:function(){return this._zOffset},set:function(e){this._zOffset!==e&&(this._zOffset=e,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"zOffsetUnits",{get:function(){return this._zOffsetUnits},set:function(e){this._zOffsetUnits!==e&&(this._zOffsetUnits=e,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cullFace",{get:function(){return this._cullFace},set:function(e){this._cullFace!==e&&(this._cullFace=e,this._isCullFaceDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cull",{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this._isCullDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(e){this._depthFunc!==e&&(this._depthFunc=e,this._isDepthFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthMask",{get:function(){return this._depthMask},set:function(e){this._depthMask!==e&&(this._depthMask=e,this._isDepthMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return this._depthTest},set:function(e){this._depthTest!==e&&(this._depthTest=e,this._isDepthTestDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frontFace",{get:function(){return this._frontFace},set:function(e){this._frontFace!==e&&(this._frontFace=e,this._isFrontFaceDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._zOffsetUnits=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!0,this._isFrontFaceDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isCullDirty&&(this.cull?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(e.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(e.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?e.enable(e.DEPTH_TEST):e.disable(e.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(e.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset||this.zOffsetUnits?(e.enable(e.POLYGON_OFFSET_FILL),e.polygonOffset(this.zOffset,this.zOffsetUnits)):e.disable(e.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(e.frontFace(this.frontFace),this._isFrontFaceDirty=!1))},e}(),ku=function(){function e(){this.reset()}return e.prototype.reset=function(){this.enabled=!1,this.mask=255,this.func=e.ALWAYS,this.funcRef=1,this.funcMask=255,this.opStencilFail=e.KEEP,this.opDepthFail=e.KEEP,this.opStencilDepthPass=e.REPLACE},Object.defineProperty(e.prototype,"stencilFunc",{get:function(){return this.func},set:function(e){this.func=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFuncRef",{get:function(){return this.funcRef},set:function(e){this.funcRef=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilFuncMask",{get:function(){return this.funcMask},set:function(e){this.funcMask=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpStencilFail",{get:function(){return this.opStencilFail},set:function(e){this.opStencilFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpDepthFail",{get:function(){return this.opDepthFail},set:function(e){this.opDepthFail=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilOpStencilDepthPass",{get:function(){return this.opStencilDepthPass},set:function(e){this.opStencilDepthPass=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilMask",{get:function(){return this.mask},set:function(e){this.mask=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilTest",{get:function(){return this.enabled},set:function(e){this.enabled=e},enumerable:!1,configurable:!0}),e.ALWAYS=519,e.KEEP=7680,e.REPLACE=7681,e}(),Mu=function(){function e(){this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty||this._isBlendEquationParametersDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(e){this._alphaBlend!==e&&(this._alphaBlend=e,this._isAlphaBlendDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.setAlphaBlendConstants=function(e,t,n,a){this._blendConstants[0]===e&&this._blendConstants[1]===t&&this._blendConstants[2]===n&&this._blendConstants[3]===a||(this._blendConstants[0]=e,this._blendConstants[1]=t,this._blendConstants[2]=n,this._blendConstants[3]=a,this._isBlendConstantsDirty=!0)},e.prototype.setAlphaBlendFunctionParameters=function(e,t,n,a){this._blendFunctionParameters[0]===e&&this._blendFunctionParameters[1]===t&&this._blendFunctionParameters[2]===n&&this._blendFunctionParameters[3]===a||(this._blendFunctionParameters[0]=e,this._blendFunctionParameters[1]=t,this._blendFunctionParameters[2]=n,this._blendFunctionParameters[3]=a,this._isBlendFunctionParametersDirty=!0)},e.prototype.setAlphaEquationParameters=function(e,t){this._blendEquationParameters[0]===e&&this._blendEquationParameters[1]===t||(this._blendEquationParameters[0]=e,this._blendEquationParameters[1]=t,this._isBlendEquationParametersDirty=!0)},e.prototype.reset=function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1},e.prototype.apply=function(e){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?e.enable(e.BLEND):e.disable(e.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(e.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(e.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(e.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))},e}(),Pu=function(){function e(){this.samplingMode=-1,this._useMipMaps=!0,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._comparisonFunction=0}return Object.defineProperty(e.prototype,"wrapU",{get:function(){return this._cachedWrapU},set:function(e){this._cachedWrapU=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapV",{get:function(){return this._cachedWrapV},set:function(e){this._cachedWrapV=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wrapR",{get:function(){return this._cachedWrapR},set:function(e){this._cachedWrapR=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anisotropicFilteringLevel",{get:function(){return this._cachedAnisotropicFilteringLevel},set:function(e){this._cachedAnisotropicFilteringLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"comparisonFunction",{get:function(){return this._comparisonFunction},set:function(e){this._comparisonFunction=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useMipMaps",{get:function(){return this._useMipMaps},set:function(e){this._useMipMaps=e},enumerable:!1,configurable:!0}),e.prototype.setParameters=function(e,t,n,a,i,r){return void 0===e&&(e=1),void 0===t&&(t=1),void 0===n&&(n=1),void 0===a&&(a=1),void 0===i&&(i=2),void 0===r&&(r=0),this._cachedWrapU=e,this._cachedWrapV=t,this._cachedWrapR=n,this._cachedAnisotropicFilteringLevel=a,this.samplingMode=i,this._comparisonFunction=r,this},e.prototype.compareSampler=function(e){return this._cachedWrapU===e._cachedWrapU&&this._cachedWrapV===e._cachedWrapV&&this._cachedWrapR===e._cachedWrapR&&this._cachedAnisotropicFilteringLevel===e._cachedAnisotropicFilteringLevel&&this.samplingMode===e.samplingMode&&this._comparisonFunction===e._comparisonFunction&&this._useMipMaps===e._useMipMaps},e}();(Ou=Cu||(Cu={}))[Ou.Unknown=0]="Unknown",Ou[Ou.Url=1]="Url",Ou[Ou.Temp=2]="Temp",Ou[Ou.Raw=3]="Raw",Ou[Ou.Dynamic=4]="Dynamic",Ou[Ou.RenderTarget=5]="RenderTarget",Ou[Ou.MultiRenderTarget=6]="MultiRenderTarget",Ou[Ou.Cube=7]="Cube",Ou[Ou.CubeRaw=8]="CubeRaw",Ou[Ou.CubePrefiltered=9]="CubePrefiltered",Ou[Ou.Raw3D=10]="Raw3D",Ou[Ou.Raw2DArray=11]="Raw2DArray",Ou[Ou.DepthStencil=12]="DepthStencil",Ou[Ou.CubeRawRGBD=13]="CubeRawRGBD",Ou[Ou.Depth=14]="Depth";var Tu=function(e){function t(n,a,i){void 0===i&&(i=!1);var r=e.call(this)||this;return r.isReady=!1,r.isCube=!1,r.is3D=!1,r.is2DArray=!1,r.isMultiview=!1,r.url="",r.generateMipMaps=!1,r.samples=0,r.type=-1,r.format=-1,r.onLoadedObservable=new Zl,r.onErrorObservable=new Zl,r.onRebuildCallback=null,r.width=0,r.height=0,r.depth=0,r.baseWidth=0,r.baseHeight=0,r.baseDepth=0,r.invertY=!1,r._invertVScale=!1,r._associatedChannel=-1,r._source=Cu.Unknown,r._buffer=null,r._bufferView=null,r._bufferViewArray=null,r._bufferViewArrayArray=null,r._size=0,r._extension="",r._files=null,r._workingCanvas=null,r._workingContext=null,r._cachedCoordinatesMode=null,r._isDisabled=!1,r._compression=null,r._sphericalPolynomial=null,r._sphericalPolynomialPromise=null,r._sphericalPolynomialComputed=!1,r._lodGenerationScale=0,r._lodGenerationOffset=0,r._useSRGBBuffer=!1,r._lodTextureHigh=null,r._lodTextureMid=null,r._lodTextureLow=null,r._isRGBD=!1,r._linearSpecularLOD=!1,r._irradianceTexture=null,r._hardwareTexture=null,r._maxLodLevel=null,r._references=1,r._gammaSpace=null,r._engine=n,r._source=a,r._uniqueId=t._Counter++,i||(r._hardwareTexture=n._createHardwareTexture()),r}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"useMipMaps",{get:function(){return this.generateMipMaps},set:function(e){this.generateMipMaps=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uniqueId",{get:function(){return this._uniqueId},enumerable:!1,configurable:!0}),t.prototype.getEngine=function(){return this._engine},Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),t.prototype.incrementReferences=function(){this._references++},t.prototype.updateSize=function(e,t,n){void 0===n&&(n=1),this._engine.updateTextureDimensions(this,e,t,n),this.width=e,this.height=t,this.depth=n,this.baseWidth=e,this.baseHeight=t,this.baseDepth=n,this._size=e*t*n},t.prototype._rebuild=function(){var e,t=this;if(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this.onRebuildCallback){var n=this.onRebuildCallback(this),a=function(e){e._swapAndDie(t,!1),t.isReady=n.isReady};n.isAsync?n.proxy.then(a):a(n.proxy)}else{var i;switch(this.source){case Cu.Temp:break;case Cu.Url:return void(i=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,function(){i._swapAndDie(t,!1),t.isReady=!0},null,this._buffer,void 0,this.format,this._extension,void 0,void 0,void 0,this._useSRGBBuffer));case Cu.Raw:(i=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case Cu.Raw3D:(i=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case Cu.Raw2DArray:(i=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression,this.type))._swapAndDie(this,!1),this.isReady=!0;break;case Cu.Dynamic:(i=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this,!1),this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);break;case Cu.Cube:return void(i=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,function(){i._swapAndDie(t,!1),t.isReady=!0},null,this.format,this._extension,!1,0,0,null,void 0,this._useSRGBBuffer));case Cu.CubeRaw:(i=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this,!1),this.isReady=!0;break;case Cu.CubeRawRGBD:return;case Cu.CubePrefiltered:return void((i=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,function(e){e&&e._swapAndDie(t,!1),t.isReady=!0},null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}}},t.prototype._swapAndDie=function(e,t){var n;void 0===t&&(t=!0),null===(n=this._hardwareTexture)||void 0===n||n.setUsage(e._source,this.generateMipMaps,this.isCube,this.width,this.height),e._hardwareTexture=this._hardwareTexture,t&&(e._isRGBD=this._isRGBD),this._lodTextureHigh&&(e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(e._lodTextureLow&&e._lodTextureLow.dispose(),e._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(e._irradianceTexture&&e._irradianceTexture.dispose(),e._irradianceTexture=this._irradianceTexture);var a=this._engine.getLoadedTexturesCache(),i=a.indexOf(this);-1!==i&&a.splice(i,1),-1===(i=a.indexOf(e))&&a.push(e)},t.prototype.dispose=function(){this._references--,this.onLoadedObservable.clear(),this.onErrorObservable.clear(),0===this._references&&(this._engine._releaseTexture(this),this._hardwareTexture=null)},t._Counter=0,t}(Pu),Uu=function(){function e(){this.shaderLanguage=au.GLSL}return e.prototype.postProcessor=function(e,t,n,a,i){return i.getCaps().drawBuffersExtension||(e=e.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,"")),e},e}(),Fu=function(){function e(){this.shaderLanguage=au.GLSL}return e.prototype.attributeProcessor=function(e){return e.replace("attribute","in")},e.prototype.varyingProcessor=function(e,t){return e.replace("varying",t?"in":"out")},e.prototype.postProcessor=function(e,t,n){var a=-1!==e.search(/#extension.+GL_EXT_draw_buffers.+require/);if(e=(e=e.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),n)e=(e=(e=(e=(e=(e=(e=e.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(a?"":"out vec4 glFragColor;\n")+"void main(");else if(-1!==t.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+e;return e},e}(),Hu=function(e){function t(t){var n=e.call(this)||this;return n._buffer=t,n}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"underlyingResource",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),t}(Kl),Ru=function(){function e(){this._valueCache={},this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null}return Object.defineProperty(e.prototype,"isAsync",{get:function(){return this.isParallelCompiled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isReady",{get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))},enumerable:!1,configurable:!0}),e.prototype._handlesSpectorRebuildCallback=function(e){e&&this.program&&e(this.program)},e.prototype._fillEffectInformation=function(e,t,n,a,i,r,o,s){var c,d=this.engine;if(d.supportsUniformBuffers)for(var l in t)e.bindUniformBlock(l,t[l]);for(this.engine.getUniforms(this,n).forEach(function(e,t){a[n[t]]=e}),this._uniforms=a,c=0;c<i.length;c++)null==e.getUniform(i[c])&&(i.splice(c,1),c--);i.forEach(function(e,t){r[e]=t});for(var u=0,f=d.getAttributes(this,o);u<f.length;u++){var p=f[u];s.push(p)}},e.prototype.dispose=function(){this._uniforms={}},e.prototype._cacheMatrix=function(e,t){var n=this._valueCache[e],a=t.updateFlag;return(void 0===n||n!==a)&&(this._valueCache[e]=a,!0)},e.prototype._cacheFloat2=function(e,t,n){var a=this._valueCache[e];if(!a||2!==a.length)return a=[t,n],this._valueCache[e]=a,!0;var i=!1;return a[0]!==t&&(a[0]=t,i=!0),a[1]!==n&&(a[1]=n,i=!0),i},e.prototype._cacheFloat3=function(e,t,n,a){var i=this._valueCache[e];if(!i||3!==i.length)return i=[t,n,a],this._valueCache[e]=i,!0;var r=!1;return i[0]!==t&&(i[0]=t,r=!0),i[1]!==n&&(i[1]=n,r=!0),i[2]!==a&&(i[2]=a,r=!0),r},e.prototype._cacheFloat4=function(e,t,n,a,i){var r=this._valueCache[e];if(!r||4!==r.length)return r=[t,n,a,i],this._valueCache[e]=r,!0;var o=!1;return r[0]!==t&&(r[0]=t,o=!0),r[1]!==n&&(r[1]=n,o=!0),r[2]!==a&&(r[2]=a,o=!0),r[3]!==i&&(r[3]=i,o=!0),o},e.prototype.setInt=function(e,t){var n=this._valueCache[e];void 0!==n&&n===t||this.engine.setInt(this._uniforms[e],t)&&(this._valueCache[e]=t)},e.prototype.setInt2=function(e,t,n){this._cacheFloat2(e,t,n)&&(this.engine.setInt2(this._uniforms[e],t,n)||(this._valueCache[e]=null))},e.prototype.setInt3=function(e,t,n,a){this._cacheFloat3(e,t,n,a)&&(this.engine.setInt3(this._uniforms[e],t,n,a)||(this._valueCache[e]=null))},e.prototype.setInt4=function(e,t,n,a,i){this._cacheFloat4(e,t,n,a,i)&&(this.engine.setInt4(this._uniforms[e],t,n,a,i)||(this._valueCache[e]=null))},e.prototype.setIntArray=function(e,t){this._valueCache[e]=null,this.engine.setIntArray(this._uniforms[e],t)},e.prototype.setIntArray2=function(e,t){this._valueCache[e]=null,this.engine.setIntArray2(this._uniforms[e],t)},e.prototype.setIntArray3=function(e,t){this._valueCache[e]=null,this.engine.setIntArray3(this._uniforms[e],t)},e.prototype.setIntArray4=function(e,t){this._valueCache[e]=null,this.engine.setIntArray4(this._uniforms[e],t)},e.prototype.setArray=function(e,t){this._valueCache[e]=null,this.engine.setArray(this._uniforms[e],t)},e.prototype.setArray2=function(e,t){this._valueCache[e]=null,this.engine.setArray2(this._uniforms[e],t)},e.prototype.setArray3=function(e,t){this._valueCache[e]=null,this.engine.setArray3(this._uniforms[e],t)},e.prototype.setArray4=function(e,t){this._valueCache[e]=null,this.engine.setArray4(this._uniforms[e],t)},e.prototype.setMatrices=function(e,t){t&&(this._valueCache[e]=null,this.engine.setMatrices(this._uniforms[e],t))},e.prototype.setMatrix=function(e,t){this._cacheMatrix(e,t)&&(this.engine.setMatrices(this._uniforms[e],t.toArray())||(this._valueCache[e]=null))},e.prototype.setMatrix3x3=function(e,t){this._valueCache[e]=null,this.engine.setMatrix3x3(this._uniforms[e],t)},e.prototype.setMatrix2x2=function(e,t){this._valueCache[e]=null,this.engine.setMatrix2x2(this._uniforms[e],t)},e.prototype.setFloat=function(e,t){var n=this._valueCache[e];void 0!==n&&n===t||this.engine.setFloat(this._uniforms[e],t)&&(this._valueCache[e]=t)},e.prototype.setVector2=function(e,t){this._cacheFloat2(e,t.x,t.y)&&(this.engine.setFloat2(this._uniforms[e],t.x,t.y)||(this._valueCache[e]=null))},e.prototype.setFloat2=function(e,t,n){this._cacheFloat2(e,t,n)&&(this.engine.setFloat2(this._uniforms[e],t,n)||(this._valueCache[e]=null))},e.prototype.setVector3=function(e,t){this._cacheFloat3(e,t.x,t.y,t.z)&&(this.engine.setFloat3(this._uniforms[e],t.x,t.y,t.z)||(this._valueCache[e]=null))},e.prototype.setFloat3=function(e,t,n,a){this._cacheFloat3(e,t,n,a)&&(this.engine.setFloat3(this._uniforms[e],t,n,a)||(this._valueCache[e]=null))},e.prototype.setVector4=function(e,t){this._cacheFloat4(e,t.x,t.y,t.z,t.w)&&(this.engine.setFloat4(this._uniforms[e],t.x,t.y,t.z,t.w)||(this._valueCache[e]=null))},e.prototype.setFloat4=function(e,t,n,a,i){this._cacheFloat4(e,t,n,a,i)&&(this.engine.setFloat4(this._uniforms[e],t,n,a,i)||(this._valueCache[e]=null))},e.prototype.setColor3=function(e,t){this._cacheFloat3(e,t.r,t.g,t.b)&&(this.engine.setFloat3(this._uniforms[e],t.r,t.g,t.b)||(this._valueCache[e]=null))},e.prototype.setColor4=function(e,t,n){this._cacheFloat4(e,t.r,t.g,t.b,n)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,n)||(this._valueCache[e]=null))},e.prototype.setDirectColor4=function(e,t){this._cacheFloat4(e,t.r,t.g,t.b,t.a)&&(this.engine.setFloat4(this._uniforms[e],t.r,t.g,t.b,t.a)||(this._valueCache[e]=null))},e.prototype._getVertexShaderCode=function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null},e.prototype._getFragmentShaderCode=function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null},e}(),Nu=function(){function e(){}return e.SetMatrixPrecision=function(t){if(e.MatrixTrackPrecisionChange=!1,t&&!e.MatrixUse64Bits&&e.MatrixTrackedMatrices)for(var n=0;n<e.MatrixTrackedMatrices.length;++n){var a=e.MatrixTrackedMatrices[n],i=a._m;a._m=new Array(16);for(var r=0;r<16;++r)a._m[r]=i[r]}e.MatrixUse64Bits=t,e.MatrixCurrentType=e.MatrixUse64Bits?Array:Float32Array,e.MatrixTrackedMatrices=null},e.MatrixUse64Bits=!1,e.MatrixTrackPrecisionChange=!0,e.MatrixCurrentType=Float32Array,e.MatrixTrackedMatrices=[],e}(),Bu=function(){function e(e,t){if(void 0===e&&(e=null),this._MSAARenderBuffer=null,this._context=t,!e&&!(e=t.createTexture()))throw new Error("Unable to create webGL texture");this.set(e)}return Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return this._webGLTexture},enumerable:!1,configurable:!0}),e.prototype.setUsage=function(){},e.prototype.set=function(e){this._webGLTexture=e},e.prototype.reset=function(){this._webGLTexture=null,this._MSAARenderBuffer=null},e.prototype.release=function(){this._MSAARenderBuffer&&(this._context.deleteRenderbuffer(this._MSAARenderBuffer),this._MSAARenderBuffer=null),this._webGLTexture&&this._context.deleteTexture(this._webGLTexture),this.reset()},e}(),ju=function(){function e(e){void 0===e&&(e=!0),this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.useStencilGlobalOnly=!1,e&&this.reset()}return Object.defineProperty(e.prototype,"isDirty",{get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"func",{get:function(){return this._func},set:function(e){this._func!==e&&(this._func=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"funcRef",{get:function(){return this._funcRef},set:function(e){this._funcRef!==e&&(this._funcRef=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"funcMask",{get:function(){return this._funcMask},set:function(e){this._funcMask!==e&&(this._funcMask=e,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opStencilFail",{get:function(){return this._opStencilFail},set:function(e){this._opStencilFail!==e&&(this._opStencilFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opDepthFail",{get:function(){return this._opDepthFail},set:function(e){this._opDepthFail!==e&&(this._opDepthFail=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"opStencilDepthPass",{get:function(){return this._opStencilDepthPass},set:function(e){this._opStencilDepthPass!==e&&(this._opStencilDepthPass=e,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mask",{get:function(){return this._mask},set:function(e){this._mask!==e&&(this._mask=e,this._isStencilMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e,this._isStencilTestDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.reset=function(){var e;this.stencilMaterial=void 0,null===(e=this.stencilGlobal)||void 0===e||e.reset(),this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0},e.prototype.apply=function(e){var t;if(e){var n=!this.useStencilGlobalOnly&&!!(null===(t=this.stencilMaterial)||void 0===t?void 0:t.enabled);this.enabled=n?this.stencilMaterial.enabled:this.stencilGlobal.enabled,this.func=n?this.stencilMaterial.func:this.stencilGlobal.func,this.funcRef=n?this.stencilMaterial.funcRef:this.stencilGlobal.funcRef,this.funcMask=n?this.stencilMaterial.funcMask:this.stencilGlobal.funcMask,this.opStencilFail=n?this.stencilMaterial.opStencilFail:this.stencilGlobal.opStencilFail,this.opDepthFail=n?this.stencilMaterial.opDepthFail:this.stencilGlobal.opDepthFail,this.opStencilDepthPass=n?this.stencilMaterial.opStencilDepthPass:this.stencilGlobal.opStencilDepthPass,this.mask=n?this.stencilMaterial.mask:this.stencilGlobal.mask,this.isDirty&&(this._isStencilTestDirty&&(this.enabled?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(e.stencilMask(this.mask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(e.stencilFunc(this.func,this.funcRef,this.funcMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(e.stencilOp(this.opStencilFail,this.opDepthFail,this.opStencilDepthPass),this._isStencilOpDirty=!1))}},e}(),Vu=function(){},zu=function(){function e(t,n,a,i){var r=this;this._name="WebGL",this.forcePOTTextures=!1,this.isFullscreen=!1,this.cullBackFaces=null,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this.validateShaderPrograms=!1,this._useReverseDepthBuffer=!1,this.isNDCHalfZRange=!1,this.hasOriginBottomLeft=!0,this.disableUniformBuffers=!1,this.onDisposeObservable=new Zl,this._frameId=0,this._uniformBuffers=new Array,this._storageBuffers=new Array,this._webGLVersion=1,this._windowIsBackground=!1,this._highPrecisionShadersAllowed=!0,this._badOS=!1,this._badDesktopOS=!1,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onContextLostObservable=new Zl,this.onContextRestoredObservable=new Zl,this._contextWasLost=!1,this._doNotHandleContextLost=!1,this.disableVertexArrayObjects=!1,this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new Lu,this._stencilStateComposer=new ju,this._stencilState=new ku,this._alphaState=new Mu,this._alphaMode=1,this._alphaEquation=0,this._internalTexturesCache=new Array,this._renderTargetWrapperCache=new Array,this._activeChannel=0,this._currentTextureChannel=-1,this._boundTexturesCache={},this._compiledEffects={},this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._activeRequests=new Array,this._adaptToDeviceRatio=!1,this._transformTextureUrl=null,this.hostInformation={isMobile:!1},this.premultipliedAlpha=!0,this.onBeforeTextureInitObservable=new Zl,this._isWebGPU=!1,this._snapshotRenderingMode=0,this._viewportCached={x:0,y:0,z:0,w:0},this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._boundUniforms={};var o=null;if(a=a||{},this._creationOptions=a,this._adaptToDeviceRatio=null!=i&&i,this._stencilStateComposer.stencilGlobal=this._stencilState,Nu.SetMatrixPrecision(!!a.useHighPrecisionMatrix),t){if(i=i||a.adaptToDeviceRatio||!1,t.getContext){if(o=t,this._renderingCanvas=o,void 0!==n&&(a.antialias=n),void 0===a.deterministicLockstep&&(a.deterministicLockstep=!1),void 0===a.lockstepMaxSteps&&(a.lockstepMaxSteps=4),void 0===a.timeStep&&(a.timeStep=1/60),void 0===a.preserveDrawingBuffer&&(a.preserveDrawingBuffer=!1),void 0===a.audioEngine&&(a.audioEngine=!0),void 0!==a.audioEngineOptions&&void 0!==a.audioEngineOptions.audioContext&&(this._audioContext=a.audioEngineOptions.audioContext),void 0!==a.audioEngineOptions&&void 0!==a.audioEngineOptions.audioDestination&&(this._audioDestination=a.audioEngineOptions.audioDestination),void 0===a.stencil&&(a.stencil=!0),!1===a.premultipliedAlpha&&(this.premultipliedAlpha=!1),void 0===a.xrCompatible&&(a.xrCompatible=!0),this._doNotHandleContextLost=!!a.doNotHandleContextLost,navigator&&navigator.userAgent){this._checkForMobile=function(){var e=navigator.userAgent;r.hostInformation.isMobile=-1!==e.indexOf("Mobile")||-1!==e.indexOf("Mac")&&tu()&&"ontouchend"in document},this._checkForMobile(),$l()&&window.addEventListener("resize",this._checkForMobile);for(var s=navigator.userAgent,c=0,d=e.ExceptionList;c<d.length;c++){var l=d[c],u=l.key,f=l.targets;if(new RegExp(u).test(s)){if(l.capture&&l.captureConstraint){var p=l.capture,m=l.captureConstraint,_=new RegExp(p).exec(s);if(_&&_.length>0&&parseInt(_[_.length-1])>=m)continue}for(var h=0,b=f;h<b.length;h++)switch(b[h]){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0}}}}if(this._doNotHandleContextLost||(this._onContextLost=function(e){e.preventDefault(),r._contextWasLost=!0,ou.Warn("WebGL context lost."),r.onContextLostObservable.notifyObservers(r)},this._onContextRestored=function(){r._restoreEngineAfterContextLost(r._initGLContext.bind(r))},o.addEventListener("webglcontextlost",this._onContextLost,!1),o.addEventListener("webglcontextrestored",this._onContextRestored,!1),a.powerPreference="high-performance"),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._badDesktopOS&&(a.xrCompatible=!1),!a.disableWebGL2Support)try{this._gl=o.getContext("webgl2",a)||o.getContext("experimental-webgl2",a),this._gl&&(this._webGLVersion=2,this._shaderPlatformName="WEBGL2",this._gl.deleteQuery||(this._webGLVersion=1,this._shaderPlatformName="WEBGL1"))}catch(e){}if(!this._gl){if(!o)throw new Error("The provided canvas is null or undefined.");try{this._gl=o.getContext("webgl",a)||o.getContext("experimental-webgl",a)}catch(e){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=t,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample?(this._webGLVersion=2,this._shaderPlatformName="WEBGL2"):this._shaderPlatformName="WEBGL1";var g=this._gl.getContextAttributes();g&&(a.stencil=g.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),void 0!==a.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=a.useHighPrecisionFloats);var v=$l()&&window.devicePixelRatio||1,y=a.limitDeviceRatio||v;this._hardwareScalingLevel=i?1/Math.min(y,v):1,this.resize(),this._isStencilEnable=!!a.stencil,this._initGLContext(),this._initFeatures();for(var S=0;S<this._caps.maxVertexAttribs;S++)this._currentBufferPointers[S]=new Vu;this._shaderProcessor=this.webGLVersion>1?new Fu:new Uu,this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent);var D="Babylon.js v".concat(e.Version);console.log(D+" - ".concat(this.description)),this._renderingCanvas&&this._renderingCanvas.setAttribute&&this._renderingCanvas.setAttribute("data-engine",D)}}return Object.defineProperty(e,"NpmPackage",{get:function(){return"babylonjs@5.0.4"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Version",{get:function(){return"5.0.4"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){var e=this.name+this.webGLVersion;return this._caps.parallelShaderCompile&&(e+=" - Parallel shader compilation"),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ShadersRepository",{get:function(){return Iu.ShadersRepository},set:function(e){Iu.ShadersRepository=e},enumerable:!1,configurable:!0}),e.prototype._getShaderProcessor=function(e){return this._shaderProcessor},Object.defineProperty(e.prototype,"useReverseDepthBuffer",{get:function(){return this._useReverseDepthBuffer},set:function(e){e!==this._useReverseDepthBuffer&&(this._useReverseDepthBuffer=e,this._depthCullingState.depthFunc=e?518:515)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this._frameId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"supportsUniformBuffers",{get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers},enumerable:!1,configurable:!0}),e.prototype.getCreationOptions=function(){return this._creationOptions},Object.defineProperty(e.prototype,"_shouldUseHighPrecisionShader",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needPOTTextures",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"activeRenderLoops",{get:function(){return this._activeRenderLoops},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doNotHandleContextLost",{get:function(){return this._doNotHandleContextLost},set:function(e){this._doNotHandleContextLost=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"framebufferDimensionsObject",{set:function(e){this._framebufferDimensionsObject=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentViewport",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture",{get:function(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture3D",{get:function(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyTexture2DArray",{get:function(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"emptyCubeTexture",{get:function(){if(!this._emptyCubeTexture){var e=new Uint8Array(4),t=[e,e,e,e,e,e];this._emptyCubeTexture=this.createRawCubeTexture(t,1,5,0,!1,!1,1)}return this._emptyCubeTexture},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWebGPU",{get:function(){return this._isWebGPU},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shaderPlatformName",{get:function(){return this._shaderPlatformName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"snapshotRendering",{get:function(){return!1},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"snapshotRenderingMode",{get:function(){return this._snapshotRenderingMode},set:function(e){this._snapshotRenderingMode=e},enumerable:!1,configurable:!0}),e.prototype.snapshotRenderingReset=function(){this.snapshotRendering=!1},e._CreateCanvas=function(e,t){if("undefined"==typeof document)return new OffscreenCanvas(e,t);var n=document.createElement("canvas");return n.width=e,n.height=t,n},e.prototype.createCanvas=function(t,n){return e._CreateCanvas(t,n)},e.prototype.createCanvasImage=function(){return document.createElement("img")},e.prototype._restoreEngineAfterContextLost=function(e){var t=this;setTimeout(function(){return Object(o.__awaiter)(t,void 0,void 0,function(){var t,n,a,i,r;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return this._dummyFramebuffer=null,t=this._depthCullingState.depthTest,n=this._depthCullingState.depthFunc,a=this._depthCullingState.depthMask,i=this._stencilState.stencilTest,[4,e()];case 1:return o.sent(),this._rebuildEffects(),null===(r=this._rebuildComputeEffects)||void 0===r||r.call(this),this._rebuildInternalTextures(),this._rebuildRenderTargetWrappers(),this._rebuildBuffers(),this.wipeCaches(!0),this._depthCullingState.depthTest=t,this._depthCullingState.depthFunc=n,this._depthCullingState.depthMask=a,this._stencilState.stencilTest=i,ou.Warn(this.name+" context successfully restored."),this.onContextRestoredObservable.notifyObservers(this),this._contextWasLost=!1,[2]}})})},0)},e.prototype._sharedInit=function(e,t,n){this._renderingCanvas=e},e.prototype._getShaderProcessingContext=function(e){return null},e.prototype._rebuildInternalTextures=function(){for(var e=0,t=this._internalTexturesCache.slice();e<t.length;e++)t[e]._rebuild()},e.prototype._rebuildRenderTargetWrappers=function(){for(var e=0,t=this._renderTargetWrapperCache.slice();e<t.length;e++)t[e]._rebuild()},e.prototype._rebuildEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e];t._pipelineContext=null,t._wasPreviouslyReady=!1,t._prepareEffect()}Iu.ResetCache()},e.prototype.areAllEffectsReady=function(){for(var e in this._compiledEffects)if(!this._compiledEffects[e].isReady())return!1;return!0},e.prototype._rebuildBuffers=function(){for(var e=0,t=this._uniformBuffers;e<t.length;e++)t[e]._rebuild();for(var n=0,a=this._storageBuffers;n<a.length;n++)a[n]._rebuild()},e.prototype._initGLContext=function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile")||void 0,standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),s3tc_srgb:this._gl.getExtension("WEBGL_compressed_texture_s3tc_srgb")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc_srgb"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),supportOcclusionQuery:this._webGLVersion>1,canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:!!(this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float")),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1,canUseGLInstanceID:this._webGLVersion>1,canUseGLVertexID:this._webGLVersion>1,supportComputeShaders:!1,supportSRGBBuffers:!1,supportTransformFeedbacks:this._webGLVersion>1,textureMaxLevel:this._webGLVersion>1},this._glVersion=this._gl.getParameter(this._gl.VERSION);var e=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=e&&(this._glRenderer=this._gl.getParameter(e.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(e.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor=this._gl.getParameter(this._gl.VENDOR)||"Unknown vendor"),this._glRenderer||(this._glRenderer=this._gl.getParameter(this._gl.RENDERER)||"Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._caps.astc&&(this._gl.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=this._caps.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR),this._caps.bptc&&(this._gl.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=this._caps.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT),this._caps.s3tc_srgb&&(this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,this._gl.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=this._caps.s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._gl.getParameter(this._gl.MAX_SAMPLES);else{var t=this._gl.getExtension("WEBGL_draw_buffers");if(null!==t){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=t.drawBuffersWEBGL.bind(t),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var n=0;n<16;n++)this._gl["COLOR_ATTACHMENT"+n+"_WEBGL"]=t["COLOR_ATTACHMENT"+n+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var a=this._gl.getExtension("WEBGL_depth_texture");null!=a&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=a.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var i=this._gl.getExtension("OES_vertex_array_object");null!=i&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=i.createVertexArrayOES.bind(i),this._gl.bindVertexArray=i.bindVertexArrayOES.bind(i),this._gl.deleteVertexArray=i.deleteVertexArrayOES.bind(i))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var r=this._gl.getExtension("ANGLE_instanced_arrays");null!=r?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=r.drawArraysInstancedANGLE.bind(r),this._gl.drawElementsInstanced=r.drawElementsInstancedANGLE.bind(r),this._gl.vertexAttribDivisor=r.vertexAttribDivisorANGLE.bind(r)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var o=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),s=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);o&&s&&(this._caps.highPrecisionShaderSupported=0!==o.precision&&0!==s.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var c=this._gl.getExtension("EXT_blend_minmax");null!=c&&(this._caps.blendMinMax=!0,this._gl.MAX=c.MAX_EXT,this._gl.MIN=c.MIN_EXT)}if(!this._caps.supportSRGBBuffers){if(this._webGLVersion>1)this._caps.supportSRGBBuffers=!0;else{var d=this._gl.getExtension("EXT_sRGB");null!=d&&(this._caps.supportSRGBBuffers=!0,this._gl.SRGB=d.SRGB_EXT,this._gl.SRGB8=d.SRGB_ALPHA_EXT,this._gl.SRGB8_ALPHA8=d.SRGB_ALPHA_EXT)}this._caps.supportSRGBBuffers=this._caps.supportSRGBBuffers&&!(!this._creationOptions||!this._creationOptions.forceSRGBBufferSupportState)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var l=0;l<this._maxSimultaneousTextures;l++)this._nextFreeTextureSlots.push(l)},e.prototype._initFeatures=function(){this._features={forceBitmapOverHTMLImageElement:!1,supportRenderAndCopyToLodForFloatTextures:1!==this._webGLVersion,supportDepthStencilTexture:1!==this._webGLVersion,supportShadowSamplers:1!==this._webGLVersion,uniformBufferHardCheckMatrix:!1,allowTexturePrefiltering:1!==this._webGLVersion,trackUbosInFrame:!1,checkUbosContentBeforeUpload:!1,supportCSM:1!==this._webGLVersion,basisNeedsPOT:1===this._webGLVersion,support3DTextures:1!==this._webGLVersion,needTypeSuffixInShaderConstants:1!==this._webGLVersion,supportMSAA:1!==this._webGLVersion,supportSSAO2:1!==this._webGLVersion,supportExtendedTextureFormats:1!==this._webGLVersion,supportSwitchCaseInShader:1!==this._webGLVersion,supportSyncTextureRead:!0,needsInvertingBitmap:!0,useUBOBindingCache:!0,needShaderCodeInlining:!1,needToAlwaysBindUniformBuffers:!1,supportRenderPasses:!1,_collectUbosUpdatedInFrame:!1}},Object.defineProperty(e.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"ThinEngine"},Object.defineProperty(e.prototype,"isStencilEnable",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0}),e.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=this.createCanvas(1,1);var e=this._workingCanvas.getContext("2d");e&&(this._workingContext=e)}},e.prototype.resetTextureCache=function(){for(var e in this._boundTexturesCache)Object.prototype.hasOwnProperty.call(this._boundTexturesCache,e)&&(this._boundTexturesCache[e]=null);this._currentTextureChannel=-1},e.prototype.getInfo=function(){return this.getGlInfo()},e.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},e.prototype.setHardwareScalingLevel=function(e){this._hardwareScalingLevel=e,this.resize()},e.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},e.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache},e.prototype.getCaps=function(){return this._caps},e.prototype.stopRenderLoop=function(e){if(e){var t=this._activeRenderLoops.indexOf(e);t>=0&&this._activeRenderLoops.splice(t,1)}else this._activeRenderLoops=[]},e.prototype._renderLoop=function(){if(!this._contextWasLost){var e=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(e=!1),e){this.beginFrame();for(var t=0;t<this._activeRenderLoops.length;t++)(0,this._activeRenderLoops[t])();this.endFrame()}}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1},e.prototype.getRenderingCanvas=function(){return this._renderingCanvas},e.prototype.getAudioContext=function(){return this._audioContext},e.prototype.getAudioDestination=function(){return this._audioDestination},e.prototype.getHostWindow=function(){return $l()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null},e.prototype.getRenderWidth=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth},e.prototype.getRenderHeight=function(e){return void 0===e&&(e=!1),!e&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight},e.prototype._queueNewFrame=function(t,n){return e.QueueNewFrame(t,n)},e.prototype.runRenderLoop=function(e){-1===this._activeRenderLoops.indexOf(e)&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))},e.prototype.clear=function(e,t,n,a){void 0===a&&(a=!1);var i=this.stencilStateComposer.useStencilGlobalOnly;this.stencilStateComposer.useStencilGlobalOnly=!0,this.applyStates(),this.stencilStateComposer.useStencilGlobalOnly=i;var r=0;t&&e&&(this._gl.clearColor(e.r,e.g,e.b,void 0!==e.a?e.a:1),r|=this._gl.COLOR_BUFFER_BIT),n&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GEQUAL,this._gl.clearDepth(0)):this._gl.clearDepth(1),r|=this._gl.DEPTH_BUFFER_BIT),a&&(this._gl.clearStencil(0),r|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(r)},e.prototype._viewport=function(e,t,n,a){e===this._viewportCached.x&&t===this._viewportCached.y&&n===this._viewportCached.z&&a===this._viewportCached.w||(this._viewportCached.x=e,this._viewportCached.y=t,this._viewportCached.z=n,this._viewportCached.w=a,this._gl.viewport(e,t,n,a))},e.prototype.setViewport=function(e,t,n){var a=t||this.getRenderWidth(),i=n||this.getRenderHeight(),r=e.x||0,o=e.y||0;this._cachedViewport=e,this._viewport(r*a,o*i,a*e.width,i*e.height)},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){this._badOS&&this.flushFramebuffer(),this._frameId++},e.prototype.resize=function(e){var t,n;if(void 0===e&&(e=!1),this._adaptToDeviceRatio){var a=$l()&&window.devicePixelRatio||1,i=this._creationOptions.limitDeviceRatio||a;this._hardwareScalingLevel=this._adaptToDeviceRatio?1/Math.min(i,a):1}$l()?(t=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth,n=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight):(t=this._renderingCanvas?this._renderingCanvas.width:100,n=this._renderingCanvas?this._renderingCanvas.height:100),this.setSize(t/this._hardwareScalingLevel,n/this._hardwareScalingLevel,e)},e.prototype.setSize=function(e,t,n){return void 0===n&&(n=!1),!(!this._renderingCanvas||(e|=0,t|=0,!n&&this._renderingCanvas.width===e&&this._renderingCanvas.height===t||(this._renderingCanvas.width=e,this._renderingCanvas.height=t,0)))},e.prototype.bindFramebuffer=function(e,t,n,a,i,r,o){var s,c,d,l,u;void 0===t&&(t=0),void 0===r&&(r=0),void 0===o&&(o=0);var f=e;this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=e,this._bindUnboundFramebuffer(f._MSAAFramebuffer?f._MSAAFramebuffer:f._framebuffer);var p=this._gl;e.is2DArray?p.framebufferTextureLayer(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,null===(s=e.texture._hardwareTexture)||void 0===s?void 0:s.underlyingResource,r,o):e.isCube&&p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(c=e.texture._hardwareTexture)||void 0===c?void 0:c.underlyingResource,r);var m=e._depthStencilTexture;if(m){var _=e._depthStencilTextureWithStencil?p.DEPTH_STENCIL_ATTACHMENT:p.DEPTH_ATTACHMENT;e.is2DArray?p.framebufferTextureLayer(p.FRAMEBUFFER,_,null===(d=m._hardwareTexture)||void 0===d?void 0:d.underlyingResource,r,o):e.isCube?p.framebufferTexture2D(p.FRAMEBUFFER,_,p.TEXTURE_CUBE_MAP_POSITIVE_X+t,null===(l=m._hardwareTexture)||void 0===l?void 0:l.underlyingResource,r):p.framebufferTexture2D(p.FRAMEBUFFER,_,p.TEXTURE_2D,null===(u=m._hardwareTexture)||void 0===u?void 0:u.underlyingResource,r)}this._cachedViewport&&!i?this.setViewport(this._cachedViewport,n,a):(n||(n=e.width,r&&(n/=Math.pow(2,r))),a||(a=e.height,r&&(a/=Math.pow(2,r))),this._viewport(0,0,n,a)),this.wipeCaches()},e.prototype.setState=function(e,t,n,a,i,r,o){var s,c;void 0===t&&(t=0),void 0===a&&(a=!1),void 0===o&&(o=0),(this._depthCullingState.cull!==e||n)&&(this._depthCullingState.cull=e);var d=null===(c=null!==(s=this.cullBackFaces)&&void 0!==s?s:i)||void 0===c||c?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==d||n)&&(this._depthCullingState.cullFace=d),this.setZOffset(t),this.setZOffsetUnits(o);var l=a?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==l||n)&&(this._depthCullingState.frontFace=l),this._stencilStateComposer.stencilMaterial=r},e.prototype.setZOffset=function(e){this._depthCullingState.zOffset=this.useReverseDepthBuffer?-e:e},e.prototype.getZOffset=function(){var e=this._depthCullingState.zOffset;return this.useReverseDepthBuffer?-e:e},e.prototype.setZOffsetUnits=function(e){this._depthCullingState.zOffsetUnits=this.useReverseDepthBuffer?-e:e},e.prototype.getZOffsetUnits=function(){var e=this._depthCullingState.zOffsetUnits;return this.useReverseDepthBuffer?-e:e},e.prototype._bindUnboundFramebuffer=function(e){this._currentFramebuffer!==e&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,e),this._currentFramebuffer=e)},e.prototype._currentFrameBufferIsDefaultFrameBuffer=function(){return null===this._currentFramebuffer},e.prototype.generateMipmaps=function(e){this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)},e.prototype.unBindFramebuffer=function(e,t,n){var a;void 0===t&&(t=!1);var i=e;this._currentRenderTarget=null;var r=this._gl;if(i._MSAAFramebuffer){if(e.isMulti)return void this.unBindMultiColorAttachmentFramebuffer(e,t,n);r.bindFramebuffer(r.READ_FRAMEBUFFER,i._MSAAFramebuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,i._framebuffer),r.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,r.COLOR_BUFFER_BIT,r.NEAREST)}!(null===(a=e.texture)||void 0===a?void 0:a.generateMipMaps)||t||e.isCube||this.generateMipmaps(e.texture),n&&(i._MSAAFramebuffer&&this._bindUnboundFramebuffer(i._framebuffer),n()),this._bindUnboundFramebuffer(null)},e.prototype.flushFramebuffer=function(){this._gl.flush()},e.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()},e.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null},e.prototype.createVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.STATIC_DRAW)},e.prototype._createVertexBuffer=function(e,t){var n=this._gl.createBuffer();if(!n)throw new Error("Unable to create vertex buffer");var a=new Hu(n);return this.bindArrayBuffer(a),e instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(e),t):this._gl.bufferData(this._gl.ARRAY_BUFFER,e,t),this._resetVertexBufferBinding(),a.references=1,a},e.prototype.createDynamicVertexBuffer=function(e){return this._createVertexBuffer(e,this._gl.DYNAMIC_DRAW)},e.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null},e.prototype.createIndexBuffer=function(e,t){var n=this._gl.createBuffer(),a=new Hu(n);if(!n)throw new Error("Unable to create index buffer");this.bindIndexBuffer(a);var i=this._normalizeIndexData(e);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,i,t?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),a.references=1,a.is32Bits=4===i.BYTES_PER_ELEMENT,a},e.prototype._normalizeIndexData=function(e){if(2===e.BYTES_PER_ELEMENT)return e;if(this._caps.uintIndices){if(e instanceof Uint32Array)return e;for(var t=0;t<e.length;t++)if(e[t]>=65535)return new Uint32Array(e);return new Uint16Array(e)}return new Uint16Array(e)},e.prototype.bindArrayBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ARRAY_BUFFER)},e.prototype.bindUniformBlock=function(e,t,n){var a=e.program,i=this._gl.getUniformBlockIndex(a,t);this._gl.uniformBlockBinding(a,i,n)},e.prototype.bindIndexBuffer=function(e){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this._bindBuffer(e,this._gl.ELEMENT_ARRAY_BUFFER)},e.prototype._bindBuffer=function(e,t){(this._vaoRecordInProgress||this._currentBoundBuffer[t]!==e)&&(this._gl.bindBuffer(t,e?e.underlyingResource:null),this._currentBoundBuffer[t]=e)},e.prototype.updateArrayBuffer=function(e){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)},e.prototype._vertexAttribPointer=function(e,t,n,a,i,r,o){var s=this._currentBufferPointers[t];if(s){var c=!1;s.active?(s.buffer!==e&&(s.buffer=e,c=!0),s.size!==n&&(s.size=n,c=!0),s.type!==a&&(s.type=a,c=!0),s.normalized!==i&&(s.normalized=i,c=!0),s.stride!==r&&(s.stride=r,c=!0),s.offset!==o&&(s.offset=o,c=!0)):(c=!0,s.active=!0,s.index=t,s.size=n,s.type=a,s.normalized=i,s.stride=r,s.offset=o,s.buffer=e),(c||this._vaoRecordInProgress)&&(this.bindArrayBuffer(e),this._gl.vertexAttribPointer(t,n,a,i,r,o))}},e.prototype._bindIndexBufferWithCache=function(e){null!=e&&this._cachedIndexBuffer!==e&&(this._cachedIndexBuffer=e,this.bindIndexBuffer(e),this._uintIndicesCurrentlySet=e.is32Bits)},e.prototype._bindVertexBuffersAttributes=function(e,t,n){var a=t.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var i=0;i<a.length;i++){var r=t.getAttributeLocation(i);if(r>=0){var o=a[i],s=null;if(n&&(s=n[o]),s||(s=e[o]),!s)continue;this._gl.enableVertexAttribArray(r),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[r]=!0);var c=s.getBuffer();c&&(this._vertexAttribPointer(c,r,s.getSize(),s.type,s.normalized,s.byteStride,s.byteOffset),s.getIsInstanced()&&(this._gl.vertexAttribDivisor(r,s.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(r),this._currentInstanceBuffers.push(c))))}}},e.prototype.recordVertexArrayObject=function(e,t,n,a){var i=this._gl.createVertexArray();return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(i),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(e,n,a),this.bindIndexBuffer(t),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),i},e.prototype.bindVertexArrayObject=function(e,t){this._cachedVertexArrayObject!==e&&(this._cachedVertexArrayObject=e,this._gl.bindVertexArray(e),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=t&&t.is32Bits,this._mustWipeVertexAttributes=!0)},e.prototype.bindBuffersDirectly=function(e,t,n,a,i){if(this._cachedVertexBuffers!==e||this._cachedEffectForVertexBuffers!==i){this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=i;var r=i.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var o=0,s=0;s<r;s++)if(s<n.length){var c=i.getAttributeLocation(s);c>=0&&(this._gl.enableVertexAttribArray(c),this._vertexAttribArraysEnabled[c]=!0,this._vertexAttribPointer(e,c,n[s],this._gl.FLOAT,!1,a,o)),o+=4*n[s]}}this._bindIndexBufferWithCache(t)},e.prototype._unbindVertexArrayObject=function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))},e.prototype.bindBuffers=function(e,t,n,a){this._cachedVertexBuffers===e&&this._cachedEffectForVertexBuffers===n||(this._cachedVertexBuffers=e,this._cachedEffectForVertexBuffers=n,this._bindVertexBuffersAttributes(e,n,a)),this._bindIndexBufferWithCache(t)},e.prototype.unbindInstanceAttributes=function(){for(var e,t=0,n=this._currentInstanceLocations.length;t<n;t++){var a=this._currentInstanceBuffers[t];e!=a&&a.references&&(e=a,this.bindArrayBuffer(a));var i=this._currentInstanceLocations[t];this._gl.vertexAttribDivisor(i,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0},e.prototype.releaseVertexArrayObject=function(e){this._gl.deleteVertexArray(e)},e.prototype._releaseBuffer=function(e){return e.references--,0===e.references&&(this._deleteBuffer(e),!0)},e.prototype._deleteBuffer=function(e){this._gl.deleteBuffer(e.underlyingResource)},e.prototype.updateAndBindInstancesBuffer=function(e,t,n){if(this.bindArrayBuffer(e),t&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t),void 0!==n[0].index)this.bindInstancesBuffer(e,n,!0);else for(var a=0;a<4;a++){var i=n[a];this._vertexAttribArraysEnabled[i]||(this._gl.enableVertexAttribArray(i),this._vertexAttribArraysEnabled[i]=!0),this._vertexAttribPointer(e,i,4,this._gl.FLOAT,!1,64,16*a),this._gl.vertexAttribDivisor(i,1),this._currentInstanceLocations.push(i),this._currentInstanceBuffers.push(e)}},e.prototype.bindInstancesBuffer=function(e,t,n){void 0===n&&(n=!0),this.bindArrayBuffer(e);var a=0;if(n)for(var i=0;i<t.length;i++)a+=4*(r=t[i]).attributeSize;for(i=0;i<t.length;i++){var r;void 0===(r=t[i]).index&&(r.index=this._currentEffect.getAttributeLocationByName(r.attributeName)),r.index<0||(this._vertexAttribArraysEnabled[r.index]||(this._gl.enableVertexAttribArray(r.index),this._vertexAttribArraysEnabled[r.index]=!0),this._vertexAttribPointer(e,r.index,r.attributeSize,r.attributeType||this._gl.FLOAT,r.normalized||!1,a,r.offset),this._gl.vertexAttribDivisor(r.index,void 0===r.divisor?1:r.divisor),this._currentInstanceLocations.push(r.index),this._currentInstanceBuffers.push(e))}},e.prototype.disableInstanceAttributeByName=function(e){if(this._currentEffect){var t=this._currentEffect.getAttributeLocationByName(e);this.disableInstanceAttribute(t)}},e.prototype.disableInstanceAttribute=function(e){for(var t,n=!1;-1!==(t=this._currentInstanceLocations.indexOf(e));)this._currentInstanceLocations.splice(t,1),this._currentInstanceBuffers.splice(t,1),n=!0,t=this._currentInstanceLocations.indexOf(e);n&&(this._gl.vertexAttribDivisor(e,0),this.disableAttributeByIndex(e))},e.prototype.disableAttributeByIndex=function(e){this._gl.disableVertexAttribArray(e),this._vertexAttribArraysEnabled[e]=!1,this._currentBufferPointers[e].active=!1},e.prototype.draw=function(e,t,n,a){this.drawElementsType(e?0:1,t,n,a)},e.prototype.drawPointClouds=function(e,t,n){this.drawArraysType(2,e,t,n)},e.prototype.drawUnIndexed=function(e,t,n,a){this.drawArraysType(e?0:1,t,n,a)},e.prototype.drawElementsType=function(e,t,n,a){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e),r=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,o=this._uintIndicesCurrentlySet?4:2;a?this._gl.drawElementsInstanced(i,n,r,t*o,a):this._gl.drawElements(i,n,r,t*o)},e.prototype.drawArraysType=function(e,t,n,a){this.applyStates(),this._reportDrawCall();var i=this._drawMode(e);a?this._gl.drawArraysInstanced(i,t,n,a):this._gl.drawArrays(i,t,n)},e.prototype._drawMode=function(e){switch(e){default:return this._gl.TRIANGLES;case 2:case 3:return this._gl.POINTS;case 1:case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN}},e.prototype._reportDrawCall=function(){},e.prototype._releaseEffect=function(e){if(this._compiledEffects[e._key]){delete this._compiledEffects[e._key];var t=e.getPipelineContext();t&&this._deletePipelineContext(t)}},e.prototype._deletePipelineContext=function(e){var t=e;t&&t.program&&(t.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(t.program))},e.prototype._getGlobalDefines=function(e){if(e)return this.isNDCHalfZRange?e.IS_NDC_HALF_ZRANGE="":delete e.IS_NDC_HALF_ZRANGE,void(this.useReverseDepthBuffer?e.USE_REVERSE_DEPTHBUFFER="":delete e.USE_REVERSE_DEPTHBUFFER);var t="";return this.isNDCHalfZRange&&(t+="#define IS_NDC_HALF_ZRANGE"),this.useReverseDepthBuffer&&(t&&(t+="\n"),t+="#define USE_REVERSE_DEPTHBUFFER"),t},e.prototype.createEffect=function(e,t,n,a,i,r,o,s,c,d){var l;void 0===d&&(d=au.GLSL);var u=e.vertexElement||e.vertex||e.vertexToken||e.vertexSource||e,f=e.fragmentElement||e.fragment||e.fragmentToken||e.fragmentSource||e,p=this._getGlobalDefines(),m=null!==(l=null!=i?i:t.defines)&&void 0!==l?l:"";p&&(m+=p);var _=u+"+"+f+"@"+m;if(this._compiledEffects[_]){var h=this._compiledEffects[_];return o&&h.isReady()&&o(h),h}var b=new Iu(e,t,n,a,this,i,r,o,s,c,_,d);return this._compiledEffects[_]=b,b},e._ConcatenateShader=function(e,t,n){return void 0===n&&(n=""),n+(t?t+"\n":"")+e},e.prototype._compileShader=function(t,n,a,i){return this._compileRawShader(e._ConcatenateShader(t,a,i),n)},e.prototype._compileRawShader=function(e,t){var n=this._gl,a=n.createShader("vertex"===t?n.VERTEX_SHADER:n.FRAGMENT_SHADER);if(!a){for(var i=n.NO_ERROR,r=n.NO_ERROR;(r=n.getError())!==n.NO_ERROR;)i=r;throw new Error("Something went wrong while creating a gl ".concat(t," shader object. gl error=").concat(i,", gl isContextLost=").concat(n.isContextLost(),", _contextWasLost=").concat(this._contextWasLost))}return n.shaderSource(a,e),n.compileShader(a),a},e.prototype._getShaderSource=function(e){return this._gl.getShaderSource(e)},e.prototype.createRawShaderProgram=function(e,t,n,a,i){void 0===i&&(i=null),a=a||this._gl;var r=this._compileRawShader(t,"vertex"),o=this._compileRawShader(n,"fragment");return this._createShaderProgram(e,r,o,a,i)},e.prototype.createShaderProgram=function(e,t,n,a,i,r){void 0===r&&(r=null),i=i||this._gl;var o=this._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",s=this._compileShader(t,"vertex",a,o),c=this._compileShader(n,"fragment",a,o);return this._createShaderProgram(e,s,c,i,r)},e.prototype.inlineShaderCode=function(e){return e},e.prototype.createPipelineContext=function(e){var t=new Ru;return t.engine=this,this._caps.parallelShaderCompile&&(t.isParallelCompiled=!0),t},e.prototype.createMaterialContext=function(){},e.prototype.createDrawContext=function(){},e.prototype._createShaderProgram=function(e,t,n,a,i){void 0===i&&(i=null);var r=a.createProgram();if(e.program=r,!r)throw new Error("Unable to create program");return a.attachShader(r,t),a.attachShader(r,n),a.linkProgram(r),e.context=a,e.vertexShader=t,e.fragmentShader=n,e.isParallelCompiled||this._finalizePipelineContext(e),r},e.prototype._finalizePipelineContext=function(e){var t=e.context,n=e.vertexShader,a=e.fragmentShader,i=e.program;if(!t.getProgramParameter(i,t.LINK_STATUS)){var r,o;if(!this._gl.getShaderParameter(n,this._gl.COMPILE_STATUS)&&(r=this._gl.getShaderInfoLog(n)))throw e.vertexCompilationError=r,new Error("VERTEX SHADER "+r);if(!this._gl.getShaderParameter(a,this._gl.COMPILE_STATUS)&&(r=this._gl.getShaderInfoLog(a)))throw e.fragmentCompilationError=r,new Error("FRAGMENT SHADER "+r);if(o=t.getProgramInfoLog(i))throw e.programLinkError=o,new Error(o)}if(this.validateShaderPrograms&&(t.validateProgram(i),!t.getProgramParameter(i,t.VALIDATE_STATUS)&&(o=t.getProgramInfoLog(i))))throw e.programValidationError=o,new Error(o);t.deleteShader(n),t.deleteShader(a),e.vertexShader=void 0,e.fragmentShader=void 0,e.onCompiled&&(e.onCompiled(),e.onCompiled=void 0)},e.prototype._preparePipelineContext=function(e,t,n,a,i,r,o,s,c,d){var l=e;l.program=a?this.createRawShaderProgram(l,t,n,void 0,c):this.createShaderProgram(l,t,n,s,void 0,c),l.program.__SPECTOR_rebuildProgram=o},e.prototype._isRenderingStateCompiled=function(e){var t=e;return!!this._gl.getProgramParameter(t.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)&&(this._finalizePipelineContext(t),!0)},e.prototype._executeWhenRenderingStateIsCompiled=function(e,t){var n=e;if(n.isParallelCompiled){var a=n.onCompiled;n.onCompiled=a?function(){a(),t()}:t}else t()},e.prototype.getUniforms=function(e,t){for(var n=new Array,a=e,i=0;i<t.length;i++)n.push(this._gl.getUniformLocation(a.program,t[i]));return n},e.prototype.getAttributes=function(e,t){for(var n=[],a=e,i=0;i<t.length;i++)try{n.push(this._gl.getAttribLocation(a.program,t[i]))}catch(e){n.push(-1)}return n},e.prototype.enableEffect=function(e){(e=null!==e&&xu.IsWrapper(e)?e.effect:e)&&e!==this._currentEffect&&(this._stencilStateComposer.stencilMaterial=void 0,e=e,this.bindSamplers(e),this._currentEffect=e,e.onBind&&e.onBind(e),e._onBindObservable&&e._onBindObservable.notifyObservers(e))},e.prototype.setInt=function(e,t){return!!e&&(this._gl.uniform1i(e,t),!0)},e.prototype.setInt2=function(e,t,n){return!!e&&(this._gl.uniform2i(e,t,n),!0)},e.prototype.setInt3=function(e,t,n,a){return!!e&&(this._gl.uniform3i(e,t,n,a),!0)},e.prototype.setInt4=function(e,t,n,a,i){return!!e&&(this._gl.uniform4i(e,t,n,a,i),!0)},e.prototype.setIntArray=function(e,t){return!!e&&(this._gl.uniform1iv(e,t),!0)},e.prototype.setIntArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2iv(e,t),0))},e.prototype.setIntArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3iv(e,t),0))},e.prototype.setIntArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4iv(e,t),0))},e.prototype.setArray=function(e,t){return!(!e||t.length<1||(this._gl.uniform1fv(e,t),0))},e.prototype.setArray2=function(e,t){return!(!e||t.length%2!=0||(this._gl.uniform2fv(e,t),0))},e.prototype.setArray3=function(e,t){return!(!e||t.length%3!=0||(this._gl.uniform3fv(e,t),0))},e.prototype.setArray4=function(e,t){return!(!e||t.length%4!=0||(this._gl.uniform4fv(e,t),0))},e.prototype.setMatrices=function(e,t){return!!e&&(this._gl.uniformMatrix4fv(e,!1,t),!0)},e.prototype.setMatrix3x3=function(e,t){return!!e&&(this._gl.uniformMatrix3fv(e,!1,t),!0)},e.prototype.setMatrix2x2=function(e,t){return!!e&&(this._gl.uniformMatrix2fv(e,!1,t),!0)},e.prototype.setFloat=function(e,t){return!!e&&(this._gl.uniform1f(e,t),!0)},e.prototype.setFloat2=function(e,t,n){return!!e&&(this._gl.uniform2f(e,t,n),!0)},e.prototype.setFloat3=function(e,t,n,a){return!!e&&(this._gl.uniform3f(e,t,n,a),!0)},e.prototype.setFloat4=function(e,t,n,a,i){return!!e&&(this._gl.uniform4f(e,t,n,a,i),!0)},e.prototype.applyStates=function(){if(this._depthCullingState.apply(this._gl),this._stencilStateComposer.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;var e=this._colorWrite;this._gl.colorMask(e,e,e,e)}},e.prototype.setColorWrite=function(e){e!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=e)},e.prototype.getColorWrite=function(){return this._colorWrite},Object.defineProperty(e.prototype,"depthCullingState",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alphaState",{get:function(){return this._alphaState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilState",{get:function(){return this._stencilState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stencilStateComposer",{get:function(){return this._stencilStateComposer},enumerable:!1,configurable:!0}),e.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache=[]},e.prototype.wipeCaches=function(e){this.preventCacheWipeBetweenFrames&&!e||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),e&&(this._currentProgram=null,this.resetTextureCache(),this._stencilStateComposer.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))},e.prototype._getSamplingParameters=function(e,t){var n=this._gl,a=n.NEAREST,i=n.NEAREST;switch(e){case 11:a=n.LINEAR,i=t?n.LINEAR_MIPMAP_NEAREST:n.LINEAR;break;case 3:a=n.LINEAR,i=t?n.LINEAR_MIPMAP_LINEAR:n.LINEAR;break;case 8:a=n.NEAREST,i=t?n.NEAREST_MIPMAP_LINEAR:n.NEAREST;break;case 4:a=n.NEAREST,i=t?n.NEAREST_MIPMAP_NEAREST:n.NEAREST;break;case 5:a=n.NEAREST,i=t?n.LINEAR_MIPMAP_NEAREST:n.LINEAR;break;case 6:a=n.NEAREST,i=t?n.LINEAR_MIPMAP_LINEAR:n.LINEAR;break;case 7:a=n.NEAREST,i=n.LINEAR;break;case 1:a=n.NEAREST,i=n.NEAREST;break;case 9:a=n.LINEAR,i=t?n.NEAREST_MIPMAP_NEAREST:n.NEAREST;break;case 10:a=n.LINEAR,i=t?n.NEAREST_MIPMAP_LINEAR:n.NEAREST;break;case 2:a=n.LINEAR,i=n.LINEAR;break;case 12:a=n.LINEAR,i=n.NEAREST}return{min:i,mag:a}},e.prototype._createTexture=function(){var e=this._gl.createTexture();if(!e)throw new Error("Unable to create texture");return e},e.prototype._createHardwareTexture=function(){return new Bu(this._createTexture(),this._gl)},e.prototype._createInternalTexture=function(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=Cu.Unknown);var i={};void 0!==t&&"object"==typeof t?(i.generateMipMaps=t.generateMipMaps,i.type=void 0===t.type?0:t.type,i.samplingMode=void 0===t.samplingMode?3:t.samplingMode,i.format=void 0===t.format?5:t.format):(i.generateMipMaps=t,i.type=0,i.samplingMode=3,i.format=5),(1!==i.type||this._caps.textureFloatLinearFiltering)&&(2!==i.type||this._caps.textureHalfFloatLinearFiltering)||(i.samplingMode=1),1!==i.type||this._caps.textureFloat||(i.type=0,ou.Warn("Float textures are not supported. Type forced to TEXTURETYPE_UNSIGNED_BYTE"));var r=this._gl,o=new Tu(this,a),s=e.width||e,c=e.height||e,d=e.layers||0,l=this._getSamplingParameters(i.samplingMode,!!i.generateMipMaps),u=0!==d?r.TEXTURE_2D_ARRAY:r.TEXTURE_2D,f=this._getRGBABufferInternalSizedFormat(i.type,i.format),p=this._getInternalFormat(i.format),m=this._getWebGLTextureType(i.type);return this._bindTextureDirectly(u,o),0!==d?(o.is2DArray=!0,r.texImage3D(u,0,f,s,c,d,0,p,m,null)):r.texImage2D(u,0,f,s,c,0,p,m,null),r.texParameteri(u,r.TEXTURE_MAG_FILTER,l.mag),r.texParameteri(u,r.TEXTURE_MIN_FILTER,l.min),r.texParameteri(u,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(u,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),i.generateMipMaps&&this._gl.generateMipmap(u),this._bindTextureDirectly(u,null),o.baseWidth=s,o.baseHeight=c,o.width=s,o.height=c,o.depth=d,o.isReady=!0,o.samples=1,o.generateMipMaps=!!i.generateMipMaps,o.samplingMode=i.samplingMode,o.type=i.type,o.format=i.format,this._internalTexturesCache.push(o),o},e.prototype._getUseSRGBBuffer=function(e,t){return e&&this._caps.supportSRGBBuffers&&(this.webGLVersion>1||this.isWebGPU||t)},e.prototype._createTextureBase=function(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h){var b=this;void 0===r&&(r=3),void 0===o&&(o=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===f&&(f=null),void 0===p&&(p=null);var g="data:"===(t=t||"").substr(0,5),v="blob:"===t.substr(0,5),y=g&&-1!==t.indexOf(";base64,"),S=u||new Tu(this,Cu.Url),D=t;!this._transformTextureUrl||y||u||l||(t=this._transformTextureUrl(t)),D!==t&&(S._originalUrl=D);var I=t.lastIndexOf("."),x=p||(I>-1?t.substring(I).toLowerCase():""),C=null;x.indexOf("?")>-1&&(x=x.split("?")[0]);for(var O=0,w=e._TextureLoaders;O<w.length;O++){var E=w[O];if(E.canLoad(x,m)){C=E;break}}i&&i._addPendingData(S),S.url=t,S.generateMipMaps=!n,S.samplingMode=r,S.invertY=a,S._useSRGBBuffer=this._getUseSRGBBuffer(!!h,n),this._doNotHandleContextLost||(S._buffer=l);var A=null;o&&!u&&(A=S.onLoadedObservable.add(o)),u||this._internalTexturesCache.push(S);var L=function(e,a){i&&i._removePendingData(S),t===D?(A&&S.onLoadedObservable.remove(A),Au.UseFallbackTexture&&b._createTextureBase(Au.FallbackTexture,n,S.invertY,i,r,null,s,c,d,l,S),e=(e||"Unknown error")+(Au.UseFallbackTexture?" - Fallback texture was used":""),S.onErrorObservable.notifyObservers({message:e,exception:a}),s&&s(e,a)):(ou.Warn("Failed to load ".concat(t,", falling back to ").concat(D)),b._createTextureBase(D,n,S.invertY,i,r,o,s,c,d,l,S,f,p,m,_,h))};if(C){var k=function(e){C.loadData(e,S,function(e,t,n,a,o,s){s?L("TextureLoader failed to load data"):c(S,x,i,{width:e,height:t},S.invertY,!n,a,function(){return o(),!1},r)},_)};l?l instanceof ArrayBuffer?k(new Uint8Array(l)):ArrayBuffer.isView(l)?k(l):s&&s("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(t,function(e){return k(new Uint8Array(e))},void 0,i?i.offlineProvider:void 0,!0,function(e,t){L("Unable to load "+(e&&e.responseURL,t))})}else{var M=function(e){v&&!b._doNotHandleContextLost&&(S._buffer=e),c(S,x,i,e,S.invertY,n,!1,d,r)};!g||y?l&&("string"==typeof l.decoding||l.close)?M(l):e._FileToolsLoadImage(t,M,L,i?i.offlineProvider:null,m,S.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):"string"==typeof l||l instanceof ArrayBuffer||ArrayBuffer.isView(l)||l instanceof Blob?e._FileToolsLoadImage(l,M,L,i?i.offlineProvider:null,m,S.invertY&&this._features.needsInvertingBitmap?{imageOrientation:"flipY"}:void 0):l&&M(l)}return S},e.prototype.createTexture=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m){var _=this;return void 0===i&&(i=3),void 0===r&&(r=null),void 0===o&&(o=null),void 0===s&&(s=null),void 0===c&&(c=null),void 0===d&&(d=null),void 0===l&&(l=null),this._createTextureBase(e,t,n,a,i,r,o,this._prepareWebGLTexture.bind(this),function(e,t,n,i,r,o){var s=_._gl,c=n.width===e&&n.height===t,l=d?_._getInternalFormat(d,r._useSRGBBuffer):".jpg"!==i||r._useSRGBBuffer?r._useSRGBBuffer?s.SRGB8_ALPHA8:s.RGBA:s.RGB,u=d?_._getInternalFormat(d):".jpg"!==i||r._useSRGBBuffer?s.RGBA:s.RGB;if(r._useSRGBBuffer&&1===_.webGLVersion&&(u=l),c)return s.texImage2D(s.TEXTURE_2D,0,l,u,s.UNSIGNED_BYTE,n),!1;var f=_._caps.maxTextureSize;if(n.width>f||n.height>f||!_._supportsHardwareTextureRescaling)return _._prepareWorkingCanvas(),!(!_._workingCanvas||!_._workingContext||(_._workingCanvas.width=e,_._workingCanvas.height=t,_._workingContext.drawImage(n,0,0,n.width,n.height,0,0,e,t),s.texImage2D(s.TEXTURE_2D,0,l,u,s.UNSIGNED_BYTE,_._workingCanvas),r.width=e,r.height=t,1));var p=new Tu(_,Cu.Temp);return _._bindTextureDirectly(s.TEXTURE_2D,p,!0),s.texImage2D(s.TEXTURE_2D,0,l,u,s.UNSIGNED_BYTE,n),_._rescaleTexture(p,r,a,l,function(){_._releaseTexture(p),_._bindTextureDirectly(s.TEXTURE_2D,r,!0),o()}),!0},s,c,d,l,u,f,m)},e._FileToolsLoadImage=function(e,t,n,a,i,r){throw gu("FileTools")},e.prototype._rescaleTexture=function(e,t,n,a,i){},e.prototype.createRawTexture=function(e,t,n,a,i,r,o,s,c){throw void 0===s&&(s=null),void 0===c&&(c=0),gu("Engine.RawTexture")},e.prototype.createRawCubeTexture=function(e,t,n,a,i,r,o,s){throw void 0===s&&(s=null),gu("Engine.RawTexture")},e.prototype.createRawTexture3D=function(e,t,n,a,i,r,o,s,c,d){throw void 0===c&&(c=null),void 0===d&&(d=0),gu("Engine.RawTexture")},e.prototype.createRawTexture2DArray=function(e,t,n,a,i,r,o,s,c,d){throw void 0===c&&(c=null),void 0===d&&(d=0),gu("Engine.RawTexture")},e.prototype._unpackFlipY=function(e){this._unpackFlipYCached!==e&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,e?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=e))},e.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)},e.prototype._getTextureTarget=function(e){return e.isCube?this._gl.TEXTURE_CUBE_MAP:e.is3D?this._gl.TEXTURE_3D:e.is2DArray||e.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D},e.prototype.updateTextureSamplingMode=function(e,t,n){void 0===n&&(n=!1);var a=this._getTextureTarget(t),i=this._getSamplingParameters(e,t.generateMipMaps||n);this._setTextureParameterInteger(a,this._gl.TEXTURE_MAG_FILTER,i.mag,t),this._setTextureParameterInteger(a,this._gl.TEXTURE_MIN_FILTER,i.min),n&&(t.generateMipMaps=!0,this._gl.generateMipmap(a)),this._bindTextureDirectly(a,null),t.samplingMode=e},e.prototype.updateTextureDimensions=function(e,t,n,a){void 0===a&&(a=1)},e.prototype.updateTextureWrappingMode=function(e,t,n,a){void 0===n&&(n=null),void 0===a&&(a=null);var i=this._getTextureTarget(e);null!==t&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t),e),e._cachedWrapU=t),null!==n&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(n),e),e._cachedWrapV=n),(e.is2DArray||e.is3D)&&null!==a&&(this._setTextureParameterInteger(i,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(a),e),e._cachedWrapR=a),this._bindTextureDirectly(i,null)},e.prototype._setupDepthStencilTexture=function(e,t,n,a,i,r){void 0===r&&(r=1);var o=t.width||t,s=t.height||t,c=t.layers||0;e.baseWidth=o,e.baseHeight=s,e.width=o,e.height=s,e.is2DArray=c>0,e.depth=c,e.isReady=!0,e.samples=r,e.generateMipMaps=!1,e.samplingMode=a?2:1,e.type=0,e._comparisonFunction=i;var d=this._gl,l=this._getTextureTarget(e),u=this._getSamplingParameters(e.samplingMode,!1);d.texParameteri(l,d.TEXTURE_MAG_FILTER,u.mag),d.texParameteri(l,d.TEXTURE_MIN_FILTER,u.min),d.texParameteri(l,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(l,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),0===i?(d.texParameteri(l,d.TEXTURE_COMPARE_FUNC,515),d.texParameteri(l,d.TEXTURE_COMPARE_MODE,d.NONE)):(d.texParameteri(l,d.TEXTURE_COMPARE_FUNC,i),d.texParameteri(l,d.TEXTURE_COMPARE_MODE,d.COMPARE_REF_TO_TEXTURE))},e.prototype._uploadCompressedDataToTextureDirectly=function(e,t,n,a,i,r,o){void 0===r&&(r=0),void 0===o&&(o=0);var s=this._gl,c=s.TEXTURE_2D;if(e.isCube&&(c=s.TEXTURE_CUBE_MAP_POSITIVE_X+r),e._useSRGBBuffer)switch(t){case 36492:t=s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT;break;case 37808:t=s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR;break;case 33776:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:e._useSRGBBuffer=!1;break;case 33779:this._caps.s3tc_srgb?t=s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:e._useSRGBBuffer=!1;break;default:e._useSRGBBuffer=!1}this._gl.compressedTexImage2D(c,o,t,n,a,0,i)},e.prototype._uploadDataToTextureDirectly=function(e,t,n,a,i,r){void 0===n&&(n=0),void 0===a&&(a=0),void 0===r&&(r=!1);var o=this._gl,s=this._getWebGLTextureType(e.type),c=this._getInternalFormat(e.format),d=void 0===i?this._getRGBABufferInternalSizedFormat(e.type,e.format,e._useSRGBBuffer):this._getInternalFormat(i,e._useSRGBBuffer);this._unpackFlipY(e.invertY);var l=o.TEXTURE_2D;e.isCube&&(l=o.TEXTURE_CUBE_MAP_POSITIVE_X+n);var u=Math.round(Math.log(e.width)*Math.LOG2E),f=Math.round(Math.log(e.height)*Math.LOG2E),p=r?e.width:Math.pow(2,Math.max(u-a,0)),m=r?e.height:Math.pow(2,Math.max(f-a,0));o.texImage2D(l,a,d,p,m,0,c,s,t)},e.prototype.updateTextureData=function(e,t,n,a,i,r,o,s,c){void 0===o&&(o=0),void 0===s&&(s=0),void 0===c&&(c=!1);var d=this._gl,l=this._getWebGLTextureType(e.type),u=this._getInternalFormat(e.format);this._unpackFlipY(e.invertY);var f=d.TEXTURE_2D;e.isCube&&(f=d.TEXTURE_CUBE_MAP_POSITIVE_X+o),this._bindTextureDirectly(f,e,!0),d.texSubImage2D(f,s,n,a,i,r,u,l,t),c&&this._gl.generateMipmap(f),this._bindTextureDirectly(f,null)},e.prototype._uploadArrayBufferViewToTexture=function(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var i=this._gl,r=e.isCube?i.TEXTURE_CUBE_MAP:i.TEXTURE_2D;this._bindTextureDirectly(r,e,!0),this._uploadDataToTextureDirectly(e,t,n,a),this._bindTextureDirectly(r,null,!0)},e.prototype._prepareWebGLTextureContinuation=function(e,t,n,a,i){var r=this._gl;if(r){var o=this._getSamplingParameters(i,!n);r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,o.mag),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,o.min),n||a||r.generateMipmap(r.TEXTURE_2D),this._bindTextureDirectly(r.TEXTURE_2D,null),t&&t._removePendingData(e),e.onLoadedObservable.notifyObservers(e),e.onLoadedObservable.clear()}},e.prototype._prepareWebGLTexture=function(t,n,a,i,r,o,s,c,d){var l=this;void 0===d&&(d=3);var u=this.getCaps().maxTextureSize,f=Math.min(u,this.needPOTTextures?e.GetExponentOfTwo(i.width,u):i.width),p=Math.min(u,this.needPOTTextures?e.GetExponentOfTwo(i.height,u):i.height),m=this._gl;m&&(t._hardwareTexture?(this._bindTextureDirectly(m.TEXTURE_2D,t,!0),this._unpackFlipY(void 0===r||!!r),t.baseWidth=i.width,t.baseHeight=i.height,t.width=f,t.height=p,t.isReady=!0,c(f,p,i,n,t,function(){l._prepareWebGLTextureContinuation(t,a,o,s,d)})||this._prepareWebGLTextureContinuation(t,a,o,s,d)):a&&a._removePendingData(t))},e.prototype._setupFramebufferDepthAttachments=function(e,t,n,a,i){void 0===i&&(i=1);var r=this._gl;if(e&&t)return this._createRenderBuffer(n,a,i,r.DEPTH_STENCIL,r.DEPTH24_STENCIL8,r.DEPTH_STENCIL_ATTACHMENT);if(t){var o=r.DEPTH_COMPONENT16;return this._webGLVersion>1&&(o=r.DEPTH_COMPONENT32F),this._createRenderBuffer(n,a,i,o,o,r.DEPTH_ATTACHMENT)}return e?this._createRenderBuffer(n,a,i,r.STENCIL_INDEX8,r.STENCIL_INDEX8,r.STENCIL_ATTACHMENT):null},e.prototype._createRenderBuffer=function(e,t,n,a,i,r,o){void 0===o&&(o=!0);var s=this._gl,c=s.createRenderbuffer();return s.bindRenderbuffer(s.RENDERBUFFER,c),n>1&&s.renderbufferStorageMultisample?s.renderbufferStorageMultisample(s.RENDERBUFFER,n,i,e,t):s.renderbufferStorage(s.RENDERBUFFER,a,e,t),s.framebufferRenderbuffer(s.FRAMEBUFFER,r,s.RENDERBUFFER,c),o&&s.bindRenderbuffer(s.RENDERBUFFER,null),c},e.prototype._releaseTexture=function(e){var t;this._deleteTexture(null===(t=e._hardwareTexture)||void 0===t?void 0:t.underlyingResource),this.unbindAllTextures();var n=this._internalTexturesCache.indexOf(e);-1!==n&&this._internalTexturesCache.splice(n,1),e._lodTextureHigh&&e._lodTextureHigh.dispose(),e._lodTextureMid&&e._lodTextureMid.dispose(),e._lodTextureLow&&e._lodTextureLow.dispose(),e._irradianceTexture&&e._irradianceTexture.dispose()},e.prototype._releaseRenderTargetWrapper=function(e){var t=this._renderTargetWrapperCache.indexOf(e);-1!==t&&this._renderTargetWrapperCache.splice(t,1)},e.prototype._deleteTexture=function(e){e&&this._gl.deleteTexture(e)},e.prototype._setProgram=function(e){this._currentProgram!==e&&(this._gl.useProgram(e),this._currentProgram=e)},e.prototype.bindSamplers=function(e){var t=e.getPipelineContext();this._setProgram(t.program);for(var n=e.getSamplers(),a=0;a<n.length;a++){var i=e.getUniform(n[a]);i&&(this._boundUniforms[a]=i)}this._currentEffect=null},e.prototype._activateCurrentTexture=function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)},e.prototype._bindTextureDirectly=function(e,t,n,a){var i,r;void 0===n&&(n=!1),void 0===a&&(a=!1);var o=!1,s=t&&t._associatedChannel>-1;if(n&&s&&(this._activeChannel=t._associatedChannel),this._boundTexturesCache[this._activeChannel]!==t||a){if(this._activateCurrentTexture(),t&&t.isMultiview)throw console.error(e,t),"_bindTextureDirectly called with a multiview texture!";this._gl.bindTexture(e,null!==(r=null===(i=null==t?void 0:t._hardwareTexture)||void 0===i?void 0:i.underlyingResource)&&void 0!==r?r:null),this._boundTexturesCache[this._activeChannel]=t,t&&(t._associatedChannel=this._activeChannel)}else n&&(o=!0,this._activateCurrentTexture());return s&&!n&&this._bindSamplerUniformToChannel(t._associatedChannel,this._activeChannel),o},e.prototype._bindTexture=function(e,t,n){if(void 0!==e){t&&(t._associatedChannel=e),this._activeChannel=e;var a=t?this._getTextureTarget(t):this._gl.TEXTURE_2D;this._bindTextureDirectly(a,t)}},e.prototype.unbindAllTextures=function(){for(var e=0;e<this._maxSimultaneousTextures;e++)this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))},e.prototype.setTexture=function(e,t,n,a){void 0!==e&&(t&&(this._boundUniforms[e]=t),this._setTexture(e,n))},e.prototype._bindSamplerUniformToChannel=function(e,t){var n=this._boundUniforms[e];n&&n._currentState!==t&&(this._gl.uniform1i(n,t),n._currentState=t)},e.prototype._getTextureWrapMode=function(e){switch(e){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT},e.prototype._setTexture=function(e,t,n,a,i){if(void 0===n&&(n=!1),void 0===a&&(a=!1),void 0===i&&(i=""),!t)return null!=this._boundTexturesCache[e]&&(this._activeChannel=e,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(t.video)this._activeChannel=e,t.update();else if(4===t.delayLoadState)return t.delayLoad(),!1;var r;r=a?t.depthStencilTexture:t.isReady()?t.getInternalTexture():t.isCube?this.emptyCubeTexture:t.is3D?this.emptyTexture3D:t.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!n&&r&&(r._associatedChannel=e);var o=!0;this._boundTexturesCache[e]===r&&(n||this._bindSamplerUniformToChannel(r._associatedChannel,e),o=!1),this._activeChannel=e;var s=this._getTextureTarget(r);if(o&&this._bindTextureDirectly(s,r,n),r&&!r.isMultiview){if(r.isCube&&r._cachedCoordinatesMode!==t.coordinatesMode){r._cachedCoordinatesMode=t.coordinatesMode;var c=3!==t.coordinatesMode&&5!==t.coordinatesMode?1:0;t.wrapU=c,t.wrapV=c}r._cachedWrapU!==t.wrapU&&(r._cachedWrapU=t.wrapU,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(t.wrapU),r)),r._cachedWrapV!==t.wrapV&&(r._cachedWrapV=t.wrapV,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(t.wrapV),r)),r.is3D&&r._cachedWrapR!==t.wrapR&&(r._cachedWrapR=t.wrapR,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(t.wrapR),r)),this._setAnisotropicLevel(s,r,t.anisotropicFilteringLevel)}return!0},e.prototype.setTextureArray=function(e,t,n,a){if(void 0!==e&&t){this._textureUnits&&this._textureUnits.length===n.length||(this._textureUnits=new Int32Array(n.length));for(var i=0;i<n.length;i++){var r=n[i].getInternalTexture();r?(this._textureUnits[i]=e+i,r._associatedChannel=e+i):this._textureUnits[i]=-1}this._gl.uniform1iv(t,this._textureUnits);for(var o=0;o<n.length;o++)this._setTexture(this._textureUnits[o],n[o],!0)}},e.prototype._setAnisotropicLevel=function(e,t,n){var a=this._caps.textureAnisotropicFilterExtension;11!==t.samplingMode&&3!==t.samplingMode&&2!==t.samplingMode&&(n=1),a&&t._cachedAnisotropicFilteringLevel!==n&&(this._setTextureParameterFloat(e,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(n,this._caps.maxAnisotropy),t),t._cachedAnisotropicFilteringLevel=n)},e.prototype._setTextureParameterFloat=function(e,t,n,a){this._bindTextureDirectly(e,a,!0,!0),this._gl.texParameterf(e,t,n)},e.prototype._setTextureParameterInteger=function(e,t,n,a){a&&this._bindTextureDirectly(e,a,!0,!0),this._gl.texParameteri(e,t,n)},e.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var e=0;e<this._caps.maxVertexAttribs;e++)this.disableAttributeByIndex(e)}else{e=0;for(var t=this._vertexAttribArraysEnabled.length;e<t;e++)e>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[e]||this.disableAttributeByIndex(e)}},e.prototype.releaseEffects=function(){for(var e in this._compiledEffects){var t=this._compiledEffects[e].getPipelineContext();this._deletePipelineContext(t)}this._compiledEffects={}},e.prototype.dispose=function(){var e;this.stopRenderLoop(),this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.releaseEffects(),null===(e=this.releaseComputeEffects)||void 0===e||e.call(this),this.unbindAllAttributes(),this._boundUniforms=[],$l()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored)),window.removeEventListener("resize",this._checkForMobile)),this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers=[],this._renderingCanvas=null,this._currentProgram=null,this._boundRenderFunction=null,Iu.ResetCache();for(var t=0,n=this._activeRequests;t<n.length;t++)n[t].abort();this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear()},e.prototype.attachContextLostEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",e,!1)},e.prototype.attachContextRestoredEvent=function(e){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",e,!1)},e.prototype.getError=function(){return this._gl.getError()},e.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)},e.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)},e.prototype._canRenderToFramebuffer=function(e){for(var t=this._gl;t.getError()!==t.NO_ERROR;);var n=!0,a=t.createTexture();t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(e),1,1,0,t.RGBA,this._getWebGLTextureType(e),null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST);var i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0);var r=t.checkFramebufferStatus(t.FRAMEBUFFER);if((n=(n=n&&r===t.FRAMEBUFFER_COMPLETE)&&t.getError()===t.NO_ERROR)&&(t.clear(t.COLOR_BUFFER_BIT),n=n&&t.getError()===t.NO_ERROR),n){t.bindFramebuffer(t.FRAMEBUFFER,null);var o=t.RGBA,s=t.UNSIGNED_BYTE,c=new Uint8Array(4);t.readPixels(0,0,1,1,o,s,c),n=n&&t.getError()===t.NO_ERROR}for(t.deleteTexture(a),t.deleteFramebuffer(i),t.bindFramebuffer(t.FRAMEBUFFER,null);!n&&t.getError()!==t.NO_ERROR;);return n},e.prototype._getWebGLTextureType=function(e){if(1===this._webGLVersion){switch(e){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(e){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE},e.prototype._getInternalFormat=function(e,t){void 0===t&&(t=!1);var n=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA;switch(e){case 0:n=this._gl.ALPHA;break;case 1:n=this._gl.LUMINANCE;break;case 2:n=this._gl.LUMINANCE_ALPHA;break;case 6:n=this._gl.RED;break;case 7:n=this._gl.RG;break;case 4:n=t?this._gl.SRGB:this._gl.RGB;break;case 5:n=t?this._gl.SRGB8_ALPHA8:this._gl.RGBA}if(this._webGLVersion>1)switch(e){case 8:n=this._gl.RED_INTEGER;break;case 9:n=this._gl.RG_INTEGER;break;case 10:n=this._gl.RGB_INTEGER;break;case 11:n=this._gl.RGBA_INTEGER}return n},e.prototype._getRGBABufferInternalSizedFormat=function(e,t,n){if(void 0===n&&(n=!1),1===this._webGLVersion){if(void 0!==t)switch(t){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return n?this._gl.SRGB:this._gl.RGB}return this._gl.RGBA}switch(e){case 3:switch(t){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(t){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return n?this._gl.SRGB8:this._gl.RGB8;case 5:return n?this._gl.SRGB8_ALPHA8:this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(t){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;default:return this._gl.RGBA16I}case 5:switch(t){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;default:return this._gl.RGBA16UI}case 6:switch(t){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;default:return this._gl.RGBA32I}case 7:switch(t){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;default:return this._gl.RGBA32UI}case 1:switch(t){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;default:return this._gl.RGBA32F}case 2:switch(t){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:return 11===t?this._gl.RGB10_A2UI:this._gl.RGB10_A2}return n?this._gl.SRGB8_ALPHA8:this._gl.RGBA8},e.prototype._getRGBAMultiSampleBufferFormat=function(e){return 1===e?this._gl.RGBA32F:2===e?this._gl.RGBA16F:this._gl.RGBA8},e.prototype._loadFile=function(t,n,a,i,r,o){var s=this,c=e._FileToolsLoadFile(t,n,a,i,r,o);return this._activeRequests.push(c),c.onCompleteObservable.add(function(e){s._activeRequests.splice(s._activeRequests.indexOf(e),1)}),c},e._FileToolsLoadFile=function(e,t,n,a,i,r){throw gu("FileTools")},e.prototype.readPixels=function(e,t,n,a,i,r){void 0===i&&(i=!0),void 0===r&&(r=!0);var o=i?4:3,s=i?this._gl.RGBA:this._gl.RGB,c=new Uint8Array(a*n*o);return r&&this.flushFramebuffer(),this._gl.readPixels(e,t,n,a,s,this._gl.UNSIGNED_BYTE,c),Promise.resolve(c)},Object.defineProperty(e,"IsSupportedAsync",{get:function(){return Promise.resolve(this.isSupported())},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IsSupported",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0}),e.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var e=this._CreateCanvas(1,1),t=e.getContext("webgl")||e.getContext("experimental-webgl");this._IsSupported=null!=t&&!!window.WebGLRenderingContext}catch(e){this._IsSupported=!1}return this._IsSupported},Object.defineProperty(e,"HasMajorPerformanceCaveat",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var e=this._CreateCanvas(1,1),t=e.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||e.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!t}catch(e){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},enumerable:!1,configurable:!0}),e.CeilingPOT=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},e.FloorPOT=function(e){return e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,(e|=e>>16)-(e>>1)},e.NearestPOT=function(t){var n=e.CeilingPOT(t),a=e.FloorPOT(t);return n-t>t-a?a:n},e.GetExponentOfTwo=function(t,n,a){var i;switch(void 0===a&&(a=2),a){case 1:i=e.FloorPOT(t);break;case 2:i=e.NearestPOT(t);break;default:i=e.CeilingPOT(t)}return Math.min(i,n)},e.QueueNewFrame=function(e,t){return $l()?(t||(t=window),t.requestPostAnimationFrame?t.requestPostAnimationFrame(e):t.requestAnimationFrame?t.requestAnimationFrame(e):t.msRequestAnimationFrame?t.msRequestAnimationFrame(e):t.webkitRequestAnimationFrame?t.webkitRequestAnimationFrame(e):t.mozRequestAnimationFrame?t.mozRequestAnimationFrame(e):t.oRequestAnimationFrame?t.oRequestAnimationFrame(e):window.setTimeout(e,16)):"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(e):setTimeout(e,16)},e.prototype.getHostDocument=function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:document},e.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]}],e._TextureLoaders=[],e.CollisionsEpsilon=.001,e._IsSupported=null,e._HasMajorPerformanceCaveat=null,e}(),Gu=function(e,t){return e?e.getClassName&&"Mesh"===e.getClassName()?null:e.getClassName&&"SubMesh"===e.getClassName()?e.clone(t):e.clone?e.clone():null:null},Ku=function(){function e(){}return e.DeepCopy=function(e,t,n,a){for(var i=function(e){var t=[];do{Object.getOwnPropertyNames(e).forEach(function(e){-1===t.indexOf(e)&&t.push(e)})}while(e=Object.getPrototypeOf(e));return t}(e),r=0,o=i;r<o.length;r++){var s=o[r];if(("_"!==s[0]||a&&-1!==a.indexOf(s))&&(p="Observable",!(-1!==(f=s).indexOf(p,f.length-p.length)||n&&-1!==n.indexOf(s)))){var c=e[s],d=typeof c;if("function"!==d)try{if("object"===d)if(c instanceof Array){if(t[s]=[],c.length>0)if("object"==typeof c[0])for(var l=0;l<c.length;l++){var u=Gu(c[l],t);-1===t[s].indexOf(u)&&t[s].push(u)}else t[s]=c.slice(0)}else t[s]=Gu(c,t);else t[s]=c}catch(e){ou.Warn(e.message)}}}var f,p},e}(),Wu=function(){function e(){}return Object.defineProperty(e,"Now",{get:function(){return ru.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()},enumerable:!1,configurable:!0}),e}(),qu=function(){function e(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}return e.prototype._injectCustomRequestHeaders=function(){for(var t in e.CustomRequestHeaders){var n=e.CustomRequestHeaders[t];n&&this._xhr.setRequestHeader(t,n)}},Object.defineProperty(e.prototype,"onprogress",{get:function(){return this._xhr.onprogress},set:function(e){this._xhr.onprogress=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._xhr.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._xhr.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statusText",{get:function(){return this._xhr.statusText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"response",{get:function(){return this._xhr.response},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseURL",{get:function(){return this._xhr.responseURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseText",{get:function(){return this._xhr.responseText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"responseType",{get:function(){return this._xhr.responseType},set:function(e){this._xhr.responseType=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeout",{get:function(){return this._xhr.timeout},set:function(e){this._xhr.timeout=e},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e,t,n){this._xhr.addEventListener(e,t,n)},e.prototype.removeEventListener=function(e,t,n){this._xhr.removeEventListener(e,t,n)},e.prototype.abort=function(){this._xhr.abort()},e.prototype.send=function(t){e.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(t)},e.prototype.open=function(t,n){for(var a=0,i=e.CustomRequestModifiers;a<i.length;a++)(0,i[a])(this._xhr,n);return n=(n=n.replace("file:http:","http:")).replace("file:https:","https:"),this._xhr.open(t,n,!0)},e.prototype.setRequestHeader=function(e,t){this._xhr.setRequestHeader(e,t)},e.prototype.getResponseHeader=function(e){return this._xhr.getResponseHeader(e)},e.CustomRequestHeaders={},e.CustomRequestModifiers=new Array,e}(),Qu=function(){function e(){}return e.FilesToLoad={},e}(),Yu=function(){function e(){}return e.ExponentialBackoff=function(e,t){return void 0===e&&(e=3),void 0===t&&(t=500),function(n,a,i){return 0!==a.status||i>=e||-1!==n.indexOf("file:")?-1:Math.pow(2,i)*t}},e}(),Ju=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t._setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t}(Error),Xu=function(e){function t(n,a,i){var r=e.call(this,n)||this;return r.errorCode=a,r.innerError=i,r.name="RuntimeError",Ju._setPrototypeOf(r,t.prototype),r}return Object(o.__extends)(t,e),t}(Ju),Zu=function(){function e(){}return e.SetImmediate=function(e){$l()&&window.setImmediate?window.setImmediate(e):setTimeout(e,1)},e}(),$u=new RegExp(/^data:([^,]+\/[^,]+)?;base64,/i),ef=function(e){function t(n,a){var i=e.call(this,n,4e3)||this;return i.name="LoadFileError",Ju._setPrototypeOf(i,t.prototype),a instanceof qu?i.request=a:i.file=a,i}return Object(o.__extends)(t,e),t}(Xu),tf=function(e){function t(n,a){var i=e.call(this,n,4001)||this;return i.request=a,i.name="RequestFileError",Ju._setPrototypeOf(i,t.prototype),i}return Object(o.__extends)(t,e),t}(Xu),nf=function(e){function t(n,a){var i=e.call(this,n,4002)||this;return i.file=a,i.name="ReadFileError",Ju._setPrototypeOf(i,t.prototype),i}return Object(o.__extends)(t,e),t}(Xu),af={DefaultRetryStrategy:Yu.ExponentialBackoff(),BaseUrl:"",CorsBehavior:"anonymous",PreprocessUrl:function(e){return e}},rf=function(e){return e.replace(/#/gm,"%23")},of=function(e,t){if((!e||0!==e.indexOf("data:"))&&af.CorsBehavior)if("string"==typeof af.CorsBehavior||af.CorsBehavior instanceof String)t.crossOrigin=af.CorsBehavior;else{var n=af.CorsBehavior(e);n&&(t.crossOrigin=n)}},sf=function(e,t,n,a,i,r){var s,c;void 0===i&&(i="");var d=!1;e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob?(c=URL.createObjectURL(new Blob([e],{type:i})),d=!0):c="data:".concat(i,";base64,")+function(e){for(var t,n,a,i,r,o,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d="",l=0,u=ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e);l<u.length;)i=(t=u[l++])>>2,r=(3&t)<<4|(n=l<u.length?u[l++]:Number.NaN)>>4,o=(15&n)<<2|(a=l<u.length?u[l++]:Number.NaN)>>6,s=63&a,isNaN(n)?o=s=64:isNaN(a)&&(s=64),d+=c.charAt(i)+c.charAt(r)+c.charAt(o)+c.charAt(s);return d}(e):e instanceof Blob?(c=URL.createObjectURL(e),d=!0):(c=rf(e),c=af.PreprocessUrl(e));var l=Au.LastCreatedEngine,u=function(t){if(n){var a=c||e.toString();n("Error while trying to load image: ".concat(0===a.indexOf("http")||a.length<=128?a:a.slice(0,128)+"..."),t)}};if("undefined"==typeof Image||null!==(s=null==l?void 0:l._features.forceBitmapOverHTMLImageElement)&&void 0!==s&&s)return df(c,function(a){l.createImageBitmap(new Blob([a],{type:i}),Object(o.__assign)({premultiplyAlpha:"none"},r)).then(function(e){t(e),d&&URL.revokeObjectURL(c)}).catch(function(t){n&&n("Error while trying to load image: "+e,t)})},void 0,a||void 0,!0,function(e,t){u(t)}),null;var f=new Image;of(c,f);var p=function(){f.removeEventListener("load",p),f.removeEventListener("error",m),t(f),d&&f.src&&URL.revokeObjectURL(f.src)},m=function(e){f.removeEventListener("load",p),f.removeEventListener("error",m),u(e),d&&f.src&&URL.revokeObjectURL(f.src)};f.addEventListener("load",p),f.addEventListener("error",m);var _=function(){f.src=c};if("blob:"!==c.substr(0,5)&&"data:"!==c.substr(0,5)&&a&&a.enableTexturesOffline)a.open(function(){a&&a.loadImage(c,f)},_);else{if(-1!==c.indexOf("file:")){var h=decodeURIComponent(c.substring(5).toLowerCase());if(Qu.FilesToLoad[h]){try{var b=void 0;try{b=URL.createObjectURL(Qu.FilesToLoad[h])}catch(e){b=URL.createObjectURL(Qu.FilesToLoad[h])}f.src=b,d=!0}catch(e){f.src=""}return f}}_()}return f},cf=function(e,t,n,a,i){var r=new FileReader,o={onCompleteObservable:new Zl,abort:function(){return r.abort()}};return r.onloadend=function(){return o.onCompleteObservable.notifyObservers(o)},i&&(r.onerror=function(){i(new nf("Unable to read ".concat(e.name),e))}),r.onload=function(e){t(e.target.result)},n&&(r.onprogress=n),a?r.readAsArrayBuffer(e):r.readAsText(e),o},df=function(e,t,n,a,i,r,o){if(e.name)return cf(e,t,n,i,r?function(e){r(void 0,e)}:void 0);var s=e;if(-1!==s.indexOf("file:")){var c=decodeURIComponent(s.substring(5).toLowerCase());0===c.indexOf("./")&&(c=c.substring(2));var d=Qu.FilesToLoad[c];if(d)return cf(d,t,n,i,r?function(e){return r(void 0,new ef(e.message,e.file))}:void 0)}if(ff(s)){var l={onCompleteObservable:new Zl,abort:function(){return function(){}}};try{t(i?pf(s):Cf(s))}catch(e){r?r(void 0,e):ou.Error(e.message||"Failed to parse the Data URL")}return Zu.SetImmediate(function(){l.onCompleteObservable.notifyObservers(l)}),l}return lf(s,function(e,n){t(e,n?n.responseURL:void 0)},n,a,i,r?function(e){r(e.request,new ef(e.message,e.request))}:void 0,o)},lf=function(e,t,n,a,i,r,o){e=rf(e),e=af.PreprocessUrl(e);var s=af.BaseUrl+e,c=!1,d={onCompleteObservable:new Zl,abort:function(){return c=!0}},l=function(){var e,a=new qu,l=null,u=function(){a&&(n&&a.removeEventListener("progress",n),e&&a.removeEventListener("readystatechange",e),a.removeEventListener("loadend",f))},f=function(){u(),d.onCompleteObservable.notifyObservers(d),d.onCompleteObservable.clear(),n=void 0,e=null,f=null,r=void 0,o=void 0,t=void 0};d.abort=function(){c=!0,f&&f(),a&&a.readyState!==(XMLHttpRequest.DONE||4)&&a.abort(),null!==l&&(clearTimeout(l),l=null),a=null};var p=function(e){var t=e.message||"Unknown error";r&&a?r(new tf(t,a)):ou.Error(t)},m=function(d){if(a){if(a.open("GET",s),o)try{o(a)}catch(e){return void p(e)}i&&(a.responseType="arraybuffer"),n&&a.addEventListener("progress",n),f&&a.addEventListener("loadend",f),e=function(){if(!c&&a&&a.readyState===(XMLHttpRequest.DONE||4)){if(e&&a.removeEventListener("readystatechange",e),a.status>=200&&a.status<300||0===a.status&&(!$l()||uf())){try{t&&t(i?a.response:a.responseText,a)}catch(e){p(e)}return}var n=af.DefaultRetryStrategy;if(n){var o=n(s,a,d);if(-1!==o)return u(),a=new qu,void(l=setTimeout(function(){return m(d+1)},o))}var f=new tf("Error status: "+a.status+" "+a.statusText+" - Unable to load "+s,a);r&&r(f)}},a.addEventListener("readystatechange",e),a.send()}};m(0)};if(a&&a.enableSceneOffline){var u=function(e){e&&e.status>400?r&&r(e):l()};a.open(function(){a&&a.loadFile(af.BaseUrl+e,function(e){!c&&t&&t(e),d.onCompleteObservable.notifyObservers(d)},n?function(e){!c&&n&&n(e)}:void 0,u,i)},u)}else l();return d},uf=function(){return"undefined"!=typeof location&&"file:"===location.protocol},ff=function(e){return $u.test(e)};function pf(e){return function(e){for(var t=cu(e),n=t.length,a=new Uint8Array(new ArrayBuffer(n)),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a.buffer}(e.split(",")[1])}var mf,_f,hf,bf,gf,vf,yf,Sf,Df,If,xf,Cf=function(e){return cu(e.split(",")[1])};zu._FileToolsLoadImage=sf,zu._FileToolsLoadFile=df,Su._FileToolsLoadFile=df,hf=ff,bf=uf,gf=df,vf=sf,yf=cf,Sf=lf,Df=of,mf={DecodeBase64UrlToBinary:pf,DecodeBase64UrlToString:Cf,DefaultRetryStrategy:(_f=af).DefaultRetryStrategy,BaseUrl:_f.BaseUrl,CorsBehavior:_f.CorsBehavior,PreprocessUrl:_f.PreprocessUrl,IsBase64DataUrl:hf,IsFileURL:bf,LoadFile:gf,LoadImage:vf,ReadFile:yf,RequestFile:Sf,SetCorsBehavior:Df},Object.defineProperty(mf,"DefaultRetryStrategy",{get:function(){return _f.DefaultRetryStrategy},set:function(e){_f.DefaultRetryStrategy=e}}),Object.defineProperty(mf,"BaseUrl",{get:function(){return _f.BaseUrl},set:function(e){_f.BaseUrl=e}}),Object.defineProperty(mf,"PreprocessUrl",{get:function(){return _f.PreprocessUrl},set:function(e){_f.PreprocessUrl=e}}),Object.defineProperty(mf,"CorsBehavior",{get:function(){return _f.CorsBehavior},set:function(e){_f.CorsBehavior=e}}),(xf=If||(If={}))[xf.Pending=0]="Pending",xf[xf.Fulfilled=1]="Fulfilled",xf[xf.Rejected=2]="Rejected";var Of=function(){this.count=0,this.target=0,this.results=[]},wf=function(){function e(e){var t=this;if(this._state=If.Pending,this._children=new Array,this._rejectWasConsumed=!1,e)try{e(function(e){t._resolve(e)},function(e){t._reject(e)})}catch(e){this._reject(e)}}return Object.defineProperty(e.prototype,"_result",{get:function(){return this._resultValue},set:function(e){this._resultValue=e,this._parent&&void 0===this._parent._result&&(this._parent._result=e)},enumerable:!1,configurable:!0}),e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype.then=function(t,n){var a=this,i=new e;return i._onFulfilled=t,i._onRejected=n,this._children.push(i),i._parent=this,this._state!==If.Pending&&setTimeout(function(){a._state===If.Fulfilled||a._rejectWasConsumed?i._resolve(a._result):i._reject(a._reason)}),i},e.prototype._moveChildren=function(e){var t,n=this;if((t=this._children).push.apply(t,e.splice(0,e.length)),this._children.forEach(function(e){e._parent=n}),this._state===If.Fulfilled)for(var a=0,i=this._children;a<i.length;a++)i[a]._resolve(this._result);else if(this._state===If.Rejected)for(var r=0,o=this._children;r<o.length;r++)o[r]._reject(this._reason)},e.prototype._resolve=function(e){try{this._state=If.Fulfilled;var t=null;if(this._onFulfilled&&(t=this._onFulfilled(e)),null!=t)if(void 0!==t._state){var n=t;n._parent=this,n._moveChildren(this._children),e=n._result}else e=t;this._result=e;for(var a=0,i=this._children;a<i.length;a++)i[a]._resolve(e);this._children.length=0,delete this._onFulfilled,delete this._onRejected}catch(e){this._reject(e,!0)}},e.prototype._reject=function(e,t){if(void 0===t&&(t=!1),this._state=If.Rejected,this._reason=e,this._onRejected&&!t)try{this._onRejected(e),this._rejectWasConsumed=!0}catch(t){e=t}for(var n=0,a=this._children;n<a.length;n++){var i=a[n];this._rejectWasConsumed?i._resolve(null):i._reject(e)}this._children.length=0,delete this._onFulfilled,delete this._onRejected},e.resolve=function(t){var n=new e;return n._resolve(t),n},e._RegisterForFulfillment=function(e,t,n){e.then(function(e){return t.results[n]=e,t.count++,t.count===t.target&&t.rootPromise._resolve(t.results),null},function(e){t.rootPromise._state!==If.Rejected&&t.rootPromise._reject(e)})},e.all=function(t){var n=new e,a=new Of;if(a.target=t.length,a.rootPromise=n,t.length)for(var i=0;i<t.length;i++)e._RegisterForFulfillment(t[i],a,i);else n._resolve([]);return n},e.race=function(t){var n=new e;if(t.length)for(var a=0,i=t;a<i.length;a++)i[a].then(function(e){return n&&(n._resolve(e),n=null),null},function(e){n&&(n._reject(e),n=null)});return n},e}(),Ef=function(){function e(){}return e.Apply=function(e){void 0===e&&(e=!1),(e||"undefined"==typeof Promise)&&(window.Promise=wf)},e}(),Af={},Lf=function(){function e(){}return e.Instantiate=function(e){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[e])return this.RegisteredExternalClasses[e];var t=Af[e];if(t)return t;ou.Warn(e+" not found, you may have missed an import.");for(var n=e.split("."),a=window||this,i=0,r=n.length;i<r;i++)a=a[n[i]];return"function"!=typeof a?null:a},e.RegisteredExternalClasses={},e}(),kf=function(){function e(){}return Object.defineProperty(e,"BaseUrl",{get:function(){return af.BaseUrl},set:function(e){af.BaseUrl=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DefaultRetryStrategy",{get:function(){return af.DefaultRetryStrategy},set:function(e){af.DefaultRetryStrategy=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"CorsBehavior",{get:function(){return af.CorsBehavior},set:function(e){af.CorsBehavior=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UseFallbackTexture",{get:function(){return Au.UseFallbackTexture},set:function(e){Au.UseFallbackTexture=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"RegisteredExternalClasses",{get:function(){return Lf.RegisteredExternalClasses},set:function(e){Lf.RegisteredExternalClasses=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"fallbackTexture",{get:function(){return Au.FallbackTexture},set:function(e){Au.FallbackTexture=e},enumerable:!1,configurable:!0}),e.FetchToRef=function(e,t,n,a,i,r){var o=4*((Math.abs(e)*n%n|0)+(Math.abs(t)*a%a|0)*n);r.r=i[o]/255,r.g=i[o+1]/255,r.b=i[o+2]/255,r.a=i[o+3]/255},e.Mix=function(e,t,n){return e*(1-n)+t*n},e.Instantiate=function(e){return Lf.Instantiate(e)},e.Slice=function(e,t,n){return Wl.Slice(e,t,n)},e.SliceToArray=function(e,t,n){return Wl.SliceToArray(e,t,n)},e.SetImmediate=function(e){Zu.SetImmediate(e)},e.IsExponentOfTwo=function(e){var t=1;do{t*=2}while(t<e);return t===e},e.FloatRound=function(t){return Math.fround?Math.fround(t):(e._TmpFloatArray[0]=t,e._TmpFloatArray[0])},e.GetFilename=function(e){var t=e.lastIndexOf("/");return t<0?e:e.substring(t+1)},e.GetFolderPath=function(e,t){void 0===t&&(t=!1);var n=e.lastIndexOf("/");return n<0?t?e:"":e.substring(0,n+1)},e.ToDegrees=function(e){return 180*e/Math.PI},e.ToRadians=function(e){return e*Math.PI/180},e.MakeArray=function(e,t){return!0===t||void 0!==e&&null!=e?Array.isArray(e)?e:[e]:null},e.GetPointerPrefix=function(e){var t="pointer";return $l()&&!window.PointerEvent&&(t="mouse"),!e._badDesktopOS||e._badOS||document&&"ontouchend"in document||(t="mouse"),t},e.SetCorsBehavior=function(e,t){of(e,t)},e.CleanUrl=function(e){return e.replace(/#/gm,"%23")},Object.defineProperty(e,"PreprocessUrl",{get:function(){return af.PreprocessUrl},set:function(e){af.PreprocessUrl=e},enumerable:!1,configurable:!0}),e.LoadImage=function(e,t,n,a,i,r){return sf(e,t,n,a,i,r)},e.LoadFile=function(e,t,n,a,i,r){return df(e,t,n,a,i,r)},e.LoadFileAsync=function(e,t){return void 0===t&&(t=!0),new Promise(function(n,a){df(e,function(e){n(e)},void 0,void 0,t,function(e,t){a(t)})})},e.LoadScript=function(e,t,n,a){if($l()){var i=document.getElementsByTagName("head")[0],r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e),a&&(r.id=a),r.onload=function(){t&&t()},r.onerror=function(t){n&&n("Unable to load script '".concat(e,"'"),t)},i.appendChild(r)}},e.LoadScriptAsync=function(e){var t=this;return new Promise(function(n,a){t.LoadScript(e,function(){n()},function(e,t){a(t)})})},e.ReadFileAsDataURL=function(e,t,n){var a=new FileReader,i={onCompleteObservable:new Zl,abort:function(){return a.abort()}};return a.onloadend=function(){i.onCompleteObservable.notifyObservers(i)},a.onload=function(e){t(e.target.result)},a.onprogress=n,a.readAsDataURL(e),i},e.ReadFile=function(e,t,n,a,i){return cf(e,t,n,a,i)},e.FileAsURL=function(e){var t=new Blob([e]);return(window.URL||window.webkitURL).createObjectURL(t)},e.Format=function(e,t){return void 0===t&&(t=2),e.toFixed(t)},e.DeepCopy=function(e,t,n,a){Ku.DeepCopy(e,t,n,a)},e.IsEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},e.RegisterTopRootEvents=function(e,t){for(var n=0;n<t.length;n++){var a=t[n];e.addEventListener(a.name,a.handler,!1);try{window.parent&&window.parent.addEventListener(a.name,a.handler,!1)}catch(e){}}},e.UnregisterTopRootEvents=function(e,t){for(var n=0;n<t.length;n++){var a=t[n];e.removeEventListener(a.name,a.handler);try{e.parent&&e.parent.removeEventListener(a.name,a.handler)}catch(e){}}},e.DumpFramebuffer=function(t,n,a,i,r,s){return void 0===r&&(r="image/png"),Object(o.__awaiter)(this,void 0,void 0,function(){var c,d;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return[4,a.readPixels(0,0,t,n)];case 1:return c=o.sent(),d=new Uint8Array(c.buffer),e.DumpData(t,n,d,i,r,s,!0),[2]}})})},e.DumpData=function(t,n,a,i,r,o,s,c,d){void 0===r&&(r="image/png"),void 0===s&&(s=!1),void 0===c&&(c=!1),e._ScreenshotCanvas||(e._ScreenshotCanvas=document.createElement("canvas")),e._ScreenshotCanvas.width=t,e._ScreenshotCanvas.height=n;var l=e._ScreenshotCanvas.getContext("2d");if(l){if(a instanceof Float32Array){for(var u=new Uint8Array(a.length),f=a.length;f--;){var p=a[f];u[f]=p<0?0:p>1?1:Math.round(255*p)}a=u}var m=l.createImageData(t,n);m.data.set(a),l.putImageData(m,0,0);var _=e._ScreenshotCanvas;if(s){var h=document.createElement("canvas");h.width=t,h.height=n;var b=h.getContext("2d");if(!b)return;b.translate(0,n),b.scale(1,-1),b.drawImage(e._ScreenshotCanvas,0,0),_=h}c?e.ToBlob(_,function(e){var t=new FileReader;t.onload=function(e){var t=e.target.result;i&&i(t)},t.readAsArrayBuffer(e)},r,d):e.EncodeScreenshotCanvasData(i,r,o,_,d)}},e.DumpDataAsync=function(t,n,a,i,r,o,s,c){return void 0===i&&(i="image/png"),void 0===o&&(o=!1),void 0===s&&(s=!1),new Promise(function(d){e.DumpData(t,n,a,function(e){return d(e)},i,r,o,s,c)})},e.ToBlob=function(e,t,n,a){void 0===n&&(n="image/png"),e.toBlob||(e.toBlob=function(e,t,n){var a=this;setTimeout(function(){for(var i=atob(a.toDataURL(t,n).split(",")[1]),r=i.length,o=new Uint8Array(r),s=0;s<r;s++)o[s]=i.charCodeAt(s);e(new Blob([o]))})}),e.toBlob(function(e){t(e)},n,a)},e.EncodeScreenshotCanvasData=function(t,n,a,i,r){void 0===n&&(n="image/png"),t?t((null!=i?i:e._ScreenshotCanvas).toDataURL(n,r)):this.ToBlob(null!=i?i:e._ScreenshotCanvas,function(t){if("download"in document.createElement("a")){if(!a){var n=new Date,i=(n.getFullYear()+"-"+(n.getMonth()+1)).slice(2)+"-"+n.getDate()+"_"+n.getHours()+"-"+("0"+n.getMinutes()).slice(-2);a="screenshot_"+i+".png"}e.Download(t,a)}else if(t){var r=URL.createObjectURL(t),o=window.open("");if(!o)return;var s=o.document.createElement("img");s.onload=function(){URL.revokeObjectURL(r)},s.src=r,o.document.body.appendChild(s)}},n,r)},e.Download=function(e,t){if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(e,t);else{var n=window.URL.createObjectURL(e),a=document.createElement("a");document.body.appendChild(a),a.style.display="none",a.href=n,a.download=t,a.addEventListener("click",function(){a.parentElement&&a.parentElement.removeChild(a)}),a.click(),window.URL.revokeObjectURL(n)}},e.BackCompatCameraNoPreventDefault=function(e){return"boolean"==typeof e[0]?e[0]:"boolean"==typeof e[1]&&e[1]},e.CreateScreenshot=function(e,t,n,a,i){throw void 0===i&&(i="image/png"),gu("ScreenshotTools")},e.CreateScreenshotAsync=function(e,t,n,a){throw void 0===a&&(a="image/png"),gu("ScreenshotTools")},e.CreateScreenshotUsingRenderTarget=function(e,t,n,a,i,r,o,s){throw void 0===i&&(i="image/png"),void 0===r&&(r=1),void 0===o&&(o=!1),gu("ScreenshotTools")},e.CreateScreenshotUsingRenderTargetAsync=function(e,t,n,a,i,r,o){throw void 0===a&&(a="image/png"),void 0===i&&(i=1),void 0===r&&(r=!1),gu("ScreenshotTools")},e.RandomId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e.IsBase64=function(e){return ff(e)},e.DecodeBase64=function(e){return pf(e)},Object.defineProperty(e,"errorsCount",{get:function(){return ou.errorsCount},enumerable:!1,configurable:!0}),e.Log=function(e){ou.Log(e)},e.Warn=function(e){ou.Warn(e)},e.Error=function(e){ou.Error(e)},Object.defineProperty(e,"LogCache",{get:function(){return ou.LogCache},enumerable:!1,configurable:!0}),e.ClearLogCache=function(){ou.ClearLogCache()},Object.defineProperty(e,"LogLevels",{set:function(e){ou.LogLevels=e},enumerable:!1,configurable:!0}),Object.defineProperty(e,"PerformanceLogLevel",{set:function(t){return(t&e.PerformanceUserMarkLogLevel)===e.PerformanceUserMarkLogLevel?(e.StartPerformanceCounter=e._StartUserMark,void(e.EndPerformanceCounter=e._EndUserMark)):(t&e.PerformanceConsoleLogLevel)===e.PerformanceConsoleLogLevel?(e.StartPerformanceCounter=e._StartPerformanceConsole,void(e.EndPerformanceCounter=e._EndPerformanceConsole)):(e.StartPerformanceCounter=e._StartPerformanceCounterDisabled,void(e.EndPerformanceCounter=e._EndPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),e._StartPerformanceCounterDisabled=function(e,t){},e._EndPerformanceCounterDisabled=function(e,t){},e._StartUserMark=function(t,n){if(void 0===n&&(n=!0),!e._Performance){if(!$l())return;e._Performance=window.performance}n&&e._Performance.mark&&e._Performance.mark(t+"-Begin")},e._EndUserMark=function(t,n){void 0===n&&(n=!0),n&&e._Performance.mark&&(e._Performance.mark(t+"-End"),e._Performance.measure(t,t+"-Begin",t+"-End"))},e._StartPerformanceConsole=function(t,n){void 0===n&&(n=!0),n&&(e._StartUserMark(t,n),console.time&&console.time(t))},e._EndPerformanceConsole=function(t,n){void 0===n&&(n=!0),n&&(e._EndUserMark(t,n),console.timeEnd(t))},Object.defineProperty(e,"Now",{get:function(){return Wu.Now},enumerable:!1,configurable:!0}),e.GetClassName=function(e,t){void 0===t&&(t=!1);var n=null;return!t&&e.getClassName?n=e.getClassName():(e instanceof Object&&(n=(t?e:Object.getPrototypeOf(e)).constructor.__bjsclassName__),n||(n=typeof e)),n},e.First=function(e,t){for(var n=0,a=e;n<a.length;n++){var i=a[n];if(t(i))return i}return null},e.getFullClassName=function(e,t){void 0===t&&(t=!1);var n=null,a=null;if(!t&&e.getClassName)n=e.getClassName();else{if(e instanceof Object){var i=t?e:Object.getPrototypeOf(e);n=i.constructor.__bjsclassName__,a=i.constructor.__bjsmoduleName__}n||(n=typeof e)}return n?(null!=a?a+".":"")+n:null},e.DelayAsync=function(e){return new Promise(function(t){setTimeout(function(){t()},e)})},e.IsSafari=function(){return!!eu()&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},e.UseCustomRequestHeaders=!1,e.CustomRequestHeaders=qu.CustomRequestHeaders,e._TmpFloatArray=new Float32Array(1),e.GetDOMTextContent=nu,e.GetAbsoluteUrl="object"==typeof document?function(e){var t=document.createElement("a");return t.href=e,t.href}:"function"==typeof URL&&"object"==typeof location?function(e){return new URL(e,location.origin).href}:function(){throw new Error("Unable to get absolute URL. Override BABYLON.Tools.GetAbsoluteUrl to a custom implementation for the current context.")},e.NoneLogLevel=ou.NoneLogLevel,e.MessageLogLevel=ou.MessageLogLevel,e.WarningLogLevel=ou.WarningLogLevel,e.ErrorLogLevel=ou.ErrorLogLevel,e.AllLogLevel=ou.AllLogLevel,e.IsWindowObjectExist=$l,e.PerformanceNoneLogLevel=0,e.PerformanceUserMarkLogLevel=1,e.PerformanceConsoleLogLevel=2,e.StartPerformanceCounter=e._StartPerformanceCounterDisabled,e.EndPerformanceCounter=e._EndPerformanceCounterDisabled,e}();function Mf(e,t,n,a){var i,r=1;1===a?i=new Float32Array(t*n*4):2===a?(i=new Uint16Array(t*n*4),r=15360):i=7===a?new Uint32Array(t*n*4):new Uint8Array(t*n*4);for(var o=0;o<t;o++)for(var s=0;s<n;s++){var c=3*(s*t+o),d=4*(s*t+o);i[d+0]=e[c+0],i[d+1]=e[c+1],i[d+2]=e[c+2],i[d+3]=r}return i}function Pf(e){return function(t,n,a,i,r,o,s,c,d,l){void 0===d&&(d=null),void 0===l&&(l=0);var u=e?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,f=e?Cu.Raw3D:Cu.Raw2DArray,p=new Tu(this,f);p.baseWidth=n,p.baseHeight=a,p.baseDepth=i,p.width=n,p.height=a,p.depth=i,p.format=r,p.type=l,p.generateMipMaps=o,p.samplingMode=c,e?p.is3D=!0:p.is2DArray=!0,this._doNotHandleContextLost||(p._bufferView=t),e?this.updateRawTexture3D(p,t,r,s,d,l):this.updateRawTexture2DArray(p,t,r,s,d,l),this._bindTextureDirectly(u,p,!0);var m=this._getSamplingParameters(c,o);return this._gl.texParameteri(u,this._gl.TEXTURE_MAG_FILTER,m.mag),this._gl.texParameteri(u,this._gl.TEXTURE_MIN_FILTER,m.min),o&&this._gl.generateMipmap(u),this._bindTextureDirectly(u,null),this._internalTexturesCache.push(p),p}}function Tf(e){return function(t,n,a,i,r,o){void 0===r&&(r=null),void 0===o&&(o=0);var s=e?this._gl.TEXTURE_3D:this._gl.TEXTURE_2D_ARRAY,c=this._getWebGLTextureType(o),d=this._getInternalFormat(a),l=this._getRGBABufferInternalSizedFormat(o,a);this._bindTextureDirectly(s,t,!0),this._unpackFlipY(void 0===i||!!i),this._doNotHandleContextLost||(t._bufferView=n,t.format=a,t.invertY=i,t._compression=r),t.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),r&&n?this._gl.compressedTexImage3D(s,0,this.getCaps().s3tc[r],t.width,t.height,t.depth,0,n):this._gl.texImage3D(s,0,l,t.width,t.height,t.depth,0,d,c,n),t.generateMipMaps&&this._gl.generateMipmap(s),this._bindTextureDirectly(s,null),t.isReady=!0}}!function(){function e(e,t,n,a){void 0===a&&(a=0),this.iterations=e,this.index=a-1,this._done=!1,this._fn=t,this._successCallback=n}e.prototype.executeNext=function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())},e.prototype.breakLoop=function(){this._done=!0,this._successCallback()},e.Run=function(t,n,a,i){void 0===i&&(i=0);var r=new e(t,n,a,i);return r.executeNext(),r},e.SyncAsyncForLoop=function(t,n,a,i,r,o){return void 0===o&&(o=0),e.Run(Math.ceil(t/n),function(e){r&&r()?e.breakLoop():setTimeout(function(){for(var i=0;i<n;++i){var o=e.index*n+i;if(o>=t)break;if(a(o),r&&r()){e.breakLoop();break}}e.executeNext()},o)},i)}}(),Au.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z",Ef.Apply(),zu.prototype.updateRawTexture=function(e,t,n,a,i,r){if(void 0===i&&(i=null),void 0===r&&(r=0),e){var o=this._getRGBABufferInternalSizedFormat(r,n),s=this._getInternalFormat(n),c=this._getWebGLTextureType(r);this._bindTextureDirectly(this._gl.TEXTURE_2D,e,!0),this._unpackFlipY(void 0===a||!!a),this._doNotHandleContextLost||(e._bufferView=t,e.format=n,e.type=r,e.invertY=a,e._compression=i),e.width%4!=0&&this._gl.pixelStorei(this._gl.UNPACK_ALIGNMENT,1),i&&t?this._gl.compressedTexImage2D(this._gl.TEXTURE_2D,0,this.getCaps().s3tc[i],e.width,e.height,0,t):this._gl.texImage2D(this._gl.TEXTURE_2D,0,o,e.width,e.height,0,s,c,t),e.generateMipMaps&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),e.isReady=!0}},zu.prototype.createRawTexture=function(e,t,n,a,i,r,o,s,c,d){void 0===s&&(s=null),void 0===c&&(c=0),void 0===d&&(d=0);var l=new Tu(this,Cu.Raw);l.baseWidth=t,l.baseHeight=n,l.width=t,l.height=n,l.format=a,l.generateMipMaps=i,l.samplingMode=o,l.invertY=r,l._compression=s,l.type=c,this._doNotHandleContextLost||(l._bufferView=e),this.updateRawTexture(l,e,a,r,s,c),this._bindTextureDirectly(this._gl.TEXTURE_2D,l,!0);var u=this._getSamplingParameters(o,i);return this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,u.mag),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,u.min),i&&this._gl.generateMipmap(this._gl.TEXTURE_2D),this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._internalTexturesCache.push(l),l},zu.prototype.createRawCubeTexture=function(e,t,n,a,i,r,o,s){void 0===s&&(s=null);var c=this._gl,d=new Tu(this,Cu.CubeRaw);d.isCube=!0,d.format=n,d.type=a,this._doNotHandleContextLost||(d._bufferViewArray=e);var l=this._getWebGLTextureType(a),u=this._getInternalFormat(n);u===c.RGB&&(u=c.RGBA),l!==c.FLOAT||this._caps.textureFloatLinearFiltering?l!==this._gl.HALF_FLOAT_OES||this._caps.textureHalfFloatLinearFiltering?l!==c.FLOAT||this._caps.textureFloatRender?l!==c.HALF_FLOAT||this._caps.colorBufferFloat||(i=!1,ou.Warn("Render to half float textures is not supported. Mipmap generation forced to false.")):(i=!1,ou.Warn("Render to float textures is not supported. Mipmap generation forced to false.")):(i=!1,o=1,ou.Warn("Half float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively.")):(i=!1,o=1,ou.Warn("Float texture filtering is not supported. Mipmap generation and sampling mode are forced to false and TEXTURE_NEAREST_SAMPLINGMODE, respectively."));var f=t,p=f;d.width=f,d.height=p,!this.needPOTTextures||kf.IsExponentOfTwo(d.width)&&kf.IsExponentOfTwo(d.height)||(i=!1),e&&this.updateRawCubeTexture(d,e,n,a,r,s),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,d,!0),e&&i&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP);var m=this._getSamplingParameters(o,i);return c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MAG_FILTER,m.mag),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_MIN_FILTER,m.min),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_CUBE_MAP,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),this._bindTextureDirectly(c.TEXTURE_CUBE_MAP,null),d.generateMipMaps=i,d.samplingMode=o,d},zu.prototype.updateRawCubeTexture=function(e,t,n,a,i,r,o){void 0===r&&(r=null),void 0===o&&(o=0),e._bufferViewArray=t,e.format=n,e.type=a,e.invertY=i,e._compression=r;var s=this._gl,c=this._getWebGLTextureType(a),d=this._getInternalFormat(n),l=this._getRGBABufferInternalSizedFormat(a),u=!1;d===s.RGB&&(d=s.RGBA,u=!0),this._bindTextureDirectly(s.TEXTURE_CUBE_MAP,e,!0),this._unpackFlipY(void 0===i||!!i),e.width%4!=0&&s.pixelStorei(s.UNPACK_ALIGNMENT,1);for(var f=0;f<6;f++){var p=t[f];r?s.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+f,o,this.getCaps().s3tc[r],e.width,e.height,0,p):(u&&(p=Mf(p,e.width,e.height,a)),s.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+f,o,l,e.width,e.height,0,d,c,p))}(!this.needPOTTextures||kf.IsExponentOfTwo(e.width)&&kf.IsExponentOfTwo(e.height))&&e.generateMipMaps&&0===o&&this._gl.generateMipmap(this._gl.TEXTURE_CUBE_MAP),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),e.isReady=!0},zu.prototype.createRawCubeTextureFromUrl=function(e,t,n,a,i,r,o,s,c,d,l,u){var f=this;void 0===c&&(c=null),void 0===d&&(d=null),void 0===l&&(l=3),void 0===u&&(u=!1);var p=this._gl,m=this.createRawCubeTexture(null,n,a,i,!r,u,l,null);return null==t||t._addPendingData(m),m.url=e,this._internalTexturesCache.push(m),this._loadFile(e,function(e){!function(e){var n=m.width,r=o(e);if(r){if(s){var d=f._getWebGLTextureType(i),l=f._getInternalFormat(a),_=f._getRGBABufferInternalSizedFormat(i),h=!1;l===p.RGB&&(l=p.RGBA,h=!0),f._bindTextureDirectly(p.TEXTURE_CUBE_MAP,m,!0),f._unpackFlipY(!1);for(var b=s(r),g=0;g<b.length;g++)for(var v=n>>g,y=0;y<6;y++){var S=b[g][y];h&&(S=Mf(S,v,v,i)),p.texImage2D(y,g,_,v,v,0,l,d,S)}f._bindTextureDirectly(p.TEXTURE_CUBE_MAP,null)}else f.updateRawCubeTexture(m,r,a,i,u);m.isReady=!0,null==t||t._removePendingData(m),c&&c()}}(e)},void 0,null==t?void 0:t.offlineProvider,!0,function(e,n){null==t||t._removePendingData(m),d&&e&&d(e.status+" "+e.statusText,n)}),m},zu.prototype.createRawTexture2DArray=Pf(!1),zu.prototype.createRawTexture3D=Pf(!0),zu.prototype.updateRawTexture2DArray=Tf(!1),zu.prototype.updateRawTexture3D=Tf(!0),zu.prototype.setAlphaConstants=function(e,t,n,a){this._alphaState.setAlphaBlendConstants(e,t,n,a)},zu.prototype.setAlphaMode=function(e,t){if(void 0===t&&(t=!1),this._alphaMode!==e){switch(e){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 17:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0}t||(this.depthCullingState.depthMask=0===e),this._alphaMode=e}},zu.prototype.getAlphaMode=function(){return this._alphaMode},zu.prototype.setAlphaEquation=function(e){if(this._alphaEquation!==e){switch(e){case 0:this._alphaState.setAlphaEquationParameters(32774,32774);break;case 1:this._alphaState.setAlphaEquationParameters(32778,32778);break;case 2:this._alphaState.setAlphaEquationParameters(32779,32779);break;case 3:this._alphaState.setAlphaEquationParameters(32776,32776);break;case 4:this._alphaState.setAlphaEquationParameters(32775,32775);break;case 5:this._alphaState.setAlphaEquationParameters(32775,32774)}this._alphaEquation=e}},zu.prototype.getAlphaEquation=function(){return this._alphaEquation},zu.prototype.updateDynamicIndexBuffer=function(e,t,n){var a;void 0===n&&(n=0),this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(e),a=t instanceof Uint16Array||t instanceof Uint32Array?t:e.is32Bits?new Uint32Array(t):new Uint16Array(t),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,a,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},zu.prototype.updateDynamicVertexBuffer=function(e,t,n,a){this.bindArrayBuffer(e),void 0===n&&(n=0);var i=t.byteLength||t.length;void 0===a||a>=i&&0===n?t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,new Float32Array(t)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,n,t):t instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(t).subarray(n,n+a)):(t=t instanceof ArrayBuffer?new Uint8Array(t,n,a):new Uint8Array(t.buffer,t.byteOffset+n,a),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)),this._resetVertexBufferBinding()},zu.prototype.createDynamicTexture=function(e,t,n,a){var i=new Tu(this,Cu.Dynamic);return i.baseWidth=e,i.baseHeight=t,n&&(e=this.needPOTTextures?zu.GetExponentOfTwo(e,this._caps.maxTextureSize):e,t=this.needPOTTextures?zu.GetExponentOfTwo(t,this._caps.maxTextureSize):t),i.width=e,i.height=t,i.isReady=!1,i.generateMipMaps=n,i.samplingMode=a,this.updateTextureSamplingMode(a,i),this._internalTexturesCache.push(i),i},zu.prototype.updateDynamicTexture=function(e,t,n,a,i,r,o){if(void 0===a&&(a=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),e){var s=this._gl,c=s.TEXTURE_2D,d=this._bindTextureDirectly(c,e,!0,r);this._unpackFlipY(void 0===n?e.invertY:n),a&&s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);var l=this._getWebGLTextureType(e.type),u=this._getInternalFormat(i||e.format),f=this._getRGBABufferInternalSizedFormat(e.type,u);s.texImage2D(c,0,f,u,l,t),e.generateMipMaps&&s.generateMipmap(c),d||this._bindTextureDirectly(c,null),a&&s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),e.isReady=!0}},zu.prototype._readTexturePixelsSync=function(e,t,n,a,i,r,o,s,c,d){var l,u;void 0===a&&(a=-1),void 0===i&&(i=0),void 0===r&&(r=null),void 0===o&&(o=!0),void 0===s&&(s=!1),void 0===c&&(c=0),void 0===d&&(d=0);var f=this._gl;if(!f)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){var p=f.createFramebuffer();if(!p)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=p}f.bindFramebuffer(f.FRAMEBUFFER,this._dummyFramebuffer),a>-1?f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+a,null===(l=e._hardwareTexture)||void 0===l?void 0:l.underlyingResource,i):f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,null===(u=e._hardwareTexture)||void 0===u?void 0:u.underlyingResource,i);var m=void 0!==e.type?this._getWebGLTextureType(e.type):f.UNSIGNED_BYTE;return s?r||(r=function(e,t,n,a){switch(void 0===n&&(n=!1),e){case 3:return ArrayBuffer,new Int8Array(t);case 0:return ArrayBuffer,new Uint8Array(t);case 4:return t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(n?t/2:t);case 5:case 8:case 9:case 10:case 2:return t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(n?t/2:t);case 6:return t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(n?t/4:t);case 7:case 11:case 12:case 13:case 14:case 15:return t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(n?t/4:t);case 1:return t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(n?t/4:t)}return ArrayBuffer,new Uint8Array(t)}(e.type,4*t*n)):m===f.UNSIGNED_BYTE?(r||(r=new Uint8Array(4*t*n)),m=f.UNSIGNED_BYTE):(r||(r=new Float32Array(4*t*n)),m=f.FLOAT),o&&this.flushFramebuffer(),f.readPixels(c,d,t,n,f.RGBA,m,r),f.bindFramebuffer(f.FRAMEBUFFER,this._currentFramebuffer),r},zu.prototype._readTexturePixels=function(e,t,n,a,i,r,o,s,c,d){return void 0===a&&(a=-1),void 0===i&&(i=0),void 0===r&&(r=null),void 0===o&&(o=!0),void 0===s&&(s=!1),void 0===c&&(c=0),void 0===d&&(d=0),Promise.resolve(this._readTexturePixelsSync(e,t,n,a,i,r,o,s,c,d))};var Uf="u_FillColor",Ff="a_VerticesData",Hf={name:"VertexListRender",attributeNames:[Ff],uniformNames:[Uf],vertexShader:"\n  attribute vec2 ".concat(Ff,";\n  void main(void) {\n      gl_Position = vec4(").concat(Ff,".xy, 0., 1.);\n  }"),fragmentShader:"\n  uniform vec4 ".concat(Uf,";\n  void main(void) {\n      gl_FragColor = ").concat(Uf,";\n  }")},Rf=function(e){var t=e.transform,n=e.canvasSize,a=e.zIndex,i=Rl($().palette.neutralDark),r=function(e,t,n){var a=Object(s.useState)(),i=a[0],r=a[1],o=Object(s.useState)(),c=o[0],d=o[1],l=Object(s.useMemo)(function(){return new Float32Array(8)},[4]),u=Object(s.useContext)(gl).engine,f=vl(Hf);return Object(s.useEffect)(function(){var e,t=new Float32Array(8);if(u&&f){var n=((e={}).a_VerticesData=new Ql(u,t,Ff,!0,!1,2,!1),e);if(u.webGLVersion>=2){var a=u.recordVertexArrayObject(n,null,f.effect);return u.bindVertexArrayObject(a,null),d(a),r(n),function(){u.releaseVertexArrayObject(a),n.a_VerticesData.dispose()}}return u.bindBuffers(n,null,f.effect),r(n),function(){n.a_VerticesData.dispose()}}},[u,f,4]),[Object(s.useCallback)(function(e){l.set(e)},[l]),Object(s.useCallback)(function(){if(u&&f&&i&&l){var t=f.effect;u.enableEffect(t),i.a_VerticesData.update(l),c?u.bindVertexArrayObject(c,null):u.bindBuffers(i,null,f.effect),t.setFloat4.apply(t,function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([Uf],n,!1)),u.drawArraysType(e,0,4)}},[u,f,l,e,4,i,c,n])]}(zl.MATERIAL_LineLoopDrawMode,0,i),o=r[0],c=r[1],d=Object(s.useMemo)(function(){return ci(qa(-1,1),Ka(2/n.x,-2/n.y),mi(t,.5))},[t,n]);return El(d),Object(s.useLayoutEffect)(function(){var e=oi(d).reduce(function(e,t){return e.push(t.x,t.y),e},[]);o(e)},[n,d,o]),Ol(c,a),null},Nf=function(e){var t=e.cropTransform,n=e.handlePos,a=e.cropHandlePhysicalPixelSize,i=e.zIndex,r=e.cssToPhysicalPixelRatio,o=e.canvasSize,s=e.visible,d=e.isFocused,l=Rl($().palette.neutralDark),u=3*(r=r||1),f=function(e,t,n,a){var i=Li(e),r=ii(a),o=ri(a),s=t,c=t,d=wa(ni(a)),l=wa(ai(a)),u=3*t+2;d<u&&(s=Math.round((d-2)/3),s=Math.max(s,n)),l<u&&(c=Math.round((l-2)/3),c=Math.max(c,n));var f=La(ti(a,i),Ea(Ma(r,tn(n,s-n,i.x)),Ma(o,tn(n,c-n,i.y)))),p=Xa(a);return Wr({x:f.x,y:f.y,width:s,height:c,rotation:p})}(n,a,Math.round(3*r),t),p=mi(f,2*u),m=mi(f,Math.round(4*r));return c.a.createElement(c.a.Fragment,null,c.a.createElement(Ml,{zIndex:i,color:l,transform:p},c.a.createElement(Fl,{shadowSize:u,visible:s,cropTransform:t,handleTransform:f})),d&&c.a.createElement(Rf,{canvasSize:o,transform:m,zIndex:i+1}))},Bf="a_lineData",jf="u_lineAlpha",Vf={name:"GridLines",attributeNames:[Bf],uniformNames:[jf],vertexShader:"\n  attribute vec3 ".concat(Bf,";\n  varying float distanceFromBeginningOfTheLine;\n  varying vec2 vPos;\n  void main(void) {\n      vPos =  ").concat(Bf,".xy;\n      distanceFromBeginningOfTheLine = ").concat(Bf,".z;\n      gl_Position = vec4(").concat(Bf,".xy, 0., 1.);\n  }"),fragmentShader:"\n  varying vec2 vPos;\n  varying float distanceFromBeginningOfTheLine;\n  uniform float ".concat(jf,";\n  void main(void){\n      float lineAlt = step(mod(distanceFromBeginningOfTheLine, ").concat(8,".0 * 2.0), ").concat(8,".0);\n      vec3 currentLineCurrentPixelColor = mix(vec3(1.0,1.0,1.0), vec3(0.8,0.8,0.8), lineAlt);\n      vec4 targetColorWithAlpha = vec4(currentLineCurrentPixelColor, ").concat(jf," * ").concat(.75,");\n      gl_FragColor = targetColorWithAlpha;\n  }")},zf=function(e){var t=e.linesCount,n=e.cropRect,a=e.alpha,i=e.canvasSize,r=Object(s.useContext)(gl).engine,o=vl(Vf),c=Object(s.useState)(),d=c[0],l=c[1],u=Object(s.useState)(),f=u[0],p=u[1],m=2*t,_=Object(s.useMemo)(function(){return e=n,t=i.x,a=i.y,{height:e.height/a*2,top:2*-e.top/a+1,width:e.width/t*2,left:e.left/t*2-1};var e,t,a},[n,i]),h=Object(s.useMemo)(function(){return new Float32Array(6*m)},[m]);return Object(s.useLayoutEffect)(function(){for(var e=_.width/(t+1),a=_.height/(t+1),i=0;i<t;i++){var r=6*i*2,o=e*(i+1),s=a*(i+1);h[r+0]=_.left+o,h[r+1]=_.top,h[r+2]=0,h[r+3]=_.left+o,h[r+4]=_.top-_.height,h[r+5]=n.height,h[r+6]=_.left,h[r+7]=_.top-s,h[r+8]=0,h[r+9]=_.left+_.width,h[r+10]=_.top-s,h[r+11]=n.width}},[_,n,t,h]),Object(s.useLayoutEffect)(function(){var e,t=void 0,n=void 0,a=new Float32Array(6*m);return r&&o&&((e={}).a_lineData=new Ql(r,a,Bf,!0,!1,3,!1),t=e,r.webGLVersion>=2?(n=r.recordVertexArrayObject(t,null,o.effect),r.bindVertexArrayObject(n,null)):r.bindBuffers(t,null,o.effect),l(t),p(n)),function(){n&&(null==r||r.releaseVertexArrayObject(n)),t&&t.a_lineData.dispose()}},[r,o,t,m]),Ol(Object(s.useCallback)(function(){r&&o&&d&&h&&(r.enableEffect(o.effect),d.a_lineData.update(h),f?r.bindVertexArrayObject(f,null):r.bindBuffers(d,null,o.effect),o.effect.setFloat(jf,a),r.drawArraysType(zl.MATERIAL_LineListDrawMode,0,2*m))},[d,r,h,o,a,f,m]),Number.MAX_VALUE),function(e){void 0===e&&(e={height:0,width:0,top:0,left:0});var t=Object(s.useContext)(Il).renderList;Object(s.useLayoutEffect)(function(){t&&t.requestRender()},[t,e.height,e.width,e.top,e.left])}(n),null},Gf=function(e){var t=e.canvasPixelSize,n=e.pointerPos,a=e.visible,i=Rl($().palette.neutralPrimary),r=c.a.createElement(c.a.Fragment,null),o=c.a.createElement(c.a.Fragment,null);if(a){var s={left:0,top:n.y,width:t.x,height:1};r=c.a.createElement(Ml,{zIndex:2,color:i,transform:gi(s)});var d={left:n.x,top:0,width:1,height:t.y};o=c.a.createElement(Ml,{zIndex:2,color:i,transform:gi(d)})}return c.a.createElement(c.a.Fragment,null,r,o)},Kf=Object(ga.e)([Ko,To,Eo],function(e,t,n){return ci(e||t,n)}),Wf={setCssToPhysicalPixelRatio:ud,setCropHandleSizeCss:ld},qf=Object(ee.connect)(function(e){var t=e.transformTools,n=t.device.pixelRatio,a=t.view.viewportPixelSize,i=t.cropInteraction,r=i.mode,o=i.focusedHandleIndex,s=i.isKeyboardFocused,c=t.cropUiDisplay.handleSizeCss,d=t.pointer.movePos,l=t.image.loadedPixelSize;return{cropTransform:Kf(e),canvasPixelSize:a,numCropGridLines:Ed(e),cropGridLinesVisibilityValue:Ad(e),cropUiMode:r,cropHandlePhysicalPixelSize:ki(c,n),cssToPhysicalPixelRatio:n,pointerPos:d,focusedHandle:o,isKeyboardFocused:s,visible:!!l}},Wf)(function(e){var t=e.cropHandlePhysicalPixelSize,n=e.canvasPixelSize,a=e.cropTransform,i=e.cropUiMode,r=e.numCropGridLines,o=e.cropGridLinesVisibilityValue,d=e.pointerPos,l=e.focusedHandle,u=e.isKeyboardFocused,f=e.visible,p=e.cssToPhysicalPixelRatio,m=i!==cr.draggingView&&i!==cr.selectingFirstCorner&&i!==cr.selectingSecondCorner,_=Object(s.useMemo)(function(){return vi(a)},[a]),h=function(e){var t=Object(s.useState)(!1),n=t[0],a=t[1],i=Object(s.useRef)(e);return i.current=e,Object(s.useLayoutEffect)(function(){if(e){var t=window.requestAnimationFrame(function(){setTimeout(function(){a(i.current)})});return function(){window.cancelAnimationFrame(t)}}},[e]),e&&n}(f);return h?c.a.createElement(c.a.Fragment,null,[un.TopLeft,un.TopCenter,un.TopRight,un.SideLeft,un.SideRight,un.BottomLeft,un.BottomCenter,un.BottomRight].map(function(e){var i="cropHandle"+e;return c.a.createElement(Nf,{key:i,handlePos:e,isFocused:e===l&&u,cropHandlePhysicalPixelSize:t,cropTransform:a,canvasSize:n,zIndex:3,cssToPhysicalPixelRatio:p,visible:m})}),i!==cr.selectingFirstCorner&&c.a.createElement(Rf,{canvasSize:n,transform:a,zIndex:2}),c.a.createElement(Gf,{canvasPixelSize:n,pointerPos:d,visible:i===cr.selectingFirstCorner}),c.a.createElement(zf,{cropRect:_,linesCount:r,alpha:o,canvasSize:n})):null});Object($e.loadStyles)([{rawString:".spinner_cc592d97{height:100%;width:100%;opacity:.8;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:absolute;z-index:200}"}]);var Qf=function(){return Qf=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Qf.apply(this,arguments)},Yf=Object(s.memo)(function(e){var t=e.loading,n=e.styles,a=e.dataTestId,i=$();return t?c.a.createElement(u.Spinner,{className:"spinner_cc592d97","data-test-id":a,style:Qf({background:i.palette.white},n),size:u.SpinnerSize.large}):null});Yf.displayName="LoadingSpinner";var Jf=Object(ee.connect)(function(e){return{loading:e.uiState.waitingForActiveEditorActivityToComplete,dataTestId:e.uiState.waitingForActiveEditorActivityToComplete?"pivot-switching":"pivot-switched"}})(Yf),Xf=Object(ee.connect)(function(e){return{loading:!Bo(e)}})(Yf),Zf=function(e){return e.autoEnhance},$f=function(e){return e.autoEnhance.waitingForAutoEnhanceLayer},ep=Object(ee.connect)(function(e){return{loading:$f(e)}})(Yf),tp=c.a.memo(function(e){var t=e.handleSizeCss,n=e.handleHitAreaSizeCss,a=e.setCropHandleSizeCss;return Object(s.useLayoutEffect)(function(){a({handleSizeCss:t,handleHitAreaSizeCss:n})},[a,t,n]),null}),np={setCropHandleSizeCss:ld},ap=Object(ee.connect)(void 0,np)(tp),ip=Object(ga.e)([Oo],function(e){var t=Pa(yi(e));return{width:t.x,height:t.y}}),rp=Object(ga.e)([ip],function(e){return e.width}),op=Object(ga.e)([ip],function(e){return e.height}),sp=Object(ga.e)([Oo,To],function(e,t){return vi(ci(t,e))});function cp(e,t){e&&("function"==typeof e?e(t):e.current=t)}function dp(e,t,n){var a=t.getBoundingClientRect();return{x:Math.floor((e.x-a.left)*n),y:Math.floor((e.y-a.top)*n)}}function lp(e,t,n){return e?Ea(t,{x:e.offsetLeft*n,y:e.offsetTop*n}):t}function up(e){Object(s.useEffect)(function(){if(e){var t=function(e){return e.preventDefault(),!1};return e.addEventListener("contextmenu",t),function(){return e.removeEventListener("contextmenu",t)}}},[e])}Object($e.loadStyles)([{rawString:".ms-Fabric--isFocusVisible .cropUIRectangle_1b96a0c4:focus{visibility:visible;outline-width:1px;outline-style:solid;outline-offset:5px}.ms-Fabric--isFocusHidden .cropUIRectangle_1b96a0c4{outline:0}.cropUIRectangle_1b96a0c4{position:absolute;justify-self:center}"}]),Object($e.loadStyles)([{rawString:".cropRectCorner_aeba7ec3{position:absolute;-ms-touch-action:none;touch-action:none}.cropRectCorner_aeba7ec3:focus{outline:0}"}]);var fp=function(e){var t=e.numRepeatsToSwitchToFast,n=e.keyboardEventTarget,a=e.handleKeyboardDown,i=e.isFastDirectionKeyCode,r=e.handleKeyboardUp,o=Object(s.useRef)(new Map);Object(s.useEffect)(function(){if(n){var e=function(e){if(e instanceof KeyboardEvent){var n=o.current.get(e.key)||0;o.current.set(e.key,n),i(e)?a(e,"SuperFast"):n<t?(o.current.set(e.key,n+1),a(e,"Slow")):a(e,"Fast")}},s=function(e){e instanceof KeyboardEvent&&(o.current.set(e.key,0),null==r||r(e))};return n.addEventListener("keydown",e),n.addEventListener("keyup",s),function(){n.removeEventListener("keydown",e),n.removeEventListener("keyup",s)}}},[n,o,t,i,a,r])};function pp(e,t,n){Object(s.useEffect)(function(){var a=function(a){if(t){var i=dp({x:a.clientX,y:a.clientY},t,e);a.cancelable&&(a.preventDefault(),n&&n({mousePhysicalPixelPos:i,deltaY:a.deltaY,deltaMode:a.deltaMode,ctrlKey:a.ctrlKey}))}};return t&&t.addEventListener("wheel",a,{passive:!1}),function(){t&&t.removeEventListener("wheel",a)}},[t,n,e])}var mp={initiatingButtonId:0,heldButtonsFlags:1},_p={initiatingButtonId:1,heldButtonsFlags:4},hp={initiatingButtonId:2,heldButtonsFlags:2};function bp(e,t){return!!((e||0)&t.heldButtonsFlags)}function gp(e,t){return bp(e.buttons,t)}function vp(e){return"touch"===e.pointerType||gp(e,mp)}function yp(e){return gp(e,_p)}function Sp(e){return gp(e,hp)}function Dp(e,t,n,a,i,r,o,s,c,d){var l,u;u=function(){return Ip(e,t,n,i,r,o,s,c,d)},(l=a).current&&window.cancelAnimationFrame(l.current),l.current=window.requestAnimationFrame(u)}function Ip(e,t,n,a,i,r,o,s,c){a({pointerPhysicalPixelPos:dp({x:e.clientX,y:e.clientY},n,t),isPrimaryButtonDownOrTouchDown:i,isMiddleButtonDown:r,isRightButtonDown:o,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,isTouch:"touch"===s,pointerId:c,inputType:Zs(e)})}var xp=function(){},Cp=function(e){var t=e.htmlElement,n=e.cssToPhysicalPixelRatio,a=e.onPointerDown,i=void 0===a?xp:a,r=e.onPointerMove,o=void 0===r?xp:r,c=e.onPointerUp,d=void 0===c?xp:c,l=e.onPointerEnter,u=void 0===l?xp:l,f=e.onPointerLeave,p=void 0===f?xp:f,m=e.onClick,_=void 0===m?xp:m,h=e.onUnmount,b=e.isPointerInteractionEnabled,g=void 0===b||b,v=Object(s.useRef)(),y=Object(s.useRef)(new Set),S=Object(s.useRef)();Object(s.useEffect)(function(){if(t){var e=function(e){try{y.current.delete(e),t.releasePointerCapture(e)}catch(e){}},a=function(e){return e.isPrimary||"touch"===e.pointerType},r=function(e){if(a(e)){var r=vp(e);vp(e)&&(o=e.pointerId,t.setPointerCapture(o),y.current.add(o)),Ip(e,n,t,i,r,yp(e),Sp(e),e.pointerType,e.pointerId)}var o},s=function(e){a(e)&&Dp(e,n,t,v,o,vp(e),yp(e),Sp(e),e.pointerType,e.pointerId)},c=function(i,r){a(i)&&(r||(e(i.pointerId),Ip(i,n,t,_,!1,!1,!1,i.pointerType,i.pointerId)),Ip(i,n,t,d,!1,!1,!1,i.pointerType,i.pointerId))},l=function(e){c(e,!1)},f=function(e){c(e,!0)},m=function(e){e.isPrimary&&"touch"!==e.pointerType&&Dp(e,n,t,S,u,vp(e),yp(e),Sp(e),e.pointerType,e.pointerId)},b=function(e){e.isPrimary&&"touch"!==e.pointerType&&Dp(e,n,t,S,p,vp(e),yp(e),Sp(e),e.pointerType,e.pointerId)};if(!g)return;return t.addEventListener("pointerdown",r),t.addEventListener("pointermove",s),t.addEventListener("pointerup",l),t.addEventListener("lostpointercapture",f),t.addEventListener("pointerenter",m),t.addEventListener("pointerleave",b),function(){t.removeEventListener("pointerdown",r),t.removeEventListener("pointermove",s),t.removeEventListener("pointerup",l),t.removeEventListener("lostpointercapture",f),t.removeEventListener("pointerenter",m),t.removeEventListener("pointerleave",b),function(){for(var t=0,n=Array.from(y.current);t<n.length;t++){var a=n[t];e(a)}}(),null==h||h()}}},[i,o,d,u,p,_,t,n,g,h])};function Op(e,t,n,a,i,r){var o=Object(s.useMemo)(function(){return t?new Pn.a(t,{recognizers:[[Pn.a.Pinch],[Pn.a.Tap,{taps:2,event:"doubletap"}]],touchAction:"compute"}):null},[t]);Object(s.useEffect)(function(){if(t&&o){var s=function(a){n&&n({center:dp(a.center,t,e),scale:a.scale})},c=function(n){a&&a({center:dp(n.center,t,e),scale:n.scale})},d=function(n){i&&i({center:dp(n.center,t,e),scale:n.scale})},l=function(n){r&&r({center:dp(n.center,t,e),scale:n.scale})};return o.on("pinchstart",s),o.on("pinchmove",c),o.on("pinchend",d),o.on("doubletap",l),function(){o.off("pinchstart",s),o.off("pinchmove",c),o.off("pinchend",d),o.off("doubletap",l)}}},[t,n,a,i,r,e,o])}function wp(e,t,n,a,i,r,o,c,d,l,u,f,p,m,_,h,b,g,v){var y=Object(s.useCallback)(function(n){u&&e&&(n.pointerPhysicalPixelPos=lp(e,n.pointerPhysicalPixelPos,t),u(n))},[e,u,t]),S=Object(s.useCallback)(function(n){f&&e&&(n.pointerPhysicalPixelPos=lp(e,n.pointerPhysicalPixelPos,t),f(n))},[e,f,t]),D=Object(s.useCallback)(function(n){p&&e&&(n.pointerPhysicalPixelPos=lp(e,n.pointerPhysicalPixelPos,t),p(n))},[e,p,t]),I=Object(s.useCallback)(function(n){m&&e&&(n.mousePhysicalPixelPos=lp(e,n.mousePhysicalPixelPos,t),m(n),d({type:"Zoom",zoom:a}))},[m,e,t,d,a]),x=Object(s.useCallback)(function(n){_&&e&&(n.center=lp(e,n.center,t),_(n))},[t,e,_]),C=Object(s.useCallback)(function(n){h&&e&&(n.center=lp(e,n.center,t),h(n))},[t,e,h]),O=Object(s.useCallback)(function(n){b&&e&&(n.center=lp(e,n.center,t),b(n),d({type:"CropImageDimension",cropDimension:qn}))},[t,e,b,d]),w=Object(s.useCallback)(function(n){g&&e&&(n.center=lp(e,n.center,t),g(n))},[t,e,g]),E=Object(s.useCallback)(function(e,t){if(!e.ctrlKey&&En(e)){e.stopPropagation(),e.preventDefault();var a=xn(e.key);o({direction:a,handlePosition:n,cropShiftingValue:In(t),inputType:"Keyboard"}),function(e,t,n,a){e===un.Center?a({type:"CropImageMove",cropTopLeftCornerFromImageOrigin:n}):a({type:"CropImageDimension",cropDimension:t})}(n,i,r,d)}},[o,n,d,i,r]);Object(s.useEffect)(function(){if(e){var t=function(e){e.stopPropagation(),"focus"===e.type&&(On()?l({handlePosition:n,isKeyboardFocused:!0}):l({handlePosition:n,isKeyboardFocused:!1}))},a=function(e){"blur"===e.type&&l({handlePosition:un.None,isKeyboardFocused:!1})};return e.addEventListener("focus",t),e.addEventListener("blur",a),function(){e.removeEventListener("focus",t),e.addEventListener("blur",a)}}},[e,n,o,l]),fp({numRepeatsToSwitchToFast:10,keyboardEventTarget:e,handleKeyboardDown:E,isFastDirectionKeyCode:wn,handleKeyboardUp:c}),Cp({htmlElement:e,cssToPhysicalPixelRatio:t,onPointerDown:y,onPointerMove:S,onPointerUp:D,onUnmount:v}),pp(t,e,I),up(e),Op(t,e,x,C,O,w)}var Ep=Object(s.forwardRef)(function(e,t){var n=e.handlePosition,a=e.ariaLabel,i=e.style,r=e.cssToPhysicalPixelRatio,o=e.currentZoom,d=e.cropDimension,l=e.cropTopLeftCornerFromImageOrigin,u=e.shouldShowTooltip,f=e.handleCropRectAdjustment,p=e.handleCropRectAdjustmentKeyUp,m=e.setAriaAnnouncementScenario,_=e.setFocusedCropHandle,h=e.onPointerDown,b=e.onPointerMove,g=e.onPointerUp,v=e.onWheel,y=e.onTouchDown,S=e.onTouchMove,D=e.onTouchUp,I=e.onDoubleTap,x=e.onUnmount,C=Object(s.useContext)(Ze).strings,O=Object(s.useState)(null),w=O[0],E=O[1];return Object(s.useEffect)(function(){cp(t,w)},[t,w]),wp(w,r,n,o,d,l,f,p,m,_,h,b,g,v,y,S,D,I,x),c.a.createElement("div",{ref:E,"data-is-focusable":!0,"aria-label":a,title:u?C.crop_cornerTooltip:void 0,role:"button",className:"cropRectCorner_aeba7ec3",tabIndex:0,style:i,"data-test-id":"crop-corner-handle-".concat(n)})});function Ap(e,t){return vt(e,t.x.toString(),t.y.toString())}function Lp(e,t,n){var a=Object(s.useContext)(Ze).strings;return Yi(e/t,n)?vt(a.editor_imageDimensionWithAspectRatioAriaLive,e.toString(),t.toString(),n.x.toString(),n.y.toString()):vt(a.editor_imageDimensionAriaLive,e.toString(),t.toString())}Ep.displayName="CropRectCorner";var kp=function(){return kp=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},kp.apply(this,arguments)},Mp=c.a.memo(function(e){var t=e.cropUIRectangle,n=e.cssToPhysicalPixelRatio,a=e.cursor,i=e.currentZoom,r=e.cropDimension,o=e.aspectRatio,d=e.cropTopLeftCornerFromImageOrigin,l=e.shouldShowTooltip,u=e.isPointerOverCropHandle,f=e.handleCropRectAdjustment,p=e.handleCropRectAdjustmentKeyUp,m=e.setAriaAnnouncementScenario,_=e.setFocusedCropHandle,h=e.onPointerDown,b=e.onPointerMove,g=e.onPointerUp,v=e.onWheel,y=e.onTouchDown,S=e.onTouchMove,D=e.onTouchUp,I=e.onDoubleTap,x=e.onUnmount,C=Object(s.useContext)(Ze).strings,O=$(),w=function(e){var t=Object(s.useContext)(Ze).strings;return Object(s.useMemo)(function(){return Ap(t.crop_topLeftCornerAriaLabel,e)},[t,e])}(d),E=function(e,t){var n=Object(s.useContext)(Ze).strings;return Object(s.useMemo)(function(){var a={x:e.x+t.width,y:e.y};return Ap(n.crop_topRightCornerAriaLabel,a)},[n,e,t])}(d,r),A=function(e,t){var n=Object(s.useContext)(Ze).strings;return Object(s.useMemo)(function(){var a={x:e.x,y:e.y+t.height};return Ap(n.crop_bottomLeftCornerAriaLabel,a)},[n,e,t])}(d,r),L=function(e,t){var n=Object(s.useContext)(Ze).strings;return Object(s.useMemo)(function(){var a={x:e.x+t.width,y:e.y+t.height};return Ap(n.crop_bottomRightCornerAriaLabel,a)},[n,e,t])}(d,r),k=Object(s.useState)(null),M=k[0],P=k[1];wp(M,n,un.Center,i,r,d,f,p,m,_,h,b,g,v,y,S,D,I,x);var T={handleCropRectAdjustment:f,handleCropRectAdjustmentKeyUp:p,setAriaAnnouncementScenario:m,setFocusedCropHandle:_,onPointerDown:h,onPointerMove:b,onPointerUp:g,onWheel:v,onUnmount:x,cssToPhysicalPixelRatio:n,currentZoom:i,cropDimension:r,cropTopLeftCornerFromImageOrigin:d,shouldShowTooltip:l},U={cursor:a,width:30,height:30},F=Lp(r.width,r.height,o);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"cropUIRectangle_1b96a0c4",style:{width:t.width/n,height:t.height/n,top:t.top/n,marginLeft:t.left/n,marginRight:t.left/n,cursor:a,outlineColor:O.palette.neutralDark},"data-is-focusable":!0,"data-test-id":"cropUIRectangle",ref:P,"aria-label":"".concat(C.crop_rectangleAriaLabel," ; ").concat(F),title:l?u?C.crop_cornerTooltip:C.crop_rectangleTooltip:void 0,role:"img",tabIndex:0}),c.a.createElement(Ep,kp({handlePosition:un.TopLeft,ariaLabel:w,style:kp(kp({},U),{top:t.top/n,left:t.left/n})},T)),c.a.createElement(Ep,kp({handlePosition:un.TopRight,ariaLabel:E,style:kp(kp({},U),{top:t.top/n,left:(t.left+t.width)/n-30})},T)),c.a.createElement(Ep,kp({handlePosition:un.BottomLeft,ariaLabel:A,style:kp(kp({},U),{left:t.left/n,top:(t.top+t.height)/n-30})},T)),c.a.createElement(Ep,kp({handlePosition:un.BottomRight,ariaLabel:L,style:kp(kp({},U),{left:(t.left+t.width)/n-30,top:(t.top+t.height)/n-30})},T)))}),Pp=Object(ga.e)([No],function(e){return Qa(e)}),Tp=Object(ga.e)([Pp],function(e){return Si(e)}),Up=Object(ga.e)([zo,To,Pp],function(e,t,n){return Cr(e,t,n)}),Fp=function(e){return e.uiState.activeEditorActivity},Hp=function(e){return e.uiState.isViewingOriginal},Rp=Object(ga.e)([Go,function(e){return e.transformTools.pointer.maxDragDistance}],function(e,t){return e?t:0}),Np=Object(ga.e)([Rp],function(e){return e>10}),Bp=function(e){var t=e.spotFixUi,n=t.userChosenSpotFixRadiusInScreenPixels,a=t.defaultSpotFixRadiusInScreenPixels;return null!=n?n:a};function jp(e){if(e.spotFixUi.spotFixMouseCursorIsActive)return e.spotFixUi.cursorScreenPosition;var t=e.spotFixUi,n=t.spotFixCursorRadiusIsChanging;return t.shouldShowSpotFixCursorAtCenter||n?Ma(e.transformTools.view.viewportPixelSize,.5):e.spotFixUi.cursorScreenPosition}var Vp,zp=Object(ga.e)([function(e){return e.spotFixUi.spotFixMouseCursorIsActive},Fp,function(e){return e.spotFixUi.spotFixCursorRadiusIsChanging},Np,function(e){return e.spotFixUi.shouldShowSpotFixCursorAtCenter}],function(e,t,n,a,i){return!a&&t===ro&&(e||n||i)}),Gp=Object(ga.e)([Ao,function(e){return e.transformTools.cropInteraction.shouldConstrainInImage},To,Pp,Go,zo,Up,ko,function(e){return e.transformTools.view.allowDraggingView},Fp,Fo,zp],function(e,t,n,a,i,r,o,s,c,d,l,u){if(u)return"none";switch(e){case cr.selectingFirstCorner:return Fr(t,ti(ei(ci(n,a)),r))?"crosshair":"not-allowed";case cr.selectingSecondCorner:return"crosshair";case cr.draggingView:return"grabbing";case cr.disabled:return l===dr.fitCropRectInView?"pointer":i?"grabbing":"grab";case cr.usingNineSliceCropHandles:default:return function(e,t,n,a){switch(e){case un.TopLeft:case un.BottomRight:return"nwse-resize";case un.BottomLeft:case un.TopRight:return"nesw-resize";case un.SideLeft:case un.SideRight:return"ew-resize";case un.TopCenter:case un.BottomCenter:return"ns-resize";case un.Center:default:return n||a?t?"grabbing":"grab":"default"}}(s,i,o,c)}}),Kp=Object(ga.e)([To],function(e){return di(e)}),Wp=Object(ga.e)([Oo,No],function(e,t){var n=vi(t),a={x:n.left,y:n.top};return Ta(La(pi(e),a))}),qp=Object(ga.e)([ko],function(e){return Vi(e)}),Qp={handleCropRectAdjustment:yd,handleCropRectAdjustmentKeyUp:Sd,setAriaAnnouncementScenario:Xn,setFocusedCropHandle:xd,onPointerMove:ie,onPointerDown:ne,onPointerUp:ae,onWheel:$c,onTouchDown:id,onTouchMove:rd,onTouchUp:od,onDoubleTap:dd,onUnmount:sd},Yp=Object(ee.connect)(function(e){var t=e.transformTools.device.pixelRatio,n=Gp(e),a=Kp(e),i=ip(e);return{cropUIRectangle:sp(e),cssToPhysicalPixelRatio:t,cursor:n,currentZoom:a,cropDimension:i,aspectRatio:Yo(e),cropTopLeftCornerFromImageOrigin:Wp(e),shouldShowTooltip:e.transformTools.cropInteraction.mode===cr.none,isPointerOverCropHandle:qp(e)}},Qp)(Mp);function Jp(e){return(0|e)===e}!function(e){e.ActualMipMapsWithFakeFallBack="ActualMipMapsWithFakeFallBack",e.NoMipMaps="NoMipMaps",e.FakeMipMaps="FakeMipMaps"}(Vp||(Vp={}));var Xp,Zp=Vp.ActualMipMapsWithFakeFallBack,$p=function(){return $p=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$p.apply(this,arguments)};function em(e,t,n,a){if(void 0===n&&(n=Xp.RGBA),!Jp(e)||!Jp(t))throw new Error("Dimensions of ("+e+","+t+") are not integers. ImageBytes cannot be created.");if(e<1||t<1)throw new RangeError("Dimensions of ("+e+","+t+") must be non-negative. ImageBytes cannot be created.");if(a&&!cm(e,t,n,a))throw new Error("Given byte array length is invalid. ImageBytes cannot be created.");var i;try{i=null!=a?a:new Uint8Array(e*t*om(n))}catch(n){if(n instanceof RangeError)throw new RangeError("Byte array length for ".concat(e," x ").concat(t," image is too big. ImageBytes cannot be created. ").concat(n.message));throw n}return{bytes:i,width:e,height:t,format:n,id:""}}function tm(e){return!!e.bytes}function nm(e){return!!e.canvasMethods}function am(e){return null!==e&&void 0!==e.main}function im(e){return am(e)?e:$p($p({},{main:null,blend:null,overlay:null,mask:null}),{main:e})}function rm(e){return tm(e)?"".concat(e.id):e instanceof HTMLImageElement?"".concat(e.src):"".concat(e.id)}function om(e){var t;return((t={})[Xp.RGB]=3,t[Xp.RGBA]=4,t)[e]}function sm(e){if(e===Xp.RGBA)return 3;throw new Error("the specified image format does not have alpha")}function cm(e,t,n,a){return!(!Jp(e)||!Jp(t))&&a.byteLength===e*t*om(n)}!function(e){e.RGBA="RGBA",e.RGB="RGB"}(Xp||(Xp={}));var dm=function(){function e(e,t){var n=this;this.getTexture=function(e,t,a,i,r,o){if(void 0===i&&(i=!1),!(e instanceof HTMLImageElement)||e.complete&&e.currentSrc){var s=rm(e),c=n._loadableTexturesMap.has(s)&&n._loadableTexturesMap.get(s);if(c)return c.refCount++,void(c.isLoaded?c.texture&&t({height:c.loadedHeight,width:c.loadedWidth,id:c.id,texture:c.texture}):c.onReadyCallbacksList.push(t));var d=n._loadableTexturesMap;d.set(s,{id:s,isLoaded:!1,onReadyCallbacksList:[t],refCount:1}),n._textureLoadFn(e,function(e,t,n){var a=d.get(s);a&&(a.loadedHeight=n,a.loadedWidth=t,a.isLoaded=!0,a.texture=e,a.onReadyCallbacksList.forEach(function(a){a&&a({id:s,height:n,width:t,texture:e})}))},function(e){r(e)},a,i,o)}else r({id:"ImageNotLoaded",message:"The image is not yet loaded"})},this.dispose=function(){n._loadableTexturesMap.forEach(function(e){e.texture&&n._textureUnloadFn(e.texture)}),n._loadableTexturesMap.clear()},this.releaseTexture=function(e,t){void 0===t&&(t=!1);var a=n._loadableTexturesMap.get(e);a&&(t||a.refCount<=1?(a.texture&&n._textureUnloadFn(a.texture),n._loadableTexturesMap.delete(e)):a.refCount--)},this.forceReleaseTexture=function(e){n.releaseTexture(e,!0)},this._textureLoadFn=e,this._textureUnloadFn=t,this._loadableTexturesMap=new Map}return e.prototype.getAlreadyLoadedTexture=function(e){var t=rm(e),n=this._loadableTexturesMap.has(t)&&this._loadableTexturesMap.get(t);if(n)return n.texture},e}();function lm(e){var t=e.getCaps().maxTextureSize;return Math.min(4096,"number"==typeof t&&t||2048)}function um(e,t){if(t<=0)throw new RangeError("Invalid max Size");for(var n=[],a=0,i=0;i<e.height;){for(;a<e.width;)n.push({left:e.left+a,top:e.top+i,width:Math.min(e.width-a,t),height:Math.min(e.height-i,t)}),a+=t;a=0,i+=t}return n}function fm(e,t,n,a,i){for(var r=new i(n.width*n.height*a),o=(t-n.width)*a,s=n.width*a,c=0,d=(n.top*t+n.left)*a;c<r.length;)r.set(e.subarray(d,d+s),c),c+=s,d+=s+o;return r}function pm(e,t){return rm(e)+"".concat(t.left,"_").concat(t.top,"_").concat(t.width,"_").concat(t.height)}function mm(e,t){var n,a,i,r=!1,o=(n=this,void 0,i=function(){var n,a,i,o,s,c;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(d){switch(d.label){case 0:n=[],a=0,i=e,d.label=1;case 1:return a<i.length?(o=i[a],r?[3,3]:(c=(s=n).push,[4,t(o)])):[3,5];case 2:return c.apply(s,[d.sent()]),[3,4];case 3:return[3,5];case 4:return a++,[3,1];case 5:return[2,n]}})},new((a=void 0)||(a=Promise))(function(e,t){function r(e){try{s(i.next(e))}catch(e){t(e)}}function o(e){try{s(i.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof a?n:new a(function(e){e(n)})).then(r,o)}s((i=i.apply(n,[])).next())}));return{promise:o,cancel:function(){r=!0}}}function _m(){var e=function(){},t=new Promise(function(t){return e=t});return window.requestAnimationFrame(e),t}function hm(e){return am(e)?e.main?hm(e.main):1:(tm(e)||nm(e))&&e.orientation||1}var bm=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},gm=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function vm(e){return 2===(null==e?void 0:e.webGLVersion)}var ym=function(){return ym=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ym.apply(this,arguments)},Sm=function(){function e(e){this.cache={},this.engine=e}return e.prototype.getEffectWrapper=function(e){var t=e.name;if(this.cache[t])return this.cache[t].effectWrapperPromise;var n=new Eu(ym({engine:this.engine},e)),a=new Promise(function(e,t){n.effect.onError=function(e,n){t(n)},n.effect.executeWhenCompiled(function(){return e(n)})});return this.cache[t]={effectWrapper:n,effectWrapperPromise:a},a},e}();function Dm(e){return pl(hm(e))}var Im,xm=c.a.memo(function(e){var t=e.children,n=e.width,a=e.height,i=e.cssWidth,r=e.cssHeight,o=e.tabIndex,d=e.onPointerDown,l=e.onPointerMove,u=e.onPointerUp,f=e.onWheel,p=e.onTouchDown,m=e.onTouchMove,_=e.onTouchUp,h=e.onDoubleTap,b=e.onUnmount,g=e.cssToPhysicalPixelRatio,v=e.color,y=e.isAnimating,S=e.title,D=Object(s.useState)(null),I=D[0],x=D[1],C=function(e){var t=Object(s.useRef)(),n=Object(s.useRef)(),a=Object(s.useRef)();return Object(s.useLayoutEffect)(function(){if(e){var i=new zu(e,!1,{alpha:!0,antialias:!1,stencil:!1,depth:!1}),r=new wu(i);i.setAlphaMode(zl.ALPHA_COMBINE),i.setViewport({x:0,y:0,width:1,height:1}),t.current=i,n.current=r,a.current=new Sm(i)}return function(){var e;null===(e=t.current)||void 0===e||e.dispose(),t.current=void 0,n.current=void 0,a.current=void 0}},[e]),[t.current,n.current,a.current]}(I),O=C[0],w=C[1],E=C[2];!function(e){var t=Object(s.useContext)(Zt).logWarningEvent;Object(s.useEffect)(function(){if(e){var n=e.onContextLostObservable.add(function(){t({id:"WebGlContextLost",message:"WebGL context was lost on a WebGL canvas."})});return function(){e.onContextLostObservable.remove(n)}}},[e,t])}(O),Cp({htmlElement:I,cssToPhysicalPixelRatio:g,onPointerDown:d,onPointerMove:l,onPointerUp:u,onUnmount:b}),up(I),pp(g,I,f),Op(g,I,p,m,_,h);var A=function(e){var t=e?lm(e):void 0,n=Object(s.useMemo)(function(){if(e)return new dm(function(t,n,a,i,r,o){void 0===r&&(r=!0),void 0===o&&(o=zl.TEXTURE_DEFAULT_ANISOTROPIC_FILTERING_LEVEL);var s=lm(e);r=!!vm(e)&&r;var c=function(){return a({id:"CreateTextureFailed",message:"loadTexture failed to create a texture"})};(function(e,t,n,a,i,r){return bm(this,void 0,void 0,function(){var o,s,c,d,l,u=this;return gm(this,function(f){switch(f.label){case 0:o={top:0,left:0,width:e.width,height:e.height},s=[],f.label=1;case 1:return f.trys.push([1,3,,4]),c=um(o,i),d=function(i){return bm(u,void 0,void 0,function(){var o,s,c,d;return gm(this,function(l){switch(l.label){case 0:return[4,_m()];case 1:if(l.sent(),!(o=function(e,t){var n;return nm(e)?e.renderCanvas(e.canvasMethods.getHTMLCanvas,{x:e.width,y:e.height},t,null!==(n=e.orientation)&&void 0!==n?n:1):t.width===e.width&&t.height===e.height&&0===t.left&&0===t.top?e:tm(e)?function(e,t){if(!cm(e.width,e.height,e.format,e.bytes))throw Error("Error: Could not extract subImage from invalid ImageBytes array");var n=e.format,a=om(n);return{bytes:fm(e.bytes,e.width,t,a,Uint8Array),format:n,width:t.width,height:t.height,id:pm(e,t)}}(e,t):function(e,t){var n=document.createElement("canvas");n.width=t.width,n.height=t.height,n.id=pm(e,t);var a=n.getContext("2d");if(a)return a.drawImage(e,t.left,t.top,t.width,t.height,0,0,t.width,t.height),n}(e,t)}(e,i)))throw new Error("Failed to create sub texture");return s=function(e,t,n,a){return tm(e)?function(e,t,n,a){if(!function(e,t,n){return function(e,t,n){return Math.min(n/e,n/t)}(e,t,lm(n))<1}(e.width,e.height,n)){var i=e.format===Xp.RGB?zl.TEXTUREFORMAT_RGB:zl.TEXTUREFORMAT_RGBA;return n.createRawTexture(e.bytes,e.width,e.height,i,t,!1,zl.TEXTURE_TRILINEAR_SAMPLINGMODE,null,zl.TEXTURETYPE_UNSIGNED_BYTE)}a({id:"ImageTooBig",message:"The supplied image size of"+" ".concat(e.width,"x").concat(e.height," ")+"exceeds max texture size of ".concat(lm(n))})}(e,t,n,a):e instanceof HTMLImageElement?function(e,t,n,a){return n.createTexture(null,!t,!1,null,void 0,null,function(e){a({id:"CreateTextureFailed",message:"Babylon engine.createTexture failed with message: ".concat(e)})},e)}(e,t,n,a):e instanceof HTMLCanvasElement?function(e,t,n,a){var i,r=function(e){var t=e.width,n=e.height,a=document.createElement("canvas");a.width=t,a.height=n;var i=a.getContext("2d");if(i)return i.scale(1,-1),i.drawImage(e,0,0,t,n,0,0,e.width,-1*e.height),a}(e);if(r){var o=null!==(i=new Gl(r,{generateMipMaps:t,engine:n,samplingMode:zl.TEXTURE_TRILINEAR_SAMPLINGMODE}).getInternalTexture())&&void 0!==i?i:void 0;return o||a({id:"CreateTextureFailed",message:"Failed to create HtmlElementTexture"}),o}a({id:"CreateTextureFailed",message:"Failed to flip canvas"})}(e,t,n,a):void 0}(o,t,n,r),s?((c=new Bl(null))._texture=s,c.wrapR=zl.TEXTURE_CLAMP_ADDRESSMODE,c.wrapU=zl.TEXTURE_CLAMP_ADDRESSMODE,c.wrapV=zl.TEXTURE_CLAMP_ADDRESSMODE,c.anisotropicFilteringLevel=a,nm(e)&&(d=e.canvasMethods.restoreHTMLCanvas)&&d(),[2,{texture:c,rect:i}]):[2]}})})},[4,mm(c,d).promise];case 2:return s=f.sent().filter(function(e){return!!e}),[3,4];case 3:return l=f.sent(),r({id:"CreateTextureFailed",message:l instanceof Error?l.message:"sub texture extraction failed."}),[3,4];case 4:return[2,{width:e.width,height:e.height,parts:s,orientation:hm(e)}]}})})})(t,r,e,o,s,a).then(function(e){e?Dm(t)?n(e,e.height,e.width):n(e,e.width,e.height):c()}).catch(function(){c()})},function(e){e.parts.forEach(function(e){var t;null===(t=e.texture)||void 0===t||t.dispose()})})},[e]);return function(e){var t=Object(s.useContext)(Zt).logMaxTextureSizeEvent;Object(s.useEffect)(function(){e&&t({value:e})},[t,e])}(t),Object(s.useEffect)(function(){return function(){return null==n?void 0:n.dispose()}},[n]),n}(O),L=Object(s.useMemo)(function(){return{canvasContextIsValid:!0,canvas:I||void 0,textures:A,engine:O,effectRenderer:w,effectWrapperManager:E}},[I,A,O,w,E]),k=e.cursor||"default";Ol(Object(s.useCallback)(function(){O&&v&&O.clear({r:v[0],g:v[1],b:v[2],a:v[3]},!0,!0)},[O,v]),-1);var M=Object(s.useContext)(Il).renderList;return Object(s.useLayoutEffect)(function(){I&&(I.width=n,I.height=a,M.renderNow())},[n,a,I,M]),c.a.createElement(gl.Provider,{value:L},c.a.createElement("canvas",{"data-test-id":y?"canvas-animating":"canvas-idle",tabIndex:o,"aria-hidden":void 0===o||o<0,ref:x,style:{cursor:k,width:i,height:r,touchAction:"none",display:"block",position:"absolute",outline:"none"},title:S}),t)}),Cm={handlePointerMove:ie,handlePointerDown:ne,handlePointerUp:ae,handleMouseWheel:$c,handleTouchDown:id,handleTouchMove:rd,handleTouchUp:od,handleDoubleTap:dd,handleCleanup:sd,handleFrameTick:Jc,abortCurrentMode:gd,setAriaAnnouncementScenario:Xn},Om=Object(ee.connect)(function(e){var t=e.transformTools,n=t.animations,a=n.needsFrameTick,i=n.image.animatedMatrix,r=t.device.pixelRatio,o=t.view,s=o.viewportPixelSize,c=o.viewportCssSize,d=Pp(e),l=Tp(e),u=i||d,f=Kp(e);return{imageTransformValues:u,imagePixelSize:l,canvasPixelSize:s,canvasCssSize:c,isPointerInImage:Up(e),isPointerOverCropHandle:qp(e),cursorStyle:Gp(e),cssToPhysicalPixelRatio:r,needsFrameTick:a,currentZoom:f}},Cm)(function(e){var t=e.handlePointerDown,n=e.handlePointerMove,a=e.handlePointerUp,i=e.handleMouseWheel,r=e.handleTouchDown,o=e.handleTouchMove,d=e.handleTouchUp,l=e.handleDoubleTap,u=e.handleCleanup,f=e.handleFrameTick,p=e.abortCurrentMode,m=e.setAriaAnnouncementScenario,_=e.cssToPhysicalPixelRatio,h=e.needsFrameTick,b=e.canvasPixelSize,g=e.canvasCssSize,v=e.isPointerInImage,y=e.isPointerOverCropHandle,S=e.cursorStyle,D=e.backgroundColor,I=e.currentZoom,x=e.children,C=e.animationSpeedMultiplier,O=Object(s.useContext)(Ze).strings,w=Rl($().palette.neutralLighterAlt),E=Object(s.useCallback)(function(e){i(e),m({type:"Zoom",zoom:I})},[i,m,I]);return Object(s.useEffect)(function(){var e=0,t=null!=C?C:1;t<=0&&(console.warn("animationSpeedMultiplier ignored. Value must be > 0."),t=1);var n=function(){e=window.requestAnimationFrame(n),f((new Date).getTime()*t)};if(h)return e=window.requestAnimationFrame(n),function(){window.cancelAnimationFrame(e)}},[h,f,C]),Object(s.useEffect)(function(){var e=function(e){"Esc"!==e.key&&"Escape"!==e.key||p()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[p]),c.a.createElement(xl,null,c.a.createElement(xm,{width:b.x,height:b.y,color:D||w,cssWidth:g.width,cssHeight:g.height,title:y?O.crop_cornerTooltip:v?O.crop_rectangleTooltip:void 0,cursor:S,onPointerDown:t,onPointerMove:n,onPointerUp:a,onWheel:E,onTouchDown:r,onTouchMove:o,onTouchUp:d,onDoubleTap:l,onUnmount:u,cssToPhysicalPixelRatio:_,isAnimating:h},x))}),wm=Object(ga.e)([Pp,To,Ko,function(e){return e.transformTools.animations.image.animatedMatrix}],function(e,t,n,a){return ci(n||t,a||e)});!function(e){e.Editor="Editor",e.MainImage="MainImage",e.Thumbnail="Thumbnail"}(Im||(Im={}));var Em=Object(s.createContext)(void 0);function Am(e){var t=performance.getEntriesByName(e);return t.length>0&&e?performance.now()-t[t.length-1].startTime:-1}function Lm(e){var t=am(e)?e.main:e;if(t)return{x:t.width,y:t.height}}function km(e){var t,n=Lm(e);return n&&Dm(e)&&(n={x:(t=n).y,y:t.x}),n}function Mm(e,t){var n=!1,a=e?km(e):void 0;return a&&(n=!t||Ra(t,a)),n}var Pm,Tm=function(){return Tm=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Tm.apply(this,arguments)};function Um(){var e=Object(s.useState)(0)[1];return function(){return e(function(e){return++e})}}!function(e){e[e.main=0]="main",e[e.lut=1]="lut",e[e.blend=2]="blend",e[e.overlay=3]="overlay",e[e.mask=4]="mask"}(Pm||(Pm={}));var Fm=Object(s.createContext)(function(e){}),Hm=c.a.memo(function(e){var t=e.onError,n=e.children;return c.a.createElement(Fm.Provider,{value:t},n)});function Rm(){return Object(s.useContext)(Fm)}var Nm=function(){return Nm=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Nm.apply(this,arguments)},Bm={disposalCondition:"whenSourceIdChanges",shouldDisposeWhenSourceIsNull:!0};function jm(e,t,n,a,i,r){var o;void 0===a&&(a=!1),void 0===r&&(r={});var c=Object(s.useRef)(void 0),d=Um();return function(e,t,n,a,i){void 0===a&&(a=!1);var r=Rm();!function(e,t,n){var a=t?rm(t):null,i=Object(s.useRef)(e);i.current=e,Object(s.useLayoutEffect)(function(){i.current()},[a,n])}(Object(s.useCallback)(function(){e&&(null==n||n.getTexture(e,i,t,a,r))},[e,t,n,r,a,i]),e,n)}(e,t,n,a,Object(s.useCallback)(function(e){c.current=e,null==i||i({x:e.width,y:e.height}),d()},[i,d])),function(e,t,n,a,i){var r,o,c=function(e,t,n){return Object(s.useCallback)(function(){e&&(null==t||t.forceReleaseTexture(e.id),n())},[t,e,n])}(t,n,i);r=c,(o=Object(s.useRef)(r)).current=r,Object(s.useEffect)(function(){return function(){o.current()}},[]);var d,l,u,f=function(e,t,n){var a=Nm(Nm({},Bm),n),i=a.disposalCondition,r=a.shouldDisposeWhenSourceIsNull;return"whenSourceIdChanges"===i&&function(e,t){return!!e&&(null==t?void 0:t.id)!==rm(e)}(e,t)||r&&null===e}(e,t,a);d=f,l=c,u=Object(s.useRef)(d),!0===d&&!1===u.current&&l(),u.current=d,function(e,t){var n=Object(s.useRef)(e);n.current&&n.current.id!==(null==e?void 0:e.id)&&(null==t||t.forceReleaseTexture(n.current.id)),n.current=e}(t,n)}(e,c.current,n,r,function(){c.current=void 0}),(null===(o=c.current)||void 0===o?void 0:o.texture)||null}var Vm=function(){return Vm=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vm.apply(this,arguments)};function zm(e,t){var n=vm(t),a=function(e){var t;return(am(e)?null===(t=e.main)||void 0===t?void 0:t.mipMapType:null==e?void 0:e.mipMapType)||Zp}(e),i={main:!1,blend:!1,overlay:!1,mask:!1};switch(a){case Vp.ActualMipMapsWithFakeFallBack:return{mipMapsEnabledByLayer:Vm(Vm({},i),{main:n,blend:n,mask:n}),shouldUseFakeMipMaps:!n};case Vp.FakeMipMaps:return{mipMapsEnabledByLayer:i,shouldUseFakeMipMaps:!0};case Vp.NoMipMaps:return{mipMapsEnabledByLayer:i,shouldUseFakeMipMaps:!1};default:throw new h(a)}}var Gm=function(){return Gm=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gm.apply(this,arguments)};function Km(e){return e[0]}var Wm="base64,";function qm(e,t,n,a,i){var r,o;!function(e,t,n,a,i){var r=e.getInternalTexture();if(!r)throw new Error("could not get internal texture!");t.updateTextureData(r,Uint8Array.from(n),a.left,a.top,a.width,a.height,void 0,void 0,i)}(n,a,(r=e,o=function(e){var t=e.indexOf(Wm)+Wm.length,n=e.substring(t);return window.atob(n)}(r),function(e){for(var t=e.length,n=new Uint8ClampedArray(t),a=0;a<t;a++)n[a]=e.charCodeAt(a);return n}(o)),t,i)}function Qm(e,t,n,a,i){if(void 0===i&&(i=!1),t)for(var r=function(e,t){return function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([],e,!0).sort(function(e,n){return(t?-1:1)*(e.id-n.id)})}(n,i),o=zm(e,t).mipMapsEnabledByLayer,s=0,c=r;s<c.length;s++)for(var d=0,l=c[s].parts;d<l.length;d++){var u=l[d],f=u.layerName,p=e[f],m=p&&(null==a?void 0:a.getAlreadyLoadedTexture(p));if(!m)throw new Error("texture missing");var _=m.parts[u.subTextureIndex].texture;if(!_)throw new Error("texturePart missing");qm(i?u.previousImageDataUri:u.imageDataUri,u.rect,_,t,o[f]||!1)}}function Ym(e,t,n,a){return Qm(e,t,n,a,!0)}var Jm=Object(s.memo)(function(e){var t=e.texturePatches,n=e.removedTexturePatches,a=e.image,i=e.notifyTextureIsRestoredToOriginal,r=e.isViewingOriginal,o=Object(s.useContext)(gl),c=o.textures,d=o.engine,l=Object(s.useMemo)(function(){return am(a)?a:im(a)},[a]),u=Object(s.useContext)(Il).renderList,f=Object(s.useRef)(-1),p=Object(s.useCallback)(function(e){f.current!==e&&(f.current=e,-1===f.current&&i())},[i]),m=Object(s.useCallback)(function(){-1!==f.current&&(Ym(l,d,t,c),u.requestRender(),p(-1))},[l,d,t,c,p,u]),_=Object(s.useCallback)(function(e){var t=n.filter(function(t){return t.id>e&&t.id<=f.current});Ym(l,d,t,c)},[l,d,n,c]),h=Object(s.useCallback)(function(){var e=t.filter(function(e){return e.id>f.current});Qm(l,d,e,c)},[l,d,t,c]);return Object(s.useEffect)(function(){var e,n;if(r)m();else{var a=(null===(e=(n=t).length>0?n[n.length-1]:void 0)||void 0===e?void 0:e.id)||-1;_(a),h(),u.requestRender(),p(a)}},[m,_,h,t,i,r,p,u]),null}),Xm={texturePatchRequests:[],pendingTexturePatchRequests:[],texturePatches:[],removedTexturePatches:[],undoRedoStack:{undoStack:[],redoStack:[],id:"TEXTURE_PATCH_UNDO_REDO_STACK_ID"},resetToDefaultsWhenTextureIsRestored:!1};function Zm(e){e.removedTexturePatches=e.removedTexturePatches.filter(function(t){return e.undoRedoStack.undoStack.find(function(e){return e.undoPayload===t.id})})}function $m(e){e.pendingTexturePatchRequests.length=0,e.texturePatchRequests.length=0}var e_,t_={undoReducer:function(e,t){$m(e),function(e,t){var n,a=e.texturePatches.findIndex(function(e){return e.id===t});if(a<0)throw new Error("texture patch not found in removeTexturePatch");(n=e.removedTexturePatches).push.apply(n,e.texturePatches.splice(a,1))}(e,t.undoPayload),e.undoRedoStack.redoStack.push(t)},redoReducer:function(e,t){$m(e),function(e,t){var n,a=e.removedTexturePatches.findIndex(function(e){return e.id===t});if(a<0)throw new Error("texture patch not found in restoreTexturePatch");(n=e.texturePatches).push.apply(n,e.removedTexturePatches.splice(a,1))}(e,t.redoPayload),e.undoRedoStack.undoStack.push(t)},removeItemsReducer:function(e,t){e.undoRedoStack.undoStack=t,Zm(e)},collapseItemsReducer:function(e,t,n){Zm(e)},afterClearRedoStacksReducer:function(e){Zm(e)}},n_=function(){return n_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n_.apply(this,arguments)};function a_(e){e.texturePatchRequests=Xm.texturePatchRequests,e.pendingTexturePatchRequests=Xm.pendingTexturePatchRequests,e.texturePatches=Xm.texturePatches,e.removedTexturePatches=Xm.removedTexturePatches,e.undoRedoStack=Xm.undoRedoStack,e.resetToDefaultsWhenTextureIsRestored=Xm.resetToDefaultsWhenTextureIsRestored}function i_(e,t){0!==e.texturePatches.length?(e.removedTexturePatches=e.removedTexturePatches.concat(function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([],e.texturePatches,!0).reverse()),e.texturePatches=[],e.resetToDefaultsWhenTextureIsRestored=!0):a_(e)}function r_(e,t){var n=t.payload.texturePatch;e.texturePatches=n.texturePatches,e.removedTexturePatches=n.removedTexturePatches,e.undoRedoStack=n.undoRedoStack}var o_,s_=Object(te.n)({name:"texturePatch",initialState:Xm,reducers:{setTexturePatchRequestPending:function(e,t){!function(e,t){var n,a=e.texturePatchRequests.findIndex(function(e){return e.id===t});a>=0&&(n=e.pendingTexturePatchRequests).push.apply(n,e.texturePatchRequests.splice(a,1))}(e,t.payload)},addTexturePatch:function(e,t){!function(e,t){if(e.pendingTexturePatchRequests.some(function(e){return e.id===t.id})){var n=t.id;e.pendingTexturePatchRequests=e.pendingTexturePatchRequests.filter(function(e){return e.id!==n}),e.texturePatches.push(t);var a=ge("texturePatchUndoRedoPayloadId",n,n,Le.KeepAll);e.undoRedoStack.undoStack.push(a)}}(e,t.payload)},notifyTextureIsRestoredToOriginal:function(e,t){!function(e){e.resetToDefaultsWhenTextureIsRestored&&a_(e)}(e)},removePendingTexturePatch:function(e,t){!function(e,t){var n=e.pendingTexturePatchRequests.findIndex(function(e){return e.id===t});if(n<0)throw new Error("texture patch not found in removePendingTexturePatchReducer");e.pendingTexturePatchRequests.splice(n,1)}(e,t.payload)}},extraReducers:function(e){e.addCase(se,i_),e.addCase(ce,r_),e.addCase(de,function(e,t){!function(e,t){if(0===t.layersToPatch.length)throw new Error("invalid layers to patch");e.texturePatchRequests.push(n_(n_({},t),{id:fe()}))}(e,t.payload)}),e.addCase(Os,function(e,t){t.payload!==ro&&t.payload!==oo&&(e.texturePatchRequests=[],e.pendingTexturePatchRequests=[])}),Se(e,t_)}}),c_=(e_=s_.actions).addTexturePatch,d_=e_.setTexturePatchRequestPending,l_=e_.notifyTextureIsRestoredToOriginal,u_=e_.removePendingTexturePatch,f_=s_.reducer,p_=function(e){return e.colorAdjustments},m_=function(e){return e.filters},__=function(e){return e.markup};function h_(e){return e.texturePatch}function b_(e){return!!e.texturePatches&&e.texturePatches.length>0}!function(e){e.Unavailable="Unavailable",e.NotInstalled="NotInstalled",e.Installing="Installing",e.Installed="Installed",e.InstallFailed="InstallFailed"}(o_||(o_={}));var g_,v_={status:o_.Installed,downloadSize:0};!function(e){e[e.ContrastStretching=0]="ContrastStretching",e[e.HistogramEqualization=1]="HistogramEqualization",e[e.ContrastStretchingAndHistogramEqualization=2]="ContrastStretchingAndHistogramEqualization"}(g_||(g_={}));var y_="autoEnhanceUndoRedoStack",S_={isAutoEnhanceOn:!1,contrastStretchingParams:{alpha:1,beta:0},level:0,enhanceAlgorithm:g_.ContrastStretching,isTexturePatchAppliedBeforeAutoEnhanceInstallation:!1,undoRedoStack:{undoStack:[],redoStack:[],id:y_}},D_={isAutoEnhanceOn:!1,contrastStretchingParams:{alpha:1,beta:0},level:1,enhanceAlgorithm:g_.ContrastStretching,undoRedoStack:{undoStack:[],redoStack:[],id:y_},waitingForAutoEnhanceLayer:!1,isTexturePatchAppliedBeforeAutoEnhanceInstallation:!1,undoPayload:void 0,autoEnhanceInstallationInfo:{status:o_.Unavailable,downloadSize:0}};function I_(e,t){return e.brightness===t.brightness&&e.exposure===t.exposure&&e.saturation===t.saturation&&e.highlights===t.highlights&&e.shadows===t.shadows&&e.contrast===t.contrast&&e.tint===t.tint&&e.vignette===t.vignette&&e.temperature===t.temperature&&e.version===t.version&&e.maskLevel===t.maskLevel}var x_={numRedSamplesPerSlice:17,numGreenSamplesPerSlice:17,numBlueSlicesPerRowIn2DLayout:2,numBlueSlicesPerColumnIn2DLayout:17},C_=[{name:"Original",lutUrlId:"",config:void 0,locStringKey:"filter_nameOriginal",ariaLabelLocStringKey:"filter_nameOriginal"},{name:"Punch",lutUrlId:"lutUrl_punch",config:x_,locStringKey:"filter_namePunch",ariaLabelLocStringKey:"filter_namePunch"},{name:"Golden",lutUrlId:"lutUrl_golden",config:x_,locStringKey:"filter_nameGolden",ariaLabelLocStringKey:"filter_nameGolden"},{name:"Radiate",lutUrlId:"lutUrl_radiate",config:x_,locStringKey:"filter_nameRadiate",ariaLabelLocStringKey:"filter_nameRadiate"},{name:"Warm Contrast",lutUrlId:"lutUrl_warmContrast",config:x_,locStringKey:"filter_nameWarmContrast",ariaLabelLocStringKey:"filter_nameWarmContrast"},{name:"Calm",lutUrlId:"lutUrl_calm",config:x_,locStringKey:"filter_nameCalm",ariaLabelLocStringKey:"filter_nameCalm"},{name:"Cool Light",lutUrlId:"lutUrl_coolLight",config:x_,locStringKey:"filter_nameCoolLight",ariaLabelLocStringKey:"filter_nameCoolLight"},{name:"Vivid Cool",lutUrlId:"lutUrl_vividCool",config:x_,locStringKey:"filter_nameVividCool",ariaLabelLocStringKey:"filter_nameVividCool"},{name:"Dramatic Cool",lutUrlId:"lutUrl_dramaticCool",config:x_,locStringKey:"filter_nameDramaticCool",ariaLabelLocStringKey:"filter_nameDramaticCool"},{name:"BW",lutUrlId:"lutUrl_bw",config:x_,locStringKey:"filter_nameBw",ariaLabelLocStringKey:"filter_nameBwAriaLabel"},{name:"BW Cool",lutUrlId:"lutUrl_bwCool",config:x_,locStringKey:"filter_nameBwCool",ariaLabelLocStringKey:"filter_nameBwCoolAriaLabel"},{name:"BW Warm",lutUrlId:"lutUrl_bwWarm",config:x_,locStringKey:"filter_nameBwWarm",ariaLabelLocStringKey:"filter_nameBwWarmAriaLabel"},{name:"BW High Contrast",lutUrlId:"lutUrl_bwHighContrast",config:x_,locStringKey:"filter_nameBwHighContrast",ariaLabelLocStringKey:"filter_nameBwHighContrastAriaLabel"},{name:"Burn",lutUrlId:"lutUrl_burn",config:x_,locStringKey:"filter_nameBurn",ariaLabelLocStringKey:"filter_nameBurn"},{name:"Film",lutUrlId:"lutUrl_film",config:x_,locStringKey:"filter_nameFilm",ariaLabelLocStringKey:"filter_nameFilm"},{name:"Vintage",lutUrlId:"lutUrl_vintage",config:x_,locStringKey:"filter_nameVintage",ariaLabelLocStringKey:"filter_nameVintage"}],O_=C_.reduce(function(e,t){return e[t.name]=1,e},{}),w_={activeFilter:C_[0],availableFilters:C_,filterLevel:1,filterLevelsByName:O_,undoRedoStack:{undoStack:[],redoStack:[],id:"filtersUndoRedoStack"},undoPayload:void 0},E_=function(e){return!!(e&&e.lutUrlId&&e.config)},A_=function(){return A_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A_.apply(this,arguments)};function L_(e,t){return E_(e.activeFilter)&&E_(t.activeFilter)&&e.activeFilter.config.numRedSamplesPerSlice===t.activeFilter.config.numRedSamplesPerSlice&&e.activeFilter.config.numGreenSamplesPerSlice===t.activeFilter.config.numGreenSamplesPerSlice&&e.activeFilter.config.numBlueSlicesPerRowIn2DLayout===t.activeFilter.config.numBlueSlicesPerRowIn2DLayout&&e.activeFilter.config.numBlueSlicesPerColumnIn2DLayout===t.activeFilter.config.numBlueSlicesPerColumnIn2DLayout&&e.activeFilter.lutUrlId===t.activeFilter.lutUrlId&&e.activeFilter.name===t.activeFilter.name&&e.filterLevel===t.filterLevel||!E_(e.activeFilter)&&!E_(t.activeFilter)}function k_(e){return A_({},e)}function M_(e,t){return e.level===t.level}function P_(e,t){var n=e.markupContentItems||[],a=t.markupContentItems||[];return n.length===a.length&&n.every(function(e,t){return e.id===a[t].id})}var T_=function(){return T_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},T_.apply(this,arguments)};function U_(e,t){var n,a=e.markupContentItems.filter(function(e){return t.includes(e.id)});(n=e.removedMarkupContentItems).push.apply(n,a),e.markupContentItems=e.markupContentItems.filter(function(e){return!t.includes(e.id)})}var F_={undoReducer:function(e,t){H_(e,t.undoPayload),e.undoRedoStack.redoStack.push(t)},redoReducer:function(e,t){H_(e,t.redoPayload),e.undoRedoStack.undoStack.push(t)},removeItemsReducer:function(e,t){e.undoRedoStack.undoStack=t},collapseItemsReducer:function(e,t,n){},afterClearRedoStacksReducer:function(e){var t,n=(t=e.undoRedoStack.undoStack.map(function(e){var t=[],n=e.undoPayload,a=n.markupContentIdsToAdd,i=n.markupContentIdsToRemove;return a&&t.push.apply(t,a),i&&t.push.apply(t,i),t}),t.reduce(function(e,t){return e.concat(t)},[]));e.removedMarkupContentItems=e.removedMarkupContentItems.filter(function(e){return null==n?void 0:n.includes(e.id)})}};function H_(e,t){var n=t.markupContentIdsToAdd,a=t.markupContentIdsToRemove,i=t.contentIdToReplace,r=t.replacementContent;if(n&&function(e,t){var n,a=e.removedMarkupContentItems.filter(function(e){return t.includes(e.id)});(n=e.markupContentItems).push.apply(n,a),e.removedMarkupContentItems=e.removedMarkupContentItems.filter(function(e){return!t.includes(e.id)})}(e,n),a&&U_(e,a),i&&r){var o=e.markupContentItems.findIndex(function(e){return e.id===i});o>=0&&(e.markupContentItems[o]=r)}}var R_,N_=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};function B_(e){switch(e){case R_.InkContent:return"markupInkContent";case R_.TextContent:return"markupTextContent";default:throw new h(e)}}!function(e){e[e.InkContent=0]="InkContent",e[e.TextContent=1]="TextContent"}(R_||(R_={}));var j_,V_=Object(te.t)("MarkupSlice/updateMarkupContent",function(e,t){return void 0===t&&(t=!0),{payload:{content:e,isUndoRedoable:t}}}),z_={markupContentItems:[],removedMarkupContentItems:[],undoRedoStack:{undoStack:[],redoStack:[],id:"markupUndoRedoStack"}},G_=Object(te.n)({name:"MarkupSlice",initialState:z_,reducers:{addMarkupContent:{reducer:function(e,t){e.markupContentItems.push(t.payload);var n=ge(B_(t.payload.contentType),{markupContentIdsToRemove:[t.payload.id]},{markupContentIdsToAdd:[t.payload.id]},Le.KeepAll);e.undoRedoStack.undoStack.push(n)},prepare:function(e){return{payload:(t=e,n=fe(),T_(T_({},t),{id:n}))};var t,n}},removeMarkupContent:function(e,t){!function(e,t){var n=t.payload;U_(e,n);var a=ge("markupEraseInkContent",{markupContentIdsToAdd:n},{markupContentIdsToRemove:n},Le.KeepAll);e.undoRedoStack.undoStack.push(a)}(e,t)},clearAllMarkupContent:function(e,t){!function(e,t){var n=e.markupContentItems.map(function(e){return e.id});U_(e,n),t.telemetry&&t.telemetry.logClearAllMarkupEvent({numberOfMarkupRemoved:n.length});var a=ge("markupClearAllMarkupContent",{markupContentIdsToAdd:N_([],n,!0)},{markupContentIdsToRemove:N_([],n,!0)},Le.KeepAll);e.undoRedoStack.undoStack.push(a)}(e,t)},setActiveMarkupContentId:function(e,t){e.activeMarkupContentId=t.payload},setMarkupTextSelection:function(e,t){e.markupTextSelection=t.payload}},extraReducers:function(e){e.addCase(se,function(e,t){e.markupContentItems=z_.markupContentItems,e.removedMarkupContentItems=z_.removedMarkupContentItems,e.undoRedoStack=z_.undoRedoStack}).addCase(ce,function(e,t){var n=t.payload.markup,a=n.markupContentItems,i=n.undoRedoStack;a&&(e.markupContentItems=a),i&&(e.undoRedoStack=i)}).addCase(V_,function(e,t){var n=t.payload;!function(e,t,n){void 0===n&&(n=!0);var a=e.markupContentItems.findIndex(function(e){return e.id===t.id});if(a>=0){if(Wc(e.markupContentItems[a],t,5))return;if(n){var i=ge(B_(t.contentType),{contentIdToReplace:t.id,replacementContent:e.markupContentItems[a]},{contentIdToReplace:t.id,replacementContent:t},Le.KeepAll);e.undoRedoStack.undoStack.push(i)}e.markupContentItems[a]=t}}(e,n.content,n.isUndoRedoable)}),Se(e,F_)}}),K_=(j_=G_.actions).addMarkupContent,W_=j_.removeMarkupContent,q_=j_.clearAllMarkupContent,Q_=j_.setActiveMarkupContentId,Y_=j_.setMarkupTextSelection,J_=G_.reducer;function X_(e){return function(e){var t=e.cropRectangle,n=e.imageTransform,a=e.originalImageSize,i=gi(t),r=ui(Wr(n),i,5),o=!ja(n.height,a.y,5)||!ja(n.width,a.x,5);return!r||o}(e.transforms)||(t=e.adjustments,n=e.filters,a=e.autoEnhance,i=e.markup,r=!!t&&!I_(t,Te),o=!L_(n,k_(w_)),s=!M_(a,S_),c=!P_(i,z_),r||o||s||c)||b_(e.texturePatch);var t,n,a,i,r,o,s,c}var Z_=function(){return Z_=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Z_.apply(this,arguments)};function $_(e,t,n,a,i,r){return{transforms:{imageTransform:qr(e.imageMatrix),cropRectangle:vi(e.cropMatrix),originalImageSize:Z_({},e.originalImageSize),aspectRatio:e.aspectRatio,shouldInvertOriginalAspectRatio:e.shouldInvertOriginalAspectRatio,undoRedoStack:e.undoRedoStack},adjustments:t,filters:n,autoEnhance:Z_(Z_({},a),{level:a.isAutoEnhanceOn&&!a.waitingForAutoEnhanceLayer?a.level:0}),version:1,markup:i,texturePatch:{texturePatches:r.texturePatches,removedTexturePatches:r.removedTexturePatches,undoRedoStack:r.undoRedoStack}}}var eh=Object(ga.e)([qo,p_,m_,Zf,__,h_],function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=$_.apply(void 0,e);return X_(n)}),th=Object(ga.e)([p_,m_,Zf,__,h_,Hp,Wo,Lo],function(e,t,n,a,i,r,o,s){var c=eh({transformTools:Io,colorAdjustments:e,filters:t,autoEnhance:n,markup:a,texturePatch:i}),d=!o,l=s===cr.draggingView;return r&&c&&d&&!l}),nh={notifyTextureIsRestoredToOriginal:l_},ah=Object(ee.connect)(function(e,t){return{texturePatches:e.texturePatch.texturePatches,removedTexturePatches:e.texturePatch.removedTexturePatches,isViewingOriginal:th(e)}},nh)(Jm);function ih(e){return!!e&&e.width>=1&&e.height>=1}var rh=function(){return rh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},rh.apply(this,arguments)};function oh(e,t){return rh(rh({},e),{left:e.left-t.left,top:e.top-t.top})}function sh(e,t,n){var a=document.createElement("canvas");a.width=t.width,a.height=t.height;var i=a.getContext("2d");if(!i)throw new Error("could not get context for canvas");return e.parts.forEach(function(e){!function(e,t,n,a){var i=hn(t,e.rect);if(i&&ih(i)){var r=oh(i,e.rect),o=e.texture;if(!o)throw new Error("texture part texture is missing");var s=function(e,t,n){if(!t)throw new Error("engine not available!");if(!t._gl)throw new Error("gl not available!");var a=e.getInternalTexture();if(!a)throw new Error("could not get internal texture!");var i=n.left,r=n.top,o=n.width,s=n.height,c=new Uint8Array(n.width*n.height*4);return t._readTexturePixelsSync(a,o,s,void 0,void 0,c,void 0,void 0,i,r),Uint8ClampedArray.from(c)}(o,n,r),c=new ImageData(s,r.width,r.height),d=i.left-t.left,l=i.top-t.top;a.putImageData(c,d,l)}}(e,t,n,i)}),i.getImageData(0,0,a.width,a.height).data}function ch(){var e=Object(s.useContext)(gl),t=e.textures,n=e.engine;return Object(s.useCallback)(function(e,a){var i=e&&(null==t?void 0:t.getAlreadyLoadedTexture(e));if(!i)throw new Error("texture not found");if(!n)throw new Error("engine not defined");return{bytes:sh(i,a,n),format:Xp.RGBA}},[n,t])}var dh=Object(s.createContext)({enableAdjustments:!1,enableFilters:!1,enableAutoEnhance:!1,useBuiltInAutoEnhance:!1,autoEnhanceInstallationInfo:v_,enableMarkup:!1,enableSpotFix:!1,experimental_enableInPainting:!1,experimental_enableMaskLayer:!1,enableUndoRedo:!1,enableMarkupText:!1}),lh=Object(s.createContext)({image:null,setImage:function(e){},setImageLayer:function(){},offscreenRenderer:null,setOffscreenRenderer:function(){},onRequestAutoEnhance:function(){},onRequestAutoEnhanceInstall:function(){}});function uh(e){var t=Object(s.useContext)(lh).image;return am(t)?!!t[e]:"main"===e&&!!t}function fh(e,t,n,a,i,r){var o=Object(s.useRef)(!1),c=uh("blend"),d=Object(s.useRef)(!c),l=Object(s.useContext)(lh).onRequestAutoEnhance;if(!e&&(c&&n&&a(!1),d.current&&c&&(d.current=!1,o.current&&(null==r||r(),o.current=!1)),t&&!c&&!n)){if(o.current=!0,null==i||i(),a(!0),!l)throw new Error("image does not have auto-enhance/blend layer and onRequestAutoEnhance callback was not provided");l()}}var ph={main:Pm.main,blend:Pm.blend,overlay:Pm.overlay,mask:Pm.mask};function mh(e,t){var n=Object(s.useContext)(gl),a=n.textures,i=zm(t,n.engine).mipMapsEnabledByLayer,r=Um();jm(im(t)[e],ph[e],a,i[e]||void 0,r)}var _h,hh=function(){return hh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},hh.apply(this,arguments)},bh=["main","blend","overlay","mask"];function gh(e){if(e.max<e.min)throw new Error("bounds.max < bounds.min");return e.max-e.min}!function(e){e.spotFix="spotFix",e.dallE2="dallE2",e.stableDiffusion="stableDiffusion",e.colorReplacement="colorReplacement"}(_h||(_h={}));var vh=function(){return vh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},vh.apply(this,arguments)};function yh(e,t,n){var a=vh({},e),i=Math.max(0,n-gh(a)),r=Math.floor(i/2);a.min-=r,a.max+=r,a.max+=i%2;var o=!1;a.min<t.min&&(a.min=t.min,o=!0);var s=!1;if(a.max>t.max&&(a.max=t.max,s=!0),s===o)return a;var c=n-gh(a);return o?a.max=Math.min(a.max+c,t.max):a.min=Math.max(a.min-c,t.min),a}function Sh(e){return{x:{min:e.left,max:e.left+e.width},y:{min:e.top,max:e.top+e.height}}}function Dh(e,t,n,a){var i,r=Sh(e),o=Sh(t);return{top:(i={x:yh(r.x,o.x,n),y:yh(r.y,o.y,a)}).y.min,left:i.x.min,width:i.x.max-i.x.min,height:i.y.max-i.y.min}}var Ih,xh=function(){return xh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xh.apply(this,arguments)};function Ch(e,t){t=xh({},t);var n=xh({},t),a=3*Math.max(t.width,t.height);return{maskBoundsRectInImage:t,sampleRectInImage:n=Dh(n,e,a,a)}}function Oh(e,t){t=xh({},t);var n=xh({},t),a=3*Math.max(t.width,t.height),i=Math.max(a,1024);return{maskBoundsRectInImage:t,sampleRectInImage:n=Dh(n,e,i,i)}}function wh(e,t){return{maskBoundsRectInImage:xh({},t),sampleRectInImage:xh({},t)}}function Eh(e){var t=Math.round(e.center.y-e.radius),n=Math.round(e.center.x-e.radius),a=Math.round(2*e.radius);return{top:t,left:n,width:a,height:a}}function Ah(e){var t=Lm(e);if(!t)throw new Error("unOrientedSize not defined");return{top:0,left:0,width:t.x,height:t.y}}function Lh(e,t,n,a,i){if(n.maskType!==Ih.CircleMask)throw new Error("only circle masks are supported");if(!e)throw new Error("image not defined");var r=Ah(e),o=Eh(n.pixelCircle);if(!hn(o,r))throw new Error("no intersection rectangle");var s=i(r,o),c=s.maskBoundsRectInImage,d=s.sampleRectInImage,l=am(e)?e:im(e),u={main:null,blend:null,overlay:null,mask:null},f={main:null,blend:null,overlay:null,mask:null};return a.forEach(function(e){var n=l[e];if(!n)throw new Error("layer image not set");u[e]=function(e,t,n,a){if(!e)throw new Error("layer image not set");var i=t(e,n);return function(e,t,n,a,i){void 0===a&&(a=4),void 0===i&&(i=3);var r=n.width/2,o=t.width,s=n.left-t.left+r,c=n.top-t.top+r,d=s-r,l=c-r,u=s+r,f=c+r,p=r*r,m=new Uint8ClampedArray(e.length);m.set(e);for(var _=e.length/a,h=0;h<_;h++){var b=h%o;if(!(b<d||b>u)){var g=Math.floor(h/o);if(!(g<l||g>f)){var v=b-s,y=g-c;v*v+y*y<p&&(m[h*a+i]=0)}}}return m}(i.bytes,n,a,om(i.format))}(n,t,d,c),f[e]=t(n,d).bytes}),{id:n.id,maskBoundsRectInImage:c,sampleRectInImage:d,layerBytesMask:u,layerBytesOriginalPixels:f,maskType:Ih.CircleMask}}function kh(e,t,n,a,i){if(n.maskType!==Ih.FromMaskLayer)throw new Error("only markup masks are supported");if(!e)throw new Error("image not defined");var r=Ah(e),o=am(e)?e:im(e);if(!o.main)throw new Error("main image layer is missing");if(!o.mask)throw new Error("layerGroupImage.mask not defined");var s=t(o.mask,r),c=function(e,t){for(var n=Number.MAX_VALUE,a=Number.MIN_VALUE,i=Number.MAX_VALUE,r=Number.MIN_VALUE,o=e.bytes,s=e.format,c=om(s),d=sm(s),l=t*c,u=d;u<o.length;u+=c)if(0!==o[u]){var f=Math.floor(u/l),p=(u-d)/c%t;n=Math.min(n,p),a=Math.max(a,p),i=Math.min(i,f),r=Math.max(r,f)}if(n!==Number.MAX_VALUE)return{top:i,left:n,width:a-n,height:r-i}}(s,r.width);if(void 0===c)throw new Error("layerGroupImage.mask does not have any pixels with non-zero alpha. using whole image rectangle instead");var d=i(r,c),l=d.maskBoundsRectInImage,u=d.sampleRectInImage,f={main:null,blend:null,overlay:null,mask:null},p={main:null,blend:null,overlay:null,mask:null};return a.forEach(function(e){var n=o[e];if(n){p[e]=t(n,u).bytes;for(var a=fm(s.bytes,r.width,u,om(s.format),Uint8ClampedArray),i=sm(s.format),c=om(s.format),d=i;d<a.length;d+=c)a[d]=0===a[d]?255:0;f[e]=a}}),{id:n.id,maskBoundsRectInImage:l,sampleRectInImage:u,layerBytesMask:f,layerBytesOriginalPixels:p,maskType:n.maskType}}function Mh(e,t){return dn(vi(ci(gi(t),e)))}function Ph(e,t){var n;return wa(ni(n=ci(Ka(t.x,t.y),e)))/wa(ai(n))}function Th(e,t,n,a,i){if(n.maskType!==Ih.PillShapedMask)throw new Error("only circle masks are supported");if(!e)throw new Error("image not defined");var r=Ah(e),o=Mh(n.rectUvToImageUv,r);if(!hn(o,r))throw new Error("no intersection rectangle");var s=i(r,o),c=s.sampleRectInImage,d=s.maskBoundsRectInImage,l=am(e)?e:im(e),u={main:null,blend:null,overlay:null,mask:null},f={main:null,blend:null,overlay:null,mask:null};return a.forEach(function(e){var a=l[e];if(!a)throw new Error("layer image not set");var i=t(a,c);u[e]=function(e,t,n,a,i,r){void 0===i&&(i=4),void 0===r&&(r=3);var o=n.width,s=new Uint8ClampedArray(t.length);s.set(t);for(var c=t.length/i,d=ei(a),l=Ph(a,{x:e.width,y:e.height}),u=.5/l,f=1-u,p=0;p<c;p++){var m=p%o,_=Math.floor(p/o),h=ti(d,{x:(m+n.left)/e.width,y:(_+n.top)/e.height}),b=h.x>=0&&h.x<=1&&h.y>=0&&h.y<=1,g=p*i+r;if(s[g]=255,b){if(h.x<u){if(Math.hypot((h.x-u)*l,h.y-.5)>.5)continue}else if(h.x>f&&Math.hypot((h.x-f)*l,h.y-.5)>.5)continue;s[g]=0}}return s}(r,i.bytes,c,n.rectUvToImageUv),f[e]=t(a,c).bytes}),{id:n.id,maskBoundsRectInImage:d,sampleRectInImage:c,layerBytesMask:u,layerBytesOriginalPixels:f,maskType:n.maskType}}function Uh(e,t,n,a,i){if(n.maskType!==Ih.RectangleMask)throw new Error("only rectangle masks are supported");if(!e)throw new Error("image not defined");var r=Ah(e),o=Mh(n.rectUvToImageUv,r);if(!hn(o,r))throw new Error("no intersection rectangle");var s=i(r,o),c=s.sampleRectInImage,d=s.maskBoundsRectInImage,l=am(e)?e:im(e),u={main:null,blend:null,overlay:null,mask:null},f={main:null,blend:null,overlay:null,mask:null};return a.forEach(function(e){var a=l[e];if(!a)throw new Error("layer image not set");var i=t(a,c);u[e]=function(e,t,n,a,i,r){void 0===i&&(i=4),void 0===r&&(r=3);var o=n.width,s=new Uint8ClampedArray(t.length);s.set(t);for(var c=t.length/i,d=ei(a),l=0;l<c;l++){var u=l%o,f=Math.floor(l/o),p=ti(d,{x:(u+n.left)/e.width,y:(f+n.top)/e.height});p.x>=0&&p.x<=1&&p.y>=0&&p.y<=1&&(s[l*i+r]=0)}return s}(r,i.bytes,c,n.rectUvToImageUv),f[e]=t(a,c).bytes}),{id:n.id,maskBoundsRectInImage:d,sampleRectInImage:c,layerBytesMask:u,layerBytesOriginalPixels:f,maskType:n.maskType}}function Fh(e){return new Promise(function(t,n){var a=new Blob([e]),i=new FileReader;i.onload=function(e){var a,i;if(e.loaded)if(null===(a=e.target)||void 0===a?void 0:a.result){var r=null===(i=e.target)||void 0===i?void 0:i.result;t(r)}else n()},i.readAsDataURL(a)})}function Hh(e,t){var n=hn(e,t);if(n)return oh(n,t)}function Rh(e){return e.reduce(function(e,t){return void 0!==t&&e.push(t),e},[])}!function(e){e[e.CircleMask=0]="CircleMask",e[e.FromMaskLayer=1]="FromMaskLayer",e[e.RectangleMask=2]="RectangleMask",e[e.PillShapedMask=3]="PillShapedMask"}(Ih||(Ih={}));var Nh=function(){return Nh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Nh.apply(this,arguments)};function Bh(e,t,n,a,i,r,o,s,c,d){return void 0===c&&(c=4),void 0===d&&(d=!1),l=this,void 0,f=function(){var l,u,f,p,m,_,h;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(b){switch(b.label){case 0:return l=t(e,a),u=Nh(Nh({},a),{top:a.top-i.top,left:a.left-i.left}),f=fm(r,i.width,u,c,Uint8ClampedArray),s&&(p=function(e,t,n){void 0===n&&(n=4);var a,i,r,o=function(e,t){void 0===t&&(t=4);for(var n=0,a=0;a<e.length;a+=t)e[a]+e[a+1]+e[a+2]===0&&n++;return n}(e,n);return o>=(i=(a=t).width)*(r=a.height)-r-i+1}(f,u),p&&(s(i),f.set(l.bytes))),m=n(e).map(function(e,t){return function(e,t,n,a,i,r,o){return s=this,d=function(){var s,c,d,l,u,f;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(p){switch(p.label){case 0:if(!(s=Hh(e,n))||!ih(s))return[2,void 0];if(!(c=Hh(n,e))||!ih(c))throw new Error("textureRectInTexturePatchRect not found!");return d=om(Xp.RGBA),l=fm(i,e.width,c,d,Uint8ClampedArray),u=fm(r,e.width,c,d,Uint8ClampedArray),o&&function(e,t,n,a,i,r,o){for(var s=_n(e),c=t.left+n.left,d=t.top+n.top,l=s.x-c,u=s.y-d,f=e.width/2,p=f*f,m=.8*f,_=m*m,h=i.length/o,b=0;b<h;b++){var g=l-b%a.width,v=u-Math.floor(b/a.width),y=g*g+v*v;if(!(y>p||y<_))for(var S=(Math.sqrt(y)/f-.8)/.19999999999999996,D=b*o,I=D;I<D+3;I++)i[I]=i[I]+S*(r[I]-i[I])}}(e,s,n,c,u,l,d),f={rect:s},[4,Fh(l)];case 1:return f.previousImageDataUri=p.sent(),[4,Fh(u)];case 2:return[2,(f.imageDataUri=p.sent(),f.subTextureIndex=a,f.layerName=t,f)]}})},new((c=void 0)||(c=Promise))(function(e,t){function n(e){try{i(d.next(e))}catch(e){t(e)}}function a(e){try{i(d.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof c?i:new c(function(e){e(i)})).then(n,a)}i((d=d.apply(s,[])).next())});var s,c,d}(a,o,e.rect,t,l.bytes,f,d)}),h=Rh,[4,Promise.all(m)];case 1:if(0===(_=h.apply(void 0,[b.sent()])).length)throw new Error("no patch parts created in createSingleTexturePatchesFromTexturePatchResponse");return[2,_]}})},new((u=void 0)||(u=Promise))(function(e,t){function n(e){try{i(f.next(e))}catch(e){t(e)}}function a(e){try{i(f.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof u?i:new u(function(e){e(i)})).then(n,a)}i((f=f.apply(l,[])).next())});var l,u,f}function jh(e,t,n,a,i,r){return void 0===r&&(r=!1),o=this,void 0,c=function(){var o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(D){switch(D.label){case 0:o=e.id,s=e.maskBoundsRectInImage,c=e.sampleRectInImage,d=e.outputLayerBytes,l=am(t)?t:im(t),u=[],f=c.width*c.height,p=0,m=bh,D.label=1;case 1:return p<m.length?(_=m[p],h=l[_],b=d[_],h&&b?(g=b.length/f,y=(v=u.push).apply,S=[u],[4,Bh(h,n,a,s,c,b,_,i,g,r)]):[3,3]):[3,4];case 2:y.apply(v,S.concat([D.sent()])),D.label=3;case 3:return p++,[3,1];case 4:return[2,{parts:u,id:o}]}})},new((s=void 0)||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s(function(e){e(i)})).then(n,a)}i((c=c.apply(o,[])).next())});var o,s,c}var Vh=function(){return Vh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vh.apply(this,arguments)};function zh(e,t,n){var a=function(e,t,n){if(e.length!==t*n*4)throw new Error("unexpected byte length");var a=document.createElement("canvas");a.width=t,a.height=n;var i=a.getContext("2d");if(!i)throw new Error("could not get canvas context");var r=i.createImageData(t,n),o=0,s=0,c=0;for(c=0;c<t*n;c++)r.data[s]=e[o],r.data[s+1]=e[o+1],r.data[s+2]=e[o+2],r.data[s+3]=e[o+3],o+=4,s+=4;return i.putImageData(r,0,0),a}(e,t,n);return a.toDataURL("png")}function Gh(e){return new Promise(function(t,n){var a=URL.createObjectURL(e),i=document.createElement("img");i.onload=function(){var e=document.createElement("canvas");e.width=i.naturalWidth,e.height=i.naturalHeight;var a=e.getContext("2d");if(null!==a){a.drawImage(i,0,0);var r=a.getImageData(0,0,e.width,e.height);t(r.data)}else n("no canvas context!")},i.onerror=function(){n("image error")},i.src=a})}function Kh(e,t){return 0===bh.filter(function(n){return n!==t&&function(e,t){return!!e[t]}(e,n)}).length}var Wh=function(){return Wh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Wh.apply(this,arguments)};function qh(e,t,n,a,i){return r=this,void 0,s=function(){var r,o,s,c,d,l,u,f,p,m,_,h;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(b){switch(b.label){case 0:if(r="https://edithvc-inpaint.westus.cloudapp.azure.com:3333/imgInpaint",e.algorithmType!==_h.dallE2&&e.algorithmType!==_h.stableDiffusion)throw new Error("not a dalle or stable diffusion request");if(o="main",!Kh(t.layerBytesOriginalPixels,o))throw new Error("unsupported layers in texturePatchWorkerRequest.layerBytesOriginalPixels");if(!Kh(t.layerBytesMask,o))throw new Error("unsupported layers in texturePatchWorkerRequest.layerBytesMask");if(s=t.layerBytesOriginalPixels[o],c=t.layerBytesMask[o],!s||!c)throw new Error("pixel data is missing from main layer");d=t.sampleRectInImage.width,l=t.sampleRectInImage.height,u=zh(s,d,l),f=null,p=zh(c,d,l),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({originalImagePngUri:u,maskPngUri:p,width:d,height:l,prompt:e.prompt,algorithm:e.algorithmType,upscale:!0,featherRadius:10})})];case 2:return f=b.sent(),[3,4];case 3:return b.sent(),[2,Promise.reject()];case 4:return f?(_=Gh,[4,f.blob()]):[2,Promise.reject()];case 5:return[4,_.apply(void 0,[b.sent()])];case 6:return m=b.sent(),(h={main:null,blend:null,overlay:null,mask:null})[o]=m,[2,jh(Wh(Wh({},t),{outputLayerBytes:h}),n,a,i)]}})},new((o=void 0)||(o=Promise))(function(e,t){function n(e){try{i(s.next(e))}catch(e){t(e)}}function a(e){try{i(s.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o(function(e){e(i)})).then(n,a)}i((s=s.apply(r,[])).next())});var r,o,s}var Qh,Yh=function(){return Yh=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Yh.apply(this,arguments)},Jh=((Qh={})[_h.spotFix]=function(e,t,a,i,r){var o=this;return new Promise(function(e,s){(function(){return e=this,void 0,a=function(){var e,t,a,i;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,n.e(4).then(n.bind(null,"DGkI"))];case 1:return e=r.sent(),t=e.default,a=new t,[2,new Promise(function(e,t){a.onmessage=function(n){n.data.wasmLoaded?e(a):t('unexpected message from worker. "wasmLoaded" was not present in the message.')},a.postMessage({initiateWasm:!0})})];case 2:throw i=r.sent(),new Error("Failed to load worker: ".concat(i));case 3:return[2]}})},new((t=void 0)||(t=Promise))(function(n,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t(function(e){e(a)})).then(r,o)}s((a=a.apply(e,[])).next())});var e,t,a})().then(function(n){if(n){var c=s,d=Yh(Yh({},t),function(e,t,n){void 0===t&&(t=3),void 0===n&&(n=4);for(var a={layerBytesWithAlpha0inAreasToFix:{main:null,blend:null,overlay:null,mask:null}},i=0,r=bh;i<r.length;i++){var o=r[i],s=e.layerBytesOriginalPixels[o];if(s){var c=new Uint8ClampedArray(s.length);c.set(s);var d=e.layerBytesMask[o];if(!d)throw new Error("mask bytes are missing");if(d.length!==s.length)throw new Error("mask and original bytes have different length");for(var l=t;l<c.length;l+=n)c[l]=d[l];a.layerBytesWithAlpha0inAreasToFix[o]=c}}return a}(t));n.onmessage=function(t){return n=o,void 0,l=function(){var n,o,d,l;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(u){switch(u.label){case 0:return function(e){return"number"==typeof e.id&&void 0!==e.maskBoundsRectInImage&&void 0!==e.outputLayerBytes}(n=t.data)?(d=(o=n).maskType===Ih.CircleMask,[4,jh(o,a,i,r,c,d)]):[3,2];case 1:return l=u.sent(),e(l),[3,3];case 2:s("unhandled message from worker!"),u.label=3;case 3:return[2]}})},new((d=void 0)||(d=Promise))(function(e,t){function a(e){try{r(l.next(e))}catch(e){t(e)}}function i(e){try{r(l.throw(e))}catch(e){t(e)}}function r(t){var n;t.done?e(t.value):(n=t.value,n instanceof d?n:new d(function(e){e(n)})).then(a,i)}r((l=l.apply(n,[])).next())});var n,d,l},n.postMessage(d)}else s("could not obtain worker")}).catch(s)})},Qh[_h.dallE2]=qh,Qh[_h.stableDiffusion]=qh,Qh[_h.colorReplacement]=function(e,t,n,a,i){return r=this,void 0,s=function(){var r,o;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(s){switch(s.label){case 0:if(e.algorithmType!==_h.colorReplacement)throw new Error("unexpected algorithm type");return r=e.layersToPatch,o={main:null,blend:null,overlay:null,mask:null},r.forEach(function(n){var a=t.layerBytesOriginalPixels[n];if(!a)throw new Error("pixel data is missing");var i=t.layerBytesMask[n];if(!i)throw new Error("maskBytes missing");var r=new Uint8ClampedArray(a);!function(e,t,n,a,i){void 0===a&&(a=3),void 0===i&&(i=4);for(var r=new Uint8ClampedArray(n.map(function(e){return Math.round(255*e)})),o=a;o<e.length;o+=i)if(0===t[o])for(var s=0;s<i;s++)e[o-a+s]=r[s]}(r,i,e.color),o[n]=r}),[4,jh(Vh(Vh({},t),{outputLayerBytes:o}),n,a,i)];case 1:return[2,s.sent()]}})},new((o=void 0)||(o=Promise))(function(e,t){function n(e){try{i(s.next(e))}catch(e){t(e)}}function a(e){try{i(s.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o(function(e){e(i)})).then(n,a)}i((s=s.apply(r,[])).next())});var r,o,s},Qh);function Xh(e,t,n,a,i){return r=this,void 0,s=function(){var r,o;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(s){return r=function(e,t,n,a){var i=function(e){var t;return((t={})[_h.spotFix]=Ch,t[_h.dallE2]=Oh,t[_h.stableDiffusion]=Oh,t[_h.colorReplacement]=wh,t)[e]}(e.algorithmType),r=function(e){var t;return((t={})[Ih.CircleMask]=Lh,t[Ih.RectangleMask]=Uh,t[Ih.FromMaskLayer]=kh,t[Ih.PillShapedMask]=Th,t)[e]}(e.maskType);return r(t,n,e,a,i)}(e,t,n,i),[2,(0,Jh[(o=e).algorithmType])(o,r,t,n,a)]})},new((o=void 0)||(o=Promise))(function(e,t){function n(e){try{i(s.next(e))}catch(e){t(e)}}function a(e){try{i(s.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof o?i:new o(function(e){e(i)})).then(n,a)}i((s=s.apply(r,[])).next())});var r,o,s}var Zh,$h,eb=Object(s.memo)(function(e){var t=this,n=e.texturePatchRequests,a=e.hasPendingRequests,i=e.texturePatches,r=e.addTexturePatch,o=e.removePendingTexturePatch,c=e.setTexturePatchRequestPending,d=e.image,l=e.waitingForAutoEnhanceLayer,u=e.setWaitingForAutoEnhanceLayer,f=e.addUserFacingErrorMessage,p=Object(s.useRef)(d);p.current=d;var m,_,h=ch(),b=(m=Object(s.useContext)(gl).textures,Object(s.useCallback)(function(e){var t=e&&(null==m?void 0:m.getAlreadyLoadedTexture(e));if(!t)throw new Error("texture not found in getTextureParts");return t.parts},[m])),g=function(e,t,n,a){var i=Object(s.useContext)(gl).textures,r=Object(s.useContext)(dh).autoEnhanceInstallationInfo,o=Object(s.useContext)(dh).useBuiltInAutoEnhance,c=r.status===o_.Installed;return fh(o,!(!a.blend||!c),t,n),function(e,t,n){var a=Object(s.useContext)(lh).setImageLayer,i=Object(s.useRef)(!1),r=Object(s.useContext)(Em),o=Mm(n,r);i.current||t&&!im(n).mask&&n&&o&&(i.current=!0,window.setTimeout(function(){a(e,function(e,t){var n=Lm(e);if(!n)return null;var a=Xp.RGBA,i={width:n.x,height:n.y,orientation:hm(e),id:"mask"+Sl().toString(),format:a},r=n.x*n.y*om(a);return hh(hh({},i),{bytes:new Uint8Array(r)})}(n))}))}("mask",!0===a.mask,e),mh("blend",e),mh("mask",e),Mm(e,Object(s.useContext)(Em))&&function(e,t,n){return bh.every(function(a){return!(!e||!t)&&(!0!==n[a]||function(e,t,n){var a=im(t)[n];return!(null===a||!e)&&void 0!==e.getAlreadyLoadedTexture(a)}(e,t,a))})}(i,e,a)}(d,l,u,(_={main:null,blend:null,overlay:null,mask:null},n.forEach(function(e){e.layersToPatch.forEach(function(e){_[e]=!0})}),_)),v=function(){var e=Object(s.useContext)(Zt),t=e.startTimedTelemetryEvent,n=e.endTimedTelemetryEvent,a=e.getTelemetryEventData,i=e.logTexturePatchCreationError;return Object(s.useMemo)(function(){return{start:function(e){var n=a("texturePatchApplied",function(e){return{type:e.algorithmType.toString(),maskType:e.maskType.toString()}}(e));return t(n,1e4)},end:function(e,t){n(e)},error:function(e,t){i({width:0,height:0})}}},[t,n,a,i])}();return Object(s.useEffect)(function(){if(g&&!a){var e=function(e,t){e:for(var n=0,a=e;n<a.length;n++){for(var i=a[n],r=0,o=t;r<o.length;r++){var s=o[r];if(i.id===s.id)continue e}return i}}(n,i);if(e){c(e.id);var s=e.layersToPatch;d=t,void 0,u=function(){var t,n;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(a){switch(a.label){case 0:t=v.start(e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Xh(e,p.current,h,b,s)];case 2:return n=a.sent(),v.end(t,e),r(n),[3,4];case 3:return a.sent(),v.error(t,e),o(e.id),e.algorithmType!==_h.dallE2&&e.algorithmType!==_h.stableDiffusion||f({id:Dt(),title:"Failed to generate texture patch",message:"Please try again."}),[3,4];case 4:return[2]}})},new((l=void 0)||(l=Promise))(function(e,t){function n(e){try{i(u.next(e))}catch(e){t(e)}}function a(e){try{i(u.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof l?i:new l(function(e){e(i)})).then(n,a)}i((u=u.apply(d,[])).next())})}}var d,l,u},[r,b,n,i,c,d,h,g,v,a,f,o]),null}),tb={undoReducer:function(e,t){e.undoRedoStack.redoStack.push(t),e.level=t.undoPayload.level,e.isAutoEnhanceOn=t.undoPayload.isAutoEnhanceOn},redoReducer:function(e,t){e.undoRedoStack.undoStack.push(t),e.level=t.redoPayload.level,e.isAutoEnhanceOn=t.redoPayload.isAutoEnhanceOn},removeItemsReducer:function(e,t){e.undoRedoStack.undoStack=t},collapseItemsReducer:function(e,t,n){e.undoRedoStack.undoStack=e.undoRedoStack.undoStack.filter(function(e){return e.sequence!==t.payload.start&&e.sequence!==t.payload.end}),e.undoRedoStack.undoStack.push(n)}},nb="autoEnhance",ab=Object(te.n)({name:"autoEnhance",initialState:D_,reducers:{setLevel:function(e,t){if(e.undoPayload||(e.undoPayload={level:e.level,isAutoEnhanceOn:e.isAutoEnhanceOn}),e.level=t.payload.level,t.payload.isUndoRedoable){var n={level:t.payload.level,isAutoEnhanceOn:e.isAutoEnhanceOn},a=ge(nb,e.undoPayload,n,Le.KeepAll);e.undoRedoStack.undoStack.push(a),e.undoPayload=void 0}},setIsAutoEnhanceOn:function(e,t){var n={level:e.level,isAutoEnhanceOn:e.isAutoEnhanceOn};e.isAutoEnhanceOn=t.payload;var a={level:e.level,isAutoEnhanceOn:t.payload};if(e.isAutoEnhanceOn){var i=ge(nb,n,a,Le.KeepAll);e.undoRedoStack.undoStack.push(i)}},setAutoEnhanceParameters:function(e,t){e.contrastStretchingParams=t.payload},setEnhanceAlgorithm:function(e,t){e.enhanceAlgorithm=t.payload},setWaitingForAutoEnhanceLayer:function(e,t){e.waitingForAutoEnhanceLayer=t.payload},setInstallationStatus:function(e,t){e.autoEnhanceInstallationInfo=t.payload}},extraReducers:function(e){e.addCase(de,function(e,t){e.autoEnhanceInstallationInfo.status!==o_.Installed&&(e.isTexturePatchAppliedBeforeAutoEnhanceInstallation=!0)}),e.addCase(se,function(e,t){e.isAutoEnhanceOn=D_.isAutoEnhanceOn,e.contrastStretchingParams=D_.contrastStretchingParams,e.level=D_.level,e.enhanceAlgorithm=D_.enhanceAlgorithm,e.isTexturePatchAppliedBeforeAutoEnhanceInstallation=D_.isTexturePatchAppliedBeforeAutoEnhanceInstallation,e.undoRedoStack=D_.undoRedoStack}),Se(e,tb)}}),ib=(Zh=ab.actions).setLevel,rb=Zh.setIsAutoEnhanceOn,ob=Zh.setWaitingForAutoEnhanceLayer,sb=Zh.setInstallationStatus,cb=Zh.setAutoEnhanceParameters,db=(Zh.setEnhanceAlgorithm,ab.reducer),lb={addTexturePatch:c_,removePendingTexturePatch:u_,setTexturePatchRequestPending:d_,setWaitingForAutoEnhanceLayer:ob,clearAllMarkupContent:q_,addUserFacingErrorMessage:Bs},ub=Object(ee.connect)(function(e,t){return{texturePatchRequests:e.texturePatch.texturePatchRequests,hasPendingRequests:e.texturePatch.pendingTexturePatchRequests.length>0,texturePatches:e.texturePatch.texturePatches,waitingForAutoEnhanceLayer:e.autoEnhance.waitingForAutoEnhanceLayer}},lb)(eb),fb=function(){return fb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fb.apply(this,arguments)},pb={onMainTextureLoaded:Zc,onOverlayTextureLoaded:ws},mb=Object(ee.connect)(function(e,t){var n=t.children;return{transform:wm(e),children:n}},pb)(function(e){return Object(s.forwardRef)(function(t,n){return c.a.createElement(c.a.Fragment,null,c.a.createElement(ah,{image:t.image}),c.a.createElement(ub,{image:t.image}),c.a.createElement(e,fb({},t,{ref:n})))})}(($h=function(e){var t=e.children,n=e.image,a=e.onMainTextureLoaded,i=e.onOverlayTextureLoaded,r=Object(s.useContext)(gl),o=r.engine,d=r.textures,l=ol(),u=zm(n,o),f=u.mipMapsEnabledByLayer,p=u.shouldUseFakeMipMaps,m=function(e,t,n,a,i){var r=Object(s.useContext)(Em),o=im(t),c=Object(s.useCallback)(function(e){null==a||a({sizeInPixels:e,resetEditsOnSizeChange:!r})},[a,r]),d=Object(s.useCallback)(function(e){null==i||i()},[i]),l=jm(o.main,Pm.main,e,!!n.main,c,{disposalCondition:"whenNewTextureLoads"}),u=jm(o.blend,Pm.blend,e,!!n.blend),f=jm(o.overlay,Pm.overlay,e,!!n.overlay,d),p=jm(o.mask,Pm.mask,e,!!n.mask),m=Object(s.useMemo)(function(){return{main:l,blend:u,overlay:f,mask:p}},[l,u,f,p]);return wl(m),m}(d,n,f,a,i);return c.a.createElement(Ld.Provider,{value:{registry:l,textures:m,shouldUseFakeMipMaps:p}},t,c.a.createElement(Ll,Gm({},e)))},Object(s.forwardRef)(function(e,t){var n,a;n=e.image,a=Object(s.useContext)(Em),Object(s.useLayoutEffect)(function(){if(am(n)?n.main:n){var e=Mm(n,a)?Im.MainImage:Im.Thumbnail;performance.clearMarks(e),performance.mark(e)}},[n,a]);var i=function(e){var t=Object(s.useContext)(Zt).logPageLoadTimeEvent,n=Object(s.useRef)({x:0,y:0}),a=Object(s.useContext)(Em);return Object(s.useCallback)(function(i){if(e&&e(i),n.current!==i.sizeInPixels){var r=!a||Ra(i.sizeInPixels,a)?Im.MainImage:Im.Thumbnail,o=window.requestAnimationFrame(function(){setTimeout(function(){t({pageLoadTimeMs:Am(r),component:r})})});return n.current=i.sizeInPixels,function(){window.cancelAnimationFrame(o)}}},[e,a,t])}(e.onMainTextureLoaded);return c.a.createElement($h,Tm({},e,{onMainTextureLoaded:i,ref:t}))})))),_b=c.a.memo(function(e){var t=e.cropWidth,n=e.cropHeight,a=e.position,i=e.opacity,r=function(e,t){var n=Object(s.useContext)(Ze).strings,a=e.toString(),i=t.toString();return{imageDimension:vt(n.editor_imageDimensionLabelFormatString,a,i),imageDimensionAriaLabel:vt(n.editor_imageDimensionAriaLabelFormatString,a,i)}}(t,n),o=r.imageDimension,d=r.imageDimensionAriaLabel;return c.a.createElement(ha,{style:{top:a.y,left:a.x,transform:"translateX(-50%)",opacity:i},visible:i>0},c.a.createElement("span",{"aria-label":d},o))}),hb=Object(ga.e)([Jo],function(e){return{x:e.left+e.width/2,y:e.top+e.height+-36}}),bb=Object(ee.connect)(function(e){return{cropWidth:rp(e),cropHeight:op(e),position:hb(e),opacity:$o(e)}})(_b);function gb(e,t,n){return t?{width:e.x/n+"px",height:e.y/n+"px"}:{width:"100%",height:"100%"}}var vb=function(){return vb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},vb.apply(this,arguments)},yb=c.a.memo(function(e){var t=e.setCanvasPixelSize,n=e.setCssToPhysicalPixelRatio,a=e.cssToPhysicalPixelRatio,i=e.canvasSize,r=e.activePivot,o=e.children,d=Object(s.useState)(null),l=d[0],u=d[1],f=a||window.devicePixelRatio||1;Object(s.useLayoutEffect)(function(){n(f)},[f,n]);var p=function(e,t,n){var a=Object(s.useRef)(),i=Object(s.useCallback)(function(){if(e){var i=n===window.devicePixelRatio,r=!a.current||!i,o=r?function(e,t){var n=e.getBoundingClientRect();return{x:Math.floor(n.width*t),y:Math.floor(n.height*t)}}(e,n):a.current;o&&t({pixelSize:o,cssSize:gb(o,r,n)})}},[a,t,n,e]),r=Object(s.useCallback)(function(e){a.current=vb({},e),i()},[a,i]);return function(e,t){var n=Object(s.useCallback)(function(n){if(e){var a=n.find(function(t){return t.target===e});if(a&&a.devicePixelContentBoxSize&&a.devicePixelContentBoxSize[0]){var i=a.devicePixelContentBoxSize[0].inlineSize,r=a.devicePixelContentBoxSize[0].blockSize,o=a.contentBoxSize[0].inlineSize;1!==window.devicePixelRatio&&i===o&&(i*=window.devicePixelRatio,r*=window.devicePixelRatio),t({x:i,y:r})}}},[t,e]);Object(s.useEffect)(function(){try{if(window.ResizeObserver&&e){var t=new ResizeObserver(n);return t.observe(e,{box:"device-pixel-content-box"}),function(){t.disconnect()}}}catch(e){}},[e,n])}(e,r),i}(l,t,f);return Object(s.useLayoutEffect)(function(){p()},[i,r,p]),c.a.createElement("div",{style:{position:"relative",height:"100%",width:"100%"},ref:u},o)});yb.displayName="SetCanvasSize";var Sb=function(){return Sb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Sb.apply(this,arguments)},Db={setCanvasPixelSize:Xc,setCssToPhysicalPixelRatio:ud},Ib=Object(ee.connect)(function(e){return{activePivot:e.uiState.activeEditorActivity}},Db)(function(e){return c.a.createElement(yb,Sb({},e))}),xb=function(e){return c.a.createElement(Ib,Sb({},e))};xb.displayName="SetCanvasSizeConnect";var Cb,Ob=c.a.memo(function(e){var t=e.activeEditorActivity,n=e.match,a=e.children;return(Array.isArray(n)?n.some(function(e){return e===t}):n===t)?c.a.createElement(c.a.Fragment,null,a):null}),wb=Object(ee.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}},null)(Ob),Eb={setAriaAnnouncement:Jn},Ab=Object(ee.connect)(function(e){return{visible:th(e)}},Eb)(function(e){var t=e.visible,n=e.gutterSize,a=void 0===n?32:n,i=e.setAriaAnnouncement,r=Object(s.useContext)(Ze).strings,o={bottom:"".concat(a,"px"),left:"50%",transform:"translateX(-50%)"};return Object(s.useEffect)(function(){t&&i(r.editor_viewingOriginalAriaLive)},[t,i,r]),c.a.createElement(ha,{visible:t,style:o},r.editor_viewingOriginal)});Object($e.loadStyles)([{rawString:".EditorCommandBarStack_e8ecbb5e{padding:0 12px;overflow:hidden;height:44px}.CommandBarBeginningStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.CommandBarMiddleStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.CommandBarEndStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.CommandBarEndStackItem_e8ecbb5e>*{margin:0 4px}.MobileCommandBarStack_e8ecbb5e{padding:0 12px;overflow:hidden;height:56px}.MobileCommandBarEndStackItem_e8ecbb5e{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:0}"}]),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(Cb||(Cb={}));var Lb=function(){return Lb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Lb.apply(this,arguments)};function kb(e){return{root:{color:e.palette.themePrimary,fill:e.palette.themePrimary},rootHovered:{backgroundColor:e.palette.neutralLight},rootPressed:{backgroundColor:e.palette.neutralQuaternaryAlt},rootDisabled:{fill:e.palette.neutralTertiary},icon:{width:"16px",height:"16px"}}}function Mb(e){return{backgroundColor:e.palette.themeSecondary,color:e.palette.white,border:"none"}}var Pb={root:{fontSize:"18px",width:"18px",height:"18px",lineHeight:"18px"}},Tb="0 0 96 108",Ub="none",Fb="40px",Hb="inkTool",Rb=Object(s.memo)(function(e){var t=e.styles,n="EraserIcon",a=dt(n),i=dt(n),r=dt(n),o=dt(n),s=dt(n),d=dt(n),l=dt(n),u=dt(n),f=dt(n),p=dt(n),m=dt(n);return c.a.createElement("svg",{className:Hb,width:"48px",height:"56px",viewBox:Tb,fill:Ub,style:t},c.a.createElement("g",{clipPath:"url(#".concat(m,")")},c.a.createElement("g",{opacity:"0.3",filter:"url(#".concat(a,")")},c.a.createElement("path",{d:"M69.2524 93V39H26.0524V93H69.2524Z",fill:"black"})),c.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"url(#".concat(l,")")}),c.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"url(#".concat(u,")")}),c.a.createElement("g",{opacity:"0.3",filter:"url(#".concat(i,")")},c.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),c.a.createElement("g",{filter:"url(#".concat(r,")")},c.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),c.a.createElement("g",{filter:"url(#".concat(o,")")},c.a.createElement("path",{d:"M71.6523 117V29.4C71.6523 26.749 69.5033 24.6 66.8523 24.6H28.4523C25.8014 24.6 23.6523 26.749 23.6523 29.4V117H71.6523Z",fill:"black",fillOpacity:"0.01"})),c.a.createElement("path",{opacity:"0.08",d:"M23.6523 29.4C23.6523 26.749 25.8014 24.6 28.4523 24.6H66.8523C69.5033 24.6 71.6523 26.749 71.6523 29.4V53.4H23.6523V29.4Z",fill:"black"}),c.a.createElement("path",{d:"M28.4523 12.6C28.4523 7.29807 32.7504 3 38.0523 3H57.2523C62.5543 3 66.8523 7.29807 66.8523 12.6V24.6H28.4523V12.6Z",fill:"url(#".concat(f,")")}),c.a.createElement("path",{d:"M28.7523 12.6C28.7523 7.46376 32.9161 3.3 38.0523 3.3H57.2523C62.3886 3.3 66.5523 7.46375 66.5523 12.6V24.3H28.7523V12.6Z",stroke:"url(#".concat(p,")"),strokeOpacity:"0.16",strokeWidth:"0.6"}),c.a.createElement("g",{opacity:"0.6",filter:"url(#".concat(s,")")},c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M57.2524 10.8H42.8524V7.19998H57.2524C60.8974 7.19998 63.8523 10.1549 63.8523 13.8V24.6H60.2523V13.8C60.2523 12.1431 58.9092 10.8 57.2524 10.8Z",fill:"white"})),c.a.createElement("path",{opacity:"0.12",fillRule:"evenodd",clipRule:"evenodd",d:"M71.6523 54.6H23.6523V53.4H71.6523V54.6Z",fill:"white"}),c.a.createElement("g",{opacity:"0.1",filter:"url(#".concat(d,")")},c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M55.818 111V36.6H58.218V111H55.818Z",fill:"white"}))),c.a.createElement("defs",null,c.a.createElement("filter",{id:a,x:"18.8524",y:"31.8",width:"57.6",height:"68.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),c.a.createElement("filter",{id:i,x:"23.6523",y:"24.6",width:"56.4",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.a.createElement("feOffset",{dx:"8.4"}),c.a.createElement("feGaussianBlur",{stdDeviation:"4.8"}),c.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),c.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0.2 0 0 0 0 0.2 0 0 0 0 0.2 0 0 0 1 0"}),c.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),c.a.createElement("filter",{id:r,x:"23.6523",y:"24.6",width:"50.4",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.a.createElement("feOffset",{dx:"2.4"}),c.a.createElement("feGaussianBlur",{stdDeviation:"3.6"}),c.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),c.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.225634 0"}),c.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),c.a.createElement("filter",{id:o,x:"23.6523",y:"24.6",width:"49.2",height:"92.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feColorMatrix",{in:"SourceAlpha",type:"matrix",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),c.a.createElement("feOffset",{dx:"1.2"}),c.a.createElement("feGaussianBlur",{stdDeviation:"4.2"}),c.a.createElement("feComposite",{in2:"hardAlpha",operator:"arithmetic",k2:"-1",k3:"1"}),c.a.createElement("feColorMatrix",{type:"matrix",values:"0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 0.1 0"}),c.a.createElement("feBlend",{mode:"normal",in2:"shape",result:"effect1_innerShadow"})),c.a.createElement("filter",{id:s,x:"30.8524",y:"-4.80002",width:"45",height:"41.4",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"6",result:"effect1_foregroundBlur"})),c.a.createElement("filter",{id:d,x:"46.218",y:"27",width:"21.6",height:"93.6",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"4.8",result:"effect1_foregroundBlur"})),c.a.createElement("linearGradient",{id:l,x1:"27.2523",y1:"39.6",x2:"71.191",y2:"44.1024",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#333333"}),c.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),c.a.createElement("linearGradient",{id:u,x1:"28.4523",y1:"45.6",x2:"47.4937",y2:"47.3382",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#333333"}),c.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),c.a.createElement("linearGradient",{id:f,x1:"47.6523",y1:"3",x2:"47.6523",y2:"24.6",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#EA9FAA"}),c.a.createElement("stop",{offset:"1",stopColor:"#FA7E90"})),c.a.createElement("linearGradient",{id:p,x1:"47.6523",y1:"3",x2:"47.6523",y2:"24.6",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"white"}),c.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),c.a.createElement("clipPath",{id:m},c.a.createElement("rect",{width:"96",height:"126",fill:"white",transform:"translate(-0.347656 -9)"}))))}),Nb=Object(s.memo)(function(e){var t=e.styles,n=e.inkBrushColor,a="InkPenIcon",i=dt(a),r=dt(a),o=dt(a),s=dt(a),d=dt(a),l=dt(a),u=dt(a);return c.a.createElement("svg",{className:Hb,width:"48px",height:"56px",viewBox:Tb,fill:Ub,style:t},c.a.createElement("g",{clipPath:"url(#".concat(i,")")},c.a.createElement("g",{opacity:"0.4",filter:"url(#".concat(r,")")},c.a.createElement("path",{d:"M69.6 116V60.8H26.4V116H69.6Z",fill:"black"})),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M48.0003 3.1998C43.5003 3.1998 40.8003 17.5998 40.8003 17.5998H55.2003C55.2003 17.5998 52.5003 3.1998 48.0003 3.1998ZM25.9449 60.7998H70.0551C71.346 68.851 72 77.0143 72 85.2142V116H24V85.2142C24 77.0143 24.6539 68.851 25.9449 60.7998Z",fill:n}),c.a.createElement("path",{d:"M41.5543 17.6H54.4456C55.6388 17.6 56.725 18.2883 57.2345 19.3672C63.456 32.5422 67.7611 46.4942 70.055 60.8H25.9449C28.2388 46.4942 32.5439 32.5422 38.7654 19.3672C39.2749 18.2882 40.3611 17.6 41.5543 17.6Z",fill:"url(#".concat(s,")")}),c.a.createElement("path",{d:"M41.5543 17.6H54.4456C55.6388 17.6 56.725 18.2883 57.2345 19.3672C63.456 32.5422 67.7611 46.4942 70.055 60.8H25.9449C28.2388 46.4942 32.5439 32.5422 38.7654 19.3672C39.2749 18.2882 40.3611 17.6 41.5543 17.6Z",fill:"url(#".concat(d,")")}),c.a.createElement("path",{opacity:"0.2",d:"M70.0551 60.8L25.9449 60.8C24.6539 68.8512 24 77.0145 24 85.2144V116H72V85.2144C72 77.0145 71.346 68.8512 70.0551 60.8Z",fill:"url(#".concat(l,")")}),c.a.createElement("path",{opacity:"0.12",d:"M25.9448 60.8H70.0549C70.119 61.1997 70.1815 61.5997 70.2425 62H25.7572C25.8182 61.5997 25.8807 61.1997 25.9448 60.8Z",fill:"white"}),c.a.createElement("path",{opacity:"0.32",d:"M40.8 17.6C40.8 17.6 43.5 3.2 48 3.2C52.5 3.2 55.2 17.6 55.2 17.6H40.8Z",fill:"url(#".concat(u,")")}),c.a.createElement("g",{opacity:"0.4",filter:"url(#".concat(o,")")},c.a.createElement("path",{d:"M49.1994 21.2C49.1994 21.2 61.8773 51.2 61.8773 72.5941C61.8773 78.807 61.8773 126.104 61.8773 126.104",stroke:"white",strokeWidth:"1.2"}))),c.a.createElement("defs",null,c.a.createElement("filter",{id:r,x:"19.2",y:"53.6",width:"57.6",height:"69.6",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),c.a.createElement("filter",{id:o,x:"41.4468",y:"13.7669",width:"28.2305",height:"119.537",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),c.a.createElement("linearGradient",{id:s,x1:"27.6002",y1:"35.6",x2:"70.8002",y2:"48.8",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#333333"}),c.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),c.a.createElement("linearGradient",{id:d,x1:"28.8002",y1:"42.8",x2:"46.8002",y2:"47.6",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#333333"}),c.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),c.a.createElement("linearGradient",{id:l,x1:"24",y1:"70.4",x2:"58.8",y2:"70.4",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",null),c.a.createElement("stop",{offset:"1",stopOpacity:"0"})),c.a.createElement("linearGradient",{id:u,x1:"56",y1:"3.2",x2:"48",y2:"17.6",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"white"}),c.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),c.a.createElement("clipPath",{id:i},c.a.createElement("rect",{width:"96",height:"120",fill:"white"}))))}),Bb=Object(s.memo)(function(e){var t=e.styles,n=e.inkBrushColor,a="HighlighterIcon",i=dt(a),r=dt(a),o=dt(a),s=dt(a),d=dt(a),l=dt(a),u=dt(a),f=dt(a),p=dt(a),m=dt(a);return c.a.createElement("svg",{className:Hb,width:"48px",height:"56px",viewBox:Tb,fill:Ub,style:t},c.a.createElement("g",{clipPath:"url(#".concat(i,")")},c.a.createElement("g",{opacity:"0.4",filter:"url(#".concat(r,")")},c.a.createElement("path",{d:"M76.8 117V59.4H19.2V117H76.8Z",fill:"black"})),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.8 42.6L30.7255 25.2699C30.9956 22.8391 33.0504 21 35.4962 21H60.5038C62.9496 21 65.0043 22.8391 65.2744 25.2699L67.2 42.6L73.7956 47.8765C77.2115 50.6092 79.2 54.7465 79.2 59.121V95.4H16.8V59.121C16.8 54.7465 18.7885 50.6092 22.2044 47.8765L28.8 42.6Z",fill:"url(#".concat(d,")")}),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M28.8 42.6L30.7255 25.2699C30.9956 22.8391 33.0504 21 35.4962 21H60.5038C62.9496 21 65.0043 22.8391 65.2744 25.2699L67.2 42.6L73.7956 47.8765C77.2115 50.6092 79.2 54.7465 79.2 59.121V95.4H16.8V59.121C16.8 54.7465 18.7885 50.6092 22.2044 47.8765L28.8 42.6Z",fill:"url(#".concat(l,")")}),c.a.createElement("g",{opacity:"0.2",filter:"url(#".concat(o,")")},c.a.createElement("path",{d:"M55.2002 27L60.2197 57.3868L73.2 63V117",stroke:"white",strokeWidth:"1.2"})),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M36 21.0002V12.6002C36 11.062 36.9773 9.6937 38.4324 9.19482L56.8216 2.88996C58.3794 2.35587 60 3.51345 60 5.16022V21.0002H36ZM79.2 61.8002H16.8V117H79.2V61.8002Z",fill:n}),c.a.createElement("rect",{opacity:"0.2",x:"16.8",y:"61.8",width:"26.4",height:"55.2",fill:"url(#".concat(u,")")}),c.a.createElement("rect",{opacity:"0.06",width:"26.4",height:"55.2",transform:"matrix(-1 0 0 1 79.2 61.8)",fill:"url(#".concat(f,")")}),c.a.createElement("path",{opacity:"0.3",d:"M36 12.6V21H60V5.15999C60 3.51321 58.3794 2.35563 56.8216 2.88972L38.4324 9.19458C36.9773 9.69347 36 11.0618 36 12.6Z",fill:"url(#".concat(p,")")}),c.a.createElement("path",{d:"M59.7 20.7H36.3V12.6C36.3 11.1899 37.1959 9.93568 38.5297 9.47837L56.9189 3.1735C58.282 2.70617 59.7 3.71906 59.7 5.15999V20.7Z",stroke:"url(#".concat(m,")"),strokeOpacity:"0.3",strokeWidth:"0.6"}),c.a.createElement("g",{opacity:"0.4",filter:"url(#".concat(s,")")},c.a.createElement("path",{d:"M73.2 117V59.4",stroke:"white",strokeWidth:"1.2"})),c.a.createElement("line",{opacity:"0.12",x1:"16.8",y1:"62.4",x2:"79.2",y2:"62.4",stroke:"white",strokeWidth:"1.2"})),c.a.createElement("defs",null,c.a.createElement("filter",{id:r,x:"12",y:"52.2",width:"72",height:"72",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),c.a.createElement("filter",{id:o,x:"47.4082",y:"19.7022",width:"33.5918",height:"104.498",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"3.6",result:"effect1_foregroundBlur"})),c.a.createElement("filter",{id:s,x:"63",y:"49.8",width:"20.4",height:"76.8",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},c.a.createElement("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),c.a.createElement("feBlend",{mode:"normal",in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),c.a.createElement("feGaussianBlur",{stdDeviation:"4.8",result:"effect1_foregroundBlur"})),c.a.createElement("linearGradient",{id:d,x1:"17.4",y1:"36.5",x2:"72.6093",y2:"65.8856",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#333333"}),c.a.createElement("stop",{offset:"0.792969",stopColor:"#605A5D"})),c.a.createElement("linearGradient",{id:l,x1:"19.2",y1:"42.7",x2:"44.1733",y2:"55.8611",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"#333333"}),c.a.createElement("stop",{offset:"1",stopColor:"#605A5D",stopOpacity:"0"})),c.a.createElement("linearGradient",{id:u,x1:"16.8",y1:"78.7846",x2:"35.94",y2:"78.7846",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",null),c.a.createElement("stop",{offset:"1",stopOpacity:"0"})),c.a.createElement("linearGradient",{id:f,x1:"-9.02706e-08",y1:"16.9846",x2:"19.14",y2:"16.9846",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",null),c.a.createElement("stop",{offset:"1",stopOpacity:"0"})),c.a.createElement("linearGradient",{id:p,x1:"44.9143",y1:"-1.25961",x2:"47.3195",y2:"23.1916",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",null),c.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),c.a.createElement("linearGradient",{id:m,x1:"48",y1:"-1.25961",x2:"48",y2:"18.774",gradientUnits:"userSpaceOnUse"},c.a.createElement("stop",{stopColor:"white"}),c.a.createElement("stop",{offset:"1",stopColor:"white",stopOpacity:"0"})),c.a.createElement("clipPath",{id:i},c.a.createElement("rect",{width:"96",height:"120",fill:"white",transform:"translate(0 -3)"}))))}),jb=Object(s.memo)(function(e){var t=e.enabled,n=e.enabledColor,a=e.disabledColor,i=e.styles,r=$(),o=null!=n?n:r.palette.black,s=null!=a?a:r.palette.neutralTertiary,d=Object(u.mergeStyles)({fill:t?o:s}),l="0 0 ".concat(24," ").concat(24);return c.a.createElement("svg",{width:24,height:24,viewBox:l,fill:"none",style:i},c.a.createElement("g",{className:d},c.a.createElement("path",{d:"M2 6.75C2 5.23122 3.23122 4 4.75 4L19.25 4C20.7688 4 22 5.23122 22 6.75V12.5356L21.1991 11.7347C20.9899 11.5255 20.7529 11.3612 20.5 11.2416V6.75C20.5 6.05964 19.9404 5.5 19.25 5.5L4.75 5.5C4.05964 5.5 3.5 6.05964 3.5 6.75L3.5 17.25C3.5 17.9404 4.05964 18.5 4.75 18.5H12.0149C12.0319 19.0338 12.2189 19.5632 12.576 20H4.75C3.23122 20 2 18.7688 2 17.25L2 6.75Z"}),c.a.createElement("path",{d:"M20.4919 12.4418C19.9062 11.856 18.9564 11.856 18.3706 12.4417L15.26 15.5524L19.4671 19.7595L22.5777 16.6489C23.1635 16.0631 23.1635 15.1133 22.5777 14.5275L20.4919 12.4418Z"}),c.a.createElement("path",{d:"M13.453 17.3593L14.5529 16.2595L18.76 20.4666L17.6601 21.5665C17.0743 22.1522 16.1246 22.1522 15.5388 21.5665L13.453 19.4807C12.8672 18.8949 12.8672 17.9451 13.453 17.3593Z"})))}),Vb=function(){return Vb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vb.apply(this,arguments)},zb={activeInkBrushId:"pen1",brushes:[{inkBrushId:"pen1",getIcon:function(e){var t;return c.a.createElement(Nb,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:ms.pen1.htmlColor})}},{inkBrushId:"pen2",getIcon:function(e){var t;return c.a.createElement(Nb,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:ms.pen2.htmlColor})}},{inkBrushId:"highlighter",getIcon:function(e){var t;return c.a.createElement(Bb,{styles:null==e?void 0:e.styles,inkBrushColor:null!==(t=null==e?void 0:e.inkBrushColor)&&void 0!==t?t:ms.highlighter.htmlColor})}}],eraser:{getIcon:function(e){return c.a.createElement(Rb,{styles:null==e?void 0:e.styles})}},text:{getIcon:function(){return c.a.createElement($t.Icon,{iconName:"HalfAlpha",styles:{root:{fontSize:21}}})}},clearAllMarkup:{getIcon:function(e){return c.a.createElement(jb,Vb({},e))}}},Gb=function(){throw new Error("Error: Components must be wrapped in a MarkupProvider")},Kb={},Wb=Object(s.createContext)({enableMarkup:!1,Canvas:Gb,canvasMethods:Kb,setCanvasMethods:function(){},InkCanvasInteraction:Gb,inkConfigurations:{Pen:{cssThicknesses:[1,2,3,4,5,6],minSliderValue:1},Highlighter:{cssThicknesses:[1,2,3,4,5,6],minSliderValue:1}},localizationStrings:{markup_markupToolbarPenTooltip:"Pen",markup_markupToolbarPenAriaLabel:"Pen",markup_markupToolbarPenAriaDescription:"Select and drag on image to add an ink stroke. Select this button again to change ink properties.",markup_markupToolbarEraserTooltip:"Remove markup",markup_markupToolbarEraserAriaLabel:"Remove markup",markup_markupToolbarEraserAriaDescription:"Select and drag over markup to remove it.",markup_markupToolbarHighlighterTooltip:"Highlighter",markup_markupToolbarHighlighterAriaLabel:"Highlighter",markup_markupToolbarHighlighterAriaDescription:"Select and drag on image to add an ink stroke. Select this button again to change ink properties.",markup_markupToolbarClearAllMarkupTooltip:"Clear all markup",markup_markupToolbarClearAllMarkupAriaLabel:"Clear all markup",markup_markupToolbarThickness:"Thickness",markup_clearAllMarkupDialogCloseButtonAriaLabel:"Close",markup_clearAllMarkupDialogTitle:"Clear all markup?",markup_clearAllMarkupDialogSubText:"All markup applied to the image will be permanently removed.",markup_clearAllMarkupDialogConfirmButtonText:"Confirm",markup_clearAllMarkupDialogConfirmButtonAriaLabel:"Confirm",markup_clearAllMarkupDialogCancelButtonText:"Cancel",markup_clearAllMarkupDialogCancelButtonAriaLabel:"Cancel",markup_markupToolbarBrushFormatString:"{0}: {1}, {2}: {3}, {4}",markup_markupToolbarBrushFormatWithArrowModeString:"{0}: {1}, {2}: {3}, {4} with {5}",markup_markupToolbarTooltipChangeInkProperties:"Select again to change ink properties.",markup_inkThicknessSliderHeaderLabel:"Stroke Thickness",markup_inkThicknessSliderAriaLabel:"Slider to pick the thickness of the selected brush.",markup_addedInkStrokeAriaLive:"Added an ink stroke to image, {0}, {1}, thickness {2}",markup_removedInkStrokesAriaLive:"Removed {0} out of {1} ink strokes",markup_clearedAllMarkupAriaLive:"Cleared all markup",markup_inkPenThicknessSliderAriaLabel:"Pen thickness.",markup_inkHighlighterThicknessSliderAriaLabel:"Highlighter thickness.",markup_inkThicknessSliderTitle:"Drag on slider or use arrow keys to change stroke thickness",markup_markupToolbarAriaLandmark:"Markup Toolbar",markup_colorDarkYellow:"Dark Yellow",markup_colorLightOrange:"Light Orange",markup_colorOrange:"Orange",markup_colorRed:"Red",markup_colorDarkPurple:"Dark Purple",markup_colorPurple:"Purple",markup_colorMagenta:"Magenta",markup_colorDarkRed:"Dark Red",markup_colorLightBlue:"Light Blue",markup_colorBlue:"Blue",markup_colorDarkBlue:"Dark Blue",markup_colorLightGreen:"Light Green",markup_colorGreen:"Green",markup_colorLightGray:"Light Gray",markup_colorGray:"Gray",markup_colorBlack:"Black",markup_colorTableAriaLabel:"Colors",markup_noArrowButtonText:"No Arrow",markup_straightNoArrowButtonTooltip:"Plain straight line",markup_straightNoArrowButtonAriaLabel:"Create a plain straight line",markup_singleArrowButtonText:"Single Arrow",markup_straightSingleArrowButtonTooltip:"Straight line with arrow",markup_straightSingleArrowButtonAriaLabel:"Create a straight line with an arrow at one end",markup_doubleArrowButtonText:"Double Arrow",markup_straightDoubleArrowButtonTooltip:"Straight Line with double arrows",markup_straightDoubleArrowButtonAriaLabel:"Create a straight line with arrows at both ends",markup_freehandNoArrowButtonTooltip:"Plain freehand line",markup_freehandNoArrowButtonAriaLabel:"Create a plain line by freehand",markup_freehandSingleArrowButtonTooltip:"Freehand line with arrow",markup_freehandSingleArrowButtonAriaLabel:"Create a freehand line with an arrow at one end",markup_freehandDoubleArrowButtonTooltip:"Freehand Line with double arrows",markup_freehandDoubleArrowButtonAriaLabel:"Create a freehand line with arrows at both ends",markup_markupToolbarNoArrowTip:"no arrow",markup_markupToolbarSingleArrowTip:"arrow end",markup_markupToolbarDoubleArrowTip:"double arrow ends",markup_strokeShapeCalloutHeaderText:"Straight line",markup_strokeShapeCalloutMainText:"Activate and draw straight-line fast by holding Shift while left mouse click and drag.",markup_strokeShapeToastText:"Hold at end of a stroke to convert into a straight line.",markup_freehandLine:"Freehand line",markup_straightLine:"Straight line",markup_textboxDefaultContent:"Type something"},scriptsToLoadJSBundles:[],markupToolsConfigurations:zb,getMarkupToolbarPosition:function(){return"Bottom"},markupToolbarStyles:void 0,enableStraightLineMarkup:!1,enableArrowhead:!1,showWetCanvas:!1,setShowWetCanvas:function(){},wetCanvasIsReady:!1,setWetCanvasIsReady:function(){},onClearAllMarkupConfirmationDialog:void 0,isStrokeShapeCalloutEnabled:!1,enableMarkupKeyboarding:!1}),qb=n("ayVK").ReactReduxContext;function Qb(){if(!qb._currentValue)throw new Error("useStore must used within a Redux store. Ensure you have a ImageEditorContext defined.");return qb._currentValue.store}function Yb(){var e=Object(s.useContext)(Wb).enableMarkup,t=Object(s.useContext)(Zt).logMarkupSummaryEvent,n=Qb();return Object(s.useCallback)(function(){if(e){var a=n.getState().markup;t({strokeCount:(null==a?void 0:a.markupContentItems.length)||0})}},[e,t,n])}var Jb,Xb=Object(s.memo)(function(e){var t=e.onCancel,n=e.styles,a=e.iconProps,i=$(),r=Object(s.useContext)(Ze).strings,o=Object(s.useMemo)(function(){return Object(u.concatStyleSets)(kb(i),n)},[i,n]),d=function(e){var t=Object(s.useContext)(Zt).logCancelEvent,n=Yb();return Object(s.useCallback)(function(a){n(),t({inputType:Xs(a)}),e()},[t,e,n])}(t);return c.a.createElement(c.a.Fragment,null,a?c.a.createElement(u.IconButton,{key:"Cancel",iconProps:a,styles:o,ariaLabel:r.toolbar_cancelAriaLabel,title:r.toolbar_cancelTooltip,role:"button",onClick:d}):c.a.createElement(u.DefaultButton,{key:"Cancel",text:r.toolbar_cancel,styles:o,onClick:d,ariaLabel:r.toolbar_cancelAriaLabel,title:r.toolbar_cancelTooltip}))}),Zb=function(){return Zb=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Zb.apply(this,arguments)},$b=Object(s.memo)(function(e){var t=e.styles,n={color:$().palette.neutralPrimaryAlt,lineHeight:"43px"};return c.a.createElement("div",{"aria-hidden":"true",style:Zb(Zb({},n),t)},"|")}),eg=Object(ga.e)([qo,p_,m_,Zf,__,h_,function(e){return e.transformTools.userDefinedDefaults||xo(e.transformTools.image.originalPixelSize)}],function(e,t,n,a,i,r,o){return function(e,t){var n=Qr(e.transforms,t),a=!e.adjustments||I_(e.adjustments,Te),i=L_(e.filters,k_(w_)),r=M_(e.autoEnhance,S_),o=P_(e.markup,z_),s=!b_(e.texturePatch);return n&&a&&i&&r&&o&&s}($_(e,t,n,a,i,r),o)});!function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(Jb||(Jb={}));var tg=u.AnimationVariables.durationValue2,ng={root:"ms-Modal",main:"ms-Dialog-main",scrollableContent:"ms-Modal-scrollableContent",isOpen:"is-open",layer:"ms-Modal-Layer"},ag=s.createContext(void 0),ig=function(){return function(){}};ag.Provider;var rg=n("faye"),og={},sg={},cg="fluent-default-layer-host",dg="#".concat(cg);function lg(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=s.useCallback(function(t){n.current=t;for(var a=0,i=e;a<i.length;a++){var r=i[a];"function"==typeof r?r(t):r&&(r.current=t)}},Object(o.__spreadArray)([],e,!0));return n}var ug,fg=Object(u.classNamesFunction)(),pg=s.forwardRef(function(e,t){var n=function(){var e;return null!==(e=s.useContext(ag))&&void 0!==e?e:ig}(),a=s.useRef(null),i=lg(a,t),r=s.useRef(),c=s.useRef(null),d=s.useContext(u.FocusRectsContext),l=s.useState(!1),f=l[0],p=l[1],m=s.useCallback(function(e){var t,n=!!(null==(t=null==d?void 0:d.providerRef)?void 0:t.current)&&t.current.classList.contains(u.IsFocusVisibleClassName);e&&n&&e.classList.add(u.IsFocusVisibleClassName)},[d]),_=e.children,h=e.className,b=e.eventBubblingEnabled,g=e.fabricProps,v=e.hostId,y=e.insertFirst,S=e.onLayerDidMount,D=void 0===S?function(){}:S,I=e.onLayerMounted,x=void 0===I?function(){}:I,C=e.onLayerWillUnmount,O=e.styles,w=e.theme,E=lg(c,null==g?void 0:g.ref,m),L=fg(O,{theme:w,className:h,isNotHost:!v}),k=function(){null==C||C();var e=r.current;r.current=void 0,e&&e.parentNode&&e.parentNode.removeChild(e)},M=function(){var e,t=Object(u.getDocument)(a.current);if(t){var n=function(e){var t,n;if(v){var a=function(e){var t=sg[e];return t&&t[0]||void 0}(v);return a?null!==(t=a.rootRef.current)&&void 0!==t?t:null:null!==(n=e.getElementById(v))&&void 0!==n?n:null}var i=dg,r=i?e.querySelector(i):null;return r||(r=function(e){var t=e.createElement("div");return t.setAttribute("id",cg),t.style.cssText="position:fixed;z-index:1000000",null==e||e.body.appendChild(t),t}(e)),r}(t);if(n){k();var i=(null!==(e=n.ownerDocument)&&void 0!==e?e:t).createElement("div");i.className=L.root,Object(u.setPortalAttribute)(i),Object(u.setVirtualParent)(i,a.current),y?n.insertBefore(i,n.firstChild):n.appendChild(i),r.current=i,p(!0)}}};return Object(A.useIsomorphicLayoutEffect)(function(){M(),v&&function(e,t){og[e]||(og[e]=[]),og[e].push(t);var n=sg[e];if(n)for(var a=0,i=n;a<i.length;a++)i[a].notifyLayersChanged()}(v,M);var e=r.current?n(r.current):void 0;return function(){e&&e(),k(),v&&function(e,t){var n=og[e];if(n){var a=n.indexOf(t);a>=0&&(n.splice(a,1),0===n.length&&delete og[e])}var i=sg[e];if(i)for(var r=0,o=i;r<o.length;r++)o[r].notifyLayersChanged()}(v,M)}},[v]),s.useEffect(function(){r.current&&f&&(null==x||x(),null==D||D(),p(!1))},[f,x,D]),s.createElement("span",{className:"ms-layer",ref:i},r.current&&rg.createPortal(s.createElement(u.FocusRectsProvider,{layerRoot:!0,providerRef:E},s.createElement(u.Fabric,Object(o.__assign)({},!b&&(ug||(ug={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach(function(e){return ug[e]=mg})),ug),g,{className:Object(u.css)(L.content,null==g?void 0:g.className),ref:E}),_)),r.current))});pg.displayName="LayerBase";var mg=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()},_g={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},hg=Object(u.styled)(pg,function(e){var t=e.className,n=e.isNotHost,a=e.theme,i=Object(u.getGlobalClassNames)(_g,a);return{root:[i.root,a.fonts.medium,n&&[i.rootNoHost,{position:"fixed",zIndex:u.ZIndexes.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[i.content,{visibility:"visible"}]}},void 0,{scope:"Layer",fields:["hostId","theme","styles"]}),bg=n("sx5R"),gg=n("bwt4"),vg=Object(u.memoizeFunction)(function(e,t){return{root:Object(u.mergeStyles)(e,t&&{touchAction:"none",selectors:{"& *":{userSelect:"none"}}})}}),yg={start:"touchstart",move:"touchmove",stop:"touchend"},Sg={start:"mousedown",move:"mousemove",stop:"mouseup"},Dg=function(e){function t(t){var n=e.call(this,t)||this;return n._currentEventType=Sg,n._events=[],n._onMouseDown=function(e){var t=s.Children.only(n.props.children).props.onMouseDown;return t&&t(e),n._currentEventType=Sg,n._onDragStart(e)},n._onMouseUp=function(e){var t=s.Children.only(n.props.children).props.onMouseUp;return t&&t(e),n._currentEventType=Sg,n._onDragStop(e)},n._onTouchStart=function(e){var t=s.Children.only(n.props.children).props.onTouchStart;return t&&t(e),n._currentEventType=yg,n._onDragStart(e)},n._onTouchEnd=function(e){var t=s.Children.only(n.props.children).props.onTouchEnd;t&&t(e),n._currentEventType=yg,n._onDragStop(e)},n._onDragStart=function(e){if("number"==typeof e.button&&0!==e.button)return!1;if(!(n.props.handleSelector&&!n._matchesSelector(e.target,n.props.handleSelector)||n.props.preventDragSelector&&n._matchesSelector(e.target,n.props.preventDragSelector))){n._touchId=n._getTouchId(e);var t=n._getControlPosition(e);if(void 0!==t){var a=n._createDragDataFromPosition(t);n.props.onStart&&n.props.onStart(e,a),n.setState({isDragging:!0,lastPosition:t}),n._events=[Object(u.on)(document.body,n._currentEventType.move,n._onDrag,!0),Object(u.on)(document.body,n._currentEventType.stop,n._onDragStop,!0)]}}},n._onDrag=function(e){"touchmove"===e.type&&e.preventDefault();var t=n._getControlPosition(e);if(t){var a=n._createUpdatedDragData(n._createDragDataFromPosition(t)),i=a.position;n.props.onDragChange&&n.props.onDragChange(e,a),n.setState({position:i,lastPosition:t})}},n._onDragStop=function(e){if(n.state.isDragging){var t=n._getControlPosition(e);if(t){var a=n._createDragDataFromPosition(t);n.setState({isDragging:!1,lastPosition:void 0}),n.props.onStop&&n.props.onStop(e,a),n.props.position&&n.setState({position:n.props.position}),n._events.forEach(function(e){return e()})}}},n.state={isDragging:!1,position:n.props.position||{x:0,y:0},lastPosition:void 0},n}return Object(o.__extends)(t,e),t.prototype.componentDidUpdate=function(e){!this.props.position||e.position&&this.props.position===e.position||this.setState({position:this.props.position})},t.prototype.componentWillUnmount=function(){this._events.forEach(function(e){return e()})},t.prototype.render=function(){var e=s.Children.only(this.props.children),t=e.props,n=this.props.position,a=this.state,i=a.position,r=a.isDragging,c=i.x,d=i.y;return n&&!r&&(c=n.x,d=n.y),s.cloneElement(e,{style:Object(o.__assign)(Object(o.__assign)({},t.style),{transform:"translate(".concat(c,"px, ").concat(d,"px)")}),className:vg(t.className,this.state.isDragging).root,onMouseDown:this._onMouseDown,onMouseUp:this._onMouseUp,onTouchStart:this._onTouchStart,onTouchEnd:this._onTouchEnd})},t.prototype._getControlPosition=function(e){var t=this._getActiveTouch(e);if(void 0===this._touchId||t){var n=t||e;return{x:n.clientX,y:n.clientY}}},t.prototype._getActiveTouch=function(e){return e.targetTouches&&this._findTouchInTouchList(e.targetTouches)||e.changedTouches&&this._findTouchInTouchList(e.changedTouches)},t.prototype._getTouchId=function(e){var t=e.targetTouches&&e.targetTouches[0]||e.changedTouches&&e.changedTouches[0];if(t)return t.identifier},t.prototype._matchesSelector=function(e,t){if(!e||e===document.body)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return!!n&&(n.call(e,t)||this._matchesSelector(e.parentElement,t))},t.prototype._findTouchInTouchList=function(e){if(void 0!==this._touchId)for(var t=0;t<e.length;t++)if(e[t].identifier===this._touchId)return e[t]},t.prototype._createDragDataFromPosition=function(e){var t=this.state.lastPosition;return void 0===t?{delta:{x:0,y:0},lastPosition:e,position:e}:{delta:{x:e.x-t.x,y:e.y-t.y},lastPosition:t,position:e}},t.prototype._createUpdatedDragData=function(e){var t=this.state.position;return{position:{x:t.x+e.delta.x,y:t.y+e.delta.y},delta:e.delta,lastPosition:t}},t}(s.Component),Ig=s.createContext({window:"object"==typeof window?window:void 0}),xg={x:0,y:0},Cg={isOpen:!1,isDarkOverlay:!0,className:"",containerClassName:"",enableAriaHiddenSiblings:!0},Og=Object(u.classNamesFunction)(),wg=s.forwardRef(function(e,t){var n,a,i,r,c,d,l,f=Object(u.getPropsWithDefaults)(Cg,e),p=f.allowTouchBodyScroll,m=f.className,_=f.children,h=f.containerClassName,b=f.scrollableContentClassName,g=f.elementToFocusOnDismiss,v=f.firstFocusableSelector,y=f.focusTrapZoneProps,S=f.forceFocusInsideTrap,D=f.disableRestoreFocus,I=void 0===D?f.ignoreExternalFocusing:D,x=f.isBlocking,C=f.isAlert,O=f.isClickableOutsideFocusTrap,w=f.isDarkOverlay,E=f.onDismiss,A=f.layerProps,L=f.overlay,k=f.isOpen,M=f.titleAriaId,P=f.styles,T=f.subtitleAriaId,U=f.theme,F=f.topOffsetFixed,H=f.responsiveMode,R=f.onLayerDidMount,N=f.isModeless,B=f.dragOptions,j=f.onDismissed,V=f.enableAriaHiddenSiblings,z=f.popupProps,G=s.useRef(null),K=s.useRef(null),W=lg(K,null==y?void 0:y.componentRef),q=s.useRef(null),Q=lg(G,t),Y=Object(gg.useResponsiveMode)(Q),J=dt("ModalFocusTrapZone",null==y?void 0:y.id),X=s.useContext(Ig).window,Z=st(),$=Z.setTimeout,ee=Z.clearTimeout,te=s.useState(k),ne=te[0],ae=te[1],ie=s.useState(k),re=ie[0],oe=ie[1],se=s.useState(xg),ce=se[0],de=se[1],le=s.useState(),ue=le[0],fe=le[1],pe=function(e){var t=s.useState(!1),n=t[0],a=t[1];return[n,{setTrue:ot(function(){return function(){a(!0)}}),setFalse:ot(function(){return function(){a(!1)}}),toggle:ot(function(){return function(){a(function(e){return!e})}})}]}(),me=pe[0],_e=pe[1],he=_e.toggle,be=_e.setFalse,ge=ot(function(){return{onModalCloseTimer:0,allowTouchBodyScroll:p,scrollableContent:null,lastSetCoordinates:xg,events:new u.EventGroup({})}}),ve=(B||{}).keepInBounds,ye=null!=C?C:x&&!N,Se=void 0===A?"":A.className,De=Og(P,{theme:U,className:m,containerClassName:h,scrollableContentClassName:b,isOpen:k,isVisible:re,hasBeenOpened:ge.hasBeenOpened,modalRectangleTop:ue,topOffsetFixed:F,isModeless:N,layerClassName:Se,windowInnerHeight:null==X?void 0:X.innerHeight,isDefaultDragHandle:B&&!B.dragHandleSelector}),Ie=Object(o.__assign)(Object(o.__assign)({eventBubblingEnabled:!1},A),{onLayerDidMount:A&&A.onLayerDidMount?A.onLayerDidMount:R,insertFirst:(null==A?void 0:A.insertFirst)||N,className:De.layer}),xe=s.useCallback(function(e){e?ge.allowTouchBodyScroll?Object(u.allowOverscrollOnElement)(e,ge.events):Object(u.allowScrollOnElement)(e,ge.events):ge.events.off(ge.scrollableContent),ge.scrollableContent=e},[ge]),Ce=function(){var e=q.current,t=null==e?void 0:e.getBoundingClientRect();t&&(F&&fe(t.top),ve&&(ge.minPosition={x:-t.left,y:-t.top},ge.maxPosition={x:t.left,y:t.top}))},Oe=s.useCallback(function(e,t){var n=ge.minPosition,a=ge.maxPosition;return ve&&n&&a&&(t=Math.max(n[e],t),t=Math.min(a[e],t)),t},[ve,ge]),we=function(){var e;ge.lastSetCoordinates=xg,be(),ge.isInKeyboardMoveMode=!1,ae(!1),de(xg),null===(e=ge.disposeOnKeyUp)||void 0===e||e.call(ge),null==j||j()},Ee=s.useCallback(function(){be(),ge.isInKeyboardMoveMode=!1},[ge,be]),Ae=s.useCallback(function(e,t){de(function(e){return{x:Oe("x",e.x+t.delta.x),y:Oe("y",e.y+t.delta.y)}})},[Oe]),Le=s.useCallback(function(){K.current&&K.current.focus()},[]);s.useEffect(function(){var e;ee(ge.onModalCloseTimer),k&&(requestAnimationFrame(function(){return $(Ce,0)}),ae(!0),B&&(e=function(e){e.altKey&&e.ctrlKey&&e.keyCode===u.KeyCodes.space&&Object(u.elementContains)(ge.scrollableContent,e.target)&&(he(),e.preventDefault(),e.stopPropagation())},ge.disposeOnKeyUp||(ge.events.on(X,"keyup",e,!0),ge.disposeOnKeyUp=function(){ge.events.off(X,"keyup",e,!0),ge.disposeOnKeyUp=void 0})),ge.hasBeenOpened=!0,oe(!0)),!k&&ne&&(ge.onModalCloseTimer=$(we,1e3*parseFloat(tg)),oe(!1))},[ne,k]),d=function(){ge.events.dispose()},(l=s.useRef(d)).current=d,s.useEffect(function(){return function(){var e;null===(e=l.current)||void 0===e||e.call(l)}},[]),function(e,t){s.useImperativeHandle(e.componentRef,function(){return{focus:function(){t.current&&t.current.focus()}}},[t])}(f,K);var ke=s.createElement(u.FocusTrapZone,Object(o.__assign)({},y,{id:J,ref:q,componentRef:W,className:Object(u.css)(De.main,null==y?void 0:y.className),elementToFocusOnDismiss:null!==(n=null==y?void 0:y.elementToFocusOnDismiss)&&void 0!==n?n:g,isClickableOutsideFocusTrap:null!==(a=null==y?void 0:y.isClickableOutsideFocusTrap)&&void 0!==a?a:N||O||!x,disableRestoreFocus:null!==(i=null==y?void 0:y.disableRestoreFocus)&&void 0!==i?i:I,forceFocusInsideTrap:(null!==(r=null==y?void 0:y.forceFocusInsideTrap)&&void 0!==r?r:S)&&!N,firstFocusableSelector:(null==y?void 0:y.firstFocusableSelector)||v,focusPreviouslyFocusedInnerElement:null===(c=null==y?void 0:y.focusPreviouslyFocusedInnerElement)||void 0===c||c,onBlur:ge.isInKeyboardMoveMode?function(e){var t,n;null===(t=null==y?void 0:y.onBlur)||void 0===t||t.call(y,e),ge.lastSetCoordinates=xg,ge.isInKeyboardMoveMode=!1,null===(n=ge.disposeOnKeyDown)||void 0===n||n.call(ge)}:void 0}),B&&ge.isInKeyboardMoveMode&&s.createElement("div",{className:De.keyboardMoveIconContainer},B.keyboardMoveIconProps?s.createElement($t.Icon,Object(o.__assign)({},B.keyboardMoveIconProps)):s.createElement($t.Icon,{iconName:"move",className:De.keyboardMoveIcon})),s.createElement("div",{ref:xe,className:De.scrollableContent,"data-is-scrollable":!0},B&&me&&s.createElement(B.menu,{items:[{key:"move",text:B.moveMenuItemText,onClick:function(){var e=function(e){if(e.altKey&&e.ctrlKey&&e.keyCode===u.KeyCodes.space)return e.preventDefault(),void e.stopPropagation();var t=e.altKey||e.keyCode===u.KeyCodes.escape;if(me&&t&&be(),!ge.isInKeyboardMoveMode||e.keyCode!==u.KeyCodes.escape&&e.keyCode!==u.KeyCodes.enter||(ge.isInKeyboardMoveMode=!1,e.preventDefault(),e.stopPropagation()),ge.isInKeyboardMoveMode){var n=!0,a=function(e){var t=10;return e.shiftKey?e.ctrlKey||(t=50):e.ctrlKey&&(t=1),t}(e);switch(e.keyCode){case u.KeyCodes.escape:de(ge.lastSetCoordinates);case u.KeyCodes.enter:ge.lastSetCoordinates=xg;break;case u.KeyCodes.up:de(function(e){return{x:e.x,y:Oe("y",e.y-a)}});break;case u.KeyCodes.down:de(function(e){return{x:e.x,y:Oe("y",e.y+a)}});break;case u.KeyCodes.left:de(function(e){return{x:Oe("x",e.x-a),y:e.y}});break;case u.KeyCodes.right:de(function(e){return{x:Oe("x",e.x+a),y:e.y}});break;default:n=!1}n&&(e.preventDefault(),e.stopPropagation())}};ge.lastSetCoordinates=ce,be(),ge.isInKeyboardMoveMode=!0,ge.events.on(X,"keydown",e,!0),ge.disposeOnKeyDown=function(){ge.events.off(X,"keydown",e,!0),ge.disposeOnKeyDown=void 0}}},{key:"close",text:B.closeMenuItemText,onClick:we}],onDismiss:be,alignTargetEdge:!0,coverTarget:!0,directionalHint:u.DirectionalHint.topLeftEdge,directionalHintFixed:!0,shouldFocusOnMount:!0,target:ge.scrollableContent}),_));return ne&&Y>=(H||gg.ResponsiveMode.small)&&s.createElement(hg,Object(o.__assign)({ref:Q},Ie),s.createElement(bg.Popup,Object(o.__assign)({role:ye?"alertdialog":"dialog",ariaLabelledBy:M,ariaDescribedBy:T,onDismiss:E,shouldRestoreFocus:!I,enableAriaHiddenSiblings:V,"aria-modal":!N},z),s.createElement("div",{className:De.root,role:N?void 0:"document"},!N&&s.createElement(u.Overlay,Object(o.__assign)({"aria-hidden":!0,isDarkThemed:w,onClick:x?void 0:E,allowTouchBodyScroll:p},L)),B?s.createElement(Dg,{handleSelector:B.dragHandleSelector||"#".concat(J),preventDragSelector:"button",onStart:Ee,onDragChange:Ae,onStop:Le,position:ce},ke):ke)))||null});wg.displayName="Modal";var Eg=Object(u.styled)(wg,function(e){var t,n=e.className,a=e.containerClassName,i=e.scrollableContentClassName,r=e.isOpen,o=e.isVisible,s=e.hasBeenOpened,c=e.modalRectangleTop,d=e.theme,l=e.topOffsetFixed,f=e.isModeless,p=e.layerClassName,m=e.isDefaultDragHandle,_=e.windowInnerHeight,h=d.palette,b=d.effects,g=d.fonts,v=Object(u.getGlobalClassNames)(ng,d);return{root:[v.root,g.medium,{backgroundColor:"transparent",position:"fixed",height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",opacity:0,pointerEvents:"none",transition:"opacity ".concat(tg)},l&&"number"==typeof c&&s&&{alignItems:"flex-start"},r&&v.isOpen,o&&{opacity:1},o&&!f&&{pointerEvents:"auto"},n],main:[v.main,{boxShadow:b.elevation64,borderRadius:b.roundedCorner2,backgroundColor:h.white,boxSizing:"border-box",position:"relative",textAlign:"left",outline:"3px solid transparent",maxHeight:"calc(100% - 32px)",maxWidth:"calc(100% - 32px)",minHeight:"176px",minWidth:"288px",overflowY:"auto",zIndex:f?u.ZIndexes.Layer:void 0},f&&{pointerEvents:"auto"},l&&"number"==typeof c&&s&&{top:c},m&&{cursor:"move"},a],scrollableContent:[v.scrollableContent,{overflowY:"auto",flexGrow:1,maxHeight:"100vh",selectors:(t={},t["@supports (-webkit-overflow-scrolling: touch)"]={maxHeight:_},t)},i],layer:f&&[p,v.layer,{pointerEvents:"none"}],keyboardMoveIconContainer:{position:"absolute",display:"flex",justifyContent:"center",width:"100%",padding:"3px 0px"},keyboardMoveIcon:{fontSize:g.xLargePlus.fontSize,width:"24px"}}},void 0,{scope:"Modal",fields:["theme","styles","enableAriaHiddenSiblings"]});Eg.displayName="Modal";var Ag=Object(u.classNamesFunction)(),Lg=function(e){function t(t){var n=e.call(this,t)||this;return Object(u.initializeComponentRef)(n),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,a=e.theme;return this._classNames=Ag(n,{theme:a,className:t}),s.createElement("div",{className:this._classNames.actions},s.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return s.Children.map(this.props.children,function(t){return t?s.createElement("span",{className:e._classNames.action},t):null})},t}(s.Component),kg={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"},Mg=Object(u.styled)(Lg,function(e){var t=e.className,n=e.theme,a=Object(u.getGlobalClassNames)(kg,n);return{actions:[a.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal",verticalAlign:"middle"}}},t],action:[a.action,{margin:"0 4px"}],actionsRight:[a.actionsRight,{alignItems:"center",display:"flex",fontSize:"0",justifyContent:"flex-end",marginRight:"-4px"}]}},void 0,{scope:"DialogFooter"}),Pg=Object(u.classNamesFunction)(),Tg=s.createElement(Mg,null).type,Ug=function(e){function t(t){var n=e.call(this,t)||this;return Object(u.initializeComponentRef)(n),Object(u.warnDeprecations)("DialogContent",t,{titleId:"titleProps.id"}),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,a=t.className,i=t.closeButtonAriaLabel,r=t.onDismiss,c=t.subTextId,d=t.subText,l=t.titleProps,f=void 0===l?{}:l,p=t.titleId,m=t.title,_=t.type,h=t.styles,b=t.theme,g=t.draggableHeaderClassName,v=Pg(h,{theme:b,className:a,isLargeHeader:_===Jb.largeHeader,isClose:_===Jb.close,draggableHeaderClassName:g}),y=this._groupChildren();return d&&(e=s.createElement("p",{className:v.subText,id:c},d)),s.createElement("div",{className:v.content},s.createElement("div",{className:v.header},s.createElement("div",Object(o.__assign)({id:p,role:"heading","aria-level":1},f,{className:Object(u.css)(v.title,f.className)}),m),s.createElement("div",{className:v.topButton},this.props.topButtonsProps.map(function(e,t){return s.createElement(u.IconButton,Object(o.__assign)({key:e.uniqueId||t},e))}),(_===Jb.close||n&&_!==Jb.largeHeader)&&s.createElement(u.IconButton,{className:v.button,iconProps:{iconName:"Cancel"},ariaLabel:i,onClick:r}))),s.createElement("div",{className:v.inner},s.createElement("div",{className:v.innerContent},e,y.contents),y.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return s.Children.map(this.props.children,function(t){"object"==typeof t&&null!==t&&t.type===Tg?e.footers.push(t):e.contents.push(t)}),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},Object(o.__decorate)([gg.withResponsiveMode],t)}(s.Component),Fg={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},Hg=Object(u.styled)(Ug,function(e){var t,n,a,i=e.className,r=e.theme,o=e.isLargeHeader,s=e.isClose,c=e.hidden,d=e.isMultiline,l=e.draggableHeaderClassName,f=r.palette,p=r.fonts,m=r.effects,_=r.semanticColors,h=Object(u.getGlobalClassNames)(Fg,r);return{content:[o&&[h.contentLgHeader,{borderTop:"4px solid ".concat(f.themePrimary)}],s&&h.close,{flexGrow:1,overflowY:"hidden"},i],subText:[h.subText,p.medium,{margin:"0 0 24px 0",color:_.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:u.FontWeights.regular}],header:[h.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&h.close,l&&[l,{cursor:"move"}]],button:[h.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:_.buttonText,fontSize:u.IconFontSizes.medium}}}],inner:[h.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: ".concat(u.ScreenWidthMinSmall,"px) and (max-width: ").concat(u.ScreenWidthMaxSmall,"px)")]={padding:"0 16px 16px"},t)}],innerContent:[h.content,{position:"relative",width:"100%"}],title:[h.title,p.xLarge,{color:_.bodyText,margin:"0",minHeight:p.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: ".concat(u.ScreenWidthMinSmall,"px) and (max-width: ").concat(u.ScreenWidthMaxSmall,"px)")]={padding:"16px 46px 16px 16px"},n)},o&&{color:_.menuHeader},d&&{fontSize:p.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(a={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:_.buttonText},".ms-Dialog-button:hover":{color:_.buttonTextHovered,borderRadius:m.roundedCorner2}},a["@media (min-width: ".concat(u.ScreenWidthMinSmall,"px) and (max-width: ").concat(u.ScreenWidthMaxSmall,"px)")]={padding:"15px 8px 0 0"},a)}]}},void 0,{scope:"DialogContent"}),Rg=Object(u.classNamesFunction)(),Ng={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1,enableAriaHiddenSiblings:!0},Bg={type:Jb.normal,className:"",topButtonsProps:[]},jg=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,a=e.modalProps,i=e.dialogContentProps,r=e.subText,o=a&&a.subtitleAriaId||t;return o||(o=(i&&i.subText||r)&&n._defaultSubTextId),o},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,a=e.modalProps,i=e.dialogContentProps,r=e.title,o=a&&a.titleAriaId||t;return o||(o=(i&&i.title||r)&&n._defaultTitleTextId),o},n._id=Object(u.getId)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t,n,a,i,r=this.props,c=r.className,d=r.containerClassName,l=r.contentClassName,u=r.elementToFocusOnDismiss,f=r.firstFocusableSelector,p=r.forceFocusInsideTrap,m=r.styles,_=r.hidden,h=r.disableRestoreFocus,b=void 0===h?r.ignoreExternalFocusing:h,g=r.isBlocking,v=r.isClickableOutsideFocusTrap,y=r.isDarkOverlay,S=r.isOpen,D=void 0===S?!_:S,I=r.onDismiss,x=r.onDismissed,C=r.onLayerDidMount,O=r.responsiveMode,w=r.subText,E=r.theme,A=r.title,L=r.topButtonsProps,k=r.type,M=r.minWidth,P=r.maxWidth,T=r.modalProps,U=Object(o.__assign)({onLayerDidMount:C},null==T?void 0:T.layerProps);(null==T?void 0:T.dragOptions)&&!(null===(e=T.dragOptions)||void 0===e?void 0:e.dragHandleSelector)&&(a="ms-Dialog-draggable-header",(i=Object(o.__assign)({},T.dragOptions)).dragHandleSelector=".".concat(a));var F=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Ng),{elementToFocusOnDismiss:u,firstFocusableSelector:f,forceFocusInsideTrap:p,disableRestoreFocus:b,isClickableOutsideFocusTrap:v,responsiveMode:O,className:c,containerClassName:d,isBlocking:g,isDarkOverlay:y,onDismissed:x}),T),{dragOptions:i,layerProps:U,isOpen:D}),H=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({className:l,subText:w,title:A,topButtonsProps:L,type:k},Bg),r.dialogContentProps),{draggableHeaderClassName:a,titleProps:Object(o.__assign)({id:(null===(t=r.dialogContentProps)||void 0===t?void 0:t.titleId)||this._defaultTitleTextId},null===(n=r.dialogContentProps)||void 0===n?void 0:n.titleProps)}),R=Rg(m,{theme:E,className:F.className,containerClassName:F.containerClassName,hidden:_,dialogDefaultMinWidth:M,dialogDefaultMaxWidth:P});return s.createElement(Eg,Object(o.__assign)({},F,{className:R.root,containerClassName:R.main,onDismiss:I||F.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),s.createElement(Hg,Object(o.__assign)({subTextId:this._defaultSubTextId,showCloseButton:F.isBlocking,onDismiss:I},H),r.children))},t.defaultProps={hidden:!0},Object(o.__decorate)([gg.withResponsiveMode],t)}(s.Component),Vg={root:"ms-Dialog"},zg=Object(u.styled)(jg,function(e){var t,n=e.className,a=e.containerClassName,i=e.dialogDefaultMinWidth,r=void 0===i?"288px":i,o=e.dialogDefaultMaxWidth,s=void 0===o?"340px":o,c=e.hidden,d=e.theme;return{root:[Object(u.getGlobalClassNames)(Vg,d).root,d.fonts.medium,n],main:[{width:r,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: ".concat(u.ScreenWidthMinMedium,"px)")]={width:"auto",maxWidth:s,minWidth:r},t)},!c&&{display:"flex"},a]}},void 0,{scope:"Dialog"});zg.displayName="Dialog";var Gg=function(){return Gg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gg.apply(this,arguments)},Kg=Object(s.memo)(function(e){var t=e.isVisible,n=e.dialogStrings,a=e.hostId,i=e.dialogType,r=void 0===i?Jb.close:i,o=e.styles,d=e.onConfirm,l=e.onCancel,f=$(),p={type:r,title:n.contentTitle,closeButtonAriaLabel:n.closeButtonAriaLabel,subText:n.contentSubText,styles:null==o?void 0:o.dialogContent},m=Object(s.useMemo)(function(){var e={main:{backgroundColor:f.palette.neutralLighterAlt}};return Object(u.concatStyleSets)(e,null==o?void 0:o.dialog)},[null==o?void 0:o.dialog,f]);return c.a.createElement(zg,{hidden:!t,onDismiss:l,dialogContentProps:p,modalProps:Gg({styles:m},a&&{layerProps:{hostId:a,styles:null==o?void 0:o.layer}})},c.a.createElement(Mg,{styles:null==o?void 0:o.dialogFooter},c.a.createElement(u.PrimaryButton,{"data-test-id":"reset-confirm",onClick:d,text:n.confirmText,ariaLabel:n.confirmAriaLabel,styles:null==o?void 0:o.confirmButton}),c.a.createElement(u.DefaultButton,{onClick:l,text:n.cancelText,ariaLabel:n.cancelAriaLabel,styles:null==o?void 0:o.cancelButton})))}),Wg=Object(s.memo)(function(e){var t=e.isVisible,n=e.hostId,a=e.dialogType,i=void 0===a?Jb.close:a,r=e.styles,o=e.onConfirm,d=e.onCancel,l=Object(s.useMemo)(function(){return Object(u.merge)({dialog:{main:{minHeight:"160px"}}},r)},[r]),f=Object(s.useContext)(Ze).strings,p={contentTitle:f.toolbar_resetConfirmDialogContentTitle,contentSubText:f.toolbar_resetConfirmDialogContentSubText,closeButtonAriaLabel:f.toolbar_resetConfirmDialogCloseButtonAriaLabel,confirmText:f.toolbar_resetConfirmDialogConfirmText,confirmAriaLabel:f.toolbar_resetConfirmDialogConfirmAriaLabel,cancelText:f.toolbar_resetConfirmDialogCancelText,cancelAriaLabel:f.toolbar_resetConfirmDialogCancelAriaLabel};return c.a.createElement(Kg,{isVisible:t,hostId:n,dialogType:i,dialogStrings:p,styles:l,onConfirm:o,onCancel:d})}),qg=function(){return qg=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},qg.apply(this,arguments)},Qg={onConfirmInDialog:function(){},onCancelInDialog:function(){},isHavanaConfirmDialogVisible:!1},Yg=function(e){var t=Object(s.useState)(Qg),n=t[0],a=t[1],i=function(){a(Qg)},r=Object(s.useCallback)(function(){return e?e():new Promise(function(e,t){a({onConfirmInDialog:function(){e("confirmed"),i()},onCancelInDialog:function(){e("canceled"),i()},isHavanaConfirmDialogVisible:!0})})},[e]);return qg(qg({},n),{showConfirmationDialog:r})},Jg=Object(s.createContext)({onResetEditsConfirmationDialog:void 0}),Xg=function(e){var t=e.onResetEditsConfirmationDialog,n=e.children;return c.a.createElement(Jg.Provider,{value:{onResetEditsConfirmationDialog:t}},n)},Zg=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},$g=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},e0=Object(s.memo)(function(e){var t=this,n=e.stackResponseMode,a=e.resetDisabled,i=e.resetEdits,r=e.setAriaAnnouncement,o=e.resetButtonStyles,d=e.confirmationDialogStyles,l=$(),f=Object(s.useContext)(Ze).strings,p=Object(s.useMemo)(function(){return Object(u.concatStyleSets)(function(e){return{root:{color:e.palette.neutralPrimary,height:"32px"},rootDisabled:{color:e.palette.neutralTertiary},rootHovered:{color:e.palette.neutralPrimary,backgroundColor:e.palette.neutralLight},rootPressed:{color:e.palette.neutralPrimary,backgroundColor:e.palette.neutralQuaternaryAlt},icon:{color:e.palette.themePrimary}}}(l),o)},[l,o]),m=Object(s.useContext)(Jg).onResetEditsConfirmationDialog,_=Yg(m),h=_.showConfirmationDialog,b=_.onConfirmInDialog,g=_.onCancelInDialog,v=_.isHavanaConfirmDialogVisible,y=function(e,t,n){var a=Object(s.useContext)(Zt).logEditResetEvent,i=Object(s.useContext)(lh).setImageLayer;return Object(s.useCallback)(function(r){a({inputType:Xs(r)}),e(!0),i("overlay",null),t(n)},[a,e,i,t,n])}(i,r,f.toolbar_imageResetFinishedAriaLive),S=function(e){return Zg(t,void 0,void 0,function(){return $g(this,function(t){switch(t.label){case 0:return[4,h().then(function(t){"confirmed"===t&&y(e)}).catch(function(e){})];case 1:return t.sent(),[2]}})})};return c.a.createElement(c.a.Fragment,null,c.a.createElement(u.ActionButton,{key:"Reset",text:n>Cb.Medium?f.toolbar_imageReset:void 0,styles:p,ariaLabel:f.toolbar_imageResetAriaLabel,title:f.toolbar_imageResetTooltip,iconProps:{iconName:"History"},onClick:function(e){return Zg(t,void 0,void 0,function(){return $g(this,function(t){return e.persist(),[2,S(e)]})})},disabled:a,role:"button","data-test-id":"reset",allowDisabledFocus:!0}),c.a.createElement("span",{style:{margin:"0px"}},c.a.createElement(Wg,{onConfirm:b,onCancel:g,isVisible:v,styles:d})))}),t0={resetEdits:se,setAriaAnnouncement:Jn},n0=Object(ee.connect)(function(e){return{resetDisabled:eg(e)}},t0)(e0),a0=Object(ga.e)(Co,function(e){return jr(e,-.05).uvToWorld}),i0=Object(ga.e)(Co,function(e){return jr(e,pr).uvToWorld}),r0=Object(ga.e)(Co,function(e){return br(e,di(e.view.worldToView))}),o0=Object(ga.e)([wo,Ho,Oo,a0,r0],function(e,t,n,a,i){return e&&fi(n,a)||t&&i.zoomIsMaximum}),s0=Object(ga.e)([wo,Ho,Oo,i0,Fo],function(e,t,n,a,i){return e&&fi(n,a)||t&&i===dr.fitCropRectInView});function c0(e,t){var n=Object(s.useRef)(e);return t||(n.current=e),n.current}var d0,l0=Object(s.memo)(function(e){var t=e.stackResponseMode,n=e.zoomInDisabled,a=e.zoomOutDisabled,i=e.freezeZoomInOutDisabled,r=e.currentZoom,o=e.setAriaAnnouncementScenario,d=e.handleZoomDeltaChange,l=e.styles,f=$(),p=Object(s.useContext)(Ze).strings,m=Object(s.useMemo)(function(){return Object(u.concatStyleSets)(kb(f),l)},[f,l]),_=Object(s.useCallback)(function(){d(-.05),o({type:"Zoom",zoom:r})},[r,o,d]),h=Object(s.useCallback)(function(){d(pr),o({type:"Zoom",zoom:r})},[r,o,d]),b=c0(n,i),g=c0(a,i);return c.a.createElement(c.a.Fragment,null,t>Cb.Small&&c.a.createElement(c.a.Fragment,null,c.a.createElement(u.IconButton,{key:"ZoomIn",iconProps:{iconName:"ZoomIn"},styles:m,ariaLabel:p.toolbar_zoomInAriaLabel,title:p.toolbar_zoomInTooltip,role:"button",onClick:_,disabled:b,"data-test-id":"zoom-in"}),c.a.createElement(u.IconButton,{key:"ZoomOut",iconProps:{iconName:"ZoomOut"},styles:m,ariaLabel:p.toolbar_zoomOutAriaLabel,title:p.toolbar_zoomOutTooltip,role:"button",onClick:h,disabled:g,"data-test-id":"zoom-out"})))}),u0={handleZoomDeltaChange:ad,setAriaAnnouncementScenario:Xn},f0=Object(ee.connect)(function(e){var t=!e.transformTools.cropInteraction.enableZoomToCrop&&!e.transformTools.view.enableZoomToView,n=!!e.transformTools.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown;return{currentZoom:Kp(e),zoomInDisabled:t||o0(e),zoomOutDisabled:t||s0(e),freezeZoomInOutDisabled:n}},u0)(l0);!function(e){e.SaveAs="SaveAs",e.SaveAsOriginal="SaveAsOriginal"}(d0||(d0={}));var p0=Object(s.createContext)(new Set),m0=Object(s.memo)(function(e){var t=e.onSave,n=e.styles,a=e.onRenderSaveMenu,i=Object(s.useContext)(Ze).strings,r=$(),o=function(e){var t=Object(s.useContext)(Zt).logSaveEvent,n=Qb(),a=Yb(),i=Object(s.useCallback)(function(i){return function(r){var o,s=n.getState().filters;a(),t({saveType:i,filterName:null===(o=null==s?void 0:s.activeFilter)||void 0===o?void 0:o.name,filterIntensity:null==s?void 0:s.filterLevel,inputType:function(){if(r){var e=r;return void 0!==e.buttons?Xs(e):"Keyboard"}return""}()}),e(i)}},[t,e,n,a]);return{onSaveOriginal:Object(s.useMemo)(function(){return i(d0.SaveAsOriginal)},[i]),onSaveAsCopy:Object(s.useMemo)(function(){return i(d0.SaveAs)},[i])}}(t),d=o.onSaveOriginal,l=o.onSaveAsCopy,f=Object(s.useMemo)(function(){return Object(u.concatStyleSets)(function(e){return{root:Lb(Lb({},Mb(e)),{margin:"0px 4px"}),rootDisabled:{backgroundColor:e.palette.neutralQuaternaryAlt,color:e.palette.neutralTertiary},rootHovered:Mb(e),rootPressed:Mb(e),rootExpanded:Mb(e)}}(r),n)},[r,n]),p=Object(s.useContext)(p0),m=!p.has(d0.SaveAsOriginal),_=!p.has(d0.SaveAs),h=[{key:"SaveOriginal",text:i.toolbar_imageSaveAsOriginal,ariaLabel:i.toolbar_imageSaveAsOriginalAriaLabel,title:i.toolbar_imageSaveAsOriginalTooltip,iconProps:{iconName:"Save"},onClick:d,disabled:m},{key:"SaveCopy",text:i.toolbar_imageSaveAsCopy,ariaLabel:i.toolbar_imageSaveAsCopyAriaLabel,title:i.toolbar_imageSaveAsCopyTooltip,iconProps:{iconName:"SaveAs"},onClick:l,disabled:_}],b={items:h};return a?a({onSave:t,saveMenuItems:h,enabledSaveTypes:p,primaryButtonStyles:f}):c.a.createElement(u.PrimaryButton,{text:i.toolbar_imageSave,title:i.toolbar_imageSaveTooltip,styles:f,menuTriggerKeyCode:u.KeyCodes.down,"data-test-id":"save_menu",menuProps:b,disabled:m&&_,allowDisabledFocus:!0})}),_0=function(){return _0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_0.apply(this,arguments)},h0=c.a.memo(function(e){var t=e.currentZoom,n=e.styles,a=Object(s.useContext)(Ze),i=a.localizePercentage,r=a.strings,o=$(),d={color:o.palette.neutralPrimaryAlt,lineHeight:"24px",minWidth:"45px",textAlign:Object(u.getRTL)(o)?"left":"right"},l=r;return c.a.createElement("div",{style:_0({},null==n?void 0:n.container)},c.a.createElement("span",{style:_0(_0({float:Object(u.getRTL)(o)?"left":"right"},d),null==n?void 0:n.label),"aria-label":l.toolbar_zoomLevelAriaLabel},i(t)))}),b0=Object(ee.connect)(function(e){return{currentZoom:Kp(e)}})(h0),g0=Object(s.createContext)({combinedUndoRedoCoordinator:void 0}),v0=Object(s.memo)(function(e){var t=e.styles,n=Object(s.useContext)(g0).combinedUndoRedoCoordinator,a=Object(s.useContext)(Ze).strings,i=$(),r=Object(u.getRTL)(i),o=Object(s.useMemo)(function(){return Object(u.concatStyleSets)(kb(i),t)},[i,t]),d=Object(s.useState)(!0),l=d[0],f=d[1],p=Object(s.useState)(!0),m=p[0],_=p[1];return function(e){var t=Object(s.useContext)(g0).combinedUndoRedoCoordinator;Object(s.useEffect)(function(){return null==t||t.onChange.addListener(e),e(),function(){null==t||t.onChange.removeListener(e)}},[t,e])}(Object(s.useCallback)(function(){f(!(null==n?void 0:n.canUndo())),_(!(null==n?void 0:n.canRedo()))},[n])),c.a.createElement(c.a.Fragment,null,c.a.createElement(u.IconButton,{key:"Undo",iconProps:{iconName:r?"RedoIcon-Havana":"UndoIcon-Havana"},styles:o,ariaLabel:a.toolbar_undoAriaLabel,title:a.toolbar_undo,role:"button",onClick:function(){null==n||n.undo()},disabled:l,"data-test-id":"undo"}),c.a.createElement(u.IconButton,{key:"Redo",iconProps:{iconName:r?"UndoIcon-Havana":"RedoIcon-Havana"},styles:o,ariaLabel:a.toolbar_redoAriaLabel,title:a.toolbar_redo,role:"button",onClick:function(){null==n||n.redo()},disabled:m,"data-test-id":"redo"}))}),y0=function(){return y0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},y0.apply(this,arguments)},S0=function(){return S0=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},S0.apply(this,arguments)},D0=c.a.memo(function(e){var t=e.componentSize,n=e.customItems,a=e.onSave,i=e.onRenderSaveMenu,r=e.onCancel,o=e.controlPivot,d=e.resetButtonStyles,l=e.confirmationDialogStyles,f=Object(s.useState)(null),p=f[0],m=f[1],_=Object(s.useState)(Cb.Large),h=_[0],b=_[1],g=$(),v=Object(u.getRTL)(g),y=Object(s.useContext)(dh).enableUndoRedo;return Object(s.useLayoutEffect)(function(){p&&(p.clientWidth>1024?b(Cb.Large):p.clientWidth>894?b(Cb.Medium):b(Cb.Small))},[p,t]),c.a.createElement("div",{ref:m},c.a.createElement(u.Stack,{className:"EditorCommandBarStack_e8ecbb5e",horizontal:!0,styles:{root:{backgroundColor:g.palette.neutralLighter,borderBottom:"".concat(g.palette.neutralQuaternary," solid 1px")}}},c.a.createElement(u.Stack.Item,{className:"CommandBarBeginningStackItem_e8ecbb5e",grow:!o},c.a.createElement(m0,{onSave:a,onRenderSaveMenu:i}),c.a.createElement($b,{styles:{padding:v?"0 16px 0 8px":"0 8px 0 16px",color:g.palette.neutralTertiary}}),c.a.createElement(n0,{stackResponseMode:h,resetButtonStyles:d,confirmationDialogStyles:l}),y&&c.a.createElement(v0,null),null==n?void 0:n.map(function(e){var t,n,a=e.key,i=e.iconProps,r=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["key","iconProps"]);return c.a.createElement(u.CommandBarButton,S0({key:a},r,{iconProps:(t=kb(g),n=i,y0(y0({},n),{styles:y0(y0({},t),null==n?void 0:n.styles)}))}))})),o&&c.a.createElement(u.Stack.Item,{grow:!0,disableShrink:!0,className:"CommandBarMiddleStackItem_e8ecbb5e"},o),c.a.createElement(u.Stack.Item,{className:"CommandBarEndStackItem_e8ecbb5e",grow:!o},c.a.createElement(b0,{styles:{container:{width:"auto",padding:"0px 4px"}}}),c.a.createElement(f0,{stackResponseMode:h}),c.a.createElement(Xb,{onCancel:r,iconProps:{iconName:"cancel"}}))))});function I0(e){return{count:{},icon:{color:e.palette.themePrimary,svg:{width:"1em",height:"1em",fill:"currentcolor"},i:{height:"100%",display:"flex",alignItems:"center"},fontSize:"16px"},link:{height:"34px",lineHeight:"34px","&:hover":{backgroundColor:e.palette.neutralLight},"&:active":{backgroundColor:e.palette.neutralQuaternaryAlt}},linkContent:{height:"100%",display:"flex"},linkIsSelected:{height:"34px",lineHeight:"34px","&:hover":{backgroundColor:e.palette.neutralLight},color:e.palette.neutralPrimary},root:{"button:hover i":{color:e.palette.themeDarkAlt},display:"flex"},text:{marginInlineStart:"4px"},linkInMenu:{},overflowMenuButton:{}}}D0.displayName="EditorCommandBar",Object($e.loadStyles)([{rawString:".dismissButton_23822781{margin-top:16px;margin-bottom:8px;border:none}"}]);var x0=Object(s.memo)(function(e){var t=e.styles,n=e.setShowAspectRatioOptions,a=$(),i=Object(s.useContext)(Ze).strings,r=Object(s.useCallback)(function(){n(!1)},[n]);return c.a.createElement(u.DefaultButton,{className:"dismissButton_23822781",text:i.footer_done,onClick:r,theme:a,styles:t})});x0.displayName="DesktopDismissAspectRatioOptionsButton";var C0={setShowAspectRatioOptions:Is},O0=Object(ee.connect)(null,C0)(x0);Object($e.loadStyles)([{rawString:".actionsStackContainer_7d1b69c4{position:absolute;bottom:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;width:100%}"}]);var w0=Object(s.memo)(function(e){var t=e.children,n=e.styles,a=void 0===n?{}:n;return c.a.createElement("div",{className:"actionsStackContainer_7d1b69c4",style:a.container},t)}),E0=null;function A0(e,t,n){var a=function(){if(!E0){var e=document.createElement("canvas");E0=e.getContext("2d")}return E0}(),i=0;if(a){a.font=t+"px "+n;var r=a.measureText(e);i=Math.ceil(r.width)}return i}function L0(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(e&&1===e.length&&e[0]&&!e[0].subComponentStyles)return e[0];for(var n={},a={},i=0,r=e;i<r.length;i++){var s=r[i];if(s)for(var c in s)if(s.hasOwnProperty(c)){if("subComponentStyles"===c&&void 0!==s.subComponentStyles){var d=s.subComponentStyles;for(var l in d)d.hasOwnProperty(l)&&(a.hasOwnProperty(l)?a[l].push(d[l]):a[l]=[d[l]]);continue}var u=n[c],f=s[c];n[c]=void 0===u?f:Object(o.__spreadArrays)(Array.isArray(u)?u:[u],Array.isArray(f)?f:[f])}}if(Object.keys(a).length>0){n.subComponentStyles={};var p=n.subComponentStyles,m=function(e){if(a.hasOwnProperty(e)){var t=a[e];p[e]=function(e){return L0.apply(void 0,t.map(function(t){return"function"==typeof t?t(e):t}))}}};for(var l in a)m(l)}return n}"".concat(18,"px"),"".concat(18,"px");var k0=n("qkRx"),M0=s.createContext({customizations:{inCustomizerContext:!1,settings:{},scopedSettings:{}}}),P0=["theme","styles"];function T0(e,t,n,a,i){var r=(a=a||{scope:"",fields:void 0}).scope,c=a.fields,d=void 0===c?P0:c,l=s.forwardRef(function(a,i){var c,l,u,f,p,m,_=s.useRef(),h=(c=d,l=r,u=s.useState(0)[1],f=function(){return u(function(e){return++e})},p=s.useContext(M0).customizations,m=p.inCustomizerContext,s.useEffect(function(){return m||k0.e.observe(f),function(){m||k0.e.unobserve(f)}},[m]),k0.e.getSettings(c,l,p)),b=h.styles,g=(h.dir,Object(o.__rest)(h,["styles","dir"])),v=n?n(a):void 0,y=_.current&&_.current.__cachedInputs__||[];if(!_.current||b!==y[1]||a.styles!==y[2]){var S=function(e){return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=[],i=0,r=t;i<r.length;i++){var o=r[i];o&&a.push("function"==typeof o?o(e):o)}return 1===a.length?a[0]:a.length?L0.apply(void 0,a):{}}(e,t,b,a.styles)};S.__cachedInputs__=[t,b,a.styles],S.__noStyleOverride__=!b&&!a.styles,_.current=S}return s.createElement(e,Object(o.__assign)({ref:i},g,v,a,{styles:_.current}))});l.displayName="Styled"+(e.displayName||e.name);var u=i?s.memo(l):l;return l.displayName&&(u.displayName=l.displayName),u}var U0,F0="undefined"!=typeof navigator&&/rv:11.0/.test(navigator.userAgent),H0={};try{H0=window}catch(z){}var R0,N0=function(){function e(e){this._rules=[],this._preservedRules=[],this._rulesToInsert=[],this._counter=0,this._keyToClassName={},this._onResetCallbacks=[],this._classNameToArgs={},this._config=Object(o.__assign)({injectionMode:1,defaultPrefix:"css",namespace:void 0,cspSettings:void 0},e),this._keyToClassName=this._config.classNameCache||{}}return e.getInstance=function(){var t;if(!(U0=H0.__stylesheet__)||U0._lastStyleElement&&U0._lastStyleElement.ownerDocument!==document){var n=(null===(t=H0)||void 0===t?void 0:t.FabricConfig)||{};U0=H0.__stylesheet__=new e(n.mergeStyles)}return U0},e.prototype.setConfig=function(e){this._config=Object(o.__assign)(Object(o.__assign)({},this._config),e)},e.prototype.onReset=function(e){this._onResetCallbacks.push(e)},e.prototype.getClassName=function(e){var t=this._config.namespace;return(t?t+"-":"")+(e||this._config.defaultPrefix)+"-"+this._counter++},e.prototype.cacheClassName=function(e,t,n,a){this._keyToClassName[t]=e,this._classNameToArgs[e]={args:n,rules:a}},e.prototype.classNameFromKey=function(e){return this._keyToClassName[e]},e.prototype.getClassNameCache=function(){return this._keyToClassName},e.prototype.argsFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.args},e.prototype.insertedRulesFromClassName=function(e){var t=this._classNameToArgs[e];return t&&t.rules},e.prototype.insertRule=function(e,t){var n=0!==this._config.injectionMode?this._getStyleElement():void 0;if(t&&this._preservedRules.push(e),n)switch(this._config.injectionMode){case 1:var a=n.sheet;try{a.insertRule(e,a.cssRules.length)}catch(e){}break;case 2:n.appendChild(document.createTextNode(e))}else this._rules.push(e);this._config.onInsertRule&&this._config.onInsertRule(e)},e.prototype.getRules=function(e){return(e?this._preservedRules.join(""):"")+this._rules.join("")+this._rulesToInsert.join("")},e.prototype.reset=function(){this._rules=[],this._rulesToInsert=[],this._counter=0,this._classNameToArgs={},this._keyToClassName={},this._onResetCallbacks.forEach(function(e){return e()})},e.prototype.resetKeys=function(){this._keyToClassName={}},e.prototype._getStyleElement=function(){var e=this;return this._styleElement||"undefined"==typeof document||(this._styleElement=this._createStyleElement(),F0||window.requestAnimationFrame(function(){e._styleElement=void 0})),this._styleElement},e.prototype._createStyleElement=function(){var e=document.head,t=document.createElement("style");t.setAttribute("data-merge-styles","true");var n=this._config.cspSettings;if(n&&n.nonce&&t.setAttribute("nonce",n.nonce),this._lastStyleElement)e.insertBefore(t,this._lastStyleElement.nextElementSibling);else{var a=this._findPlaceholderStyleTag();a?e.insertBefore(t,a.nextElementSibling):e.insertBefore(t,e.childNodes[0])}return this._lastStyleElement=t,t},e.prototype._findPlaceholderStyleTag=function(){var e=document.head;return e?e.querySelector("style[data-merge-styles]"):null},e}();function B0(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=[],a=[],i=N0.getInstance();function r(e){for(var t=0,o=e;t<o.length;t++){var s=o[t];if(s)if("string"==typeof s)if(s.indexOf(" ")>=0)r(s.split(" "));else{var c=i.argsFromClassName(s);c?r(c):-1===n.indexOf(s)&&n.push(s)}else Array.isArray(s)?r(s):"object"==typeof s&&a.push(s)}}return r(e),{classes:n,objects:a}}function j0(e){R0!==e&&(R0=e)}function V0(){return void 0===R0&&(R0="undefined"!=typeof document&&!!document.documentElement&&"rtl"===document.documentElement.getAttribute("dir")),R0}function z0(){return{rtl:V0()}}R0=V0();var G0,K0={},W0={"user-select":1};function q0(e,t){var n=function(){var e,t;if(!G0){var n="undefined"!=typeof document?document:void 0,a="undefined"!=typeof navigator?navigator:void 0,i=null===(t=null===(e=a)||void 0===e?void 0:e.userAgent)||void 0===t?void 0:t.toLowerCase();G0=n?{isWebkit:!(!n||!("WebkitAppearance"in n.documentElement.style)),isMoz:!!(i&&i.indexOf("firefox")>-1),isOpera:!!(i&&i.indexOf("opera")>-1),isMs:!(!a||!/rv:11.0/i.test(a.userAgent)&&!/Edge\/\d./i.test(navigator.userAgent))}:{isWebkit:!0,isMoz:!0,isOpera:!0,isMs:!0}}return G0}(),a=e[t];if(W0[a]){var i=e[t+1];W0[a]&&(n.isWebkit&&e.push("-webkit-"+a,i),n.isMoz&&e.push("-moz-"+a,i),n.isMs&&e.push("-ms-"+a,i),n.isOpera&&e.push("-o-"+a,i))}}var Q0,Y0=["column-count","font-weight","flex","flex-grow","flex-shrink","fill-opacity","opacity","order","z-index","zoom"];function J0(e,t){var n=e[t],a=e[t+1];if("number"==typeof a){var i=Y0.indexOf(n)>-1,r=n.indexOf("--")>-1,o=i||r?"":"px";e[t+1]=""+a+o}}var X0="left",Z0="right",$0=((Q0={}).left=Z0,Q0.right=X0,Q0),e1={"w-resize":"e-resize","sw-resize":"se-resize","nw-resize":"ne-resize"};function t1(e,t,n){if(e.rtl){var a=t[n];if(!a)return;var i=t[n+1];if("string"==typeof i&&i.indexOf("@noflip")>=0)t[n+1]=i.replace(/\s*(?:\/\*\s*)?\@noflip\b(?:\s*\*\/)?\s*?/g,"");else if(a.indexOf(X0)>=0)t[n]=a.replace(X0,Z0);else if(a.indexOf(Z0)>=0)t[n]=a.replace(Z0,X0);else if(String(i).indexOf(X0)>=0)t[n+1]=i.replace(X0,Z0);else if(String(i).indexOf(Z0)>=0)t[n+1]=i.replace(Z0,X0);else if($0[a])t[n]=$0[a];else if(e1[i])t[n+1]=e1[i];else switch(a){case"margin":case"padding":t[n+1]=function(e){if("string"==typeof e){var t=e.split(" ");if(4===t.length)return t[0]+" "+t[3]+" "+t[2]+" "+t[1]}return e}(i);break;case"box-shadow":t[n+1]=function(e,t){var n=e.split(" "),a=parseInt(n[0],10);return n[0]=n[0].replace(String(a),String(-1*a)),n.join(" ")}(i)}}}function n1(e){var t=e&&e["&"];return t?t.displayName:void 0}var a1=/\:global\((.+?)\)/g;function i1(e,t){return e.indexOf(":global(")>=0?e.replace(a1,"$1"):0===e.indexOf(":")?t+e:e.indexOf("&")<0?t+" "+e:e}function r1(e,t,n,a){void 0===t&&(t={__order:[]}),0===n.indexOf("@")?o1([a],t,n=n+"{"+e):n.indexOf(",")>-1?function(e){if(!a1.test(e))return e;for(var t=[],n=/\:global\((.+?)\)/g,a=null;a=n.exec(e);)a[1].indexOf(",")>-1&&t.push([a.index,a.index+a[0].length,a[1].split(",").map(function(e){return":global("+e.trim()+")"}).join(", ")]);return t.reverse().reduce(function(e,t){var n=t[0],a=t[1],i=t[2];return e.slice(0,n)+i+e.slice(a)},e)}(n).split(",").map(function(e){return e.trim()}).forEach(function(n){return o1([a],t,i1(n,e))}):o1([a],t,i1(n,e))}function o1(e,t,n){void 0===t&&(t={__order:[]}),void 0===n&&(n="&");var a=N0.getInstance(),i=t[n];i||(i={},t[n]=i,t.__order.push(n));for(var r=0,o=e;r<o.length;r++){var s=o[r];if("string"==typeof s){var c=a.argsFromClassName(s);c&&o1(c,t,n)}else if(Array.isArray(s))o1(s,t,n);else for(var d in s)if(s.hasOwnProperty(d)){var l=s[d];if("selectors"===d){var u=s.selectors;for(var f in u)u.hasOwnProperty(f)&&r1(n,t,f,u[f])}else"object"==typeof l?null!==l&&r1(n,t,d,l):void 0!==l&&("margin"===d||"padding"===d?s1(i,d,l):i[d]=l)}}return t}function s1(e,t,n){var a="string"==typeof n?n.split(" "):[n];e[t+"Top"]=a[0],e[t+"Right"]=a[1]||a[0],e[t+"Bottom"]=a[2]||a[0],e[t+"Left"]=a[3]||a[1]||a[0]}function c1(e,t){for(var n=[e.rtl?"rtl":"ltr"],a=!1,i=0,r=t.__order;i<r.length;i++){var o=r[i];n.push(o);var s=t[o];for(var c in s)s.hasOwnProperty(c)&&void 0!==s[c]&&(a=!0,n.push(c,s[c]))}return a?n.join(""):void 0}function d1(e,t){return t<=0?"":1===t?e:e+d1(e,t-1)}function l1(e,t){if(!t)return"";var n,a,i,r=[];for(var o in t)t.hasOwnProperty(o)&&"displayName"!==o&&void 0!==t[o]&&r.push(o,t[o]);for(var s=0;s<r.length;s+=2)i=void 0,"-"!==(i=(n=r)[a=s]).charAt(0)&&(n[a]=K0[i]=K0[i]||i.replace(/([A-Z])/g,"-$1").toLowerCase()),J0(r,s),t1(e,r,s),q0(r,s);for(s=1;s<r.length;s+=4)r.splice(s,1,":",r[s],";");return r.join("")}function u1(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=o1(t),i=c1(e,a);if(i){var r=N0.getInstance(),o={className:r.classNameFromKey(i),key:i,args:t};if(!o.className){o.className=r.getClassName(n1(a));for(var s=[],c=0,d=a.__order;c<d.length;c++){var l=d[c];s.push(l,l1(e,a[l]))}o.rulesToInsert=s}return o}}function f1(e,t){void 0===t&&(t=1);var n=N0.getInstance(),a=e.className,i=e.key,r=e.args,o=e.rulesToInsert;if(o){for(var s=0;s<o.length;s+=2){var c=o[s+1];if(c){var d=o[s],l=(d=d.replace(/&/g,d1("."+e.className,t)))+"{"+c+"}"+(0===d.indexOf("@")?"}":"");n.insertRule(l)}}n.cacheClassName(a,i,r,o)}}function p1(e,t){var n,a,i={subComponentStyles:{}};if(!e[0]&&e.length<=1)return{subComponentStyles:{}};var r=L0.apply(void 0,e),o=[];for(var s in r)if(r.hasOwnProperty(s)){if("subComponentStyles"===s){i.subComponentStyles=r.subComponentStyles||{};continue}var c=B0(r[s]),d=c.classes,l=c.objects;(null===(n=l)||void 0===n?void 0:n.length)?(p=u1(t||{},{displayName:s},l))&&(o.push(p),i[s]=d.concat([p.className]).join(" ")):i[s]=d.join(" ")}for(var u=0,f=o;u<f.length;u++){var p;(p=f[u])&&f1(p,null===(a=t)||void 0===a?void 0:a.specificityMultiplier)}return i}var m1=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return p1(e,z0())}({root:{display:"inline-block"},placeholder:["ms-Icon-placeHolder",{width:"1em"}],image:["ms-Icon-imageContainer",{overflow:"hidden"}]}),_1=!1,h1=0,b1={empty:!0},g1={},v1="undefined"==typeof WeakMap?null:WeakMap;function y1(){h1++}function S1(e,t,n){if(void 0===t&&(t=100),void 0===n&&(n=!1),!v1)return e;if(!_1){var a=N0.getInstance();a&&a.onReset&&N0.getInstance().onReset(y1),_1=!0}var i,r=0,o=h1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];var c=i;(void 0===i||o!==h1||t>0&&r>t)&&(i=I1(),r=0,o=h1),c=i;for(var d=0;d<a.length;d++){var l=D1(a[d]);c.map.has(l)||c.map.set(l,I1()),c=c.map.get(l)}return c.hasOwnProperty("value")||(c.value=e.apply(void 0,a),r++),!n||null!==c.value&&void 0!==c.value||(c.value=e.apply(void 0,a)),c.value}}function D1(e){return e?"object"==typeof e||"function"==typeof e?e:(g1[e]||(g1[e]={val:e}),g1[e]):b1}function I1(){return{map:v1?new v1:null}}var x1=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},a=0,i=e;a<i.length;a++)for(var r=i[a],o=Array.isArray(r)?r:Object.keys(r),s=0,c=o;s<c.length;s++){var d=c[s];n[d]=1}return n},C1=x1(["onCopy","onCut","onPaste","onCompositionEnd","onCompositionStart","onCompositionUpdate","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onInput","onSubmit","onLoad","onError","onKeyDown","onKeyDownCapture","onKeyPress","onKeyUp","onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting","onClick","onClickCapture","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onMouseUpCapture","onSelect","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onScroll","onWheel","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onGotPointerCapture","onLostPointerCapture"]),O1=x1(["accessKey","children","className","contentEditable","dir","draggable","hidden","htmlFor","id","lang","ref","role","style","tabIndex","title","translate","spellCheck","name"]),w1=x1(O1,C1),E1=(x1(w1,["form"]),x1(w1,["height","loop","muted","preload","src","width"])),A1=(x1(E1,["poster"]),x1(w1,["start"]),x1(w1,["value"]),x1(w1,["download","href","hrefLang","media","rel","target","type"]),x1(w1,["autoFocus","disabled","form","formAction","formEncType","formMethod","formNoValidate","formTarget","type","value"])),L1=(x1(A1,["accept","alt","autoCapitalize","autoComplete","checked","dirname","form","height","inputMode","list","max","maxLength","min","multiple","pattern","placeholder","readOnly","required","src","step","size","type","value","width"]),x1(A1,["autoCapitalize","cols","dirname","form","maxLength","placeholder","readOnly","required","rows","wrap"]),x1(A1,["form","multiple","required"]),x1(w1,["selected","value"]),x1(w1,["cellPadding","cellSpacing"]),x1(w1,["rowSpan","scope"]),x1(w1,["colSpan","headers","rowSpan","scope"]),x1(w1,["span"]),x1(w1,["span"]),x1(w1,["acceptCharset","action","encType","encType","method","noValidate","target"]),x1(w1,["allow","allowFullScreen","allowPaymentRequest","allowTransparency","csp","height","importance","referrerPolicy","sandbox","src","srcDoc","width"]),x1(w1,["alt","crossOrigin","height","src","srcSet","useMap","width"])),k1=w1;function M1(e,t,n){for(var a,i=Array.isArray(t),r={},o=0,s=Object.keys(e);o<s.length;o++){var c=s[o];!(!i&&t[c]||i&&t.indexOf(c)>=0||0===c.indexOf("data-")||0===c.indexOf("aria-"))||n&&-1!==(null===(a=n)||void 0===a?void 0:a.indexOf(c))||(r[c]=e[c])}return r}function P1(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a];if(r)if("string"==typeof r)n.push(r);else if(r.hasOwnProperty("toString")&&"function"==typeof r.toString)n.push(r.toString());else for(var o in r)r[o]&&n.push(o)}return n.join(" ")}function T1(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return U1(e,z0())}function U1(e,t){var n=B0(e instanceof Array?e:[e]),a=n.classes,i=n.objects;return i.length&&a.push(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=u1.apply(void 0,Object(o.__spreadArrays)([e],t));return a?(f1(a,e.specificityMultiplier),a.className):""}(t||{},i)),a.join(" ")}var F1=n("Oukv").e.getValue("icons",{__options:{disableWarnings:!1,warnOnMissingIcons:!0},__remapped:{}}),H1=N0.getInstance();H1&&H1.onReset&&H1.onReset(function(){for(var e in F1)F1.hasOwnProperty(e)&&F1[e].subset&&(F1[e].subset.className=void 0)});var R1,N1=S1(function(e){var t=function(e){var t,n,a=void 0,i=F1.__options;if(e=e?function(e){return e.toLowerCase()}(e):"",e=F1.__remapped[e]||e)if(a=F1[e]){var r=a.subset;r&&r.fontFace&&(r.isRegistered||(t=r.fontFace,N0.getInstance().insertRule("@font-face{"+l1(z0(),t)+"}",!0),r.isRegistered=!0),r.className||(r.className=T1(r.style,{fontFamily:r.fontFace.fontFamily,fontWeight:r.fontFace.fontWeight||"normal",fontStyle:r.fontFace.fontStyle||"normal"})))}else!i.disableWarnings&&i.warnOnMissingIcons&&(n='The icon "'+e+'" was used but not registered. See https://github.com/microsoft/fluentui/wiki/Using-icons for more information.',console&&console.warn&&console.warn(n));return a}(e)||{subset:{},code:void 0},n=t.code,a=t.subset;return n?{children:n,iconClassName:a.className,fontFamily:a.fontFace&&a.fontFace.fontFamily,mergeImageProps:a.mergeImageProps}:null},void 0,!0),B1=function(e){var t=e.iconName,n=e.className,a=e.style,i=void 0===a?{}:a,r=N1(t)||{},c=r.iconClassName,d=r.children,l=r.fontFamily,u=r.mergeImageProps,f=M1(e,w1),p=e["aria-label"]||e.title,m=e["aria-label"]||e["aria-labelledby"]||e.title?{role:u?void 0:"img"}:{"aria-hidden":!0},_=d;return u&&"object"==typeof d&&"object"==typeof d.props&&p&&(_=s.cloneElement(d,{alt:p})),s.createElement("i",Object(o.__assign)({"data-icon-name":t},m,f,u?{title:void 0,"aria-label":void 0}:{},{className:P1("ms-Icon",m1.root,c,!t&&m1.placeholder,n),style:Object(o.__assign)({fontFamily:l},i)}),_)};S1(function(e,t,n){return B1({iconName:e,className:t,"aria-label":n})}),function(e){e[e.default=0]="default",e[e.image=1]="image",e[e.Default=1e5]="Default",e[e.Image=100001]="Image"}(R1||(R1={}));var j1=n("25SK");function V1(e){if(!j1.e&&"undefined"!=typeof document){var t=e;return t&&t.ownerDocument?t.ownerDocument:document}}var z1,G1=n("a1Kd");function K1(e){if(void 0===e&&(e={}),void 0!==e.rtl)return e.rtl;if(void 0===z1){var t=function(e){var t=null;try{var n=Object(G1.e)();t=n?n.sessionStorage.getItem("isRTL"):null}catch(e){}return t}();null!==t&&function(e,t){void 0===t&&(t=!1);var n=V1();n&&n.documentElement.setAttribute("dir",e?"rtl":"ltr"),t&&function(e,t){var n;try{null===(n=Object(G1.e)())||void 0===n||n.sessionStorage.setItem("isRTL",t)}catch(e){}}(0,e?"1":"0"),j0(z1=e)}(z1="1"===t);var n=V1();void 0===z1&&n&&j0(z1="rtl"===(n.body&&n.body.getAttribute("dir")||n.documentElement.getAttribute("dir")))}return!!z1}var W1,q1,Q1,Y1=0,J1=N0.getInstance();function X1(e){void 0===e&&(e={});var t=new Map,n=0,a=0,i=Y1;return function(r,o){var s,c;if(void 0===o&&(o={}),e.useStaticStyles&&"function"==typeof r&&r.__noStyleOverride__)return r(o);a++;var d=t,l=o.theme,u=l&&void 0!==l.rtl?l.rtl:K1(),f=e.disableCaching;return i!==Y1&&(i=Y1,t=new Map,n=0),e.disableCaching||(d=$1(t,r),d=$1(d,o)),!f&&d.__retval__||(d.__retval__=void 0===r?{}:p1(["function"==typeof r?r(o):r],{rtl:!!u,specificityMultiplier:e.useStaticStyles?5:void 0}),f||n++),n>(e.cacheSize||50)&&((null===(c=null===(s=Object(G1.e)())||void 0===s?void 0:s.FabricConfig)||void 0===c?void 0:c.enableClassNameCacheFullWarning)&&(console.warn("Styles are being recalculated too frequently. Cache miss rate is "+n+"/"+a+"."),console.trace()),t.clear(),n=0,e.disableCaching=!0),d.__retval__}}function Z1(e,t){return t=function(e){switch(e){case void 0:return"__undefined__";case null:return"__null__";default:return e}}(t),e.has(t)||e.set(t,new Map),e.get(t)}function $1(e,t){if("function"==typeof t)if(t.__cachedInputs__)for(var n=0,a=t.__cachedInputs__;n<a.length;n++)e=Z1(e,a[n]);else e=Z1(e,t);else if("object"==typeof t)for(var i in t)t.hasOwnProperty(i)&&(e=Z1(e,t[i]));return e}J1&&J1.onReset&&J1.onReset(function(){return Y1++}),function(e){e[e.center=0]="center",e[e.contain=1]="contain",e[e.cover=2]="cover",e[e.none=3]="none",e[e.centerCover=4]="centerCover",e[e.centerContain=5]="centerContain"}(W1||(W1={})),function(e){e[e.landscape=0]="landscape",e[e.portrait=1]="portrait"}(q1||(q1={})),function(e){e[e.notLoaded=0]="notLoaded",e[e.loaded=1]="loaded",e[e.error=2]="error",e[e.errorLoaded=3]="errorLoaded"}(Q1||(Q1={}));var ev=X1(),tv=function(e){function t(t){var n=e.call(this,t)||this;return n._coverStyle=q1.portrait,n._imageElement=s.createRef(),n._frameElement=s.createRef(),n._onImageLoaded=function(e){var t=n.props,a=t.src,i=t.onLoad;i&&i(e),n._computeCoverStyle(n.props),a&&n.setState({loadState:Q1.loaded})},n._onImageError=function(e){n.props.onError&&n.props.onError(e),n.setState({loadState:Q1.error})},n.state={loadState:Q1.notLoaded},n}return Object(o.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.src!==this.props.src?this.setState({loadState:Q1.notLoaded}):this.state.loadState===Q1.loaded&&this._computeCoverStyle(e)},t.prototype.componentDidUpdate=function(e,t){this._checkImageLoaded(),this.props.onLoadingStateChange&&t.loadState!==this.state.loadState&&this.props.onLoadingStateChange(this.state.loadState)},t.prototype.render=function(){var e=M1(this.props,L1,["width","height"]),t=this.props,n=t.src,a=t.alt,i=t.width,r=t.height,c=t.shouldFadeIn,d=t.shouldStartVisible,l=t.className,u=t.imageFit,f=t.role,p=t.maximizeFrame,m=t.styles,_=t.theme,h=this.state.loadState,b=void 0!==this.props.coverStyle?this.props.coverStyle:this._coverStyle,g=ev(m,{theme:_,className:l,width:i,height:r,maximizeFrame:p,shouldFadeIn:c,shouldStartVisible:d,isLoaded:h===Q1.loaded||h===Q1.notLoaded&&this.props.shouldStartVisible,isLandscape:b===q1.landscape,isCenter:u===W1.center,isCenterContain:u===W1.centerContain,isCenterCover:u===W1.centerCover,isContain:u===W1.contain,isCover:u===W1.cover,isNone:u===W1.none,isError:h===Q1.error,isNotImageFit:void 0===u});return s.createElement("div",{className:g.root,style:{width:i,height:r},ref:this._frameElement},s.createElement("img",Object(o.__assign)({},e,{onLoad:this._onImageLoaded,onError:this._onImageError,key:"fabricImage"+this.props.src||"",className:g.image,ref:this._imageElement,src:n,alt:a,role:f})))},t.prototype._checkImageLoaded=function(){var e=this.props.src;this.state.loadState===Q1.notLoaded&&this._imageElement.current&&(e&&this._imageElement.current.naturalWidth>0&&this._imageElement.current.naturalHeight>0||this._imageElement.current.complete&&t._svgRegex.test(e))&&(this._computeCoverStyle(this.props),this.setState({loadState:Q1.loaded}))},t.prototype._computeCoverStyle=function(e){var t=e.imageFit,n=e.width,a=e.height;if((t===W1.cover||t===W1.contain||t===W1.centerContain||t===W1.centerCover)&&void 0===this.props.coverStyle&&this._imageElement.current&&this._frameElement.current){var i;i="number"==typeof n&&"number"==typeof a&&t!==W1.centerContain&&t!==W1.centerCover?n/a:this._frameElement.current.clientWidth/this._frameElement.current.clientHeight;var r=this._imageElement.current.naturalWidth/this._imageElement.current.naturalHeight;this._coverStyle=r>i?q1.landscape:q1.portrait}},t.defaultProps={shouldFadeIn:!0},t._svgRegex=/\.svg$/i,t}(s.Component),nv=S1(function(e,t){var n=N0.getInstance();return t?Object.keys(e).reduce(function(t,a){return t[a]=n.getClassName(e[a]),t},{}):e});function av(e,t,n){return nv(e,void 0!==n?n:t.disableGlobalClassNames)}function iv(e){var t=N0.getInstance(),n=t.getClassName(),a=[];for(var i in e)e.hasOwnProperty(i)&&a.push(i,"{",l1(z0(),e[i]),"}");var r=a.join("");return t.insertRule("@keyframes "+n+"{"+r+"}",!0),t.cacheClassName(n,r,[],["keyframes",r]),n}var rv="cubic-bezier(.1,.9,.2,1)",ov="cubic-bezier(.1,.25,.75,.9)",sv="0.167s",cv="0.267s",dv="0.367s",lv="0.467s",uv=iv({from:{opacity:0},to:{opacity:1}}),fv=iv({from:{opacity:1},to:{opacity:0,visibility:"hidden"}}),pv=Gv(-10),mv=Gv(-20),_v=Gv(-40),hv=Gv(-400),bv=Gv(10),gv=Gv(20),vv=Gv(40),yv=Gv(400),Sv=Kv(10),Dv=Kv(20),Iv=Kv(-10),xv=Kv(-20),Cv=Wv(10),Ov=Wv(20),wv=Wv(40),Ev=Wv(400),Av=Wv(-10),Lv=Wv(-20),kv=Wv(-40),Mv=Wv(-400),Pv=qv(-10),Tv=qv(-20),Uv=qv(10),Fv=qv(20),Hv=iv({from:{transform:"scale3d(.98,.98,1)"},to:{transform:"scale3d(1,1,1)"}}),Rv=iv({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(.98,.98,1)"}}),Nv=iv({from:{transform:"scale3d(1.03,1.03,1)"},to:{transform:"scale3d(1,1,1)"}}),Bv=iv({from:{transform:"scale3d(1,1,1)"},to:{transform:"scale3d(1.03,1.03,1)"}}),jv=iv({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(90deg)"}}),Vv=iv({from:{transform:"rotateZ(0deg)"},to:{transform:"rotateZ(-90deg)"}});function zv(e,t,n){return{animationName:e,animationDuration:t,animationTimingFunction:n,animationFillMode:"both"}}function Gv(e){return iv({from:{transform:"translate3d("+e+"px,0,0)",pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function Kv(e){return iv({from:{transform:"translate3d(0,"+e+"px,0)",pointerEvents:"none"},to:{transform:"translate3d(0,0,0)",pointerEvents:"auto"}})}function Wv(e){return iv({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d("+e+"px,0,0)"}})}function qv(e){return iv({from:{transform:"translate3d(0,0,0)"},to:{transform:"translate3d(0,"+e+"px,0)"}})}var Qv=function(e){var t={},n=function(n){var a;e.hasOwnProperty(n)&&Object.defineProperty(t,n,{get:function(){return void 0===a&&(a=T1(e[n]).toString()),a},enumerable:!0,configurable:!0})};for(var a in e)n(a);return t}({slideRightIn10:zv(uv+","+pv,dv,rv),slideRightIn20:zv(uv+","+mv,dv,rv),slideRightIn40:zv(uv+","+_v,dv,rv),slideRightIn400:zv(uv+","+hv,dv,rv),slideLeftIn10:zv(uv+","+bv,dv,rv),slideLeftIn20:zv(uv+","+gv,dv,rv),slideLeftIn40:zv(uv+","+vv,dv,rv),slideLeftIn400:zv(uv+","+yv,dv,rv),slideUpIn10:zv(uv+","+Sv,dv,rv),slideUpIn20:zv(uv+","+Dv,dv,rv),slideDownIn10:zv(uv+","+Iv,dv,rv),slideDownIn20:zv(uv+","+xv,dv,rv),slideRightOut10:zv(fv+","+Cv,dv,rv),slideRightOut20:zv(fv+","+Ov,dv,rv),slideRightOut40:zv(fv+","+wv,dv,rv),slideRightOut400:zv(fv+","+Ev,dv,rv),slideLeftOut10:zv(fv+","+Av,dv,rv),slideLeftOut20:zv(fv+","+Lv,dv,rv),slideLeftOut40:zv(fv+","+kv,dv,rv),slideLeftOut400:zv(fv+","+Mv,dv,rv),slideUpOut10:zv(fv+","+Pv,dv,rv),slideUpOut20:zv(fv+","+Tv,dv,rv),slideDownOut10:zv(fv+","+Uv,dv,rv),slideDownOut20:zv(fv+","+Fv,dv,rv),scaleUpIn100:zv(uv+","+Hv,dv,rv),scaleDownIn100:zv(uv+","+Nv,dv,rv),scaleUpOut103:zv(fv+","+Bv,sv,ov),scaleDownOut98:zv(fv+","+Rv,sv,ov),fadeIn100:zv(uv,sv,ov),fadeIn200:zv(uv,cv,ov),fadeIn400:zv(uv,dv,ov),fadeIn500:zv(uv,lv,ov),fadeOut100:zv(fv,sv,ov),fadeOut200:zv(fv,cv,ov),fadeOut400:zv(fv,dv,ov),fadeOut500:zv(fv,lv,ov),rotate90deg:zv(jv,"0.1s",ov),rotateN90deg:zv(Vv,"0.1s",ov)}),Yv={root:"ms-Image",rootMaximizeFrame:"ms-Image--maximizeFrame",image:"ms-Image-image",imageCenter:"ms-Image-image--center",imageContain:"ms-Image-image--contain",imageCover:"ms-Image-image--cover",imageCenterContain:"ms-Image-image--centerContain",imageCenterCover:"ms-Image-image--centerCover",imageNone:"ms-Image-image--none",imageLandscape:"ms-Image-image--landscape",imagePortrait:"ms-Image-image--portrait"},Jv=T0(tv,function(e){var t=e.className,n=e.width,a=e.height,i=e.maximizeFrame,r=e.isLoaded,o=e.shouldFadeIn,s=e.shouldStartVisible,c=e.isLandscape,d=e.isCenter,l=e.isContain,u=e.isCover,f=e.isCenterContain,p=e.isCenterCover,m=e.isNone,_=e.isError,h=e.isNotImageFit,b=e.theme,g=av(Yv,b),v={position:"absolute",left:"50% /* @noflip */",top:"50%",transform:"translate(-50%,-50%)"},y=Object(G1.e)(),S=void 0!==y&&void 0===y.navigator.msMaxTouchPoints,D=l&&c||u&&!c?{width:"100%",height:"auto"}:{width:"auto",height:"100%"};return{root:[g.root,b.fonts.medium,{overflow:"hidden"},i&&[g.rootMaximizeFrame,{height:"100%",width:"100%"}],r&&o&&!s&&Qv.fadeIn400,(d||l||u||f||p)&&{position:"relative"},t],image:[g.image,{display:"block",opacity:0},r&&["is-loaded",{opacity:1}],d&&[g.imageCenter,v],l&&[g.imageContain,S&&{width:"100%",height:"100%",objectFit:"contain"},!S&&D,v],u&&[g.imageCover,S&&{width:"100%",height:"100%",objectFit:"cover"},!S&&D,v],f&&[g.imageCenterContain,c&&{maxWidth:"100%"},!c&&{maxHeight:"100%"},v],p&&[g.imageCenterCover,c&&{maxHeight:"100%"},!c&&{maxWidth:"100%"},v],m&&[g.imageNone,{width:"auto",height:"auto"}],h&&[!!n&&!a&&{height:"auto",width:"100%"},!n&&!!a&&{height:"100%",width:"auto"},!!n&&!!a&&{height:"100%",width:"100%"}],c&&g.imageLandscape,!c&&g.imagePortrait,!r&&"is-notLoaded",o&&"is-fadeIn",_&&"is-error"]}},void 0,{scope:"Image"},!0),Xv=X1({cacheSize:100}),Zv=function(e){function t(t){var n=e.call(this,t)||this;return n._onImageLoadingStateChange=function(e){n.props.imageProps&&n.props.imageProps.onLoadingStateChange&&n.props.imageProps.onLoadingStateChange(e),e===Q1.error&&n.setState({imageLoadError:!0})},n.state={imageLoadError:!1},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.className,a=e.styles,i=e.iconName,r=e.imageErrorAs,c=e.theme,d="string"==typeof i&&0===i.length,l=!!this.props.imageProps||this.props.iconType===R1.image||this.props.iconType===R1.Image,u=N1(i)||{},f=u.iconClassName,p=u.children,m=u.mergeImageProps,_=Xv(a,{theme:c,className:n,iconClassName:f,isImage:l,isPlaceholder:d}),h=l?"span":"i",b=M1(this.props,w1,["aria-label"]),g=this.state.imageLoadError,v=Object(o.__assign)(Object(o.__assign)({},this.props.imageProps),{onLoadingStateChange:this._onImageLoadingStateChange}),y=g&&r||Jv,S=this.props["aria-label"]||this.props.ariaLabel,D=v.alt||S||this.props.title,I=D||this.props["aria-labelledby"]||v["aria-label"]||v["aria-labelledby"]?{role:l||m?void 0:"img","aria-label":l||m?void 0:D}:{"aria-hidden":!this.props["aria-labelledby"]&&!v["aria-labelledby"]},x=p;return m&&p&&"object"==typeof p&&D&&(x=s.cloneElement(p,{alt:D})),s.createElement(h,Object(o.__assign)({"data-icon-name":i},I,b,m?{title:void 0,"aria-label":void 0}:{},{className:_.root}),l?s.createElement(y,Object(o.__assign)({},v)):t||x)},t}(s.Component),$v=T0(Zv,function(e){var t=e.className,n=e.iconClassName,a=e.isPlaceholder,i=e.isImage,r=e.styles;return{root:[a&&m1.placeholder,m1.root,i&&m1.image,n,t,r&&r.root,r&&r.imageContainer]}},void 0,{scope:"Icon"},!0);$v.displayName="Icon";var e3=X1(),t3=function(e){var t=e.checked,n=void 0!==t&&t,a=e.className,i=e.theme,r=e.styles,o=e.useFastIcons,c=void 0===o||o,d=e3(r,{theme:i,className:a,checked:n}),l=c?B1:$v;return s.createElement("div",{className:d.root},s.createElement(l,{iconName:"CircleRing",className:d.circle}),s.createElement(l,{iconName:"StatusCircleCheckmark",className:d.check}))};t3.displayName="CheckBase";var n3,a3,i3,r3,o3,s3="@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)";!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(n3||(n3={})),function(e){e.Arabic="'"+n3.Arabic+"'",e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'"+n3.Cyrillic+"'",e.EastEuropean="'"+n3.EastEuropean+"'",e.Greek="'"+n3.Greek+"'",e.Hebrew="'"+n3.Hebrew+"'",e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'"+n3.Selawik+"'",e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'"+n3.Vietnamese+"'",e.WestEuropean="'"+n3.WestEuropean+"'",e.Armenian="'"+n3.Armenian+"'",e.Georgian="'"+n3.Georgian+"'"}(a3||(a3={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(i3||(i3={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(r3||(r3={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(o3||(o3={}));var c3,d3,l3={root:"ms-Check",circle:"ms-Check-circle",check:"ms-Check-check",checkHost:"ms-Check-checkHost"},u3=T0(t3,function(e){var t,n,a,i,r,s=e.height,c=void 0===s?e.checkBoxHeight||"18px":s,d=e.checked,l=e.className,u=e.theme,f=u.palette,p=u.semanticColors,m=u.fonts,_=K1(u),h=av(l3,u),b={fontSize:c,position:"absolute",left:0,top:0,width:c,height:c,textAlign:"center",verticalAlign:"middle"};return{root:[h.root,m.medium,{lineHeight:"1",width:c,height:c,verticalAlign:"top",position:"relative",userSelect:"none",selectors:(t={":before":{content:'""',position:"absolute",top:"1px",right:"1px",bottom:"1px",left:"1px",borderRadius:"50%",opacity:1,background:p.bodyBackground}},t["."+h.checkHost+":hover &, ."+h.checkHost+":focus &, &:hover, &:focus"]={opacity:1},t)},d&&["is-checked",{selectors:{":before":{background:f.themePrimary,opacity:1,selectors:(n={},n[s3]={background:"Window"},n)}}}],l],circle:[h.circle,b,{color:f.neutralSecondary,selectors:(a={},a[s3]={color:"WindowText"},a)},d&&{color:f.white}],check:[h.check,b,{opacity:0,color:f.neutralSecondary,fontSize:o3.medium,left:_?"-0.5px":".5px",selectors:(i={":hover":{opacity:1}},i[s3]=Object(o.__assign)({},{forcedColorAdjust:"none",MsHighContrastAdjust:"none"}),i)},d&&{opacity:1,color:f.white,fontWeight:900,selectors:(r={},r[s3]={border:"none",color:"WindowText"},r)}],checkHost:h.checkHost}},void 0,{scope:"Check"},!0),f3="change";function p3(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.length<2?t[0]:function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];t.forEach(function(t){return t&&t.apply(e,n)})}}function m3(){b3(this.props.componentRef,this)}function _3(e){e.componentRef!==this.props.componentRef&&(b3(e.componentRef,null),b3(this.props.componentRef,this))}function h3(){b3(this.props.componentRef,null)}function b3(e,t){e&&("object"==typeof e?e.current=t:"function"==typeof e&&e(t))}!function(e){e[e.none=0]="none",e[e.single=1]="single",e[e.multiple=2]="multiple"}(c3||(c3={})),function(e){e[e.horizontal=0]="horizontal",e[e.vertical=1]="vertical"}(d3||(d3={}));var g3=Object(G1.e)()||{};void 0===g3.__currentId__&&(g3.__currentId__=0);var v3=!1;function y3(e){if(!v3){var t=N0.getInstance();t&&t.onReset&&t.onReset(S3),v3=!0}return(void 0===e?"id__":e)+g3.__currentId__++}function S3(e){void 0===e&&(e=0),g3.__currentId__=e}function D3(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];t=t||{};for(var i=0,r=n;i<r.length;i++){var o=r[i];if(o)for(var s in o)!o.hasOwnProperty(s)||e&&!e(s)||(t[s]=o[s])}return t}var I3=function(){function e(t){this._id=e._uniqueId++,this._parent=t,this._eventRecords=[]}return e.raise=function(t,n,a,i){var r;if(e._isElement(t)){if("undefined"!=typeof document&&document.createEvent){var o=document.createEvent("HTMLEvents");o.initEvent(n,i||!1,!0),function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];D3.apply(this,[null,e].concat(t))}(o,a),r=t.dispatchEvent(o)}else if("undefined"!=typeof document&&document.createEventObject){var s=document.createEventObject(a);t.fireEvent("on"+n,s)}}else for(;t&&!1!==r;){var c=t.__events__,d=c?c[n]:null;if(d)for(var l in d)if(d.hasOwnProperty(l))for(var u=d[l],f=0;!1!==r&&f<u.length;f++){var p=u[f];p.objectCallback&&(r=p.objectCallback.call(p.parent,a))}t=i?t.parent:null}return r},e.isObserved=function(e,t){var n=e&&e.__events__;return!!n&&!!n[t]},e.isDeclared=function(e,t){var n=e&&e.__declaredEvents;return!!n&&!!n[t]},e.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},e._isElement=function(e){return!!e&&(!!e.addEventListener||"undefined"!=typeof HTMLElement&&e instanceof HTMLElement)},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)},e.prototype.onAll=function(e,t,n){for(var a in t)t.hasOwnProperty(a)&&this.on(e,a,t[a],n)},e.prototype.on=function(t,n,a,i){var r=this;if(n.indexOf(",")>-1)for(var o=n.split(/[ ,]+/),s=0;s<o.length;s++)this.on(t,o[s],a,i);else{var c=this._parent,d={target:t,eventName:n,parent:c,callback:a,options:i};if((o=t.__events__=t.__events__||{})[n]=o[n]||{count:0},o[n][this._id]=o[n][this._id]||[],o[n][this._id].push(d),o[n].count++,e._isElement(t)){var l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed){var n;try{if(!1===(n=a.apply(c,e))&&e[0]){var i=e[0];i.preventDefault&&i.preventDefault(),i.stopPropagation&&i.stopPropagation(),i.cancelBubble=!0}}catch(i){}return n}};d.elementCallback=l,t.addEventListener?t.addEventListener(n,l,i):t.attachEvent&&t.attachEvent("on"+n,l)}else d.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!r._isDisposed)return a.apply(c,e)};this._eventRecords.push(d)}},e.prototype.off=function(e,t,n,a){for(var i=0;i<this._eventRecords.length;i++){var r=this._eventRecords[i];if(!(e&&e!==r.target||t&&t!==r.eventName||n&&n!==r.callback||"boolean"==typeof a&&a!==r.options)){var o=r.target.__events__,s=o[r.eventName],c=s?s[this._id]:null;c&&(1!==c.length&&n?(s.count--,c.splice(c.indexOf(r),1)):(s.count-=c.length,delete o[r.eventName][this._id]),s.count||delete o[r.eventName]),r.elementCallback&&(r.target.removeEventListener?r.target.removeEventListener(r.eventName,r.elementCallback,r.options):r.target.detachEvent&&r.target.detachEvent("on"+r.eventName,r.elementCallback)),this._eventRecords.splice(i--,1)}}},e.prototype.raise=function(t,n,a){return e.raise(this._parent,t,n,a)},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var n=0;n<e.length;n++)t[e[n]]=!0},e._uniqueId=0,e}();Object($e.loadStyles)([{rawString:".tile_39583318{display:block;position:absolute;top:0;bottom:0;left:0;right:0;z-index:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-transition:-webkit-transform .1s linear;transition:-webkit-transform .1s linear;transition:transform .1s linear;transition:transform .1s linear,-webkit-transform .1s linear;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.tile_39583318::-moz-focus-inner{border:0}.tile_39583318{outline:transparent}.tile_39583318.selectable_39583318:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.tile_39583318.selectable_39583318:hover.selected_39583318{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.tile_39583318.selected_39583318{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.tile_39583318.selected_39583318.isFluentStyling_39583318 .name_39583318{font-weight:600}.ms-Fabric--isFocusVisible .tile_39583318:focus{background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.ms-Fabric--isFocusVisible .tile_39583318:focus.isFluentStyling_39583318{background-color:transparent}.ms-Fabric--isFocusVisible .tile_39583318:focus.selected_39583318{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-Fabric--isFocusVisible .tile_39583318:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.ms-Fabric--isFocusVisible .tile_39583318:focus.selected_39583318{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-Fabric--isFocusVisible .tile_39583318:focus.selected_39583318.isFluentStyling_39583318{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.tile_39583318.hasBackgroundFrame_39583318{-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,.05);box-shadow:0 1px 3px 1px rgba(1,1,0,.05)}.tile_39583318.hasBackgroundFrame_39583318.selectable_39583318:hover{outline:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.ms-Fabric--isFocusVisible .tile_39583318.hasBackgroundFrame_39583318:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.ms-Fabric--isFocusVisible .tile_39583318.hasBackgroundFrame_39583318:focus.selected_39583318{outline:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.tile_39583318.hasBackgroundFrame_39583318:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.tile_39583318.invokable_39583318:active{-webkit-transform:scale(.95);transform:scale(.95)}.label_39583318{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.description_39583318{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.link_39583318{border:none;background:0 0;position:absolute;padding:0;top:0;left:0;bottom:0;right:0;width:100%;text-decoration:none;color:inherit;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-ms-flex-line-pack:stretch;align-content:stretch;pointer-events:none}.link_39583318::-moz-focus-inner{border:0}.link_39583318{outline:transparent}.foreground_39583318{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;overflow:visible;max-width:100%;max-height:100%;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.tile_39583318.invokable_39583318 .foreground_39583318{pointer-events:auto;cursor:pointer}.foreground_39583318.foregroundHide_39583318{opacity:0}.hasForegroundFrame_39583318 .foreground_39583318{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-shadow:0 1px 3px 1px rgba(1,1,0,.05);box-shadow:0 1px 3px 1px rgba(1,1,0,.05);min-width:32px;min-height:32px}.hasForegroundFrame_39583318 .foreground_39583318:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;pointer-events:none;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.check_39583318{display:none;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;top:0;border:none;background:0 0;background-color:transparent;opacity:0;-webkit-box-sizing:border-box;box-sizing:border-box;padding:6px}.check_39583318::-moz-focus-inner{border:0}.check_39583318{outline:transparent}.check_39583318{position:absolute}.ms-Fabric--isFocusVisible .check_39583318:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .check_39583318{right:0}html[dir=rtl] .check_39583318{left:0}.tile_39583318.uninvokable_39583318 .check_39583318{width:100%;height:100%}.tile_39583318.selectable_39583318 .check_39583318{display:-webkit-box;display:-ms-flexbox;display:flex}.tile_39583318.selected_39583318 .check_39583318,.tile_39583318.showCheck_39583318 .check_39583318,.tile_39583318:hover .check_39583318{opacity:1}.ms-Fabric--isFocusVisible .check_39583318:focus{opacity:1}.ms-Fabric--isFocusVisible .tile_39583318:focus .check_39583318{opacity:1}.background_39583318{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear}.tile_39583318.invokable_39583318 .background_39583318{cursor:pointer;pointer-events:auto}.background_39583318.backgroundHide_39583318{opacity:0}.aboveNameplate_39583318{-webkit-box-flex:1;-ms-flex:1;flex:1;position:relative;margin:16px 16px 0 16px}.content_39583318{position:absolute;top:0;left:0;bottom:0;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.hasForegroundFrame_39583318 .content_39583318{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.nameplate_39583318{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;position:relative;margin:auto 0 0 0;padding:12px 8px;text-align:center;z-index:0}.nameplate_39583318 .name_39583318{-webkit-transition:color .2s linear;transition:color .2s linear}.tile_39583318.invokable_39583318 .nameplate_39583318 .name_39583318{pointer-events:auto;cursor:pointer}.link_39583318:hover .nameplate_39583318 .name_39583318{text-decoration:underline}.isFluentStyling_39583318 .link_39583318:hover .nameplate_39583318 .name_39583318{text-decoration:none}.nameplate_39583318 .activity_39583318{-webkit-transition:color .2s linear;transition:color .2s linear}.tile_39583318.hasBackgroundFrame_39583318 .nameplate_39583318{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;padding:12px 10px}.signal_39583318{display:inline-block}html[dir=ltr] .signal_39583318.storageSignal_39583318{margin-left:4px}html[dir=rtl] .signal_39583318.storageSignal_39583318{margin-right:4px}html[dir=ltr] .signal_39583318.socialSignal_39583318{margin-right:4px}html[dir=rtl] .signal_39583318.socialSignal_39583318{margin-left:4px}html[dir=ltr] .signal_39583318.lifecycleSignal_39583318{margin-right:4px}html[dir=rtl] .signal_39583318.lifecycleSignal_39583318{margin-left:4px}.name_39583318{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%}html[dir=ltr] .name_39583318{margin-left:-8px}html[dir=rtl] .name_39583318{margin-right:-8px}html[dir=ltr] .name_39583318{padding-left:8px}html[dir=rtl] .name_39583318{padding-right:8px}.isLarge_39583318 .name_39583318,.name_39583318{font-size:14px;height:30px;margin-top:-7px;margin-bottom:-8px}.isSmall_39583318 .name_39583318{font-size:12px;height:24px;margin-top:-5px;margin-bottom:-7px}.activity_39583318{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:400;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:100%;height:24px;margin-bottom:-4px}html[dir=ltr] .activity_39583318{margin-left:-8px}html[dir=rtl] .activity_39583318{margin-right:-8px}html[dir=ltr] .activity_39583318{padding-left:8px}html[dir=rtl] .activity_39583318{padding-right:8px}.hasBackgroundFrame_39583318 .name_39583318{display:block}html[dir=ltr] .hasBackgroundFrame_39583318 .name_39583318{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left}html[dir=rtl] .hasBackgroundFrame_39583318 .name_39583318{-webkit-box-pack:right;-ms-flex-pack:right;justify-content:right}.hasBackgroundFrame_39583318 .name_39583318,.isLarge_39583318 .isSmall_39583318 .hasBackgroundFrame_39583318 .name_39583318{font-size:14px;height:auto;padding-top:6px;margin-top:0;margin-bottom:0;line-height:22px}.hasBackgroundFrame_39583318 .activity_39583318{font-size:12px;display:block;height:auto;margin-top:0;margin-bottom:0;line-height:20px}html[dir=ltr] .hasBackgroundFrame_39583318 .activity_39583318{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}html[dir=rtl] .hasBackgroundFrame_39583318 .activity_39583318{-webkit-box-pack:left;-ms-flex-pack:left;justify-content:left;text-align:left}.hasBackground_39583318 .nameplate_39583318:before{position:absolute;content:'';display:block;top:-4px;bottom:0;left:0;right:0;background-image:-webkit-gradient(linear,left bottom,left top,from(rgba(0,0,0,.65)),color-stop(55%,rgba(0,0,0,.5525)),color-stop(80%,rgba(0,0,0,.195)),to(rgba(0,0,0,0)));background-image:linear-gradient(to top,rgba(0,0,0,.65) 0,rgba(0,0,0,.5525) 55%,rgba(0,0,0,.195) 80%,rgba(0,0,0,0) 100%);z-index:-1;-webkit-transition:opacity .2s linear;transition:opacity .2s linear;opacity:0}.hasBackground_39583318 .onlyOnHover_39583318 .name_39583318{opacity:0;-webkit-transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:transform .25s ease-out,opacity .2s linear,color .2s linear;transition:transform .25s ease-out,opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_39583318 .onlyOnHover_39583318 .activity_39583318{opacity:0;-webkit-transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;transition:transform .25s ease-out,opacity .2s linear,color .2s linear;transition:transform .25s ease-out,opacity .2s linear,color .2s linear,-webkit-transform .25s ease-out;-webkit-transform:translateY(1rem);transform:translateY(1rem)}.hasBackground_39583318.selected_39583318 .name_39583318.onlyOnHover_39583318,.hasBackground_39583318:hover .name_39583318.onlyOnHover_39583318{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}.hasBackground_39583318.selected_39583318 .activity_39583318.onlyOnHover_39583318,.hasBackground_39583318:hover .activity_39583318.onlyOnHover_39583318{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}.hasBackground_39583318.showBackground_39583318.selected_39583318 .onlyOnHover_39583318.nameplate_39583318:before,.hasBackground_39583318.showBackground_39583318:hover .onlyOnHover_39583318.nameplate_39583318:before{opacity:1}.hasBackground_39583318.showBackground_39583318 .nameplate_39583318:not(.onlyOnHover_39583318):before{opacity:1}.hasBackground_39583318.showBackground_39583318 .name_39583318{color:#fff;text-shadow:.5px .5px 2px rgba(0,0,0,.55)}.hasBackground_39583318.showBackground_39583318 .activity_39583318{color:#fff;text-shadow:.5px .5px 2px rgba(0,0,0,.55)}.disabled_39583318{opacity:.5}"}]);var x3="tile_39583318",C3="selectable_39583318",O3="selected_39583318",w3="isFluentStyling_39583318",E3="name_39583318",A3="hasBackgroundFrame_39583318",L3="invokable_39583318",k3="label_39583318",M3="description_39583318",P3="link_39583318",T3="foreground_39583318",U3="foregroundHide_39583318",F3="hasForegroundFrame_39583318",H3="check_39583318",R3="uninvokable_39583318",N3="showCheck_39583318",B3="background_39583318",j3="backgroundHide_39583318",V3="aboveNameplate_39583318",z3="content_39583318",G3="nameplate_39583318",K3="activity_39583318",W3="signal_39583318",q3="storageSignal_39583318",Q3="socialSignal_39583318",Y3="lifecycleSignal_39583318",J3="isLarge_39583318",X3="isSmall_39583318",Z3="hasBackground_39583318",$3="onlyOnHover_39583318",e2="showBackground_39583318",t2="disabled_39583318";Object($e.loadStyles)([{rawString:".signal_fc6811ff{display:inline-block;margin:0 4px;position:relative;-webkit-transition:color .2s linear;transition:color .2s linear}.dark_fc6811ff .signal_fc6811ff,.signal_fc6811ff .dark_fc6811ff.selected_fc6811ff{color:#fff}html[dir=ltr] .signal_fc6811ff:first-child{margin-left:0}html[dir=rtl] .signal_fc6811ff:first-child{margin-right:0}html[dir=ltr] .signal_fc6811ff:last-child{margin-right:0}html[dir=rtl] .signal_fc6811ff:last-child{margin-left:0}i.signal_fc6811ff{top:.2em}"}]);var n2="signal_fc6811ff",a2="dark_fc6811ff",i2="selected_fc6811ff";Object($e.loadStyles)([{rawString:".root_851d9364{line-height:1;width:18px;height:18px;vertical-align:top;position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.root_851d9364:before{content:'';position:absolute;left:1px;right:1px;bottom:1px;top:1px;border-radius:50%;opacity:1;background:"},{theme:"bodyBackground",defaultValue:"#ffffff"},{rawString:"}.root_851d9364.rootIsChecked_851d9364:before{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";opacity:1}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.root_851d9364.rootIsChecked_851d9364:before{background:Window}}.root_851d9364 .check_851d9364{opacity:0}.checkHost_851d9364:focus .root_851d9364 .check_851d9364,.checkHost_851d9364:hover .root_851d9364 .check_851d9364,.root_851d9364.rootIsChecked_851d9364 .check_851d9364,.root_851d9364:focus .check_851d9364,.root_851d9364:hover .check_851d9364{opacity:1}.check_851d9364,.circle_851d9364{font-size:18px;position:absolute;left:0;top:0;width:18px;height:18px;text-align:center;vertical-align:middle}.circle_851d9364{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.circle_851d9364{color:WindowText}}.rootIsChecked_851d9364 .circle_851d9364{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.check_851d9364{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";font-size:16px;left:.5px}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.check_851d9364{-ms-high-contrast-adjust:none}}.rootIsChecked_851d9364 .check_851d9364{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:900}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.rootIsChecked_851d9364 .check_851d9364{border:none;color:WindowText}}"}]);var r2="root_851d9364",o2="rootIsChecked_851d9364",s2="check_851d9364",c2="checkHost_851d9364",d2="circle_851d9364",l2=a,u2=i,f2=r,p2={small:{nameplatePadding:12,nameplateNameHeight:12,nameplateMargin:0,nameplateActivityHeight:20,foregroundMargin:16},large:{nameplatePadding:12,nameplateNameHeight:15,nameplateMargin:0,nameplateActivityHeight:20,foregroundMargin:16}},m2=function(e){function t(t,n){var a=e.call(this,t,n)||this;a._onSelectionChange=function(){var e=a.props,t=e.selection,n=e.selectionIndex,i=void 0===n?-1:n,r=i>-1&&!!t&&t.isIndexSelected(i),o=!!t&&!!t.isModal&&t.isModal();a.setState({isSelected:r,isModal:o})},function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=p3(e,e[n],t[n]))}(a,{componentDidMount:m3,componentDidUpdate:_3,componentWillUnmount:h3}),a._nameId=y3("Tile-name"),a._activityId=y3("Tile-activity"),a._labelId=y3("Tile-label"),a._descriptionId=y3("Tile-description");var i=t.selectionIndex,r=void 0===i?-1:i,o=t.selection,s=!!o&&r>-1&&o.isIndexSelected(r),c=!!o&&!!o.isModal&&o.isModal();return a.state={isSelected:s,isModal:c},a._events=new I3(a),a}return Object(o.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props,n=t.selection,a=t.selectionIndex,i=e.selection,r=e.selectionIndex,o=void 0===r?-1:r;if(n!==i||a!==o){var s=!!i&&o>-1&&i.isIndexSelected(o),c=!!i&&i.isModal&&i.isModal();this.setState({isSelected:s,isModal:c})}},t.prototype.componentDidMount=function(){var e=this.props.selection;e&&this._events.on(e,f3,this._onSelectionChange)},t.prototype.componentDidUpdate=function(e){var t=this.props.selection,n=e.selection;t!==n&&(n&&this._events.off(n),t&&this._events.on(t,f3,this._onSelectionChange))},t.prototype.componentWillUnmount=function(){this._events.dispose()},t.prototype.render=function(){var e,t=this.props,n=(t.children,t.selectionIndex),a=void 0===n?-1:n,i=t.invokeSelection,r=void 0!==i&&i,c=t.selection,d=t.background,l=t.foreground,u=t.showBackgroundFrame,f=void 0!==u&&u,p=t.showForegroundFrame,m=void 0!==p&&p,_=t.hideBackground,h=void 0!==_&&_,b=t.hideForeground,g=void 0!==b&&b,v=t.itemName,y=t.itemActivity,S=(t.componentRef,t.className),D=t.tileSize,I=void 0===D?"large":D,x=(t.contentSize,t.ariaLabel),C=t.descriptionAriaLabel,O=t.href,w=t.onClick,E=t.download,A=t.hrefLang,L=t.media,k=t.rel,M=t.target,P=t.isFluentStyling,T=t.ariaLabelSelected,U=t.nameplateOnlyOnHover,F=t.disabled,H=void 0!==F&&F,R=Object(o.__rest)(t,["children","selectionIndex","invokeSelection","selection","background","foreground","showBackgroundFrame","showForegroundFrame","hideBackground","hideForeground","itemName","itemActivity","componentRef","className","tileSize","contentSize","ariaLabel","descriptionAriaLabel","href","onClick","download","hrefLang","media","rel","target","isFluentStyling","ariaLabelSelected","nameplateOnlyOnHover","disabled"]),N=this.state,B=N.isSelected,j=void 0!==B&&B,V=N.isModal,z=void 0!==V&&V,G=this.props.isSelectable,K=void 0===G?!H&&!!c&&a>-1:G,W=!(!O&&!w&&!r||z),q=j&&T?x+", "+T:x,Q=s.createElement(s.Fragment,null,x?s.createElement("span",{key:"label",id:this._labelId,className:P1("ms-Tile-label",k3)},q):null,d?this._onRenderBackground({background:d,hideBackground:h}):null,l?this._onRenderForeground({foreground:l,hideForeground:g}):null,v||y?this._onRenderNameplate({name:v,activity:y,onlyOnHover:!!U}):null),Y=O?"a":w?"button":"span",J=s.createElement(Y,{href:O,onClick:w,download:E,hrefLang:A,media:L,target:M,rel:void 0===k?O&&M?"noopener":void 0:k,ref:this.props.linkRef,"data-selection-invoke":!!(W&&a>-1)||void 0,className:P1("ms-Tile-link",l2.link)},Q);return s.createElement("div",Object(o.__assign)({"aria-selected":j},M1(R,k1),{"aria-labelledby":x?this._labelId:this._nameId,"aria-describedby":q||C?this._descriptionId:this._activityId,"aria-disabled":H||void 0,className:P1("ms-Tile",S,l2.tile,(e={},e["ms-Tile--isSmall "+l2.isSmall]="small"===I,e["ms-Tile--isLarge "+l2.isLarge]="large"===I,e["ms-Tile--hasBackgroundFrame "+l2.hasBackgroundFrame]=f,e["ms-Tile--hasForegroundFrame "+l2.hasForegroundFrame]=m,e["ms-Tile--isSelected "+l2.selected+" "+u2.selected]=j,e["ms-Tile--isSelectable "+l2.selectable]=K,e["ms-Tile--hasBackground "+l2.hasBackground]=!!d,e[u2.dark]=!!d&&!h,e["ms-Tile--showBackground "+l2.showBackground]=!h,e["ms-Tile--invokable "+l2.invokable]=W,e["ms-Tile--uninvokable "+l2.uninvokable]=!W,e["ms-Tile--isDisabled "+l2.disabled]=H,e["ms-Tile--showCheck "+l2.showCheck]=z,e["ms-Tile--isFluentStyling "+l2.isFluentStyling]=P,e)),"data-selection-disabled":H||void 0,"data-is-focusable":!0,"data-is-sub-focuszone":!0,"data-disable-click-on-enter":!0,"data-selection-index":a>-1?a:void 0,"data-selection-touch-invoke":!!(W&&a>-1)||void 0}),J,C?s.createElement("span",{key:"description",role:"presentation",hidden:!0,id:this._descriptionId},C):null,K?this._onRenderCheck({isSelected:j}):null)},t.prototype._onRenderBackground=function(e){var t,n=e.background,a=e.hideBackground,i="function"==typeof n?n(_2(this.props)):n;return i?s.createElement("span",{key:"background",className:P1("ms-Tile-background",l2.background,(t={},t["ms-Tile-background--hide "+l2.backgroundHide]=a,t))},i):null},t.prototype._onRenderForeground=function(e){var t,n=e.foreground,a=e.hideForeground,i="function"==typeof n?n(_2(this.props)):n;return i?s.createElement("span",{key:"foreground",role:"presentation",className:P1("ms-Tile-aboveNameplate",l2.aboveNameplate)},s.createElement("span",{role:"presentation",className:P1("ms-Tile-content",l2.content)},s.createElement("span",{role:"presentation",className:P1("ms-Tile-foreground",l2.foreground,(t={},t["ms-Tile-foreground--hide "+l2.foregroundHide]=a,t))},i))):null},t.prototype._onRenderNameplate=function(e){var t,n,a,i=e.name,r=e.activity,o=e.onlyOnHover;return s.createElement("span",{key:"nameplate",className:P1("ms-Tile-nameplate",l2.nameplate,(t={},t[l2.onlyOnHover]=o,t))},i?s.createElement("span",{id:this._nameId,className:P1("ms-Tile-name",l2.name,(n={},n[l2.onlyOnHover]=o,n))},i):null,r?s.createElement("span",{id:this._activityId,className:P1("ms-Tile-activity",l2.activity,(a={},a[l2.onlyOnHover]=o,a))},r):null)},t.prototype._onRenderCheck=function(e){var t,n=e.isSelected,a=this.props.toggleSelectionAriaLabel;return s.createElement("span",{key:"check",role:"checkbox","aria-label":a,className:P1("ms-Tile-check",l2.check,f2.checkHost,(t={},t[f2.hostShowCheck]=this.state.isModal,t)),"data-selection-toggle":!0,"aria-checked":n},s.createElement(u3,{checked:n}))},t}(s.Component);function _2(e){var t=e.contentSize,n=e.tileSize,a=void 0===n?"large":n;if(!t)return{};var i=t.width,r=p2[a],o=r.nameplatePadding,s=r.nameplateMargin,c=r.nameplateActivityHeight,d=r.nameplateNameHeight,l=r.foregroundMargin,u=0;return(e.itemName||e.itemActivity)&&(u+=2*o,e.itemName&&(u+=d),e.itemActivity&&(u+=c+s)),{foregroundSize:{width:i-2*l,height:t.height-l-u},backgroundSize:t}}Object($e.loadStyles)([{rawString:".tileContainer_73a5ba4a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:80px;margin-top:8px}.tileContainer_73a5ba4a .tile_73a5ba4a{position:relative;background-color:transparent;border-radius:4px;width:100%;height:100%}.tileContainer_73a5ba4a .tile_73a5ba4a :active{border-radius:4px}.tileContainer_73a5ba4a .tileName_73a5ba4a{font-size:12px;pointer-events:auto}.ms-Fabric--isFocusHidden .tileContainer_73a5ba4a .tile_73a5ba4a button{outline:0}.ms-Fabric--isFocusVisible .tileContainer_73a5ba4a .tile_73a5ba4a button:focus{outline-color:inherit;outline-width:1px;outline-style:solid}"}]);var h2,b2=function(){return b2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b2.apply(this,arguments)},g2=b2(b2({},lr(0)),{top:56,bottom:206});(h2={}).Crop={top:80,left:24,right:24,bottom:149},h2.Adjustment=g2,h2.Retouch=g2,h2.Filter=g2,h2.Markup=g2,Object(u.concatStyleSets)({container:{borderRadius:"4px",overflow:"hidden"},body:{display:"flex",flexDirection:"column"},footer:{margin:"8px 16px"}},{body:{position:"relative",justifyContent:"flex-end",alignItems:"center"}});var v2,y2,S2=function(){return S2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},S2.apply(this,arguments)},D2=S2(S2({},lr(0)),{top:56,bottom:174});(v2={}).Crop={top:80,left:24,right:24,bottom:149},v2.Adjustment=D2,v2.Filter=D2,v2.Markup=D2,v2.Retouch=D2,(y2={}).Crop=S2(S2({},lr(24)),{top:40}),y2.Adjustment=lr(0),y2.Filter=lr(0),y2.Markup=S2(S2({},lr(0)),{left:12,right:12}),y2.Retouch=lr(0);var I2=function(){return I2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},I2.apply(this,arguments)};function x2(e,t,n,a){return I2(I2(I2(I2({},a),e&&a.highlightBackgroundOverride),t&&a.activeBackgroundOverride),n&&a.disabledBackgroundOverride)}function C2(e,t,n){return I2(I2(I2({},n),e&&I2(I2({},w2),null==n?void 0:n.activeNameOverride)),t&&(null==n?void 0:n.disabledNameOverride))}function O2(e,t){return I2(I2({},t),e&&(null==t?void 0:t.activeIconOverride))}var w2={fontWeight:"bold"};function E2(e){var t=function(e){return{background:{width:"48px",height:"48px",activeBackgroundOverride:{backgroundColor:e.palette.neutralQuaternary},highlightBackgroundOverride:{backgroundColor:e.palette.themeLighter},outlineColor:e.palette.neutralDark},icon:{fontSize:"20px",width:"20px",height:"20px",color:e.palette.neutralPrimaryAlt,fill:e.palette.neutralPrimaryAlt},name:{marginTop:"6px",activeNameOverride:{color:e.palette.black},padding:"0 5px",textAlign:"center",wordBreak:"break-word",wordWrap:"break-word"}}}(e);return I2({},t)}var A2,L2=function(){return L2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},L2.apply(this,arguments)},k2=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};!function(e){e[e.BelowTile=0]="BelowTile",e[e.InsideTileBesideIcon=1]="InsideTileBesideIcon",e[e.InsideTileBelowIcon=2]="InsideTileBelowIcon"}(A2||(A2={}));var M2=Object(s.forwardRef)(function(e,t){var n=e.name,a=e.ariaLabel,i=e.ariaSelected,r=e.namePosition,o=void 0===r?A2.BelowTile:r,d=e.iconName,l=e.tileClassNames,f=e.tileStyles,p=e.isHighlighted,m=e.isActive,_=e.isDisabled,h=void 0!==_&&_,b=e.role,g=void 0===b?"option":b,v=e.tabIndex,y=void 0===v?0:v,S=e.onClick,D=e.title,I=e.id,x=Object(s.useCallback)(function(e){S(n,e)},[n,S]),C=Object(s.useState)(null),O=C[0],w=C[1];Object(s.useLayoutEffect)(function(){O&&(O.tabIndex=y,O.setAttribute("role",g),O.setAttribute("aria-selected",String(i)))},[O,y,i,g]);var E=Object(s.useMemo)(function(){return c.a.createElement("span",{className:"tileName_73a5ba4a",style:C2(m,h,f.name),"aria-hidden":"true",onClick:h?void 0:x},n)},[m,h,n,f.name,x]),A=Object(s.useMemo)(function(){var e={display:"flex",alignItems:"center",cursor:f.background.cursor,width:"100%",height:"100%",justifyContent:"center"};return o===A2.InsideTileBesideIcon?c.a.createElement("div",{style:e},c.a.createElement($t.Icon,{iconName:d,style:O2(m,f.icon)}),E):c.a.createElement("div",{style:L2(L2({},e),{flexDirection:"column"})},c.a.createElement($t.Icon,{iconName:d,style:O2(m,f.icon)}),o===A2.InsideTileBelowIcon&&E)},[d,f,E,o,m]);return Object(s.useImperativeHandle)(t,function(){return{focus:function(){return null==O?void 0:O.focus()}}},[O]),c.a.createElement("div",{className:"tileContainer_73a5ba4a",style:f.container},c.a.createElement(m2,{className:u.css.apply(void 0,k2(["tile_73a5ba4a"],l||[],!1)),style:x2(p,m,h,f.background),isFluentStyling:!0,background:A,ariaLabel:a,linkRef:w,onClick:h?void 0:x,title:D,id:I}),o===A2.BelowTile&&E)});function P2(e,t){return function(n){var a=function(e){return new Map([[uo.name,{key:"original",text:e.aspectRatio_original,ariaLabel:e.aspectRatio_originalAriaLabel}],[fo.name,{key:"square",text:e.aspectRatio_square,ariaLabel:e.aspectRatio_squareAriaLabel}],[lo.name,{key:"freeForm",text:e.aspectRatio_freeform,ariaLabel:e.aspectRatio_freeformAriaLabel}]])}(e),i=a.get(n.name);if(i)return i;if(Ia(n)&&n.localizedStrings){var r=n.localizedStrings;return{key:r.label,text:r.label,ariaLabel:r.ariaLabel}}return function(e,t,n,a){var i=yt(t,a,e.x,e.y);return{key:i,text:i,ariaLabel:yt(n,a,e.x,e.y)}}(n.ratio,e.aspectRatio_ratioLabelFormatString,e.aspectRatio_ratioAriaLabelFormatString,t)}}function T2(e){return e.iconName}function U2(e,t,n){var a=Object(s.useContext)(Zt).logFlipEvent,i=Object(s.useContext)(Ze).strings;return Object(s.useCallback)(function(r){a({axis:t,inputType:Xs(r)}),e(),n("X"===t?i.flip_horizontalFinishedAriaLive:i.flip_verticalFinishedAriaLive)},[a,e,t,n,i])}Object($e.loadStyles)([{rawString:".rotateAspectFlipBarContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;-ms-flex-item-align:center;align-self:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:12px;margin-right:12px;margin-bottom:8px;max-width:700px;width:calc(100% - 24px)}.rotateButtonsContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex}.aspectRatioButtonContainer_94111356{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.aspectRatioButton_94111356{background-color:transparent;border:none}.mirrorButtonsContainer_94111356{display:-webkit-box;display:-ms-flexbox;display:flex}"}]);var F2=c.a.memo(function(e){var t=e.styles,n=e.icons,a=e.rotationAngle,i=e.aspectRatio,r=e.shouldFocusOnAspectRatioButton,o=void 0!==r&&r,d=e.rotateCropAndImageBy90,l=e.handleMirrorXClick,f=e.handleMirrorYClick,p=e.setShowAspectRatioOptions,m=e.setAriaAnnouncement,_=Object(s.useContext)(Ze),h=_.localizeNumber,b=_.strings,g=Object(s.useRef)(null),v=Object(s.useState)(null),y=v[0],S=v[1],D=Object(s.useState)(null),I=D[0],x=D[1],C=Object(s.useState)(null),O=C[0],w=C[1],E=$(),A=E.fonts.medium.fontFamily,L=function(e,t,n,a,i){var r=function(e,t,n){var a=Object(s.useContext)(Zt).logRotateEvent,i=Object(s.useContext)(Ze).strings;return[Object(s.useCallback)(function(r){a({angle:Ar(t,90),inputType:Xs(r)}),e(Ir.Clockwise),n(i.rotate_right90FinishedAriaLive)},[a,e,t,n,i]),Object(s.useCallback)(function(r){a({angle:Ar(t,-90),inputType:Xs(r)}),e(Ir.CounterClockwise),n(i.rotate_left90FinishedAriaLive)},[a,e,t,n,i])]}(t,e,i);return{handleRotateCropRectAndImageBy90ClockwiseWithTelemetry:r[0],handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry:r[1],handleMirrorXWithTelemetry:U2(n,"X",i),handleMirrorYWithTelemetry:U2(a,"Y",i)}}(a,d,l,f,m),k=L.handleRotateCropRectAndImageBy90ClockwiseWithTelemetry,M=L.handleRotateCropRectAndImageBy90CounterClockwiseWithTelemetry,P=L.handleMirrorXWithTelemetry,T=L.handleMirrorYWithTelemetry,U=Object(s.useMemo)(function(){return P2(b,h)(i)},[i,b,h]),F=Object(s.useCallback)(function(){p(!0)},[p]);Object(s.useEffect)(function(){var e;o&&(null===(e=g.current)||void 0===e||e.focus())},[o]);var H=Object(s.useMemo)(function(){var e=14;if(O&&y&&I&&A){var t=O.clientWidth-(y.clientWidth+I.clientWidth+18+8);e=function(e,t,n,a){if(t<=0)return 0;for(var i=14,r=A0(e,i,a);r>t;)r=A0(e,i-=.5,a);return i}(U.text,t,0,A)}return e},[O,y,I,A,U.text]),R=t&&t.icon,N=t&&t.iconButton,B=t&&t.aspectRatioButton?t.aspectRatioButton(E,H):N,j=t&&t.container;return c.a.createElement("div",{style:j,ref:w},c.a.createElement("div",{className:"rotateButtonsContainer_94111356",ref:S},c.a.createElement(u.IconButton,{iconProps:{iconName:n.rotate90CounterClockwise,styles:R},title:b.rotate_left90,ariaLabel:b.rotate_left90AriaLabel,onClick:M,styles:N}),c.a.createElement(u.IconButton,{iconProps:{iconName:n.rotate90Clockwise,styles:R},title:b.rotate_right90,ariaLabel:b.rotate_right90AriaLabel,onClick:k,styles:N})),c.a.createElement("div",{className:"aspectRatioButtonContainer_94111356"},c.a.createElement(u.DefaultButton,{styles:B,className:"aspectRatioButton_94111356",text:U.text,ariaLabel:U.ariaLabel,iconProps:{iconName:T2(i),styles:R},title:b.aspectRatio_tooltip,onClick:F,"data-test-id":"aspect-ratio-button",componentRef:g})),c.a.createElement("div",{className:"mirrorButtonsContainer_94111356",ref:x},c.a.createElement(u.IconButton,{iconProps:{iconName:n.flipHorizontally,styles:R},title:b.flip_horizontal,ariaLabel:b.flip_horizontalAriaLabel,onClick:P,styles:N}),c.a.createElement(u.IconButton,{iconProps:{iconName:n.flipVertically,styles:R},title:b.flip_vertical,ariaLabel:b.flip_verticalAriaLabel,onClick:T,styles:N})))});F2.displayName="Rotate90AspectFlipBar";var H2=Object(ga.e)([Pp],function(e){return Xa(e)}),R2=Object(ga.e)([H2],function(e){return Er(e)}),N2={rotateCropAndImageBy90:pd,handleMirrorXClick:ed,handleMirrorYClick:td,setShowAspectRatioOptions:Is,setAriaAnnouncement:Jn},B2=Object(ee.connect)(function(e){return{aspectRatio:e.transformTools.cropInteraction.aspectRatio,rotationAngle:H2(e)}},N2)(F2);Object($e.loadStyles)([{rawString:".RotationBarRoot_d52148bd{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-preferred-size:100%;flex-basis:100%;-ms-touch-action:none;touch-action:none;overflow:hidden;cursor:w-resize}.ms-Fabric--isFocusHidden .RotationBarRoot_d52148bd{outline:0}.ms-Fabric--isFocusVisible .RotationBarRoot_d52148bd:focus{outline:auto}"}]),Object($e.loadStyles)([{rawString:".TicksManager_a7a3a373{position:absolute;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%}"}]);var j2=Object(s.memo)(function(e){var t=e.boundingSize,n=e.angle,a=e.styles,i=e.layout,r=e.children,o=a.root,d=a.tickRoot,l=a.zeroTick,u=i.numTicks,f=(l.width?l.width:d.width)+l.strokeWidth,p=2*u*(d.width+d.distanceBetween)+f,m=Math.min(o.maxWidth,t.width-2*o.sidePadding),_=Object(s.useMemo)(function(){var e=f/2+d.distanceBetween+d.width/2,t=d.distanceBetween+d.width;return Math.abs(n)<1?-e*n:-(e+(Math.abs(n)-1)*t)*Math.sign(n)},[n,d,f]);return c.a.createElement("div",{className:"TicksManager_a7a3a373"},c.a.createElement("svg",{width:p,height:o.height,viewBox:"0 0 ".concat(p," ").concat(o.height)},c.a.createElement("defs",null,c.a.createElement("linearGradient",{id:"fadeGradient"},c.a.createElement("stop",{offset:"0",stopColor:"black"}),c.a.createElement("stop",{offset:i.fadeDistance,stopColor:"white"}),c.a.createElement("stop",{offset:1-i.fadeDistance,stopColor:"white"}),c.a.createElement("stop",{offset:"1",stopColor:"black"})),c.a.createElement("mask",{id:"fade"},c.a.createElement("rect",{width:m,height:o.height,x:(p-m)/2,fill:"url(#fadeGradient)"})),c.a.createElement("mask",{id:"colorize"},c.a.createElement("rect",{width:m,height:o.height,x:(p-m)/2,fill:d.color}),c.a.createElement("rect",{width:Math.abs(_),height:o.height,x:p/2+f/2-(n>0?-_+f:0),fill:"white"}))),c.a.createElement("g",{mask:"url(#fade)",fill:d.activeColor,stroke:d.activeColor},c.a.createElement("g",{mask:"url(#colorize)"},c.a.createElement("g",{"data-testid":"ticksParent",transform:"translate(".concat(_,",0)")},r)))))});Object($e.loadStyles)([{rawString:".CenterAnchorContainer_22a2596f{position:absolute;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}"}]);var V2=function(){return V2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},V2.apply(this,arguments)},z2=Object(s.memo)(function(e){var t=e.styles,n=t.centerAnchor,a=n.width,i=n.height,r=n.rx,o=n.ry,s=n.color,d=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(n,["width","height","rx","ry","color"]);return c.a.createElement("div",{className:"CenterAnchorContainer_22a2596f"},c.a.createElement("svg",{width:a||t.tickRoot.width,height:t.root.height,viewBox:"0 0 ".concat(a||t.tickRoot.width," ").concat(t.root.height),fill:"none"},c.a.createElement("rect",V2({key:"centerAnchor"},d,{x:0,y:(t.root.height-i)/2,width:8,height:i,rx:r,ry:o,fill:s}))))}),G2=function(){return G2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},G2.apply(this,arguments)},K2=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n},W2=Object(s.memo)(function(e){var t=e.styles,n=e.layout,a=t.root,i=t.tickRoot,r=t.majorTick,o=t.minorTick,d=t.zeroTick,l=n.numTicks,u=n.majorTickInterval,f=(d.width?d.width:i.width)+d.strokeWidth,p=Object(s.useCallback)(function(e){var t=d.strokeWidth,n=(d.width,d.height),i=d.rx,r=d.ry,o=K2(d,["strokeWidth","width","height","rx","ry"]);return c.a.createElement("rect",G2({key:"zeroTick"},o,{x:e+t/2,y:(a.height-n)/2,width:f-t,height:n,rx:i,ry:r,fill:"transparent",strokeWidth:t}))},[a,d,f]),m=Object(s.useCallback)(function(e,t){var n=r.height,o=r.rx,s=r.ry,d=K2(r,["height","rx","ry"]),l=i.width;return c.a.createElement("rect",G2({key:t,strokeWidth:0},d,{x:e,y:(a.height-n)/2,width:l,height:n,rx:o,ry:s}))},[r,a,i]),_=Object(s.useCallback)(function(e,t){var n=K2(o,[]),r=i.width;return c.a.createElement("circle",G2({key:t,strokeWidth:0},n,{r:r/2,cx:e+2,cy:a.height/2}))},[o,a,i]);return c.a.createElement(c.a.Fragment,null,Array(2*l+1).fill(0).map(function(e,t){var n=t*(i.distanceBetween+i.width);return t>l&&(n+=f-i.width),t===l?p(n):(l-t)%u==0?m(n,t):_(n,t)}))});function q2(e){var t=Object(s.useContext)(Ze).localizeNumber;return Object(s.useMemo)(function(){return t(Ge(Er(e),1))},[e,t])}var Q2=function(){return Q2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Q2.apply(this,arguments)},Y2=function(){return Y2=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Y2.apply(this,arguments)},J2=c.a.memo(function(e){var t=e.boundingSize,n=e.angle,a=e.styles,i=e.layout,r=e.cssToPhysicalPixelRatio,o=e.shouldShowTooltip,d=e.handleRotationBarPointerDown,l=e.handleRotationBarPointerMove,u=e.handleRotationBarPointerUp,f=e.handleRotationAdjustmentOnKeyDown,p=e.handleRotationAdjustmentOnKeyUp,m=e.handleCleanupRotationBarPointer,_=e.setIsKeyboardFocused,h=Object(s.useState)(null),b=h[0],g=h[1],v=Object(s.useContext)(Ze).strings,y=a.root,S=y.sidePadding,D=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(y,["sidePadding"]),I=q2(n);function x(e){switch(e){case"Slow":return.1;case"Fast":return 1;case"SuperFast":return 5;default:return 0}}var C=Object(s.useCallback)(function(e,t){var n=xn(e.key);f({direction:n,sliderShiftingValue:x(t),inputType:"Keyboard"})},[f]),O=Object(s.useMemo)(function(){return{numRepeatsToSwitchToFast:10,keyboardEventTarget:b,handleKeyboardDown:C,isFastDirectionKeyCode:An,handleKeyboardUp:p}},[p,C,b]);!function(e,t,n){var a=Object(s.useState)("allInteractions"),i=a[0],r=a[1],o=Object(s.useCallback)(function(t){var n;r("onlyPointerInteractions"),null===(n=e.onPointerDown)||void 0===n||n.call(e,t)},[e]),c=Object(s.useCallback)(function(t){var n;r("allInteractions"),null===(n=e.onPointerUp)||void 0===n||n.call(e,t)},[e]),d=Object(s.useCallback)(function(){var t;r("allInteractions"),null===(t=e.onUnmount)||void 0===t||t.call(e)},[e]);Cp(Q2(Q2({},e),{onPointerDown:o,onPointerUp:c,onUnmount:d,isPointerInteractionEnabled:"onlyKeyboardInteractions"!==i}));var l=Object(s.useCallback)(function(e,a){e.ctrlKey||"onlyPointerInteractions"!==i&&n(e)&&(e.preventDefault(),e.stopPropagation(),r("onlyKeyboardInteractions"),t.handleKeyboardDown(e,a))},[i,n,t]),u=Object(s.useCallback)(function(e){var a;"onlyPointerInteractions"!==i&&n(e)&&(e.preventDefault(),e.stopPropagation(),r("allInteractions"),null===(a=t.handleKeyboardUp)||void 0===a||a.call(t,e))},[i,n,t]);fp(Q2(Q2({},t),{handleKeyboardDown:l,handleKeyboardUp:u}))}(Object(s.useMemo)(function(){return{htmlElement:b,cssToPhysicalPixelRatio:r,onPointerDown:d,onPointerMove:l,onPointerUp:u,onUnmount:m}},[r,m,d,l,u,b]),O,Ln);var w=Object(s.useCallback)(function(){_(On())},[_]),E=Object(s.useCallback)(function(){_(!1)},[_]);return c.a.createElement("div",{className:"RotationBarRoot_d52148bd",style:Y2(Y2({},D),{padding:"0px ".concat(S,"px")}),ref:g,"aria-label":v.rotate_sliderAriaLabel,title:o?v.rotate_sliderTooltip:void 0,tabIndex:0,role:"slider","aria-valuenow":parseInt(I),"aria-valuemin":-45,"aria-valuemax":45,"aria-valuetext":"".concat(I).concat(v.rotate_degree),onFocus:w,onBlur:E},c.a.createElement(j2,{boundingSize:t,angle:n,styles:a,layout:i},c.a.createElement(W2,{styles:a,layout:i})),c.a.createElement(z2,{styles:a}))}),X2=Object(ga.e)([Uo,Ro],function(e,t){return{width:e.x/t,height:e.y/t}}),Z2={handleRotationBarPointerUp:md,handleRotationBarPointerMove:_d,handleRotationBarPointerDown:hd,handleRotationAdjustmentOnKeyDown:Dd,handleRotationAdjustmentOnKeyUp:Id,handleCleanupRotationBarPointer:cd,setIsKeyboardFocused:bd},$2=Object(ee.connect)(function(e,t){var n=e.transformTools.device.pixelRatio;return{boundingSize:(null==t?void 0:t.boundingSize)||X2(e),angle:R2(e),cssToPhysicalPixelRatio:n,shouldShowTooltip:!e.transformTools.rotationUi.rotationBarPointer.incrementingIdOfPointerThatIsDown}},Z2)(J2),ey={numTicks:45,majorTickInterval:5,fadeDistance:.1};function ty(e){return{tickRoot:{width:4,distanceBetween:8,color:e.palette.neutralSecondary,activeColor:e.palette.black},minorTick:{},majorTick:{height:12,rx:2,ry:2},zeroTick:{width:6,height:10,rx:4,ry:4,strokeWidth:2},centerAnchor:{width:8,height:24,rx:4,ry:4,color:e.palette.black},root:{maxWidth:700,sidePadding:10,height:32}}}Object($e.loadStyles)([{rawString:".RotationAngleDisplayContainer_8a0e54d3{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:100%;pointer-events:none}.RotationAngleDisplay_8a0e54d3{padding:0 5px;text-align:center;font-size:16px}.RotationAngleDegree_8a0e54d3{width:0}"}]);var ny=c.a.memo(function(e){var t=e.rotationAngle,n=e.styles,a=void 0===n?{}:n,i=Object(s.useContext)(Ze).strings,r=q2(t);return c.a.createElement("div",{className:"RotationAngleDisplayContainer_8a0e54d3",style:a.container,"aria-label":"".concat(r).concat(i.rotate_degree)},c.a.createElement("span",{className:"RotationAngleDisplay_8a0e54d3",style:a.angleDisplay},r),c.a.createElement("span",{className:"RotationAngleDegree_8a0e54d3",style:a.angleDegree},i.rotate_degree))});ny.displayName="RotationAngleDisplay";var ay=Object(ee.connect)(function(e){return{rotationAngle:H2(e)}})(ny),iy=Object(s.memo)(function(e){var t=e.styles,n=e.componentStyles,a=e.rotate90AspectFlipBarIcons,i=e.shouldFocusOnAspectRatioButton,r=$();return c.a.createElement(w0,{styles:{container:null==t?void 0:t.transformToolsContainer}},c.a.createElement(ay,{styles:n&&n.rotationAngleDisplay}),c.a.createElement("div",{style:n&&n.rotationBarRoot},c.a.createElement($2,{styles:ty(r),layout:ey})),c.a.createElement(B2,{styles:n&&n.rotate90AspectFlipBar,icons:a,shouldFocusOnAspectRatioButton:i}))});iy.displayName="TransformToolsActionStack",Object($e.loadStyles)([{rawString:".scrollBoxWrapper_dce3aece{overflow:scroll;-ms-overflow-style:none;overflow:-moz-scrollbars-none;scrollbar-width:none}.scrollBoxWrapper_dce3aece::-webkit-scrollbar{display:none}.scrollBox_dce3aece{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap}"}]);var ry=function(){return ry=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ry.apply(this,arguments)},oy=Object(s.forwardRef)(function(e,t){var n=e.direction,a=e.initialScrollLeft,i=void 0===a?0:a,r=e.initialScrollTop,o=void 0===r?0:r,d=e.children,l=e.scrollBoxRef,u=e.scrollBoxStyles,f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["direction","initialScrollLeft","initialScrollTop","children","scrollBoxRef","scrollBoxStyles"]),p=Object(s.useState)(null),m=p[0],_=p[1],h=Object(s.useState)(!1),b=h[0],g=h[1],v=Object(s.useRef)(),y=Object(s.useRef)(),S=Object(s.useRef)(),D=Object(s.useRef)(),I=Object(s.useMemo)(function(){return ry(ry({},"vertical"===n?{overflowX:"hidden"}:void 0),"horizontal"===n?{overflowY:"hidden"}:void 0)},[n]),x=Object(s.useMemo)(function(){return function(e){var t=e.direction;return"vertical"===t?{flexDirection:"column"}:"horizontal"===t?{flexDirection:"row"}:{flexWrap:"wrap"}}({direction:n})},[n]);Object(s.useEffect)(function(){cp(t,m)},[t,m]),Object(s.useLayoutEffect)(function(){m&&(m.scrollTop=null!=o?o:0,m.scrollLeft=null!=i?i:0)},[i,o,m]),Object(s.useEffect)(function(){if(m){var e=function(e){g(!0),v.current=e.screenX,y.current=m.scrollLeft,S.current=e.screenY,D.current=m.scrollTop},t=function(e){if(e.preventDefault(),e.stopPropagation(),void 0!==v.current&&void 0!==y.current){var t=v.current-e.screenX;m.scrollLeft=y.current+t}if(void 0!==S.current&&void 0!==D.current){var n=S.current-e.screenY;m.scrollTop=D.current+n}},n=function(){b&&void 0!==v.current&&(v.current=void 0,y.current=void 0),b&&void 0!==S&&(S.current=void 0,D.current=void 0),g(!1)};if(!m.ontouchstart)return m.addEventListener("mousedown",e),m.addEventListener("mousemove",t),m.addEventListener("mouseup",n),m.addEventListener("mouseleave",n),function(){m.removeEventListener("mousedown",e),m.removeEventListener("mousemove",t),m.removeEventListener("mouseup",n),m.removeEventListener("mouseleave",n)}}},[v,b,y,S,D,m]);var C=Array.isArray(d)?d:[null!=d?d:null];return c.a.createElement("div",ry({className:"scrollBoxWrapper_dce3aece",style:I,ref:_},f),c.a.createElement("div",{className:"scrollBox_dce3aece",style:ry(ry({pointerEvents:b?"none":void 0},x),u),ref:l},C.map(function(e,t){return c.a.createElement("div",{key:"scroll-box-item-".concat(t)},e)})))});oy.displayName="ScrollContainer";var sy=function(){return sy=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},sy.apply(this,arguments)},cy=function(e){var t=e.children,n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["children"]),a=Object(s.useState)(null),i=a[0],r=a[1],o=Object(s.useState)(),d=o[0],l=o[1],u=Object(s.useRef)(!0),f=Object(s.useMemo)(function(){return c.a.Children.toArray(t).map(function(){return Object(s.createRef)()})},[t]);return Object(s.useLayoutEffect)(function(){if(0!==f.length){var e=f[0].current,t=f.slice(-1)[0].current,n=function(e){if(e&&i){var t=e.getBoundingClientRect().width;return(i.clientWidth-t)/2}};l({left:n(e),right:n(t)})}},[f,i]),Object(s.useLayoutEffect)(function(){var e,n;if(0!==f.length&&d&&void 0!==d.left&&void 0!==d.right){var a=c.a.Children.toArray(t).findIndex(function(e){return c.a.isValidElement(e)&&e.props.isActive});null===(n=null===(e=f[a])||void 0===e?void 0:e.current)||void 0===n||n.scrollIntoView({inline:"center",behavior:u.current?"auto":"smooth"}),u.current=!1}},[t,f,d]),c.a.createElement("div",{ref:r,style:{overflow:"hidden"}},c.a.createElement(oy,sy({},n,{scrollBoxStyles:{paddingLeft:null==d?void 0:d.left,paddingRight:null==d?void 0:d.right}}),c.a.Children.toArray(t).map(function(e,t){return c.a.createElement("div",{ref:f[t],key:t},e)})))};Object($e.loadStyles)([{rawString:".scrollBoxContainer_28f2b9ed{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}"}]);var dy=function(){return dy=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},dy.apply(this,arguments)},ly={margin:"0px ".concat(32,"px")};function uy(e,t){return{root:dy({position:"absolute",zIndex:3,height:"100%",width:32,i:{color:e.palette.neutralPrimary}},"start"===t?{left:"-".concat(32,"px")}:{right:"-".concat(32,"px")}),rootHovered:{backgroundColor:"transparent",i:{color:e.palette.neutralPrimaryAlt}},rootPressed:{backgroundColor:"transparent",i:{color:e.palette.neutralSecondary}}}}function fy(e,t,n){Object(s.useEffect)(function(){var a=n||window.ResizeObserver;if(a&&e){var i=new a(t);return i.observe(e),function(){i.disconnect()}}},[n,e,t])}var py=function(){return py=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},py.apply(this,arguments)},my=function(e){var t=$(),n=Object(s.useRef)(null),a=Object(s.useState)(null),i=a[0],r=a[1],o=Object(s.useState)(null),d=o[0],l=o[1],f=function(e,t,n){var a=Object(s.useState)(!1),i=a[0],r=a[1],o=Object(s.useState)(!1),c=o[0],d=o[1],l=Object(s.useCallback)(function(){if(e&&t){var n=e.getBoundingClientRect(),a=t.getBoundingClientRect();return{x:n.left-a.left,y:n.top-a.top,width:n.width,height:n.height}}},[e,t]),u=Object(s.useCallback)(function(){var e=l();e&&t&&r(e.x<0&&e.width!==t.clientWidth)},[t,l]),f=Object(s.useCallback)(function(){var e=l();e&&t&&d(e.x+e.width>t.clientWidth&&e.width!==t.clientWidth)},[t,l]),p=Object(s.useCallback)(function(){u(),f()},[u,f]);Object(s.useEffect)(function(){p()},[e,t,p]);var m=Object(s.useCallback)(function(e){var a=l();t&&a&&n&&(n.scrollTo?n.scrollTo({left:e*t.clientWidth-a.x}):n.scrollLeft=e*t.clientWidth-a.x,p())},[t,n,p,l]);return fy(t,p),{showPanLeft:i,showPanRight:c,onPanLeftClick:Object(s.useCallback)(function(){return m(-1)},[m]),onPanRightClick:Object(s.useCallback)(function(){return m(1)},[m]),onScroll:Object(s.useCallback)(function(){return p()},[p])}}(d,i,n.current),p=f.showPanLeft,m=f.showPanRight,_=f.onPanLeftClick,h=f.onPanRightClick,b=f.onScroll;return c.a.createElement("div",{className:"scrollBoxContainer_28f2b9ed",style:ly,ref:r},p&&c.a.createElement(u.IconButton,{iconProps:{iconName:"ChevronLeft"},styles:uy(t,"start"),onClick:_,tabIndex:-1}),c.a.createElement(oy,py({},e,{direction:"horizontal",scrollBoxRef:l,onScroll:b,ref:n})),m&&c.a.createElement(u.IconButton,{iconProps:{iconName:"ChevronRight"},styles:uy(t,"end"),onClick:h,tabIndex:-1}))};function _y(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a="center");var i=Object(s.useState)(e.indexOf(t)),r=i[0],o=i[1],c=Object(s.useCallback)(function(t){var i=0,s=n>0?Math.ceil(e.length/n):1,c=n>0?Math.ceil((r+1)/n):1,d=e.length-n*(s-1),l=Math.floor((n-d)/2);switch(t.key){case"ArrowLeft":i=-1;break;case"ArrowRight":i=1;break;case"ArrowDown":"center"===a&&c===s-1&&d<n?(i=n-l,n>0&&r%n<l&&(i+=l-r%n)):i=n;break;case"ArrowUp":i="center"===a&&c===s&&d<n?-n+l:-n;break;default:i=0}i&&(t.preventDefault(),o(zi(r+i,0,e.length-1)))},[r,e,n,a]);return{keyboardFocusedIndex:r,setKeyboardFocusedIndex:o,onKeyDown:c}}var hy,by=function(){return by=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},by.apply(this,arguments)};!function(e){e[e.Default=0]="Default",e[e.AutoCenterSelected=1]="AutoCenterSelected",e[e.ChevronPanning=2]="ChevronPanning"}(hy||(hy={}));var gy=function(){return gy=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},gy.apply(this,arguments)},vy=Object(s.memo)(function(e){var t=e.activeAspectRatio,n=e.aspectRatiosList,a=e.setAspectRatio,i=e.setAriaAnnouncement,r=e.scrollContainerType,o=e.aspectRatioTilesStyles,d=e.tileClassNames,l=e.aspectRatioTileTabIndex,u=Object(s.useContext)(Ze),f=u.localizeNumber,p=u.strings,m=Object(s.useRef)(new Array(n.length)),_=_y(n,t),h=_.keyboardFocusedIndex,b=_.setKeyboardFocusedIndex,g=_.onKeyDown,v=function(e,t,n){var a=Object(s.useContext)(Zt).logAspectRatioEvent,i=Object(s.useContext)(Ze).strings;return Object(s.useCallback)(function(r,o){a({aspectRatio:o,inputType:Xs(r)}),e(o),t(vt(i.aspectRatio_changedAriaLive,n(o).ariaLabel))},[a,e,t,i,n])}(a,i,P2(p,f)),y=Object(s.useCallback)(function(e,t,n){v(t,e),b(n)},[b,v]),S=void 0!==l?l:function(e){return function(t){return e===t?0:-1}}(n[h]),D=function(e,t,n,a,i,r,o,s,d,l,u,f,p,m){return e.map(function(e,o){var l=n(e),u=l.key,p=l.text,m=l.ariaLabel,_=!!r&&r(e);return c.a.createElement(M2,by({key:u,name:p,iconName:a(e),tileStyles:"function"==typeof t?t(e):t,isHighlighted:!1,onClick:function(t,n){return i(e,n,o)},ariaSelected:_,ref:function(e){d&&d.current&&(d.current[o]=e)},tabIndex:"function"==typeof s?s(e):s,namePosition:undefined,tileClassNames:f&&(_?f.activeClassNames:f.inactiveClassNames),ariaLabel:m,title:m},{role:"option",isActive:_}))})}(n,o,P2(p,f),T2,y,function(e){return function(t){return e===t}}(t),0,S,m,0,0,d);Object(s.useEffect)(function(){window.requestAnimationFrame(function(){var e=m.current[h];e&&e.focus()})},[h,m]);var I={role:"listbox",title:p.aspectRatio_listTitle};switch(r){case hy.AutoCenterSelected:return c.a.createElement(cy,gy({},I,{direction:"horizontal"}),D);case hy.ChevronPanning:return c.a.createElement(my,gy({},I,{style:{outline:"none"},onKeyDown:g}),D);case hy.Default:default:return c.a.createElement(oy,gy({},I,{direction:"horizontal"}),D)}});vy.displayName="AspectRatioActionsBar";var yy=function(){return yy=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},yy.apply(this,arguments)},Sy={container:{position:"relative",bottom:"8px"}},Dy=(yy(yy({},Sy.container),{height:"16px",bottom:"5px"}),{container:{marginBottom:"8px",alignItems:"center"}}),Iy={display:"flex",flexGrow:1,alignSelf:"center",justifyContent:"center",margin:"0px 12px 8px 12px",maxWidth:"700px",width:"calc(100% - 24px)"},xy=function(){return xy=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xy.apply(this,arguments)},Cy=Object(s.memo)(function(e){var t=e.visible,n=e.showAspectRatioOptions,a=e.activeAspectRatio,i=e.aspectRatiosList,r=e.tileClassNames,o=e.desktopTransformToolsActionStackStyles,d=e.setAspectRatio,l=e.setAriaAnnouncement,f=$(),p=function(e){return{root:{backgroundColor:"transparent",color:e.palette.neutralPrimary,fill:e.palette.neutralPrimary,width:"fit-content",justifyContent:"center",display:"flex",alignSelf:"center",margin:"0px 4px",span:{fontWeight:400},i:{color:e.palette.neutralPrimary,fill:e.palette.neutralPrimary}},rootHovered:{backgroundColor:e.palette.neutralLight},rootPressed:{backgroundColor:e.palette.neutralQuaternaryAlt},rootDisabled:{backgroundColor:"transparent",color:e.palette.neutralTertiary,i:{color:e.palette.neutralTertiary,fill:e.palette.neutralTertiary}}}}(f),m=Object(s.useState)(!1),_=m[0],h=m[1],b=null==o?void 0:o.getAspectRatioTilesStyles,g=b?b(f):void 0;return Object(s.useEffect)(function(){On()&&document.activeElement&&n&&h(!0)},[n]),t?c.a.createElement(w0,{styles:Dy},!n&&c.a.createElement(iy,{componentStyles:{rotationAngleDisplay:Sy,rotationBarRoot:{display:"flex",justifyContent:"center",marginBottom:"16px"},rotate90AspectFlipBar:{iconButton:p,icon:Pb,container:Iy}},rotate90AspectFlipBarIcons:{rotate90CounterClockwise:"Rotate90CounterClockwise",rotate90Clockwise:"Rotate90Clockwise",flipHorizontally:"Switch",flipVertically:"Sort"},shouldFocusOnAspectRatioButton:_,styles:o}),n&&c.a.createElement("div",{style:{width:"fit-content",maxWidth:"100%",display:"flex",flexDirection:"column"}},c.a.createElement(vy,xy({scrollContainerType:hy.ChevronPanning,aspectRatioTilesStyles:xy(xy({},E2(f)),g)},{activeAspectRatio:a,setAspectRatio:d,setAriaAnnouncement:l,tileClassNames:r,aspectRatiosList:i})),c.a.createElement(O0,{styles:Object(u.concatStyleSets)(p,null==o?void 0:o.buttonStyles)}))):null}),Oy=Object(ga.e)([Uo,Ro,function(e){return e.transformTools.view.viewFitting.marginCssPixels}],function(e,t,n){return ur(e,t,n)}),wy=Object(ga.e)([Oy,To,Oo,Bo,Fo],function(e,t,n,a,i){return a&&(i===dr.fitCropRectInView||!function(e,t,n){var a=dn(vi(ci(t,n)));return a.top+a.height>e.top+e.height}(e,t,n))}),Ey={setAspectRatio:vd,setAriaAnnouncement:Jn},Ay=Object(ee.connect)(function(e){var t=e.transformTools.cropInteraction,n=t.aspectRatio,a=t.aspectRatiosList,i=e.uiState.showAspectRatioOptions;return{visible:wy(e),showAspectRatioOptions:i,activeAspectRatio:n,aspectRatiosList:a}},Ey)(Cy);Object($e.loadStyles)([{rawString:".ms-Fabric--isFocusVisible .nonCropUI_ccacc7f0:focus{visibility:visible;outline-width:3px;outline-style:solid;outline-offset:-3px}.ms-Fabric--isFocusHidden .nonCropUI_ccacc7f0{outline:0}.nonCropUI_ccacc7f0{position:absolute;width:100%;height:100%;top:0}"}]);var Ly="nonCropUI_ccacc7f0";function ky(e,t,n){t.forEach(function(t){t.ctrlKey!==e.ctrlKey||t.shiftKey!==e.shiftKey||t.code!==e.code&&t.keyCode!==e.keyCode||t.handler(n,e)})}var My=function(e,t,n){Object(s.useEffect)(function(){if(e){var a=function(e){e instanceof KeyboardEvent&&ky(e,t,!0)},i=function(e){e instanceof KeyboardEvent&&ky(e,t,!1)};return e.addEventListener("keydown",a,n),e.addEventListener("keyup",i,n),function(){e.removeEventListener("keydown",a,n),e.removeEventListener("keyup",i,n)}}},[e,t,n])};function Py(e,t,n,a){var i=Object(s.useCallback)(function(e,i){if(!e.ctrlKey&&En(e)){e.stopPropagation(),e.preventDefault();var r=xn(e.key);t({direction:r,adjustmentCanvasShiftingValue:In(i)}),a({type:"PanView",panViewTopLeftCornerFromCropOrigin:n})}},[t,a,n]);fp({numRepeatsToSwitchToFast:10,keyboardEventTarget:e,handleKeyboardDown:i,isFastDirectionKeyCode:wn})}var Ty={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],65:["a","A"],66:["b","B"],67:["c","C"],68:["d","D"],69:["e","E"],70:["f","F"],71:["g","G"],72:["h","H"],73:["i","I"],74:["j","J"],75:["k","K"],76:["l","L"],77:["m","M"],78:["n","N"],79:["o","O"],80:["p","P"],81:["q","Q"],82:["r","R"],83:["s","S"],84:["t","T"],85:["u","U"],86:["v","V"],87:["w","W"],88:["x","X"],89:["y","Y"],90:["z","Z"],91:"OS",93:"ContextMenu",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"F13",125:"F14",126:"F15",127:"F16",128:"F17",129:"F18",130:"F19",131:"F20",132:"F21",133:"F22",134:"F23",135:"F24",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"},Uy={};for(var Fy in Ty)if(Ty.hasOwnProperty(Fy)){var Hy=Ty[Fy];if("string"==typeof Hy)Uy[Hy]=Number(Fy);else for(var Ry=0;Ry<Hy.length;Ry++)Uy[Hy[Ry]]=Number(Fy)}var Ny=Uy[" "],By=(Uy[0],Uy[1],Uy[2],Uy[3],Uy[4],Uy[5],Uy[6],Uy[7],Uy[8],Uy[9],Uy["~"],Uy["`"],Uy["!"],Uy["@"],Uy["#"],Uy["%"],Uy["^"],Uy["&"],Uy["+"],Uy["-"],Uy["="],Uy["/"],Uy["*"],Uy[","],Uy["."],Uy[":"],Uy[";"],Uy["|"],Uy["\\"],Uy["?"],Uy["'"],Uy['"'],Uy["{"],Uy["}"],Uy["("],Uy[")"],Uy["<"],Uy[">"],Uy["["]),jy=Uy["]"],Vy=(Uy.ArrowDown,Uy.ArrowLeft,Uy.ArrowRight,Uy.ArrowUp,Uy.End,Uy.Enter,Uy.Home,Uy.PageDown,Uy.PageUp,Uy.Tab,c.a.memo(function(e){var t=e.cursor,n=e.cssToPhysicalPixelRatio,a=e.hasNonCropEdits,i=e.onPointerDown,r=e.onPointerMove,o=e.onPointerUp,d=e.onWheel,l=e.onTouchDown,u=e.onTouchMove,f=e.onTouchUp,p=e.onDoubleTap,m=e.onUnmount,_=e.setIsViewingOriginal,h=e.panView,b=e.panViewTopLeftCornerFromCropOrigin,g=e.setAriaAnnouncementScenario,v=e.isCanvasHidden,y=void 0!==v&&v,S=Object(s.useContext)(Ze).strings,D=Object(s.useState)(null),I=D[0],x=D[1],C=$(),O=Object(s.useCallback)(function(e){(e.isPrimaryButtonDownOrTouchDown||e.isMiddleButtonDown||e.isRightButtonDown)&&r(e)},[r]);Cp({htmlElement:I,cssToPhysicalPixelRatio:n,onPointerDown:i,onPointerMove:O,onPointerUp:o,onUnmount:m}),Op(n,I,l,u,f,p),pp(n,I,d),up(I);var w=Object(s.useMemo)(function(){return[{code:"Space",keyCode:Ny,handler:_,ctrlKey:!1,shiftKey:!1}]},[_]);My(I,w),Py(I,h,b,g);var E=a?S.nonCrop_imageAriaLabelWithEdits:S.nonCrop_imageAriaLabelWithoutEdits;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{ref:x,className:Ly,style:{cursor:t,outlineColor:C.palette.neutralDark},"data-is-focusable":!0,title:a?S.nonCrop_imageTooltip:void 0,"aria-label":E,role:"img",tabIndex:0,"data-test-id":"nonCrop_canvas","aria-hidden":y}))})),zy=Object(ga.e)([To,Oo],function(e,t){return Ta(Ma(pi(ci(e,t)),-1))}),Gy=function(){return Gy=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gy.apply(this,arguments)},Ky={onPointerMove:ie,onPointerDown:ne,onPointerUp:ae,onWheel:$c,onTouchDown:id,onTouchMove:rd,onTouchUp:od,onDoubleTap:dd,onUnmount:sd,setIsViewingOriginal:Ls,panView:Cd,setAriaAnnouncementScenario:Xn},Wy=Object(ee.connect)(function(e){return{cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,cursor:Gp(e),hasNonCropEdits:eh(Gy(Gy({},Io),e)),panViewTopLeftCornerFromCropOrigin:zy(e)}},Ky)(Vy);Object($e.loadStyles)([{rawString:".layout_desktop_46fde051{width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.content_container_46fde051{display:grid;width:100%;height:calc(100% - 44px);grid-template-columns:1fr auto auto;grid-template-rows:1fr}.canvas_container_46fde051{position:relative}"}]);var qy=c.a.memo(function(e){var t=e.cssPixelMarginByActivity,n=e.activeEditorActivity,a=e.setViewFittingMarginCssPixels;return Object(s.useLayoutEffect)(function(){a({marginCssPixels:t[n]||lr(0),shouldAnimate:!0})},[a,n,t]),null}),Qy={setViewFittingMarginCssPixels:fd},Yy=Object(ee.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity}},Qy)(qy),Jy=function(){function e(e,t){this._levelUniformName=e,this._mapNormalizedToShaderValue=t,this._level=0}return e.prototype.onBeforeBabylonRender=function(e){e.setFloat(this._levelUniformName,this._mapNormalizedToShaderValue(this._level))},e.prototype.setLevel=function(e){this._level=e},e.prototype.getLevel=function(){return this._level},e}(),Xy=function(){function e(e,t,n){this._name=e,this._defineIdentifierName=t,this._shaderInputProvider=n}return e.prototype.getName=function(){return this._name},e.prototype.getUniformNames=function(e){return[]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return"\n#define ".concat(this._defineIdentifierName)},e.prototype.getShaderFunctionBody=function(e){return""},e.prototype.onBeforeBabylonRender=function(e,t){this._shaderInputProvider.onBeforeBabylonRender(e,t)},e}(),Zy=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),$y=function(e){function t(t,n,a){var i=e.call(this,t,n,a)||this;return i.name=t,i.defineIdentifierName=n,i.shaderInputProvider=a,i}return Zy(t,e),t.prototype.getLevel=function(){return this.shaderInputProvider.getLevel()},t.prototype.setLevel=function(e){return this.shaderInputProvider.setLevel(e)},t}(Xy),e6=function(e,t){var n=e.levelUniformName,a=e.mapNormalizedToShaderValue,i=e.defName,r=Object(s.useMemo)(function(){return new Jy(n,a)},[n,a]),o=Object(s.useMemo)(function(){return new $y(e.defName,i,r)},[i,r,e]);r.setLevel(zi(t,0,1)),wl(t),Ul(o)},t6=[.04,1,4],n6={defName:"BRIGHTNESS",levelUniformName:"uBrightnessLevel",mapNormalizedToShaderValue:function(e){return yr(t6,e)}},a6=function(){return n6},i6=Object(ee.connect)(function(e){return{level:e.colorAdjustments.brightness}})(function(e){var t=e.level,n=a6();return e6(n,t),null}),r6=function(){function e(){this._devicePixelRatio=1,this._checkerboardSize=15,this._lightCheckerColor=1,this._darkCheckerColor=.95}return e.prototype.setDevicePixelRatio=function(e){this._devicePixelRatio=e},e.prototype.setCheckerboardSize=function(e){e&&(this._checkerboardSize=e)},e.prototype.setLightCheckerColor=function(e){e&&(this._lightCheckerColor=e)},e.prototype.setDarkCheckerColor=function(e){e&&(this._darkCheckerColor=e)},e.prototype.getName=function(){return"CheckerboardShader"},e.prototype.getUniformNames=function(e){return[e("uCheckerboardSize@"),e("uLightCheckerColor@"),e("uDarkCheckerColor@")]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n        //Checkerboard effect---\n        uniform float uCheckerboardSize@;\n        uniform float uLightCheckerColor@;\n        uniform float uDarkCheckerColor@;\n        ")},e.prototype.getShaderFunctionBody=function(e){return e("\n            //Checkerboard effect---\n            float total = step(uCheckerboardSize@, mod(".concat(Nd,".x, uCheckerboardSize@ * 2.0)) + step(uCheckerboardSize@, mod(").concat(Nd,".y, uCheckerboardSize@ * 2.0));\n            float baseCheckerboardColor = mix(uDarkCheckerColor@,uLightCheckerColor@,sign(mod(total, 2.0 )));\n            vec4 checkerBlendedColor = mix(vec4(baseCheckerboardColor,baseCheckerboardColor,baseCheckerboardColor,1.0),gl_FragColor, gl_FragColor.a);\n\n            // Checkerboard is hidden when there's a colorOverride. For example, the default transparent placeholder image should be shown without a checkerboard effect.\n            vec4 checkerboardColor = mix(checkerBlendedColor,").concat(Gd,",").concat(zd,");\n            gl_FragColor = mix(checkerboardColor, gl_FragColor, ").concat(Jd,");\n        "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uCheckerboardSize@"),this._checkerboardSize*this._devicePixelRatio),e.setFloat(t("uLightCheckerColor@"),this._lightCheckerColor),e.setFloat(t("uDarkCheckerColor@"),this._darkCheckerColor)},e}(),o6=Object(ee.connect)(function(e){return{devicePixelRatio:e.transformTools.device.pixelRatio}})(function(e){var t=e.devicePixelRatio,n=e.checkerboardSize,a=e.lightCheckerColor,i=e.darkCheckerColor,r=Object(s.useMemo)(function(){return new r6},[]);return r.setDevicePixelRatio(t),wl(t),r.setCheckerboardSize(n),wl(n),r.setLightCheckerColor(a),wl(a),r.setDarkCheckerColor(i),wl(i),Ul(r),null}),s6=function(){function e(e,t,n){this._negativeVectorUniformName=e,this._neutralVectorUniformName=t,this._positiveVectorUniformName=n,this._negativeVector=[0,0,0,0],this._neutralVector=[0,0,0,0],this._positiveVector=[0,0,0,0]}return e.prototype.onBeforeBabylonRender=function(e){e.setVector4(this._negativeVectorUniformName,ll(this._negativeVector)),e.setVector4(this._neutralVectorUniformName,ll(this._neutralVector)),e.setVector4(this._positiveVectorUniformName,ll(this._positiveVector))},e.prototype.setData=function(e,t,n){this._negativeVector=e,this._neutralVector=t,this._positiveVector=n},e}();function c6(e,t){return{r:e.r-t.r,g:e.g-t.g,b:e.b-t.b,a:e.a-t.a}}var d6=p6(0);function l6(e,t,n,a){e=zi(e,0,360),t=zi(t,-100,100),n=zi(n,-100,100),a=zi(a,-100,100);var i,r=function(e,t){var n=e,a=u6(t);return(a*=.5)<0&&(a*=-1,n=(e+180)%360),[n,a]}(e,t),o=r[0],s=r[1],c=function(e){return 50+.25*u6(e)}(a),d=function(e,t,n){var a,i,r,o=zi(e,0,359),s=zi(t/100,0,1),c=zi(n/100,0,1);if(0===s)a=c,i=c,r=c;else{o/=60;var d=Math.floor(o),l=o-d,u=c*(1-s),f=c*(1-s*l),p=c*(1-s*(1-l));switch(d){case 0:a=c,i=p,r=u;break;case 1:a=f,i=c,r=u;break;case 2:a=u,i=c,r=p;break;case 3:a=u,i=f,r=c;break;case 4:a=p,i=u,r=c;break;default:a=c,i=u,r=f}}return{r:a,g:i,b:r,a:1}}(o,s,c);return(d={r:2*(i=d).r,g:2*i.g,b:2*i.b,a:2*i.a}).a=function(e){return 1+.01*e}(n),d}function u6(e){return Math.sign(e)*e*e/100}function f6(e,t){var n,a;return a=t,{r:(n=l6(e.hue,e.density,e.saturation,e.value)).r*a.r,g:n.g*a.g,b:n.b*a.b,a:n.a*a.a}}function p6(e){return{hue:30,density:0,saturation:0,value:e}}function m6(e){return[e.r,e.g,e.b,e.a]}var _6=function(){return _6=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_6.apply(this,arguments)},h6=[-65,0,100],b6={negativeVectorUniformName:"vCameraColorCurveNegative",neutralVectorUniformName:"vCameraColorCurveNeutral",positiveVectorUniformName:"vCameraColorCurvePositive"},g6=_6(_6({defName:"COLORCURVES"},b6),{createColorCurveVectors:function(e,t,n){return a=tn(-100,100,e),i=yr(h6,t),r=tn(-100,100,n),o=l6(30,0,0,a),s=f6(p6(i),o),c=f6(d6,o),d=f6(p6(r),o),l=c6(s,c),u=c,{negativeVector:m6(c6(c,d)),neutralVector:m6(u),positiveVector:m6(l)};var a,i,r,o,s,c,d,l,u},getUniformNames:function(){return Object.values(b6)}}),v6=function(){return g6},y6=c.a.memo(function(e){var t,n=e.exposureNormalizedSliderLevel,a=e.highlightsNormalizedSliderLevel,i=e.shadowsNormalizedSliderLevel,r=v6(),o=(t=r,Object(s.useMemo)(function(){var e=new s6(t.negativeVectorUniformName,t.neutralVectorUniformName,t.positiveVectorUniformName);return[e,new Xy(t.defName,t.defName,e)]},[t])),c=o[0],d=o[1],l=r.createColorCurveVectors(n,a,i),u=l.negativeVector,f=l.neutralVector,p=l.positiveVector;return c.setData(u,f,p),wl(n,a,i),Ul(d),null}),S6=Object(ee.connect)(function(e){return{exposureNormalizedSliderLevel:e.colorAdjustments.exposure,highlightsNormalizedSliderLevel:e.colorAdjustments.highlights,shadowsNormalizedSliderLevel:e.colorAdjustments.shadows}})(y6),D6={defName:"CONTRAST",highLevelValuesUniformName:"uContrastHighValues",lowLevelValuesUniformName:"uContrastLowValues",mapNormalizedToShaderValue:an(-1,1),getContrastValues:function(e){return{lowLevelValues:{x:2*e,y:1-e,z:0},highLevelValues:{x:2*-e,y:1+3*e,z:-e}}}},I6=function(){return D6},x6=c.a.memo(function(e){var t=e.level,n=I6(),a=Object(s.useMemo)(function(){var e=I6(),t=new C6(e.lowLevelValuesUniformName,e.highLevelValuesUniformName);return[t,new Xy(e.defName,e.defName,t)]},[]),i=a[0],r=a[1],o=n.getContrastValues(n.mapNormalizedToShaderValue(t)),c=o.highLevelValues,d=o.lowLevelValues;return i.setLevels(c,d),wl(t),Ul(r),null}),C6=function(){function e(e,t){this._lowLevelValuesUniformName=e,this._highLevelValuesUniformName=t,this._lowLevelValues={x:0,y:0,z:0},this._highLevelValues={x:0,y:0,z:0}}return e.prototype.onBeforeBabylonRender=function(e){e.setVector3(this._lowLevelValuesUniformName,this._lowLevelValues),e.setVector3(this._highLevelValuesUniformName,this._highLevelValues)},e.prototype.setLevels=function(e,t){this._lowLevelValues=e,this._highLevelValues=t},e}(),O6=Object(ee.connect)(function(e){return{level:e.colorAdjustments.contrast}})(x6),w6=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},E6=function(){function e(){this._transform=[1,0,0,0,1,0],this._level=1,this._outsideVisibility=.3}return e.prototype.setTransform=function(e){this._transform=e},e.prototype.setLevel=function(e){this._level=e},e.prototype.setOutsideLightness=function(e){this._outsideVisibility=e},e.prototype.getName=function(){return"CropMaskShader"},e.prototype.getUniformNames=function(e){return[e("uCropTransform@"),e("uCropTransformInverse@"),e("uLevel@"),e("uOutsideVisibility@")]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n        //CropMask effect---\n        uniform mat3 uCropTransform@;\n        uniform mat3 uCropTransformInverse@;\n        uniform float uLevel@;\n        uniform float uOutsideVisibility@;\n        ")},e.prototype.getShaderFunctionBody=function(e){return e("\n            //CropMask effect---\n            vec3 normalizedPos@ = vec3(".concat(Nd,".x,").concat(Nd,".y,1.0) * uCropTransformInverse@;\n\n            float isOutsideCropRegion = 1. - step(0.0, normalizedPos@.x) * step(0.0, normalizedPos@.y) * step(0.0, 1.0 - normalizedPos@.x) * step(0.0, 1.0 - normalizedPos@.y);\n            float applyCropMask = mix(isOutsideCropRegion, 0., ").concat(Jd,");\n\n            finalAlphaMultiply = mix(finalAlphaMultiply, uOutsideVisibility@, applyCropMask);\n        "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setMatrix3x3(t("uCropTransform@"),new Float32Array(w6(w6([],this._transform,!0),[0,0,1],!1))),e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(w6(w6([],ei(this._transform),!0),[0,0,1],!1))),e.setFloat(t("uLevel@"),this._level),e.setFloat(t("uOutsideVisibility@"),this._outsideVisibility)},e}(),A6=Object(ga.e)([function(e){return Xi(e.transformTools.animations.outsideCropVisibility,e.transformTools.animations.currentTime,100)},function(e){return Xi(e.transformTools.animations.dismissOutsideCropVisibility,e.transformTools.animations.currentTime,400)},Go,Ao,Fp],function(e,t,n,a,i){return function(e,t,n,a,i){if(i!==to||a===cr.disabled)return 0;if((a===cr.none||a===cr.draggingView)&&1===t)return.2;var r=e||Sr(a);return tn(r?.2:.5,r?.5:.2,t)*function(e,t){return Sr(t)?yr([1,1,1,1,.4],e):1}(n,a)}(n,e,t,a,i)}),L6=Object(ee.connect)(function(e){var t=e.transformTools.cropInteraction.mode;return{transform:Kf(e),level:t===cr.selectingFirstCorner?0:1,outsideVisibilityValue:A6(e)}})(function(e){var t=e.transform,n=e.level,a=e.outsideVisibilityValue,i=Object(s.useMemo)(function(){return new E6},[]);return i.setTransform(t),i.setLevel(n),i.setOutsideLightness(a),El(t),wl(n),Ul(i),null}),k6=Object(s.createContext)({textures:{},urlsById:{},loadUrls:function(){}}),M6="level@",P6="lookup2D@",T6="uBlueSlicesIn2DLayout@",U6="uTexSize@",F6="LutShader",H6=function(){function e(){this._level=0,this._configuration={numRedSamplesPerSlice:0,numGreenSamplesPerSlice:0,numBlueSlicesPerRowIn2DLayout:0,numBlueSlicesPerColumnIn2DLayout:0}}return e.prototype.setLevel=function(e){this._level=e},e.prototype.getLevel=function(){return this._level},e.prototype.setTexture=function(e){this._texture=e},e.prototype.getTexture=function(){return this._texture},e.prototype.setConfiguration=function(e){this._configuration=e},e.prototype.getConfiguration=function(){return this._configuration},e.prototype.getBlueSlicesIn2DLayout=function(){return{x:this._configuration.numBlueSlicesPerRowIn2DLayout,y:this._configuration.numBlueSlicesPerColumnIn2DLayout}},e.prototype.calculateTextureSize=function(){return Ha(this.getBlueSlicesIn2DLayout(),{x:this._configuration.numRedSamplesPerSlice,y:this._configuration.numGreenSamplesPerSlice})},e.prototype.getUniformNames=function(e){return[e(M6),e(T6),e(U6)]},e.prototype.getSamplerNames=function(e){return[e(P6)]},e.prototype.getName=function(){return F6},e.prototype.getFunctions=function(e){return["\nvec4 getColorInLookupTable(in vec4 color, in sampler2D lookupTable, in vec2 blueSlicesIn2DLayout, in vec2 texSize) {\n    color = clamp(color, 0., 1.);\n\n    mediump float unboundBlueSlice = color.b * (blueSlicesIn2DLayout.x * blueSlicesIn2DLayout.y - 1.);\n\n    // Find the nearest lower bound quad location\n    mediump vec2 lowerBoundBlueSlice;\n    lowerBoundBlueSlice.y = floor(floor(unboundBlueSlice) / blueSlicesIn2DLayout.x);\n    lowerBoundBlueSlice.x = floor(unboundBlueSlice) - (lowerBoundBlueSlice.y * blueSlicesIn2DLayout.x);\n\n    // Find the nearest upper bound quad location\n    mediump vec2 upperBoundBlueSlice;\n    upperBoundBlueSlice.y = floor(ceil(unboundBlueSlice) / blueSlicesIn2DLayout.x);\n    upperBoundBlueSlice.x = ceil(unboundBlueSlice) - (upperBoundBlueSlice.y * blueSlicesIn2DLayout.x);\n\n    // Within the slices, find the position of the rg values in UV space\n    highp vec2 texPos1 = (lowerBoundBlueSlice / blueSlicesIn2DLayout) + vec2(0.5, 0.5) / texSize + (((vec2(1., 1.) / blueSlicesIn2DLayout) - vec2(1., 1.) / texSize) * color.rg);\n    highp vec2 texPos2 = (upperBoundBlueSlice / blueSlicesIn2DLayout) + vec2(0.5, 0.5) / texSize + (((vec2(1., 1.) / blueSlicesIn2DLayout) - vec2(1., 1.) / texSize) * color.rg);\n\n    // Get the two colors that we will interpolate in the LUT texture\n    lowp vec4 newColor1 = texture2D(lookupTable, texPos1);\n    lowp vec4 newColor2 = texture2D(lookupTable, texPos2);\n\n    // Interpolate between the two depending on our blue channel\n    lowp vec4 newColor = mix(newColor1, newColor2, fract(unboundBlueSlice));\n    return newColor;\n}"]},e.prototype.getHeaderCode=function(e){return e("\n//look up table effect---\n        uniform float ".concat(M6,";\n        uniform sampler2D ").concat(P6,";\n        uniform vec2 ").concat(T6,";\n        uniform vec2 ").concat(U6,";\n        "))},e.prototype.getShaderFunctionBody=function(e){return e("\n//look up table effect---\n        vec4 tempColor@ = getColorInLookupTable(gl_FragColor, ".concat(P6,", ").concat(T6,", ").concat(U6,");\n        gl_FragColor.rgb = mix(gl_FragColor.rgb,tempColor@.rgb, ").concat(M6,");\n        "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(M6),this._level),this._texture&&e.setTexture(t(P6),this._texture),e.setVector2(t(T6),this.getBlueSlicesIn2DLayout()),e.setVector2(t(U6),this.calculateTextureSize())},e}(),R6=Object(ga.e)([Wo,Hp,Lo],function(e,t,n){return t&&!e&&n!==cr.draggingView}),N6=Object(ee.connect)(function(e){var t=e.filters.activeFilter;return{level:e.filters.filterLevel,activeFilter:t,disabled:R6({transformTools:e.transformTools,uiState:e.uiState})}})(function(e){var t=e.level,n=e.activeFilter,a=e.disabled,i=Object(s.useContext)(k6),r=i.textures,o=i.urlsById,c=i.loadUrls,d=Object(s.useMemo)(function(){return new H6},[]),l=E_(n);0===Object.keys(o).length&&l&&t>0&&c();var u=o[n.lutUrlId],f=l&&u?r[u]:void 0,p=f?f.parts[0].texture:void 0,m=p&&!a?t:0;return d.setLevel(m),l&&n.config&&d.setConfiguration(n.config),d.setTexture(p),wl(m,n,p),Ul(d),null}),B6={defName:"MASTER",levelUniformName:"uMasterLevel",mapNormalizedToShaderValue:function(e){return e}},j6=function(){return B6},V6=Object(ee.connect)(function(e){return{level:R6({transformTools:e.transformTools,uiState:e.uiState})?0:1}})(function(e){var t=e.level,n=j6();return e6(n,t),null}),z6={defName:"SATURATION",levelUniformName:"uSaturationLevel",mapNormalizedToShaderValue:an(-1,1)},G6=function(){return z6},K6=c.a.memo(function(e){var t=e.saturationNormalizedSliderLevel,n=G6();return e6(n,t),null}),W6=Object(ee.connect)(function(e){return{saturationNormalizedSliderLevel:e.colorAdjustments.saturation}})(K6),q6=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},Q6=j6(),Y6="VignetteShader",J6=function(){function e(){this._transform=[1,0,0,0,1,0],this._level=0}return e.prototype.setTransform=function(e){this._transform=e},e.prototype.getTransform=function(){return this._transform},e.prototype.setLevel=function(e){this._level=e},e.prototype.getName=function(){return Y6},e.prototype.getUniformNames=function(e){return[e("uCropTransform@"),e("uCropTransformInverse@"),e("uLevel@")]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n          //Vignette effect---\n          uniform mat3 uCropTransform@;\n          uniform mat3 uCropTransformInverse@;\n          uniform float uLevel@;\n        ")},e.prototype.getShaderFunctionBody=function(e){return e("\n        //Vignette effect---\n        vec3 normalizedPos@ = vec3(".concat(Nd,".x, ").concat(Nd,".y,1.0) * uCropTransformInverse@;\n\n        float shouldMix@ = step(0.0, normalizedPos@.x) * step(0.0, normalizedPos@.y) * step(0.0, 1.0 - normalizedPos@.x) * step(0.0, 1.0 - normalizedPos@.y);\n        float dist@ = distance(normalizedPos@.xy, vec2(0.5));\n        float vignetteSize@ = 0.5;\n        float gradient@ = smoothstep(0.8, vignetteSize@ * 0.799, dist@ * (abs(uLevel@ * 0.525) + vignetteSize@));\n        float shouldApplyAdjustments@ = mix(").concat(Q6.levelUniformName,", 1., ").concat(Jd,");\n        vec3 color@ = gl_FragColor.rgb;\n\n        // white\n        if(uLevel@ < 0.) {\n          color@ = mix(vec3(1.), gl_FragColor.rgb, gradient@);\n        }\n\n        // black\n        if(uLevel@ > 0.) {\n          color@ = mix(vec3(0.), gl_FragColor.rgb, gradient@);\n        }\n\n        gl_FragColor.rgb = mix(gl_FragColor.rgb, color@, shouldMix@ * shouldApplyAdjustments@);\n      "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setMatrix3x3(t("uCropTransform@"),new Float32Array(q6(q6([],this._transform,!0),[0,0,1],!1))),e.setMatrix3x3(t("uCropTransformInverse@"),new Float32Array(q6(q6([],ei(this._transform),!0),[0,0,1],!1))),e.setFloat(t("uLevel@"),this._level)},e}(),X6={mapNormalizedToShaderValue:an(-.7,.7)},Z6=Object(ee.connect)(function(e){return{transform:Kf(e),level:e.colorAdjustments.vignette}})(function(e){var t=e.transform,n=e.level,a=Object(s.useMemo)(function(){return new J6},[]),i=X6.mapNormalizedToShaderValue;return a.setTransform(t),a.setLevel(i(n)),El(t),wl(n),Ul(a),null}),$6=.003256,e7=6502.078125,t7=[3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252],n7=function(e,t,n){return{r:t7[0]*e+t7[1]*t+t7[2]*n,g:t7[3]*e+t7[4]*t+t7[5]*n,b:t7[6]*e+t7[7]*t+t7[8]*n}},a7=[{u:.18006,v:.26352,slope:-.24341,recipTemp:0},{u:.18066,v:.26589,slope:-.25479,recipTemp:1e-5},{u:.18133,v:.26846,slope:-.26876,recipTemp:2e-5},{u:.18208,v:.27119,slope:-.28539,recipTemp:1/33333},{u:.18293,v:.27407,slope:-.3047,recipTemp:4e-5},{u:.18388,v:.27709,slope:-.32675,recipTemp:5e-5},{u:.18494,v:.28021,slope:-.35156,recipTemp:1/16667},{u:.18611,v:.28342,slope:-.37915,recipTemp:1/14286},{u:.1874,v:.28668,slope:-.40955,recipTemp:8e-5},{u:.1888,v:.28997,slope:-.44278,recipTemp:1/11111},{u:.19032,v:.29326,slope:-.47888,recipTemp:1e-4},{u:.19462,v:.30141,slope:-.58204,recipTemp:1/8e3},{u:.19962,v:.30921,slope:-.70471,recipTemp:1/6667},{u:.20525,v:.31647,slope:-.84901,recipTemp:1/5714},{u:.21142,v:.32312,slope:-1.0182,recipTemp:2e-4},{u:.21807,v:.32909,slope:-1.2168,recipTemp:1/4444},{u:.22511,v:.33439,slope:-1.4512,recipTemp:1/4e3},{u:.23247,v:.33904,slope:-1.7298,recipTemp:1/3636},{u:.2401,v:.34308,slope:-2.0637,recipTemp:1/3333},{u:.24792,v:.34655,slope:-2.4681,recipTemp:1/3077},{u:.25591,v:.34951,slope:-2.9641,recipTemp:1/2857},{u:.264,v:.352,slope:-3.5814,recipTemp:1/2677},{u:.27218,v:.35407,slope:-4.3633,recipTemp:4e-4},{u:.28039,v:.35577,slope:-5.3762,recipTemp:1/2353},{u:.28863,v:.35714,slope:-6.7262,recipTemp:1/2222},{u:.29685,v:.35823,slope:-8.5955,recipTemp:1/2105},{u:.30505,v:.35907,slope:-11.324,recipTemp:5e-4},{u:.3132,v:.35968,slope:-15.628,recipTemp:1/1905},{u:.32129,v:.36011,slope:-23.325,recipTemp:1/1818},{u:.32931,v:.36038,slope:-40.77,recipTemp:1/1739},{u:.33724,v:.36051,slope:-116.45,recipTemp:1/1667}],i7=function(e,t){var n,a,i,r,o,s=function(e,t){for(var n=1/e,a=1;a<a7.length&&!(n<a7[a].recipTemp);a++);a===a7.length&&a--;var i=a7[a-1],r=a7[a],o=nn(i.recipTemp,r.recipTemp,n),s=tn(i.slope/Math.sqrt(1+i.slope*i.slope),r.slope/Math.sqrt(1+r.slope*r.slope),o),c=tn(i.u,r.u,o),d=tn(i.v,r.v,o),l=t/Math.sqrt(1+s*s),u=c+l,f=d+s*l;if(f>-.1*u+.4){var p=(-.1*u+.4-f)/(-.1*(u-c)+d-f);u=tn(u,c,p),f=tn(f,d,p)}return{y:1,u:u,v:f}}(e,t);return n=s.y,a=s.u,i=s.v,r=0,o=0,n>=1e-7&&(r=6*a*n/(4*i),o=n*(6*(4-a)-60*i)/(12*i)),[r,n,o]},r7={defName:"WHITE_BALANCE",mapSliderValueToTint:function(e){return e=tn(-1,1,e),[$6,1.25*e/100+$6]},whiteBalanceGainUniformName:"uWhiteBalanceGain",mapSliderValueToKelvinTemperature:function(e){var t=e7;return(e=tn(-1,1,e))>0?t=tn(e7,1e4,e):e<0&&(t=tn(e7,4e3,-e)),[t,6502.078125]},mapTemperatureAndTintToRBGains:function(e,t,n,a){var i=zi(e,1667,Number.MAX_VALUE),r=i7(i,n),o=i7(t,a),s=n7.apply(void 0,r),c=n7.apply(void 0,o);return[c.r/c.g/(s.r/s.g),c.b/c.g/(s.b/s.g)]}},o7=function(){return r7},s7=function(){function e(e){this._whiteBalanceGainUniformName=e,this._whiteBalanceGainVector={r:1,g:1,b:1}}return e.prototype.onBeforeBabylonRender=function(e){e.setColor3(this._whiteBalanceGainUniformName,this._whiteBalanceGainVector)},e.prototype.setGains=function(e,t){this._whiteBalanceGainVector={r:e,g:1,b:t}},e}(),c7=c.a.memo(function(e){var t=e.tintLevel,n=e.temperatureLevel,a=o7(),i=a.mapSliderValueToTint,r=a.mapSliderValueToKelvinTemperature,o=a.mapTemperatureAndTintToRBGains,c=a.whiteBalanceGainUniformName,d=a.defName,l=r(n),u=l[0],f=l[1],p=i(t),m=o(u,f,p[0],p[1]),_=m[0],h=m[1],b=function(e,t){return Object(s.useMemo)(function(){var n=new s7(e);return[n,new Xy(t,t,n)]},[e,t])}(c,d),g=b[0],v=b[1];return g.setGains(_,h),wl(t,n),Ul(v),null}),d7=Object(ee.connect)(function(e){return{tintLevel:e.colorAdjustments.tint,temperatureLevel:e.colorAdjustments.temperature}})(c7),l7="uZoomLevel@",u7=function(){function e(){this._zoomLevel=1}return e.prototype.setZoomLevel=function(e){this._zoomLevel=e},e.prototype.getName=function(){return"ZoomToPixelsShader"},e.prototype.getUniformNames=function(e){return[e(l7)]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return e(" //ZoomToPixels effect---\n    uniform float ".concat(l7,";"))},e.prototype.getShaderFunctionBody=function(e){return e("//ZoomToPixels effect---\n        if(".concat(l7," > 1.0 && ").concat(Jd," == 0.){\n            vec2 screenTranslationInPixels@ = (vec3(0.0,0.0,1.0) * ").concat(Bd,").xy;\n            vec2 zoomVec2@ = vec2(").concat(l7,");\n            vec2 pixelPosOffset@ = mod(screenTranslationInPixels@, zoomVec2@);\n            vec2 pixelPosRounded@ = floor((").concat(Nd,"- pixelPosOffset@)/zoomVec2@ )*").concat(l7," + 0.5*zoomVec2@;\n            vec3 uv@ = vec3(pixelPosRounded@.x + pixelPosOffset@.x, pixelPosRounded@.y + pixelPosOffset@.y,1.0) * ").concat(jd,";\n            gl_FragColor = getTextureColor(uv@.xy);\n\n            // Texture may not be set so use the color override to show that instead (these are set in ShadersBase.ts)\n            gl_FragColor = mix(gl_FragColor,").concat(Gd,",").concat(zd,");\n\n            //modify the uv so that subsequent effect code will use this uv value when sampling textures.\n            ").concat(Rd,".xy = uv@.xy;\n        }\n        "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(l7),this._zoomLevel)},e}(),f7=c.a.memo(function(e){var t=e.zoomLevel,n=Object(s.useMemo)(function(){return new u7},[]);return n.setZoomLevel(t),wl(t),Ul(n),null});f7.displayName="ZoomToPixelsEffect";var p7=Object(ee.connect)(function(e){return{zoomLevel:Kp(e)}})(f7),m7=o7(),_7=a6(),h7=G6(),b7=I6(),g7=v6(),v7=j6(),y7=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([m7.whiteBalanceGainUniformName,_7.levelUniformName,h7.levelUniformName,b7.highLevelValuesUniformName,b7.lowLevelValuesUniformName,v7.levelUniformName],g7.getUniformNames(),!0),S7="\n#ifdef ".concat(m7.defName,"\n  uniform vec3 ").concat(m7.whiteBalanceGainUniformName,";\n#endif\n#ifdef ").concat(_7.defName,"\n  uniform float ").concat(_7.levelUniformName,";\n#endif\n#ifdef ").concat(h7.defName,"\n  uniform float ").concat(h7.levelUniformName,";\n  const float SATURATION_RED_K = 9437.0 / 32768.0;\n  const float SATURATION_GREEN_K = 1.0 - SATURATION_RED_K;\n#endif\n#ifdef ").concat(b7.defName,"\n  uniform vec3 ").concat(b7.lowLevelValuesUniformName,";\n  uniform vec3 ").concat(b7.highLevelValuesUniformName,";\n\n  float TransformChannelContrast(in float channelLevel, in vec3 low, in vec3 high) {\n    vec3 levels = mix(low, high, step(channelLevel, 0.5));\n    return ((levels.x * channelLevel + levels.y) * channelLevel) + levels.z;\n  }\n#endif\n#ifdef ").concat(g7.defName,"\n  uniform vec4 ").concat(g7.negativeVectorUniformName,";\n  uniform vec4 ").concat(g7.neutralVectorUniformName,";\n  uniform vec4 ").concat(g7.positiveVectorUniformName,";\n#endif\n#ifdef ").concat(v7.defName,"\n  uniform float ").concat(v7.levelUniformName,";\n#endif\n\n  struct Adjustments {\n    vec3 whiteBalanceGain;\n    float brightness;\n    float saturation;\n    vec3 contrastLowLevels;\n    vec3 contrastHighLevels;\n    vec4 colorCurvesNeutralVector;\n    vec4 colorCurvesPositiveVector;\n    vec4 colorCurvesNegativeVector;\n  };\n\n  ").concat(Td,"\n  ").concat(Pd,"\n  ").concat(Ud,"\n  ").concat("\n#ifndef GETLUMINANCE\n#define GETLUMINANCE\n\nconst vec3 LuminanceEncodeApprox = vec3(0.2126, 0.7152, 0.0722);\nfloat getLuminance(vec3 color)\n{\n    return clamp(dot(color, LuminanceEncodeApprox), 0., 1.);\n}\n#endif\n","\n\n  vec4 ApplyAdjustments(in Adjustments adj, in vec4 c) {\n    vec4 result = c.rgba;\n\n    #ifdef ").concat(m7.defName,"\n      // Apply White Balance (Gamma Space)\n      result.rgb *= adj.whiteBalanceGain.rgb;\n    #endif\n\n    result.rgb = toLinearSpace(result.rgb);\n\n    #ifdef ").concat(_7.defName,"\n      // Apply Brightness (Linear Space)\n      result.rgb *= adj.brightness;\n    #endif\n\n    #ifdef ").concat(h7.defName,"\n      // Apply Saturation (Linear Space)\n      float saturatedR = result.r + (result.r - result.g) * SATURATION_GREEN_K * adj.saturation;\n      float saturatedG = result.g + (result.g - result.r) * SATURATION_RED_K   * adj.saturation;\n      float saturatedB = result.b + (result.b - SATURATION_RED_K * result.r - SATURATION_GREEN_K * result.g) * adj.saturation;\n      result.rgb = clamp(vec3(saturatedR, saturatedG, saturatedB), vec3(0.0), vec3(1.0));\n    #endif\n\n    result.rgb = toGammaSpace(result.rgb);\n\n    #ifdef ").concat(g7.defName,"\n      // Apply Color Curves (Gamma Space)\n      // https://github.com/BabylonJS/Babylon.js/blob/6adcf34c72f322949fe04b9ccbe3fc5faf7206a1/src/Shaders/ShadersInclude/imageProcessingFunctions.fx\n      float luma = getLuminance(result.rgb);\n      vec2 curveMix = clamp(vec2(luma * 3.0 - 1.5, luma * -3.0 + 1.5), vec2(0.0), vec2(1.0));\n      vec4 colorCurve = adj.colorCurvesNeutralVector + curveMix.x * adj.colorCurvesPositiveVector - curveMix.y * adj.colorCurvesNegativeVector;\n      result.rgb *= colorCurve.rgb;\n      result.rgb = mix(vec3(luma), result.rgb, colorCurve.a);\n    #endif\n\n    result = clamp(result, 0.0, 1.0);\n\n    #ifdef ").concat(b7.defName,"\n      // Apply Contrast (Gamma Space)\n      // Assumption: Value is clamped. Otherwise high contrast levels cause strange colors with high brightness/exposure\n      result.r = TransformChannelContrast(result.r, adj.contrastLowLevels, adj.contrastHighLevels);\n      result.g = TransformChannelContrast(result.g, adj.contrastLowLevels, adj.contrastHighLevels);\n      result.b = TransformChannelContrast(result.b, adj.contrastLowLevels, adj.contrastHighLevels);\n    #endif\n\n    result = clamp(result, 0.0, 1.0);\n    return result;\n  }\n"),D7="\n  Adjustments adj;\n\n  #ifdef ".concat(m7.defName,"\n    adj.whiteBalanceGain = ").concat(m7.whiteBalanceGainUniformName,";\n  #endif\n\n  #ifdef ").concat(_7.defName,"\n    adj.brightness = ").concat(_7.levelUniformName,";\n  #endif\n\n  #ifdef ").concat(h7.defName,"\n    adj.saturation = ").concat(h7.levelUniformName,";\n  #endif\n\n  #ifdef ").concat(b7.defName,"\n    adj.contrastLowLevels = ").concat(b7.lowLevelValuesUniformName,";\n    adj.contrastHighLevels = ").concat(b7.highLevelValuesUniformName,";\n  #endif\n\n  #ifdef ").concat(g7.defName,"\n    adj.colorCurvesNeutralVector = ").concat(g7.neutralVectorUniformName,";\n    adj.colorCurvesPositiveVector = ").concat(g7.positiveVectorUniformName,";\n    adj.colorCurvesNegativeVector = ").concat(g7.negativeVectorUniformName,";\n  #endif\n\n  #ifdef ").concat(v7.defName,"\n    float shouldApplyAdjustments = mix(").concat(v7.levelUniformName,", 1., ").concat(Jd,");\n    gl_FragColor = mix(gl_FragColor, ApplyAdjustments(adj, gl_FragColor), shouldApplyAdjustments);\n  #else\n    gl_FragColor = ApplyAdjustments(adj, gl_FragColor);\n  #endif\n"),I7=function(){function e(){}return e.prototype.getName=function(){return"AdjustmentsShader"},e.prototype.getUniformNames=function(e){return y7},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return S7},e.prototype.getShaderFunctionBody=function(e){return D7},e.prototype.onBeforeBabylonRender=function(e,t){},e}(),x7=function(e){return e.children,Ul(Object(s.useMemo)(function(){return new I7},[])),null},C7=function(e){var t=e.children;return c.a.createElement(c.a.Fragment,null,t,c.a.createElement(x7,null))},O7=function(){function e(){this.enabledAsFloat=0}return e.prototype.setEnabled=function(e){this.enabledAsFloat=e?1:0},e.prototype.getName=function(){return"FakeMipMapEffectShader"},e.prototype.getUniformNames=function(e){return[]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return e(" //FakeMipMapEffectShader---\n    #define ".concat(il))},e.prototype.getShaderFunctionBody=function(e){return""},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(Xd),this.enabledAsFloat)},e}(),w7=c.a.memo(function(e){var t=e.zoomLevel,n=Object(s.useMemo)(function(){return new O7},[]);Ul(n);var a=Object(s.useContext)(Ld).shouldUseFakeMipMaps&&t<.3333333333333333;return n.setEnabled(a),wl(a),null});w7.displayName="FakeMipMapsEffect";var E7=Object(ee.connect)(function(e){return{zoomLevel:Kp(e)}})(w7);function A7(e){var t=e.toString();return t.includes(".")?t:t+"."}var L7="uCursorScreenPos@",k7="uEnabled@",M7="uCursorRadius@",P7=A7(20),T7=A7(60),U7=function(){function e(){this._cursorScreenPosition={x:0,y:0},this._enabled=!1,this._cursorRadiusInScreenPixels=20}return e.prototype.setCursorScreenPosition=function(e){this._cursorScreenPosition=e},e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.setCursorRadiusInScreenPixels=function(e){this._cursorRadiusInScreenPixels=e},e.prototype.getName=function(){return"REMOVE_MARKUP_NEAR_CURSOR_SHADER_NAME"},e.prototype.getUniformNames=function(e){return[e(L7),e(k7),e(M7)]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n        //RemoveMarkupNearCursorShader effect---\n        uniform vec2 ".concat(L7,";\n        uniform float ").concat(k7,";\n        uniform float ").concat(M7,";\n    "))},e.prototype.getShaderFunctionBody=function(e){return e("\n        // RemoveMarkupNearCursorShader effect---\n        if(".concat(k7," > 0.){\n          float distance@ = distance(").concat(L7,", ").concat(Nd,");\n          overlayTextureAlphaOverride = \n              smoothstep(").concat(M7," + ").concat(P7,",\n                         ").concat(M7," + ").concat(T7,", \n                         distance@);\n        }\n    "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat2(t(L7),this._cursorScreenPosition.x,this._cursorScreenPosition.y),e.setFloat(t(k7),this._enabled?1:0),e.setFloat(t(M7),this._cursorRadiusInScreenPixels)},e}(),F7=Object(ee.connect)(function(e){return{cursorScreenPosition:jp(e),isSpotFixCursorVisible:zp(e),cursorRadiusInScreenPixels:Bp(e)}})(function(e){var t=e.cursorScreenPosition,n=e.isSpotFixCursorVisible,a=e.cursorRadiusInScreenPixels,i=Object(s.useMemo)(function(){return new U7},[]);return i.setCursorScreenPosition(t),Al(t),i.setEnabled(n),wl(n),i.setCursorRadiusInScreenPixels(a),wl(a),Ul(i),null}),H7="uEnabled@",R7=function(){function e(){this._enabled=!1}return e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.getName=function(){return"SpotFixRadiusChangingShader"},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return e("\n      //SpotFixRadiusChangingShader effect---\n     uniform float ".concat(H7,";\n     "))},e.prototype.getUniformNames=function(e){return[e(H7)]},e.prototype.getShaderFunctionBody=function(e){return e("\n    //SpotFixRadiusChangingShader effect---\n    if(".concat(H7," > 0.&& ").concat(Jd," == 0.){\n      vec4 result = gl_FragColor.rgba;\n      result.rgb *= 0.5;\n      gl_FragColor =result;\n    }\n  "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(H7),this._enabled?1:0)},e}(),N7=Object(ee.connect)(function(e){return{spotFixCursorRadiusIsChanging:e.spotFixUi.spotFixCursorRadiusIsChanging}})(function(e){var t=e.spotFixCursorRadiusIsChanging,n=Object(s.useMemo)(function(){return new R7},[]);return n.setEnabled(t),Ul(n),null}),B7=function(){function e(){this._level=.5,this._contrastStretchingParams={alpha:1,beta:0}}return e.prototype.setContrastStretchingParams=function(e){this._contrastStretchingParams=e},e.prototype.setLevel=function(e){this._level=e},e.prototype.getName=function(){return"AutoEnhanceShader"},e.prototype.getUniformNames=function(e){return[e("uLevel@"),e("uContrastStretchingParams@"),e("uEnhanceAlgorithm@"),e("uEqualizationCoefficient@")]},e.prototype.getFunctions=function(e){return[Td,Pd]},e.prototype.getHeaderCode=function(e){return e("\n          //AutoEnhance effect---\n          uniform float uLevel@;\n          uniform vec2 uContrastStretchingParams@;\n          uniform int uEnhanceAlgorithm@;\n          uniform float uEqualizationCoefficient@;\n          ")},e.prototype.getShaderFunctionBody=function(e){return e("\n    {\n        //AutoEnhance effect---  \n        if (uLevel@ > 0.0) {\n          vec3 hsv = rgb2hsv(gl_FragColor.rgb);\n          float origGrey = hsv[2];\n          \n          float enhancedGrey_CS = (origGrey * uContrastStretchingParams@.x) + uContrastStretchingParams@.y;\n          enhancedGrey_CS = min(enhancedGrey_CS, 1.0);\n\n          // Increase Saturation a bit\n          hsv[1] = min(1.0, hsv[1] * 1.07);\n\n          vec3 enhancedRGB_CS = hsv2rgb(vec3(hsv[0], hsv[1], enhancedGrey_CS));\n          gl_FragColor.rgb = mix(gl_FragColor.rgb, enhancedRGB_CS, uLevel@); \n        }\n    }\n      ")},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t("uLevel@"),this._level),e.setFloat2(t("uContrastStretchingParams@"),this._contrastStretchingParams.alpha,this._contrastStretchingParams.beta)},e}(),j7=Object(ee.connect)(function(e){var t=e.autoEnhance,n=t.isAutoEnhanceOn,a=t.contrastStretchingParams,i=t.level,r=t.waitingForAutoEnhanceLayer;return{level:R6({transformTools:e.transformTools,uiState:e.uiState})||!n||r?0:i,contrastStretchingParams:a}})(function(e){var t=e.level,n=e.contrastStretchingParams,a=Object(s.useMemo)(function(){return new B7},[]);return a.setContrastStretchingParams(n),a.setLevel(t),wl(n),wl(t),Ul(a),null}),V7={defName:al,levelUniformName:Wd,mapNormalizedToShaderValue:function(e){return e}},z7=Object(ee.connect)(function(e){var t=e.autoEnhance,n=t.level,a=t.isAutoEnhanceOn,i=t.waitingForAutoEnhanceLayer;return{alpha:R6({transformTools:e.transformTools,uiState:e.uiState})||!a||i?0:n}})(function(e){var t=e.alpha,n=void 0===t?0:t,a=Object(s.useContext)(Ld).textures;return(null==a?void 0:a.blend)||(n=0),e6(V7,n),null}),G7="SecondaryOverlayShader",K7=function(){function e(){this._overlayAlpha=1}return e.prototype.setOverlayAlpha=function(e){this._overlayAlpha=e},e.prototype.getOverlayAlpha=function(){return this._overlayAlpha},e.prototype.getName=function(){return G7},e.prototype.getUniformNames=function(e){return[e(Qd)]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return e(" //SecondaryOverlay effect---\n    uniform sampler2D ".concat(qd,";\n    uniform float ").concat(Qd,";\n    "))},e.prototype.getShaderFunctionBody=function(e){var t=Qd;return e("//SecondaryOverlay effect---\n    {\n      if(".concat(t," > 0.){\n        vec4 overlayColor = texture2D(").concat("secondaryOverlayTextureSampler",", ").concat("uv",".xy);\n        if(overlayColor.a > 0.){\n          float overlayBlendedAlpha = overlayColor.a + gl_FragColor.a * (1. - overlayColor.a);\n          vec4 overlayBlendedColor = vec4((overlayColor.rgb * overlayColor.a + gl_FragColor.rgb * gl_FragColor.a * (1. - overlayColor.a)) / overlayBlendedAlpha, overlayBlendedAlpha);\n          gl_FragColor = mix(gl_FragColor, overlayBlendedColor, ").concat(t,"*overlayTextureAlphaOverride);\n        }\n      }\n    }\n    "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(Qd),this._overlayAlpha)},e}(),W7=function(e){var t=e.alpha,n=Object(s.useMemo)(function(){return new K7},[]);return n.setOverlayAlpha(t),wl(t),Ul(n),null},q7=Object(s.memo)(function(e){var t=e.disable?0:1;return c.a.createElement(W7,{alpha:t})}),Q7=Object(ee.connect)(function(e){var t=R6({transformTools:e.transformTools,uiState:e.uiState}),n=e.uiState,a=n.waitingForActiveEditorActivityToComplete,i=n.activeEditorActivity;return{disable:t||a&&i===io}})(q7),Y7="uMaskLevel@",J7=function(){function e(){this._maskLevel=0}return e.prototype.setMaskLevel=function(e){this._maskLevel=e},e.prototype.getMaskLevel=function(){return this._maskLevel},e.prototype.getName=function(){return"SecondaryMaskShader"},e.prototype.getUniformNames=function(e){return[e(Y7)]},e.prototype.getFunctions=function(){return[]},e.prototype.getHeaderCode=function(e){return e(" //SecondaryMask effect---\n    uniform sampler2D ".concat(Yd,";\n    uniform float ").concat(e(Y7),";\n    "))},e.prototype.getShaderFunctionBody=function(e){var t=e(Y7);return e("//SecondaryMask effect---\n    {\n      if(".concat(t," != 0.)\n      {\n        vec4 maskColor = texture2D(").concat("uMaskTextureSampler",", ").concat("uv",".xy);\n        float maskLevel = ").concat(t," * maskColor.b;\n        \n        //TODO: should be able to re-use value, rather than sampling the texture again.\n        vec4 originalImageColor = sampleTexture(").concat(Hd,", ").concat("uv",".xy);\n        \n        if(").concat(t," >= 0.)\n        {\n          //positive mask\n          gl_FragColor = mix( gl_FragColor, originalImageColor, 1. - maskLevel );\n        }\n        else\n        {\n          //negative / inverted mask.\n          gl_FragColor = mix( gl_FragColor, originalImageColor, -maskLevel );\n        }\n      }\n    }\n    "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(Y7),this._maskLevel)},e}(),X7=Object(ee.connect)(function(e){return{maskLevel:e.colorAdjustments.maskLevel}})(function(e){var t=e.maskLevel,n=Object(s.useMemo)(function(){return new J7},[]);return n.setMaskLevel(t),wl(t),Ul(n),null}),Z7=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},$7="MaskLayerVisualizationShader",eS=[1,0,0,.5],tS=[0,0,0,0],nS=function(){function e(){this._maskVisualizationColor=Z7([],eS,!0)}return e.prototype.setEnabled=function(e){this._maskVisualizationColor=Z7([],e?eS:tS,!0)},e.prototype.getName=function(){return $7},e.prototype.getUniformNames=function(e){return[]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n        //".concat($7,"---\n        uniform vec4 ").concat(Zd,";\n        "))},e.prototype.getShaderFunctionBody=function(e){var t=Zd;return e("\n    //".concat($7,"---\n    if(").concat(t,".a > 0.  && ").concat(Jd," == 0.)\n    {\n      vec4 maskTextureColor = texture2D(").concat("uMaskTextureSampler",", ").concat("uv",".xy);\n      gl_FragColor = mix( gl_FragColor, ").concat(t,", maskTextureColor.a * ").concat(t,".a );\n    }\n    "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat4.apply(e,Z7(["uMaskVisualizationColor"],this._maskVisualizationColor,!1))},e}(),aS=Object(s.memo)(function(e){var t=e.enabled,n=Object(s.useMemo)(function(){return new nS},[]);return n.setEnabled(t),wl(t),Ul(n),null}),iS=Object(ee.connect)(function(e){var t=e.uiState.activeEditorActivity,n=e.inPaintingUi.algorithmParameters.maskType;return{enabled:t===oo&&n===Ih.FromMaskLayer}})(aS),rS=c.a.memo(function(e){var t=e.isAutoEnhanceOn,n=e.setAutoEnhanceParameters,a=ch(),i=Object(s.useContext)(lh).image;return Object(s.useEffect)(function(){if(t){var e=function(e,t,n){var a=im(e).main;if(!a)throw Error("Image is null");var i=km(a);if(void 0===i)throw new Error("No oriented size for image");var r={width:i.x,height:i.y,top:0,left:0};return tm(a)?{bytes:new Uint8ClampedArray(a.bytes.buffer,a.bytes.byteOffset,a.bytes.buffer.byteLength),format:a.format}:t(a,r)}(i,a),r=e.format===Xp.RGBA?4:3,o=e.bytes.byteLength/r,s=function(e,t,n){var a=function(e,t,n){for(var a=0,i=e.length,r=.011*n,o=0,s=0;s<e.length;s++)if((o+=e[s])>r){a=s;break}for(o=0,s=e.length-1;s>=0;s--)if((o+=e[s])>r){i=s;break}return{lowThreshold:a,highThreshold:i}}(e,0,n),i=a.lowThreshold,r=a.highThreshold-i,o=255/(r=Math.max(r,1));return{alpha:o,beta:-o*i/384}}(oS(e,o),0,o),c=s.alpha,d=s.beta;n({alpha:c,beta:d})}},[t,i,a,n]),null}),oS=function(e,t){var n=1e7,a=e.format===Xp.RGBA?4:3,i=e.bytes,r=a;t>n&&(r*=Math.ceil(t/n));for(var o=new Array(256).fill(0),s=0;s+2<i.length;s+=r)o[Math.max(i[s],i[s+1],i[s+2])]++;return o},sS={setAutoEnhanceParameters:cb},cS=Object(ee.connect)(function(e){return{isAutoEnhanceOn:e.autoEnhance.isAutoEnhanceOn}},sS)(rS),dS=c.a.memo(function(){var e=Object(s.useContext)(dh),t=e.enableAdjustments,n=e.enableFilters,a=e.enableSpotFix,i=e.experimental_enableMaskLayer,r=e.enableAutoEnhance,o=e.useBuiltInAutoEnhance;return c.a.createElement(c.a.Fragment,null,c.a.createElement(p7,null),c.a.createElement(E7,null),n&&c.a.createElement(N6,null),t&&c.a.createElement(c.a.Fragment,null,c.a.createElement(C7,null,c.a.createElement(d7,null),c.a.createElement(i6,null),c.a.createElement(O6,null),c.a.createElement(S6,null),c.a.createElement(W6,null),c.a.createElement(V6,null)),c.a.createElement(Z6,null)),a&&c.a.createElement(c.a.Fragment,null,c.a.createElement(F7,null),c.a.createElement(N7,null)),r&&(o?c.a.createElement(c.a.Fragment,null,c.a.createElement(cS,null),c.a.createElement(j7,null)):c.a.createElement(z7,null)),i&&c.a.createElement(c.a.Fragment,null,c.a.createElement(X7,null),c.a.createElement(iS,null)),c.a.createElement(Q7,null),c.a.createElement(o6,null),c.a.createElement(L6,null))});function lS(){return n.e(3).then(n.bind(null,"H3kl"))}var uS=function(){return uS=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},uS.apply(this,arguments)},fS=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},pS=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},mS=Object(s.memo)(function(e){var t=e.filters,n=e.children,a=function(e,t){var n=Object(s.useContext)(dh).enableFilters,a=Rm(),i=Object(s.useState)({}),r=i[0],o=i[1],c=Object(s.useCallback)(function(){lS().then(function(e){var t=e.defaultLutUrlDictionary;o(t)}).catch(function(e){return a({id:"CodeSplitFailed",message:"Failed to load LUT data URLs"})})},[a]),l=function(e,t,n,a){var i=this,r=Object(s.useState)({}),o=r[0],c=r[1],l=Rm(),u=Object(s.useCallback)(function(e){return fS(i,void 0,void 0,function(){var n;return pS(this,function(a){switch(a.label){case 0:return[4,d(e)];case 1:return n=a.sent(),[2,new Promise(function(a,i){t&&t.getTexture(n,function(t){a(uS(uS({},t),{url:e}))},Pm.lut,!1,function(e){var t={id:"CreateLutThumbnailTextureFailed",message:"LutThumbnailTexture: "+e.message};l(t),i()},1)})]}})})},[l,t]),f=Object(s.useCallback)(function(e){return null==t?void 0:t.releaseTexture(e)},[t]);return Object(s.useEffect)(function(){if(e&&n.length>0){var t=!0,r=[],o=mm(n,function(e){return fS(i,void 0,void 0,function(){var n;return pS(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),E_(e)&&a[e.lutUrlId]?[4,u(a[e.lutUrlId])]:[3,2];case 1:if(n=i.sent(),t)return r.push(n.id),[2,n];f(n.id),i.label=2;case 2:return[3,4];case 3:return i.sent(),[3,4];case 4:return[2]}})})}),s=o.promise,d=o.cancel;return s.then(function(e){if(t){var n={};e.forEach(function(e){return e&&(n[e.url]=e.texture)}),c(n)}},function(){}),function(){d(),t=!1,r.forEach(function(e){return f(e)}),r=[],c({})}}},[n,e,u,f,a]),o}(n,e,t,r);return Object(s.useMemo)(function(){return{textures:l,urlsById:r,loadUrls:c}},[l,r,c])}(Object(s.useContext)(gl).textures,t);return c.a.createElement(k6.Provider,{value:a},n)}),_S=Object(ee.connect)(function(e){return{filters:e.filters.availableFilters}})(mS),hS=function(e){return e.toFixed(0)};function bS(e){var t=Object(s.useContext)(Ze).strings;return function(n,a,i){e("Original"!==n?vt(t.filter_changedAriaLiveWithIntensity,a,i):vt(t.filter_changedAriaLive,a))}}var gS=function(){return gS=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},gS.apply(this,arguments)};function vS(e){return Math.round(tn(0,100,e))}var yS=Object(s.memo)(function(e){var t,n=e.filterLevel,a=e.title,i=e.setFilterLevel,r=e.layout,o=e.headerName,d=e.ariaLabel,l=e.style,f=e.hideSliderValueAfterInactivity,p=e.filterName,m=e.filterAriaLabelLocString,_=e.setAriaAnnouncement,h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["filterLevel","title","setFilterLevel","layout","headerName","ariaLabel","style","hideSliderValueAfterInactivity","filterName","filterAriaLabelLocString","setAriaAnnouncement"]),b=$(),g=100,v=hS,y=Object(s.useContext)(Ze).localizeNumber,S=Object(s.useState)(!1),D=S[0],I=S[1],x=bS(_),C=Object(s.useCallback)(function(e){var t=nn(0,g,e);I(!0),i({level:t,isUndoRedoable:!1})},[0,g,i]),O=Object(s.useMemo)(function(){return vS(n)},[n]),w=Object(s.useMemo)(function(){var e;return Object(u.concatStyleSets)(bt(b),null===(e=null==l?void 0:l.getSliderStyles)||void 0===e?void 0:e.call(l,b))},[l,b]),E={value:O,valueFormatter:v,maxValue:g,minValue:0,label:o,shouldShow:D||!f};return c.a.createElement("div",{className:null==l?void 0:l.containerClassName,style:null==l?void 0:l.container},c.a.createElement(sn,{headerProps:E,layout:r,styles:null===(t=null==l?void 0:l.getSliderHeaderStyles)||void 0===t?void 0:t.call(l,b)}),c.a.createElement("div",{style:null==l?void 0:l.sliderWrapper},c.a.createElement(ht,gS({},h,{min:0,max:g,step:1,value:O,styles:w,showValue:!1,originFromZero:!0,onChange:C,"aria-label":d,ariaValueText:y,onChanged:function(e,t){I(!1);var n=nn(0,g,t);i({level:n,isUndoRedoable:!0}),x(p,m,t.toString())},buttonProps:{title:a}}))))});Object($e.loadStyles)([{rawString:".imageTileContainer_29808faa{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:8px;width:-webkit-min-content;width:-moz-min-content;width:min-content}.imageTileContainer_29808faa .tile_29808faa{position:relative;background-color:transparent;background-size:cover;background-repeat:no-repeat;background-position:center;height:93px;width:93px;border-radius:3px;margin:8px 0}.imageTileContainer_29808faa .tile_29808faa .background_29808faa{position:absolute;top:0;height:100%;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;opacity:0;font-size:23px;border-radius:3px}.imageTileContainer_29808faa .tileName_29808faa{font-size:12px;line-height:14px;text-align:center;word-break:break-word;word-wrap:break-word;pointer-events:auto}.tileIcon_29808faa{fill:white;font-size:24px;width:24px;height:24px}.ms-Fabric--isFocusHidden .imageTileContainer_29808faa .ms-Tile-link{outline:0;height:100%}.ms-Fabric--isFocusVisible .imageTileContainer_29808faa .ms-Tile-link:focus{outline-color:inherit;outline-width:1px;outline-style:solid}"}]);var SS=function(){return SS=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},SS.apply(this,arguments)};function DS(e){return{width:"100%",height:"100%",backgroundColor:e.palette.neutralQuaternary,color:e.palette.black,activeBackgroundOverride:{opacity:1}}}function IS(e,t,n,a){return SS(SS(SS(SS({},a),e&&(null==a?void 0:a.highlightImageOverride)),t&&(null==a?void 0:a.activeImageOverride)),n&&(null==a?void 0:a.disabledImageOverride))}var xS=function(){return xS=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},xS.apply(this,arguments)},CS=Object(s.forwardRef)(function(e,t){var n=e.image,a=e.imageTileStyles,i=e.name,r=e.ariaLabel,o=e.ariaSelected,d=e.isHighlighted,l=e.isActive,f=e.isDisabled,p=void 0!==f&&f,m=e.role,_=void 0===m?"option":m,h=e.tabIndex,b=void 0===h?0:h,g=e.containerRef,v=e.onClick,y=e.onKeyDown,S=e.title,D=$(),I=Object(s.useState)(null),x=I[0],C=I[1],O=Object(s.useCallback)(function(e){v(i,e)},[i,v]);Object(s.useLayoutEffect)(function(){x&&(x.tabIndex=b,x.setAttribute("role",_),x.setAttribute("aria-selected",String(o)))},[o,x,_,b]),Object(s.useImperativeHandle)(t,function(){return{focus:function(){return null==x?void 0:x.focus()}}},[x]);var w=Object(s.useMemo)(function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"background_29808faa",style:x2(d,l,p,xS(xS({},DS(D)),null==a?void 0:a.background))},c.a.createElement($t.FontIcon,{iconName:"ActiveFilterCheckmark-Havana",className:"tileIcon_29808faa",style:null==a?void 0:a.icon})),!n&&c.a.createElement(u.Shimmer,{theme:D,shimmerElements:[{type:u.ShimmerElementType.line,width:93,height:93}]}))},[n,a,l,p,d,D]),E=Object(s.useMemo)(function(){return c.a.createElement("span",{className:"tileName_29808faa",style:C2(l,p,null==a?void 0:a.name),"aria-hidden":"true",onClick:p?void 0:O},i)},[null==a?void 0:a.name,l,p,i,O]);return c.a.createElement("div",{className:"imageTileContainer_29808faa",style:null==a?void 0:a.container,ref:g,"data-test-id":n?"image-tile-image-loaded":"image-tile-image-loading"},c.a.createElement(m2,{style:xS(xS({backgroundImage:l?"":"url(".concat(n,")")},IS(d,l,p,null==a?void 0:a.image)),{outlineColor:D.palette.neutralDark}),className:"tile_29808faa",background:w,ariaLabel:r,linkRef:C,onKeyDown:y,"data-test-id":"imageTile-".concat(i),onClick:p?void 0:O,title:S}),E)});function OS(e,t,n,a){return e===t?"Original"===t.name?n.filter_activeOriginalFilterAriaLabel:vt(n.filter_activeTileAriaLabel,n[e.ariaLabelLocStringKey],vS(a[e.name]).toString()):"Original"===t.name?vt(n.filter_tileAriaLabelWhenOriginalFilterIsSelected,n[e.ariaLabelLocStringKey]):vt(n.filter_tileAriaLabel,n[e.ariaLabelLocStringKey],n[t.ariaLabelLocStringKey],vS(a[t.name]).toString())}var wS=function(){return wS=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},wS.apply(this,arguments)};function ES(e){return e.getEffects().find(function(e){return e.getName()===F6})}var AS=function(e,t){var n=void 0,a=e.getEffects().find(function(e){return e.getName()===G7});return a&&(n=a.getOverlayAlpha(),a.setOverlayAlpha(t)),function(){a&&a.setOverlayAlpha(null!=n?n:0)}},LS=function(){return LS=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},LS.apply(this,arguments)},kS=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},MS=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object($e.loadStyles)([{rawString:".bodyContainer_8740aa0f{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:24px 0}.bodyContainer_8740aa0f .rowContainer_8740aa0f{width:100%}.bodyContainer_8740aa0f .row_8740aa0f{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.bodyContainer_8740aa0f .lastRowWithFewerItems_8740aa0f{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}"}]);var PS=Object(s.memo)(function(e){var t=e.availableFilters,n=e.activeFilter,a=e.filterLevelsByName,i=e.setActiveFilterAndLevel,r=e.setAriaAnnouncement,o=e.size,d=e.styles,l=e.header,u=e.footer,f=e.imageTransformValues,p=e.cropTransformValues,m=e.cssToPhysicalPixelRatio,_=e.children,h=e.colorAdjustments,b=Object(s.useState)(t.length),g=b[0],v=b[1],y=Object(s.useMemo)(function(){return t.map(function(){return Object(s.createRef)()})},[t]),S=Object(s.useRef)(new Array(t.length)),D=bS(r),I=_y(t,n,g),x=I.keyboardFocusedIndex,C=I.setKeyboardFocusedIndex,O=I.onKeyDown,w=Object(s.useContext)(Ze).strings,E=w,A=Object(s.useCallback)(function(e){i({activeFilter:n,filterLevel:e.level,isUndoRedoable:e.isUndoRedoable})},[n,i]),L=Object(s.useCallback)(function(e,t){i({activeFilter:e,filterLevel:a[e.name],isUndoRedoable:!0}),D(e.name,E[e.ariaLabelLocStringKey],vS(a[e.name]).toString()),C(t)},[i,a,D,E,C]);Object(s.useLayoutEffect)(function(){for(var e,t,n,a=0;a<y.length;a++){var i=null===(t=null===(e=y[a])||void 0===e?void 0:e.current)||void 0===t?void 0:t.getBoundingClientRect();if(n&&i&&n.top<i.top)return void v(a);n=i}v(y.length)},[y]),Object(s.useLayoutEffect)(function(){var e;S.current&&(null===(e=S.current[x])||void 0===e||e.focus())},[x]);var k=function(e,t,n,a,i,r,o){var c=this,d=Object(s.useState)([]),l=d[0],u=d[1],f=Object(s.useContext)(lh),p=f.image,m=f.offscreenRenderer,_=Rm();return Object(s.useEffect)(function(){var i=!1,r=mm(e,function(e){return kS(c,void 0,void 0,function(){var r,o,s,c;return MS(this,function(d){switch(d.label){case 0:return r=void 0,o=function(e){return am(e)?$p($p({},e),{overlay:null}):$p($p({},{main:null,blend:null,overlay:null,mask:null}),{main:e})}(p),m&&o?(s=function(t,n){return function(e,t,n,a,i,r,o){var s=function(e,t){return function(e,t,n){var a=void 0,i=e.getEffects().find(function(e){return"ENABLE_SECONDARY_BLEND"===e.getName()});return i&&(a=i.getLevel(),i.setLevel(t)),function(){i&&i.setLevel(null!=a?a:0)}}(e,t)}(e,a),c=function(e,t,n,a,i,r){var o=void 0,s=void 0,c=void 0,d=ES(e);try{d&&(o=d.getLevel(),s=d.getTexture(),c=d.getConfiguration(),function(e,t,n,a,i){if(E_(a)&&i){var r=t[n[a.lutUrlId]];if(!r||1!==r.parts.length)throw new Error("support is only available for filters from list of default filters");e.setTexture(r.parts[0].texture),e.setConfiguration(a.config),e.setLevel(i)}else e.setLevel(0)}(d,i,r,t,n))}catch(e){a({id:"FilterTextureNotFound",message:"Failed to apply the default filter during offscreen render: ".concat(e," ")})}return function(){d&&c&&(d.setLevel(null!=o?o:0),d.setTexture(s),d.setConfiguration(c))}}(e,t,n,r,o.lutTextures,o.lutUrlsById),d=AS(e,i);return function(){s(),c(),d()}}(t,e,1,0,0,_,n)},[4,_m()]):[3,4];case 1:return d.sent(),i?[3,4]:[4,m.getEditedImage(o,LS({},(l=qr(t),u=vi(n),f={width:Math.floor(93*a),height:Math.floor(93*a)},h=f.width/u.width,b=f.height/u.height,g=Math.max(h,b),v={left:0,top:0,width:f.width,height:f.height},{imageTransform:{width:l.width*g,height:l.height*g,x:v.width-(v.width/2+g*u.width/2)-u.left*g+l.x*g,y:v.height-(v.height/2+g*u.height/2)-u.top*g+l.y*g,rotation:l.rotation},cropRectangle:v})),s)];case 2:return c=d.sent(),[4,_m()];case 3:d.sent(),r=null==c?void 0:c.toDataURL(),d.label=4;case 4:return[2,{name:e.name,src:r}]}var l,u,f,h,b,g,v})})}),o=r.promise,s=r.cancel;return kS(c,void 0,void 0,function(){var e;return MS(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,o];case 1:return e=t.sent(),i||u(e),[3,3];case 2:return t.sent(),u([]),[3,3];case 3:return[2]}})}),function(){s(),i=!0}},[e,n,a,_,93,p,t,m,93,i]),l}(t,f,p,m,h),M=function(e,t,n,a,i,r,o,d,l,u,f,p,m){var _=Object(s.useContext)(Ze).strings,h=Object(s.useCallback)(function(a,s){var p,h=n.find(function(e){return a.name===e.name}),b=(null==d?void 0:d.name)===a.name?0:-1;return c.a.createElement(CS,{key:a.name,image:null!==(p=null==h?void 0:h.src)&&void 0!==p?p:"",onClick:function(){r(a,s)},isActive:e.name===a.name,isHighlighted:!1,name:_[a.locStringKey],ariaLabel:OS(a,e,_,i),ariaSelected:e.name===a.name,imageTileStyles:wS(wS({},o),{image:wS({width:93,height:93},null==o?void 0:o.image),container:null==o?void 0:o.container}),tabIndex:b,onKeyDown:l,containerRef:t[s],ref:function(e){u&&u.current&&(u.current[s]=e)},role:f,title:m})},[n,void 0,null==d?void 0:d.name,e,_,i,o,93,l,t,f,m,r,u]);return h}(n,y,k,0,a,L,null==d?void 0:d.imageTile,t[x],O,S,"option"),P=vt(w.filter_sliderTooltip,E[n.ariaLabelLocStringKey]),T=t.map(M).map(function(e,n){return c.a.createElement("div",{ref:y[n],key:t[n].name,style:null==d?void 0:d.filterTile},e)}).reduce(function(e,t){return g&&e[e.length-1].length&&e[e.length-1].length===g&&e.push([]),e[e.length-1].push(t),e},[[]]).map(function(e,t,i){var o=i.length-1===t&&e.length!==i[0].length;return c.a.createElement("div",{key:t,className:"rowContainer_8740aa0f"},c.a.createElement("div",{className:"".concat("row_8740aa0f"," ").concat(o?"lastRowWithFewerItems_8740aa0f":""),style:null==d?void 0:d.row},e),function(e){return E_(n)&&!!e.find(function(e){return e.props.children.props.isActive})}(e)&&c.a.createElement(yS,{key:n.name,style:null==d?void 0:d.slider,filterLevel:a[n.name],setFilterLevel:A,layout:"Labeled",headerName:E.filter_intensitySliderHeader,ariaLabel:vt(E.filter_intensitySliderAriaLabelFormatString,E[n.ariaLabelLocStringKey],P),title:P,filterName:n.name,filterAriaLabelLocString:E[n.ariaLabelLocStringKey],setAriaAnnouncement:r}))});return c.a.createElement(tt,{size:o,styles:d,header:l,footer:u},_,c.a.createElement("section",{"aria-label":w.filter_filtersAriaLandmark},c.a.createElement("div",{className:"bodyContainer_8740aa0f",style:null==d?void 0:d.bodyContainer,role:"listbox",title:E.filter_listTitle},T)))}),TS={undoReducer:function(e,t){var n;e.undoRedoStack.redoStack.push(t),e.activeFilter=t.undoPayload.activeFilter,e.filterLevel=t.undoPayload.filterLevel,e.filterLevelsByName[t.undoPayload.activeFilter.name]=null!==(n=t.undoPayload.filterLevel)&&void 0!==n?n:1},redoReducer:function(e,t){var n;e.undoRedoStack.undoStack.push(t),e.activeFilter=t.redoPayload.activeFilter,e.filterLevel=t.redoPayload.filterLevel,e.filterLevelsByName[t.redoPayload.activeFilter.name]=null!==(n=t.redoPayload.filterLevel)&&void 0!==n?n:1},removeItemsReducer:function(e,t){e.undoRedoStack.undoStack=t},collapseItemsReducer:function(e,t,n){e.undoRedoStack.undoStack=e.undoRedoStack.undoStack.filter(function(e){return e.sequence!==t.payload.start&&e.sequence!==t.payload.end}),e.undoRedoStack.undoStack.push(n)}},US={Original:"filterOriginal",Punch:"filterPunch",Golden:"filterGolden",Radiate:"filterRadiate","Warm Contrast":"filterWarmContrast",Calm:"filterCalm","Cool Light":"filterCoolLight","Vivid Cool":"filterVividCool","Dramatic Cool":"filterDramaticCool",BW:"filterBW","BW Cool":"filterBWCool","BW Warm":"filterBWWarm","BW High Contrast":"filterBWHighContrast",Burn:"filterBurn",Film:"filterFilm",Vintage:"filterVintage"},FS=Object(te.n)({name:"filters",initialState:w_,reducers:{setActiveFilterAndLevel:function(e,t){!function(e,t){var n,a=t.payload,i=a.activeFilter,r=a.filterLevel;e.undoPayload||(e.undoPayload={activeFilter:e.activeFilter,filterLevel:e.filterLevel});var o={activeFilter:i,filterLevel:r};if(e.activeFilter=i,e.filterLevel=r,e.filterLevelsByName[i.name]=null!=r?r:1,He(e.undoPayload,o)&&t.payload.isUndoRedoable){var s=ge(null!==(n=US[t.payload.activeFilter.name])&&void 0!==n?n:"customFilter",e.undoPayload,o,Le.KeepAll);e.undoRedoStack.undoStack.push(s),e.undoPayload=void 0}}(e,t)}},extraReducers:function(e){e.addCase(se,function(e,t){return w_}).addCase(ce,function(e,t){var n=t.payload.filters,a=n.activeFilter,i=n.filterLevel,r=n.undoRedoStack;a&&(e.activeFilter=a),void 0!==i&&(e.filterLevel=i),a&&i&&(e.filterLevelsByName[a.name]=null!=i?i:1),r&&(e.undoRedoStack=r)}),Se(e,TS)}}),HS=FS.actions.setActiveFilterAndLevel,RS=FS.reducer,NS={setActiveFilterAndLevel:HS,setAriaAnnouncement:Jn},BS=Object(ee.connect)(function(e){var t=e.filters;return{availableFilters:t.availableFilters,activeFilter:t.activeFilter,filterLevelsByName:e.filters.filterLevelsByName,cropTransformValues:e.transformTools.cropInteraction.uvToWorld,imageTransformValues:e.transformTools.image._preciseUvToWorld,cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,colorAdjustments:e.colorAdjustments}},NS)(PS);Object($e.loadStyles)([{rawString:".right_pane_b7fef646{width:390px;overflow-y:auto;-ms-overflow-style:none;overflow:-moz-scrollbars-none;scrollbar-width:none}.right_pane_b7fef646::-webkit-scrollbar{display:none}"}]);var jS=function(){return jS=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},jS.apply(this,arguments)},VS=Object(s.memo)(function(e){var t=e.theme,n=e.styles,a=e.className,i=e.children,r={backgroundColor:t.palette.neutralLighterAlt,borderLeft:"".concat(t.palette.neutralQuaternary," 1px solid")},o=jS(jS({},r),n);return c.a.createElement("div",{className:"right_pane_b7fef646"+" ".concat(a),style:o},i)});Object($e.loadStyles)([{rawString:".autoEnhanceContainer_a4a3f91b{margin:30px 16px 0 16px}.autoEnhanceButton_a4a3f91b{width:100%;min-height:60px;height:auto;overflow-wrap:break-word;padding:9px 12px;border-radius:2px}"}]);var zS="autoEnhanceButton_a4a3f91b",GS={root:{height:"48px",border:"none"},rootHovered:{border:"none"},rootPressed:{border:"none"},textContainer:{flexGrow:0},label:{fontSize:"14px",lineHeight:"20px",fontWeight:"400"}};function KS(e,t){if(t)return GS;var n={root:{color:e.palette.black,backgroundColor:e.palette.neutralQuaternaryAlt},rootHovered:{color:e.palette.black,backgroundColor:e.palette.neutralQuaternaryAlt,opacity:.9},rootPressed:{color:e.palette.neutralSecondary,backgroundColor:e.palette.neutralLighter},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:e.palette.neutralLighter}};return Object(u.concatStyleSets)(GS,n)}var WS=Object(s.memo)(function(e){var t,n=e.level,a=e.isAutoEnhanceOn,i=e.isTexturePatchAppliedBeforeAutoEnhanceInstallation,r=e.autoEnhanceInstallationInfo,o=e.styles,d=e.setLevel,l=e.setIsAutoEnhanceOn,f=e.setAriaAnnouncement,p=e.waitingForAutoEnhanceLayer,m=e.setWaitingForAutoEnhanceLayer,_=Object(s.useContext)(Ze),h=_.strings,b=_.localizeNumber,g=Object(s.useContext)(Zt),v=g.logAutoEnhanceRequestedEvent,y=g.logAutoEnhanceInstallRequestedEvent,S=h,D=vt(h.filter_sliderTooltip,h.autoEnhance_name),I=uh("blend"),x=Object(s.useContext)(lh).onRequestAutoEnhanceInstall,C=Object(s.useContext)(dh).useBuiltInAutoEnhance,O=Object(s.useMemo)(function(){return tn(0,100,n)},[n]),w=Object(s.useRef)(O);w.current=O;var E=$(),A=Object(s.useRef)(null),L=Object(s.useCallback)(function(){var e=A.current;if(!e)throw new Error("event not set");v({inputType:Xs(e)}),f(S.autoEnhance_generatingAriaLive)},[v,f,S]),k=Object(s.useCallback)(function(){a&&f(vt(S.autoEnhance_appliedAriaLive,b(w.current)))},[f,b,a,S.autoEnhance_appliedAriaLive]);(function(e,t){var n,a,i=uh("blend");n=Object(s.useCallback)(function(){i||e||t(!1)},[i,e,t]),(a=Object(s.useRef)(n)).current=n,Object(s.useEffect)(function(){return function(){return a.current()}},[])})(C,l),fh(C,a,p,m,L,k);var M=Object(s.useCallback)(function(e){l(!a),A.current=e,(I||C)&&f(a?S.autoEnhance_removedAriaLive:vt(S.autoEnhance_appliedAriaLive,b(w.current)))},[l,a,I,C,f,S.autoEnhance_removedAriaLive,S.autoEnhance_appliedAriaLive,b]),P=a&&!p,T=r.status,U=i||!I&&p,F=function(e,t,n,a){var i=$();return Object(s.useMemo)(function(){var r=KS(i,!1);switch(n){case o_.NotInstalled:return Object(u.concatStyleSets)(r,null==a?void 0:a.autoEnhanceNotInstalledButton);case o_.Installing:return Object(u.concatStyleSets)(r,null==a?void 0:a.autoEnhanceInstallingButton);case o_.Installed:return e&&!t?Object(u.concatStyleSets)(KS(i,!0),null==a?void 0:a.autoEnhanceAppliedButton):Object(u.concatStyleSets)(r,null==a?void 0:a.autoEnhanceNotAppliedButton);case o_.InstallFailed:return Object(u.concatStyleSets)(r,null==a?void 0:a.autoEnhanceInstallFailedButton);case o_.Unavailable:default:return r}},[n,e,t,i,a])}(a,p,T,o),H=function(e,t){var n={root:{background:"transparent"},label:{color:e.palette.neutralTertiary,fontSize:"14px",lineHeight:"20px",fontWeight:"400",margin:"0px 23px"},circle:{borderColor:"".concat(e.palette.themeDarkAlt," rgba(0,0,0,0) rgba(0,0,0,0)")}};return Object(u.concatStyleSets)(n,t)}(E,null==o?void 0:o.spinner),R=function(e){return Object(u.concatStyleSets)({root:{width:"16px",height:"16px",margin:"0px 8px"}},e)}(null==o?void 0:o.icon),N=r.downloadSize;return c.a.createElement("div",{className:"autoEnhanceContainer_a4a3f91b",style:null==o?void 0:o.bodyContainer},T===o_.NotInstalled&&c.a.createElement(u.PrimaryButton,{className:zS,ariaLabel:S.autoEnhance_installTooltip,text:vt(S.autoEnhance_downloadButton,N.toString()),styles:F,iconProps:{iconName:"Download",styles:R},onClick:function(e){null==x||x(),y({inputType:Xs(e)})}}),T===o_.Installing&&c.a.createElement(u.PrimaryButton,{className:zS,text:"",styles:F,disabled:!0,onRenderChildren:function(){return c.a.createElement(u.Spinner,{styles:H,size:u.SpinnerSize.medium,label:vt(S.autoEnhance_downloadingStatus,N.toString()),labelPosition:"right"})}}),T===o_.InstallFailed&&c.a.createElement(u.PrimaryButton,{className:zS,ariaLabel:S.autoEnhance_retryInstallTooltip,text:S.autoEnhance_retryDownloadButton,iconProps:{iconName:"Refresh",styles:R},styles:F,onClick:function(){null==x||x()}}),T===o_.Installed&&c.a.createElement(u.PrimaryButton,{className:zS,ariaDescription:a?S.autoEnhance_appliedTooltip:S.autoEnhance_notAppliedTooltip,ariaLabel:S.autoEnhance_name,role:"toggle",title:i?S.autoEnhance_disabledBySpotFixTooltip:void 0,text:S.autoEnhance_name,styles:F,iconProps:{iconName:null!==(t=null==o?void 0:o.autoEnhanceOnIconName)&&void 0!==t?t:"AutoEnhanceOn",styles:R},disabled:U,allowDisabledFocus:!0,onClick:M}),T===o_.Installed&&P&&c.a.createElement(yS,{key:"autoEnhance",style:null==o?void 0:o.slider,filterLevel:n,setFilterLevel:d,layout:"Labeled",disabled:U,headerName:S.autoEnhance_intensitySliderHeader,ariaLabel:vt(h.adjustment_sliderAriaLabelFormatString,S.autoEnhance_intensitySliderAriaLabel,D),title:D,filterName:"autoEnhance",filterAriaLabelLocString:h.autoEnhance_name,setAriaAnnouncement:f}))}),qS={setLevel:ib,setIsAutoEnhanceOn:rb,setAriaAnnouncement:Jn,setWaitingForAutoEnhanceLayer:ob},QS=Object(ee.connect)(function(e){var t=e.autoEnhance;return{level:t.level,isAutoEnhanceOn:t.isAutoEnhanceOn,waitingForAutoEnhanceLayer:t.waitingForAutoEnhanceLayer,isTexturePatchAppliedBeforeAutoEnhanceInstallation:t.isTexturePatchAppliedBeforeAutoEnhanceInstallation}},qS)(WS);function YS(e,t){var n=e[t];if(!n)throw new Error("Could not find ink brush with id ".concat(t));return{inkBrush:n,id:t}}function JS(e){return e.toString(16).padStart(2,"0")}function XS(e){return[{localizedName:e.markup_colorDarkYellow,hexColor:ls},{localizedName:e.markup_colorLightOrange,hexColor:"#fbae17"},{localizedName:e.markup_colorOrange,hexColor:"#f36323"},{localizedName:e.markup_colorRed,hexColor:"#e3182d"},{localizedName:e.markup_colorDarkPurple,hexColor:"#5b318d"},{localizedName:e.markup_colorPurple,hexColor:"#914bb8"},{localizedName:e.markup_colorMagenta,hexColor:"#cf1278"},{localizedName:e.markup_colorDarkRed,hexColor:"#c10051"},{localizedName:e.markup_colorLightBlue,hexColor:"#3eccfd"},{localizedName:e.markup_colorBlue,hexColor:us},{localizedName:e.markup_colorDarkBlue,hexColor:"#0051ba"},{localizedName:e.markup_colorLightGreen,hexColor:"#7ec400"},{localizedName:e.markup_colorGreen,hexColor:"#00b44b"},{localizedName:e.markup_colorLightGray,hexColor:fs},{localizedName:e.markup_colorGray,hexColor:"#b6b6b6"},{localizedName:e.markup_colorBlack,hexColor:ps}]}function ZS(e){return XS(e).map(function(e,t){var n=++t;return{index:n,id:n.toString(),label:e.localizedName,color:e.hexColor}})}function $S(e,t){var n=t.cssThicknesses,a=n.indexOf(e),i=Math.round(n.length/2);return-1===a?i:a}function e4(e){return function(t){var n;return e.minSliderValue+t*(null!==(n=e.step)&&void 0!==n?n:1)}}var t4,n4=function(){return n4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n4.apply(this,arguments)},a4=Object(s.memo)(function(e){var t=e.addInkContent,n=e.setAriaAnnouncement,a=e.inkBrush,i=Object(s.useContext)(Wb),r=i.InkCanvasInteraction,o=i.localizationStrings,d=i.inkConfigurations,l=Object(s.useCallback)(function(e){t(e);var i=function(e,t,n,a){var i,r=function(e,t){var n=XS(e).find(function(e){return e.hexColor.toLowerCase()===t.toLowerCase()});if(!n)throw new Error("No matching color option for hex value ".concat(t));return n.localizedName}(e,"#"+JS((i=t.drawingAttributes.color).r)+JS(i.g)+JS(i.b)),o=function(e,t){switch(t){case os.Pen:return e.markup_markupToolbarPenAriaLabel;case os.Highlighter:return e.markup_markupToolbarHighlighterAriaLabel;default:throw new h(t)}}(e,n.inkType),s=$S(t.drawingAttributes.height,a),c=e4(a)(s).toString();return vt(e.markup_addedInkStrokeAriaLive,o,r,c)}(o,e,a,d[a.inkType]);n(i)},[t,a,d,o,n]);return c.a.createElement(r,n4({},e,{addInkContent:l}))}),i4={addInkContent:K_,setAriaAnnouncement:Jn},r4=Object(ee.connect)(function(e){return{cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,imageViewTransform:wm(e)}},i4)(a4);Object($e.loadStyles)([{rawString:".toolbar_aa444992{border-radius:8px 8px 0 0;padding:0 16px;-webkit-box-shadow:0 4px 8px rgba(0,0,0,.14),0 0 2px rgba(0,0,0,.12);box-shadow:0 4px 8px rgba(0,0,0,.14),0 0 2px rgba(0,0,0,.12);display:-webkit-box;display:-ms-flexbox;display:flex;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;pointer-events:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;z-index:100;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.toolbar_aa444992 .focusZone_aa444992{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}@media screen and (max-width:578px) and (orientation:landscape){.toolbar_aa444992 .focusZone_aa444992{width:100%}}@media screen and (max-width:578px) and (orientation:landscape){.toolbar_aa444992 span{width:100%}}.markupToolbarTooltip_aa444992{border:none;border-radius:4px;padding:6px}.toolbarButton_aa444992 .toolbarIcon_aa444992{-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;position:relative;-webkit-transition:-webkit-transition .15s ease-in-out;transition:-webkit-transition .15s ease-in-out;transition:transition .15s ease-in-out;transition:transition .15s ease-in-out,-webkit-transition .15s ease-in-out}"}]),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(t4||(t4={}));var o4={Left:u.DirectionalHint.rightCenter,Right:u.DirectionalHint.leftCenter,Bottom:u.DirectionalHint.topCenter,Inline:u.DirectionalHint.topCenter},s4=Object(s.memo)(function(e){var t=e.iconComponent,n=e.onClick,a=e.onFocus,i=e.tooltipContent,r=e.ariaLabel,o=e.ariaDescription,d=e.isToolActive,l=e.buttonId,f=e.disabled,p=e.markupToolbarToolsStyles,m=e.markupToolbarButtonStyles,_=e.arrowModeIconProps,h=e.cursor,b=e.text,g=$(),v=Object(s.useContext)(Wb),y=v.markupToolbarStyles,S=(0,v.getMarkupToolbarPosition)(y),D=function(e,t){var n,a,i,r,o={toolbarButton:{},activeToolbarIcon:{backgroundColor:e.palette.neutralTertiaryAlt},toolbarIcon:{width:Fb,height:Fb,"&:hover":(n={backgroundColor:e.palette.neutralTertiaryAlt},n[".".concat(Hb)]={top:"-4px"},n),"&:active":(a={backgroundColor:e.palette.neutralTertiaryAlt},a[".".concat(Hb)]={top:"-4px"},a)},toolbarIconDisabled:{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"}},activeSVGIcon:(i={},i[".".concat(Hb)]={top:"-4px"},i),SVGIcon:(r={},r[".".concat(Hb)]={top:"5px",position:"absolute",transition:"top 0.05s ease-in-out"},r),toolbarTooltip:{boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"}};return Object(u.concatStyleSets)(o,t)}(g,p),I=D.toolbarButton,x=D.activeToolbarIcon,C=D.toolbarIcon,O=D.activeSVGIcon,w=D.SVGIcon,E=D.toolbarIconDisabled,A=D.toolbarTooltip,L=Object(u.mergeStyles)(I),k=Object(u.mergeStyles)(A),M=Object(u.mergeStyles)(C,d&&x,w,d&&O,"toolbarIcon_aa444992",f&&E),P=dt("tooltip"),T={gapSpace:15,beakWidth:12,styles:{beak:{background:g.palette.neutralLight},beakCurtain:{background:g.palette.neutralLight},calloutMain:{background:g.palette.neutralLight}}},U=Object(s.useMemo)(function(){return Object(u.concatStyleSets)({root:{backgroundColor:"inherit",border:"none",height:"56px",margin:"0",minWidth:"48px",overflow:"hidden",padding:"0",width:"48px",alignSelf:"center"},rootHovered:{backgroundColor:"inherit"},rootPressed:{backgroundColor:"inherit"},rootDisabled:{backgroundColor:"inherit"},screenReaderText:{visibility:"hidden"}},m)},[m]),F=c.a.createElement(u.DefaultButton,{id:l,text:b,styles:U,className:Object(u.css)(L,"toolbarButton_aa444992"),onClick:n,onFocus:a,role:"option","aria-checked":d,ariaLabel:r,ariaDescription:o,disabled:f,iconProps:_,style:{cursor:h}},c.a.createElement("span",{"aria-hidden":!0,className:M,role:"presentation"},t));return f||"none"===h||!i?F:c.a.createElement(u.TooltipHost,{content:i,id:P,directionalHint:o4[S],calloutProps:T,delay:t4.long,className:Object(u.css)(k,"markupToolbarTooltip_aa444992"),tooltipProps:{styles:{subText:{fontWeight:600,textAlign:"center"}}}},F)}),c4=function(){return c4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c4.apply(this,arguments)},d4=Object(s.memo)(function(e){var t=e.markupToolbarToolsStyles,n=e.getIcon,a=e.activeMarkupToolType,i=e.setActiveMarkupToolType,r=e.onClick,o=e.markupToolbarButtonStyles,d=e.showTooltip,l=e.iconSize,u=Object(s.useContext)(Wb),f=u.localizationStrings,p=u.setShowWetCanvas,m=Object(s.useCallback)(function(){p(!1),i(gs),null==r||r()},[r,i,p]),_=a===gs;return c.a.createElement(s4,{markupToolbarToolsStyles:t,iconComponent:n({isActive:_,styles:c4({},l)}),onClick:m,onFocus:m,tooltipContent:d?f.markup_markupToolbarEraserTooltip:void 0,ariaLabel:f.markup_markupToolbarEraserAriaLabel,ariaDescription:f.markup_markupToolbarEraserAriaDescription,isToolActive:_,markupToolbarButtonStyles:o})});function l4(e,t){switch(e){case rs.FreeHand:return t.markup_freehandLine;case rs.StraightLine:return t.markup_straightLine;default:throw new h(e)}}var u4=function(){return u4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},u4.apply(this,arguments)},f4=Object(s.memo)(function(e){var t=e.inkBrush,n=e.buttonId,a=e.locStrings,i=e.isToolActive,r=e.getIcon,o=e.markupToolbarToolsStyles,s=e.markupToolbarButtonStyles,d=e.iconSize,l=e.onClick,u=e.onFocus,f=e.getDisplayThickness,p=e.getTooltipContent,m=e.getAriaLabel,_=e.cursor;return c.a.createElement(s4,{iconComponent:r({styles:u4({},d),inkBrushColor:t.htmlColor,isActive:i}),onClick:l,onFocus:u,tooltipContent:null==p?void 0:p(a,a.markup_markupToolbarHighlighterTooltip,t.htmlColor,f(t.thicknessInCssPixels,t.inkType),i,l4(t.strokeShape.lineMode,a)),ariaLabel:m(a,a.markup_markupToolbarHighlighterAriaLabel,t.htmlColor,f(t.thicknessInCssPixels,t.inkType),l4(t.strokeShape.lineMode,a)),ariaDescription:a.markup_markupToolbarHighlighterAriaDescription,isToolActive:i,buttonId:n,markupToolbarToolsStyles:o,markupToolbarButtonStyles:s,cursor:_})}),p4=function(e){return void 0!==e&&e!==is.NoArrow};function m4(e,t){switch(e){case is.NoArrow:return t.markup_markupToolbarNoArrowTip;case is.SingleArrow:return t.markup_markupToolbarSingleArrowTip;case is.DoubleArrow:return t.markup_markupToolbarDoubleArrowTip;default:throw new h(e)}}var _4=function(){return _4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_4.apply(this,arguments)},h4=Object(s.memo)(function(e){var t=e.inkBrush,n=e.buttonId,a=e.locStrings,i=e.isToolActive,r=e.getIcon,o=e.iconSize,d=e.markupToolbarToolsStyles,l=e.markupToolbarButtonStyles,f=e.onClick,p=e.onFocus,m=e.getDisplayThickness,_=e.getTooltipContent,b=e.getAriaLabel,g=e.markupToolbarArrowIconStyle,v=e.cursor,S=function(e,t){var n=$();return{iconName:Object(s.useMemo)(function(){return p4(e)?function(e){switch(e){case is.SingleArrow:return"SmallSingleArrow-Havana";case is.DoubleArrow:return"SmallArrowMaximize-Havana";default:throw new h(e)}}(e):void 0},[e]),styles:Object(s.useMemo)(function(){if(p4(e))return e===is.SingleArrow?Object(u.mergeStyleSets)(y(n).singleArrow,null==t?void 0:t.singleArrow):Object(u.mergeStyleSets)(y(n).doubleArrow,null==t?void 0:t.doubleArrow)},[e,t,n])}}(t.strokeShape.arrowMode,g);return c.a.createElement(s4,{iconComponent:r({styles:_4({},o),inkBrushColor:t.htmlColor,isActive:i}),onClick:f,onFocus:p,tooltipContent:null==_?void 0:_(a,a.markup_markupToolbarPenTooltip,t.htmlColor,m(t.thicknessInCssPixels,t.inkType),i,l4(t.strokeShape.lineMode,a),t.strokeShape.arrowMode&&m4(t.strokeShape.arrowMode,a)),ariaLabel:b(a,a.markup_markupToolbarPenAriaLabel,t.htmlColor,m(t.thicknessInCssPixels,t.inkType),l4(t.strokeShape.lineMode,a),t.strokeShape.arrowMode&&m4(t.strokeShape.arrowMode,a)),ariaDescription:a.markup_markupToolbarPenAriaDescription,isToolActive:i,buttonId:n,markupToolbarToolsStyles:d,markupToolbarButtonStyles:l,arrowModeIconProps:S,cursor:v})}),b4=function(){return b4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b4.apply(this,arguments)},g4=Object(s.memo)(function(e){var t=e.inkBrush,n=e.inkBrushId,a=e.locStrings,i=e.isToolActive,r=e.brushMarkupToolType,o=e.iconSize,d=e.markupToolbarToolsStyles,l=e.markupToolbarButtonStyles,u=e.getIcon,f=e.getDisplayThickness,p=e.getTooltipContent,m=e.getAriaLabel,_=e.setActiveMarkupInkBrushId,h=e.setActiveMarkupToolType,b=e.setShowWetCanvas,g=e.onClick,v=e.markupToolbarArrowIconStyle,y=e.cursor,S=dt(n),D=Object(s.useCallback)(function(){_(n),b(!0),h(r)},[_,n,b,h,r]),I=Object(s.useCallback)(function(){i||D(),null==g||g(S,i)},[i,g,S,D]),x=Object(s.useCallback)(function(){On()&&D()},[D]);return c.a.createElement(v4,{inkBrush:t,buttonId:S,locStrings:a,isToolActive:i,onClick:I,onFocus:x,getDisplayThickness:f,getAriaLabel:m,getTooltipContent:p,markupToolbarToolsStyles:d,markupToolbarButtonStyles:l,iconSize:o,getIcon:u,markupToolbarArrowIconStyle:v,cursor:y})}),v4=function(e){switch(e.inkBrush.inkType){case os.Pen:return c.a.createElement(h4,b4({},e));case os.Highlighter:return c.a.createElement(f4,b4({},e));default:throw new h(e.inkBrush.inkType)}},y4=Object(s.memo)(function(e){var t=e.brushInkPropertiesLabel,n=e.changeInkPropertiesLabel;return c.a.createElement(c.a.Fragment,null,c.a.createElement("span",null,t),c.a.createElement("br",null),c.a.createElement("span",null,n))});function S4(e){switch(e){case os.Highlighter:return bs;case os.Pen:return hs;default:throw new h(e)}}var D4,I4=Object(s.memo)(function(e){var t=e.inkBrushes,n=e.activeInkBrushId,a=e.activeMarkupToolType,i=e.markupToolsConfigurations,r=e.showTooltip,o=void 0===r||r,d=e.iconSize,l=e.markupToolbarToolsStyles,u=e.markupToolbarButtonStyles,f=e.setActiveMarkupInkBrushId,p=e.setActiveMarkupToolType,m=e.setInkBrush,_=e.onBrushClick,h=e.markupToolbarArrowIconStyle,b=e.cursor,g=Object(s.useContext)(Wb),v=g.localizationStrings,y=g.inkConfigurations,S=g.setShowWetCanvas,D=Object(s.useCallback)(function(e,t){var n=y[t],a=$S(e,n);return e4(n)(a)},[y]),I=Object(s.useCallback)(function(e,t){return n===e&&a===t},[n,a]);return c.a.createElement(c.a.Fragment,null,Object.entries(t).filter(function(e){return e[0],!1!==e[1].isInkBrushvisible}).map(function(e){var t=e[0],n=e[1],a=S4(n.inkType),r=i.brushes.find(function(e){return e.inkBrushId===t});if(!r)throw new Error("inkBrushConfig not found for ".concat(t));return c.a.createElement(g4,{inkBrush:n,inkBrushId:t,locStrings:v,inkConfiguration:y[n.inkType],brushMarkupToolType:a,isToolActive:I(t,a),getDisplayThickness:D,getTooltipContent:o?C4:void 0,getAriaLabel:x4,setActiveMarkupInkBrushId:f,setActiveMarkupToolType:p,setInkBrush:m,setShowWetCanvas:S,key:t,markupToolbarToolsStyles:l,markupToolbarButtonStyles:u,iconSize:d,getIcon:r.getIcon,onClick:_,markupToolbarArrowIconStyle:h,cursor:b})}))});function x4(e,t,n,a,i,r){for(var o="",s=0,c=ZS(e);s<c.length;s++){var d=c[s],l=d.label;d.color===n&&l&&(o=l)}if(""===o)throw new Error("Unrecognized color");return r?vt(e.markup_markupToolbarBrushFormatWithArrowModeString,t,o,e.markup_markupToolbarThickness,a.toString(),i,r):vt(e.markup_markupToolbarBrushFormatString,t,o,e.markup_markupToolbarThickness,a.toString(),i)}function C4(e,t,n,a,i,r,o){var s=x4(e,t,n,a,r,o),d=e.markup_markupToolbarTooltipChangeInkProperties;return i?c.a.createElement(y4,{brushInkPropertiesLabel:s,changeInkPropertiesLabel:d}):s}function O4(e,t,n){var a=t||{width:0,height:0},i=Object(s.useState)(a),r=i[0],o=i[1],c=Object(s.useCallback)(function(e){var t=e[0].contentRect,n=t.width,a=t.height;o({width:n,height:a})},[o]);return Object(s.useLayoutEffect)(function(){if(e){var t=e.offsetWidth,n=e.offsetHeight;o({width:t,height:n})}},[e]),fy(e,c,n),r}function w4(e,t,n,a,i){var r=i-n/2,o=i+n/2,s=i-a/2,c=i+a/2;return"".concat(e,",").concat(o," ").concat(e,",").concat(r," ").concat(t,",").concat(s," ").concat(t,",").concat(c)}!function(e){e[e.Unshaded=0]="Unshaded",e[e.Shade1=1]="Shade1",e[e.Shade2=2]="Shade2",e[e.Shade3=3]="Shade3",e[e.Shade4=4]="Shade4",e[e.Shade5=5]="Shade5",e[e.Shade6=6]="Shade6",e[e.Shade7=7]="Shade7",e[e.Shade8=8]="Shade8"}(D4||(D4={}));var E4={width:336,height:30},A4={width:336,height:90},L4=Object(s.memo)(function(e){var t=e.previewSize,n=e.thickness,a=e.flipHorizontally,i=void 0!==a&&a,r=n*(i?2:.6),o=n*(i?.6:2),s=t.width,d=Math.floor(t.height/2);return c.a.createElement("polygon",{points:w4(0,s,r,o,d),strokeWidth:"1"})}),k4=Object(s.memo)(function(e){var t=e.previewSize,n=e.thickness,a=e.flipHorizontally,i=void 0!==a&&a,r=e.opacity,o=void 0===r?1:r,s=e.yScale,d=void 0===s?1:s,l=e.hidePathStroke,u=n*(i?2.25:.25),f=n*(i?.25:2.25),p=void 0===l||l?"transparent":void 0,m=u*d,_=f*d,h=u/2,b=t.width-f/2,g=Math.floor(t.height/2);return c.a.createElement(c.a.Fragment,null,c.a.createElement("polygon",{key:"trapezoid ".concat(o,",").concat(d),points:w4(h,b,m,_,g),strokeWidth:"1",opacity:o}),c.a.createElement("path",{key:"trapezoidLeft ".concat(o,",").concat(d),d:"M ".concat(h+1,",").concat(g+m/2," a1,1 0 0,1 0, ").concat(-m),stroke:p,strokeWidth:"1",opacity:o}),c.a.createElement("path",{key:"trapezoidRight ".concat(o,",").concat(d),d:"M ".concat(b-1,",").concat(g+_/2," a1,1 0 0,0 0, ").concat(-_),stroke:p,strokeWidth:"1",opacity:o}))});Object($e.loadStyles)([{rawString:".strokePreviewContainer_694e746e{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.strokePreviewContainer_694e746e .disabled_694e746e{opacity:.4}"}]);var M4=Object(s.memo)(function(e){var t=e.thickness,n=e.waveStrokeHtmlColor;return c.a.createElement("path",{d:"M1 25.8995C57 46.8995 41 20.8995 83 10.8995C125 0.899481 132 41.8995 170 36.8995C208 31.8995 230 -4.10055 259 2.89945",stroke:n,strokeWidth:4*t})}),P4=Object(s.memo)(function(e){var t=e.thickness,n=e.opacity,a=void 0===n?1:n,i=e.yScale,r=void 0===i?1:i,o=e.waveStrokeHtmlColor;return c.a.createElement("path",{key:"wave ".concat(a,",").concat(r),d:"M1 25.8995C57 46.8995 41 20.8995 83 10.8995C125 0.899481 132 41.8995 170 36.8995C208 31.8995 230 -4.10055 259 2.89945",stroke:o,strokeWidth:t})}),T4=function(){return T4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},T4.apply(this,arguments)},U4=Object(s.memo)(function(e){var t,n,a=e.thickness,i=e.inkBrushHtmlColor,r=e.inkBrushInkType,o=e.flipHorizontally,d=void 0!==o&&o,l=e.disabled,u=void 0!==l&&l,f=e.strokePreviewShape,p=void 0===f?"Line":f,m=e.styles,_=$(),b=Object(s.useState)(null),g=b[0],v=b[1],y=O4(g).width,S="Wave"===p,D=null===(t=null==g?void 0:g.querySelector("svg"))||void 0===t?void 0:t.querySelector("path"),I=Object(s.useCallback)(function(e,t){if(e){var n=e.getBBox(),a={top:n.x-t/2,left:n.y-t/2,width:n.width+t,height:n.height+t};return"".concat(a.top," ").concat(a.left," ").concat(a.width," ").concat(a.height)}},[]),x=Object(s.useMemo)(function(){return T4(T4({},S?A4:E4),{width:y,viewbox:S?I(D,a):void 0})},[I,y,S,D,a]),C=Object(s.useMemo)(function(){return function(e,t){var n=ma(e.palette.white),a=ma(t);return!(!n||!a)&&function(e,t){function n(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}var a=.2126*n(e.r/aa)+.7152*n(e.g/aa)+.0722*n(e.b/aa);a+=.05;var i=.2126*n(t.r/aa)+.7152*n(t.g/aa)+.0722*n(t.b/aa);return a/(i+=.05)>1?a/i:i/a}(n,a)<1.3}(_,i)},[_,i]),O=Object(s.useMemo)(function(){var e={previewSize:x,thickness:a,flipHorizontally:d,inkBrushHtmlColor:i,waveStrokeHtmlColor:i};switch(r){case os.Highlighter:return S?c.a.createElement(M4,T4({},e)):c.a.createElement(L4,T4({},e));case os.Pen:return S?c.a.createElement(P4,T4({},e,{hidePathStroke:!C})):c.a.createElement(k4,T4({},e,{hidePathStroke:!C}));default:throw new h(r)}},[x,a,d,r,C,S,i]),w=Object(s.useMemo)(function(){var e;return C?null===(e=null==_?void 0:_.palette)||void 0===e?void 0:e.neutralSecondary:void 0},[C,null===(n=null==_?void 0:_.palette)||void 0===n?void 0:n.neutralSecondary]);return c.a.createElement("div",{ref:v,className:"strokePreviewContainer_694e746e",style:T4(T4({},m),{margin:S?8:null==m?void 0:m.margin})},c.a.createElement("svg",{className:u?"disabled_694e746e":void 0,height:x.height,width:x.width,viewBox:x.viewbox,fill:S?"none":i,style:{stroke:w}},O))}),F4=function(e){var t,n=dt("gridCell"),a=e.item,i=e.id,r=void 0===i?n:i,c=e.className,d=e.selected,l=e.disabled,f=void 0!==l&&l,p=e.onRenderItem,m=e.cellDisabledStyle,_=e.cellIsSelectedStyle,h=e.index,b=e.label,g=e.getClassNames,v=e.onClick,y=e.onHover,S=e.onMouseMove,D=e.onMouseLeave,I=e.onMouseEnter,x=e.onFocus,C=Object(u.getNativeProps)(e,u.buttonProperties),O=s.useCallback(function(e){v&&!f&&v(a,e)},[f,a,v]),w=s.useCallback(function(e){I&&I(e)||!y||f||y(a,e)},[f,a,y,I]),E=s.useCallback(function(e){S&&S(e)||!y||f||y(a,e)},[f,a,y,S]),A=s.useCallback(function(e){D&&D(e)||!y||f||y(void 0,e)},[f,y,D]),L=s.useCallback(function(e){x&&!f&&x(a,e)},[f,a,x]);return s.createElement(u.CommandButton,Object(o.__assign)({id:r,"data-index":h,"data-is-focusable":!0,"aria-selected":d,ariaLabel:b,title:b},C,{className:Object(u.css)(c,(t={},t[""+_]=d,t[""+m]=f,t)),onClick:O,onMouseEnter:w,onMouseMove:E,onMouseLeave:A,onFocus:L,getClassNames:g}),p(a))},H4=Object(u.classNamesFunction)(),R4=s.forwardRef(function(e,t){var n=dt(void 0,e.id),a=e.items,i=e.columnCount,r=e.onRenderItem,c=e.isSemanticRadio,d=e.ariaPosInSet,l=void 0===d?e.positionInSet:d,f=e.ariaSetSize,p=void 0===f?e.setSize:f,m=e.styles,_=e.doNotContainWithinFocusZone,h=Object(u.getNativeProps)(e,u.htmlElementProperties,_?[]:["onBlur"]),b=H4(m,{theme:e.theme}),g=Object(u.toMatrix)(a,i),v=s.createElement("table",Object(o.__assign)({"aria-posinset":l,"aria-setsize":p,id:n,role:c?"radiogroup":"grid"},h,{className:b.root}),s.createElement("tbody",{role:c?"presentation":"rowgroup"},g.map(function(e,t){return s.createElement("tr",{role:c?"presentation":"row",key:t},e.map(function(e,t){return s.createElement("td",{role:"presentation",key:t+"-cell",className:b.tableCell},r(e,t))}))})));return _?v:s.createElement(u.FocusZone,{elementRef:t,isCircularNavigation:e.shouldFocusCircularNavigate,className:b.focusedContainer,onBlur:e.onBlur},v)}),N4=Object(u.styled)(R4,function(e){return{root:{padding:2,outline:"none"},tableCell:{padding:0}}});N4.displayName="ButtonGrid";var B4={outline:0},j4=function(e){return{fontSize:e,margin:"0 4px",height:"16px",lineHeight:"16px",textAlign:"center",flexShrink:0}},V4=Object(u.memoizeFunction)(function(e){var t,n,a=e.semanticColors,i=e.effects,r=e.fonts,o=a.buttonBorder,s=a.disabledBackground,c=a.disabledText,d={left:-2,top:-2,bottom:-2,right:-2,outlineColor:"ButtonText"};return{root:[Object(u.getFocusStyle)(e,{inset:1,highContrastStyle:d,borderColor:"transparent"}),e.fonts.medium,{border:"1px solid "+o,borderRadius:i.roundedCorner2,boxSizing:"border-box",cursor:"pointer",display:"inline-block",padding:"0 16px",textDecoration:"none",textAlign:"center",userSelect:"none",selectors:{":active > span":{position:"relative",left:0,top:0}}}],rootDisabled:[Object(u.getFocusStyle)(e,{inset:1,highContrastStyle:d,borderColor:"transparent"}),{backgroundColor:s,borderColor:s,color:c,cursor:"default",selectors:{":hover":B4,":focus":B4}}],iconDisabled:{color:c,selectors:(t={},t[u.HighContrastSelector]={color:"GrayText"},t)},menuIconDisabled:{color:c,selectors:(n={},n[u.HighContrastSelector]={color:"GrayText"},n)},flexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},description:{display:"block"},textContainer:{flexGrow:1,display:"block"},icon:j4(r.mediumPlus.fontSize),menuIcon:j4(r.small.fontSize),label:{margin:"0 4px",lineHeight:"100%",display:"block"},screenReaderText:u.hiddenContentStyle}}),z4=Object(u.memoizeFunction)(function(e,t){var n,a,i,r=V4(e),o={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent",selectors:(n={},n[u.HighContrastSelector]={borderColor:"Window"},n)},rootHovered:{color:e.palette.themePrimary,selectors:(a={},a[u.HighContrastSelector]={color:"Highlight"},a)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent",borderColor:"transparent",selectors:(i={},i[u.HighContrastSelector]={color:"GrayText"},i)},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(u.concatStyleSets)(r,o,t)}),G4=Object(u.classNamesFunction)(),K4=Object(u.memoizeFunction)(function(e,t,n,a,i,r,o,s,c){var d=z4(e);return Object(u.mergeStyleSets)({root:["ms-Button",d.root,n,t,o&&["is-checked",d.rootChecked],r&&["is-disabled",d.rootDisabled],!r&&!o&&{selectors:{":hover":d.rootHovered,":focus":d.rootFocused,":active":d.rootPressed}},r&&o&&[d.rootCheckedDisabled],!r&&o&&{selectors:{":hover":d.rootCheckedHovered,":active":d.rootCheckedPressed}}],flexContainer:["ms-Button-flexContainer",d.flexContainer]})}),W4={left:-2,top:-2,bottom:-2,right:-2,border:"none",outlineColor:"ButtonText"},q4=Object(u.styled)(function(e){var t,n,a=e.item,i=e.idPrefix,r=void 0===i?e.id:i,c=e.isRadio,d=e.selected,l=void 0!==d&&d,u=e.disabled,f=void 0!==u&&u,p=e.styles,m=e.circle,_=void 0===m||m,h=e.color,b=e.onClick,g=e.onHover,v=e.onFocus,y=e.onMouseEnter,S=e.onMouseMove,D=e.onMouseLeave,I=e.onWheel,x=e.onKeyDown,C=e.height,O=e.width,w=e.borderWidth,E=G4(p,{theme:e.theme,disabled:f,selected:l,circle:_,isWhite:(t=h,n=ma(t),"ffffff"===(null==n?void 0:n.hex)),height:C,width:O,borderWidth:w}),A=function(e){var t,n=E.svg;return s.createElement("svg",{className:n,role:"img","aria-label":e.label,viewBox:"0 0 20 20",fill:null===(t=ma(e.color))||void 0===t?void 0:t.str},_?s.createElement("circle",{cx:"50%",cy:"50%",r:"50%"}):s.createElement("rect",{width:"100%",height:"100%"}))},L=c?{role:"radio","aria-checked":l,selected:void 0}:{role:"gridcell",selected:l};return s.createElement(F4,Object(o.__assign)({item:a,id:"".concat(r,"-").concat(a.id,"-").concat(a.index),key:a.id,disabled:f},L,{onRenderItem:function(t){var n=e.onRenderColorCellContent;return(void 0===n?A:n)(t,A)},onClick:b,onHover:g,onFocus:v,label:a.label,className:E.colorCell,getClassNames:K4,index:a.index,onMouseEnter:y,onMouseMove:S,onMouseLeave:D,onWheel:I,onKeyDown:x}))},function(e){var t,n,a,i,r,o=e.theme,s=e.disabled,c=e.selected,d=e.circle,l=e.isWhite,f=e.height,p=void 0===f?20:f,m=e.width,_=void 0===m?20:m,h=e.borderWidth,b=o.semanticColors,g=o.palette,v=g.neutralLighter,y=g.neutralLight,S=g.neutralSecondary,D=g.neutralTertiary,I=h||(_<24?2:4);return{colorCell:[Object(u.getFocusStyle)(o,{inset:-1,position:"relative",highContrastStyle:W4}),{backgroundColor:b.bodyBackground,padding:0,position:"relative",boxSizing:"border-box",display:"inline-block",cursor:"pointer",userSelect:"none",borderRadius:0,border:"none",height:p,width:_,verticalAlign:"top"},!d&&{selectors:(t={},t[".".concat(u.IsFocusVisibleClassName," &:focus::after")]={outlineOffset:"".concat(I-1,"px")},t)},d&&{borderRadius:"50%",selectors:(n={},n[".".concat(u.IsFocusVisibleClassName," &:focus::after")]={outline:"none",borderColor:b.focusBorder,borderRadius:"50%",left:-I,right:-I,top:-I,bottom:-I,selectors:(a={},a[u.HighContrastSelector]={outline:"1px solid ButtonText"},a)},n)},c&&{padding:2,border:"".concat(I,"px solid ").concat(y),selectors:(i={},i["&:hover::before"]={content:'""',height:p,width:_,position:"absolute",top:-I,left:-I,borderRadius:d?"50%":"default",boxShadow:"inset 0 0 0 1px ".concat(S)},i)},!c&&{selectors:(r={},r["&:hover, &:active, &:focus"]={backgroundColor:b.bodyBackground,padding:2,border:"".concat(I,"px solid ").concat(v)},r["&:focus"]={borderColor:b.bodyBackground,padding:0,selectors:{":hover":{borderColor:o.palette.neutralLight,padding:2}}},r)},s&&{color:b.disabledBodyText,pointerEvents:"none",opacity:.3},l&&!c&&{backgroundColor:D,padding:1}],svg:[{width:"100%",height:"100%"},d&&{borderRadius:"50%"}]}},void 0,{scope:"ColorPickerGridCell"},!0),Q4=Object(u.classNamesFunction)(),Y4=s.forwardRef(function(e,t){var n=dt("swatchColorPicker"),a=e.id||n,i=ot({isNavigationIdle:!0,cellFocused:!1,navigationIdleTimeoutId:void 0,navigationIdleDelay:250}),r=st(),c=r.setTimeout,d=r.clearTimeout,l=e.colorCells,f=e.cellShape,p=void 0===f?"circle":f,m=e.columnCount,_=e.shouldFocusCircularNavigate,h=void 0===_||_,b=e.className,g=e.disabled,v=void 0!==g&&g,y=e.doNotContainWithinFocusZone,S=e.styles,D=e.cellMargin,I=void 0===D?10:D,x=e.defaultSelectedId,C=e.focusOnHover,O=e.mouseLeaveParentSelector,w=e.onChange,E=e.onColorChanged,A=e.onCellHovered,L=e.onCellFocused,k=e.getColorGridCellStyles,M=e.cellHeight,P=e.cellWidth,T=e.cellBorderWidth,U=e.onRenderColorCellContent,F=s.useMemo(function(){return l.map(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{index:t})})},[l]),H=s.useCallback(function(e,t){var n,a=null===(n=l.filter(function(e){return e.id===t})[0])||void 0===n?void 0:n.color;null==w||w(e,t,a),null==E||E(t,a)},[w,E,l]),R=ct(e.selectedId,x,H),N=R[0],B=R[1],j=Q4(S,{theme:e.theme,className:b,cellMargin:I}),V={root:j.root,tableCell:j.tableCell,focusedContainer:j.focusedContainer},z=l.length<=m,G=s.useCallback(function(e){L&&(i.cellFocused=!1,L(void 0,void 0,e))},[i,L]),K=s.useCallback(function(e){return C?(i.isNavigationIdle&&!v&&e.currentTarget.focus(),!0):!i.isNavigationIdle||!!v},[C,i,v]),W=s.useCallback(function(e){if(!C)return!i.isNavigationIdle||!!v;var t=e.currentTarget;return!i.isNavigationIdle||document&&t===document.activeElement||t.focus(),!0},[C,i,v]),q=s.useCallback(function(e){var t=O;if(C&&t&&i.isNavigationIdle&&!v)for(var n=document.querySelectorAll(t),a=0;a<n.length;a+=1)if(n[a].contains(e.currentTarget)){if(n[a].setActive)try{n[a].setActive()}catch(e){}else n[a].focus();break}},[v,C,i,O]),Q=s.useCallback(function(e,t){A&&(e?A(e.id,e.color,t):A(void 0,void 0,t))},[A]),Y=s.useCallback(function(e,t){if(L)return e?(i.cellFocused=!0,L(e.id,e.color,t)):(i.cellFocused=!1,L(void 0,void 0,t))},[i,L]),J=s.useCallback(function(e,t){v||e.disabled||e.id!==N&&(L&&i.cellFocused&&(i.cellFocused=!1,L(void 0,void 0,t)),B(e.id,t))},[v,i,L,N,B]),X=s.useCallback(function(){i.isNavigationIdle||void 0===i.navigationIdleTimeoutId?i.isNavigationIdle=!1:(d(i.navigationIdleTimeoutId),i.navigationIdleTimeoutId=void 0),i.navigationIdleTimeoutId=c(function(){i.isNavigationIdle=!0},i.navigationIdleDelay)},[d,i,c]),Z=s.useCallback(function(e){e.which!==u.KeyCodes.up&&e.which!==u.KeyCodes.down&&e.which!==u.KeyCodes.left&&e.which!==u.KeyCodes.right||X()},[X]),$=function(e){return s.createElement(q4,{item:e,idPrefix:a,color:e.color,styles:k,disabled:v||e.disabled,onClick:J,onHover:Q,onFocus:Y,selected:N===e.id,circle:"circle"===p,label:e.label,onMouseEnter:K,onMouseMove:W,onMouseLeave:q,onWheel:X,onKeyDown:Z,onRenderColorCellContent:U,height:M,width:P,borderWidth:T,isRadio:z})};return l.length<1||m<1?null:s.createElement(N4,Object(o.__assign)({},e,{ref:t,id:a,items:F,columnCount:m,isSemanticRadio:z,onRenderItem:function(t,n){var a=e.onRenderColorCell;return(void 0===a?$:a)(t,$)},shouldFocusCircularNavigate:h,doNotContainWithinFocusZone:y,onBlur:G,theme:e.theme,styles:V}))});Y4.displayName="SwatchColorPicker";var J4={focusedContainer:"ms-swatchColorPickerBodyContainer"},X4=Object(u.styled)(Y4,function(e){var t=e.className,n=e.theme;return{root:{margin:"8px 0",borderCollapse:"collapse"},tableCell:{padding:e.cellMargin/2},focusedContainer:[Object(u.getGlobalClassNames)(J4,n).focusedContainer,{clear:"both",display:"block",minWidth:"180px"},t]}},void 0,{scope:"SwatchColorPicker"});Object($e.loadStyles)([{rawString:".inkStylePicker_96c52854{border-radius:8px;width:336px}.inkSwatchColorPickerContainer_96c52854{clear:both;display:block;text-align:center}"}]);var Z4=function(){return Z4=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Z4.apply(this,arguments)};function $4(e,t){var n=null!=t?t:{},a=n.colorCellSize,i=n.colorCellSVGRadius,r=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(n,["colorCellSize","colorCellSVGRadius"]),o={colorCell:{padding:"0px",borderRadius:"50%",height:"auto",width:"auto"},colorCellSVG:{border:"1px solid transparent","&:hover":{backgroundColor:e.palette.neutralQuaternary,borderRadius:"50%"},"&:active":{backgroundColor:e.palette.neutralQuaternaryAlt,borderRadius:"50%"}},colorCellSVGCircle:{strokeOpacity:"0.3",stroke:e.palette.black},colorCellSelected:{backgroundColor:e.palette.neutralQuaternaryAlt,border:"1px solid "+e.palette.neutralTertiary,borderRadius:"50%"}};return Z4(Z4({},Object(u.concatStyleSets)(o,r)),{colorCellSize:null!=a?a:30,colorCellSVGRadius:null!=i?i:12})}var e9=function(e){return{display:e?"none":"block"}},t9={root:{margin:"0px",padding:"0px"},tableCell:{padding:"0px",height:"40px",width:"40px",textAlign:"center",button:{margin:"0px"}}},n9=Object(s.memo)(function(e){var t=e.colorOptions,n=e.selectedHTMLColor,a=e.colorPickerGridCellButtonIdPrefix,i=e.colorTableAriaLabel,r=e.maxColumnCount,o=void 0===r?8:r,d=e.styles,l=e.doNotContainWithinFocusZone,f=e.disabled,p=void 0!==f&&f,m=e.setSelectedHtmlColor,_=$(),h=function(e){if(!e)throw Error("Color of cell must not be falsy.");return e};function b(e){return"".concat(a,"-").concat(e)}var g=function(e){var t=h(e.color),a=n===t,i=$4(_,null==d?void 0:d.colorPickerGridCellStyles),r=i.colorCellSVG,o=i.colorCellSVGCircle,s=i.colorCellSize,l=i.colorCellSVGRadius,f=i.colorCellSelected,m=i.colorCellDisabled,b=p?Object(u.mergeStyles)(m):Object(u.mergeStyles)(r,a&&f);return c.a.createElement("svg",{className:b,width:s,height:s,viewBox:"0 0 ".concat(s," ").concat(s),fill:p?"inherit":e.color},c.a.createElement("circle",{className:Object(u.mergeStyles)(o),cx:"50%",cy:"50%",r:l}))},v=Object(s.useMemo)(function(){return Object(u.concatStyleSets)(t9,null==d?void 0:d.colorPicker)},[null==d?void 0:d.colorPicker]);return c.a.createElement("div",{className:"inkSwatchColorPickerContainer_96c52854"},c.a.createElement(X4,{id:"inkColorPicker","aria-label":i,columnCount:Math.min(t.length,o),colorCells:t,styles:v,onRenderColorCell:function(e){var t;if(!e)throw Error("ColorPicker did not receive color options to display.");var a=h(e.color),i=$4(_,null==d?void 0:d.colorPickerGridCellStyles).colorCell;return c.a.createElement(F4,{item:e,id:b(e.id),label:e.label,index:e.index,key:e.id,role:"gridcell",className:Object(u.mergeStyles)(i,p&&(null===(t=null==d?void 0:d.colorPickerGridCellStyles)||void 0===t?void 0:t.colorCellDisabled)),onRenderItem:g,onClick:function(){return m(a)},selected:!p&&n===a,disabled:p})},selectedId:function(e){var n,a=null===(n=t.find(function(t){return t.color===e}))||void 0===n?void 0:n.id;return a?b(a):void 0}(n),doNotContainWithinFocusZone:l}))}),a9=function(){return a9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a9.apply(this,arguments)},i9=c.a.memo(function(e){var t,n,a=e.inkConfiguration,i=e.inkBrushThicknessInCssPixels,r=e.layout,o=e.headerName,d=e.ariaLabel,l=e.title,f=e.onThicknessSliderChanged,p=e.disabled,m=void 0!==p&&p,_=e.styles,h=e.iconName,b=a.cssThicknesses.length-1,g=Object(s.useMemo)(function(){return $S(i,a)},[i,a]),v=Object(s.useContext)(Ze).localizeNumber,y=e4(a);function S(e){return y(e).toString()}var D=$(),I={value:g,maxValue:b,minValue:0,label:o,valueFormatter:S,iconName:h},x=!!h||!!(null==_?void 0:_.sliderHeader),C=Object(s.useMemo)(function(){var e,t=bt(D),n=a9(a9({},t),{valueLabel:{width:"20px",margin:"0",textAlign:"end"},slideBox:Object(u.mergeStyles)(t.slideBox,{margin:"0 1em 0 0",padding:"0"}),line:m&&{display:"none"}});return Object(u.concatStyleSets)(n,null===(e=null==_?void 0:_.getSliderStyles)||void 0===e?void 0:e.call(_,D,g))},[D,m,_,g]),O=a9(a9({},null==_?void 0:_.sliderHeader),{container:a9(a9({},null===(t=null==_?void 0:_.sliderHeader)||void 0===t?void 0:t.container),m&&{opacity:"0.25"}),labelValueHeader:a9(a9({},null===(n=null==_?void 0:_.sliderHeader)||void 0===n?void 0:n.labelValueHeader),m&&{display:"none"})});return c.a.createElement("div",null,x&&c.a.createElement(sn,{headerProps:I,layout:r,styles:O}),c.a.createElement("div",{style:null==_?void 0:_.sliderWrapper},c.a.createElement(ht,{id:"InkThicknessSlider",min:0,max:b,value:g,showValue:!x,styles:C,"aria-label":d,ariaValueText:function(e){return v(y(e))},onChange:f,valueFormat:S,snapToStep:!0,disabled:m,originFromZero:!0,buttonProps:{title:l}})))}),r9=function(){return r9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r9.apply(this,arguments)};function o9(e){var t=function(e){return{backgroundColor:"transparent",color:e.palette.neutralSecondary,fill:e.palette.neutralSecondary}}(e),n=function(e){return{backgroundColor:e.palette.neutralQuaternary,color:e.palette.black,fill:e.palette.black}}(e);return{root:r9(r9({},t),{display:"flex",height:"32px",minWidth:"32px"}),rootFocused:r9({},t),rootPressed:{backgroundColor:e.palette.neutralLighter},rootChecked:r9({},n),rootHovered:r9({},t),rootCheckedHovered:r9({},n),rootCheckedPressed:r9(r9({},t),{backgroundColor:e.palette.neutralLighter})}}Object($e.loadStyles)([{rawString:".container_189c8002{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-column-gap:12px;-moz-column-gap:12px;column-gap:12px}@media screen and (max-width:578px) and (orientation:landscape){.container_189c8002{-ms-flex-wrap:nowrap;flex-wrap:nowrap}}.disabled_189c8002{display:none}.icon_189c8002{font-size:18px;width:18px;height:18px;line-height:18px;margin:0}.iconLabelButton_189c8002{padding:0;border:none;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:default;margin:0}"}]);var s9="icon_189c8002",c9="iconLabelButton_189c8002",d9=Object(s.forwardRef)(function(e,t){var n=e.styles,a=e.activeStrokeShape,i=e.disabled,r=void 0!==i&&i,o=e.shouldHideArrowOptions,d=void 0!==o&&o,l=e.shouldHideStraightLineOptions,f=void 0!==l&&l,p=e.isHighlighter,m=void 0!==p&&p,_=e.onStrokeShapeChanged,h=Object(s.useContext)(Wb).localizationStrings,b=$(),g=function(e){return e.arrowMode===a.arrowMode&&e.lineMode===a.lineMode},v=Object(s.useCallback)(function(e){a.arrowMode===e.arrowMode&&a.lineMode===e.lineMode||_(e)},[a,_]),y=Object(s.useMemo)(function(){return Object(u.mergeStyleSets)(o9(b),null==n?void 0:n.iconLabelButton)},[null==n?void 0:n.iconLabelButton,b]),S=Object(s.useMemo)(function(){return Object(u.mergeStyleSets)(o9(b),{root:{display:"none"}},null==n?void 0:n.iconLabelButton)},[b,null==n?void 0:n.iconLabelButton]);function D(e){return e?S:y}return c.a.createElement("div",{className:"container_189c8002",style:null==n?void 0:n.container,role:"listbox",ref:t},c.a.createElement(u.DefaultButton,{iconProps:{iconName:"freehandNoArrowIcon-Havana",styles:null==n?void 0:n.icon,className:s9},styles:D(m&&!d&&f),onClick:function(){return v({arrowMode:is.NoArrow,lineMode:rs.FreeHand})},checked:g({arrowMode:is.NoArrow,lineMode:rs.FreeHand}),className:c9,role:"option",disabled:m&&!d&&f||r,title:h.markup_freehandNoArrowButtonTooltip,ariaLabel:h.markup_freehandNoArrowButtonAriaLabel}),c.a.createElement(u.DefaultButton,{iconProps:{iconName:"freehandSingleArrowIcon-Havana",styles:null==n?void 0:n.icon,className:s9},styles:D(m||d),onClick:function(){return v({arrowMode:is.SingleArrow,lineMode:rs.FreeHand})},checked:g({arrowMode:is.SingleArrow,lineMode:rs.FreeHand}),className:c9,role:"option",disabled:m||d||r,title:h.markup_freehandSingleArrowButtonTooltip,ariaLabel:h.markup_freehandSingleArrowButtonAriaLabel}),c.a.createElement(u.DefaultButton,{iconProps:{iconName:"freehandDoubleArrowIcon-Havana",styles:null==n?void 0:n.icon,className:s9},styles:D(m||d),onClick:function(){return v({arrowMode:is.DoubleArrow,lineMode:rs.FreeHand})},checked:g({arrowMode:is.DoubleArrow,lineMode:rs.FreeHand}),className:c9,role:"option",disabled:m||d||r,title:h.markup_freehandDoubleArrowButtonTooltip,ariaLabel:h.markup_freehandDoubleArrowButtonAriaLabel}),c.a.createElement(u.DefaultButton,{iconProps:{iconName:"line",styles:null==n?void 0:n.icon,className:Object(u.mergeStyles)({transform:"rotateY(180deg)"},s9)},styles:D(f),onClick:function(){return v({arrowMode:is.NoArrow,lineMode:rs.StraightLine})},checked:g({arrowMode:is.NoArrow,lineMode:rs.StraightLine}),className:c9,title:h.markup_straightNoArrowButtonTooltip,ariaLabel:h.markup_straightNoArrowButtonAriaLabel,disabled:f||r,role:"option"}),c.a.createElement(u.DefaultButton,{iconProps:{iconName:"ArrowTallUpRight",styles:null==n?void 0:n.icon,className:s9},styles:D(m||d||f),onClick:function(){return v({arrowMode:is.SingleArrow,lineMode:rs.StraightLine})},checked:g({arrowMode:is.SingleArrow,lineMode:rs.StraightLine}),className:c9,title:h.markup_straightSingleArrowButtonTooltip,ariaLabel:h.markup_straightSingleArrowButtonAriaLabel,disabled:m||f||d||r,role:"option"}),c.a.createElement(u.DefaultButton,{iconProps:{iconName:"ArrowMaximize-Havana",styles:null==n?void 0:n.icon,className:s9},styles:D(m||d||f),onClick:function(){return v({arrowMode:is.DoubleArrow,lineMode:rs.StraightLine})},checked:g({arrowMode:is.DoubleArrow,lineMode:rs.StraightLine}),className:c9,title:h.markup_straightDoubleArrowButtonTooltip,ariaLabel:h.markup_straightDoubleArrowButtonAriaLabel,disabled:m||f||d||r,role:"option"}))});d9.displayName="StrokeShapePicker";var l9=o.__assign;function u9(e,t){void 0===t&&(t={});var n=t.defaultProp,a=void 0===n?"children":n;return function(t,n,i,r,c){if(s.isValidElement(n))return n;var d=function(e,t){var n,a;return"string"==typeof t||"number"==typeof t||"boolean"==typeof t?((n={})[e]=t,a=n):a=t,a}(a,n),l=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];for(var i={},r=[],o=0,s=n;o<s.length;o++){var c=s[o];r.push(c&&c.className),l9(i,c)}return i.className=Object(H.mergeCss)([e,r],{rtl:Object(A.getRTL)(t)}),i}(r,c,t,d);if(i){if(i.component){var u=i.component;return s.createElement(u,Object(o.__assign)({},l))}if(i.render)return i.render(l,e)}return s.createElement(e,Object(o.__assign)({},l))}}var f9=Object(A.memoizeFunction)(function(e){return u9(e)});function p9(e,t,n,a,i,r){return void 0!==e.create?e.create(t,n,a,i):f9(e)(t,n,a,i,r)}function m9(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];for(var i={},r=0,s=n;r<s.length;r++){var c=s[r];c&&(c="function"==typeof c?c(e,t):c,Array.isArray(c)&&(c=m9.apply(void 0,Object(o.__spreadArray)([e,t],c,!1))),l9(i,c))}return i}var _9=function(e,t){void 0===t&&(t={});var n=t.factoryOptions,a=(void 0===n?{}:n).defaultProp,i=function(n){var a,i,r,c,d=(a=t.displayName,i=s.useContext(A.CustomizerContext),r=t.fields,c=["theme","styles","tokens"],A.Customizations.getSettings(r||c,a,i.customizations)),l=t.state;l&&(n=Object(o.__assign)(Object(o.__assign)({},n),l(n)));var u=n.theme||d.theme,f=m9(n,u,t.tokens,d.tokens,n.tokens),p=function(e,t,n){for(var a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return mt.concatStyleSets.apply(void 0,a.map(function(a){return"function"==typeof a?a(e,t,n):a}))}(n,u,f,t.styles,d.styles,n.styles),m=Object(o.__assign)(Object(o.__assign)({},n),{styles:p,tokens:f,_defaultStyles:p,theme:u});return e(m)};return i.displayName=t.displayName||e.name,a&&(i.create=u9(i,{defaultProp:a})),l9(i,t.statics),i}(function(e){if(null==e.children)return null;e.block,e.className;var t=e.as,n=void 0===t?"span":t,a=(e.variant,e.nowrap,Object(o.__rest)(e,["block","className","as","variant","nowrap"])),i=function(e,t){var n={},a=e,i=function(e){if(t.hasOwnProperty(e)){var i=function(n){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(i.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return p9(t[e],n,a[e],a.slots&&a.slots[e],a._defaultStyles&&a._defaultStyles[e],a.theme)};i.isSlot=!0,n[e]=i}};for(var r in t)i(r);return n}(e,{root:n});return function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e;return i.isSlot?0===(n=s.Children.toArray(n)).length?i(t):i(Object(o.__assign)(Object(o.__assign)({},t),{children:n})):s.createElement.apply(s,Object(o.__spreadArray)([e,t],n,!1))}(i.root,Object(o.__assign)({},Object(u.getNativeProps)(a,u.htmlElementProperties)))},{displayName:"Text",styles:function(e,t){var n=e.as,a=e.className,i=e.block,r=e.nowrap,o=e.variant,s=t.fonts,c=t.semanticColors,d=s[o||"medium"];return{root:[d,{color:d.color||c.bodyText,display:i?"td"===n?"table-cell":"block":"inline",mozOsxFontSmoothing:d.MozOsxFontSmoothing,webkitFontSmoothing:d.WebkitFontSmoothing},r&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},a]}}}),h9=Object(s.memo)(function(e){var t=e.calloutVisibilityState,n=e.setCalloutVisibilityState,a=e.target,i=e.styles,r=e.directionalHint,o=void 0===r?u.DirectionalHint.leftTopEdge:r,d=e.calloutHeaderText,l=e.calloutMainText,f=e.gapSpace,p=void 0===f?20:f,m=$();Object(s.useEffect)(function(){"notShown"===t&&a&&n("showing")},[n,t,a]);var _=Object(s.useMemo)(function(){return Object(u.mergeStyleSets)(null==i?void 0:i.calloutMain,{root:{borderRadius:"7px",wordBreak:"break-word"},beak:{},calloutMain:{borderRadius:"7px"},beakCurtain:{borderRadius:"7px"},container:{}})},[i,m]);return"showing"===t&&a?c.a.createElement(u.Callout,{target:a,directionalHint:o,gapSpace:p,backgroundColor:m.palette.neutralLighter,alignTargetEdge:!0,styles:_},c.a.createElement(_9,{block:!0,style:null==i?void 0:i.calloutHeader},d),c.a.createElement(_9,{block:!0,style:null==i?void 0:i.calloutContent},l)):null}),b9={setCalloutVisibilityState:Ns},g9=Object(ee.connect)(function(e){return{calloutVisibilityState:e.uiState.markupUiState.strokeShapeTipVisibilityState}},b9)(h9);Object($e.loadStyles)([{rawString:".headerContainer_d382ef31{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;line-height:42px;margin:25px 0 6px 0}.headerContainer_d382ef31 .name_d382ef31{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-margin-end:auto;margin-inline-end:auto;width:100%}.headerContainer_d382ef31 .name_d382ef31 .childrenWrapper_d382ef31{margin-left:auto}"}]);var v9=function(e){var t=e.iconName,n=e.label,a=e.styles,i=e.children,r=$().palette.neutralPrimary,o=Object(s.useMemo)(function(){var e={root:{fill:r,fontSize:"16px",height:"16px",width:"16px",lineHeight:"16px",marginRight:"8px"}};return Object(u.concatStyleSets)(e,null==a?void 0:a.icon)},[r,null==a?void 0:a.icon]);return c.a.createElement("div",{style:null==a?void 0:a.container,"aria-hidden":!0},c.a.createElement("div",{className:"headerContainer_d382ef31"},c.a.createElement("span",{className:"name_d382ef31"},!!t&&c.a.createElement($t.Icon,{iconName:t,styles:o}),!!n&&n,!!i&&c.a.createElement("div",{className:"childrenWrapper_d382ef31"},i))))};v9.displayName="SectionHeader";var y9={calloutHeader:{fontSize:"14px",padding:"10px 12px 0px"},calloutContent:{fontSize:"12px",padding:"0px 12px 16px"},calloutMain:{root:{width:"318px"}}},S9=function(){return S9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},S9.apply(this,arguments)},D9=Object(s.memo)(function(e){var t,n,a=e.styles,i=e.colorOptions,r=e.inkBrush,o=r.thicknessInCssPixels,d=r.htmlColor,l=r.inkType,f=r.strokeShape,p=e.inkBrushIdForInkStyleChange,m=e.inkConfiguration,_=e.colorPickerGridCellButtonIdPrefix,h=e.colorPickerMaxColumnCount,b=e.doNotContainColorPickerWithinFocusZone,g=e.disabled,v=void 0!==g&&g,y=e.setInkBrush,S=e.shouldHideArrowOptions,D=void 0!==S&&S,I=e.isStrokeShapeCalloutVisible,x=void 0===I||I,C=e.strokeShapeTipVisibilityState,O=e.setStrokeShapeTipVisibilityState,w=e.inkThicknessSliderHeaderIcon,E=e.strokePreviewShape,A=e.isColorHeaderVisible,L=void 0!==A&&A,k=e.isStrokeShapePickerHeaderVisible,M=void 0!==k&&k,P=$(),T=Object(u.getRTL)(P),U=Object(s.useRef)(null),F=Object(s.useRef)(null),H=Object(s.useRef)(null),R=Object(s.useRef)(null),N=Object(u.mergeStyles)(null===(t=null==a?void 0:a.inkColorPickerStyles)||void 0===t?void 0:t.container),B=Object(s.useMemo)(function(){return S4(l)===bs},[l]),j=Object(s.useContext)(Wb),V=j.localizationStrings,z=j.enableArrowhead,G=j.enableStraightLineMarkup,K=j.isStrokeShapeCalloutEnabled,W=Object(s.useCallback)(function(e,t,n,a){var i,r,o,s,c,d={inkBrush:{thicknessInCssPixels:(i=e,r=m,o=r.cssThicknesses,s=o[i],c=o[Math.round(o.length/2)],-1===s?c:s),htmlColor:t,inkType:n,strokeShape:a},id:p};y(d)},[m,p,y]),q=Object(s.useCallback)(function(e){W(e,d,l,f)},[d,l,W,f]),Q=Object(s.useCallback)(function(e){W($S(o,m),e,l,f)},[m,l,o,W,f]),Y=Object(s.useCallback)(function(e){W($S(o,m),d,l,e)},[o,d,l,W,m]),J=Object(s.useMemo)(function(){return z||G},[z,G]),X=Object(s.useMemo)(function(){return!J||!G&&B},[G,B,J]),Z=Object(s.useMemo)(function(){var e,t;return(null!==(t=null===(e=null==a?void 0:a.strokeShapePickerStyles)||void 0===e?void 0:e.getContainerWrapper)&&void 0!==t?t:e9)(X)},[X,null===(n=null==a?void 0:a.strokeShapePickerStyles)||void 0===n?void 0:n.getContainerWrapper]),ee=Object(s.useMemo)(function(){return Object(u.merge)(y9,null==a?void 0:a.strokeShapeCalloutStyles)},[null==a?void 0:a.strokeShapeCalloutStyles]),te=Object(s.useMemo)(function(){var e;return Object(u.mergeStyles)({padding:"0 16px",minHeight:"170px",height:X?"auto":"217px",display:"inline-flex",flexDirection:"column",justifyContent:"space-evenly",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"},null===(e=null==a?void 0:a.getContentWrapperStyle)||void 0===e?void 0:e.call(a,X,D))},[X,a,D]),ne=function(e,t,n){var a,i;e.preventDefault(),e.shiftKey?null===(a=null==t?void 0:t.current)||void 0===a||a.focus():null===(i=null==n?void 0:n.current)||void 0===i||i.focus()},ae=Object(s.useCallback)(function(){"showing"===C&&O("alreadyShown")},[O,C]);return c.a.createElement("div",{className:"inkStylePicker_96c52854",style:S9({backgroundColor:P.palette.neutralLight,padding:"0 16px"},null==a?void 0:a.containerStyles),"data-test-id":"ink-style-picker",onClick:ae,role:"presentation",onKeyDown:ae},c.a.createElement("div",{className:te},c.a.createElement(U4,{thickness:$S(o,m)+1,inkBrushHtmlColor:v?P.palette.white:d,inkBrushInkType:l,flipHorizontally:T,disabled:v,strokePreviewShape:E,styles:null==a?void 0:a.strokePreviewStyles}),c.a.createElement(u.FocusZone,{componentRef:H,onKeyDown:function(e){"Tab"===e.key&&ne(e,U,F)}},c.a.createElement(i9,{disabled:v,layout:"Labeled",inkConfiguration:m,inkBrushThicknessInCssPixels:o,onThicknessSliderChanged:q,ariaLabel:I9(l,V),styles:null==a?void 0:a.sliderStyles,title:V.markup_inkThicknessSliderTitle,headerName:V.markup_inkThicknessSliderHeaderLabel,iconName:w})),c.a.createElement(u.FocusZone,{componentRef:F,onKeyDown:function(e){"Tab"===e.key&&ne(e,H,U)},direction:u.FocusZoneDirection.domOrder,isCircularNavigation:!0,className:N},L&&c.a.createElement(v9,{label:"Color",iconName:"CircleFill"}),c.a.createElement(n9,{colorPickerGridCellButtonIdPrefix:_,styles:null==a?void 0:a.inkColorPickerStyles,colorTableAriaLabel:V.markup_colorTableAriaLabel,doNotContainWithinFocusZone:b,colorOptions:i,selectedHTMLColor:d,maxColumnCount:h,setSelectedHtmlColor:Q,disabled:v})),J&&c.a.createElement("div",{style:Z},K&&x&&c.a.createElement(g9,{target:R,directionalHint:u.DirectionalHint.rightBottomEdge,calloutHeaderText:V.markup_strokeShapeCalloutHeaderText,calloutMainText:V.markup_strokeShapeCalloutMainText,styles:ee}),c.a.createElement(u.FocusZone,{componentRef:U,onKeyDown:function(e){"Tab"===e.key&&ne(e,F,H)},direction:u.FocusZoneDirection.domOrder,isCircularNavigation:!0},M&&c.a.createElement(v9,{label:"Line Style",iconName:"lineStyleIcon-Havana"}),c.a.createElement(d9,{styles:null==a?void 0:a.strokeShapePickerStyles,activeStrokeShape:f,disabled:v,onStrokeShapeChanged:Y,isHighlighter:B,shouldHideArrowOptions:!z,shouldHideStraightLineOptions:!G,ref:R})))))});function I9(e,t){switch(e){case os.Highlighter:return t.markup_inkHighlighterThicknessSliderAriaLabel;case os.Pen:return t.markup_inkPenThicknessSliderAriaLabel;default:throw new h(e)}}var x9=Object(s.memo)(function(e){var t=e.onCloseMenu,n=e.directionalHint,a=e.elementIdForContextMenuPosition,i=e.openTriggerContainerId,r=e.hostId,o=e.inkBrush,d=e.inkBrushIdForInkStyleChange,l=e.localizationStrings,f=e.inkConfiguration,p=e.isStylePickerDisabled,m=void 0!==p&&p,_=e.styles,h=e.showGapBetweenToolbarAndStylePicker,b=void 0!==h&&h,g=e.colorPickerMaxColumnCount,v=e.setInkBrush,y=e.shouldHideArrowOptions,S=e.strokeShapeTipVisibilityState,D=e.setStrokeShapeTipVisibilityState,I=dt("".concat(d,"ContextualMenu")),x=dt("buttonGridCell"),C={style:{backgroundColor:"transparent",width:"auto",minWidth:"initial"},direction:u.FocusZoneDirection.bidirectional,isCircularNavigation:!0},O=b?8:0,w=c.a.createElement(D9,{colorPickerGridCellButtonIdPrefix:x,doNotContainColorPickerWithinFocusZone:!0,styles:_,colorOptions:ZS(l),colorPickerMaxColumnCount:g,inkConfiguration:f,inkBrush:o,inkBrushIdForInkStyleChange:d,setInkBrush:v,key:d,disabled:m,shouldHideArrowOptions:y,strokeShapeTipVisibilityState:S,setStrokeShapeTipVisibilityState:D}),E=[{key:"MenuComponent-".concat(a),onRender:function(){return w}}];return Object(s.useEffect)(function(){var e=!0,n=function(e){var n,r=document.getElementById(a),o=document.getElementById(I);i&&(n=document.getElementById(i));var s=null==r?void 0:r.contains(e.target),c=!(null==o?void 0:o.contains(e.target)),d=null==n?void 0:n.contains(e.target);s||!c||d||t()},r=function(e){var n,r;"Escape"===e.key&&(i?null===(n=document.getElementById(i))||void 0===n||n.focus():null===(r=document.getElementById(a))||void 0===r||r.focus(),t())},o=function(){t()};return window.addEventListener("pointerdown",n,e),window.addEventListener("keydown",r,e),window.addEventListener("resize",o,e),function(){window.removeEventListener("pointerdown",n,e),window.removeEventListener("keydown",r,e),window.removeEventListener("resize",o,e)}},[I,a,t,x,i,D]),c.a.createElement(u.ContextualMenu,{directionalHint:n,calloutProps:{styles:null==_?void 0:_.callout,layerProps:{hostId:r}},focusZoneProps:C,gapSpace:O,id:I,items:E,target:"#".concat(a),isBeakVisible:!1,useTargetAsMinWidth:!0,shouldFocusOnMount:!0,alignTargetEdge:!0})});x9.displayName="InkStylePickerContextualMenu";var C9=function(){return C9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},C9.apply(this,arguments)},O9=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},w9=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},E9=Object(s.memo)(function(e){var t,n,a,i=this,r=e.confirmationDialogHostId,o=e.confirmationDialogType,d=e.enableClearAllMarkup,l=e.showTooltip,f=e.styles,p=e.clearAllMarkupContent,m=e.text,_=e.setAriaAnnouncement,h=e.getIcon,b=Object(s.useContext)(Wb),g=b.localizationStrings,v=b.onClearAllMarkupConfirmationDialog,y=Object(s.useContext)(dh).enableUndoRedo,S=(t=$(),n=null==f?void 0:f.markupToolbarTools,a={toolbarButton:{},activeToolbarIcon:{backgroundColor:t.palette.neutralQuaternaryAlt},toolbarIcon:{width:Fb,height:Fb,"&:active":{backgroundColor:t.palette.neutralQuaternaryAlt},"&:hover":{backgroundColor:t.palette.neutralLight}},toolbarIconDisabled:{"&:hover":{backgroundColor:"transparent"},"&:active":{backgroundColor:"transparent"}},activeSVGIcon:{},SVGIcon:{},toolbarTooltip:{boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)"}},Object(u.concatStyleSets)(a,n)),D=Yg(v),I=D.showConfirmationDialog,x=D.onConfirmInDialog,C=D.onCancelInDialog,O=D.isHavanaConfirmDialogVisible,w={contentTitle:g.markup_clearAllMarkupDialogTitle,contentSubText:g.markup_clearAllMarkupDialogSubText,closeButtonAriaLabel:g.markup_clearAllMarkupDialogCloseButtonAriaLabel,confirmText:g.markup_clearAllMarkupDialogConfirmButtonText,confirmAriaLabel:g.markup_clearAllMarkupDialogConfirmButtonAriaLabel,cancelText:g.markup_clearAllMarkupDialogCancelButtonText,cancelAriaLabel:g.markup_clearAllMarkupDialogCancelButtonAriaLabel};return c.a.createElement(c.a.Fragment,null,c.a.createElement(s4,{text:m,markupToolbarToolsStyles:S,markupToolbarButtonStyles:null==f?void 0:f.markupToolbarButton,iconComponent:h(C9({enabled:d},null==f?void 0:f.clearAllMarkupIcon)),onClick:function(){return O9(i,void 0,void 0,function(){return w9(this,function(e){return y?[2,new Promise(function(e){p(),_(g.markup_clearedAllMarkupAriaLive),e()})]:[2,O9(i,void 0,void 0,function(){return w9(this,function(e){switch(e.label){case 0:return[4,I().then(function(e){"confirmed"===e&&(p(),_(g.markup_clearedAllMarkupAriaLive))}).catch(function(e){})];case 1:return e.sent(),[2]}})})]})})},tooltipContent:l?g.markup_markupToolbarClearAllMarkupTooltip:void 0,ariaLabel:g.markup_markupToolbarClearAllMarkupAriaLabel,isToolActive:!1,disabled:!d}),d&&!y&&c.a.createElement(Kg,{onConfirm:x,onCancel:C,isVisible:O,hostId:r,dialogType:o,styles:null==f?void 0:f.confirmationDialog,dialogStrings:w}))}),A9=function(){return A9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A9.apply(this,arguments)},L9=Object(s.memo)(function(e){var t=e.markupToolbarToolsStyles,n=e.getIcon,a=e.activeMarkupToolType,i=e.setActiveMarkupToolType,r=e.onClick,o=e.markupToolbarButtonStyles,d=e.iconSize,l=Object(s.useContext)(Wb).setShowWetCanvas,u=Object(s.useCallback)(function(){l(!1),i(vs),null==r||r()},[r,i,l]),f=a===vs;return c.a.createElement(s4,{markupToolbarToolsStyles:t,iconComponent:n({isActive:f,styles:A9({},d)}),onClick:u,onFocus:u,ariaLabel:"",isToolActive:f,markupToolbarButtonStyles:o})}),k9=function(){return k9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},k9.apply(this,arguments)},M9={Left:u.DirectionalHint.rightTopEdge,Right:u.DirectionalHint.leftTopEdge,Bottom:u.DirectionalHint.topCenter,Inline:u.DirectionalHint.topCenter},P9={Left:4,Right:4,Bottom:8,Inline:8},T9=Object(s.memo)(function(e){var t,n=e.inkBrushes,a=e.activeInkBrushId,i=e.activeMarkupToolType,r=e.enableClearAllMarkup,o=e.clearAllMarkupConfirmationDialogHostId,d=e.clearAllMarkupConfirmationDialogType,l=e.showGapBetweenToolbarAndStylePicker,f=void 0!==l&&l,p=e.showStylePickerInFullWidth,m=void 0===p||p,_=e.showInkStylePicker,h=e.stylePickerHostId,b=e.stylePickerPopUpPositionSource,g=void 0===b?"SelectedInkBrushButton":b,v=e.clearAllMarkupContent,y=e.setAriaAnnouncement,S=e.setActiveMarkupInkBrushId,D=e.setActiveMarkupToolType,I=e.setInkBrush,x=e.setShowInkStylePicker,C=e.colorPickerMaxColumnCount,O=e.strokeShapeTipVisibilityState,w=e.setStrokeShapeTipVisibilityState,E=e.cursor,A=$(),L=Object(s.useContext)(Wb),k=L.localizationStrings,M=L.markupToolsConfigurations,P=L.inkConfigurations,T=L.markupToolbarStyles,U=(0,L.getMarkupToolbarPosition)(T),F=Object(s.useState)(),H=F[0],R=F[1],N=n[a],B=dt("inkStylePickerContainer"),j=dt("buttonsContainer"),V=dt("outerContainer"),z=Object(s.useState)(B),G=z[0],K=z[1],W=Object(s.useContext)(dh).enableMarkupText,q="Inline"===U,Q=Object(s.useCallback)(function(e,t){R(e),t&&x(!_),K(m?B:{MarkupToolbarContainer:V,SelectedInkBrushButton:e}[g])},[m,x,_,B,V,g]),Y=Object(s.useCallback)(function(){x(!1)},[x]),J=Object(s.useCallback)(function(){x(!1)},[x]);Object(s.useLayoutEffect)(function(){var e,t=null===(e=document.getElementById(j))||void 0===e?void 0:e.querySelector('button[aria-checked="true"]');R(null==t?void 0:t.id)},[j]);var X=m?{containerStyles:{display:"flex",justifyContent:" center",width:"100%",backgroundColor:"transparent"},callout:{root:{width:"100%",left:"0px !important",right:"0px !important",borderRadius:"8px",borderBottom:"1px solid ".concat(A.palette.neutralLight)},calloutMain:{borderRadius:"12px 12px 0 0"}}}:{callout:{root:{backgroundColor:"transparent",borderRadius:"8px"},calloutMain:{backgroundColor:"transparent"}}},Z=k9(k9({},null==T?void 0:T.inkStylePicker),{callout:Object(u.merge)(k9({},X.callout),k9({},null==T?void 0:T.contextualMenuCallout)),containerStyles:Object(u.merge)(k9({},X.containerStyles),k9({},null===(t=null==T?void 0:T.inkStylePicker)||void 0===t?void 0:t.containerStyles))}),ee=C||P9[U],te=Object(s.useCallback)(function(){"showing"===O&&w("alreadyShown")},[w,O]),ne=Object(s.useCallback)(function(e){e.ctrlKey&&e.preventDefault()},[]);return c.a.createElement("div",{className:"toolbar_aa444992",style:k9({backgroundColor:A.palette.neutralLight},null==T?void 0:T.container),"aria-label":k.markup_markupToolbarAriaLandmark,role:"region",id:V},c.a.createElement("span",{role:"presentation",onClick:te,onKeyDown:te},c.a.createElement(u.FocusZone,{direction:u.FocusZoneDirection.domOrder,isCircularNavigation:!0,role:"toolbar",preventFocusRestoration:!0,className:"focusZone_aa444992",onKeyDown:ne},_&&c.a.createElement(u.Stack,{id:B},c.a.createElement(x9,{inkBrush:n[a],elementIdForContextMenuPosition:G,inkBrushIdForInkStyleChange:a,directionalHint:M9[U],localizationStrings:k,inkConfiguration:P[N.inkType],onCloseMenu:J,setInkBrush:I,showGapBetweenToolbarAndStylePicker:f,styles:Z,openTriggerContainerId:H,hostId:h,isStylePickerDisabled:!ds(i),colorPickerMaxColumnCount:ee,setStrokeShapeTipVisibilityState:w,strokeShapeTipVisibilityState:O})),c.a.createElement(u.Stack,{horizontal:!0,id:j,style:null==T?void 0:T.inkToolsContainer,role:"listbox"},c.a.createElement(I4,{inkBrushes:n,activeMarkupToolType:i,activeInkBrushId:a,setActiveMarkupInkBrushId:S,setActiveMarkupToolType:D,setInkBrush:I,markupToolbarToolsStyles:null==T?void 0:T.markupToolbarTools,markupToolbarButtonStyles:null==T?void 0:T.markupToolbarButton,iconSize:null==T?void 0:T.markupToolbarIconSize,markupToolsConfigurations:M,onBrushClick:q?void 0:Q,showTooltip:!m,markupToolbarArrowIconStyle:null==T?void 0:T.markupToolbarArrowIconStyle,cursor:E}),c.a.createElement(d4,{markupToolbarToolsStyles:null==T?void 0:T.markupToolbarTools,activeMarkupToolType:i,setActiveMarkupToolType:D,onClick:Y,getIcon:M.eraser.getIcon,markupToolbarButtonStyles:null==T?void 0:T.markupToolbarButton,iconSize:null==T?void 0:T.markupToolbarIconSize,showTooltip:!m}),W&&q&&c.a.createElement(L9,{markupToolbarToolsStyles:null==T?void 0:T.markupToolbarTools,activeMarkupToolType:i,setActiveMarkupToolType:D,getIcon:M.text.getIcon,markupToolbarButtonStyles:null==T?void 0:T.markupToolbarButton,iconSize:null==T?void 0:T.markupToolbarIconSize,showTooltip:!m}),!q&&c.a.createElement(E9,{styles:null==T?void 0:T.clearAllMarkup,enableClearAllMarkup:r,clearAllMarkupContent:v,setAriaAnnouncement:y,confirmationDialogType:d,getIcon:M.clearAllMarkup.getIcon,showTooltip:!m,confirmationDialogHostId:o})))))}),U9=function(){return U9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},U9.apply(this,arguments)},F9=Object(s.memo)(function(e){var t=e.isMarkupKeyboardInputActive?"none":"pointer",n=Object(s.useContext)(Wb).markupToolbarStyles,a=Object(s.useMemo)(function(){return U9({borderRadius:"8px",padding:"0",bottom:"0",left:"50%"},null==n?void 0:n.canvasContainer)},[n]);return c.a.createElement(ha,{style:a,visible:!0},c.a.createElement(T9,U9({cursor:t},e)))}),H9=Object(ga.e)([function(e){return e.markup.markupContentItems}],function(e){return e.some(function(e){return e.contentType===R_.InkContent})}),R9={setActiveMarkupInkBrushId:Ps,setActiveMarkupToolType:Fs,setInkBrush:Us,setShowInkStylePicker:Rs,clearAllMarkupContent:q_,setAriaAnnouncement:Jn,setStrokeShapeTipVisibilityState:Ns},N9=Object(ee.connect)(function(e){return{activeMarkupToolType:e.uiState.markupUiState.activeMarkupToolType,enableClearAllMarkup:H9({markup:e.markup}),showInkStylePicker:e.uiState.markupUiState.showInkStylePicker,strokeShapeTipVisibilityState:e.uiState.markupUiState.strokeShapeTipVisibilityState,isMarkupKeyboardInputActive:e.uiState.markupUiState.isKeyboardInputActive}},R9)(F9),B9=Object(s.memo)(function(e){var t=e.inkBrushes,n=e.activeInkBrushId,a=e.showGapBetweenToolbarAndStylePicker,i=e.showStylePickerInFullWidth,r=e.dialogType,o=e.stylePickerPopUpPositionSource,s=e.shouldOmitInkContent,d=YS(t,n);return c.a.createElement(c.a.Fragment,null,c.a.createElement(N9,{inkBrushes:t,activeInkBrushId:n,showGapBetweenToolbarAndStylePicker:a,showStylePickerInFullWidth:i,clearAllMarkupConfirmationDialogType:r,stylePickerPopUpPositionSource:o}),c.a.createElement(r4,{inkBrush:d.inkBrush,shouldOmitInkContent:s}))}),j9=Object(ee.connect)(function(e){return{inkBrushes:e.uiState.markupUiState.inkBrushes,activeInkBrushId:e.uiState.markupUiState.activeInkBrushId}})(B9),V9=function(){return V9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},V9.apply(this,arguments)},z9=Object(s.memo)(function(e){var t,n,a=e.markupContentItems,i=e.setAriaAnnouncement,r=e.removeMarkupContent,o=e.setShouldUpdateImageOverlay,d=e.shouldCleanupMarkup,l=e.disabled,u=Object(s.useContext)(Wb).Canvas,f=a.length>0;t=!l,n=Object(s.useContext)(lh).setImageLayer,Object(s.useEffect)(function(){t&&n("overlay",null)},[t,n]),function(e,t,n){Object(s.useEffect)(function(){n&&e(t)},[n,t,e])}(o,f,!l),function(e,t){var n=Object(s.useContext)(Wb).setCanvasMethods;Object(s.useEffect)(function(){!e&&t&&n(Kb)},[e,n,t])}(f,d);var p=function(e,t,n){var a=Object(s.useRef)(e),i=Object(s.useContext)(Wb).localizationStrings,r=Object(s.useCallback)(function(e){var r,o,s,c=(r=i,o=e.length,s=a.current.length,vt(r.markup_removedInkStrokesAriaLive,o.toString(),s.toString()));t(e),n(c)},[i,a,t,n]);return a.current=e,r}(a,r,i);return l?null:c.a.createElement(u,V9({},e,{removeMarkupContent:p}))});function G9(e){return Math.max(1.5,Math.ceil(.2*e))}function K9(e){var t=e<12?3:2;return Math.max(e/2+t,4)}var W9='<path d="M2.61668 8.01447L2.95461 7.67687L4.80895 5.82223L4.81034 5.82084L6.148 4.48324V4.803C6.148 5.44733 6.6703 5.96967 7.3146 5.96967C7.959 5.96967 8.4813 5.44733 8.4813 4.803V1.75556C8.4813 1.74038 8.481 1.72526 8.4805 1.71018C8.4921 1.3982 8.3785 1.08066 8.1396 0.841709C7.9006 0.602758 7.5831 0.489234 7.2711 0.500811C7.256 0.500271 7.2409 0.5 7.2257 0.5H4.14777C3.50344 0.5 2.9811 1.02233 2.9811 1.66667C2.9811 2.311 3.50344 2.83333 4.14777 2.83333H4.49803L0.966869 6.36445C0.685479 6.62925 0.522129 6.9496 0.502069 7.28601C0.482019 7.62218 0.608909 7.93241 0.828849 8.15235C1.04879 8.3723 1.35902 8.49919 1.69519 8.47915C2.03157 8.4591 2.35189 8.29579 2.61668 8.01447Z" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>',q9='<path d="M4.4835 7.16661L5.82698 5.8229L5.82702 5.82287L5.82972 5.82017L7.1667 4.48324V4.803C7.1667 5.44733 7.689 5.96966 8.3333 5.96966C8.9777 5.96966 9.5 5.44733 9.5 4.803V1.75555C9.5 1.74038 9.4997 1.72526 9.4992 1.71018C9.5108 1.3982 9.3972 1.08066 9.1583 0.841709C8.9193 0.602756 8.6018 0.489233 8.2898 0.50081C8.2747 0.500271 8.2596 0.5 8.2444 0.5H5.16647C4.52214 0.5 3.99981 1.02233 3.99981 1.66667C3.99981 2.311 4.52214 2.83333 5.16647 2.83333H5.51674L2.83333 5.5167V5.15776C2.83333 4.51343 2.311 3.9911 1.66667 3.9911C1.02234 3.9911 0.5 4.51343 0.5 5.15776V8.24438C0.5 8.25955 0.50027 8.27468 0.50081 8.28975C0.48923 8.60174 0.60276 8.91928 0.84171 9.15823C1.08066 9.39718 1.3982 9.51071 1.71019 9.49913C1.72527 9.49967 1.74039 9.49994 1.75556 9.49994H4.8219C5.46623 9.49994 5.98857 8.9776 5.98857 8.33327C5.98857 7.68894 5.46623 7.16661 4.8219 7.16661H4.4835Z" stroke="white" stroke-linecap="round" stroke-linejoin="round"/>',Q9=window.btoa("<svg width='48' height='47' viewBox='0 0 48 47' fill='none' xmlns='http://www.w3.org/2000/svg'>\n<g filter='url(#filter0_dd)'>\n  <circle cx='24' cy='20' r='16' fill='white' fill-opacity='0.8'/>\n</g>\n<defs>\n  <filter id='filter0_dd' x='0.8' y='2.38419e-07' width='46.4' height='46.4' filterUnits='userSpaceOnUse' color-interpolation-filters='sRGB'>\n    <feFlood flood-opacity='0' result='BackgroundImageFix'/>\n    <feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/>\n    <feOffset dy='3.2'/>\n    <feGaussianBlur stdDeviation='3.6'/>\n    <feColorMatrix type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.13 0'/>\n    <feBlend mode='normal' in2='BackgroundImageFix' result='effect1_dropShadow'/>\n    <feColorMatrix in='SourceAlpha' type='matrix' values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0'/>\n    <feOffset dy='0.6'/>\n    <feGaussianBlur stdDeviation='0.9'/>\n    <feColorMatrix type='matrix' values='0 \n0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0'/>\n    <feBlend mode='normal' in2='effect1_dropShadow' result='effect2_dropShadow'/>\n    <feBlend mode='normal' in='SourceGraphic' in2='effect2_dropShadow' result='shape'/>\n  </filter>\n</defs>\n</svg>"),Y9=Object(ga.e)([function(e){return e.uiState.markupUiState.activeMarkupToolType},function(e){return e.uiState.markupUiState.inkBrushes},function(e){return e.uiState.markupUiState.activeInkBrushId}],function(e,t,a){var i=YS(t,a).inkBrush,r=i.thicknessInCssPixels,o=i.htmlColor,s=i.strokeShape,c=n("tPTD"),d=n("b+rg");switch(e){case hs:return function(e,t,n){var a=K9(t);return"url(data:image/svg+xml;base64,".concat(window.btoa(function(e,t,n,a){var i=G9(t),r=2*t+30;return"\n    <svg\n      height='".concat(r,"'\n      width='").concat(r,"'\n      xmlns='http://www.w3.org/2000/svg'\n      viewBox='0 0 ").concat(r," ").concat(r,"'\n    >\n      <circle\n        cx='50%'\n        cy='50%'\n        r='").concat(t,"'\n        stroke='white'\n        stroke-width='").concat(i,"'\n        fill='").concat(e,"'\n        shape-rendering='geometricPrecision'\n      />\n      '").concat(function(e,t,n,a,i){var r=e/2+n+t+1,o=e/2;switch(i){case is.NoArrow:return;case is.SingleArrow:return function(e,t){return"\n    <svg x='".concat(e,"' y='").concat(t,'\' width="9" height="9" viewBox="0 0 9 9" fill="black" xmlns="http://www.w3.org/2000/svg">\n    ').concat(W9,"\n    </svg>")}(r,o);case is.DoubleArrow:return function(e,t){return"\n    <svg x='".concat(e,"' y='").concat(t,'\' width="10" height="10" viewBox="0 0 10 10" fill="black" xmlns="http://www.w3.org/2000/svg">\n    ').concat(q9,"\n    </svg>")}(r,o)}}(r,i,t,0,a),"'\n      </svg>")}(e,a,0,n)),") ").concat(a+15," ").concat(a+15)}(o,r,s.arrowMode)+", url(".concat(c.default,"), crosshair");case bs:return function(e,t){var n=Math.max(10,t),a=n/2,i=n/5;return"url(data:image/svg+xml;base64,".concat(window.btoa(function(e,t){var n=Math.min(.1*t,1.5),a=t/2,i=t;return"<svg\n      height='".concat(i,"'\n      width='").concat(a,"'\n      xmlns='http://www.w3.org/2000/svg'\n      viewBox='0 0 ").concat(a," ").concat(i,"'\n    >\n      <rect\n        height='").concat(i,"'\n        width='").concat(a,"'\n        cx='50%'\n        cy='50%'\n        stroke='white'\n        stroke-width='").concat(n,"'\n        fill='").concat(e,"'\n      />\n    </svg>")}(e,n)),") ").concat(a-i," ").concat(a)}(o,r)+", url(".concat(c.default,"), crosshair");case gs:return"url(data:image/svg+xml;base64,".concat(Q9,") 24 20, url(").concat(d.default,"), default");default:return"default"}}),J9={removeMarkupContent:W_,setActiveMarkupToolType:Fs,setAriaAnnouncement:Jn,setShouldUpdateImageOverlay:As,setStrokeShapeTipVisibilityState:Ns,setMarkupCursorScreenPosition:Vs,moveMarkupCursorScreenPositionBy:zs,setIsKeyboardInputActive:Gs,addMarkupContent:K_,updateMarkupContent:V_,setShowInkStylePicker:Rs,setLinePreviewCoords:Ks,setActiveMarkupContentId:Q_,setMarkupTextSelection:Y_},X9=Object(ee.connect)(function(e){var t=e.transformTools,n=t.view,a=n.viewportPixelSize,i=n.viewportCssSize,r=t.image.originalPixelSize,o=t.device.pixelRatio;return{cropViewTransform:Kf(e),imageViewTransform:wm(e),originalImagePixelSize:r,cssToPhysicalPixelRatio:o,width:a.x,height:a.y,cssWidth:i.width,cssHeight:i.height,markupContentItems:e.markup.markupContentItems,shouldCleanupMarkup:""!==e.uiState.nextEditorActivity&&e.uiState.activeEditorActivity===io,activeMarkupToolType:e.uiState.markupUiState.activeMarkupToolType,previousActiveMarkupToolType:e.uiState.markupUiState.previousActiveMarkupToolType,activeInkBrush:e.uiState.markupUiState.inkBrushes[e.uiState.markupUiState.activeInkBrushId],cursor:Y9(e),hidden:e.uiState.activeEditorActivity!==io,disabled:e.uiState.activeEditorActivity!==io&&(0===e.markup.markupContentItems.length&&0===e.markup.undoRedoStack.redoStack.length||!e.uiState.waitingForMarkupOverlayTexture),isKeyboardInputActive:e.uiState.markupUiState.isKeyboardInputActive,cursorScreenPos:e.uiState.markupUiState.markupCursorScreenPosition,linePreviewCoords:e.uiState.markupUiState.linePreviewCoords}},J9)(z9),Z9=Object(s.memo)(function(e){var t=e.showGapBetweenToolbarAndStylePicker,n=void 0!==t&&t,a=e.showStylePickerInFullWidth,i=void 0!==a&&a,r=e.dialogType,o=e.stylePickerPopUpPositionSource,d=e.showMarkupToolbar,l=void 0===d||d,u=e.isEditorFocused,f=Object(s.useContext)(dh).enableMarkup,p=Object(s.useContext)(Wb),m=p.markupToolbarStyles,_=(0,p.getMarkupToolbarPosition)(m);return f?c.a.createElement(c.a.Fragment,null,c.a.createElement(X9,{isEditorFocused:u}),l&&"Inline"!==_?c.a.createElement(wb,{match:io},c.a.createElement(j9,{key:"".concat(_,"InkConnect"),showGapBetweenToolbarAndStylePicker:n,showStylePickerInFullWidth:i,dialogType:r,stylePickerPopUpPositionSource:o})):null):null}),$9=function(){return $9=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},$9.apply(this,arguments)},e8=lr(42),t8=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},n8=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},a8=function(e,t){e.width=t.x,e.height=t.y};function i8(e,t,n,a){n(),r8(e,t),a.renderNow()}var r8=function(e,t){e.width=t.x,e.height=t.y};function o8(e,t,n,a){return t8(this,void 0,void 0,function(){var i,r,o,s,c;return n8(this,function(d){switch(d.label){case 0:return i=[null,function(){}],n&&e?(o=function(){},s=new Promise(function(e){return o=e}),c=function(e){r=e,o()},n.getTexture(e,c,t,!0,a),[4,s]):[3,2];case 1:d.sent(),r&&r.texture&&(i=[r.texture,function(){r&&n.releaseTexture(r.id)}]),d.label=2;case 2:return[2,i]}})})}function s8(e,t,n){return t8(this,void 0,void 0,function(){var a,i,r,o,s,c,d,l,u,f,p,m;return n8(this,function(_){switch(_.label){case 0:return a={main:null,blend:null,overlay:null,mask:null},i=[],(r=im(e)).main?[4,o8(r.main,Pm.main,t,n)]:[3,2];case 1:o=_.sent(),s=o[0],c=o[1],s&&(a.main=s,i.push(c)),_.label=2;case 2:return r.blend?[4,o8(r.blend,Pm.blend,t,n)]:[3,4];case 3:d=_.sent(),l=d[0],u=d[1],l&&(a.blend=l,i.push(u)),_.label=4;case 4:return r.overlay?[4,o8(r.overlay,Pm.overlay,t,n)]:[3,6];case 5:f=_.sent(),p=f[0],m=f[1],p&&(a.overlay=p,i.push(m)),_.label=6;case 6:return[2,[a,function(){i.forEach(function(e){return e()})}]]}})})}function c8(e){return t=this,void 0,a=function(){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(x){switch(x.label){case 0:return t=e.image,n=e.renderList,a=e.canvas,i=e.renderImage,r=e.textures,o=e.customEdits,s=e.errorCallback,c=e.engine,d=e.waitForLutsToLoad,l=e.setEffectLevels,u=e.restoreOverlayCanvas,f=e.needsLuts,p=e.cropTransformValues,m=e.imageTransformValues,[4,s8(t,r,s)];case 1:return _=x.sent(),h=_[0],b=_[1],null==u||u(),a&&(null==h?void 0:h.main)?(o&&(p=gi(o.cropRectangle),m=Wr(o.imageTransform)),f?[4,d()]:[3,3]):[2,null];case 2:x.sent(),x.label=3;case 3:return g={x:a.width,y:a.height},v=vi(p),a8(a,{x:v.width,y:v.height}),c&&(y=function(e,t,n,a){var i=n.getRenderWidth(),r=n.getRenderHeight(),o=vi(e),s=o.width,c=o.height;Jp(s)&&Jp(c)||a({id:"InvalidInput",message:"Expected integer input values for getTransformsToFitOutputImageInCanvas(). Received cropRectangle values of (width: ".concat(s,", height: ").concat(c,").")});var d=Math.min(i/s,r/c);return d<1?(a({id:"ImageTooBig",message:"Output image was resized because it exceeds max canvas drawing buffer size (width: ".concat(i,", height: ").concat(r,"), use getEditedImageBytes to get the full image data")}),{scaledCropTransform:ci(Ka(d),e),scaledImageTransform:ci(Ka(d),t)}):void 0}(p,m,c,s),y&&(p=y.scaledCropTransform,m=y.scaledImageTransform,v=vi(p),a8(a,{x:v.width,y:v.height}))),S=ci(qa(-v.left,-v.top),m),D=ci(qa(-v.left,-v.top),p),i(S,h,D,l),I=function(e){var t=document.createElement("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");return null==n||n.drawImage(e,0,0),t}(a),i8(a,g,b,n),I||s({id:"CreateEditedImageFailed",message:"Could not create edited image in HTMLCanvasElement format."}),[2,I]}})},new((n=void 0)||(n=Promise))(function(e,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(t,[])).next())});var t,n,a}function d8(e){return t=this,void 0,a=function(){var t,n,a;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(i){switch(i.label){case 0:return t=e.getRenderWidth(),n=e.getRenderHeight(),[4,e.readPixels(0,0,t,n,!0)];case 1:return a=i.sent(),[2,em(t,n,Xp.RGBA,new Uint8Array(a.buffer))]}})},new((n=void 0)||(n=Promise))(function(e,i){function r(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(t){var a;t.done?e(t.value):(a=t.value,a instanceof n?a:new n(function(e){e(a)})).then(r,o)}s((a=a.apply(t,[])).next())});var t,n,a}var l8=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},u8=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function f8(e){return l8(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I=this;return u8(this,function(x){switch(x.label){case 0:return t=e.image,n=e.renderList,a=e.canvas,i=e.renderImage,r=e.textures,o=e.customEdits,s=e.errorCallback,c=e.engine,d=e.waitForLutsToLoad,l=e.setEffectLevels,u=e.restoreOverlayCanvas,f=e.needsLuts,p=e.cropTransformValues,m=e.imageTransformValues,[4,s8(t,r,s)];case 1:return _=x.sent(),h=_[0],b=_[1],null==u||u(),a&&(null==h?void 0:h.main)&&c?(o&&(p=gi(o.cropRectangle),m=Wr(o.imageTransform)),f?[4,d()]:[3,3]):[2,null];case 2:x.sent(),x.label=3;case 3:g={x:a.width,y:a.height},v=function(e,t){return hc(Va(e),Ga,Di(t).y)}(m,p),y=vi(p),S=um(y,2048),D=em(y.width,y.height,Xp.RGBA);try{return S.forEach(function(e){return l8(I,void 0,void 0,function(){var t,n,r,o,s;return u8(this,function(d){switch(d.label){case 0:return a8(a,{x:e.width,y:e.height}),t=qa(-e.left,-e.top),n=ci(t,v),r=ci(t,p),i(n,h,r,l),[4,d8(c)];case 1:if(!(o=d.sent()))throw new Error("Error: Could not create edited image in ImageBytes format.");return u=e,f=-y.top,m=-y.left,(s=cn(cn({},u),{top:u.top+f,left:u.left+m})).top=y.height-s.top-s.height,function(e,t,n){if(!mn({top:t.y,left:t.x,width:e.width,height:e.height},{top:0,left:0,width:n.width,height:n.height}))throw new RangeError("Src of "+e.width+"x"+e.height+" at ("+t.x+","+t.y+") is not within dst "+n.width+"x"+n.height+" to be copied.");if(!cm(e.width,e.height,e.format,e.bytes)||!cm(n.width,n.height,n.format,n.bytes))throw Error("Byte array does not have a valid length.");for(var a=e.bytes,i=n.bytes,r=om(e.format),o=e.width*r,s=(n.width-e.width)*r,c=0,d=(t.y*n.width+t.x)*r,l=e.bytes.byteLength;c<l;)i.set(a.subarray(c,c+o),d),c+=o,d+=o+s}(o,{x:s.left,y:s.top},D),[2]}var u,f,m})})}),i8(a,g,b,n),[2,D]}catch(e){return s({id:"CreateEditedImageFailed",message:e instanceof Error?e.message:"unknown error"}),i8(a,g,b,n),[2,null]}return[2]}})})}function p8(e,t,n,a){if(void 0===n&&(n={left:0,top:0,width:t.x,height:t.y}),e){var i=e({x:n.width,y:n.height},function(e,t,n){return ci(qa(-t.left,-t.top),Ka(e.x,e.y),ei(fl(n)))}(t,n,a));return i&&(i.id=Sl().toString()),null!=i?i:void 0}}var m8=function(){return m8=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},m8.apply(this,arguments)};function _8(e,t){void 0===t&&(t=void 0);var n=Lm(e);if(!n)return null;var a={width:n.x,height:n.y,orientation:hm(e),id:"markupOverlay"+Sl().toString()};if(!t){var i=Xp.RGBA,r=n.x*n.y*om(i);return m8(m8({},a),{bytes:new Uint8Array(r),format:i})}return t.getHTMLCanvas?m8(m8({},a),{canvasMethods:t,renderCanvas:p8}):null}var h8=function(){return h8=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h8.apply(this,arguments)},b8=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},g8=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},v8=Object(s.forwardRef)(function(e,t){var n=Object(s.useContext)(gl),a=n.canvasContextIsValid,i=n.canvas,r=n.engine,o=n.effectRenderer,c=n.textures;if(!a)throw new SyntaxError("Invalid BabylonCanvasComponentContext.  The BabylonOffscreenImageRenderConnectImpl component must be used within an BabylonCanvas component");var d=Object(s.useContext)(Ld).registry;if(!d)throw new SyntaxError("Invalid ImageEffectContext.  The BabylonOffscreenImageRenderConnect component must be used within an BabylonImage component");var l=vl(rl(d)),u=Object(s.useContext)(k6),f=Object(s.useRef)(u);f.current=u;var p=function(){var e,t,n,a,i=Object(s.useContext)(dh).enableFilters,r=Object(s.useContext)(k6),o=r.textures,c=r.urlsById,d=r.loadUrls,l=!i||0!==Object.keys(o).length&&0!==Object.keys(c).length;return e=l,t=l?void 0:d,n=Object(s.useRef)(function(){}),a=Object(s.useState)(function(){return new Promise(function(e){return n.current=e})})[0],Object(s.useEffect)(function(){e&&n.current()},[e]),Object(s.useCallback)(function(){return t&&t(),a},[t,a])}();if(!Qb().getState().transformTools)throw new Error("Invalid redux store in BabylonOffscreenImageRenderConnect, must contain ITransformToolsState");return function(e,t,n,a,i,r){var o=this,c=Object(s.useContext)(Zt).logFailedToGetEditedImageEvent,d=Object(s.useContext)(Il).renderList,l=Object(s.useContext)(Wb).canvasMethods,u=Object(s.useContext)(lh).image,f=Object(s.useRef)(u);f.current=u;var p=Rm(),m=Qb(),_=Object(s.useCallback)(function(e,t){if(e){var n=_8(e,l);if(n)return h8(h8({},im(e)),{overlay:n})}return im(e)},[l]),h=function(){var e=Object(s.useContext)(Ld).registry,t=Object(s.useRef)(e);return t.current=e,Object(s.useCallback)(function(e){if(void 0!==e)return!0;if(t.current)return void 0!==(n=ES(t.current))&&0!==n.getLevel();var n;throw new Error("effectRegistryRef.current not set in getHasLuts")},[])}();Object(s.useImperativeHandle)(i,function(){var i={renderList:d,canvas:e,textures:t,renderImage:n,engine:r,waitForLutsToLoad:a};return{getEditedImageBytes:function(e,t,n){return b8(o,void 0,void 0,function(){var a,o,s,d,u,f,b,g;return g8(this,function(v){switch(v.label){case 0:return a=null,r?(o=m.getState(),s=o.transformTools,d=s.cropInteraction.uvToWorld,u=s.image,f=u._preciseUvToWorld,b=u.originalPixelSize,g=_(e,b),[4,f8(h8(h8({},i),{image:g,cropTransformValues:d,imageTransformValues:f,customEdits:t,errorCallback:p,setEffectLevels:n,restoreOverlayCanvas:l.restoreHTMLCanvas,needsLuts:h(n)}))]):[3,2];case 1:a=v.sent(),v.label=2;case 2:return a?a.id=Dt():c(),[2,a]}})})},getEditedImage:function(t,n,a){return b8(o,void 0,void 0,function(){var r,o,s,d,u,f,b,g;return g8(this,function(v){switch(v.label){case 0:return r=null,e?(o=m.getState(),s=o.transformTools,d=s.cropInteraction.uvToWorld,u=s.image,f=u._preciseUvToWorld,b=u.originalPixelSize,g=_(t,b),[4,c8(h8(h8({},i),{image:g,cropTransformValues:d,imageTransformValues:f,customEdits:n,errorCallback:p,setEffectLevels:a,restoreOverlayCanvas:l.restoreHTMLCanvas,needsLuts:h(a)}))]):[3,2];case 1:r=v.sent(),v.label=2;case 2:return r||c(),[2,r]}})})},getImageLayerBytes:function(e){var n=f.current;if(!n)throw new Error("texture not found in getImageLayerBytes");var a=im(n)[e],i=a&&(null==t?void 0:t.getAlreadyLoadedTexture(a));if(!i)return Promise.resolve(null);if(!r)throw new Error("engine not defined");var o=i.width,s=i.height,c=sh(i,{top:0,left:0,width:o,height:s},r);return Promise.resolve({bytes:new Uint8Array(c),width:o,height:s,orientation:void 0,format:Xp.RGBA,id:Dt()})}}},[d,e,t,n,r,a,m,_,p,l,c,h])}(i,c,Object(s.useCallback)(function(e,t,n,a){var i,s,c,u=void 0,p=(i=n,s=void 0,(c=d.getEffects().find(function(e){return e.getName()===Y6}))&&i&&(s=c.getTransform(),c.setTransform(i)),function(){c&&s&&c.setTransform(s)}),m=AS(d,t.overlay?1:0);a&&(u=a(d,{lutTextures:f.current.textures,lutUrlsById:f.current.urlsById})),hl(e,d,cl,l,t,r,o,!0),u&&u(),p(),m()},[d,l,r,o]),p,t,r),null}),y8=c.a.memo(function(e){var t=e.shouldSetMarkupOverlay,n=e.shouldSetEmptyMarkupOverlay,a=e.currentContentHash,i=e.setWaitingForMarkupOverlayTexture,r=Object(s.useContext)(lh),o=r.image,c=r.setImageLayer,d=Object(s.useContext)(Wb),l=d.canvasMethods,u=d.wetCanvasIsReady,f=d.setCanvasMethods,p=Object(s.useRef)(function(){throw new Error("generateMarkupOverlayImage function is empty")}),m=Object(s.useRef)(a),_=Object(s.useCallback)(function(){i(!0),u&&(p.current(),f(Kb))},[f,i,u]);return Object(s.useEffect)(function(){p.current=function(){if(!(l.getHTMLCanvas&&l.restoreHTMLCanvas&&o))throw new Error("canvasMethods missing in generateMarkupOverlayImage");c("overlay",_8(o,l))}},[l,o,c]),Object(s.useEffect)(function(){m.current!==a&&(t?_():n&&""===a&&o&&c("overlay",_8(o)),m.current=a)},[o,u,f,t,n,i,_,a,c]),Object(s.useEffect)(function(){var e=am(o)&&o.overlay;t&&!e&&_()},[u,o,f,i,t,_]),null}),S8={setWaitingForMarkupOverlayTexture:Es},D8=Object(ee.connect)(function(e){var t=e.uiState.activeEditorActivity===io,n=e.markup.markupContentItems.length>0,a=e.markup.undoRedoStack.redoStack.length>0,i=n||a,r=i&&!t&&!!jo(e),o=i&&t&&""!==e.uiState.nextEditorActivity,s=e.markup.markupContentItems.map(function(e){return"".concat(e.id)}).join("_"),c=!t;return{originalImagePixelSize:e.transformTools.image.originalPixelSize,shouldSetMarkupOverlay:r||o,currentContentHash:s,shouldSetEmptyMarkupOverlay:c}},S8)(y8);function I8(e,t){return Object(s.useCallback)(function(n){e(),t(n)},[t,e])}var x8,C8=function(e){return e.toFixed(0)},O8=function(){return O8=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},O8.apply(this,arguments)},w8=function(){return w8=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},w8.apply(this,arguments)},E8=function(){return E8=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},E8.apply(this,arguments)},A8=c.a.memo(function(e){var t=e.cursor,n=e.cssToPhysicalPixelRatio,a=e.onPointerDown,i=e.onPointerMove,r=e.onPointerUp,o=e.onPointerEnter,d=e.onPointerLeave,l=e.onWheel,f=e.onTouchDown,p=e.onTouchMove,m=e.onTouchUp,_=e.onDoubleTap,h=e.panView,b=e.panViewTopLeftCornerFromCropOrigin,g=e.setAriaAnnouncementScenario,v=e.requestTexturePatch,y=e.spotFixRadiusInScreenPixels,S=e.imageUvToView,D=e.zoomLevel,I=e.originalImageSize,x=e.pointerHasDraggedBeyondSpotFixClickThreshold,C=e.setSpotFixTipVisibilityState,O=e.onUnmount,w=e.cursorScreenPosition,E=e.setSpotFixCursorScreenPosition,A=e.worldToViewTransform,L=e.pixelRoundedImageUvToWorld,k=(e.isRetouchActivityActive,e.setSpotFixRadiusInScreenPixels),M=e.spotFixAlgorithmParams,P=e.setShouldShowSpotFixCursorAtCenter,T=e.isTexturePatchAppliedBeforeAutoEnhanceInstallation,U=Object(s.useState)(null),F=U[0],H=U[1],R=Object(s.useState)(!1),N=R[0],B=R[1],j=$(),V=Object(s.useContext)(Ze).strings,z=Object(s.useContext)(dh),G=z.enableAutoEnhance,K=z.useBuiltInAutoEnhance,W=Object(s.useState)(M),q=W[0],Q=W[1];Object(s.useEffect)(function(){var e=["main"];T||!G||K||e.push("blend"),Q(function(t){return E8(E8({},t),{layersToPatch:e})})},[G,T,K]);var Y=function(e,t,n,a,i,r){var o=Object(s.useContext)(lh).image,c=o?hm(o):1,d=Object(s.useRef)(a);d.current=a;var l=Object(s.useRef)(n);return l.current=n,Object(s.useCallback)(function(n){var a=function(e,t,n,a,i,r){var o=function(e,t,n){return void 0===n&&(n=1),si(ml(n,e),t)}(t,r,i),s=pl(i)?{x:a.y,y:a.x}:a,c=function(e,t,n,a){return{center:Ha(e,t),radius:a/n}}(o,s,n,e),d={top:0,left:0,width:s.x,height:s.y},l=hn(Eh(c),d);if(void 0!==l&&0!==l.width&&0!==l.height)return c}(t,l.current,d.current,i,c,n.cursorScreenPosition);a&&e(w8(w8({},r),{maskType:Ih.CircleMask,pixelCircle:a}))},[e,t,i,c,r])}(v,y,S,D,I,q),J=Object(s.useRef)(x);J.current=x;var X=Object(s.useCallback)(function(e){J.current||Y({cursorScreenPosition:e.pointerPhysicalPixelPos})},[Y]),Z=Object(s.useCallback)(function(){return C("alreadyShown")},[C]),ee=I8(Z,a),te=I8(Z,l),ne=I8(Z,h),ae=I8(Z,E),ie=Object(s.useCallback)(function(e){i(e),E(e.pointerPhysicalPixelPos)},[i,E]);return Cp({htmlElement:F,cssToPhysicalPixelRatio:n,onPointerDown:ee,onPointerMove:ie,onPointerUp:r,onPointerEnter:o,onPointerLeave:d,onClick:X,onUnmount:O}),Op(n,F,f,p,m,_),pp(n,F,te),up(F),Py(F,ne,b,g),function(e,t,n,a,i,r,o,s,c){var d=Object(u.getRTL)(c),l=2*o,f=function(e){var t=l,n=Math.min(100,Math.max(10,t+e));s({radius:n/2,isChanging:!0})},p=function(e){Cr(e,a,i)&&t(e)},m=[{code:"KeyD",keyCode:Uy.D,handler:function(t,n,a){t&&p(O8(O8({},e),{x:e.x+In(a)}))},ctrlKey:!1,shiftKey:!1},{code:"KeyA",keyCode:Uy.A,handler:function(t,n,a){t&&p(O8(O8({},e),{x:e.x-In(a)}))},ctrlKey:!1,shiftKey:!1},{code:"KeyS",keyCode:Uy.S,handler:function(t,n,a){t&&p(O8(O8({},e),{y:e.y+In(a)}))},ctrlKey:!1,shiftKey:!1},{code:"KeyW",keyCode:Uy.W,handler:function(t,n,a){t&&p(O8(O8({},e),{y:e.y-In(a)}))},ctrlKey:!1,shiftKey:!1},{code:"ArrowRight",keyCode:Uy.ArrowRight,handler:function(t,n,a){t&&p(O8(O8({},e),{x:e.x+In(a)}))},ctrlKey:!0,shiftKey:!1},{code:"ArrowLeft",keyCode:Uy.ArrowLeft,handler:function(t,n,a){t&&p(O8(O8({},e),{x:e.x-In(a)}))},ctrlKey:!0,shiftKey:!1},{code:"ArrowDown",keyCode:Uy.ArrowDown,handler:function(t,n,a){t&&p(O8(O8({},e),{y:e.y+In(a)}))},ctrlKey:!0,shiftKey:!1},{code:"ArrowUp",keyCode:Uy.ArrowUp,handler:function(t,n,a){t&&p(O8(O8({},e),{y:e.y-In(a)}))},ctrlKey:!0,shiftKey:!1},{code:"Enter",keyCode:Uy.Enter,handler:function(t){t&&n({cursorScreenPosition:e})},ctrlKey:!1,shiftKey:!1},{code:"Space",keyCode:Ny,handler:function(t){t&&n({cursorScreenPosition:e})},ctrlKey:!1,shiftKey:!1},{code:"BracketRight",keyCode:jy,handler:function(e){e?f(d?-1:1):s({radius:l/2,isChanging:!1})},ctrlKey:!1,shiftKey:!1},{code:"BracketLeft",keyCode:By,handler:function(e){e?f(d?1:-1):s({radius:l/2,isChanging:!1})},ctrlKey:!1,shiftKey:!1}];function _(e){return m.find(function(t){return t.ctrlKey===e.ctrlKey&&t.shiftKey===e.shiftKey&&(t.code===e.code||t.keyCode===e.keyCode)})}fp({numRepeatsToSwitchToFast:10,keyboardEventTarget:window,handleKeyboardDown:function(e,t){var n;null===(n=_(e))||void 0===n||n.handler(!0,e,t)},isFastDirectionKeyCode:wn,handleKeyboardUp:function(e){var t;null===(t=_(e))||void 0===t||t.handler(!1,e)}})}(w,ae,Y,A,L,0,y,k,j),Object(s.useEffect)(function(){return document.activeElement===F&&P(N),function(){return P(!1)}},[F,N,P]),c.a.createElement("div",{onMouseMove:function(){return B(!1)},onClick:function(){return B(!1)},onKeyUp:function(){return B(!0)},ref:H,className:Ly,style:{cursor:t,outlineColor:j.palette.neutralDark},"data-is-focusable":!0,"aria-label":V.spotFix_calloutMainText,role:"button",tabIndex:0,"data-test-id":"nonCrop_canvas"})}),L8=Object(ga.e)([Vo],function(e){return e}),k8={defaultSpotFixRadiusInScreenPixels:30,userChosenSpotFixRadiusInScreenPixels:void 0,spotFixCursorRadiusIsChanging:!1,spotFixSampleSizeFactor:3,spotFixMouseCursorIsActive:!1,spotFixTipVisibilityState:"notShown",cursorScreenPosition:{x:0,y:0},algorithmParameters:{algorithmType:_h.spotFix,maskType:Ih.CircleMask,pixelCircle:{center:{x:0,y:0},radius:1},layersToPatch:[]},shouldShowSpotFixCursorAtCenter:!1},M8=Object(te.n)({name:"spotFixUi",initialState:k8,reducers:{setDefaultSpotFixRadiusInScreenPixels:function(e,t){e.defaultSpotFixRadiusInScreenPixels=t.payload},setSpotFixRadiusInScreenPixels:function(e,t){e.userChosenSpotFixRadiusInScreenPixels=t.payload.radius,e.spotFixCursorRadiusIsChanging=t.payload.isChanging,t.payload.isChanging&&"showing"===e.spotFixTipVisibilityState&&(e.spotFixTipVisibilityState="alreadyShown")},setSpotFixSampleSizeFactor:function(e,t){e.spotFixSampleSizeFactor=t.payload},setSpotFixTipVisibilityState:function(e,t){e.spotFixTipVisibilityState=t.payload},setSpotFixCursorScreenPosition:function(e,t){e.cursorScreenPosition=t.payload,e.spotFixMouseCursorIsActive=!0},setShouldShowSpotFixCursorAtCenter:function(e,t){e.shouldShowSpotFixCursorAtCenter=t.payload},setSpotFixMouseCursorIsActive:function(e,t){e.spotFixMouseCursorIsActive=t.payload},setSpotFixAlgorithmParameters:function(e,t){e.algorithmParameters=t.payload}},extraReducers:function(e){e.addCase(re,function(e,t){e.spotFixMouseCursorIsActive=!0}),e.addCase(ie,function(e,t){e.spotFixMouseCursorIsActive=!0}),e.addCase(oe,function(e,t){e.spotFixMouseCursorIsActive=!1}),e.addCase(Os,function(e,t){e.spotFixMouseCursorIsActive=!1,t.payload!==ro&&"showing"===e.spotFixTipVisibilityState&&(e.spotFixTipVisibilityState="alreadyShown")})}}),P8=(x8=M8.actions).setDefaultSpotFixRadiusInScreenPixels,T8=x8.setSpotFixRadiusInScreenPixels,U8=(x8.setSpotFixSampleSizeFactor,x8.setSpotFixTipVisibilityState),F8=x8.setSpotFixCursorScreenPosition,H8=(x8.setSpotFixAlgorithmParameters,x8.setShouldShowSpotFixCursorAtCenter),R8=(x8.setSpotFixMouseCursorIsActive,M8.reducer),N8={onPointerMove:ie,onPointerDown:ne,onPointerUp:ae,onPointerEnter:re,onPointerLeave:oe,onWheel:$c,onTouchDown:id,onTouchMove:rd,onTouchUp:od,onDoubleTap:dd,onUnmount:sd,panView:Cd,setAriaAnnouncementScenario:Xn,requestTexturePatch:de,setSpotFixTipVisibilityState:U8,setSpotFixCursorScreenPosition:F8,setSpotFixRadiusInScreenPixels:T8,setShouldShowSpotFixCursorAtCenter:H8},B8=Object(ee.connect)(function(e){var t=e.transformTools.device.pixelRatio,n=Gp(e),a=wm(e),i=Kp(e),r=L8(e),o=Np(e),s=To(e),c=Pp(e),d=e.uiState.activeEditorActivity===ro,l=e.spotFixUi.algorithmParameters,u=zy(e),f=e.autoEnhance.isTexturePatchAppliedBeforeAutoEnhanceInstallation;return{cssToPhysicalPixelRatio:t,cursor:n,panViewTopLeftCornerFromCropOrigin:u,spotFixRadiusInScreenPixels:Bp(e),imageUvToView:a,zoomLevel:i,originalImageSize:r,pointerHasDraggedBeyondSpotFixClickThreshold:o,cursorScreenPosition:jp(e),worldToViewTransform:s,pixelRoundedImageUvToWorld:c,isRetouchActivityActive:d,spotFixAlgorithmParams:l,isTexturePatchAppliedBeforeAutoEnhanceInstallation:f}},N8)(A8);var j8="CirclePlaceHolderShader",V8="uEnabled@",z8=function(){function e(){this._enabled=!0}return e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.getName=function(){return j8},e.prototype.getUniformNames=function(e){return[e(V8)]},e.prototype.getFunctions=function(e){return[]},e.prototype.getHeaderCode=function(e){return e("\n        //CirclePlaceHolderShader effect---\n        uniform float ".concat(V8,";\n        "))},e.prototype.getShaderFunctionBody=function(e){return e("\n      //".concat(j8," ---\n      if(").concat(V8," > 0.){\n        vec2 uvCenter = vec2(0.5,0.5);\n        float distanceFromCenter = length(").concat(Rd,".xy - uvCenter);\n        finalAlphaMultiply =  1. - smoothstep(0.48,0.5,distanceFromCenter);\n      }  \n      "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(V8),this._enabled?1:0)},e}(),G8=function(e){var t=e.enabled,n=void 0===t||t,a=Object(s.useMemo)(function(){return new z8},[]);return Ul(a),a.setEnabled(!!n),wl(n),null},K8=[.929,.922,.914,.8],W8=[.784,.776,.769,.8],q8=Object(s.memo)(function(e){var t=e.allTexturePatchRequests,n=e.originalImageSize,a=e.imageUvToView,i=function(e,t,n,a,i,r){void 0===r&&(r=100);var o=Object(s.useState)(t),c=o[0],d=o[1];return Object(s.useEffect)(function(){if(e){var i=Date.now(),o=setInterval(function(){var e=Date.now()-i;if(e<a)d(t);else{var r=.5+.5*Math.sin((e-a)*Math.PI*2/2e3);d(function(e,t,n){return[tn(e[0],t[0],n),tn(e[1],t[1],n),tn(e[2],t[2],n),tn(e[3],t[3],n)]}(t,n,r))}},r);return function(){clearInterval(o)}}d(t)},[e,t,n,a,2e3,r]),c}(0!==t.length,K8,W8,3e3),r=Object(s.useContext)(lh).image;return r?c.a.createElement(c.a.Fragment,null,t.map(function(e){var t=e.maskType===Ih.CircleMask?e.pixelCircle:void 0;if(void 0!==t)return c.a.createElement(Ml,{key:e.id,transform:Q8(t,r,n,a),color:i,zIndex:2},c.a.createElement(G8,null));var o=e.maskType===Ih.RectangleMask?e.rectUvToImageUv:void 0;return void 0!==o?c.a.createElement(Ml,{key:e.id,transform:ci(a,o),color:i,zIndex:2}):null})):null});function Q8(e,t,n,a){var i=Lm(t)||n,r=function(e,t){return ci(t,fl(e?hm(e):1))}(t,a);return function(e,t,n){var a=function(e,t){return Fa({x:e,y:e},t)}(2*e.radius,t),i=function(e,t,n){var a=function(e,t){return Fa(e,t)}(e,t);return La(a,Ma(n,.5))}(e.center,t,a);return ci(n,qa(i.x,i.y),Ka(a.x,a.y))}(e,i,r)}var Y8=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},J8=Object(ee.connect)(function(e){var t=wm(e),n=L8(e);return{allTexturePatchRequests:Y8(Y8([],e.texturePatch.texturePatchRequests,!0),e.texturePatch.pendingTexturePatchRequests,!0),imageUvToView:t,originalImageSize:n}})(q8),X8="uCursorScreenPos@",Z8="uEnabled@",$8="uRotationInRadians@",e5="uCursorRadius@",t5=A7(16),n5=function(){function e(){this._cursorScreenPosition={x:0,y:0},this._enabled=!1,this._animTimeMilliseconds=0,this._cursorRadiusInScreenPixels=20}return e.prototype.setCursorScreenPosition=function(e){this._cursorScreenPosition=e},e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.setAnimTimeMilliseconds=function(e){this._animTimeMilliseconds=e},e.prototype.setCursorRadiusInScreenPixels=function(e){this._cursorRadiusInScreenPixels=e},e.prototype.getName=function(){return"SPOT_FIX_CURSOR_SHADER_NAME"},e.prototype.getUniformNames=function(e){return[e(X8),e(Z8),e($8),e(e5)]},e.prototype.getFunctions=function(e){return["\n#ifndef SMOOTH_BUMP\n#define SMOOTH_BUMP\nfloat smoothBump(float x1,float x2, float x3, float x4,float x){\n  return mix(smoothstep(x1,x2,x),1. - smoothstep(x3,x4,x),step(x3,x));\n}\n#endif\n"]},e.prototype.getHeaderCode=function(e){return e("\n        //SpotFixCursorShader effect---\n        uniform vec2 ".concat(X8,";\n        uniform float ").concat(Z8,";\n        uniform float ").concat($8,";\n        uniform float ").concat(e5,";\n        "))},e.prototype.getShaderFunctionBody=function(e){return e("\n            // SpotFixCursorShader effect---\n            if(".concat(Z8," > 0.){\n              float distance@ = distance(").concat(X8,", ").concat(Nd,");                \n              float alpha@ = smoothBump(").concat(e5,"-1.0,").concat(e5,",").concat(e5," + ").concat(A7(1),",").concat(e5," + ").concat(A7(1),"+1.0, distance@);\n\n              if(alpha@ > 0.){\n                vec2 offset@ = normalize(").concat(Nd," - ").concat(X8,"); \n                float theta@ = atan(offset@.y, offset@.x) + ").concat($8,";\n                float arcLenth@ = ").concat(e5,"*theta@;\n                float numDashesInCircle@ = ").concat(t5,";\n                float dashLength@ = 2. * ").concat(Math.PI," * ").concat(e5," / numDashesInCircle@;\n                float lineAlt@ = mod(arcLenth@, dashLength@ * 2.);\n                float bumpVal@ = smoothBump(dashLength@ * 0.5 - 0.5,dashLength@ * 0.5 + 0.5,dashLength@ * 1.5 - 0.5,dashLength@ * 1.5 + 0.5,  lineAlt@);\n                vec4 color1@ = vec4(1., 1., 1., 1.);\n                vec4 color2@ = vec4(0., 0., 0., 1.);\n                gl_FragColor =  mix(gl_FragColor,mix(color1@,color2@, bumpVal@), alpha@);\n              }\n            }\n        "))},e.prototype.getRotationInRadians=function(){return-2*Math.PI*(this._animTimeMilliseconds%5e3)/5e3},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat2(t(X8),this._cursorScreenPosition.x,this._cursorScreenPosition.y),e.setFloat(t(Z8),this._enabled?1:0),e.setFloat(t($8),this.getRotationInRadians()),e.setFloat(t(e5),this._cursorRadiusInScreenPixels)},e}(),a5=function(e){var t=e.cursorScreenPosition,n=e.enabled,a=e.cursorRadiusInScreenPixels,i=Object(s.useMemo)(function(){return new n5},[]);i.setCursorScreenPosition(t),Al(t),i.setEnabled(n),wl(n),wl(a);var r=Object(s.useState)(0),o=r[0],c=r[1];return Object(s.useEffect)(function(){if(n){var e=setInterval(function(){c((new Date).getTime())},100);return function(){clearInterval(e)}}},[n,c]),i.setAnimTimeMilliseconds(o),wl(o),i.setCursorRadiusInScreenPixels(a),wl(a),Ul(i),null},i5=Object(s.memo)(function(e){var t,n,a=e.cursorScreenPosition,i=e.cursorContainerSizeInScreenPixels,r=e.cursorRadiusInScreenPixels,o=e.isSpotFixCursorVisible,d=e.pointerIsDown,l=dt(),u=(t=a,n={width:i,height:i},Object(s.useMemo)(function(){return gi(function(e,t){return{left:e.x-t.width/2,top:e.y-t.height/2,width:t.width,height:t.height}}(t,n))},[t,n])),f=o&&d?K8:dl;return c.a.createElement(Ml,{key:l,transform:u,color:f,zIndex:2},c.a.createElement(a5,{cursorScreenPosition:a,cursorRadiusInScreenPixels:r,enabled:o&&!d}),c.a.createElement(G8,{enabled:o&&d}))}),r5=Object(ee.connect)(function(e){var t=Bp(e),n=2*(t+1);return{cursorScreenPosition:jp(e),cursorContainerSizeInScreenPixels:n,isSpotFixCursorVisible:zp(e),cursorRadiusInScreenPixels:t,pointerIsDown:Go(e)}})(i5),o5={setCalloutVisibilityState:U8},s5=Object(ee.connect)(function(e){return{calloutVisibilityState:e.spotFixUi.spotFixTipVisibilityState}},o5)(h9),c5={activeSection:{transition:"none"},thumb:{transition:"none"},inactiveSection:{transition:"none"}},d5=Object(s.memo)(function(e){var t,n=e.spotFixDiameter,a=e.setSpotFixDiameter,i=e.styles,r=e.layout,o=e.label,d=e.iconName,l=e.hideSliderValueAfterInactivity,f=e.spotFixSliderHeaderRef,p=$(),m=100,_=C8,h=Object(s.useContext)(Ze),b=h.localizeNumber,g=h.strings,v=Object(s.useState)(!1),y=v[0],S=v[1],D=Object(s.useCallback)(function(e){a(e,!0),S(!0)},[a]),I=Object(s.useMemo)(function(){var e;return Object(u.concatStyleSets)(bt(p),c5,null===(e=i.getSliderStyles)||void 0===e?void 0:e.call(i,p))},[i,p]),x={value:n,valueFormatter:_,maxValue:m,minValue:10,label:o,iconName:d,shouldShow:y||!l},C=Object(s.useCallback)(function(e){var t=n,i=0;if(e.ctrlKey)e.preventDefault();else{switch(e.key){case kn("ArrowLeft",p):case"ArrowDown":i=-1;break;case kn("ArrowRight",p):case"ArrowUp":i=1;break;case"Home":t=10;break;case"End":t=m;break;default:return}var r=Math.min(m,Math.max(10,t+i));a(r,!0),e.preventDefault(),e.stopPropagation()}},[a,m,10,1,n,p]),O=Object(s.useCallback)(function(e){a(n,!1),e.preventDefault(),e.stopPropagation()},[a,n]);return c.a.createElement("div",{style:null==i?void 0:i.container,"data-testid":"spotFixSliderContainer"},c.a.createElement(sn,{headerProps:x,layout:r,styles:null===(t=null==i?void 0:i.getSliderHeaderStyles)||void 0===t?void 0:t.call(i,p),ref:f}),c.a.createElement(ht,{min:10,max:m,step:1,value:n,styles:I,showValue:!1,onChange:D,ariaValueText:b,onChanged:function(e,t){a(t,!1),S(!1)},ariaLabel:g.spotFix_header,buttonProps:{title:g.spotFix_sizeSliderTooltip,onKeyDown:C,onKeyUp:O}}))}),l5=Object(ee.connect)(function(e){return{spotFixDiameter:2*Bp(e)}},function(e){return Object(uc.t)({setSpotFixDiameter:function(e,t){return T8({radius:e/2,isChanging:t})}},e)})(d5),u5=Object(s.memo)(function(e){var t=e.spotFixSizeSliderStyles,n=e.sliderLayout,a=void 0===n?"Labeled":n,i=e.hideSliderValueAfterInactivity,r=e.spotFixSliderHeaderRef,o=Object(s.useContext)(Ze).strings;return c.a.createElement(l5,{layout:a,styles:t,label:o.spotFix_sizeSliderHeader,iconName:"BullseyeTarget",hideSliderValueAfterInactivity:i,spotFixSliderHeaderRef:r})}),f5={calloutHeader:{fontSize:"20px",padding:"20px 24px 12px"},calloutContent:{fontSize:"12px",padding:"0px 24px 20px"},calloutMain:{root:{width:"343px"}}};Object($e.loadStyles)([{rawString:".sectionHeader_2812b441{font-size:16px;font-weight:500;line-height:42px;margin:25px 0 6px}"}]);var p5=function(){return p5=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},p5.apply(this,arguments)},m5=Object(s.memo)(function(e){var t=e.size,n=e.header,a=e.footer,i=e.styles,r=e.spotFixControlPanelStyles,o=e.isCalloutEnabled,d=void 0!==o&&o,l=Object(s.useContext)(Ze).strings,f=Object(s.useRef)(null),p=Object(s.useMemo)(function(){return Object(u.merge)(p5({},f5),p5({},r.textCalloutStyles))},[r.textCalloutStyles]);return c.a.createElement(tt,{styles:i,size:t,header:n,footer:a},c.a.createElement("div",{className:"sectionHeader_2812b441",style:null==r?void 0:r.sectionHeader},l.spotFix_header),d&&c.a.createElement(s5,{target:f,styles:p,calloutHeaderText:l.spotFix_calloutHeaderText,calloutMainText:l.spotFix_calloutMainText}),c.a.createElement(u5,{spotFixSizeSliderStyles:r.sliderStyles,spotFixSliderHeaderRef:f}))}),_5=Object(s.memo)(function(e){var t=e.defaultRadiusInScreenPixels,n=e.setDefaultSpotFixRadiusInScreenPixels;return Object(s.useEffect)(function(){n(t)},[n,t]),null}),h5={setDefaultSpotFixRadiusInScreenPixels:P8},b5=Object(ee.connect)(null,h5)(_5),g5=Object(s.memo)(function(e){var t=e.setInstallationStatus,n=Object(s.useContext)(dh).autoEnhanceInstallationInfo;return Object(s.useEffect)(function(){t(n)},[n,t]),null}),v5={setInstallationStatus:sb},y5=Object(ee.connect)(null,v5)(g5);function S5(e,t){if(e[0]&&e[1]){var n=ti(t,e[0]),a=ti(t,e[1]),i=gi({top:n.y,left:n.x,width:a.x-n.x,height:a.y-n.y});return ci(ei(t),i)}}var D5=function(){return D5=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},D5.apply(this,arguments)},I5=function(){return I5=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},I5.apply(this,arguments)};function x5(e,t,n){if(e[0]&&e[1]){if(0===Ba(e[0],e[1]))return;var a=Ha(e[0],n),i=Ha(e[1],n),r=ka(La(i,a)),o=(_=r,h=90/xa,b=Math.cos(h),g=Math.sin(h),{x:b*(v=_.x)-g*(y=_.y),y:g*v+b*y}),s=Ma(r,t),c=Ma(o,t),d=Ma(s,-1),l=Ma(c,-1),u=Aa([a,d,l]),f=Ma(u,-1),p=Aa([i,s,l,f]),m=Aa([a,d,c,f]);return ci(ei(Ka(n.x,n.y)),function(e,t,n){return[e.x,t.x,n.x,e.y,t.y,n.y]}(p,m,u))}var _,h,b,g,v,y}var C5,O5=function(){return O5=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},O5.apply(this,arguments)},w5=((C5={})[Ih.RectangleMask]=function(e){var t=e.algorithmParameters,n=S5(e.selectedUvPositions,e.imageUvToView);if(n)return D5(D5({},t),{maskType:Ih.RectangleMask,rectUvToImageUv:n})},C5[Ih.FromMaskLayer]=function(e){var t=e.algorithmParameters;return I5(I5({},t),{maskType:Ih.FromMaskLayer})},C5[Ih.PillShapedMask]=function(e){var t=e.algorithmParameters,n=e.selectedUvPositions,a=e.imageSizeInPixels;if(t.maskType!==Ih.PillShapedMask)throw new Error("unexpected mask type");var i=x5(n,t.radius,a);if(i)return O5(O5({},t),{maskType:Ih.PillShapedMask,rectUvToImageUv:i})},C5[Ih.CircleMask]=function(){throw new Error("request circle mask texture patch not implemented")},C5);function E5(e){return w5[e]}var A5,L5=[1,0,0,1],k5=c.a.memo(function(e){var t=e.cursor,n=e.cssToPhysicalPixelRatio,a=e.onPointerDown,i=e.onPointerMove,r=e.onPointerUp,o=e.onPointerEnter,d=e.onPointerLeave,l=e.onWheel,u=e.onTouchDown,f=e.onTouchMove,p=e.onTouchUp,m=e.onDoubleTap,_=e.panView,h=e.panViewTopLeftCornerFromCropOrigin,b=e.setAriaAnnouncementScenario,g=e.imageUvToView,v=e.originalImageSize,y=e.onUnmount,S=e.setSelectedUvPositions,D=e.setPointerMovePixelPos,I=e.algorithmParameters,x=e.clearSelectedUvPositions,C=e.requestTexturePatch,O=Object(s.useState)(null),w=O[0],E=O[1],A=$(),L=Object(s.useContext)(Ze).strings,k=Object(s.useRef)(g);k.current=g;var M=Object(s.useRef)(null),P=Object(s.useRef)(null),T=Object(s.useCallback)(function(){},[]),U=I.maskType,F=Object(s.useCallback)(function(e){P.current=e.pointerPhysicalPixelPos,a(e),M.current=e.pointerPhysicalPixelPos;var t=si(k.current,e.pointerPhysicalPixelPos);S([t])},[a,S]),H=Object(s.useCallback)(function(e){if(D(e.pointerPhysicalPixelPos),null!==M.current){var t=si(k.current,M.current),n=si(k.current,e.pointerPhysicalPixelPos);if(S([t,n]),U===Ih.FromMaskLayer&&P.current){var a=[si(k.current,P.current),si(k.current,e.pointerPhysicalPixelPos)];!function(e,t,n,a){var i={algorithmType:_h.colorReplacement,color:L5,layersToPatch:["mask"],maskType:Ih.PillShapedMask,rectUvToImageUv:[1,0,0,0,1,0],radius:50},r=E5(i.maskType)({selectedUvPositions:t,algorithmParameters:i,imageUvToView:e,imageSizeInPixels:n});r&&a(r)}(k.current,a,v,C)}P.current=e.pointerPhysicalPixelPos}i(e)},[D,i,S,U,v,C]),R=Object(s.useCallback)(function(e){if(r(e),null!==M.current){var t=si(k.current,M.current),n=si(k.current,e.pointerPhysicalPixelPos);S([t,n]),M.current=null}},[r,S]);return Cp({htmlElement:w,cssToPhysicalPixelRatio:n,onPointerDown:F,onPointerMove:H,onPointerUp:R,onPointerEnter:o,onPointerLeave:d,onClick:T,onUnmount:y}),Op(n,w,u,f,p,m),pp(n,w,l),up(w),Py(w,_,h,b),Object(s.useEffect)(function(){U!==Ih.RectangleMask&&U!==Ih.PillShapedMask||x()},[U,x]),c.a.createElement("div",{ref:E,className:Ly,style:{cursor:t,outlineColor:A.palette.neutralDark},"data-is-focusable":!0,"aria-label":L.spotFix_calloutMainText,role:"button",tabIndex:0,"data-test-id":"nonCrop_canvas"})}),M5={algorithmParameters:{algorithmType:_h.dallE2,prompt:"a photo",maskType:Ih.RectangleMask,rectUvToImageUv:[1,0,0,0,1,0],layersToPatch:["main"]},selectedUvPositions:[],pointerMovePixelPos:{x:0,y:0},disclaimerHasShown:!1},P5=Object(te.n)({name:"inPaintingUi",initialState:M5,reducers:{setInPaintingAlgorithmParameters:function(e,t){e.algorithmParameters=t.payload},setSelectedUvPositions:function(e,t){e.selectedUvPositions=t.payload},clearSelectedUvPositions:function(e,t){e.selectedUvPositions=[]},setPointerMovePixelPos:function(e,t){e.pointerMovePixelPos=t.payload},setDisclaimerHasShown:function(e,t){e.disclaimerHasShown=t.payload}},extraReducers:function(e){e.addCase(se,function(e,t){return M5}).addCase(Os,function(e,t){e.selectedUvPositions=[]})}}),T5=(A5=P5.actions).setInPaintingAlgorithmParameters,U5=A5.setSelectedUvPositions,F5=A5.clearSelectedUvPositions,H5=A5.setPointerMovePixelPos,R5=A5.setDisclaimerHasShown,N5=P5.reducer,B5={onPointerMove:ie,onPointerDown:ne,onPointerUp:ae,onPointerEnter:re,onPointerLeave:oe,onWheel:$c,onTouchDown:id,onTouchMove:rd,onTouchUp:od,onDoubleTap:dd,onUnmount:sd,panView:Cd,setAriaAnnouncementScenario:Xn,requestTexturePatch:de,setSpotFixTipVisibilityState:U8,setSpotFixCursorScreenPosition:F8,setSpotFixRadiusInScreenPixels:T8,setShouldShowSpotFixCursorAtCenter:H8,setSelectedUvPositions:U5,setPointerMovePixelPos:H5,clearSelectedUvPositions:F5},j5=Object(ee.connect)(function(e){return{cssToPhysicalPixelRatio:e.transformTools.device.pixelRatio,cursor:Gp(e),imageUvToView:wm(e),originalImageSize:L8(e),panViewTopLeftCornerFromCropOrigin:zy(e),algorithmParameters:e.inPaintingUi.algorithmParameters}},B5)(k5),V5=[.2,.2,1,.7],z5=Object(s.memo)(function(e){var t=e.imageUvToView,n=e.selectedUvPositions;if(!e.isVisible)return null;var a=S5(n,t);return a?c.a.createElement(Ml,{key:"InPaintingRectangleSelection",transform:ci(t,a),color:V5,zIndex:2}):null}),G5=Object(ee.connect)(function(e){var t=wm(e);return{selectedUvPositions:e.inPaintingUi.selectedUvPositions,imageUvToView:t,isVisible:e.inPaintingUi.algorithmParameters.maskType===Ih.RectangleMask}},{})(z5),K5=Object(ee.connect)(function(e){return{canvasPixelSize:e.transformTools.view.viewportPixelSize,pointerPos:e.inPaintingUi.pointerMovePixelPos,visible:!0}},{})(Gf),W5=Object(u.classNamesFunction)(),q5=s.forwardRef(function(e,t){var n=e.styles,a=e.theme,i=e.className,r=e.vertical,o=e.alignContent,c=e.children,d=W5(n,{theme:a,className:i,alignContent:o,vertical:r});return s.createElement("div",{className:d.root,ref:t},s.createElement("div",{className:d.content,role:"separator","aria-orientation":r?"vertical":"horizontal"},c))}),Q5=Object(u.styled)(q5,function(e){var t,n,a=e.theme,i=e.alignContent,r=e.vertical,o=e.className,s="start"===i,c="center"===i,d="end"===i;return{root:[a.fonts.medium,{position:"relative"},i&&{textAlign:i},!i&&{textAlign:"center"},r&&(c||!i)&&{verticalAlign:"middle"},r&&s&&{verticalAlign:"top"},r&&d&&{verticalAlign:"bottom"},r&&{padding:"0 4px",height:"inherit",display:"table-cell",zIndex:1,selectors:{":after":(t={backgroundColor:a.palette.neutralLighter,width:"1px",content:'""',position:"absolute",top:"0",bottom:"0",left:"50%",right:"0",zIndex:-1},t[u.HighContrastSelector]={backgroundColor:"WindowText"},t)}},!r&&{padding:"4px 0",selectors:{":before":(n={backgroundColor:a.palette.neutralLighter,height:"1px",content:'""',display:"block",position:"absolute",top:"50%",bottom:"0",left:"0",right:"0"},n[u.HighContrastSelector]={backgroundColor:"WindowText"},n)}},o],content:[{position:"relative",display:"inline-block",padding:"0 12px",color:a.semanticColors.bodyText,background:a.semanticColors.bodyBackground},r&&{padding:"12px 0"}]}},void 0,{scope:"Separator"});Q5.displayName="Separator";var Y5="backward",J5=function(e){function t(t){var n=e.call(this,t)||this;return n._inputElement=s.createRef(),n._autoFillEnabled=!0,n._onCompositionStart=function(e){n.setState({isComposing:!0}),n._autoFillEnabled=!1},n._onCompositionUpdate=function(){Object(u.isIE11)()&&n._updateValue(n._getCurrentInputValue(),!0)},n._onCompositionEnd=function(e){var t=n._getCurrentInputValue();n._tryEnableAutofill(t,n.value,!1,!0),n.setState({isComposing:!1}),n._async.setTimeout(function(){n._updateValue(n._getCurrentInputValue(),!1)},0)},n._onClick=function(){n.value&&""!==n.value&&n._autoFillEnabled&&(n._autoFillEnabled=!1)},n._onKeyDown=function(e){if(n.props.onKeyDown&&n.props.onKeyDown(e),!e.nativeEvent.isComposing)switch(e.which){case u.KeyCodes.backspace:n._autoFillEnabled=!1;break;case u.KeyCodes.left:case u.KeyCodes.right:n._autoFillEnabled&&(n.setState({inputValue:n.props.suggestedDisplayValue||""}),n._autoFillEnabled=!1);break;default:n._autoFillEnabled||-1!==n.props.enableAutofillOnKeyPress.indexOf(e.which)&&(n._autoFillEnabled=!0)}},n._onInputChanged=function(e){var t=n._getCurrentInputValue(e);if(n.state.isComposing||n._tryEnableAutofill(t,n.value,e.nativeEvent.isComposing),!Object(u.isIE11)()||!n.state.isComposing){var a=e.nativeEvent.isComposing,i=void 0===a?n.state.isComposing:a;n._updateValue(t,i)}},n._onChanged=function(){},n._updateValue=function(e,t){if(e||e!==n.value){var a=n.props,i=a.onInputChange,r=a.onInputValueChange;i&&(e=(null==i?void 0:i(e,t))||""),n.setState({inputValue:e},function(){return null==r?void 0:r(e,t)})}},Object(u.initializeComponentRef)(n),n._async=new u.Async(n),n.state={inputValue:t.defaultVisibleValue||"",isComposing:!1},n}return Object(o.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){if(e.updateValueInWillReceiveProps){var n=e.updateValueInWillReceiveProps();if(null!==n&&n!==t.inputValue&&!t.isComposing)return Object(o.__assign)(Object(o.__assign)({},t),{inputValue:n})}return null},Object.defineProperty(t.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._getControlledValue()||this.state.inputValue||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e,t,n){var a=this.props,i=a.suggestedDisplayValue,r=a.shouldSelectFullInputValueInComponentDidUpdate,o=0;if(!a.preventValueSelection)if(this._inputElement.current&&this._inputElement.current===document.activeElement&&this._autoFillEnabled&&this.value&&i&&X5(i,this.value)){var s=!1;if(r&&(s=r()),s)this._inputElement.current.setSelectionRange(0,i.length,Y5);else{for(;o<this.value.length&&this.value[o].toLocaleLowerCase()===i[o].toLocaleLowerCase();)o++;o>0&&this._inputElement.current.setSelectionRange(o,i.length,Y5)}}else this._inputElement.current&&(null===n||this._autoFillEnabled||this.state.isComposing||this._inputElement.current.setSelectionRange(n.start,n.end,n.dir))},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=Object(u.getNativeProps)(this.props,u.inputProperties),t=Object(o.__assign)(Object(o.__assign)({},this.props.style),{fontFamily:"inherit"});return s.createElement("input",Object(o.__assign)({autoCapitalize:"off",autoComplete:"off","aria-autocomplete":"both"},e,{style:t,ref:this._inputElement,value:this._getDisplayValue(),onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionUpdate,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))},t.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()},t.prototype.clear=function(){this._autoFillEnabled=!0,this._updateValue("",!1),this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)},t.prototype.getSnapshotBeforeUpdate=function(){var e,t,n=this._inputElement.current;return n&&n.selectionStart!==this.value.length?{start:null!==(e=n.selectionStart)&&void 0!==e?e:n.value.length,end:null!==(t=n.selectionEnd)&&void 0!==t?t:n.value.length,dir:n.selectionDirection||"backward"}:null},t.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""},t.prototype._tryEnableAutofill=function(e,t,n,a){!n&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||a)&&(this._autoFillEnabled=!0)},t.prototype._getDisplayValue=function(){return this._autoFillEnabled?(n=e=this.value,(t=this.props.suggestedDisplayValue)&&e&&X5(t,n)&&(n=t),n):this.value;var e,t,n},t.prototype._getControlledValue=function(){var e=this.props.value;return void 0===e||"string"==typeof e?e:(console.warn("props.value of Autofill should be a string, but it is ".concat(e," with type of ").concat(typeof e)),e.toString())},t.defaultProps={enableAutofillOnKeyPress:[u.KeyCodes.down,u.KeyCodes.up]},t}(s.Component);function X5(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}var Z5=Object(A.classNamesFunction)(),$5=s.forwardRef(function(e,t){var n=e.disabled,a=e.required,i=e.inputProps,r=e.name,c=e.ariaLabel,d=e.ariaLabelledBy,l=e.ariaDescribedBy,u=e.ariaPositionInSet,f=e.ariaSetSize,p=e.title,m=e.checkmarkIconProps,_=e.styles,h=e.theme,b=e.className,g=e.boxSide,v=void 0===g?"start":g,y=dt("checkbox-",e.id),S=s.useRef(null),D=lg(S,t),I=s.useRef(null),x=ct(e.checked,e.defaultChecked,e.onChange),C=x[0],O=x[1],w=ct(e.indeterminate,e.defaultIndeterminate),E=w[0],L=w[1];Object(A.useFocusRects)(S);var k=Z5(_,{theme:h,className:b,disabled:n,indeterminate:E,checked:C,reversed:"start"!==v,isUsingCustomLabelRender:!!e.onRenderLabel}),M=s.useCallback(function(e){E?(O(!!C,e),L(!1)):O(!C,e)},[O,L,E,C]),P=s.useCallback(function(e){return e&&e.label?s.createElement("span",{className:k.text,title:e.title},e.label):null},[k.text]),T=s.useCallback(function(e){if(I.current){var t=!!e;I.current.indeterminate=t,L(t)}},[L]);!function(e,t,n,a,i){s.useImperativeHandle(e.componentRef,function(){return{get checked(){return!!t},get indeterminate(){return!!n},set indeterminate(e){a(e)},focus:function(){i.current&&i.current.focus()}}},[i,t,n,a])}(e,C,E,T,I),s.useEffect(function(){return T(E)},[T,E]);var U=e.onRenderLabel||P,F=E?"mixed":void 0,H=Object(o.__assign)(Object(o.__assign)({className:k.input,type:"checkbox"},i),{checked:!!C,disabled:n,required:a,name:r,id:y,title:p,onChange:M,"aria-disabled":n,"aria-label":c,"aria-labelledby":d,"aria-describedby":l,"aria-posinset":u,"aria-setsize":f,"aria-checked":F});return s.createElement("div",{className:k.root,title:p,ref:D},s.createElement("input",Object(o.__assign)({},H,{ref:I,title:p,"data-ktp-execute-target":!0})),s.createElement("label",{className:k.label,htmlFor:y},s.createElement("div",{className:k.checkbox,"data-ktp-target":!0},s.createElement(ec.Icon,Object(o.__assign)({iconName:"CheckMark"},m,{className:k.checkmark}))),U(e,P)))});$5.displayName="CheckboxBase";var eD,tD,nD,aD,iD,rD={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},oD="20px",sD="200ms",cD="cubic-bezier(.4, 0, .23, 1)",dD=Object(A.styled)($5,function(e){var t,n,a,i,r,s,c,d,l,u,f,p,m,_,h,b,g,v,y=e.className,S=e.theme,D=e.reversed,I=e.checked,x=e.disabled,C=e.isUsingCustomLabelRender,O=e.indeterminate,w=S.semanticColors,E=S.effects,L=S.palette,k=S.fonts,M=Object(mt.getGlobalClassNames)(rD,S),P=w.inputForegroundChecked,T=L.neutralSecondary,U=L.neutralPrimary,F=w.inputBackgroundChecked,H=w.inputBackgroundChecked,R=w.disabledBodySubtext,N=w.inputBorderHovered,B=w.inputBackgroundCheckedHovered,j=w.inputBackgroundChecked,V=w.inputBackgroundCheckedHovered,z=w.inputBackgroundCheckedHovered,G=w.inputTextHovered,K=w.disabledBodySubtext,W=w.bodyText,q=w.disabledText,Q=[(t={content:'""',borderRadius:E.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:x?R:F,transitionProperty:"border-width, border, border-color",transitionDuration:sD,transitionTimingFunction:cD},t[mt.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[M.root,{position:"relative",display:"flex"},D&&"reversed",I&&"is-checked",!x&&"is-enabled",x&&"is-disabled",!x&&[!I&&(n={},n[":hover .".concat(M.checkbox)]=(a={borderColor:N},a[mt.HighContrastSelector]={borderColor:"Highlight"},a),n[":focus .".concat(M.checkbox)]={borderColor:N},n[":hover .".concat(M.checkmark)]=(i={color:T,opacity:"1"},i[mt.HighContrastSelector]={color:"Highlight"},i),n),I&&!O&&(r={},r[":hover .".concat(M.checkbox)]={background:V,borderColor:z},r[":focus .".concat(M.checkbox)]={background:V,borderColor:z},r[mt.HighContrastSelector]=(s={},s[":hover .".concat(M.checkbox)]={background:"Highlight",borderColor:"Highlight"},s[":focus .".concat(M.checkbox)]={background:"Highlight"},s[":focus:hover .".concat(M.checkbox)]={background:"Highlight"},s[":focus:hover .".concat(M.checkmark)]={color:"Window"},s[":hover .".concat(M.checkmark)]={color:"Window"},s),r),O&&(c={},c[":hover .".concat(M.checkbox,", :hover .").concat(M.checkbox,":after")]=(d={borderColor:B},d[mt.HighContrastSelector]={borderColor:"WindowText"},d),c[":focus .".concat(M.checkbox)]={borderColor:B},c[":hover .".concat(M.checkmark)]={opacity:"0"},c),(l={},l[":hover .".concat(M.text,", :focus .").concat(M.text)]=(u={color:G},u[mt.HighContrastSelector]={color:x?"GrayText":"WindowText"},u),l)],y],input:(f={position:"absolute",background:"none",opacity:0},f[".".concat(A.IsFocusVisibleClassName," &:focus + label::before")]=(p={outline:"1px solid "+S.palette.neutralSecondary,outlineOffset:"2px"},p[mt.HighContrastSelector]={outline:"1px solid WindowText"},p),f),label:[M.label,S.fonts.medium,{display:"flex",alignItems:C?"center":"flex-start",cursor:x?"default":"pointer",position:"relative",userSelect:"none"},D&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[M.checkbox,(m={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:oD,width:oD,border:"1px solid ".concat(U),borderRadius:E.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:sD,transitionTimingFunction:cD,overflow:"hidden",":after":O?Q:null},m[mt.HighContrastSelector]=Object(o.__assign)({borderColor:"WindowText"},Object(mt.getHighContrastNoAdjustStyle)()),m),O&&{borderColor:F},D?{marginLeft:4}:{marginRight:4},!x&&!O&&I&&(_={background:j,borderColor:H},_[mt.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},_),x&&(h={borderColor:R},h[mt.HighContrastSelector]={borderColor:"GrayText"},h),I&&x&&(b={background:K,borderColor:R},b[mt.HighContrastSelector]={background:"Window"},b)],checkmark:[M.checkmark,(g={opacity:I&&!O?"1":"0",color:P},g[mt.HighContrastSelector]=Object(o.__assign)({color:x?"GrayText":"Window"},Object(mt.getHighContrastNoAdjustStyle)()),g)],text:[M.text,(v={color:x?q:W,fontSize:k.medium.fontSize,lineHeight:"20px"},v[mt.HighContrastSelector]=Object(o.__assign)({color:x?"GrayText":"WindowText"},Object(mt.getHighContrastNoAdjustStyle)()),v),D?{marginRight:4}:{marginLeft:4}]}},void 0,{scope:"Checkbox"}),lD=Object(u.memoizeFunction)(function(e){var t,n=e.semanticColors;return{backgroundColor:n.disabledBackground,color:n.disabledText,cursor:"default",selectors:(t={":after":{borderColor:n.disabledBackground}},t[u.HighContrastSelector]={color:"GrayText",selectors:{":after":{borderColor:"GrayText"}}},t)}}),uD={selectors:(eD={},eD[u.HighContrastSelector]=Object(o.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Object(u.getHighContrastNoAdjustStyle)()),eD)},fD={selectors:(tD={},tD[u.HighContrastSelector]=Object(o.__assign)({color:"WindowText",backgroundColor:"Window"},Object(u.getHighContrastNoAdjustStyle)()),tD)},pD=Object(u.memoizeFunction)(function(e,t,n,a,i,r){var s,c=e.palette,d=e.semanticColors,l={textHoveredColor:d.menuItemTextHovered,textSelectedColor:c.neutralDark,textDisabledColor:d.disabledText,backgroundHoveredColor:d.menuItemBackgroundHovered,backgroundPressedColor:d.menuItemBackgroundPressed},f={root:[e.fonts.medium,{backgroundColor:a?l.backgroundHoveredColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:i?"none":"block",width:"100%",height:"auto",minHeight:36,lineHeight:"20px",padding:"0 8px",position:"relative",borderWidth:"1px",borderStyle:"solid",borderColor:"transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",selectors:Object(o.__assign)(Object(o.__assign)((s={},s[u.HighContrastSelector]={border:"none",borderColor:"Background"},s),!i&&{"&.ms-Checkbox":{display:"flex",alignItems:"center"}}),{"&.ms-Button--command:hover:active":{backgroundColor:l.backgroundPressedColor},".ms-Checkbox-label":{width:"100%"}})},r?[{backgroundColor:"transparent",color:l.textSelectedColor,selectors:{":hover":[{backgroundColor:l.backgroundHoveredColor},uD]}},Object(u.getFocusStyle)(e,{inset:-1,isFocusedOnly:!1}),uD]:[]],rootHovered:{backgroundColor:l.backgroundHoveredColor,color:l.textHoveredColor},rootFocused:{backgroundColor:l.backgroundHoveredColor},rootDisabled:{color:l.textDisabledColor,cursor:"default"},optionText:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:"0px",maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",display:"inline-block"},optionTextWrapper:{maxWidth:"100%",display:"flex",alignItems:"center"}};return Object(u.concatStyleSets)(f,t,n)}),mD=Object(u.memoizeFunction)(function(e,t){var n,a,i=e.semanticColors,r=e.fonts,s={buttonTextColor:i.bodySubtext,buttonTextHoveredCheckedColor:i.buttonTextChecked,buttonBackgroundHoveredColor:i.listItemBackgroundHovered,buttonBackgroundCheckedColor:i.listItemBackgroundChecked,buttonBackgroundCheckedHoveredColor:i.listItemBackgroundCheckedHovered},c={selectors:(n={},n[u.HighContrastSelector]=Object(o.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Object(u.getHighContrastNoAdjustStyle)()),n)},d={root:{color:s.buttonTextColor,fontSize:r.small.fontSize,position:"absolute",top:0,height:"100%",lineHeight:30,width:32,textAlign:"center",cursor:"default",selectors:(a={},a[u.HighContrastSelector]=Object(o.__assign)({backgroundColor:"ButtonFace",borderColor:"ButtonText",color:"ButtonText"},Object(u.getHighContrastNoAdjustStyle)()),a)},icon:{fontSize:r.small.fontSize},rootHovered:[{backgroundColor:s.buttonBackgroundHoveredColor,color:s.buttonTextHoveredCheckedColor,cursor:"pointer"},c],rootPressed:[{backgroundColor:s.buttonBackgroundCheckedColor,color:s.buttonTextHoveredCheckedColor},c],rootChecked:[{backgroundColor:s.buttonBackgroundCheckedColor,color:s.buttonTextHoveredCheckedColor},c],rootCheckedHovered:[{backgroundColor:s.buttonBackgroundCheckedHoveredColor,color:s.buttonTextHoveredCheckedColor},c],rootDisabled:[lD(e),{position:"absolute"}]};return Object(u.concatStyleSets)(d,t)}),_D=Object(u.memoizeFunction)(function(e,t,n){var a,i,r,s,c,d,l=e.semanticColors,f=e.fonts,p=e.effects,m={textColor:l.inputText,borderColor:l.inputBorder,borderHoveredColor:l.inputBorderHovered,borderPressedColor:l.inputFocusBorderAlt,borderFocusedColor:l.inputFocusBorderAlt,backgroundColor:l.inputBackground,erroredColor:l.errorText},_={headerTextColor:l.menuHeader,dividerBorderColor:l.bodyDivider},h={selectors:(a={},a[u.HighContrastSelector]={color:"GrayText"},a)},b=[{color:l.inputPlaceholderText},h],g=[{color:l.inputTextHovered},h],v=[{color:l.disabledText},h],y=Object(o.__assign)(Object(o.__assign)({color:"HighlightText",backgroundColor:"Window"},Object(u.getHighContrastNoAdjustStyle)()),{selectors:{":after":{borderColor:"Highlight"}}}),S=Object(u.getInputFocusStyle)(m.borderPressedColor,p.roundedCorner2,"border",0),D={container:{},label:{},labelDisabled:{},root:[e.fonts.medium,{boxShadow:"none",marginLeft:"0",paddingRight:32,paddingLeft:9,color:m.textColor,position:"relative",outline:"0",userSelect:"none",backgroundColor:m.backgroundColor,cursor:"text",display:"block",height:32,whiteSpace:"nowrap",textOverflow:"ellipsis",boxSizing:"border-box",selectors:{".ms-Label":{display:"inline-block",marginBottom:"8px"},"&.is-open":{selectors:(i={},i[u.HighContrastSelector]=y,i)},":after":{pointerEvents:"none",content:"''",position:"absolute",left:0,top:0,bottom:0,right:0,borderWidth:"1px",borderStyle:"solid",borderColor:m.borderColor,borderRadius:p.roundedCorner2}}}],rootHovered:{selectors:(r={":after":{borderColor:m.borderHoveredColor},".ms-ComboBox-Input":[{color:l.inputTextHovered},Object(u.getPlaceholderStyles)(g),fD]},r[u.HighContrastSelector]=Object(o.__assign)(Object(o.__assign)({color:"HighlightText",backgroundColor:"Window"},Object(u.getHighContrastNoAdjustStyle)()),{selectors:{":after":{borderColor:"Highlight"}}}),r)},rootPressed:[{position:"relative",selectors:(s={},s[u.HighContrastSelector]=y,s)}],rootFocused:[{selectors:(c={".ms-ComboBox-Input":[{color:l.inputTextHovered},fD]},c[u.HighContrastSelector]=y,c)},S],rootDisabled:lD(e),rootError:{selectors:{":after":{borderColor:m.erroredColor},":hover:after":{borderColor:l.inputBorderHovered}}},rootDisallowFreeForm:{},input:[Object(u.getPlaceholderStyles)(b),{backgroundColor:m.backgroundColor,color:m.textColor,boxSizing:"border-box",width:"100%",height:"100%",borderStyle:"none",outline:"none",font:"inherit",textOverflow:"ellipsis",padding:"0",selectors:{"::-ms-clear":{display:"none"}}},fD],inputDisabled:[lD(e),Object(u.getPlaceholderStyles)(v)],errorMessage:[e.fonts.small,{color:m.erroredColor,marginTop:"5px"}],callout:{boxShadow:p.elevation8},optionsContainerWrapper:{width:n},optionsContainer:{display:"block"},screenReaderText:u.hiddenContentStyle,header:[f.medium,{fontWeight:u.FontWeights.semibold,color:_.headerTextColor,backgroundColor:"none",borderStyle:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(d={},d[u.HighContrastSelector]=Object(o.__assign)({color:"GrayText"},Object(u.getHighContrastNoAdjustStyle)()),d)}],divider:{height:1,backgroundColor:_.dividerBorderColor}};return Object(u.concatStyleSets)(D,t)}),hD=Object(u.memoizeFunction)(function(e,t,n,a,i,r,o,s){return{container:Object(u.mergeStyles)("ms-ComboBox-container",t,e.container),label:Object(u.mergeStyles)(e.label,a&&e.labelDisabled),root:Object(u.mergeStyles)("ms-ComboBox",s?e.rootError:n&&"is-open",i&&"is-required",e.root,!o&&e.rootDisallowFreeForm,s&&!r?e.rootError:!a&&r&&e.rootFocused,!a&&{selectors:{":hover":s?e.rootError:!n&&!r&&e.rootHovered,":active":s?e.rootError:e.rootPressed,":focus":s?e.rootError:e.rootFocused}},a&&["is-disabled",e.rootDisabled]),input:Object(u.mergeStyles)("ms-ComboBox-Input",e.input,a&&e.inputDisabled),errorMessage:Object(u.mergeStyles)(e.errorMessage),callout:Object(u.mergeStyles)("ms-ComboBox-callout",e.callout),optionsContainerWrapper:Object(u.mergeStyles)("ms-ComboBox-optionsContainerWrapper",e.optionsContainerWrapper),optionsContainer:Object(u.mergeStyles)("ms-ComboBox-optionsContainer",e.optionsContainer),header:Object(u.mergeStyles)("ms-ComboBox-header",e.header),divider:Object(u.mergeStyles)("ms-ComboBox-divider",e.divider),screenReaderText:Object(u.mergeStyles)(e.screenReaderText)}}),bD=Object(u.memoizeFunction)(function(e){return{optionText:Object(u.mergeStyles)("ms-ComboBox-optionText",e.optionText),root:Object(u.mergeStyles)("ms-ComboBox-option",e.root,{selectors:{":hover":e.rootHovered,":focus":e.rootFocused,":active":e.rootPressed}}),optionTextWrapper:Object(u.mergeStyles)(e.optionTextWrapper)}});function gD(e,t){for(var n=[],a=0,i=t;a<i.length;a++){var r=e[i[a]];r&&n.push(r)}return n}!function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.SelectAll=3]="SelectAll"}(nD||(nD={})),function(e){e[e.backward=-1]="backward",e[e.none=0]="none",e[e.forward=1]="forward"}(aD||(aD={})),function(e){e[e.clearAll=-2]="clearAll",e[e.default=-1]="default"}(iD||(iD={}));var vD=s.memo(function(e){return(0,e.render)()},function(e,t){e.render;var n=Object(o.__rest)(e,["render"]),a=(t.render,Object(o.__rest)(t,["render"]));return Object(u.shallowCompare)(n,a)}),yD="ComboBox",SD={options:[],allowFreeform:!1,autoComplete:"on",buttonIconProps:{iconName:"ChevronDown"}},DD=s.forwardRef(function(e,t){var n=Object(u.getPropsWithDefaults)(SD,e),a=(n.ref,Object(o.__rest)(n,["ref"])),i=s.useRef(null),r=lg(i,t),c=function(e){var t=e.options,n=e.defaultSelectedKey,a=e.selectedKey,i=s.useState(function(){return CD(t,function(e,t){var n=OD(e);return n.length?n:OD(t)}(n,a))}),r=i[0],o=i[1],c=s.useState(t),d=c[0],l=c[1],u=s.useState(),f=u[0],p=u[1];return s.useEffect(function(){if(void 0!==a){var e=OD(a),n=CD(t,e);o(n)}l(t)},[t,a]),s.useEffect(function(){null===a&&p(void 0)},[a]),[r,o,d,l,f,p]}(a),d=c[0],l=c[1],f=c[2],p=c[3],m=c[4],_=c[5];return s.createElement(xD,Object(o.__assign)({},a,{hoisted:{mergedRootRef:r,rootRef:i,selectedIndices:d,setSelectedIndices:l,currentOptions:f,setCurrentOptions:p,suggestedDisplayValue:m,setSuggestedDisplayValue:_}}))});function ID(e,t){for(var n=Object(A.getChildren)(e),a=0;a<n.length;a++){var i=n[a];if(t(i))return i;var r=ID(i,t);if(r)return r}return null}DD.displayName=yD;var xD=function(e){function t(t){var n=e.call(this,t)||this;return n._autofill=s.createRef(),n._comboBoxWrapper=s.createRef(),n._comboBoxMenu=s.createRef(),n._selectedElement=s.createRef(),n._overrideScrollDismiss=!1,n.focus=function(e,t){n.props.disabled||(n._autofill.current&&(t?Object(u.focusAsync)(n._autofill.current):n._autofill.current.focus(),e&&n.setState({isOpen:!0})),n._hasFocus()||n.setState({focusState:"focused"}))},n.dismissMenu=function(){n.state.isOpen&&n.setState({isOpen:!1})},n._onUpdateValueInAutofillWillReceiveProps=function(){var e=n._autofill.current;return e?null===e.value||void 0===e.value?null:wD(n._currentVisibleValue):null},n._renderComboBoxWrapper=function(e,t){var a=n.props,i=a.label,r=a.disabled,c=a.ariaLabel,d=a.ariaDescribedBy,l=void 0===d?n.props["aria-describedby"]:d,f=a.required,p=a.errorMessage,m=a.buttonIconProps,_=a.isButtonAriaHidden,h=a.title,b=a.placeholder,g=a.tabIndex,v=a.autofill,y=a.iconButtonProps,S=a.hoisted.suggestedDisplayValue,D=n.state,I=D.ariaActiveDescendantValue,x=D.isOpen,C=n._hasFocus()&&n.props.multiSelect&&e?e:b,O={"aria-labelledby":[n.props["aria-labelledby"],i&&n._id+"-label"].join(" ").trim()||void 0,"aria-label":c&&!i?c:void 0};return s.createElement("div",{"data-ktp-target":!0,ref:n._comboBoxWrapper,id:n._id+"wrapper",className:n._classNames.root,"aria-owns":x?n._id+"-list":void 0},s.createElement(J5,Object(o.__assign)({"data-ktp-execute-target":!0,"data-is-interactable":!r,componentRef:n._autofill,id:n._id+"-input",className:n._classNames.input,type:"text",onFocus:n._onFocus,onBlur:n._onBlur,onKeyDown:n._onInputKeyDown,onKeyUp:n._onInputKeyUp,onClick:n._onAutofillClick,onTouchStart:n._onTouchStart,onInputValueChange:n._onInputChange,"aria-expanded":x,"aria-autocomplete":n._getAriaAutoCompleteValue(),role:"combobox",readOnly:r},O,{"aria-describedby":void 0!==p?Object(u.mergeAriaAttributeValues)(l,t):l,"aria-activedescendant":I,"aria-required":f,"aria-disabled":r,"aria-controls":x?n._id+"-list":void 0,spellCheck:!1,defaultVisibleValue:n._currentVisibleValue,suggestedDisplayValue:S,updateValueInWillReceiveProps:n._onUpdateValueInAutofillWillReceiveProps,shouldSelectFullInputValueInComponentDidUpdate:n._onShouldSelectFullInputValueInAutofillComponentDidUpdate,title:h,preventValueSelection:!n._hasFocus(),placeholder:C,tabIndex:r?-1:g},v)),s.createElement(u.IconButton,Object(o.__assign)({className:"ms-ComboBox-CaretDown-button",styles:n._getCaretButtonStyles(),role:_?"presentation":void 0,"aria-hidden":_},_?void 0:O,{"data-is-focusable":!1,tabIndex:-1,onClick:n._onComboBoxClick,onBlur:n._onBlur,iconProps:m,disabled:r,checked:x},y)))},n._onShouldSelectFullInputValueInAutofillComponentDidUpdate=function(){return n._currentVisibleValue===n.props.hoisted.suggestedDisplayValue},n._getVisibleValue=function(){var e=n.props,t=e.text,a=e.allowFreeform,i=e.allowFreeInput,r=e.autoComplete,o=e.hoisted,s=o.suggestedDisplayValue,c=o.selectedIndices,d=o.currentOptions,l=n.state,u=l.currentPendingValueValidIndex,f=l.currentPendingValue,p=l.isOpen,m=ED(d,u);if((!p||!m)&&(t||""===t)&&null==f)return t;if(n.props.multiSelect){if(n._hasFocus()){var _=-1;return"on"===r&&m&&(_=u),n._getPendingString(f,d,_)}return n._getMultiselectDisplayString(c,d,s)}return _=n._getFirstSelectedIndex(),a||i?("on"===r&&m&&(_=u),n._getPendingString(f,d,_)):m&&"on"===r?(_=u,wD(f)):!n.state.isOpen&&f?ED(d,_)?f:wD(s):ED(d,_)?kD(d[_]):wD(s)},n._onInputChange=function(e){n.props.disabled?n._handleInputWhenDisabled(null):(n.props.onInputValueChange&&n.props.onInputValueChange(e),n.props.allowFreeform||n.props.allowFreeInput?n._processInputChangeWithFreeform(e):n._processInputChangeWithoutFreeform(e))},n._onFocus=function(){var e,t;null===(t=null===(e=n._autofill.current)||void 0===e?void 0:e.inputElement)||void 0===t||t.select(),n._hasFocus()||n.setState({focusState:"focusing"})},n._onResolveOptions=function(){if(n.props.onResolveOptions){var e=n.props.onResolveOptions(Object(o.__spreadArray)([],n.props.hoisted.currentOptions,!0));Array.isArray(e)?n.props.hoisted.setCurrentOptions(e):e&&e.then&&(n._currentPromise=e,e.then(function(t){e===n._currentPromise&&n.props.hoisted.setCurrentOptions(t)}))}},n._onBlur=function(e){var t,a,i=e.relatedTarget;if(null===e.relatedTarget&&(i=document.activeElement),i){var r=null===(t=n.props.hoisted.rootRef.current)||void 0===t?void 0:t.contains(i),o=null===(a=n._comboBoxMenu.current)||void 0===a?void 0:a.contains(i),s=n._comboBoxMenu.current&&Object(u.findElementRecursive)(n._comboBoxMenu.current,function(e){return e===i});if(r||o||s)return s&&n._hasFocus()&&(!n.props.multiSelect||n.props.allowFreeform)&&n._submitPendingValue(e),e.preventDefault(),void e.stopPropagation()}n._hasFocus()&&(n.setState({focusState:"none"}),n.props.multiSelect&&!n.props.allowFreeform||n._submitPendingValue(e))},n._onRenderContainer=function(e,t){var a=e.onRenderList,i=e.calloutProps,r=e.dropdownWidth,c=e.dropdownMaxWidth,d=e.onRenderUpperContent,l=void 0===d?n._onRenderUpperContent:d,f=e.onRenderLowerContent,p=void 0===f?n._onRenderLowerContent:f,m=e.useComboBoxAsMenuWidth,_=e.persistMenu,h=e.shouldRestoreFocus,b=void 0===h||h,g=n.state.isOpen,v=n._id,y=m&&n._comboBoxWrapper.current?n._comboBoxWrapper.current.clientWidth+2:void 0;return s.createElement(u.Callout,Object(o.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHint:u.DirectionalHint.bottomLeftEdge,directionalHintFixed:!1},i,{onLayerMounted:n._onLayerMounted,className:Object(u.css)(n._classNames.callout,null==i?void 0:i.className),target:n._comboBoxWrapper.current,onDismiss:n._onDismiss,onMouseDown:n._onCalloutMouseDown,onScroll:n._onScroll,setInitialFocus:!1,calloutWidth:m&&n._comboBoxWrapper.current?y&&y:r,calloutMaxWidth:c||y,hidden:_?!g:void 0,shouldRestoreFocus:b,preventDismissOnEvent:function(e){return n._preventDismissOnScrollOrResize(e)}}),l(n.props,n._onRenderUpperContent),s.createElement("div",{className:n._classNames.optionsContainerWrapper,ref:n._comboBoxMenu},null==a?void 0:a(Object(o.__assign)(Object(o.__assign)({},e),{id:v}),n._onRenderList)),p(n.props,n._onRenderLowerContent))},n._onLayerMounted=function(){n._onCalloutLayerMounted(),n._async.setTimeout(function(){n._scrollIntoView()},0),n.props.calloutProps&&n.props.calloutProps.onLayerMounted&&n.props.calloutProps.onLayerMounted()},n._onRenderLabel=function(e){var t=e.props,a=t.label,i=t.disabled,r=t.required;return a?s.createElement(u.Label,{id:n._id+"-label",disabled:i,required:r,className:n._classNames.label},a,e.multiselectAccessibleText&&s.createElement("span",{className:n._classNames.screenReaderText},e.multiselectAccessibleText)):null},n._onRenderList=function(e){var t=e.onRenderItem,a=void 0===t?n._onRenderItem:t,i=e.label,r=e.ariaLabel,c=e.multiSelect,d={items:[]},l=[],u=function(){var e=d.id?[s.createElement("div",{role:"group",key:d.id,"aria-labelledby":d.id},d.items)]:d.items;l=Object(o.__spreadArray)(Object(o.__spreadArray)([],l,!0),e,!0),d={items:[]}};e.options.forEach(function(e,t){!function(e,t){switch(e.itemType){case nD.Header:d.items.length>0&&u();var i=n._id+e.key;d.items.push(a(Object(o.__assign)(Object(o.__assign)({id:i},e),{index:t}),n._onRenderItem)),d.id=i;break;case nD.Divider:t>0&&d.items.push(a(Object(o.__assign)(Object(o.__assign)({},e),{index:t}),n._onRenderItem)),d.items.length>0&&u();break;default:d.items.push(a(Object(o.__assign)(Object(o.__assign)({},e),{index:t}),n._onRenderItem))}}(e,t)}),d.items.length>0&&u();var f=n._id;return s.createElement("div",{id:f+"-list",className:n._classNames.optionsContainer,"aria-labelledby":i&&f+"-label","aria-label":r&&!i?r:void 0,"aria-multiselectable":c?"true":void 0,role:"listbox"},l)},n._onRenderItem=function(e){switch(e.itemType){case nD.Divider:return n._renderSeparator(e);case nD.Header:return n._renderHeader(e);default:return n._renderOption(e)}},n._onRenderLowerContent=function(){return null},n._onRenderUpperContent=function(){return null},n._renderOption=function(e){var t,a=n.props.onRenderOption,i=void 0===a?n._onRenderOptionContent:a,r=null!==(t=e.id)&&void 0!==t?t:n._id+"-list"+e.index,c=n._isOptionSelected(e.index),d=n._isOptionChecked(e.index),l=n._isOptionIndeterminate(e.index),f=n._getCurrentOptionStyles(e),p=bD(n._getCurrentOptionStyles(e)),m=e.title;return s.createElement(vD,{key:e.key,index:e.index,disabled:e.disabled,isSelected:c,isChecked:d,isIndeterminate:l,text:e.text,render:function(){return n.props.multiSelect?s.createElement(dD,{id:r,ariaLabel:e.ariaLabel,ariaLabelledBy:e.ariaLabel?void 0:r+"-label",key:e.key,styles:f,className:"ms-ComboBox-option",onChange:n._onItemClick(e),label:e.text,checked:d,indeterminate:l,title:m,disabled:e.disabled,onRenderLabel:n._renderCheckboxLabel.bind(n,Object(o.__assign)(Object(o.__assign)({},e),{id:r+"-label"})),inputProps:Object(o.__assign)({"aria-selected":d?"true":"false",role:"option"},{"data-index":e.index,"data-is-focusable":!0})}):s.createElement(u.CommandButton,{id:r,key:e.key,"data-index":e.index,styles:f,checked:c,className:"ms-ComboBox-option",onClick:n._onItemClick(e),onMouseEnter:n._onOptionMouseEnter.bind(n,e.index),onMouseMove:n._onOptionMouseMove.bind(n,e.index),onMouseLeave:n._onOptionMouseLeave,role:"option","aria-selected":c?"true":"false",ariaLabel:e.ariaLabel,disabled:e.disabled,title:m},s.createElement("span",{className:p.optionTextWrapper,ref:c?n._selectedElement:void 0},i(e,n._onRenderOptionContent)))},data:e.data})},n._onCalloutMouseDown=function(e){e.preventDefault()},n._onScroll=function(){var e;n._isScrollIdle||void 0===n._scrollIdleTimeoutId?n._isScrollIdle=!1:(n._async.clearTimeout(n._scrollIdleTimeoutId),n._scrollIdleTimeoutId=void 0),(null===(e=n.props.calloutProps)||void 0===e?void 0:e.onScroll)&&n.props.calloutProps.onScroll(),n._scrollIdleTimeoutId=n._async.setTimeout(function(){n._isScrollIdle=!0},250)},n._onRenderOptionContent=function(e){var t=bD(n._getCurrentOptionStyles(e));return s.createElement("span",{className:t.optionText},e.text)},n._onRenderMultiselectOptionContent=function(e){var t=bD(n._getCurrentOptionStyles(e));return s.createElement("span",{id:e.id,"aria-hidden":"true",className:t.optionText},e.text)},n._onDismiss=function(){var e=n.props.onMenuDismiss;e&&e(),n.props.persistMenu&&n._onCalloutLayerMounted(),n._setOpenStateAndFocusOnClose(!1,!1),n._resetSelectedIndex()},n._onAfterClearPendingInfo=function(){n._processingClearPendingInfo=!1},n._onInputKeyDown=function(e){var t=n.props,a=t.disabled,i=t.allowFreeform,r=t.allowFreeInput,o=t.autoComplete,s=t.hoisted.currentOptions,c=n.state,d=c.isOpen,l=c.currentPendingValueValidIndexOnHover;if(n._lastKeyDownWasAltOrMeta=MD(e),a)n._handleInputWhenDisabled(e);else{var f=n._getPendingSelectedIndex(!1);switch(e.which){case u.KeyCodes.enter:n._autofill.current&&n._autofill.current.inputElement&&n._autofill.current.inputElement.select(),n._submitPendingValue(e),n.props.multiSelect&&d?n.setState({currentPendingValueValidIndex:f}):(d||(!i||void 0===n.state.currentPendingValue||null===n.state.currentPendingValue||n.state.currentPendingValue.length<=0)&&n.state.currentPendingValueValidIndex<0)&&n.setState({isOpen:!d});break;case u.KeyCodes.tab:return n.props.multiSelect||n._submitPendingValue(e),void(d&&n._setOpenStateAndFocusOnClose(!d,!1));case u.KeyCodes.escape:if(n._resetSelectedIndex(),!d)return;n.setState({isOpen:!1});break;case u.KeyCodes.up:if(l===iD.clearAll&&(f=n.props.hoisted.currentOptions.length),e.altKey||e.metaKey){if(d){n._setOpenStateAndFocusOnClose(!d,!0);break}return}e.preventDefault(),n._setPendingInfoFromIndexAndDirection(f,aD.backward);break;case u.KeyCodes.down:e.altKey||e.metaKey?n._setOpenStateAndFocusOnClose(!0,!0):(l===iD.clearAll&&(f=-1),e.preventDefault(),n._setPendingInfoFromIndexAndDirection(f,aD.forward));break;case u.KeyCodes.home:case u.KeyCodes.end:if(i||r)return;f=-1;var p=aD.forward;e.which===u.KeyCodes.end&&(f=s.length,p=aD.backward),n._setPendingInfoFromIndexAndDirection(f,p);break;case u.KeyCodes.space:if(!i&&!r&&"off"===o)break;default:if(e.which>=112&&e.which<=123)return;if(e.keyCode===u.KeyCodes.alt||"Meta"===e.key)return;if(!i&&!r&&"on"===o){n._onInputChange(e.key);break}return}e.stopPropagation(),e.preventDefault()}},n._onInputKeyUp=function(e){var t=n.props,a=t.disabled,i=t.allowFreeform,r=t.allowFreeInput,o=t.autoComplete,s=n.state.isOpen,c=n._lastKeyDownWasAltOrMeta&&MD(e);n._lastKeyDownWasAltOrMeta=!1;var d=c&&!(Object(u.isMac)()||Object(u.isIOS)());a?n._handleInputWhenDisabled(e):e.which!==u.KeyCodes.space?d&&s?n._setOpenStateAndFocusOnClose(!s,!0):("focusing"===n.state.focusState&&n.props.openOnKeyboardFocus&&n.setState({isOpen:!0}),"focused"!==n.state.focusState&&n.setState({focusState:"focused"})):i||r||"off"!==o||n._setOpenStateAndFocusOnClose(!s,!!s)},n._onOptionMouseLeave=function(){n._shouldIgnoreMouseEvent()||n.props.persistMenu&&!n.state.isOpen||n.setState({currentPendingValueValidIndexOnHover:iD.clearAll})},n._onComboBoxClick=function(){var e=n.props.disabled,t=n.state.isOpen;e||(n._setOpenStateAndFocusOnClose(!t,!1),n.setState({focusState:"focused"}))},n._onAutofillClick=function(){var e=n.props,t=e.disabled;e.allowFreeform&&!t?n.focus(n.state.isOpen||n._processingTouch):n._onComboBoxClick()},n._onTouchStart=function(){n._comboBoxWrapper.current&&!("onpointerdown"in n._comboBoxWrapper)&&n._handleTouchAndPointerEvent()},n._onPointerDown=function(e){"touch"===e.pointerType&&(n._handleTouchAndPointerEvent(),e.preventDefault(),e.stopImmediatePropagation())},Object(u.initializeComponentRef)(n),n._async=new u.Async(n),n._events=new u.EventGroup(n),Object(u.warnMutuallyExclusive)(yD,t,{defaultSelectedKey:"selectedKey",text:"defaultSelectedKey",selectedKey:"value",dropdownWidth:"useComboBoxAsMenuWidth",ariaLabel:"label"}),n._id=t.id||Object(u.getId)("ComboBox"),n._isScrollIdle=!0,n._processingTouch=!1,n._gotMouseMove=!1,n._processingClearPendingInfo=!1,n.state={isOpen:!1,focusState:"none",currentPendingValueValidIndex:-1,currentPendingValue:void 0,currentPendingValueValidIndexOnHover:iD.default},n}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props.hoisted;return gD(e.currentOptions,e.selectedIndices)},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this._comboBoxWrapper.current&&!this.props.disabled&&(this._events.on(this._comboBoxWrapper.current,"focus",this._onResolveOptions,!0),"onpointerdown"in this._comboBoxWrapper.current&&this._events.on(this._comboBoxWrapper.current,"pointerdown",this._onPointerDown,!0))},t.prototype.componentDidUpdate=function(e,t){var n,a,i,r=this,s=this.props,c=s.allowFreeform,d=s.allowFreeInput,l=s.text,f=s.onMenuOpen,p=s.onMenuDismissed,m=s.hoisted,_=m.currentOptions,h=m.selectedIndices,b=this.state,g=b.currentPendingValue,v=b.currentPendingValueValidIndex,y=b.isOpen;!y||t.isOpen&&t.currentPendingValueValidIndex===v||this._async.setTimeout(function(){return r._scrollIntoView()},0),this._hasFocus()&&(y||t.isOpen&&!y&&this._focusInputAfterClose&&this._autofill.current&&document.activeElement!==this._autofill.current.inputElement)&&this.focus(void 0,!0),this._focusInputAfterClose&&(t.isOpen&&!y||this._hasFocus()&&(!y&&!this.props.multiSelect&&e.hoisted.selectedIndices&&h&&e.hoisted.selectedIndices[0]!==h[0]||!c&&!d||l!==e.text))&&this._onFocus(),this._notifyPendingValueChanged(t),y&&!t.isOpen&&(this._overrideScrollDismiss=!0,this._async.clearTimeout(this._overrideScrollDimissTimeout),this._overrideScrollDimissTimeout=this._async.setTimeout(function(){r._overrideScrollDismiss=!1},100),null==f||f()),!y&&t.isOpen&&p&&p();var S=v,D=_.map(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{index:t})});!Object(u.shallowCompare)(e.hoisted.currentOptions,_)&&g&&(S=this.props.allowFreeform||this.props.allowFreeInput?this._processInputChangeWithFreeform(g):this._updateAutocompleteIndexWithoutFreeform(g));var I=void 0;y&&this._hasFocus()&&-1!==S?I=null!==(n=D[S].id)&&void 0!==n?n:this._id+"-list"+S:y&&h.length&&(I=null!==(i=null===(a=D[h[0]])||void 0===a?void 0:a.id)&&void 0!==i?i:this._id+"-list"+h[0]),I!==this.state.ariaActiveDescendantValue&&this.setState({ariaActiveDescendantValue:I})},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this._id+"-error",t=this.props,n=t.className,a=t.disabled,i=t.required,r=t.errorMessage,c=t.onRenderContainer,d=void 0===c?this._onRenderContainer:c,l=t.onRenderLabel,f=void 0===l?this._onRenderLabel:l,p=t.onRenderList,m=void 0===p?this._onRenderList:p,_=t.onRenderItem,h=void 0===_?this._onRenderItem:_,b=t.onRenderOption,g=void 0===b?this._onRenderOptionContent:b,v=t.allowFreeform,y=t.styles,S=t.theme,D=t.persistMenu,I=t.multiSelect,x=t.hoisted,C=x.suggestedDisplayValue,O=x.selectedIndices,w=x.currentOptions,E=this.state.isOpen;this._currentVisibleValue=this._getVisibleValue();var A=I?this._getMultiselectDisplayString(O,w,C):void 0,L=Object(u.getNativeProps)(this.props,u.divProperties,["onChange","value","aria-describedby","aria-labelledby"]),k=!!(r&&r.length>0);this._classNames=this.props.getClassNames?this.props.getClassNames(S,!!E,!!a,!!i,!!this._hasFocus(),!!v,!!k,n):hD(_D(S,y),n,!!E,!!a,!!i,!!this._hasFocus(),!!v,!!k);var M=this._renderComboBoxWrapper(A,e);return s.createElement("div",Object(o.__assign)({},L,{ref:this.props.hoisted.mergedRootRef,className:this._classNames.container}),f({props:this.props,multiselectAccessibleText:A},this._onRenderLabel),M,(D||E)&&d(Object(o.__assign)(Object(o.__assign)({},this.props),{onRenderList:m,onRenderItem:h,onRenderOption:g,options:w.map(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{index:t})}),onDismiss:this._onDismiss}),this._onRenderContainer),k&&s.createElement("div",{role:"alert",id:e,className:this._classNames.errorMessage},r))},t.prototype._getPendingString=function(e,t,n){return null!=e?e:ED(t,n)?kD(t[n]):""},t.prototype._getMultiselectDisplayString=function(e,t,n){for(var a=[],i=0;e&&i<e.length;i++){var r=e[i];t[r].itemType!==nD.SelectAll&&a.push(ED(t,r)?t[r].text:wD(n))}var o=this.props.multiSelectDelimiter,s=void 0===o?", ":o;return a.join(s)},t.prototype._preventDismissOnScrollOrResize=function(e){return!(!this._overrideScrollDismiss||"scroll"!==e.type&&"resize"!==e.type)},t.prototype._processInputChangeWithFreeform=function(e){var t=this.props.hoisted.currentOptions,n=-1;if(""===e)return 1===(i=t.map(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{index:t})}).filter(function(t){return AD(t)&&!t.disabled&&kD(t)===e})).length&&(n=i[0].index),this._setPendingInfo(e,n,e),n;var a=e;e=e.toLocaleLowerCase();var i,r="";if("on"===this.props.autoComplete){if((i=t.map(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{index:t})}).filter(function(t){return AD(t)&&!t.disabled&&0===kD(t).toLocaleLowerCase().indexOf(e)})).length>0){var s=kD(i[0]);r=s.toLocaleLowerCase()!==e?s:"",n=i[0].index}}else 1===(i=t.map(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{index:t})}).filter(function(t){return AD(t)&&!t.disabled&&kD(t).toLocaleLowerCase()===e})).length&&(n=i[0].index);return this._setPendingInfo(a,n,r),n},t.prototype._processInputChangeWithoutFreeform=function(e){var t=this,n=this.state,a=n.currentPendingValue,i=n.currentPendingValueValidIndex;if("on"===this.props.autoComplete&&""!==e){this._autoCompleteTimeout&&(this._async.clearTimeout(this._autoCompleteTimeout),this._autoCompleteTimeout=void 0,e=wD(a)+e);var r=this._updateAutocompleteIndexWithoutFreeform(e);return this._autoCompleteTimeout=this._async.setTimeout(function(){t._autoCompleteTimeout=void 0},1e3),r}var o=i>=0?i:this._getFirstSelectedIndex();return this._setPendingInfoFromIndex(o),o},t.prototype._updateAutocompleteIndexWithoutFreeform=function(e){var t=this.props.hoisted.currentOptions,n=e;e=e.toLocaleLowerCase();var a=t.map(function(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{index:t})}).filter(function(t){return AD(t)&&!t.disabled&&0===t.text.toLocaleLowerCase().indexOf(e)});return a.length>0?(this._setPendingInfo(n,a[0].index,kD(a[0])),a[0].index):-1},t.prototype._getFirstSelectedIndex=function(){var e=this.props.hoisted.selectedIndices;return(null==e?void 0:e.length)?e[0]:-1},t.prototype._getNextSelectableIndex=function(e,t){var n=this.props.hoisted.currentOptions,a=e+t;if(!ED(n,a=Math.max(0,Math.min(n.length-1,a))))return-1;var i=n[a];if(!LD(i)||!0===i.hidden){if(t===aD.none||!(a>0&&t<aD.none||a>=0&&a<n.length&&t>aD.none))return e;a=this._getNextSelectableIndex(a,t)}return a},t.prototype._setSelectedIndex=function(e,t,n){void 0===n&&(n=aD.none);var a=this.props,i=a.onChange,r=a.onPendingValueChanged,s=a.hoisted,c=s.selectedIndices,d=s.currentOptions,l=c?c.slice():[],u=d.slice();if(ED(d,e=this._getNextSelectableIndex(e,n))){if(this.props.multiSelect||l.length<1||1===l.length&&l[0]!==e){var f=Object(o.__assign)({},d[e]);if(!f||f.disabled)return;if(this.props.multiSelect)if(f.selected=void 0!==f.selected?!f.selected:l.indexOf(e)<0,f.itemType===nD.SelectAll)l=[],f.selected?d.forEach(function(e,t){!e.disabled&&LD(e)&&(l.push(t),u[t]=Object(o.__assign)(Object(o.__assign)({},e),{selected:!0}))}):u=d.map(function(e){return Object(o.__assign)(Object(o.__assign)({},e),{selected:!1})});else{f.selected&&l.indexOf(e)<0?l.push(e):!f.selected&&l.indexOf(e)>=0&&(l=l.filter(function(t){return t!==e})),u[e]=f;var p=u.filter(function(e){return e.itemType===nD.SelectAll})[0];if(p){var m=this._isSelectAllChecked(l),_=u.indexOf(p);m?(l.push(_),u[_]=Object(o.__assign)(Object(o.__assign)({},p),{selected:!0})):(l=l.filter(function(e){return e!==_}),u[_]=Object(o.__assign)(Object(o.__assign)({},p),{selected:!1}))}}else l[0]=e;t.persist(),this.props.selectedKey||null===this.props.selectedKey||(this.props.hoisted.setSelectedIndices(l),this.props.hoisted.setCurrentOptions(u)),this._hasPendingValue&&r&&(r(),this._hasPendingValue=!1),i&&i(t,f,e,kD(f))}this.props.multiSelect&&this.state.isOpen||this._clearPendingInfo()}},t.prototype._submitPendingValue=function(e){var t,n=this.props,a=n.onChange,i=n.allowFreeform,r=n.autoComplete,o=n.multiSelect,s=n.hoisted,c=s.currentOptions,d=this.state,l=d.currentPendingValue,f=d.currentPendingValueValidIndex,p=d.currentPendingValueValidIndexOnHover,m=this.props.hoisted.selectedIndices;if(!this._processingClearPendingInfo){if(i){if(null==l)return void(p>=0&&(this._setSelectedIndex(p,e),this._clearPendingInfo()));if(ED(c,f)){var _=kD(c[f]).toLocaleLowerCase(),h=this._autofill.current;if(l.toLocaleLowerCase()===_||r&&0===_.indexOf(l.toLocaleLowerCase())&&(null==h?void 0:h.isValueSelected)&&l.length+(h.selectionEnd-h.selectionStart)===_.length||(null===(t=null==h?void 0:h.inputElement)||void 0===t?void 0:t.value.toLocaleLowerCase())===_){if(this._setSelectedIndex(f,e),o&&this.state.isOpen)return;return void this._clearPendingInfo()}}if(a)a&&a(e,void 0,void 0,l);else{var b={key:l||Object(u.getId)(),text:wD(l)};o&&(b.selected=!0);var g=c.concat([b]);m&&(o||(m=[]),m.push(g.length-1)),s.setCurrentOptions(g),s.setSelectedIndices(m)}}else f>=0?this._setSelectedIndex(f,e):p>=0&&this._setSelectedIndex(p,e);this._clearPendingInfo()}},t.prototype._onCalloutLayerMounted=function(){this._gotMouseMove=!1},t.prototype._renderSeparator=function(e){var t=e.index,n=e.key;return t&&t>0?s.createElement("div",{role:"presentation",key:n,className:this._classNames.divider}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOptionContent:t;return s.createElement("div",{id:e.id,key:e.key,className:this._classNames.header},n(e,this._onRenderOptionContent))},t.prototype._renderCheckboxLabel=function(e){var t=this.props.onRenderOption;return(void 0===t?this._onRenderMultiselectOptionContent:t)(e,this._onRenderMultiselectOptionContent)},t.prototype._isOptionHighlighted=function(e){var t=this.state.currentPendingValueValidIndexOnHover;return t!==iD.clearAll&&(t>=0?t===e:this._isOptionSelected(e))},t.prototype._isOptionSelected=function(e){return this._getPendingSelectedIndex(!0)===e},t.prototype._isOptionChecked=function(e){return!(!this.props.multiSelect||void 0===e||!this.props.hoisted.selectedIndices)&&this.props.hoisted.selectedIndices.indexOf(e)>=0},t.prototype._isOptionIndeterminate=function(e){var t=this.props,n=t.multiSelect,a=t.hoisted;if(n&&void 0!==e&&a.selectedIndices&&a.currentOptions){var i=a.currentOptions[e];if(i&&i.itemType===nD.SelectAll)return a.selectedIndices.length>0&&!this._isSelectAllChecked()}return!1},t.prototype._isSelectAllChecked=function(e){var t=this.props,n=t.multiSelect,a=t.hoisted,i=a.currentOptions.find(function(e){return e.itemType===nD.SelectAll}),r=e||a.selectedIndices;if(!n||!r||!i)return!1;var o=a.currentOptions.indexOf(i),s=r.filter(function(e){return e!==o}),c=a.currentOptions.filter(function(e){return!e.disabled&&e.itemType!==nD.SelectAll&&LD(e)});return s.length===c.length},t.prototype._getPendingSelectedIndex=function(e){var t=this.state,n=t.currentPendingValueValidIndex,a=t.currentPendingValue;return n>=0||e&&null!=a?n:this.props.multiSelect?-1:this._getFirstSelectedIndex()},t.prototype._scrollIntoView=function(){var e=this.props,t=e.onScrollToItem,n=e.scrollSelectedToTop,a=this._getPendingSelectedIndex(!0);if(t)t(a>=0?a:this._getFirstSelectedIndex());else{var i=this._selectedElement.current;if(this.props.multiSelect&&this._comboBoxMenu.current&&(i=ID(this._comboBoxMenu.current,function(e){var t;return(null===(t=e.dataset)||void 0===t?void 0:t.index)===a.toString()})),i&&i.offsetParent){var r=!0;if(this._comboBoxMenu.current&&this._comboBoxMenu.current.offsetParent){var o=this._comboBoxMenu.current.offsetParent,s=i.offsetParent,c=s.offsetHeight,d=s.offsetTop,l=o,u=l.offsetHeight,f=l.scrollTop,p=d+c>f+u;d<f||n?(r=!1,o.scrollTo(0,d)):p&&o.scrollTo(0,d-u+c)}else i.offsetParent.scrollIntoView(r)}}},t.prototype._onItemClick=function(e){var t=this,n=this.props.onItemClick,a=e.index;return function(i){t.props.multiSelect||(t._autofill.current&&t._autofill.current.focus(),t.setState({isOpen:!1})),n&&n(i,e,a),t._setSelectedIndex(a,i)}},t.prototype._resetSelectedIndex=function(){var e=this.props.hoisted.currentOptions;this._clearPendingInfo();var t=this._getFirstSelectedIndex();t>0&&t<e.length?this.props.hoisted.setSuggestedDisplayValue(e[t].text):this.props.text&&this.props.hoisted.setSuggestedDisplayValue(this.props.text)},t.prototype._clearPendingInfo=function(){this._processingClearPendingInfo=!0,this.props.hoisted.setSuggestedDisplayValue(void 0),this.setState({currentPendingValue:void 0,currentPendingValueValidIndex:-1,currentPendingValueValidIndexOnHover:iD.default},this._onAfterClearPendingInfo)},t.prototype._setPendingInfo=function(e,t,n){void 0===t&&(t=-1),this._processingClearPendingInfo||(this.props.hoisted.setSuggestedDisplayValue(n),this.setState({currentPendingValue:wD(e),currentPendingValueValidIndex:t,currentPendingValueValidIndexOnHover:iD.default}))},t.prototype._setPendingInfoFromIndex=function(e){var t=this.props.hoisted.currentOptions;if(e>=0&&e<t.length){var n=t[e];this._setPendingInfo(kD(n),e,kD(n))}else this._clearPendingInfo()},t.prototype._setPendingInfoFromIndexAndDirection=function(e,t){var n=this.props.hoisted.currentOptions;t===aD.forward&&e>=n.length-1?e=-1:t===aD.backward&&e<=0&&(e=n.length);var a=this._getNextSelectableIndex(e,t);e===a?t===aD.forward?e=this._getNextSelectableIndex(-1,t):t===aD.backward&&(e=this._getNextSelectableIndex(n.length,t)):e=a,ED(n,e)&&this._setPendingInfoFromIndex(e)},t.prototype._notifyPendingValueChanged=function(e){var t=this.props.onPendingValueChanged;if(t){var n=this.props.hoisted.currentOptions,a=this.state,i=a.currentPendingValue,r=a.currentPendingValueValidIndex,o=a.currentPendingValueValidIndexOnHover,s=void 0,c=void 0;o!==e.currentPendingValueValidIndexOnHover&&ED(n,o)?s=o:r!==e.currentPendingValueValidIndex&&ED(n,r)?s=r:i!==e.currentPendingValue&&(c=i),(void 0!==s||void 0!==c||this._hasPendingValue)&&(t(void 0!==s?n[s]:void 0,s,c),this._hasPendingValue=void 0!==s||void 0!==c)}},t.prototype._setOpenStateAndFocusOnClose=function(e,t){this._focusInputAfterClose=t,this.setState({isOpen:e})},t.prototype._onOptionMouseEnter=function(e){this._shouldIgnoreMouseEvent()||this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._onOptionMouseMove=function(e){this._gotMouseMove=!0,this._isScrollIdle&&this.state.currentPendingValueValidIndexOnHover!==e&&this.setState({currentPendingValueValidIndexOnHover:e})},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._handleInputWhenDisabled=function(e){this.props.disabled&&(this.state.isOpen&&this.setState({isOpen:!1}),null!==e&&e.which!==u.KeyCodes.tab&&e.which!==u.KeyCodes.escape&&(e.which<112||e.which>123)&&(e.stopPropagation(),e.preventDefault()))},t.prototype._handleTouchAndPointerEvent=function(){var e=this;void 0!==this._lastTouchTimeoutId&&(this._async.clearTimeout(this._lastTouchTimeoutId),this._lastTouchTimeoutId=void 0),this._processingTouch=!0,this._lastTouchTimeoutId=this._async.setTimeout(function(){e._processingTouch=!1,e._lastTouchTimeoutId=void 0},500)},t.prototype._getCaretButtonStyles=function(){var e=this.props.caretDownButtonStyles;return mD(this.props.theme,e)},t.prototype._getCurrentOptionStyles=function(e){var t=this.props.comboBoxOptionStyles,n=e.styles;return pD(this.props.theme,t,n,this._isPendingOption(e),e.hidden,this._isOptionHighlighted(e.index))},t.prototype._getAriaAutoCompleteValue=function(){return this.props.disabled||"on"!==this.props.autoComplete?"list":this.props.allowFreeform?"inline":"both"},t.prototype._isPendingOption=function(e){return e&&e.index===this.state.currentPendingValueValidIndex},t.prototype._hasFocus=function(){return"none"!==this.state.focusState},Object(o.__decorate)([Object(u.customizable)("ComboBox",["theme","styles"],!0)],t)}(s.Component);function CD(e,t){if(!e||!t)return[];var n={};e.forEach(function(e,t){e.selected&&(n[t]=!0)});for(var a=function(t){var a=Object(u.findIndex)(e,function(e){return e.key===t});a>-1&&(n[a]=!0)},i=0,r=t;i<r.length;i++)a(r[i]);return Object.keys(n).map(Number).sort()}function OD(e){return void 0===e?[]:e instanceof Array?e:[e]}function wD(e){return e||""}function ED(e,t){return!!e&&t>=0&&t<e.length}function AD(e){return e.itemType!==nD.Header&&e.itemType!==nD.Divider&&e.itemType!==nD.SelectAll}function LD(e){return e.itemType!==nD.Header&&e.itemType!==nD.Divider}function kD(e){return e.useAriaLabelAsText&&e.ariaLabel?e.ariaLabel:e.text}function MD(e){return e.which===u.KeyCodes.alt||"Meta"===e.key}function PD(e){return"#".concat(function(e,t,n){var a=sa(e,100,100);return la(a.r,a.g,a.b)}(e.h))}function TD(e,t,n){var a=sa(e.h,t,n),i=a.r,r=a.g,s=a.b,c=la(i,r,s);return Object(o.__assign)(Object(o.__assign)({},e),{s:t,v:n,r:i,g:r,b:s,hex:c,str:fa(i,r,s,e.a,c)})}var UD=Object(u.classNamesFunction)(),FD=function(e){function t(t){var n=e.call(this,t)||this;return n._disposables=[],n._root=s.createRef(),n._isAdjustingSaturation=!0,n._descriptionId=Object(u.getId)("ColorRectangle-description"),n._onKeyDown=function(e){var t=n.state.color,a=t.s,i=t.v,r=e.shiftKey?10:1;switch(e.which){case u.KeyCodes.up:n._isAdjustingSaturation=!1,i+=r;break;case u.KeyCodes.down:n._isAdjustingSaturation=!1,i-=r;break;case u.KeyCodes.left:n._isAdjustingSaturation=!0,a-=r;break;case u.KeyCodes.right:n._isAdjustingSaturation=!0,a+=r;break;default:return}n._updateColor(e,TD(t,da(a,100),da(i,na)))},n._onMouseDown=function(e){n._disposables.push(Object(u.on)(window,"mousemove",n._onMouseMove,!0),Object(u.on)(window,"mouseup",n._disposeListeners,!0)),n._onMouseMove(e)},n._onMouseMove=function(e){if(n._root.current){var t=HD(e,n.state.color,n._root.current);t&&n._updateColor(e,t)}},n._onTouchStart=function(e){n._root.current&&e.stopPropagation()},n._onTouchMove=function(e){if(n._root.current){var t=HD(e,n.state.color,n._root.current);t&&n._updateColor(e,t),e.preventDefault(),e.stopPropagation()}},n._disposeListeners=function(){n._disposables.forEach(function(e){return e()}),n._disposables=[]},Object(u.initializeComponentRef)(n),n.state={color:t.color},n}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"color",{get:function(){return this.state.color},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e,t){e!==this.props&&this.props.color&&this.setState({color:this.props.color})},t.prototype.componentDidMount=function(){this._root.current&&(this._root.current.addEventListener("touchstart",this._onTouchStart,{capture:!0,passive:!1}),this._root.current.addEventListener("touchmove",this._onTouchMove,{capture:!0,passive:!1}))},t.prototype.componentWillUnmount=function(){this._root.current&&(this._root.current.removeEventListener("touchstart",this._onTouchStart),this._root.current.removeEventListener("touchmove",this._onTouchMove)),this._disposeListeners()},t.prototype.render=function(){var e=this.props,t=e.minSize,n=e.theme,a=e.className,i=e.styles,r=e.ariaValueFormat,o=e.ariaLabel,c=e.ariaDescription,d=this.state.color,l=UD(i,{theme:n,className:a,minSize:t}),u=r.replace("{0}",String(d.s)).replace("{1}",String(d.v));return s.createElement("div",{ref:this._root,tabIndex:0,className:l.root,style:{backgroundColor:PD(d)},onMouseDown:this._onMouseDown,onKeyDown:this._onKeyDown,role:"slider","aria-valuetext":u,"aria-valuenow":this._isAdjustingSaturation?d.s:d.v,"aria-valuemin":0,"aria-valuemax":na,"aria-label":o,"aria-describedby":this._descriptionId,"data-is-focusable":!0},s.createElement("div",{className:l.description,id:this._descriptionId},c),s.createElement("div",{className:l.light}),s.createElement("div",{className:l.dark}),s.createElement("div",{className:l.thumb,style:{left:d.s+"%",top:na-d.v+"%",backgroundColor:d.str}}))},t.prototype._updateColor=function(e,t){var n=this.props.onChange,a=this.state.color;t.s===a.s&&t.v===a.v||(n&&n(e,t),e.defaultPrevented||(this.setState({color:t}),e.preventDefault()))},t.defaultProps={minSize:220,ariaLabel:"Saturation and brightness",ariaValueFormat:"Saturation {0} brightness {1}",ariaDescription:"Use left and right arrow keys to set saturation. Use up and down arrow keys to set brightness."},t}(s.Component);function HD(e,t,n){var a=n.getBoundingClientRect(),i=void 0,r=e;if(r.touches){var o=r.touches[r.touches.length-1];void 0!==o.clientX&&void 0!==o.clientY&&(i={clientX:o.clientX,clientY:o.clientY})}if(!i){var s=e;void 0!==s.clientX&&void 0!==s.clientY&&(i={clientX:s.clientX,clientY:s.clientY})}if(i){var c=(i.clientX-a.left)/a.width,d=(i.clientY-a.top)/a.height;return TD(t,da(Math.round(100*c),100),da(Math.round(na-d*na),na))}}var RD=Object(u.styled)(FD,function(e){var t,n,a=e.className,i=e.theme,r=e.minSize,s=i.palette,c=i.effects;return{root:["ms-ColorPicker-colorRect",{position:"relative",marginBottom:8,border:"1px solid ".concat(s.neutralLighter),borderRadius:c.roundedCorner2,minWidth:r,minHeight:r,outline:"none",selectors:(t={},t[u.HighContrastSelector]=Object(o.__assign)({},Object(u.getHighContrastNoAdjustStyle)()),t[".".concat(u.IsFocusVisibleClassName," &:focus")]=(n={outline:"1px solid ".concat(s.neutralSecondary)},n["".concat(u.HighContrastSelector)]={outline:"2px solid CanvasText"},n),t)},a],light:["ms-ColorPicker-light",{position:"absolute",left:0,right:0,top:0,bottom:0,background:"linear-gradient(to right, white 0%, transparent 100%) /*@noflip*/"}],dark:["ms-ColorPicker-dark",{position:"absolute",left:0,right:0,top:0,bottom:0,background:"linear-gradient(to bottom, transparent 0, #000 100%)"}],thumb:["ms-ColorPicker-thumb",{position:"absolute",width:20,height:20,background:"white",border:"1px solid ".concat(s.neutralSecondaryAlt),borderRadius:"50%",boxShadow:c.elevation8,transform:"translate(-50%, -50%)",selectors:{":before":{position:"absolute",left:0,right:0,top:0,bottom:0,border:"2px solid ".concat(s.white),borderRadius:"50%",boxSizing:"border-box",content:'""'}}}],description:mt.hiddenContentStyle}},void 0,{scope:"ColorRectangle"}),ND=Object(u.classNamesFunction)(),BD=function(e){function t(t){var n=e.call(this,t)||this;return n._disposables=[],n._root=s.createRef(),n._onKeyDown=function(e){var t=n.value,a=n._maxValue,i=e.shiftKey?10:1;switch(e.which){case u.KeyCodes.left:t-=i;break;case u.KeyCodes.right:t+=i;break;case u.KeyCodes.home:t=0;break;case u.KeyCodes.end:t=a;break;default:return}n._updateValue(e,da(t,a))},n._onMouseDown=function(e){var t=Object(u.getWindow)(n);t&&n._disposables.push(Object(u.on)(t,"mousemove",n._onMouseMove,!0),Object(u.on)(t,"mouseup",n._disposeListeners,!0)),n._onMouseMove(e)},n._onMouseMove=function(e){if(n._root.current){var t=n._maxValue,a=n._root.current.getBoundingClientRect(),i=(e.clientX-a.left)/a.width,r=da(Math.round(i*t),t);n._updateValue(e,r)}},n._onTouchStart=function(e){n._root.current&&e.stopPropagation()},n._onTouchMove=function(e){if(n._root.current){var t=e.touches[e.touches.length-1];if(void 0!==t.clientX){var a=n._maxValue,i=n._root.current.getBoundingClientRect(),r=(t.clientX-i.left)/i.width,o=da(Math.round(r*a),a);n._updateValue(e,o)}e.preventDefault(),e.stopPropagation()}},n._disposeListeners=function(){n._disposables.forEach(function(e){return e()}),n._disposables=[]},Object(u.initializeComponentRef)(n),Object(u.warnDeprecations)("ColorSlider",t,{thumbColor:"styles.sliderThumb",overlayStyle:"overlayColor",isAlpha:"type",maxValue:"type",minValue:"type"}),"hue"===n._type||t.overlayColor||t.overlayStyle||Object(u.warn)("ColorSlider: 'overlayColor' is required when 'type' is \"alpha\" or \"transparency\""),n.state={currentValue:t.value||0},n}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this.state.currentValue},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e,t){e!==this.props&&void 0!==this.props.value&&this.setState({currentValue:this.props.value})},t.prototype.componentDidMount=function(){this._root.current&&(this._root.current.addEventListener("touchstart",this._onTouchStart,{capture:!0,passive:!1}),this._root.current.addEventListener("touchmove",this._onTouchMove,{capture:!0,passive:!1}))},t.prototype.componentWillUnmount=function(){this._root.current&&(this._root.current.removeEventListener("touchstart",this._onTouchStart),this._root.current.removeEventListener("touchmove",this._onTouchMove)),this._disposeListeners()},t.prototype.render=function(){var e=this._type,t=this._maxValue,n=this.props,a=n.overlayStyle,i=n.overlayColor,r=n.theme,o=n.className,c=n.styles,d=n.ariaLabel,l=void 0===d?e:d,u=this.value,f=ND(c,{theme:r,className:o,type:e}),p=100*u/t;return s.createElement("div",{ref:this._root,className:f.root,tabIndex:0,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,role:"slider","aria-valuenow":u,"aria-valuetext":String(u),"aria-valuemin":0,"aria-valuemax":t,"aria-label":l,"data-is-focusable":!0},!(!i&&!a)&&s.createElement("div",{className:f.sliderOverlay,style:i?{background:"transparency"===e?"linear-gradient(to right, #".concat(i,", transparent)"):"linear-gradient(to right, transparent, #".concat(i,")")}:a}),s.createElement("div",{className:f.sliderThumb,style:{left:p+"%"}}))},Object.defineProperty(t.prototype,"_type",{get:function(){var e=this.props,t=e.isAlpha,n=e.type;return void 0===n?t?"alpha":"hue":n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_maxValue",{get:function(){return"hue"===this._type?359:ia},enumerable:!1,configurable:!0}),t.prototype._updateValue=function(e,t){if(t!==this.value){var n=this.props.onChange;n&&n(e,t),e.defaultPrevented||(this.setState({currentValue:t}),e.preventDefault())}},t.defaultProps={value:0},t}(s.Component),jD={background:"linear-gradient(".concat(["to left","red 0","#f09 10%","#cd00ff 20%","#3200ff 30%","#06f 40%","#00fffd 50%","#0f6 60%","#35ff00 70%","#cdff00 80%","#f90 90%","red 100%"].join(","),")")},VD={backgroundImage:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAJUlEQVQYV2N89erVfwY0ICYmxoguxjgUFKI7GsTH5m4M3w1ChQC1/Ca8i2n1WgAAAABJRU5ErkJggg==)"},zD=Object(u.styled)(BD,function(e){var t,n,a=e.theme,i=e.className,r=e.type,o=void 0===r?"hue":r,s=e.isAlpha,c=void 0===s?"hue"!==o:s,d=a.palette,l=a.effects;return{root:["ms-ColorPicker-slider",{position:"relative",height:20,marginBottom:8,border:"1px solid ".concat(d.neutralLight),borderRadius:l.roundedCorner2,boxSizing:"border-box",outline:"none",forcedColorAdjust:"none",selectors:(t={},t[".".concat(u.IsFocusVisibleClassName," &:focus")]=(n={outline:"1px solid ".concat(d.neutralSecondary)},n["".concat(u.HighContrastSelector)]={outline:"2px solid CanvasText"},n),t)},c?VD:jD,i],sliderOverlay:["ms-ColorPicker-sliderOverlay",{content:"",position:"absolute",left:0,right:0,top:0,bottom:0}],sliderThumb:["ms-ColorPicker-thumb","is-slider",{position:"absolute",width:20,height:20,background:"white",border:"1px solid ".concat(d.neutralSecondaryAlt),borderRadius:"50%",boxShadow:l.elevation8,transform:"translate(-50%, -50%)",top:"50%",forcedColorAdjust:"auto"}]}},void 0,{scope:"ColorSlider"});function GD(e,t){return Object(o.__assign)(Object(o.__assign)({},e),{a:t,t:ia-t,str:fa(e.r,e.g,e.b,t,e.hex)})}function KD(e,t){var n=ia-t;return Object(o.__assign)(Object(o.__assign)({},e),{t:t,a:n,str:fa(e.r,e.g,e.b,n,e.hex)})}var WD=Object(u.classNamesFunction)(),qD=["hex","r","g","b","a","t"],QD={hex:"hexError",r:"redError",g:"greenError",b:"blueError",a:"alphaError",t:"transparencyError"},YD=function(e){function t(n){var a=e.call(this,n)||this;a._onSVChanged=function(e,t){a._updateColor(e,t)},a._onHChanged=function(e,t){a._updateColor(e,function(e,t){var n=sa(t,e.s,e.v),a=n.r,i=n.g,r=n.b,s=la(a,i,r);return Object(o.__assign)(Object(o.__assign)({},e),{h:t,r:a,g:i,b:r,hex:s,str:fa(a,i,r,e.a,s)})}(a.state.color,t))},a._onATChanged=function(e,t){var n="transparency"===a.props.alphaType?KD:GD;a._updateColor(e,n(a.state.color,Math.round(t)))},a._onBlur=function(e){var t,n=a.state,i=n.color,r=n.editingColor;if(r){var s,c=r.value,d=r.component,l="hex"===d,u="a"===d,f="t"===d,p=l?3:1;if(c.length>=p&&(l||!isNaN(Number(c)))){var m;m=l?ma("#"+(!(s=c)||s.length<3?"ffffff":s.length>=6?s.substring(0,6):s.substring(0,3))):u||f?(u?GD:KD)(i,da(Number(c),ia)):pa(function(e){return{r:da(e.r,aa),g:da(e.g,aa),b:da(e.b,aa),a:"number"==typeof e.a?da(e.a,ia):e.a}}(Object(o.__assign)(Object(o.__assign)({},i),((t={})[d]=Number(c),t)))),a._updateColor(e,m)}else a.setState({editingColor:void 0})}},Object(u.initializeComponentRef)(a);var i=n.strings;Object(u.warnDeprecations)("ColorPicker",n,{hexLabel:"strings.hex",redLabel:"strings.red",greenLabel:"strings.green",blueLabel:"strings.blue",alphaLabel:"strings.alpha",alphaSliderHidden:"alphaType"}),i.hue&&Object(u.warn)("ColorPicker property 'strings.hue' was used but has been deprecated. Use 'strings.hueAriaLabel' instead."),a.state={color:JD(n)||ma("#ffffff")},a._textChangeHandlers={};for(var r=0,s=qD;r<s.length;r++){var c=s[r];a._textChangeHandlers[c]=a._onTextChange.bind(a,c)}var d=t.defaultProps.strings;return a._textLabels={r:n.redLabel||i.red||d.red,g:n.greenLabel||i.green||d.green,b:n.blueLabel||i.blue||d.blue,a:n.alphaLabel||i.alpha||d.alpha,hex:n.hexLabel||i.hex||d.hex,t:i.transparency||d.transparency},a._strings=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},d),{alphaAriaLabel:a._textLabels.a,transparencyAriaLabel:a._textLabels.t}),i),a}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"color",{get:function(){return this.state.color},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e,t){if(e!==this.props){var n=JD(this.props);n&&this._updateColor(void 0,n)}},t.prototype.render=function(){var e=this,t=this.props,n=this._strings,a=this._textLabels,i=t.theme,r=t.className,c=t.styles,d=t.alphaType,l=t.alphaSliderHidden,f=void 0===l?"none"===d:l,p=t.tooltipProps,m=this.state.color,_="transparency"===d,h=["hex","r","g","b",_?"t":"a"],b=_?m.t:m.a,g=_?a.t:a.a,v=WD(c,{theme:i,className:r,alphaType:d}),y=[a.r,m.r,a.g,m.g,a.b,m.b];f||"number"!=typeof b||y.push(g,"".concat(b,"%"));var S=n.rootAriaLabelFormat.replace("{0}",y.join(" "));return s.createElement("div",{className:v.root,role:"group","aria-label":S},s.createElement("div",{className:v.panel},s.createElement(RD,{color:m,onChange:this._onSVChanged,ariaLabel:n.svAriaLabel,ariaDescription:n.svAriaDescription,ariaValueFormat:n.svAriaValueFormat,className:v.colorRectangle}),s.createElement("div",{className:v.flexContainer},s.createElement("div",{className:v.flexSlider},s.createElement(zD,{className:"is-hue",type:"hue",ariaLabel:n.hue||n.hueAriaLabel,value:m.h,onChange:this._onHChanged}),!f&&s.createElement(zD,{className:"is-alpha",type:d,ariaLabel:_?n.transparencyAriaLabel:n.alphaAriaLabel,overlayColor:m.hex,value:b,onChange:this._onATChanged})),t.showPreview&&s.createElement("div",{className:v.flexPreviewBox},s.createElement("div",{className:v.colorSquare+" is-preview",style:{backgroundColor:m.str}}))),s.createElement("table",{className:v.table,role:"group",cellPadding:"0",cellSpacing:"0"},s.createElement("thead",null,s.createElement("tr",{className:v.tableHeader},s.createElement("td",{className:v.tableHexCell},a.hex),s.createElement("td",null,a.r),s.createElement("td",null,a.g),s.createElement("td",null,a.b),!f&&s.createElement("td",{className:v.tableAlphaCell},g))),s.createElement("tbody",null,s.createElement("tr",null,h.map(function(t){if(("a"===t||"t"===t)&&f)return null;var n=e._getTooltipValue(t);return s.createElement("td",{key:t},s.createElement(u.TooltipHost,Object(o.__assign)({content:n,directionalHint:u.DirectionalHint.bottomCenter,role:"alert"},p),s.createElement(u.TextField,{className:v.input,onChange:e._textChangeHandlers[t],onBlur:e._onBlur,value:e._getDisplayValue(t),spellCheck:!1,ariaLabel:a[t],autoComplete:"off",invalid:!!n})))}))))))},t.prototype._getDisplayValue=function(e){var t=this.state,n=t.color,a=t.editingColor;return a&&a.component===e?a.value:"hex"===e?n[e]||"":"number"!=typeof n[e]||isNaN(n[e])?"":String(n[e])},t.prototype._getTooltipValue=function(e){var t=this.state.editingColor;if(t&&t.component===e){var n=t.value;if(!("hex"===e&&n.length>=3&&n.length<=6)){var a=QD[e];return this._strings[a]}}},t.prototype._onTextChange=function(e,t,n){var a,i=this.state.color,r="hex"===e,s="a"===e,c="t"===e;if(n=(n||"").substr(0,r?6:3),(r?ra:oa).test(n))if(""!==n&&(r?6===n.length:s||c?Number(n)<=ia:Number(n)<=aa))if(String(i[e])===n)this.state.editingColor&&this.setState({editingColor:void 0});else{var d=r?ma("#"+n):c?KD(i,Number(n)):pa(Object(o.__assign)(Object(o.__assign)({},i),((a={})[e]=Number(n),a)));this._updateColor(t,d)}else this.setState({editingColor:{component:e,value:n}})},t.prototype._updateColor=function(e,t){if(t){var n=this.state,a=n.color,i=n.editingColor;if(t.h!==a.h||t.str!==a.str||i){if(e&&this.props.onChange&&(this.props.onChange(e,t),e.defaultPrevented))return;this.setState({color:t,editingColor:void 0})}}},t.defaultProps={alphaType:"alpha",strings:{rootAriaLabelFormat:"Color picker, {0} selected.",hex:"Hex",red:"Red",green:"Green",blue:"Blue",alpha:"Alpha",transparency:"Transparency",hueAriaLabel:"Hue",svAriaLabel:FD.defaultProps.ariaLabel,svAriaValueFormat:FD.defaultProps.ariaValueFormat,svAriaDescription:FD.defaultProps.ariaDescription,hexError:"Hex values must be between 3 and 6 characters long",alphaError:"Alpha must be between 0 and 100",transparencyError:"Transparency must be between 0 and 100",redError:"Red must be between 0 and 255",greenError:"Green must be between 0 and 255",blueError:"Blue must be between 0 and 255"}},t}(s.Component);function JD(e){var t=e.color;return"string"==typeof t?ma(t):t}var XD=Object(u.styled)(YD,function(e){var t=e.className,n=e.theme,a=e.alphaType;return{root:["ms-ColorPicker",n.fonts.medium,{position:"relative",maxWidth:300},t],panel:["ms-ColorPicker-panel",{padding:"16px"}],table:["ms-ColorPicker-table",{tableLayout:"fixed",width:"100%",selectors:{"tbody td:last-of-type .ms-ColorPicker-input":{paddingRight:0}}}],tableHeader:[n.fonts.small,{selectors:{td:{paddingBottom:4}}}],tableHexCell:{width:"25%"},tableAlphaCell:"transparency"===a&&{width:"22%"},colorSquare:["ms-ColorPicker-colorSquare",{width:48,height:48,margin:"0 0 0 8px",border:"1px solid #c8c6c4",forcedColorAdjust:"none"}],flexContainer:{display:"flex"},flexSlider:{flexGrow:"1"},flexPreviewBox:{flexGrow:"0"},input:["ms-ColorPicker-input",{width:"100%",border:"none",boxSizing:"border-box",height:30,selectors:{"&.ms-TextField":{paddingRight:4},"& .ms-TextField-field":{minWidth:"auto",padding:5,textOverflow:"clip"}}}]}},void 0,{scope:"ColorPicker"}),ZD=function(){return ZD=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ZD.apply(this,arguments)},$D=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},eI="Spot Fix",tI="DallE-2",nI="Stable Diffusion",aI="Color Replacement",iI=[{key:eI,text:eI},{key:tI,text:tI},{key:nI,text:nI},{key:aI,text:aI}],rI=Object(s.memo)(function(e){var t,n=e.size,a=e.header,i=e.footer,r=e.styles,o=e.algorithmParameters,d=e.setAlgorithmParameters,l=Object(s.useRef)(""),f=Object(s.useRef)(sl),p=o.algorithmType===_h.dallE2||o.algorithmType===_h.stableDiffusion,m=o.algorithmType===_h.colorReplacement,_=o.algorithmType,b=Object(s.useMemo)(function(){switch(_){case _h.dallE2:return tI;case _h.stableDiffusion:return nI;case _h.spotFix:return eI;case _h.colorReplacement:return aI;default:throw new h(_)}},[_]),g=Object(s.useCallback)(function(e,t){t&&(t.key===tI?d(ZD(ZD({},o),{algorithmType:_h.dallE2,prompt:l.current})):t.key===nI?d(ZD(ZD({},o),{algorithmType:_h.stableDiffusion,prompt:l.current})):t.key===aI?d(ZD(ZD({},o),{algorithmType:_h.colorReplacement,color:f.current})):d(ZD(ZD({},o),{algorithmType:_h.spotFix})))},[o,d]),v=Object(s.useCallback)(function(e,t){var n,a,i=(void 0===a&&(a=1),[(n=t).r/255,n.g/255,n.b/255,void 0===n.a?a:n.a/100]);o.algorithmType===_h.colorReplacement&&d(ZD(ZD({},o),{color:$D([],i,!0)})),f.current=$D([],i,!0)},[o,d]);return c.a.createElement(tt,{styles:r,size:n,header:a,footer:i},c.a.createElement(DD,{label:"Algorithm",text:b,options:iI,onChange:g}),p&&c.a.createElement(u.TextField,{label:"Prompt",value:p?o.prompt:"",onChange:function(e,t){var n=t||"";l.current=n,d(ZD(ZD({},o),{prompt:n}))},onKeyDown:function(e){e.stopPropagation()},onKeyUp:function(e){e.stopPropagation()},multiline:!0,rows:5}),m&&c.a.createElement(c.a.Fragment,null,c.a.createElement(XD,{color:(t=o.color,"rgba(".concat(Math.round(255*t[0]),",").concat(Math.round(255*t[1]),",").concat(Math.round(255*t[2]),",").concat(t[3],")")),onChange:v,showPreview:!0})),e.children)}),oI={setAlgorithmParameters:T5},sI=Object(ee.connect)(function(e){return{algorithmParameters:e.inPaintingUi.algorithmParameters}},oI)(rI),cI=function(){return cI=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},cI.apply(this,arguments)},dI="Rectangle",lI="Mask layer",uI="Pill Shape",fI=[{key:dI,text:dI},{key:lI,text:lI}],pI=Object(s.memo)(function(e){var t=e.size,n=e.header,a=e.footer,i=e.styles,r=e.algorithmParameters,o=e.setAlgorithmParameters,d=r.maskType,l=Object(s.useMemo)(function(){switch(d){case Ih.FromMaskLayer:return lI;case Ih.RectangleMask:return dI;case Ih.PillShapedMask:return uI;case Ih.CircleMask:return"Circle";default:throw new h(d)}},[d]),u=Object(s.useCallback)(function(e,t){t&&(t.key===lI?o(cI(cI({},r),{maskType:Ih.FromMaskLayer})):t.key===dI?o(cI(cI({},r),{maskType:Ih.RectangleMask,rectUvToImageUv:[1,0,0,0,1,0]})):t.key===uI&&o(cI(cI({},r),{maskType:Ih.PillShapedMask,radius:1,rectUvToImageUv:[1,0,0,0,1,0]})))},[o,r]);return c.a.createElement(tt,{styles:i,size:t,header:n,footer:a},c.a.createElement(DD,{label:"Mask type",text:l,options:fI,onChange:u}),r.maskType===Ih.PillShapedMask&&c.a.createElement(ht,{label:"Radius",min:1,max:50,step:1,value:r.radius,showValue:!0,snapToStep:!0,onChange:function(e){o(cI(cI({},r),{radius:e}))}}))}),mI={setAlgorithmParameters:T5},_I=Object(ee.connect)(function(e){return{algorithmParameters:e.inPaintingUi.algorithmParameters}},mI)(pI),hI=Object(s.memo)(function(e){var t=e.size,n=e.header,a=e.footer,i=e.styles,r=e.requestTexturePatch,o=e.algorithmParameters,s=e.selectedUvPositions,d=e.clearSelectedUvPositions,l=e.imageUvToView,f=e.imageSizeInPixels,p=function(e){return(e.algorithmType===_h.dallE2||e.algorithmType===_h.stableDiffusion)&&""===e.prompt}(o),m=E5(o.maskType)({selectedUvPositions:s,algorithmParameters:o,imageUvToView:l,imageSizeInPixels:f});return c.a.createElement(tt,{styles:i,size:t,header:n,footer:a},c.a.createElement(u.DefaultButton,{text:"Go",disabled:p||!m,onClick:function(){m&&r(m),d()}}))}),bI={requestTexturePatch:de,clearSelectedUvPositions:F5},gI=Object(ee.connect)(function(e){var t=wm(e),n=e.inPaintingUi;return{algorithmParameters:n.algorithmParameters,selectedUvPositions:n.selectedUvPositions,imageUvToView:t,imageSizeInPixels:e.transformTools.image.originalPixelSize}},bI)(hI);Object($e.loadStyles)([{rawString:".sectionHeader_5d3ac010{font-size:16px;font-weight:500;line-height:42px;margin:25px 15px 6px}"}]);var vI=Object(s.memo)(function(e){var t=e.styles,n=e.disclaimerHasShown,a=e.setDisclaimerHasShown;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"sectionHeader_5d3ac010"},"Photo In-painting"),!n&&c.a.createElement(tt,{styles:t},c.a.createElement(u.TextField,{label:"",multiline:!0,rows:10,disabled:!0,defaultValue:"Photo in-painting is an experimental feature.  Current limitations of the underlying AI models may produce biased, offensive, or unsatisfactory results. Click below to acknowledge that you understand these limitations to proceed to using this experimental feature."}),c.a.createElement(Q5,null),c.a.createElement(u.DefaultButton,{text:"I understand",onClick:function(){a(!0)}})),n&&c.a.createElement(c.a.Fragment,null,c.a.createElement(_I,{styles:t}),c.a.createElement(Q5,null),c.a.createElement(sI,{styles:t}),c.a.createElement(Q5,null),c.a.createElement(gI,{styles:t})))}),yI={setDisclaimerHasShown:R5},SI=Object(ee.connect)(function(e){return{disclaimerHasShown:e.inPaintingUi.disclaimerHasShown}},yI)(vI),DI="PillShapeShader",II="uEnabled@",xI="uAspectRatio@",CI=function(){function e(){this._enabled=!0,this._aspectRatio=1}return e.prototype.setEnabled=function(e){this._enabled=e},e.prototype.setAspectRatio=function(e){this._aspectRatio=e},e.prototype.getName=function(){return DI},e.prototype.getUniformNames=function(e){return[e(II),e(xI)]},e.prototype.getFunctions=function(e){return["\nfloat distanceToLineSegment(vec2 lineStart, vec2 lineEnd, vec2 position)\n{\n    float lineLength = distance(lineEnd, lineStart);\n    if(lineLength == 0.0) return distance(position, lineStart);\n    float t = dot(position - lineStart, lineEnd - lineStart) / (lineLength * lineLength);\n    t = clamp(t, 0., 1.);\n    vec2 nearestPositionOnLine = mix(lineStart,lineEnd,t);\n    return distance(position, nearestPositionOnLine);\n}\n"]},e.prototype.getHeaderCode=function(e){return e("\n        //".concat(DI," ---\n        uniform float ").concat(II,";\n        uniform float ").concat(xI,";\n        "))},e.prototype.getShaderFunctionBody=function(e){return e("\n      //".concat(DI," ---\n      if(").concat(II," > 0.){\n        float aspect = ").concat(xI,";\n        vec2 lineStart = vec2(0.5,0.5);\n        vec2 lineEnd = vec2(aspect-0.5,0.5);\n        vec2 pos = vec2(").concat(Rd,".x*aspect,").concat(Rd,".y);\n        finalAlphaMultiply = 1. - smoothstep(0.48,0.5,distanceToLineSegment(lineStart,lineEnd,pos)); //TODO: smoothing should be based on screen pixels size.\n      }  \n      "))},e.prototype.onBeforeBabylonRender=function(e,t){e.setFloat(t(II),this._enabled?1:0),e.setFloat(t(xI),this._aspectRatio)},e}(),OI=function(e){var t=e.aspectRatio,n=e.enabled,a=void 0===n||n,i=Object(s.useMemo)(function(){return new CI},[]);return Ul(i),i.setEnabled(a),i.setAspectRatio(t),wl(a),wl(t),null},wI=[.2,1,.2,1],EI=Object(s.memo)(function(e){var t=e.imageUvToView,n=e.selectedUvPositions,a=e.isVisible,i=e.imageSizeInPixels,r=e.radiusInImagePixels;if(!a)return null;var o=x5(n,r,i);return o?c.a.createElement(Ml,{key:"InPaintingRectangleSelection",transform:ci(t,o),color:wI,zIndex:2},c.a.createElement(OI,{aspectRatio:Ph(o,i)})):null}),AI=Object(ee.connect)(function(e){var t=wm(e),n=e.inPaintingUi,a=n.selectedUvPositions,i=n.algorithmParameters,r=i.maskType===Ih.PillShapedMask?i.radius:0;return{selectedUvPositions:a,imageUvToView:t,radiusInImagePixels:r,isVisible:r>0,imageSizeInPixels:e.transformTools.image.originalPixelSize}},{})(EI);Object($e.loadStyles)([{rawString:".container_0ff71ffc{position:absolute;left:50%;bottom:0;-webkit-transform:translate(-50%,0);transform:translate(-50%,0)}"}]);var LI=c.a.memo(function(e){var t=e.userFacingErrorMessages,n=e.removeUserFacingErrorMessage,a=$(),i=Object(u.getRTL)(a),r={root:{borderRadius:"8px",marginBottom:"16px"}},o=Object(s.useMemo)(function(){return i?{marginLeft:"8px"}:{marginRight:"8px"}},[i]);return c.a.createElement("div",{className:"container_0ff71ffc"},t.map(function(e,t){return c.a.createElement(u.MessageBar,{key:"error-".concat(t),messageBarType:u.MessageBarType.error,isMultiline:!0,styles:r,onDismiss:function(){return n(e.id)},dismissButtonAriaLabel:"Close"},c.a.createElement("b",{style:o},e.title),e.message)}))}),kI={removeUserFacingErrorMessage:js},MI=Object(ee.connect)(function(e){return{userFacingErrorMessages:e.uiState.userFacingErrorMessages}},kI)(LI);Object($e.loadStyles)([{rawString:".sectionHeader_23d63f10{font-size:16px;font-weight:500;line-height:42px;margin:25px 0 6px 0}.mainSection_23d63f10{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:8px}.eraserSection_23d63f10{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.textSection_23d63f10{-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:8px 16px}"}]);var PI="mainSection_23d63f10",TI={body:{display:"flex",flexDirection:"column"},container:{width:"100%"}},UI={display:"flex"};function FI(e){return{root:{border:"none",backgroundColor:e.semanticColors.primaryButtonTextDisabled,borderRadius:3,height:40},rootHovered:{backgroundColor:e.semanticColors.primaryButtonTextDisabled},textContainer:{flexGrow:"unset"},icon:{marginRight:32}}}var HI={addMarkupContent:K_},RI=Object(ee.connect)(function(e){return{imageViewTransform:wm(e)}},HI)(function(e){var t=e.addMarkupContent,n=e.imageViewTransform,a=Object(s.useContext)(Wb).localizationStrings,i=$();return c.a.createElement(u.DefaultButton,{ariaLabel:"",text:"Add text",styles:FI(i),iconProps:{iconName:"InsertTextBox"},onClick:function(){t({text:a.markup_textboxDefaultContent,contentType:R_.TextContent,invertedPhysicalImageTransformDuringContentSerialization:ei(n),initialPosition:{positionType:"CenteredOnCanvas"}})}})}),NI=function(){return NI=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},NI.apply(this,arguments)};function BI(e,t,n,a){var i,r,o=Object.keys(t);if(0===o.length)return null;var s=+o[0],c=t[+s].selectionStart,d=(null===(r=null===(i=null==e?void 0:e[s])||void 0===i?void 0:i[c])||void 0===r?void 0:r[n])||a,l=o.every(function(i){var r,o,l,u,f=t[+i],p=f.selectionStart,m=f.selectionEnd;p===m&&(d=(null===(o=null===(r=null==e?void 0:e[s])||void 0===r?void 0:r[c-1])||void 0===o?void 0:o[n])||a);for(var _=p;_<m;_++)if(((null===(u=null===(l=null==e?void 0:e[+i])||void 0===l?void 0:l[_])||void 0===u?void 0:u[n])||a)!==d)return!1;return!0});return l?d:null}var jI=function(e){return{root:{height:40,backgroundColor:e.semanticColors.primaryButtonTextDisabled,"&::after":{border:"none"}},container:{lineHeight:32},input:{backgroundColor:e.semanticColors.primaryButtonTextDisabled}}},VI=function(e){return{rootPressed:{backgroundColor:e.semanticColors.primaryButtonTextDisabled},rootHovered:{backgroundColor:e.semanticColors.primaryButtonTextDisabled}}},zI={root:{margin:0},container:{alignItems:"baseline"}},GI=function(){return GI=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},GI.apply(this,arguments)},KI=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},WI=[12,24,36,48,60,72,84];function qI(e){return{key:e,text:"".concat(e)}}var QI=function(e){var t=e.fontSize,n=void 0===t?48:t,a=e.onChange,i=e.disabled,r=e.text,o=$(),d=Object(s.useMemo)(function(){return WI.map(function(e){return qI(e)})},[]),l=Object(s.useState)(void 0),f=l[0],p=l[1],m=Object(s.useState)(d),_=m[0],h=m[1],b=Object(s.useRef)(null),g=Object(u.mergeStyles)(function(e){return{color:e.semanticColors.errorText,fontSize:e.fonts.small.fontSize}}(o)),v=Object(s.useCallback)(function(e,t){f||(p(void 0),(null==t?void 0:t.text)&&(null==a||a(+t.text)))},[a,f]),y=Object(s.useCallback)(function(e){e&&(Jp(+e)?p(+e<1||+e>1e3?"The number must be between ".concat(1," and ").concat(1e3,"."):void 0):p("This is not a valid number."))},[]);return Object(s.useEffect)(function(){var e=qI(n);if(!_.find(function(t){return t.key===e.key})){var t=GI(GI({},e),{styles:{root:{display:"none"}}});h(KI(KI([],d,!0),[t],!1))}},[n,_,h,d]),Object(s.useEffect)(function(){var e,t,n=null===(e=null==b?void 0:b.current)||void 0===e?void 0:e._autofill.current;function a(e){"Enter"===e.key&&v(void 0,qI(+((null==n?void 0:n.value)||48)))}return null===(t=null==n?void 0:n.inputElement)||void 0===t||t.addEventListener("keydown",a),function(){var e;null===(e=null==n?void 0:n.inputElement)||void 0===e||e.removeEventListener("keydown",a)}},[b,v,n]),c.a.createElement(c.a.Fragment,null,c.a.createElement(v9,{label:"Size",iconName:"FontSize"}),c.a.createElement(DD,{styles:jI(o),disabled:i,allowFreeform:!0,autoComplete:"off",selectedKey:n,options:_,caretDownButtonStyles:VI(o),dropdownWidth:100,onChange:v,componentRef:b,onInputValueChange:y,text:i?"":r}),f&&c.a.createElement("div",{className:g},f))},YI=Object(A.classNamesFunction)(),JI=s.forwardRef(function(e,t){var n=e.as,a=void 0===n?"div":n,i=e.ariaLabel,r=e.checked,c=e.className,d=e.defaultChecked,l=void 0!==d&&d,u=e.disabled,f=e.inlineLabel,p=e.label,m=e.offAriaLabel,_=e.offText,h=e.onAriaLabel,b=e.onChange,g=e.onChanged,v=e.onClick,y=e.onText,S=e.role,D=e.styles,I=e.theme,x=ct(r,l,s.useCallback(function(e,t){null==b||b(e,t),null==g||g(t)},[b,g])),C=x[0],O=x[1],w=YI(D,{theme:I,className:c,disabled:u,checked:C,inlineLabel:f,onOffMissing:!y&&!_}),E=C?h:m,L=dt("Toggle",e.id),k="".concat(L,"-label"),M="".concat(L,"-stateText"),P=C?y:_,T=Object(A.getNativeProps)(e,A.inputProperties,["defaultChecked"]),U=void 0;i||E||(p&&(U=k),P&&!U&&(U=M));var F=s.useRef(null);Object(A.useFocusRects)(F),XI(e,C,F);var H={root:{className:w.root,hidden:T.hidden},label:{children:p,className:w.label,htmlFor:L,id:k},container:{className:w.container},pill:Object(o.__assign)(Object(o.__assign)({},T),{"aria-disabled":u,"aria-checked":C,"aria-label":i||E,"aria-labelledby":U,className:w.pill,"data-is-focusable":!0,"data-ktp-target":!0,disabled:u,id:L,onClick:function(e){u||(O(!C,e),v&&v(e))},ref:F,role:S||"switch",type:"button"}),thumb:{className:w.thumb},stateText:{children:P,className:w.text,htmlFor:L,id:M}};return s.createElement(a,Object(o.__assign)({ref:t},H.root),p&&s.createElement(rt,Object(o.__assign)({},H.label)),s.createElement("div",Object(o.__assign)({},H.container),s.createElement("button",Object(o.__assign)({},H.pill),s.createElement("span",Object(o.__assign)({},H.thumb))),(C&&y||_)&&s.createElement(rt,Object(o.__assign)({},H.stateText))))});JI.displayName="ToggleBase";var XI=function(e,t,n){s.useImperativeHandle(e.componentRef,function(){return{get checked(){return!!t},focus:function(){n.current&&n.current.focus()}}},[t,n])},ZI=Object(A.styled)(JI,function(e){var t,n,a,i,r,s,c,d=e.theme,l=e.className,u=e.disabled,f=e.checked,p=e.inlineLabel,m=e.onOffMissing,_=d.semanticColors,h=d.palette,b=_.bodyBackground,g=_.inputBackgroundChecked,v=_.inputBackgroundCheckedHovered,y=h.neutralDark,S=_.disabledBodySubtext,D=_.smallInputBorder,I=_.inputForegroundChecked,x=_.disabledBodySubtext,C=_.disabledBackground,O=_.smallInputBorder,w=_.inputBorderHovered,E=_.disabledBodySubtext,A=_.disabledText;return{root:["ms-Toggle",f&&"is-checked",!u&&"is-enabled",u&&"is-disabled",d.fonts.medium,{marginBottom:"8px"},p&&{display:"flex",alignItems:"center"},l],label:["ms-Toggle-label",{display:"inline-block"},u&&{color:A,selectors:(t={},t[mt.HighContrastSelector]={color:"GrayText"},t)},p&&!m&&{marginRight:16},m&&p&&{order:1,marginLeft:16},p&&{wordBreak:"break-word"}],container:["ms-Toggle-innerContainer",{display:"flex",position:"relative"}],pill:["ms-Toggle-background",Object(mt.getFocusStyle)(d,{inset:-3}),{fontSize:"20px",boxSizing:"border-box",width:40,height:20,borderRadius:10,transition:"all 0.1s ease",border:"1px solid ".concat(O),background:b,cursor:"pointer",display:"flex",alignItems:"center",padding:"0 3px",overflow:"visible"},!u&&[!f&&{selectors:{":hover":[{borderColor:w}],":hover .ms-Toggle-thumb":[{backgroundColor:y,selectors:(n={},n[mt.HighContrastSelector]={borderColor:"Highlight"},n)}]}},f&&[{background:g,borderColor:"transparent",justifyContent:"flex-end"},{selectors:(a={":hover":[{backgroundColor:v,borderColor:"transparent",selectors:(i={},i[mt.HighContrastSelector]={backgroundColor:"Highlight"},i)}]},a[mt.HighContrastSelector]=Object(o.__assign)({backgroundColor:"Highlight"},Object(mt.getHighContrastNoAdjustStyle)()),a)}]],u&&[{cursor:"default"},!f&&[{borderColor:E}],f&&[{backgroundColor:S,borderColor:"transparent",justifyContent:"flex-end"}]],!u&&{selectors:{"&:hover":{selectors:(r={},r[mt.HighContrastSelector]={borderColor:"Highlight"},r)}}}],thumb:["ms-Toggle-thumb",{display:"block",width:12,height:12,borderRadius:"50%",transition:"all 0.1s ease",backgroundColor:D,borderColor:"transparent",borderWidth:6,borderStyle:"solid",boxSizing:"border-box"},!u&&f&&[{backgroundColor:I,selectors:(s={},s[mt.HighContrastSelector]={backgroundColor:"Window",borderColor:"Window"},s)}],u&&[!f&&[{backgroundColor:x}],f&&[{backgroundColor:C}]]],text:["ms-Toggle-stateText",{selectors:{"&&":{padding:"0",margin:"0 8px",userSelect:"none",fontWeight:mt.FontWeights.regular}}},u&&{selectors:{"&&":{color:A,selectors:(c={},c[mt.HighContrastSelector]={color:"GrayText"},c)}}}]}},void 0,{scope:"Toggle"}),$I={root:{width:"100%"},focusedContainer:{marginLeft:"-6px"},tableCell:{padding:0}};function ex(e){return{padding:0,opacity:e?"0.3":"unset"}}var tx,nx=function(){return nx=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},nx.apply(this,arguments)},ax=function(e){var t=e.selectedId,n=e.disabled,a=$(),i=function(e){var i=e.id===t&&!n,r=$4(a),o=r.colorCellSVG,s=r.colorCellSVGCircle,d=r.colorCellSize,l=r.colorCellSVGRadius,f=r.colorCellSelected;return c.a.createElement("svg",{className:Object(u.mergeStyles)(o,i&&f),width:d,height:d,viewBox:"0 0 ".concat(d," ").concat(d),fill:e.color},c.a.createElement("circle",{className:Object(u.mergeStyles)(s),cx:"50%",cy:"50%",r:l}))};return c.a.createElement(X4,nx({},e,{onRenderColorCell:function(e,t){var a=null==t?void 0:t(e);return a?c.a.createElement(F4,nx({},a.props,{onRenderItem:i,className:Object(u.mergeStyles)(ex(n))})):null},styles:$I}))},ix=function(e){var t=e.onTextColorChange,n=e.onBackgroundColorChange,a=e.disabled,i=e.colors,r=e.textColorId,o=e.backgroundColorId,d=e.defaultBackgroundColorId,l=void 0!==o,u=Object(s.useMemo)(function(){var e;return null===(e=i.find(function(e){return e.id===d}))||void 0===e?void 0:e.color},[i,d]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(v9,{label:"Color",iconName:"CircleFill"}),c.a.createElement(ax,{disabled:a,selectedId:r,columnCount:8,colorCells:i,onChange:function(e,n,a){return t(a)}}),c.a.createElement(v9,{label:"Background color",iconName:"BackgroundColor"},c.a.createElement(ZI,{disabled:a,styles:zI,onText:"On",offText:"Off",checked:l,onChange:function(){n(l?"transparent":u)}})),l&&c.a.createElement(ax,{disabled:a,selectedId:o,columnCount:8,colorCells:i,onChange:function(e,t,a){return n(a)}}))},rx=function(){function e(){this._size=0}return e.prototype.updateOptions=function(e){for(var t=[],n=[],a=0,i=0;i<e.length;i++){var r=e[i],s=r.itemType,c=r.hidden;s===nD.Divider||s===nD.Header?(t.push(i),n.push(i)):c?n.push(i):a++}this._size=a,this._displayOnlyOptionsCache=t,this._notSelectableOptionsCache=n,this._cachedOptions=Object(o.__spreadArray)([],e,!0)},Object.defineProperty(e.prototype,"optionSetSize",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cachedOptions",{get:function(){return this._cachedOptions},enumerable:!1,configurable:!0}),e.prototype.positionInSet=function(e){if(void 0!==e){for(var t=0;e>this._notSelectableOptionsCache[t];)t++;if(this._displayOnlyOptionsCache[t]===e)throw new Error("Unexpected: Option at index ".concat(e," is not a selectable element."));if(this._notSelectableOptionsCache[t]!==e)return e-t+1}},e}();!function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(tx||(tx={}));var ox,sx=Object(u.classNamesFunction)();!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(ox||(ox={}));var cx,dx,lx,ux,fx,px=function(e){function t(t){var n=e.call(this,t)||this;n._panel=s.createRef(),n._animationCallback=null,n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent),n.dismiss=function(e){n.props.onDismiss&&n.isActive&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.close()},n._allowScrollOnPanel=function(e){e?n._allowTouchBodyScroll?Object(u.allowOverscrollOnElement)(e,n._events):Object(u.allowScrollOnElement)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,a=void 0===t?n._onRenderNavigationContent:t;return s.createElement("div",{className:n._classNames.navigation},a(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t,a=e.closeButtonAriaLabel,i=e.hasCloseButton,r=e.onRenderHeader,o=void 0===r?n._onRenderHeader:r;if(i){var c=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return s.createElement(s.Fragment,null,!n._hasCustomNavigation&&o(n.props,n._onRenderHeader,n._headerTextId),s.createElement(u.IconButton,{styles:c,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:a,title:a,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},n._onRenderHeader=function(e,t,a){var i=e.headerText,r=e.headerTextProps,c=void 0===r?{}:r;return i?s.createElement("div",{className:n._classNames.header},s.createElement("div",Object(o.__assign)({id:a,role:"heading","aria-level":1},c,{className:Object(u.css)(n._classNames.headerText,c.className)}),i)):null},n._onRenderBody=function(e){return s.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,a=void 0===t?null:t;return a?s.createElement("div",{className:n._classNames.footer},s.createElement("div",{className:n._classNames.footerInner},a())):null},n._animateTo=function(e){e===ox.open&&n.props.onOpen&&n.props.onOpen(),n._animationCallback=n._async.setTimeout(function(){n.setState({visibility:e}),n._onTransitionComplete(e)},200)},n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(e){n._updateFooterPosition(),e===ox.open&&n.props.onOpened&&n.props.onOpened(),e===ox.closed&&n.props.onDismissed&&n.props.onDismissed()};var a=n.props.allowTouchBodyScroll,i=void 0!==a&&a;return n._allowTouchBodyScroll=i,Object(u.initializeComponentRef)(n),Object(u.warnDeprecations)("Panel",t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n.state={isFooterSticky:!1,visibility:ox.closed,id:Object(u.getId)("Panel")},n}return Object(o.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==ox.closed&&t.visibility!==ox.animatingClosed?e.isOpen||t.visibility!==ox.open&&t.visibility!==ox.animatingOpen?null:{visibility:ox.animatingClosed}:{visibility:ox.animatingOpen}},t.prototype.componentDidMount=function(){this._async=new u.Async(this),this._events=new u.EventGroup(this),this._events.on(window,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:ox.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),a=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===ox.animatingOpen?this._animateTo(ox.open):this.state.visibility===ox.animatingClosed&&this._animateTo(ox.closed)),n&&!a?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!n&&a&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,a=e.elementToFocusOnDismiss,i=e.firstFocusableSelector,r=e.focusTrapZoneProps,c=e.forceFocusInsideTrap,d=e.hasCloseButton,l=e.headerText,f=e.headerClassName,p=void 0===f?"":f,m=e.ignoreExternalFocusing,_=e.isBlocking,h=e.isFooterAtBottom,b=e.isLightDismiss,g=e.isHiddenOnDismiss,v=e.layerProps,y=e.overlayProps,S=e.popupProps,D=e.type,I=e.styles,x=e.theme,C=e.customWidth,O=e.onLightDismissClick,w=void 0===O?this._onPanelClick:O,E=e.onRenderNavigation,A=void 0===E?this._onRenderNavigation:E,L=e.onRenderHeader,k=void 0===L?this._onRenderHeader:L,M=e.onRenderBody,P=void 0===M?this._onRenderBody:M,T=e.onRenderFooter,U=void 0===T?this._onRenderFooter:T,F=this.state,H=F.isFooterSticky,R=F.visibility,N=F.id,B=D===tx.smallFixedNear||D===tx.customNear,j=Object(u.getRTL)(x)?B:!B,V=D===tx.custom||D===tx.customNear?{width:C}:{},z=Object(u.getNativeProps)(this.props,u.divProperties),G=this.isActive,K=R===ox.animatingClosed||R===ox.animatingOpen;if(this._headerTextId=l&&N+"-headerText",!G&&!K&&!g)return null;this._classNames=sx(I,{theme:x,className:n,focusTrapZoneClassName:r?r.className:void 0,hasCloseButton:d,headerClassName:p,isAnimating:K,isFooterSticky:H,isFooterAtBottom:h,isOnRightSide:j,isOpen:G,isHiddenOnDismiss:g,type:D,hasCustomNavigation:this._hasCustomNavigation});var W,q=this._classNames,Q=this._allowTouchBodyScroll;return _&&G&&(W=s.createElement(u.Overlay,Object(o.__assign)({className:q.overlay,isDarkThemed:!1,onClick:b?w:void 0,allowTouchBodyScroll:Q},y))),s.createElement(hg,Object(o.__assign)({},v),s.createElement(bg.Popup,Object(o.__assign)({role:"dialog","aria-modal":_?"true":void 0,ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:q.hiddenPanel,enableAriaHiddenSiblings:!!G},S),s.createElement("div",Object(o.__assign)({"aria-hidden":!G&&K},z,{ref:this._panel,className:q.root}),W,s.createElement(u.FocusTrapZone,Object(o.__assign)({ignoreExternalFocusing:m,forceFocusInsideTrap:!(!_||g&&!G)&&c,firstFocusableSelector:i,isClickableOutsideFocusTrap:!0},r,{className:q.main,style:V,elementToFocusOnDismiss:a}),s.createElement("div",{className:q.contentInner},s.createElement("div",{ref:this._allowScrollOnPanel,className:q.scrollableContent,"data-is-scrollable":!0},s.createElement("div",{className:q.commands,"data-is-visible":!0},A(this.props,this._onRenderNavigation)),(this._hasCustomNavigation||!d)&&k(this.props,this._onRenderHeader,this._headerTextId),P(this.props,this._onRenderBody),U(this.props,this._onRenderFooter)))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:ox.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:ox.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===ox.open||this.state.visibility===ox.animatingOpen},enumerable:!1,configurable:!0}),t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&(Object(u.elementContains)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:tx.smallFixedFar},t}(s.Component),mx={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},_x="auto",hx=((cx={})["@media (min-width: ".concat(u.ScreenWidthMinMedium,"px)")]={width:340},cx),bx=((dx={})["@media (min-width: ".concat(u.ScreenWidthMinLarge,"px)")]={width:592},dx["@media (min-width: ".concat(u.ScreenWidthMinXLarge,"px)")]={width:644},dx),gx=((lx={})["@media (min-width: ".concat(u.ScreenWidthMinUhfMobile,"px)")]={left:48,width:"auto"},lx["@media (min-width: ".concat(u.ScreenWidthMinXXLarge,"px)")]={left:428},lx),vx=((ux={})["@media (min-width: ".concat(u.ScreenWidthMinXXLarge,"px)")]={left:_x,width:940},ux),yx=((fx={})["@media (min-width: ".concat(u.ScreenWidthMinXXLarge,"px)")]={left:176},fx),Sx=function(e){var t;switch(e){case tx.smallFixedFar:t=Object(o.__assign)({},hx);break;case tx.medium:t=Object(o.__assign)(Object(o.__assign)({},hx),bx);break;case tx.large:t=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},hx),bx),gx);break;case tx.largeFixed:t=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},hx),bx),gx),vx);break;case tx.extraLarge:t=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},hx),bx),gx),yx)}return t},Dx={paddingLeft:"24px",paddingRight:"24px"},Ix=Object(u.styled)(px,function(e){var t,n,a,i,r=e.className,s=e.focusTrapZoneClassName,c=e.hasCloseButton,d=e.headerClassName,l=e.isAnimating,f=e.isFooterSticky,p=e.isFooterAtBottom,m=e.isOnRightSide,_=e.isOpen,h=e.isHiddenOnDismiss,b=e.hasCustomNavigation,g=e.theme,v=e.type,y=void 0===v?tx.smallFixedFar:v,S=g.effects,D=g.fonts,I=g.semanticColors,x=Object(u.getGlobalClassNames)(mx,g),C=y===tx.custom||y===tx.customNear;return{root:[x.root,g.fonts.medium,_&&x.isOpen,c&&x.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},C&&m&&x.custom,C&&!m&&x.customNear,r],overlay:[{pointerEvents:"auto",cursor:"pointer"},_&&l&&u.AnimationClassNames.fadeIn100,!_&&l&&u.AnimationClassNames.fadeOut100],hiddenPanel:[!_&&!l&&h&&{visibility:"hidden"}],main:[x.main,{backgroundColor:I.bodyBackground,boxShadow:S.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:_x,right:0,width:"100%",selectors:Object(o.__assign)((t={},t[u.HighContrastSelector]={borderLeft:"3px solid ".concat(I.variantBorder),borderRight:"3px solid ".concat(I.variantBorder)},t),Sx(y))},y===tx.smallFluid&&{left:0},y===tx.smallFixedNear&&{left:0,right:_x,width:272},y===tx.customNear&&{right:"auto",left:0},C&&{maxWidth:"100vw"},_&&l&&!m&&u.AnimationClassNames.slideRightIn40,_&&l&&m&&u.AnimationClassNames.slideLeftIn40,!_&&l&&!m&&u.AnimationClassNames.slideLeftOut40,!_&&l&&m&&u.AnimationClassNames.slideRightOut40,s],commands:[x.commands,{backgroundColor:I.bodyBackground,paddingTop:18,selectors:(n={},n["@media (min-height: ".concat(u.ScreenWidthMinMedium,"px)")]={position:"sticky",top:0,zIndex:1},n)},b&&{paddingTop:"inherit"}],navigation:[x.navigation,{display:"flex",justifyContent:"flex-end"},b&&{height:"44px"}],contentInner:[x.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[x.header,Dx,{alignSelf:"flex-start"},c&&!b&&{flexGrow:1},b&&{flexShrink:0}],headerText:[x.headerText,D.xLarge,{color:I.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},d],scrollableContent:[x.scrollableContent,{overflowY:"auto"},p&&{flexGrow:1,display:"inherit",flexDirection:"inherit"}],content:[x.content,Dx,{paddingBottom:20},p&&{selectors:(a={},a["@media (min-height: ".concat(u.ScreenWidthMinMedium,"px)")]={flexGrow:1},a)}],footer:[x.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity ".concat(u.AnimationVariables.durationValue3," ").concat(u.AnimationVariables.easeFunction2),selectors:(i={},i["@media (min-height: ".concat(u.ScreenWidthMinMedium,"px)")]={position:"sticky",bottom:0},i)},f&&{backgroundColor:I.bodyBackground,borderTopColor:I.variantBorder}],footerInner:[x.footerInner,Dx,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[x.closeButton,{marginRight:14,color:g.palette.neutralSecondary,fontSize:u.IconFontSizes.large},b&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:g.palette.neutralPrimary}}}}},void 0,{scope:"Panel"});function xx(e){var t=Object(s.useRef)();return Object(s.useEffect)(function(){t.current=e}),t.current}var Cx=Object(u.classNamesFunction)(),Ox={options:[]},wx=s.forwardRef(function(e,t){var n=Object(A.getPropsWithDefaults)(Ox,e),a=s.useRef(null),i=lg(t,a),r=Object(gg.useResponsiveMode)(a,n.responsiveMode),c=function(e){var t,n=e.defaultSelectedKeys,a=e.selectedKeys,i=e.defaultSelectedKey,r=e.selectedKey,o=e.options,c=e.multiSelect,d=xx(o),l=s.useState([]),f=l[0],p=l[1],m=o!==d,_=xx(t=c?m&&void 0!==n?n:a:m&&void 0!==i?i:r);return s.useEffect(function(){var e=function(e){return Object(u.findIndex)(o,function(t){return null!=e?t.key===e:!!t.selected||!!t.isSelected})};void 0===t&&d||t===_&&!m||p(function(){if(void 0===t)return c?o.map(function(e,t){return e.selected?t:-1}).filter(function(e){return-1!==e}):-1!==(r=e(null))?[r]:[];if(!Array.isArray(t))return-1!==(r=e(t))?[r]:[];for(var n=[],a=0,i=t;a<i.length;a++){var r,s=i[a];-1!==(r=e(s))&&n.push(r)}return n}())},[m,c,d,_,o,t]),[f,p]}(n),d=c[0],l=c[1];return s.createElement(Tx,Object(o.__assign)({},n,{responsiveMode:r,hoisted:{rootRef:i,selectedIndices:d,setSelectedIndices:l}}))});wx.displayName="DropdownBase";var Ex,Ax,Lx,kx,Mx,Px,Tx=function(e){function t(t){var n=e.call(this,t)||this;n._host=s.createRef(),n._focusZone=s.createRef(),n._dropDown=s.createRef(),n._scrollIdleDelay=250,n._sizePosCache=new rx,n._requestAnimationFrame=Object(u.safeRequestAnimationFrame)(n),n.dismissMenu=function(){n.state.isOpen&&n.setState({isOpen:!1})},n._onChange=function(e,t,a,i,r){var s=n.props,c=s.onChange,d=s.onChanged;if(c||d){var l=r?Object(o.__assign)(Object(o.__assign)({},t[a]),{selected:!i}):t[a];c&&c(Object(o.__assign)(Object(o.__assign)({},e),{target:n._dropDown.current}),l,a),d&&d(l,a)}},n._getPlaceholder=function(){return n.props.placeholder||n.props.placeHolder},n._getTitle=function(e,t){var a=n.props.multiSelectDelimiter,i=void 0===a?", ":a;return e.map(function(e){return e.text}).join(i)},n._onRenderTitle=function(e){return s.createElement(s.Fragment,null,n._getTitle(e))},n._onRenderPlaceholder=function(e){return n._getPlaceholder()?s.createElement(s.Fragment,null,n._getPlaceholder()):null},n._onRenderContainer=function(e){var t=e.calloutProps,a=e.panelProps,i=n.props,r=i.responsiveMode,c=i.dropdownWidth,d=r<=gg.ResponsiveMode.medium,l={firstFocusableTarget:"#".concat(n._listId,"1")},f=n._classNames.subComponentStyles?n._classNames.subComponentStyles.panel:void 0,p=void 0,m=void 0;return"auto"===c?m=n._dropDown.current?n._dropDown.current.clientWidth:0:p=c||(n._dropDown.current?n._dropDown.current.clientWidth:0),d?s.createElement(Ix,Object(o.__assign)({closeButtonAriaLabel:"Close",focusTrapZoneProps:l,hasCloseButton:!0,isOpen:!0,isLightDismiss:!0,onDismiss:n._onDismiss,styles:f},a),n._renderFocusableList(e)):s.createElement(u.Callout,Object(o.__assign)({isBeakVisible:!1,gapSpace:0,doNotLayer:!1,directionalHintFixed:!1,directionalHint:u.DirectionalHint.bottomLeftEdge,calloutWidth:p,calloutMinWidth:m},t,{className:n._classNames.callout,target:n._dropDown.current,onDismiss:n._onDismiss,onScroll:n._onScroll,onPositioned:n._onPositioned}),n._renderFocusableList(e))},n._onRenderCaretDown=function(e){return s.createElement($t.Icon,{className:n._classNames.caretDown,iconName:"ChevronDown","aria-hidden":!0})},n._onRenderList=function(e){var t=e.onRenderItem,a=void 0===t?n._onRenderItem:t,i={items:[]},r=[],c=function(){var e=i.id?[s.createElement("div",{role:"group",key:i.id,"aria-labelledby":i.id},i.items)]:i.items;r=Object(o.__spreadArray)(Object(o.__spreadArray)([],r,!0),e,!0),i={items:[]}};return e.options.forEach(function(e,t){!function(e,t){switch(e.itemType){case nD.Header:i.items.length>0&&c();var r=n._id+e.key;i.items.push(a(Object(o.__assign)(Object(o.__assign)({id:r},e),{index:t}),n._onRenderItem)),i.id=r;break;case nD.Divider:t>0&&i.items.push(a(Object(o.__assign)(Object(o.__assign)({},e),{index:t}),n._onRenderItem)),i.items.length>0&&c();break;default:i.items.push(a(Object(o.__assign)(Object(o.__assign)({},e),{index:t}),n._onRenderItem))}}(e,t)}),i.items.length>0&&c(),s.createElement(s.Fragment,null,r)},n._onRenderItem=function(e){switch(e.itemType){case nD.Divider:return n._renderSeparator(e);case nD.Header:return n._renderHeader(e);default:return n._renderOption(e)}},n._renderOption=function(e){var t,a=n.props,i=a.onRenderOption,r=void 0===i?n._onRenderOption:i,c=a.hoisted.selectedIndices,d=void 0===c?[]:c,l=!(void 0===e.index||!d)&&d.indexOf(e.index)>-1,f=e.hidden?n._classNames.dropdownItemHidden:l&&!0===e.disabled?n._classNames.dropdownItemSelectedAndDisabled:l?n._classNames.dropdownItemSelected:!0===e.disabled?n._classNames.dropdownItemDisabled:n._classNames.dropdownItem,p=e.title,m=n._listId+e.index,_=null!==(t=e.id)&&void 0!==t?t:m+"-label",h=n._classNames.subComponentStyles?n._classNames.subComponentStyles.multiSelectItem:void 0;return n.props.multiSelect?s.createElement(dD,{id:m,key:e.key,disabled:e.disabled,onChange:n._onItemClick(e),inputProps:Object(o.__assign)({"aria-selected":l,onMouseEnter:n._onItemMouseEnter.bind(n,e),onMouseLeave:n._onMouseItemLeave.bind(n,e),onMouseMove:n._onItemMouseMove.bind(n,e),role:"option"},{"data-index":e.index,"data-is-focusable":!(e.disabled||e.hidden)}),label:e.text,title:p,onRenderLabel:n._onRenderItemLabel.bind(n,Object(o.__assign)(Object(o.__assign)({},e),{id:_})),className:Object(u.css)(f,"is-multi-select"),checked:l,styles:h,ariaPositionInSet:e.hidden?void 0:n._sizePosCache.positionInSet(e.index),ariaSetSize:e.hidden?void 0:n._sizePosCache.optionSetSize,ariaLabel:e.ariaLabel,ariaLabelledBy:e.ariaLabel?void 0:_}):s.createElement(u.CommandButton,{id:m,key:e.key,"data-index":e.index,"data-is-focusable":!e.disabled,disabled:e.disabled,className:f,onClick:n._onItemClick(e),onMouseEnter:n._onItemMouseEnter.bind(n,e),onMouseLeave:n._onMouseItemLeave.bind(n,e),onMouseMove:n._onItemMouseMove.bind(n,e),role:"option","aria-selected":l?"true":"false",ariaLabel:e.ariaLabel,title:p,"aria-posinset":n._sizePosCache.positionInSet(e.index),"aria-setsize":n._sizePosCache.optionSetSize},r(e,n._onRenderOption))},n._onRenderOption=function(e){return s.createElement("span",{className:n._classNames.dropdownOptionText},e.text)},n._onRenderMultiselectOption=function(e){return s.createElement("span",{id:e.id,"aria-hidden":"true",className:n._classNames.dropdownOptionText},e.text)},n._onRenderItemLabel=function(e){var t=n.props.onRenderOption;return(void 0===t?n._onRenderMultiselectOption:t)(e,n._onRenderMultiselectOption)},n._onPositioned=function(e){n._focusZone.current&&n._requestAnimationFrame(function(){var e=n.props.hoisted.selectedIndices;if(n._focusZone.current)if(!n._hasBeenPositioned&&e&&e[0]&&!n.props.options[e[0]].disabled){var t=Object(u.getDocument)().getElementById("".concat(n._id,"-list").concat(e[0]));t&&n._focusZone.current.focusElement(t),n._hasBeenPositioned=!0}else n._focusZone.current.focus()}),n.state.calloutRenderEdge&&n.state.calloutRenderEdge===e.targetEdge||n.setState({calloutRenderEdge:e.targetEdge})},n._onItemClick=function(e){return function(t){e.disabled||(n.setSelectedIndex(t,e.index),n.props.multiSelect||n.setState({isOpen:!1}))}},n._onScroll=function(){n._isScrollIdle||void 0===n._scrollIdleTimeoutId?n._isScrollIdle=!1:(clearTimeout(n._scrollIdleTimeoutId),n._scrollIdleTimeoutId=void 0),n._scrollIdleTimeoutId=window.setTimeout(function(){n._isScrollIdle=!0},n._scrollIdleDelay)},n._onMouseItemLeave=function(e,t){if(!n._shouldIgnoreMouseEvent()&&n._host.current)if(n._host.current.setActive)try{n._host.current.setActive()}catch(e){}else n._host.current.focus()},n._onDismiss=function(){n.setState({isOpen:!1})},n._onDropdownBlur=function(e){n._isDisabled()||n.state.isOpen||(n.setState({hasFocus:!1}),n.props.onBlur&&n.props.onBlur(e))},n._onDropdownKeyDown=function(e){if(!n._isDisabled()&&(n._lastKeyDownWasAltOrMeta=n._isAltOrMeta(e),!n.props.onKeyDown||(n.props.onKeyDown(e),!e.defaultPrevented))){var t,a=n.props.hoisted.selectedIndices.length?n.props.hoisted.selectedIndices[0]:-1,i=e.altKey||e.metaKey,r=n.state.isOpen;switch(e.which){case u.KeyCodes.enter:n.setState({isOpen:!r});break;case u.KeyCodes.escape:if(!r)return;n.setState({isOpen:!1});break;case u.KeyCodes.up:if(i){if(r){n.setState({isOpen:!1});break}return}n.props.multiSelect?n.setState({isOpen:!0}):n._isDisabled()||(t=n._moveIndex(e,-1,a-1,a));break;case u.KeyCodes.down:i&&(e.stopPropagation(),e.preventDefault()),i&&!r||n.props.multiSelect?n.setState({isOpen:!0}):n._isDisabled()||(t=n._moveIndex(e,1,a+1,a));break;case u.KeyCodes.home:n.props.multiSelect||(t=n._moveIndex(e,1,0,a));break;case u.KeyCodes.end:n.props.multiSelect||(t=n._moveIndex(e,-1,n.props.options.length-1,a));break;case u.KeyCodes.space:break;default:return}t!==a&&(e.stopPropagation(),e.preventDefault())}},n._onDropdownKeyUp=function(e){if(!n._isDisabled()){var t=n._shouldHandleKeyUp(e),a=n.state.isOpen;n.props.onKeyUp&&(n.props.onKeyUp(e),e.defaultPrevented)||(e.which===u.KeyCodes.space?(n.setState({isOpen:!a}),e.stopPropagation(),e.preventDefault()):t&&a&&n.setState({isOpen:!1}))}},n._onZoneKeyDown=function(e){var t,a,i;n._lastKeyDownWasAltOrMeta=n._isAltOrMeta(e);var r=e.altKey||e.metaKey;switch(e.which){case u.KeyCodes.up:r?n.setState({isOpen:!1}):n._host.current&&(i=Object(u.getLastFocusable)(n._host.current,n._host.current.lastChild,!0));break;case u.KeyCodes.home:case u.KeyCodes.end:case u.KeyCodes.pageUp:case u.KeyCodes.pageDown:break;case u.KeyCodes.down:!r&&n._host.current&&(i=Object(u.getFirstFocusable)(n._host.current,n._host.current.firstChild,!0));break;case u.KeyCodes.escape:n.setState({isOpen:!1});break;case u.KeyCodes.tab:n.setState({isOpen:!1});var o=Object(u.getDocument)();o&&(e.shiftKey?null===(t=Object(A.getPreviousElement)(o.body,n._dropDown.current,!1,!1,!0,!0))||void 0===t||t.focus():null===(a=Object(A.getNextElement)(o.body,n._dropDown.current,!1,!1,!0,!0))||void 0===a||a.focus());break;default:return}i&&i.focus(),e.stopPropagation(),e.preventDefault()},n._onZoneKeyUp=function(e){n._shouldHandleKeyUp(e)&&n.state.isOpen&&(n.setState({isOpen:!1}),e.preventDefault())},n._onDropdownClick=function(e){if(!n.props.onClick||(n.props.onClick(e),!e.defaultPrevented)){var t=n.state.isOpen;n._isDisabled()||n._shouldOpenOnFocus()||n.setState({isOpen:!t}),n._isFocusedByClick=!1}},n._onDropdownMouseDown=function(){n._isFocusedByClick=!0},n._onFocus=function(e){if(!n._isDisabled()){n.props.onFocus&&n.props.onFocus(e);var t={hasFocus:!0};n._shouldOpenOnFocus()&&(t.isOpen=!0),n.setState(t)}},n._isDisabled=function(){var e=n.props.disabled,t=n.props.isDisabled;return void 0===e&&(e=t),e},n._onRenderLabel=function(e){var t=e.label,a=e.required,i=e.disabled,r=n._classNames.subComponentStyles?n._classNames.subComponentStyles.label:void 0;return t?s.createElement(u.Label,{className:n._classNames.label,id:n._labelId,required:a,styles:r,disabled:i},t):null},Object(u.initializeComponentRef)(n),t.multiSelect,t.selectedKey,t.selectedKeys,t.defaultSelectedKey,t.defaultSelectedKeys;var a=t.options;return n._id=t.id||Object(u.getId)("Dropdown"),n._labelId=n._id+"-label",n._listId=n._id+"-list",n._optionId=n._id+"-option",n._isScrollIdle=!0,n._hasBeenPositioned=!1,n._sizePosCache.updateOptions(a),n.state={isOpen:!1,hasFocus:!1,calloutRenderEdge:void 0},n}return Object(o.__extends)(t,e),Object.defineProperty(t.prototype,"selectedOptions",{get:function(){var e=this.props;return gD(e.options,e.hoisted.selectedIndices)},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){clearTimeout(this._scrollIdleTimeoutId)},t.prototype.componentDidUpdate=function(e,t){!0===t.isOpen&&!1===this.state.isOpen&&(this._gotMouseMove=!1,this._hasBeenPositioned=!1,this.props.onDismiss&&this.props.onDismiss())},t.prototype.render=function(){var e=this._id,t=this.props,n=t.className,a=t.label,i=t.options,r=t.ariaLabel,c=t.required,d=t.errorMessage,l=t.styles,f=t.theme,p=t.panelProps,m=t.calloutProps,_=t.onRenderTitle,h=void 0===_?this._getTitle:_,b=t.onRenderContainer,g=void 0===b?this._onRenderContainer:b,v=t.onRenderCaretDown,y=void 0===v?this._onRenderCaretDown:v,S=t.onRenderLabel,D=void 0===S?this._onRenderLabel:S,I=t.onRenderItem,x=void 0===I?this._onRenderItem:I,C=t.hoisted.selectedIndices,O=this.state,w=O.isOpen,E=O.calloutRenderEdge,A=O.hasFocus,L=t.onRenderPlaceholder||t.onRenderPlaceHolder||this._getPlaceholder;i!==this._sizePosCache.cachedOptions&&this._sizePosCache.updateOptions(i);var k=gD(i,C),M=Object(u.getNativeProps)(t,u.divProperties),P=this._isDisabled(),T=e+"-errorMessage";this._classNames=Cx(l,{theme:f,className:n,hasError:!!(d&&d.length>0),hasLabel:!!a,isOpen:w,required:c,disabled:P,isRenderingPlaceholder:!k.length,panelClassName:p?p.className:void 0,calloutClassName:m?m.className:void 0,calloutRenderEdge:E});var U=!!d&&d.length>0;return s.createElement("div",{className:this._classNames.root,ref:this.props.hoisted.rootRef,"aria-owns":w?this._listId:void 0},D(this.props,this._onRenderLabel),s.createElement("div",Object(o.__assign)({"data-is-focusable":!P,"data-ktp-target":!0,ref:this._dropDown,id:e,tabIndex:P?-1:0,role:"combobox","aria-haspopup":"listbox","aria-expanded":w?"true":"false","aria-label":r,"aria-labelledby":a&&!r?Object(u.mergeAriaAttributeValues)(this._labelId,this._optionId):void 0,"aria-describedby":U?this._id+"-errorMessage":void 0,"aria-required":c,"aria-disabled":P,"aria-controls":w?this._listId:void 0},M,{className:this._classNames.dropdown,onBlur:this._onDropdownBlur,onKeyDown:this._onDropdownKeyDown,onKeyUp:this._onDropdownKeyUp,onClick:this._onDropdownClick,onMouseDown:this._onDropdownMouseDown,onFocus:this._onFocus}),s.createElement("span",{id:this._optionId,className:this._classNames.title,"aria-live":A?"polite":void 0,"aria-atomic":!!A||void 0,"aria-invalid":U},k.length?h(k,this._onRenderTitle):L(t,this._onRenderPlaceholder)),s.createElement("span",{className:this._classNames.caretDownWrapper},y(t,this._onRenderCaretDown))),w&&g(Object(o.__assign)(Object(o.__assign)({},t),{onDismiss:this._onDismiss,onRenderItem:x}),this._onRenderContainer),U&&s.createElement("div",{role:"alert",id:T,className:this._classNames.errorMessage},d))},t.prototype.focus=function(e){this._dropDown.current&&(this._dropDown.current.focus(),e&&this.setState({isOpen:!0}))},t.prototype.setSelectedIndex=function(e,t){var n=this.props,a=n.options,i=n.selectedKey,r=n.selectedKeys,o=n.multiSelect,s=n.notifyOnReselect,c=n.hoisted.selectedIndices,d=void 0===c?[]:c,l=!!d&&d.indexOf(t)>-1,u=[];if(t=Math.max(0,Math.min(a.length-1,t)),void 0===i&&void 0===r){if(o||s||t!==d[0]){if(o)if(u=d?this._copyArray(d):[],l){var f=u.indexOf(t);f>-1&&u.splice(f,1)}else u.push(t);else u=[t];e.persist(),this.props.hoisted.setSelectedIndices(u),this._onChange(e,a,t,l,o)}}else this._onChange(e,a,t,l,o)},t.prototype._copyArray=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];t.push(i)}return t},t.prototype._moveIndex=function(e,t,n,a){var i=this.props.options;if(a===n||0===i.length)return a;n>=i.length?n=0:n<0&&(n=i.length-1);for(var r=0;i[n].itemType===nD.Header||i[n].itemType===nD.Divider||i[n].disabled;){if(r>=i.length)return a;n+t<0?n=i.length:n+t>=i.length&&(n=-1),n+=t,r++}return this.setSelectedIndex(e,n),n},t.prototype._renderFocusableList=function(e){var t=e.onRenderList,n=void 0===t?this._onRenderList:t,a=e.label,i=e.ariaLabel,r=e.multiSelect;return s.createElement("div",{className:this._classNames.dropdownItemsWrapper,onKeyDown:this._onZoneKeyDown,onKeyUp:this._onZoneKeyUp,ref:this._host,tabIndex:0},s.createElement(u.FocusZone,{ref:this._focusZone,direction:u.FocusZoneDirection.vertical,id:this._listId,className:this._classNames.dropdownItems,role:"listbox","aria-label":i,"aria-labelledby":a&&!i?this._labelId:void 0,"aria-multiselectable":r},n(e,this._onRenderList)))},t.prototype._renderSeparator=function(e){var t=e.index,n=e.key,a=e.hidden?this._classNames.dropdownDividerHidden:this._classNames.dropdownDivider;return t>0?s.createElement("div",{role:"presentation",key:n,className:a}):null},t.prototype._renderHeader=function(e){var t=this.props.onRenderOption,n=void 0===t?this._onRenderOption:t,a=e.key,i=e.id,r=e.hidden?this._classNames.dropdownItemHeaderHidden:this._classNames.dropdownItemHeader;return s.createElement("div",{id:i,key:a,className:r},n(e,this._onRenderOption))},t.prototype._onItemMouseEnter=function(e,t){this._shouldIgnoreMouseEvent()||t.currentTarget.focus()},t.prototype._onItemMouseMove=function(e,t){var n=t.currentTarget;this._gotMouseMove=!0,this._isScrollIdle&&document.activeElement!==n&&n.focus()},t.prototype._shouldIgnoreMouseEvent=function(){return!this._isScrollIdle||!this._gotMouseMove},t.prototype._isAltOrMeta=function(e){return e.which===u.KeyCodes.alt||"Meta"===e.key},t.prototype._shouldHandleKeyUp=function(e){var t=this._lastKeyDownWasAltOrMeta&&this._isAltOrMeta(e);return this._lastKeyDownWasAltOrMeta=!1,!!t&&!(Object(u.isMac)()||Object(u.isIOS)())},t.prototype._shouldOpenOnFocus=function(){var e=this.state.hasFocus,t=this.props.openOnKeyboardFocus;return!this._isFocusedByClick&&!0===t&&!e},t.defaultProps={options:[]},t}(s.Component);!function(e){e[e.top=1]="top",e[e.bottom=-1]="bottom",e[e.left=2]="left",e[e.right=-2]="right"}(Ex||(Ex={})),function(e){e[e.top=0]="top",e[e.bottom=1]="bottom",e[e.start=2]="start",e[e.end=3]="end"}(Ax||(Ax={}));var Ux={root:"ms-Dropdown-container",label:"ms-Dropdown-label",dropdown:"ms-Dropdown",title:"ms-Dropdown-title",caretDownWrapper:"ms-Dropdown-caretDownWrapper",caretDown:"ms-Dropdown-caretDown",callout:"ms-Dropdown-callout",panel:"ms-Dropdown-panel",dropdownItems:"ms-Dropdown-items",dropdownItem:"ms-Dropdown-item",dropdownDivider:"ms-Dropdown-divider",dropdownOptionText:"ms-Dropdown-optionText",dropdownItemHeader:"ms-Dropdown-header",titleIsPlaceHolder:"ms-Dropdown-titleIsPlaceHolder",titleHasError:"ms-Dropdown-title--hasError"},Fx=((Lx={})["".concat(u.HighContrastSelector,", ").concat(u.HighContrastSelectorWhite.replace("@media ",""))]=Object(o.__assign)({},Object(u.getHighContrastNoAdjustStyle)()),Lx),Hx={selectors:Object(o.__assign)((kx={},kx[u.HighContrastSelector]={backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},kx[".ms-Checkbox-checkbox"]=(Mx={},Mx[u.HighContrastSelector]={borderColor:"HighlightText"},Mx),kx),Fx)},Rx={selectors:(Px={},Px[u.HighContrastSelector]={borderColor:"Highlight"},Px)},Nx=Object(u.getScreenSelector)(0,u.ScreenWidthMinMedium),Bx=Object(u.styled)(wx,function(e){var t,n,a,i,r,s,c,d,l,f,p,m,_=e.theme,h=e.hasError,b=e.hasLabel,g=e.className,v=e.isOpen,y=e.disabled,S=e.required,D=e.isRenderingPlaceholder,I=e.panelClassName,x=e.calloutClassName,C=e.calloutRenderEdge;if(!_)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var O=Object(u.getGlobalClassNames)(Ux,_),w=_.palette,E=_.semanticColors,A=_.effects,L=_.fonts,k={color:E.menuItemTextHovered},M={color:E.menuItemText},P={borderColor:E.errorText},T=[O.dropdownItem,{backgroundColor:"transparent",boxSizing:"border-box",cursor:"pointer",display:"flex",alignItems:"center",padding:"0 8px",width:"100%",minHeight:36,lineHeight:20,height:0,position:"relative",border:"1px solid transparent",borderRadius:0,wordWrap:"break-word",overflowWrap:"break-word",textAlign:"left",".ms-Button-flexContainer":{width:"100%"}}],U=[O.dropdownItemHeader,Object(o.__assign)(Object(o.__assign)({},L.medium),{fontWeight:u.FontWeights.semibold,color:E.menuHeader,background:"none",backgroundColor:"transparent",border:"none",height:36,lineHeight:36,cursor:"default",padding:"0 8px",userSelect:"none",textAlign:"left",selectors:(t={},t[u.HighContrastSelector]=Object(o.__assign)({color:"GrayText"},Object(u.getHighContrastNoAdjustStyle)()),t)})],F=E.menuItemBackgroundPressed,H=function(e){var t,n;return void 0===e&&(e=!1),{selectors:(t={"&:hover":[{color:E.menuItemTextHovered,backgroundColor:e?F:E.menuItemBackgroundHovered},Hx],"&.is-multi-select:hover":[{backgroundColor:e?F:"transparent"},Hx],"&:active:hover":[{color:E.menuItemTextHovered,backgroundColor:e?E.menuItemBackgroundHovered:E.menuItemBackgroundPressed},Hx]},t[".".concat(u.IsFocusVisibleClassName," &:focus:after")]=(n={left:0,top:0,bottom:0,right:0},n[u.HighContrastSelector]={inset:"2px"},n),t[u.HighContrastSelector]={border:"none"},t)}},R=Object(o.__spreadArray)(Object(o.__spreadArray)([],T,!0),[{backgroundColor:F,color:E.menuItemTextHovered},H(!0),Hx],!1),N=Object(o.__spreadArray)(Object(o.__spreadArray)([],T,!0),[{color:E.disabledText,cursor:"default",selectors:(n={},n[u.HighContrastSelector]={color:"GrayText",border:"none"},n)}],!1),B=C===Ex.bottom?"".concat(A.roundedCorner2," ").concat(A.roundedCorner2," 0 0"):"0 0 ".concat(A.roundedCorner2," ").concat(A.roundedCorner2),j=C===Ex.bottom?"0 0 ".concat(A.roundedCorner2," ").concat(A.roundedCorner2):"".concat(A.roundedCorner2," ").concat(A.roundedCorner2," 0 0");return{root:[O.root,g],label:O.label,dropdown:[O.dropdown,u.normalize,L.medium,{color:E.menuItemText,borderColor:E.focusBorder,position:"relative",outline:0,userSelect:"none",selectors:(a={},a["&:hover ."+O.title]=[!y&&k,{borderColor:v?w.neutralSecondary:w.neutralPrimary},Rx],a["&:focus ."+O.title]=[!y&&k,{selectors:(i={},i[u.HighContrastSelector]={color:"Highlight"},i)}],a["&:focus:after"]=[{pointerEvents:"none",content:"''",position:"absolute",boxSizing:"border-box",top:"0px",left:"0px",width:"100%",height:"100%",border:y?"none":"2px solid ".concat(w.themePrimary),borderRadius:"2px",selectors:(r={},r[u.HighContrastSelector]={color:"Highlight"},r)}],a["&:active ."+O.title]=[!y&&k,{borderColor:w.themePrimary},Rx],a["&:hover ."+O.caretDown]=!y&&M,a["&:focus ."+O.caretDown]=[!y&&M,{selectors:(s={},s[u.HighContrastSelector]={color:"Highlight"},s)}],a["&:active ."+O.caretDown]=!y&&M,a["&:hover ."+O.titleIsPlaceHolder]=!y&&M,a["&:focus ."+O.titleIsPlaceHolder]=!y&&M,a["&:active ."+O.titleIsPlaceHolder]=!y&&M,a["&:hover ."+O.titleHasError]=P,a["&:active ."+O.titleHasError]=P,a)},v&&"is-open",y&&"is-disabled",S&&"is-required",S&&!b&&{selectors:(c={":before":{content:"'*'",color:E.errorText,position:"absolute",top:-5,right:-10}},c[u.HighContrastSelector]={selectors:{":after":{right:-14}}},c)}],title:[O.title,u.normalize,{backgroundColor:E.inputBackground,borderWidth:1,borderStyle:"solid",borderColor:E.inputBorder,borderRadius:v?B:A.roundedCorner2,cursor:"pointer",display:"block",height:32,lineHeight:30,padding:"0 28px 0 8px",position:"relative",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},D&&[O.titleIsPlaceHolder,{color:E.inputPlaceholderText}],h&&[O.titleHasError,P],y&&{backgroundColor:E.disabledBackground,border:"none",color:E.disabledText,cursor:"default",selectors:(d={},d[u.HighContrastSelector]=Object(o.__assign)({border:"1px solid GrayText",color:"GrayText",backgroundColor:"Window"},Object(u.getHighContrastNoAdjustStyle)()),d)}],caretDownWrapper:[O.caretDownWrapper,{height:32,lineHeight:30,paddingTop:1,position:"absolute",right:8,top:0},!y&&{cursor:"pointer"}],caretDown:[O.caretDown,{color:w.neutralSecondary,fontSize:L.small.fontSize,pointerEvents:"none"},y&&{color:E.disabledText,selectors:(l={},l[u.HighContrastSelector]=Object(o.__assign)({color:"GrayText"},Object(u.getHighContrastNoAdjustStyle)()),l)}],errorMessage:Object(o.__assign)(Object(o.__assign)({color:E.errorText},_.fonts.small),{paddingTop:5}),callout:[O.callout,{boxShadow:A.elevation8,borderRadius:j,selectors:(f={},f[".ms-Callout-main"]={borderRadius:j},f)},x],dropdownItemsWrapper:{selectors:{"&:focus":{outline:0}}},dropdownItems:[O.dropdownItems,{display:"block"}],dropdownItem:Object(o.__spreadArray)(Object(o.__spreadArray)([],T,!0),[H()],!1),dropdownItemSelected:R,dropdownItemDisabled:N,dropdownItemSelectedAndDisabled:[R,N,{backgroundColor:"transparent"}],dropdownItemHidden:Object(o.__spreadArray)(Object(o.__spreadArray)([],T,!0),[{display:"none"}],!1),dropdownDivider:[O.dropdownDivider,{height:1,backgroundColor:E.bodyDivider}],dropdownDividerHidden:[O.dropdownDivider,{display:"none"}],dropdownOptionText:[O.dropdownOptionText,{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",minWidth:0,maxWidth:"100%",wordWrap:"break-word",overflowWrap:"break-word",margin:"1px"}],dropdownItemHeader:U,dropdownItemHeaderHidden:Object(o.__spreadArray)(Object(o.__spreadArray)([],U,!0),[{display:"none"}],!1),subComponentStyles:{label:{root:{display:"inline-block"}},multiSelectItem:{root:{padding:0},label:{alignSelf:"stretch",padding:"0 8px",width:"100%"},input:{selectors:(p={},p[".".concat(u.IsFocusVisibleClassName," &:focus + label::before")]={outlineOffset:"0px"},p)}},panel:{root:[I],main:{selectors:(m={},m[Nx]={width:272},m)},contentInner:{padding:"0 0 20px"}}}}},void 0,{scope:"Dropdown"});function jx(e,t){return{title:{color:e.palette.neutralDark,lineHeight:40,height:40,border:"unset",backgroundColor:t?e.semanticColors.disabledBackground:e.semanticColors.primaryButtonTextDisabled},caretDownWrapper:{lineHeight:40,height:40}}}Bx.displayName="Dropdown";var Vx=function(){return Vx=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vx.apply(this,arguments)},zx=function(e){var t=$();return c.a.createElement(Bx,Vx({},e,{styles:jx(t,e.disabled)}))},Gx=function(){return Gx=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Gx.apply(this,arguments)},Kx={addMarkupContent:K_,updateTextContent:V_},Wx=Object(ee.connect)(function(e){return{activeTextContent:e.markup.markupContentItems.find(function(t){return t.id===e.markup.activeMarkupContentId&&t.contentType===R_.TextContent}),markupTextSelection:e.markup.markupTextSelection}},Kx)(function(e){var t=e.activeTextContent,n=e.updateTextContent,a=e.markupTextSelection;function i(e,a){var i;(null==t?void 0:t.drawingAttributes)&&n(Gx(Gx({},t),{drawingAttributes:Gx(Gx({},null==t?void 0:t.drawingAttributes),(i={},i[e]=a,i))}))}function r(e,n){var r;i("styles",function(e,t,a,i){var r=Object.keys(t),o=r[0],s=t[+o].selectionStart,c={};return r.forEach(function(i){for(var r,d,l,u,f=t[+i],p=f.selectionStart,m=f.selectionEnd,_={},h=p;h<m;h++)_[h]=NI(NI({},null===(d=null==e?void 0:e[+i])||void 0===d?void 0:d[h]),((r={})[a]=(null===(u=null===(l=null==e?void 0:e[+o])||void 0===l?void 0:l[+s])||void 0===u||u[a],n),r));c[+i]=NI(NI({},null==e?void 0:e[+i]),_)}),c}(null===(r=null==t?void 0:t.drawingAttributes)||void 0===r?void 0:r.styles,a||{},e))}var o=Object(s.useContext)(Wb).localizationStrings,d=Object(s.useMemo)(function(){return ZS(o)},[o]),l=Object(s.useMemo)(function(){var e,n;return BI(null===(e=null==t?void 0:t.drawingAttributes)||void 0===e?void 0:e.styles,a||{},"fontSize",null===(n=null==t?void 0:t.drawingAttributes)||void 0===n?void 0:n.fontSize)||void 0},[t,a]),u=Object(s.useMemo)(function(){var e;return null===(e=d.find(function(e){var n;return e.color===(null===(n=null==t?void 0:t.drawingAttributes)||void 0===n?void 0:n.backgroundColor)}))||void 0===e?void 0:e.id},[t,d]),f=Object(s.useMemo)(function(){var e,n,i,r=BI(null===(e=null==t?void 0:t.drawingAttributes)||void 0===e?void 0:e.styles,a||{},"fill",null===(n=null==t?void 0:t.drawingAttributes)||void 0===n?void 0:n.fill);return null===(i=d.find(function(e){return e.color===r}))||void 0===i?void 0:i.id},[t,d,a]),p=Object(s.useMemo)(function(){var e,n;return BI(null===(e=null==t?void 0:t.drawingAttributes)||void 0===e?void 0:e.styles,a||{},"fontFamily",null===(n=null==t?void 0:t.drawingAttributes)||void 0===n?void 0:n.fontFamily)},[t,a]),m=Object(s.useMemo)(function(){return(d.findIndex(function(e){return e.color===fs})+1).toString()},[d]),_=Object(s.useMemo)(function(){return(d.findIndex(function(e){return e.color===ps})+1).toString()},[d]);return c.a.createElement("div",null,c.a.createElement(v9,{label:"Font style",iconName:"Font"}),c.a.createElement(zx,{options:[{key:"Times New Roman",text:"Times New Roman"},{key:"arial",text:"arial"}],disabled:!t,selectedKey:p,placeholder:null===p&&t?"Mixed":void 0,onChange:function(e,t){var n;return r("fontFamily",null===(n=null==t?void 0:t.key)||void 0===n?void 0:n.toString())}}),c.a.createElement(QI,{fontSize:l,disabled:!t,onChange:function(e){return r("fontSize",e)},text:void 0===l&&t?"Mixed":void 0}),c.a.createElement(ix,{disabled:!t,colors:d,textColorId:f,backgroundColorId:u,onTextColorChange:function(e){return r("fill",e)},defaultColorId:_,defaultBackgroundColorId:m,onBackgroundColorChange:function(e){return i("backgroundColor",e)}}))}),qx=Object(s.memo)(function(e){var t=e.showGapBetweenToolbarAndStylePicker,n=void 0!==t&&t,a=e.dialogType,i=e.stylePickerPopUpPositionSource,r=e.styles,o=e.inkBrushes,d=e.activeInkBrushId,l=e.inkBrush,f=e.setInkBrush,p=e.setStrokeShapeTipVisibilityState,m=e.colorPickerMaxColumnCount,_=e.shouldHideArrowOptions,h=void 0!==_&&_,b=e.strokeShapeTipVisibilityState,g=e.setInkBrushVisibility,v=e.activeMarkupToolType,y=e.clearAllMarkupContent,S=e.enableClearAllMarkup,D=e.setAriaAnnouncement,I=dt("buttonGridCell"),x=Object(s.useContext)(Wb),C=x.localizationStrings,O=x.inkConfigurations,w=x.markupToolbarStyles,E=x.markupToolsConfigurations,A=$(),L=Object(s.useMemo)(function(){return function(e){return{markupToolbarTools:{toolbarIcon:{"&:hover":{backgroundColor:"unset"}}},markupToolbarButton:Object(u.mergeStyleSets)(Mb(e),{root:{width:"100%",marginTop:8,backgroundColor:e.palette.neutralLight},textContainer:{flexGrow:"unset"},flexContainer:{flexDirection:"row-reverse"},rootHovered:{backgroundColor:e.palette.neutralTertiaryAlt}})}}(A)},[A]),k=O[o[d].inkType];return Object(s.useEffect)(function(){Object.entries(o).filter(function(e){return"pen2"===e[0]}).forEach(function(e){var t=e[0];return g({inkBrushId:t,isInkBrushVisible:!1})})},[o,g]),c.a.createElement(tt,{styles:r},c.a.createElement("section",{"aria-label":""},c.a.createElement("div",{className:"sectionHeader_23d63f10",style:null==r?void 0:r.sectionHeader},"Markup")),c.a.createElement("section",null,c.a.createElement(j9,{showGapBetweenToolbarAndStylePicker:n,showStylePickerInFullWidth:!0,dialogType:a,stylePickerPopUpPositionSource:i})),ds(v)&&c.a.createElement("section",{"aria-label":"",className:PI},c.a.createElement(D9,{colorPickerGridCellButtonIdPrefix:I,doNotContainColorPickerWithinFocusZone:!0,colorOptions:ZS(C),colorPickerMaxColumnCount:m,inkConfiguration:k,inkBrush:l,inkBrushIdForInkStyleChange:d,setInkBrush:f,key:d,shouldHideArrowOptions:h,isStrokeShapeCalloutVisible:!0,strokeShapeTipVisibilityState:b,setStrokeShapeTipVisibilityState:p,styles:null==w?void 0:w.inkStylePicker,inkThicknessSliderHeaderIcon:"BullseyeTarget",strokePreviewShape:"Line",isColorHeaderVisible:!0,isStrokeShapePickerHeaderVisible:!0})),v===gs&&c.a.createElement("section",{"aria-label":"",className:Object(u.mergeStyles)(PI,"eraserSection_23d63f10"),style:{backgroundColor:A.palette.neutralLight}},c.a.createElement(E9,{styles:L,enableClearAllMarkup:S,clearAllMarkupContent:y,setAriaAnnouncement:D,confirmationDialogType:Jb.normal,getIcon:E.clearAllMarkup.getIcon,showTooltip:!1,text:"Clear All Markup"})),v===vs&&c.a.createElement("section",{"aria-label":"",className:Object(u.mergeStyles)(PI,"textSection_23d63f10"),style:{backgroundColor:A.palette.neutralLight}},c.a.createElement(RI,null),c.a.createElement(Wx,null)))}),Qx={setStrokeShapeTipVisibilityState:Ns,setInkBrush:Us,setInkBrushVisibility:Ws,clearAllMarkupContent:q_,setAriaAnnouncement:Jn},Yx=Object(ee.connect)(function(e){return{inkBrush:e.uiState.markupUiState.inkBrushes[e.uiState.markupUiState.activeInkBrushId],inkBrushes:e.uiState.markupUiState.inkBrushes,activeInkBrushId:e.uiState.markupUiState.activeInkBrushId,strokeShapeTipVisibilityState:e.uiState.markupUiState.strokeShapeTipVisibilityState,activeMarkupToolType:e.uiState.markupUiState.activeMarkupToolType,enableClearAllMarkup:e.markup.markupContentItems.length>0}},Qx)(qx),Jx=Object(s.memo)(function(e){var t,n=e.componentSize,a=e.onSave,i=e.onClose,r=e.pivotItems,o=e.isEditorFocused,d=e.cssToPhysicalPixelRatio,l=e.layout,u=e.animationSpeedMultiplier,f=e.hideCanvas,p=e.customCommandBarButtons,m=e.onRenderSaveMenu,_=e.actionsStackStyles,b=$(),g=Object(s.useContext)(lh),v=g.image,y=g.setOffscreenRenderer,S=Object(s.useContext)(dh),D=S.enableAutoEnhance,I=S.autoEnhanceInstallationInfo,x=Object(s.useContext)(Wb),C=x.markupToolbarStyles,O=(0,x.getMarkupToolbarPosition)(C),w="Inline"===O,E=null===(t=null==C?void 0:C.clearAllMarkup)||void 0===t?void 0:t.confirmationDialog,A=Object(s.useMemo)(function(){return function(e){var t;return(t={}).Crop=$9($9({},e8),{bottom:162}),t.Adjustment=e8,t.Filter=e8,t.Markup=function(e){switch(e){case"Left":case"Right":return $9($9({},e8),{left:90,right:90});case"Bottom":return $9($9({},e8),{bottom:56});case"Inline":return $9({},e8);default:throw new h(e)}}(e),t.Retouch=e8,t.InPaint=e8,t}(O)},[O]),L=Object(s.useState)(null),k=L[0],M=L[1],P=Object(s.useState)(!0),T=P[0],U=P[1],F=O4(k);return Object(s.useLayoutEffect)(function(){U(!(F.width<813))},[F]),c.a.createElement("div",{className:"layout_desktop_46fde051",ref:M},c.a.createElement("div",{role:"banner"},r.length>1&&c.a.createElement(D0,{componentSize:n,onSave:a,onRenderSaveMenu:m,onCancel:i,controlPivot:c.a.createElement(fc,{pivotItems:r,styles:I0(b),showHeaderText:T}),confirmationDialogStyles:E,customItems:p}),r.length<=1&&c.a.createElement(D0,{componentSize:n,onSave:a,onRenderSaveMenu:m,onCancel:i,confirmationDialogStyles:E})),c.a.createElement("div",{className:"content_container_46fde051"},c.a.createElement("div",{className:"canvas_container_46fde051",role:"main","data-test-id":"canvas-container"},c.a.createElement(Xf,null),c.a.createElement(Jf,null),c.a.createElement(ep,null),!f&&c.a.createElement(xb,{canvasSize:n,cssToPhysicalPixelRatio:d},c.a.createElement(Om,{animationSpeedMultiplier:u},c.a.createElement(wb,{match:to},c.a.createElement(ap,{handleSizeCss:28,handleHitAreaSizeCss:50}),c.a.createElement(qf,null)),c.a.createElement(mb,{image:v,color:dl,zIndex:1},c.a.createElement(_S,null,c.a.createElement(v8,{ref:y}),c.a.createElement(dS,null))),c.a.createElement(wb,{match:ro},c.a.createElement(r5,null),c.a.createElement(J8,null)),c.a.createElement(wb,{match:oo},c.a.createElement(J8,null),c.a.createElement(G5,null),c.a.createElement(AI,null),c.a.createElement(K5,null)),c.a.createElement(Z9,{showGapBetweenToolbarAndStylePicker:!0,stylePickerPopUpPositionSource:"Bottom"===O?"SelectedInkBrushButton":"MarkupToolbarContainer",isEditorFocused:o}),c.a.createElement(D8,null))),c.a.createElement(wb,{match:ro},c.a.createElement(B8,null)),c.a.createElement(wb,{match:oo},c.a.createElement(j5,null)),c.a.createElement(wb,{match:[no,ao]},c.a.createElement(Wy,null),c.a.createElement(Ab,null)),c.a.createElement(wb,{match:to},c.a.createElement(Yp,null),c.a.createElement(Ay,{desktopTransformToolsActionStackStyles:_}),c.a.createElement(ts,null),c.a.createElement(bb,null))),c.a.createElement(wb,{match:no},c.a.createElement(VS,{theme:b},c.a.createElement(ta,{styles:{adjustmentSlider:{getSliderHeaderStyles:function(){return{container:{paddingBottom:"2.5px"}}},getSliderStyles:function(){return{container:{marginBottom:"17.5px"}}}}}}))),c.a.createElement(wb,{match:ao},c.a.createElement(VS,{theme:b},c.a.createElement(BS,{styles:l.getFilterActionsPaneStyles()},D&&c.a.createElement(c.a.Fragment,null,c.a.createElement(QS,{autoEnhanceInstallationInfo:I}),c.a.createElement(y5,null))))),c.a.createElement(wb,{match:io},w&&c.a.createElement(VS,{theme:b,styles:UI},c.a.createElement(Yx,{styles:TI}))),c.a.createElement(wb,{match:ro},c.a.createElement(VS,{theme:b},c.a.createElement(b5,{defaultRadiusInScreenPixels:30}),c.a.createElement(m5,{styles:{adjustmentSlider:{getSliderHeaderStyles:function(){return{container:{paddingBottom:"2.5px"}}},getSliderStyles:function(){return{container:{marginBottom:"17.5px"}}}}},spotFixControlPanelStyles:{sliderStyles:{getSliderHeaderStyles:function(){return{container:{paddingBottom:"2.5px"}}}}},isCalloutEnabled:!0}))),c.a.createElement(wb,{match:oo},c.a.createElement(VS,{theme:b},c.a.createElement(SI,{styles:{adjustmentSlider:{getSliderHeaderStyles:function(){return{container:{paddingBottom:"2.5px"}}},getSliderStyles:function(){return{container:{marginBottom:"17.5px"}}}}}})))),c.a.createElement(MI,null),c.a.createElement(Yy,{cssPixelMarginByActivity:A}))}),Xx=function(){return Xx=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Xx.apply(this,arguments)},Zx={reactNode:function(e){var t=Xx(Xx({},e),{hideCanvas:this.hideCanvas});return c.a.createElement(Jx,Xx({},t))},getTheme:function(e,t){return Xx(Xx({},e?f:p),{rtl:t})},getFilterActionsPaneStyles:function(){return{filterTile:{margin:"0 8px"},slider:{container:m},imageTile:{container:{width:"93px"}}}},getMarkupToolbarStyles:function(e,t,n,a){return void 0===t&&(t="Bottom"),void 0===n&&(n=!1),void 0===a&&(a=!1),function(e,t){switch(t){case"Left":return Object(u.merge)(D(e),I);case"Right":return Object(u.merge)(D(e),C);case"Bottom":return function(e){return{inkStylePicker:{strokeShapePickerStyles:{container:S({},O(e)),iconLabelButton:{root:{marginTop:"8px"}}}}}}(e);case"Inline":return function(e){return{markupToolbarPosition:"Inline",inkStylePicker:{strokeShapePickerStyles:{container:S(S({},O(e)),{borderTop:"unset",justifyContent:"flex-start"}),iconLabelButton:{root:{marginTop:"8px"}}},inkColorPickerStyles:{container:{marginLeft:"unset"},colorPicker:{root:{marginLeft:-8}}},strokePreviewStyles:{margin:"16px 0 0"},containerStyles:{width:"100%",marginTop:16},getContentWrapperStyle:function(){return{height:"inherit",display:"inherit",padding:0,boxShadow:"unset"}}},canvasContainer:{background:"inherit",transform:"inherit",bottom:"inherit",left:"inherit",position:"inherit"}}}(e);default:throw new h(t)}}(e,t)}},$x=function(){function e(){this._count=0,this._min=Number.MAX_VALUE,this._totalTime=0}return Object.defineProperty(e.prototype,"frameCount",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minimumFps",{get:function(){return this._min},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageFps",{get:function(){return 1e3*this._count/this._totalTime},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this._count=0,this._min=Number.MAX_VALUE,this._totalTime=0},e.prototype.reportFrame=function(e){this._count++;var t=1e3/e;this._min=Math.min(this.minimumFps,t),this._totalTime+=e},e}(),eC=c.a.memo(function(e){var t=e.imageSize,n=e.children,a=Object(s.useContext)(Zt),i=a.logPageLoadTimeEvent,r=a.logSessionStatistics,o=a.updateSessionId,d=Object(s.useRef)(t),l=Object(s.useMemo)(function(){return new $x},[]);return Object(s.useEffect)(function(){var e=window.performance.now(),t=0,n=function(){var a=window.performance.now();l.reportFrame(a-e),e=a,t=window.requestAnimationFrame(n)};return t=window.requestAnimationFrame(n),function(){window.cancelAnimationFrame(t)}},[l]),Object(s.useEffect)(function(){return function(){d.current!==t&&(r({minFrameRate:l.minimumFps,avgFrameRate:l.averageFps,imageSize:{width:t.x,height:t.y}}),l.reset(),o(),d.current=t)}},[r,o,l,t]),Object(s.useLayoutEffect)(function(){var e=window.requestAnimationFrame(function(){setTimeout(function(){i({pageLoadTimeMs:Am(Im.Editor),component:Im.Editor})})});return function(){window.cancelAnimationFrame(e)}},[i]),c.a.createElement(c.a.Fragment,null,n)}),tC=Object(ee.connect)(function(e){return{imageSize:e.transformTools.image.originalPixelSize}},{})(eC),nC={adjustment_light:"",adjustment_color:"",adjustment_lightAriaLandmark:"",adjustment_colorAriaLandmark:"",adjustment_brightness:"",adjustment_exposure:"",adjustment_contrast:"",adjustment_highlights:"",adjustment_shadows:"",adjustment_saturation:"",adjustment_temperature:"",adjustment_tint:"",adjustment_vignette:"",adjustment_mobileChangedAriaLive:"",adjustment_sliderChangedAriaLive:"",adjustment_sliderAriaLabelFormatString:"",adjustment_sliderTooltip:"",adjustment_tileMobileTooltip:"",adjustment_tileMobileAriaLabel:"",aspectRatio_listTitle:"",aspectRatio_freeform:"",aspectRatio_freeformAriaLabel:"",aspectRatio_original:"",aspectRatio_originalAriaLabel:"",aspectRatio_square:"",aspectRatio_squareAriaLabel:"",aspectRatio_ratioLabelFormatString:"",aspectRatio_ratioAriaLabelFormatString:"",aspectRatio_tooltip:"",aspectRatio_changedAriaLive:"",flip_portrait:"",flip_portraitAriaLabel:"",flip_landscape:"",flip_landscapeAriaLabel:"",autoEnhance_name:"",autoEnhance_generatingAriaLive:"",autoEnhance_appliedAriaLive:"",autoEnhance_removedAriaLive:"",autoEnhance_intensitySliderHeader:"",autoEnhance_intensitySliderAriaLabel:"",autoEnhance_downloadButton:"",autoEnhance_downloadingStatus:"",autoEnhance_retryDownloadButton:"",autoEnhance_installTooltip:"",autoEnhance_retryInstallTooltip:"",autoEnhance_appliedTooltip:"",autoEnhance_notAppliedTooltip:"",autoEnhance_disabledBySpotFixTooltip:"",crop_topLeftCornerAriaLabel:"",crop_topRightCornerAriaLabel:"",crop_bottomLeftCornerAriaLabel:"",crop_bottomRightCornerAriaLabel:"",crop_cornerTooltip:"",crop_rectangleAriaLabel:"",crop_rectangleTooltip:"",crop_rectanglePositionAriaLive:"",crop_rectangleCannotMoveInCurrentDirectionAriaLive:"",editor_viewingOriginal:"",editor_viewingOriginalAriaLive:"",editor_zoomPercentAriaLive:"",editor_imageDimensionLabelFormatString:"",editor_imageDimensionAriaLabelFormatString:"",editor_imageDimensionAriaLive:"",editor_imageDimensionWithAspectRatioAriaLive:"",filter_listTitle:"",filter_intensitySliderHeader:"",filter_intensitySliderAriaLabelFormatString:"",filter_nameOriginal:"",filter_nameBurn:"",filter_nameBw:"",filter_nameBwAriaLabel:"",filter_nameBwCool:"",filter_nameBwCoolAriaLabel:"",filter_nameBwHighContrast:"",filter_nameBwHighContrastAriaLabel:"",filter_nameBwWarm:"",filter_nameBwWarmAriaLabel:"",filter_nameCoolLight:"",filter_nameCalm:"",filter_nameDramaticCool:"",filter_nameFilm:"",filter_nameGolden:"",filter_namePunch:"",filter_nameRadiate:"",filter_nameVintage:"",filter_nameVividCool:"",filter_nameWarmContrast:"",filter_changedAriaLive:"",filter_changedAriaLiveWithIntensity:"",filter_mobileChangedAriaLive:"",filter_mobileChangedAriaLiveWithIntensity:"",filter_filtersAriaLandmark:"",filter_sliderTooltip:"",filter_tileMobileTooltip:"",filter_tileAriaLabel:"",filter_tileAriaLabelWhenOriginalFilterIsSelected:"",filter_activeTileAriaLabel:"",filter_activeOriginalFilterAriaLabel:"",footer_done:"",nonCrop_imageTooltip:"",nonCrop_imageAriaLabelWithEdits:"",nonCrop_imageAriaLabelWithoutEdits:"",nonCrop_panViewPositionAriaLive:"",pivot_crop:"",pivot_adjustment:"",pivot_filter:"",pivot_markup:"",pivot_retouch:"",pivot_inpaint:"",pivot_AriaLabel:"",rotate_left90:"",rotate_left90AriaLabel:"",rotate_left90FinishedAriaLive:"",rotate_right90:"",rotate_right90AriaLabel:"",rotate_right90FinishedAriaLive:"",rotate_sliderAriaLabel:"",rotate_degree:"",rotate_sliderTooltip:"",flip_horizontal:"",flip_horizontalAriaLabel:"",flip_horizontalFinishedAriaLive:"",flip_vertical:"",flip_verticalAriaLabel:"",flip_verticalFinishedAriaLive:"",toolbar_imageSave:"",toolbar_imageSaveTooltip:"",toolbar_imageSaveAsOriginal:"",toolbar_imageSaveAsOriginalAriaLabel:"",toolbar_saveMenuSplitButtonAriaLabel:"",toolbar_imageSaveAsOriginalTooltip:"",toolbar_imageSaveAsCopy:"",toolbar_imageSaveAsCopyAriaLabel:"",toolbar_imageSaveAsCopyTooltip:"",toolbar_imageReset:"",toolbar_imageResetTooltip:"",toolbar_imageResetAriaLabel:"",toolbar_imageResetFinishedAriaLive:"",toolbar_resetConfirmDialogContentTitle:"",toolbar_resetConfirmDialogContentSubText:"",toolbar_resetConfirmDialogCloseButtonAriaLabel:"",toolbar_resetConfirmDialogConfirmText:"",toolbar_resetConfirmDialogConfirmAriaLabel:"",toolbar_resetConfirmDialogCancelText:"",toolbar_resetConfirmDialogCancelAriaLabel:"",toolbar_zoomLevelAriaLabel:"",toolbar_zoomInTooltip:"",toolbar_zoomInAriaLabel:"",toolbar_zoomOutTooltip:"",toolbar_zoomOutAriaLabel:"",toolbar_done:"",toolbar_doneAriaLabel:"",toolbar_doneTooltip:"",toolbar_cancel:"",toolbar_cancelAriaLabel:"",toolbar_cancelTooltip:"",toolbar_fitToViewTooltip:"",toolbar_viewActualSizeTooltip:"",toolbar_undo:"",toolbar_undoAriaLabel:"",toolbar_redo:"",toolbar_redoAriaLabel:"",undoRedo_colorAdjustmentsAriaLive:"",undoRedo_autoEnhanceAriaLive:"",undoRedo_filterAriaLive:"",undoRedo_markupInkContentAriaLive:"",undoRedo_markupEraseContentAriaLive:"",undoRedo_markupClearAllMarkupContentAriaLive:"",undoRedo_transformCropAriaLive:"",undoRedo_transformAspectRatioAriaLive:"",undoRedo_transformMirrorImageAriaLive:"",undoRedo_transformRotationAriaLive:"",undoRedo_spotFixAriaLive:"",spotFix_toastText:"",spotFix_calloutHeaderText:"",spotFix_calloutMainText:"",spotFix_header:"",spotFix_sizeSliderTooltip:"",spotFix_sizeSliderHeader:""},aC=function(e){var t=e.localization,n=e.children,a=Object(s.useMemo)(function(){return Xe(null!=t?t:{strings:nC,locales:void 0})},[t]);return c.a.createElement(Ze.Provider,{value:a},n)},iC=function(e){var t=e.telemetryCallback,n=e.children,a=Object(s.useMemo)(function(){return t?Ct(t):null},[t]);return c.a.createElement(c.a.Fragment,null,t&&a?c.a.createElement(Zt.Provider,{value:a},n):n)},rC=c.a.memo(function(){var e=Object(s.useContext)(Zt).logErrorEvent;return Object(s.useEffect)(function(){var t=function(t){var n,a,i=t.message,r=t.filename,o=t.lineno,s=t.colno,c=t.error;e({message:i,source:r,lineNumber:o,columnNumber:s,error:{message:null!==(n=null==c?void 0:c.message)&&void 0!==n?n:"No message available.",stack:null!==(a=null==c?void 0:c.stack)&&void 0!==a?a:"No stack information available."}})};return window.addEventListener("error",t),function(){return window.removeEventListener("error",t)}},[e]),null}),oC={imageTransform:{x:0,y:0,width:1,height:1,rotation:0},cropRectangle:{top:0,left:0,width:1,height:1},originalImageSize:{x:1,y:1},aspectRatio:lo,shouldInvertOriginalAspectRatio:!1},sC={brightness:0,exposure:0,saturation:0,highlights:0,shadows:0,contrast:0,tint:0,temperature:0,vignette:0,version:we.Version1,maskLevel:0},cC=function(e,t){if(typeof e!=typeof t)return!1;if("object"==typeof e)for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!cC(e[n],t[n]))return!1;return!0},dC=function(e){return e>=0&&e<=1},lC=function(e,t){var n={isValid:!0};try{var a=e.adjustments,i=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["adjustments"]);if(void 0!==i.version&&"number"!=typeof i.version)throw new Error("IEditOperations contains invalid data");!function(e,t){if(!(cC(oC,e)&&t.some(function(t){return Wc(t,e.aspectRatio,5)})&&e.originalImageSize.x>=1&&e.originalImageSize.y>=1&&e.imageTransform.height>=1&&e.imageTransform.width>=1&&e.cropRectangle.height>=1&&e.cropRectangle.width>=1))throw new Error("IEditTransformOperations contains invalid data")}(i.transforms,t),a&&function(e){if(!(cC(sC,e)&&Object.values(we).includes(e.version)&&dC(e.brightness)&&dC(e.exposure)&&dC(e.saturation)&&dC(e.highlights)&&dC(e.shadows)&&dC(e.contrast)&&dC(e.tint)&&dC(e.vignette)&&dC(e.temperature)))throw new Error("IColorAdjustmentWithoutLutState contains invalid data")}(a)}catch(e){n.isValid=!1,n.message=e instanceof Error?e.message:"unknown error"}return n},uC=function(){return uC=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},uC.apply(this,arguments)},fC=function(){return fC=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},fC.apply(this,arguments)};function pC(e){return e&&"object"==typeof e&&!Array.isArray(e)}function mC(e,t){var n=fC(fC({},e),t);return pC(e)&&pC(t)&&Object.keys(t).forEach(function(a){var i;if(!(a in e))throw new Error("override object has a key that does not exist in base object: ".concat(a));if(t[a]&&e[a]&&typeof t[a]!=typeof e[a])throw new Error("override object value at key: '".concat(a,"' type does not match base object type at key:'").concat(a,"'"));pC(t[a])?n[a]=mC(e[a],t[a]):Object.assign(n,((i={})[a]=t[a],i))}),n}var _C=function(){return _C=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_C.apply(this,arguments)};function hC(e,t){var n=Object(s.useRef)(e);return n.current!==e&&t&&t(n.current,e),n.current}var bC=["pen1","pen2","highlighter"];function gC(e){var t=Rm(),n=hC(e,Object(s.useCallback)(function(){t({id:"InitialInkBrushConfigIgnored",message:"Change to initialMarkupToolsConfigurations prop was ignored. initialMarkupToolsConfigurations is for initial state only. For subsequent changes use the state or reset method"})},[t]));try{!function(e){if(!e.activeInkBrushId)throw new Error("initialInkBrushConfiguration must contain a activeInkBrushId");if(!bC.includes(e.activeInkBrushId))throw new Error("initialInkBrushConfiguration contains an invalid activeInkBrushId");if(!e.eraser.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for the eraser tool");if(!e.clearAllMarkup.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for the clear-ink button");e.brushes.forEach(function(e){if(!e.getIcon)throw new Error("initialInkBrushConfiguration must provide a getIcon callback for ".concat(e.inkBrushId))}),bC.forEach(function(t){if(!e.brushes.find(function(e){return e.inkBrushId===t}))throw new Error("initialInkBrushConfiguration must include configuration for brushId: ".concat(t))})}(e)}catch(e){n=zb,e instanceof Error?t({id:"InitialInkBrushConfigIgnored",message:e.message}):t({id:"InitialInkBrushConfigIgnored",message:"Change to initialMarkupToolsConfigurations prop was ignored. initialMarkupToolsConfigurations is invalid"})}return n}var vC=function(){return vC=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},vC.apply(this,arguments)},yC=c.a.memo(function(e){var t=e.serializedState,n=e.defaultEdits,a=e.initialEdits,i=e.initialUiState,r=e.aspectRatiosList,o=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["serializedState","defaultEdits","initialEdits","initialUiState","aspectRatiosList"]),d=Object(s.useContext)(Zt),l=Object(s.useContext)(Wb).markupToolsConfigurations,u=Rm(),f=gC(l),p=Object(s.useRef)(n).current,m=function(e,t,n){if(n){var a=lC(n,t),i=a.isValid,r=a.message;if(i)return n;e({id:"InitialEditsIgnored",message:"ValidationError: ".concat(r)})}}(u,null!=r?r:go,a),_=Object(s.useMemo)(function(){return function(e,t,n,a,i,r,o){var s=e?JSON.parse(decodeURI(e)):{},c={colorAdjustments:ze,transformTools:wd,uiState:qs,ariaAnnouncement:Zn,filters:RS,autoEnhance:db,markup:J_,texturePatch:f_,spotFixUi:R8,inPaintingUi:N5},d={transformTools:mC(function(e){var t=Io;return e?_C(_C({},Io),{cropInteraction:_C(_C({},Io.cropInteraction),{aspectRatiosList:e})}):t}(r),s.transformTools),colorAdjustments:mC(Te,s.colorAdjustments),uiState:mC(Ss,s.uiState),ariaAnnouncement:mC(Qn,s.ariaAnnouncement),filters:mC(w_,s.filters),autoEnhance:mC(D_,s.autoEnhance),markup:mC(z_,s.markup),texturePatch:mC(Xm,s.texturePatch)},l=Object(te.e)({reducer:c,preloadedState:d,middleware:function(e){return e().concat(o||[])}});if(t&&l.dispatch(nd(t)),n&&l.dispatch(ce(n)),i){var u={};i.brushes.forEach(function(e){u[e.inkBrushId]=ms[e.inkBrushId]}),l.dispatch(Ts(u)),l.dispatch(Ps(i.activeInkBrushId)),l.dispatch(Hs(S4(u[i.activeInkBrushId].inkType)))}return a&&l.dispatch(ks(a)),l}(t,p,m,i,f,r,[(e=d,function(t){return function(t){return function(n){return t(uC(uC({},n),{telemetry:e}))}}})]);var e},[t,p,m,i,f,r,d]);return Object(s.useEffect)(function(){n&&_.dispatch(nd(n))},[_,n]),c.a.createElement(ee.Provider,vC({},o,{store:_}))});yC.displayName="ImageEditorProvider";var SC=function(){return SC=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},SC.apply(this,arguments)},DC=function(e){var t=e.image,n=e.onRequestAutoEnhance,a=e.onRequestAutoEnhanceInstall,i=e.children,r=Object(s.useState)(t),o=r[0],d=r[1],l=Object(s.useState)(null),u=l[0],f=l[1],p=Object(s.useContext)(Wb).enableMarkup;Object(s.useEffect)(function(){d(function(e){return p&&am(e)&&e.overlay?SC(SC({},im(t)),{overlay:e.overlay}):t})},[t,p]);var m=Object(s.useCallback)(function(e,t){d(function(n){var a;if(!am(n)&&!t)return n;if(am(n)){var i=n[e];if(!i&&!t||t&&i&&rm(i)===rm(t))return n}return SC(SC({},im(n)),((a={})[e]=t,a))})},[]);return c.a.createElement(lh.Provider,{value:{image:o,setImage:d,onRequestAutoEnhance:n,onRequestAutoEnhanceInstall:a,setImageLayer:m,offscreenRenderer:u,setOffscreenRenderer:f}},i)},IC=new Set([d0.SaveAs,d0.SaveAsOriginal]),xC=new Set,CC=function(e,t,n){return t&&n?IC:xC},OC=Object(ga.e)([jo,Vo,Bo],function(e,t,n){return n&&!!e&&Ra(e,t)}),wC=c.a.memo(function(e){var t,n=e.editsAreSameAsDefaults,a=e.editsWouldModifyImage,i=e.isFullSizeInputImageAvailable,r=e.onDecideEnabledSaveTypes,o=e.children,s=(t=(r||CC)(n,a,i),new Set(Array.from(t)));return c.a.createElement(p0.Provider,{value:s},o)}),EC=Object(ee.connect)(function(e,t){return{editsAreSameAsDefaults:eg(e),editsWouldModifyImage:eh(e),isFullSizeInputImageAvailable:OC(e)}})(wC),AC=c.a.memo(function(e){var t=e.sessionFullImageSize,n=e.setSessionFullImageSize,a=e.resetEdits,i=e.children,r=Rm(),o=hC(t,Object(s.useCallback)(function(){r({id:"SessionFullImageSizeIgnored",message:"Change to sessionFullImageSize prop was ignored. sessionFullImageSize is for initial state only."})},[r]));return Object(s.useEffect)(function(){o&&(n(o),a(!1))},[a,o,n]),c.a.createElement(Em.Provider,{value:o},i)}),LC={setSessionFullImageSize:Od,resetEdits:se},kC=Object(ee.connect)(null,LC)(AC),MC={tileAriaRole:"option",tileListAriaRole:"listbox"},PC=Object(s.createContext)(MC),TC=function(e){var t=e.ariaConfig,n=void 0===t?MC:t,a=e.children,i=n.tileAriaRole,r=n.tileListAriaRole;return c.a.createElement(PC.Provider,{value:{tileAriaRole:i,tileListAriaRole:r}},a)},UC=c.a.memo(function(e){var t=e.image,n=e.localization,a=e.telemetryCallback,i=e.serializedState,r=e.onComponentError,o=e.defaultEdits,d=e.initialEdits,l=e.initialUiState,u=e.children,f=e.onDecideEnabledSaveTypes,p=e.sessionFullImageSize,m=e.onResetEditsConfirmationDialog,_=e.onRequestAutoEnhance,h=e.onRequestAutoEnhanceInstall,b=e.ariaConfig,g=e.aspectRatiosDisplayedInOrder,v=hC(d,Object(s.useCallback)(function(){r({id:"InitialEditsIgnored",message:"Change to initialEdits prop was ignored. initialEdits is for initial state only. For subsequent changes use the setEdits method, or the reset method"})},[r])),y=hC(l,Object(s.useCallback)(function(){r({id:"InitialUiStateIgnored",message:"Change to initialUiState prop was ignored. initialUiState is for initial state only. For subsequent changes use the setUiState method"})},[r]));return c.a.createElement(Hm,{onError:r},c.a.createElement(iC,{telemetryCallback:a},c.a.createElement(aC,{localization:n},c.a.createElement(yC,{serializedState:i,defaultEdits:o,initialEdits:v,initialUiState:y,aspectRatiosList:g},c.a.createElement(TC,{ariaConfig:b},c.a.createElement(Xg,{onResetEditsConfirmationDialog:m},c.a.createElement(EC,{onDecideEnabledSaveTypes:f},c.a.createElement(kC,{sessionFullImageSize:p},c.a.createElement(DC,{image:t,onRequestAutoEnhance:_,onRequestAutoEnhanceInstall:h},u,c.a.createElement(tC,null)))))))),c.a.createElement(rC,null)))});function FC(e,t){return void 0===t&&(t=18),c.a.createElement("svg",{viewBox:"0 0 ".concat(t," ").concat(t)},c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:HC(e,t)}))}function HC(e,t){var n=e>1,a=n?t:t*e,i=n?t/e:t,r={left:(t-a)/2,top:(t-i)/2,width:a,height:i};return RC({left:r.left+1.5,top:r.top+1.5,width:a-3,height:i-3},1.5)+RC(r,3)}function RC(e,t){var n=e.left,a=e.top+t,i=t,r=.5*t,o=e.width-2*t,s=e.height-2*t;return"M".concat(n," ").concat(a,"v").concat(s,"c0 ").concat(r," ").concat(r," ").concat(i," ").concat(i," ").concat(i,"h").concat(o,"c").concat(r," 0 ").concat(i," -").concat(r," ").concat(i," -").concat(i,"v-").concat(s,"c0 -").concat(r," -").concat(r," -").concat(i," -").concat(i," -").concat(i,"h-").concat(o,"c-").concat(r," 0 -").concat(i," ").concat(r," -").concat(i," ").concat(i,"z")}UC.displayName="ImageEditorContext";var NC=FC(.5),BC=FC(2),jC=FC(2/3),VC=FC(1.5),zC=FC(3/4),GC=FC(4/3),KC=FC(.8),WC=FC(5/4),qC=FC(9/16),QC=FC(16/9),YC=FC(1),JC=c.a.createElement("svg",{viewBox:"0 0 20 20"},c.a.createElement("path",{d:"M19.2502 11C19.6298 11 19.9436 11.2822 19.9933 11.6482L20.0002 11.75V16.75C20.0002 18.483 18.6437 19.8992 16.9346 19.9949L16.7502 20L12.0823 20.0002C12.6186 19.6147 13.0556 19.0997 13.3475 18.5011L16.7502 18.5C17.6683 18.5 18.4213 17.7929 18.4944 16.8935L18.5002 16.75V11.75C18.5002 11.3358 18.8359 11 19.2502 11ZM9.75015 7C11.5451 7 13.0002 8.45507 13.0002 10.25V16.75C13.0002 18.5449 11.5451 20 9.75015 20H3.25015C1.45523 20 0.0001508 18.5449 0.0001508 16.75V10.25C0.0001508 8.45507 1.45523 7 3.25015 7H9.75015ZM5.71776 15.3534L5.61627 15.4445L2.66355 18.3993C2.84693 18.4645 3.04439 18.5 3.25015 18.5H9.75015C9.95591 18.5 10.1534 18.4645 10.3368 18.3993L7.38403 15.4445C6.96097 15.0215 6.31009 14.9651 5.82627 15.2753L5.71776 15.3534ZM9.75015 8.5H3.25015C2.28365 8.5 1.50015 9.2835 1.50015 10.25V16.75C1.50015 16.9558 1.53566 17.1532 1.60089 17.3366L4.55561 14.3839C5.5848 13.3547 7.22681 13.3118 8.30707 14.2552L8.44469 14.3839L11.3994 17.3366C11.4646 17.1532 11.5002 16.9558 11.5002 16.75V10.25C11.5002 9.2835 10.7166 8.5 9.75015 8.5ZM9.00015 10C9.55243 10 10.0002 10.4477 10.0002 11C10.0002 11.5523 9.55243 12 9.00015 12C8.44787 12 8.00015 11.5523 8.00015 11C8.00015 10.4477 8.44787 10 9.00015 10ZM16.7502 0C18.4832 0 19.8994 1.35645 19.995 3.06558L20.0002 3.25V8.25C20.0002 8.66421 19.6644 9 19.2502 9C18.8705 9 18.5567 8.71785 18.507 8.35177L18.5002 8.25V3.25C18.5002 2.33183 17.793 1.57881 16.8937 1.5058L16.7502 1.5H11.7502C11.3359 1.5 11.0002 1.16421 11.0002 0.75C11.0002 0.370304 11.2823 0.0565091 11.6484 0.00684667L11.7502 0H16.7502ZM8.25015 0C8.66436 0 9.00015 0.335786 9.00015 0.75C9.00015 1.1297 8.718 1.44349 8.35192 1.49315L8.25015 1.5H3.25015C2.33198 1.5 1.57896 2.20711 1.50595 3.10647L1.50015 3.25L1.50011 6.65214C0.901018 6.94409 0.385711 7.38126 0 7.91785L0.0001508 3.25C0.0001508 1.51697 1.35661 0.100754 3.06573 0.00514483L3.25015 0H8.25015Z"})),XC=c.a.createElement("svg",{viewBox:"0 0 18 18"},c.a.createElement("path",{d:"M14.75 0C16.5449 0 18 1.45507 18 3.25V14.75C18 16.5449 16.5449 18 14.75 18H3.25C1.45507 18 0 16.5449 0 14.75V3.25C0 1.45507 1.45507 0 3.25 0H14.75ZM15.3305 16.4014L9.52467 10.7148C9.25962 10.4553 8.85013 10.4316 8.55879 10.644L8.4752 10.7148L2.66845 16.4011C2.8504 16.4651 3.04613 16.5 3.25 16.5H14.75C14.9535 16.5 15.1489 16.4653 15.3305 16.4014L9.52467 10.7148L15.3305 16.4014ZM14.75 1.5H3.25C2.2835 1.5 1.5 2.2835 1.5 3.25V14.75C1.5 14.9584 1.53643 15.1583 1.60326 15.3437L7.42578 9.64299C8.25887 8.82729 9.56746 8.7885 10.4458 9.52658L10.5742 9.64312L16.3964 15.3447C16.4634 15.159 16.5 14.9588 16.5 14.75V3.25C16.5 2.2835 15.7165 1.5 14.75 1.5ZM12.2521 3.5C13.4959 3.5 14.5042 4.50831 14.5042 5.75212C14.5042 6.99592 13.4959 8.00423 12.2521 8.00423C11.0083 8.00423 10 6.99592 10 5.75212C10 4.50831 11.0083 3.5 12.2521 3.5ZM12.2521 5C11.8367 5 11.5 5.33673 11.5 5.75212C11.5 6.1675 11.8367 6.50423 12.2521 6.50423C12.6675 6.50423 13.0042 6.1675 13.0042 5.75212C13.0042 5.33673 12.6675 5 12.2521 5Z"})),ZC=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M7.99685 13.7862C8.2423 13.7862 8.4465 13.9629 8.4888 14.1958L8.4969 14.2856V15.5005C8.4969 15.7764 8.273 16 7.99685 16C7.75139 16 7.54724 15.8234 7.50491 15.5903L7.49685 15.5005V14.2856C7.49685 14.0098 7.72071 13.7862 7.99685 13.7862ZM12.7337 12.0179L12.803 12.0756L13.663 12.9348C13.8582 13.1298 13.8582 13.446 13.663 13.6411C13.4894 13.8144 13.22 13.8337 13.0251 13.6989L12.9559 13.6411L12.0958 12.782C11.9006 12.587 11.9006 12.2707 12.0958 12.0756C12.2694 11.9023 12.5388 11.883 12.7337 12.0179ZM3.89746 12.0756C4.07103 12.249 4.09031 12.5181 3.95532 12.7128L3.89746 12.782L3.03745 13.6411C2.84219 13.8361 2.5256 13.8361 2.33034 13.6411C2.15678 13.4677 2.13749 13.1986 2.27249 13.0039L2.33034 12.9348L3.19035 12.0756C3.38562 11.8806 3.7022 11.8806 3.89746 12.0756ZM8.0072 3.51284C10.4866 3.51284 12.4965 5.52061 12.4965 7.99731C12.4965 10.4741 10.4866 12.4818 8.0072 12.4818C5.52781 12.4818 3.51787 10.4741 3.51787 7.99731C3.51787 5.52061 5.52781 3.51284 8.0072 3.51284ZM15.4999 7.51538C15.776 7.51538 15.9999 7.739 15.9999 8.01483C15.9999 8.26007 15.823 8.46395 15.5898 8.5063L15.4999 8.51429H14.2836C14.0075 8.51429 13.7836 8.29073 13.7836 8.01483C13.7836 7.76965 13.9605 7.56572 14.1938 7.52343L14.2836 7.51538H15.4999ZM1.71624 7.49206C1.99238 7.49206 2.21624 7.71567 2.21624 7.99151C2.21624 8.23669 2.03936 8.44067 1.80612 8.48293L1.71624 8.49102H0.5C0.22386 8.49102 0 8.26736 0 7.99151C0 7.74631 0.17688 7.54239 0.41012 7.5001L0.5 7.49206H1.71624ZM2.9682 2.30115L3.03745 2.35893L3.89746 3.21803C4.09272 3.41307 4.09272 3.72931 3.89746 3.92436C3.72389 4.09774 3.45447 4.117 3.2596 3.98216L3.19035 3.92436L2.33034 3.06528C2.13508 2.87023 2.13508 2.55399 2.33034 2.35893C2.50391 2.18556 2.77333 2.16629 2.9682 2.30115ZM13.663 2.35893C13.8365 2.53232 13.8558 2.80146 13.7208 2.99611L13.663 3.06528L12.803 3.92436C12.6077 4.11941 12.2911 4.11941 12.0958 3.92436C11.9223 3.75099 11.903 3.48185 12.038 3.28719L12.0958 3.21803L12.9559 2.35893C13.1511 2.16388 13.4677 2.16388 13.663 2.35893ZM8.0001 0C8.2456 0 8.4498 0.176689 8.4921 0.409688L8.5001 0.499461V1.71439C8.5001 1.99023 8.2763 2.21385 8.0001 2.21385C7.75468 2.21385 7.55054 2.03717 7.5082 1.80417L7.50014 1.71439V0.499461C7.50014 0.223619 7.724 0 8.0001 0Z"})),$C=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M15.2353 0.76375C14.2155 -0.254592 12.5621 -0.254582 11.5424 0.76377L10.5071 1.79773L10.1574 1.44848C9.57382 0.865754 8.62779 0.865754 8.04425 1.44848L7.4607 2.0312C6.87718 2.61393 6.87717 3.55871 7.4607 4.14144L7.81043 4.49069L1.48156 10.8109C1.20135 11.0907 1.04392 11.4703 1.04392 11.8661V12.3649L0.0831169 14.6114C-0.271229 15.4399 0.571603 16.2745 1.3982 15.9136L3.63826 14.9357H4.11779C4.51407 14.9357 4.89413 14.7785 5.17435 14.4986L11.5032 8.17842L11.8552 8.52998C12.4387 9.11262 13.3847 9.11262 13.9683 8.52998L14.5518 7.94721C15.1354 7.36448 15.1354 6.41969 14.5518 5.83697L14.1999 5.48547L15.2353 4.45148C16.2549 3.43314 16.2549 1.78209 15.2353 0.76375ZM8.51483 5.19411L10.7989 7.47503L4.46997 13.7952C4.37657 13.8885 4.24989 13.941 4.11779 13.941H3.53415C3.46549 13.941 3.39756 13.9551 3.33465 13.9825L0.999194 15.0021L2.00003 12.6621C2.02644 12.6003 2.04006 12.5338 2.04006 12.4667V11.8661C2.04006 11.7341 2.09253 11.6076 2.18594 11.5143L8.51483 5.19411Z"})),eO=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M9.9462 0.239097C11.3059 0.578692 12.5937 1.28004 13.6569 2.34315C16.781 5.46734 16.781 10.5327 13.6569 13.6569C10.5327 16.7811 5.46734 16.7811 2.34314 13.6569C-0.781049 10.5327 -0.781048 5.46734 2.34315 2.34315C3.98115 0.705139 6.15275 -0.074067 8.29843 0.00553347C8.39082 0.00896099 8.48317 0.0139849 8.57543 0.0205977C9.03652 0.0536426 9.49532 0.126492 9.9462 0.239097ZM12.9497 12.9498C15.6834 10.2161 15.6834 5.78393 12.9497 3.05026C12.6157 2.71617 12.2562 2.42292 11.8776 2.17049L12.3536 2.64645C12.5488 2.84171 12.5488 3.15829 12.3536 3.35356C12.1583 3.54882 11.8417 3.54882 11.6464 3.35355L9.44226 1.14937C8.87302 1.03008 8.29181 0.982245 7.71296 1.00585L9.35355 2.64645C9.54881 2.84171 9.54881 3.15829 9.35355 3.35355C9.15829 3.54882 8.84171 3.54882 8.64645 3.35355L6.46284 1.16994C6.05435 1.26147 5.65247 1.38997 5.26255 1.55544L7.35355 3.64645C7.54882 3.84171 7.54882 4.15829 7.35355 4.35356C7.15829 4.54882 6.84171 4.54882 6.64645 4.35355L4.33014 2.03725C4.01204 2.2334 3.70624 2.45737 3.41621 2.70915L5.35354 4.64645C5.54881 4.84171 5.54881 5.15829 5.35355 5.35355C5.15829 5.54882 4.84171 5.54882 4.64644 5.35356L2.70911 3.41626C2.45734 3.70627 2.23338 4.01206 2.03725 4.33014L4.35355 6.64645C4.54882 6.84171 4.54882 7.15829 4.35355 7.35356C4.15829 7.54882 3.84171 7.54882 3.64645 7.35356L1.55544 5.26255C1.38997 5.65247 1.26147 6.05435 1.16994 6.46284L3.35355 8.64645C3.54882 8.84171 3.54882 9.15829 3.35355 9.35356C3.15829 9.54882 2.84171 9.54882 2.64645 9.35356L1.00585 7.71296C0.982241 8.29181 1.03008 8.87302 1.14936 9.44226L3.35355 11.6464C3.54882 11.8417 3.54882 12.1583 3.35355 12.3536C3.15829 12.5488 2.84171 12.5488 2.64645 12.3536L2.17048 11.8776C2.42291 12.2562 2.71617 12.6157 3.05025 12.9498C5.78392 15.6834 10.2161 15.6834 12.9497 12.9498Z"})),tO=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M9.5001 10.0001C9.2239 10.0001 9.0001 10.224 9.0001 10.5001C9.0001 10.7762 9.2239 11.0001 9.5001 11.0001H12.5001C12.7762 11.0001 13.0001 10.7762 13.0001 10.5001C13.0001 10.224 12.7762 10.0001 12.5001 10.0001H9.5001ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM8 15C6.247 15 4.6445 14.3556 3.41645 13.2908L13.2908 3.41645C14.3556 4.6445 15 6.247 15 8C15 11.866 11.866 15 8 15ZM3.50003 5.00005C3.50003 4.7239 3.72389 4.50004 4.00004 4.50004H5.00005V3.50003C5.00005 3.22389 5.22391 3.00003 5.50005 3.00003C5.7762 3.00003 6.00006 3.22389 6.00006 3.50003V4.50004H7.00006C7.27621 4.50004 7.50007 4.7239 7.50007 5.00005C7.50007 5.27619 7.27621 5.50005 7.00006 5.50005H6.00006V6.50006C6.00006 6.7762 5.7762 7.00006 5.50005 7.00006C5.22391 7.00006 5.00005 6.7762 5.00005 6.50006V5.50005H4.00004C3.72389 5.50005 3.50003 5.27619 3.50003 5.00005Z"})),nO=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M16 8C16 3.58172 12.4183 -1.56562e-07 8 -3.49691e-07C3.5817 -5.42821e-07 -1.56562e-07 3.58172 -3.49691e-07 8C-5.42821e-07 12.4183 3.5817 16 8 16C12.4183 16 16 12.4183 16 8ZM15 8C15 11.6979 12.1326 14.726 8.5 14.9824L8.5 1.01758C12.1326 1.27396 15 4.30212 15 8Z"})),aO=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M7.64645 0.146453C7.84171 -0.0488175 8.1583 -0.0488175 8.3536 0.146453C8.8853 0.678212 10.1584 2.20981 11.2998 4.04882C12.4297 5.86917 13.5 8.0985 13.5 10C13.5 11.8438 12.972 13.3521 11.9905 14.4037C11.0058 15.4587 9.6148 16 8 16C6.38524 16 4.99415 15.4587 4.00947 14.4037C3.02801 13.3521 2.5 11.8438 2.5 10C2.5 8.0985 3.5703 5.86917 4.70018 4.04882C5.84163 2.20981 7.11469 0.678212 7.64645 0.146453Z"})),iO=c.a.createElement("svg",{viewBox:"0 0 20 20"},c.a.createElement("path",{d:"M2.5 0C1.11929 0 0 1.11929 0 2.5V17.5C0 18.8807 1.11929 20 2.5 20H17.5C18.8807 20 20 18.8807 20 17.5V2.5C20 1.11929 18.8807 0 17.5 0H2.5ZM10 18.5C5.30558 18.5 1.5 14.6944 1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5Z"})),rO=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M2.34315 2.34315C5.46734 -0.781049 10.5327 -0.781049 13.6569 2.34315C14.72 3.40625 15.4213 4.69413 15.7609 6.0538L13.3536 3.64645C13.1583 3.45118 12.8417 3.45118 12.6464 3.64645C12.4512 3.84171 12.4512 4.15829 12.6464 4.35355L15.9945 7.70157C16.0131 8.20286 15.9848 8.70555 15.9096 9.20253L13.3536 6.64645C13.1583 6.45118 12.8417 6.45118 12.6464 6.64645C12.4512 6.84171 12.4512 7.15829 12.6464 7.35355L15.6474 10.3545C15.5283 10.7423 15.3791 11.123 15.1997 11.4926L12.3536 8.64645C12.1583 8.45119 11.8417 8.45119 11.6464 8.64645C11.4512 8.84171 11.4512 9.15829 11.6464 9.35355L14.6871 12.3942C14.4819 12.7056 14.2528 13.0059 13.9996 13.2924L11.3536 10.6464C11.1583 10.4512 10.8417 10.4512 10.6465 10.6465C10.4512 10.8417 10.4512 11.1583 10.6465 11.3536L13.2925 13.9995C13.006 14.2527 12.7057 14.4819 12.3942 14.6871L9.35355 11.6464C9.15829 11.4512 8.84171 11.4512 8.64645 11.6464C8.45118 11.8417 8.45118 12.1583 8.64645 12.3536L11.4926 15.1997C11.123 15.3791 10.7424 15.5283 10.3545 15.6474L7.35355 12.6464C7.15829 12.4512 6.84171 12.4512 6.64645 12.6464C6.45118 12.8417 6.45118 13.1583 6.64645 13.3536L9.20253 15.9096C8.70555 15.9848 8.20286 16.0131 7.70157 15.9945L4.35355 12.6464C4.15829 12.4512 3.84171 12.4512 3.64645 12.6464C3.45118 12.8417 3.45118 13.1583 3.64645 13.3536L6.0538 15.7609C4.69413 15.4213 3.40625 14.72 2.34315 13.6569C-0.781049 10.5327 -0.781049 5.46734 2.34315 2.34315Z"})),oO=c.a.createElement("svg",{viewBox:"0 0 16 16"},c.a.createElement("path",{d:"M8.5 5C8.5 4.72386 8.2761 4.5 8 4.5C7.72386 4.5 7.5 4.72386 7.5 5V10.063C6.63739 10.285 6 11.0681 6 12C6 13.1046 6.89543 14 8 14C9.1046 14 10 13.1046 10 12C10 11.0681 9.3626 10.285 8.5 10.063V5Z"}),c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 3C5 1.34315 6.34315 0 8 0C9.6569 0 11 1.34315 11 3L10.9999 9.3541C11.6219 10.0589 12 10.9857 12 12C12 14.2091 10.2091 16 8 16C5.79086 16 4 14.2091 4 12C4 10.9857 4.37808 10.0589 5.00008 9.3541L5 3ZM10 3C10 1.89543 9.1046 1 8 1C6.89543 1 6 1.89543 6 3L6.00008 9.7546L5.85719 9.9004C5.32642 10.442 5 11.1824 5 12C5 13.6568 6.34315 15 8 15C9.6569 15 11 13.6568 11 12C11 11.1824 10.6736 10.442 10.1428 9.9004L9.9999 9.7546L10 3Z"})),sO=c.a.createElement("svg",{viewBox:"0 0 17 17"},c.a.createElement("path",{d:"M0.772726 15.197C0.500211 15.197 0.247849 15.0534 0.108562 14.8192C-0.0307244 14.585 -0.0363398 14.2947 0.0937875 14.0552L6.53315 2.2068C6.70191 1.89625 7.05994 1.73979 7.40252 1.82687C7.74499 1.91395 7.98485 2.22234 7.98485 2.57578V14.4243C7.98485 14.851 7.63887 15.197 7.21212 15.197H0.772726Z"}),c.a.createElement("path",{d:"M16.8914 14.8192C16.7521 15.0534 16.4998 15.197 16.2273 15.197H9.78786C9.36111 15.197 9.01514 14.851 9.01514 14.4243V2.57578C9.01514 2.22234 9.25499 1.91395 9.59746 1.82687C9.94004 1.73979 10.2981 1.89625 10.4668 2.2068L16.9062 14.0552C17.0364 14.2947 17.0307 14.585 16.8914 14.8192ZM10.5606 5.61584V13.6516H14.9278L10.5606 5.61584Z"})),cO=c.a.createElement("svg",{viewBox:"0 0 17 17"},c.a.createElement("path",{d:"M14.8192 0.108562C15.0534 0.247849 15.197 0.500211 15.197 0.772726V7.21212C15.197 7.63887 14.851 7.98485 14.4243 7.98485H2.57578C2.22234 7.98485 1.91395 7.74499 1.82687 7.40252C1.73979 7.05994 1.89625 6.70191 2.2068 6.53315L14.0552 0.0937875C14.2947 -0.0363398 14.585 -0.0307244 14.8192 0.108562ZM5.61584 6.43939H13.6516V2.07217L5.61584 6.43939Z"}),c.a.createElement("path",{d:"M15.197 16.2273C15.197 16.4998 15.0534 16.7521 14.8192 16.8914C14.585 17.0307 14.2947 17.0364 14.0552 16.9062L2.2068 10.4668C1.89625 10.2981 1.73979 9.94004 1.82687 9.59746C1.91395 9.25499 2.22234 9.01514 2.57578 9.01514H14.4243C14.851 9.01514 15.197 9.36111 15.197 9.78786V16.2273Z"})),dO=c.a.createElement("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.38561 17.6144C2.69008 16.4943 0 13.0613 0 9C0 4.02944 4.02944 0 9 0C13.0613 0 16.4943 2.69008 17.6144 6.38561C21.3099 7.5057 24 10.9387 24 15C24 19.9706 19.9706 24 15 24C10.9387 24 7.5057 21.3099 6.38561 17.6144ZM6.04394 15.895C6.01488 15.6006 6 15.302 6 15C6 10.0294 10.0294 6 15 6C15.302 6 15.6006 6.01488 15.895 6.04394C14.7478 3.37164 12.0925 1.5 9 1.5C4.85786 1.5 1.5 4.85786 1.5 9C1.5 12.0925 3.37164 14.7478 6.04394 15.895ZM17.9561 8.10504C17.9571 8.11555 17.9581 8.12606 17.9591 8.13658C17.9862 8.42074 18 8.70876 18 9C18 13.9706 13.9706 18 9 18C8.69798 18 8.39942 17.9851 8.10504 17.9561C9.25223 20.6284 11.9075 22.5 15 22.5C19.1421 22.5 22.5 19.1421 22.5 15C22.5 11.9075 20.6284 9.25223 17.9561 8.10504Z"})),lO=c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M345 1792q-69 0-131-28t-110-75-76-110-28-132V601q0-69 28-131t75-110 110-76 132-28h1358q69 0 131 28t110 75 76 110 28 132v846q0 69-28 131t-75 110-110 76-132 28H345zm1351-128q46 0 87-17t71-48 48-72 18-87V608q0-46-17-87t-48-71-72-48-87-18H352q-46 0-87 17t-71 48-48 72-18 87v832q0 46 17 87t48 71 72 48 87 18h1344zM512 808q-15 8-31 16t-33 8q-26 0-45-19t-19-45q0-17 9-33t26-24l128-64q14-7 29-7 27 0 45 18t19 46v640q0 26-19 45t-45 19q-26 0-45-19t-19-45V808zm896 0q-15 8-31 16t-33 8q-26 0-45-19t-19-45q0-17 9-33t26-24l128-64q14-7 29-7 27 0 45 18t19 46v640q0 26-19 45t-45 19q-26 0-45-19t-19-45V808zm-512 24q0-26 19-45t45-19q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45zm0 384q0-26 19-45t45-19q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45z"})),uO=c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M251 1792q-50 0-95-20t-80-55-55-80-21-96V507q0-50 20-95t55-80 80-55 96-21h1546q50 0 95 20t80 55 55 80 21 96v1034q0 50-20 95t-55 80-80 55-96 21H251zm1541-128q27 0 50-10t40-27 28-41 10-50V512q0-26-10-49t-27-41-41-28-50-10H256q-27 0-50 10t-40 27-28 41-10 50v1024q0 27 10 50t27 41 40 27 51 10h1536zM256 832V704q0-39 15-74t41-61 62-42 74-15h128q26 0 45 19t19 45q0 26-19 45t-45 19H448q-21 0-34 7t-20 21-9 31-2 37q0 16 1 32t1 32q0 20-2 37t-9 30-20 21-34 8q-26 0-45-19t-19-45zm1152-256q0-26 19-45t45-19h128q39 0 74 15t61 41 42 62 15 74v128q0 26-19 45t-45 19q-26 0-45-19t-19-45V704q0-21-7-34t-21-19-31-9-37-3q-16 0-32 1t-32 1q-20 0-37-2t-30-9-21-20-8-34zm-960 960q-39 0-74-15t-61-41-42-62-15-74v-128q0-26 19-45t45-19q26 0 45 19t19 45v128q0 21 7 34t21 20 31 9 37 2q16 0 32-1t32-1q19 0 36 2t31 9 21 20 8 34q0 26-19 45t-45 19H448zm1024 0q-26 0-45-19t-19-45q0-26 19-45t45-19h128q21 0 34-7t19-21 9-31 3-37q0-16-1-32t-1-32q0-19 2-36t9-31 20-21 34-8q26 0 45 19t19 45v128q0 39-15 74t-41 61-62 42-74 15h-128z"})),fO=c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M640 1755L19 1133l90-90 531 530L1939 275l90 90L640 1755z"})),pO=c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M2048 1088H250l787 787-90 90L6 1024 947 83l90 90-787 787h1798v128z"})),mO=c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M2042 1024l-941 941-90-90 787-787H0V960h1798l-787-787 90-90 941 941z"})),_O=c.a.createElement("svg",{width:"20",height:"20",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M10.7481 1.00122L18.3019 1.00173L18.4021 1.01565L18.5009 1.04325L18.562 1.06918C18.6411 1.10407 18.715 1.1546 18.7799 1.21953L18.8206 1.26357L18.8812 1.34505L18.9183 1.41008L18.957 1.50039L18.9762 1.56452L18.9898 1.62846L18.9991 1.72165L18.9996 9.25511C18.9996 9.66933 18.6638 10.0051 18.2496 10.0051C17.8699 10.0051 17.5561 9.72296 17.5065 9.35688L17.4996 9.25511L17.4991 3.55922L3.55911 17.5042L9.24963 17.5051C9.62933 17.5051 9.94313 17.7873 9.99279 18.1533L9.99963 18.2551C9.99963 18.6348 9.71748 18.9486 9.35141 18.9983L9.24963 19.0051L1.71378 19.0043L1.68479 19.0015C1.61873 18.9969 1.55602 18.983 1.49674 18.9619L1.40661 18.923L1.38942 18.9125C1.18522 18.8021 1.03877 18.5991 1.00535 18.3597L0.998108 18.2551V10.7512C0.998108 10.337 1.33389 10.0012 1.74811 10.0012C2.1278 10.0012 2.4416 10.2834 2.49126 10.6495L2.49811 10.7512V16.4432L16.4381 2.50022L10.7481 2.50122C10.3684 2.50122 10.0546 2.21907 10.005 1.85299L9.99811 1.75122C9.99811 1.37152 10.2803 1.05773 10.6463 1.00807L10.7481 1.00122Z"})),hO=c.a.createElement("svg",{viewBox:"0 0 14 24",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M6.04545 3.50454V20.4955L1.64659 15.6446C1.2835 15.2442 0.67931 15.2279 0.297105 15.6083C-0.0851011 15.9887 -0.100593 16.6217 0.262502 17.0221L6.30795 23.6887C6.48817 23.8875 6.73835 24 7 24C7.26165 24 7.51183 23.8875 7.69204 23.6887L13.7375 17.0221C14.1006 16.6217 14.0851 15.9887 13.7029 15.6083C13.3207 15.2279 12.7165 15.2442 12.3534 15.6446L7.95454 20.4955V3.50454L12.3534 8.35542C12.7165 8.75582 13.3207 8.77205 13.7029 8.39167C14.0851 8.01128 14.1006 7.37832 13.7375 6.97792L7.69346 0.31281C7.51947 0.120177 7.27313 0 7 0C6.72687 0 6.48053 0.120177 6.30654 0.31281L0.262502 6.97792C-0.100593 7.37832 -0.0851011 8.01128 0.297105 8.39167C0.67931 8.77205 1.2835 8.75582 1.64659 8.35542L6.04545 3.50454Z"})),bO=c.a.createElement("svg",{viewBox:"0 0 8 9",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M4 9C3.72386 9 3.5 8.77614 3.5 8.5L3.5 1.70711L0.853554 4.35355C0.658292 4.54882 0.341709 4.54882 0.146447 4.35355C-0.0488153 4.15829 -0.0488153 3.84171 0.146447 3.64645L3.64645 0.146446C3.84171 -0.0488161 4.15829 -0.0488161 4.35355 0.146446L7.85355 3.64645C8.04882 3.84171 8.04882 4.15829 7.85355 4.35355C7.65829 4.54882 7.34171 4.54882 7.14645 4.35355L4.5 1.70711L4.5 8.5C4.5 8.77614 4.27614 9 4 9Z"})),gO=c.a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"m6.907 6.68 2.734-2.73a6.66 6.66 0 1 1 9.42 9.42l-8.338 8.338a1 1 0 0 1-1.415-1.415l8.339-8.336A4.66 4.66 0 0 0 11.229 5.2l-.174.166-3.641 3.633H12a1 1 0 0 1 .993.884L13 10a1 1 0 0 1-.883.993l-.117.006-7.06-.001-.095-.01-.112-.024-.131-.047-.082-.04-.102-.064a.996.996 0 0 1-.125-.107l-.092-.105-.074-.114-.046-.093-.038-.105-.016-.058-.016-.081-.007-.062L4 10V3.002a1 1 0 0 1 1.993-.116L6 3.002v4.584l3.641-3.635L6.907 6.68Z"})),vO=c.a.createElement("svg",{width:"16",height:"16",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M18 7.586 14.36 3.951a6.66 6.66 0 1 0-9.42 9.42l8.339 8.337a1 1 0 0 0 1.414-1.415l-8.339-8.336A4.66 4.66 0 0 1 12.771 5.2l.174.166 3.64 3.633H12a1 1 0 0 0-.993.884L11 10a1 1 0 0 0 .883.993l.117.006h7a1 1 0 0 0 .993-.883L20 10V3.002a1 1 0 0 0-1.993-.116L18 3.002v4.584L14.36 3.951 18 7.586Z"})),yO=c.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M960 640q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45q0-26 19-45t45-19zm0 512q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45q0-26 19-45t45-19zM704 896q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45q0-26 19-45t45-19zm256 0q26 0 45 19t19 45q0 26-19 45t-45 19q-26 0-45-19t-19-45q0-26 19-45t45-19zm320 64q0 26-19 45t-45 19q-26 0-45-19t-19-45q0-26 19-45t45-19q26 0 45 19t19 45zm640 512q0 93-35 174t-96 142-142 96-175 36q-89 0-171-34t-146-97l-195-195-195 195q-63 63-145 97t-172 34q-93 0-174-35t-143-96-96-142-35-175q0-90 34-172t97-145l195-195-195-195q-63-63-97-145T0 448q0-93 35-174t96-142 142-96T448 0q89 0 171 34t146 97l195 195 195-195q63-63 145-97t172-34q93 0 174 35t143 96 96 142 35 175q0 90-34 172t-97 145l-195 195 195 195q63 63 97 145t34 172zM1050 417l453 453 195-196q46-47 70-103t24-123q0-66-25-124t-68-102-102-69-125-25q-66 0-122 24t-104 70l-196 195zM417 870l453-453-196-195q-47-46-103-70t-123-24q-66 0-124 25t-102 68-69 102-25 125q0 66 24 122t70 104l195 196zm453 633l-453-453-195 196q-46 47-70 103t-24 123q0 66 25 124t68 102 102 69 125 25q66 0 122-24t104-70l196-195zM507 960l453 453 453-453-453-453-453 453zm1285 512q0-66-24-122t-70-104l-195-196-453 453 196 195q47 46 103 70t123 24q66 0 124-25t102-68 69-102 25-125z"})),SO=c.a.createElement("svg",{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M192 64h6l389 35q50 5 120 11t154 16 175 21 185 25 184 30 169 34 145 37 107 42q17 9 34 20t30 25 22 32 8 39q0 29-14 52t-38 40q-34 26-98 48t-143 42-166 36-169 28-151 22-112 15q-55 7-124 16t-142 20-140 27-120 35l-2 1q39 14 91 26t112 23 121 18 123 16 116 12 98 9q38 3 93 9t118 14 129 19 127 26 109 31 80 37q23 16 39 37t16 50q0 29-16 51t-39 37q-28 19-74 34t-103 29-117 23-119 19-108 14-83 10q-59 7-129 16t-143 23-140 32-124 42l-20 10q-14 7-30 16t-26 19-12 20q0 5 4 12t10 14 11 13 9 9q27 26 71 52t94 49 99 41 85 30l337 104q20 6 33 23t13 39q0 26-19 44t-45 19q-7 0-33-7t-62-18-77-24-79-25-67-21-41-13q-34-10-82-27t-101-41-103-53-92-64-66-73-26-83q0-43 25-78t68-65 99-51 118-39 125-29 121-20 105-14 76-9q59-7 124-14t131-18 130-24 120-34q-61-22-131-37t-142-27-144-18-137-14q-42-3-106-9t-139-15-154-21-150-27-129-33-90-41q-22-15-36-36t-15-49q0-32 18-54t44-38q30-18 78-34t105-29 119-24 121-21 110-15 86-12q80-10 181-23t205-31 202-42 172-58l-5-2q-61-28-154-52t-202-44-228-38-231-30-210-23-168-16l-389-35q-25-2-41-21t-17-43q0-27 19-45t45-19z"})),DO=c.a.createElement("svg",{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M1728 1152q-26 0-45 19t-19 45v613l-147-146q-19-19-45-19t-45 19-19 45q0 26 19 45l256 256q19 19 45 19t45-19l256-256q19-19 19-45t-19-45-45-19q-26 0-45 19l-147 146v-613q0-26-19-45t-45-19zM192 64h6l389 35q50 5 120 11t154 16 175 21 185 25 184 30 169 34 145 37 107 42q17 9 34 20t30 25 22 32 8 39q0 29-14 52t-38 40q-34 26-97 48t-143 42-166 36-170 28-151 22-112 15q-55 7-124 16t-142 20-140 27-120 35l-2 1q48 17 99 27t102 20q105 18 210 30t211 22 211 23 210 32q58 11 117 25t113 38q-23-6-46-6-46 0-87 20t-69 59q-105-20-209-35t-212-24q-43-4-107-10t-138-15-154-20-150-27-129-33-90-41q-22-14-36-36t-15-49q0-32 18-54t44-38q31-18 79-34t105-29 118-24 120-21 110-15 87-12q80-10 181-23t205-31 202-42 172-58l-5-2q-61-28-153-52t-202-44-228-38-231-30-211-23-168-16l-389-35q-25-2-41-21t-17-43q0-27 19-45t45-19zm1344 1248q-81 14-161 24t-161 21q-30 4-81 10t-114 17-128 23-125 31-104 38-65 46l-4 6q-2 3-3 7 0 5 4 12t10 14 11 13 9 9q27 26 71 52t94 49 99 41 85 30l337 104q20 6 33 23t13 39q0 26-19 44t-45 19q-7 0-33-7t-62-18-77-24-79-25-67-21-41-13q-35-11-83-28t-100-41-103-53-93-63-66-74-25-82q0-58 44-102t113-76 155-55 167-36 151-23 107-13q85-10 169-21t170-28q-6 32-5 65t2 66z"})),IO=c.a.createElement("svg",{width:"20",height:"20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 2048 2048"},c.a.createElement("path",{d:"M192 64h6l389 35q49 5 119 11t154 16 176 21 186 26 184 29 169 34 144 37 107 42q17 9 34 20t30 25 22 31 8 40q0 29-14 52t-38 40q-34 26-97 48t-143 42-166 36-170 28-151 22-112 15q-55 7-124 16t-142 20-140 27-120 35l-2 1q48 17 99 27t102 20q94 17 189 28t191 20 190 20 191 25l-113 113q-54-7-135-15t-175-17-193-22-188-28-162-38-114-48q-21-14-36-36t-15-49q0-32 18-54t44-38q31-18 79-34t105-29 118-24 120-21 110-15 87-12q80-10 181-23t205-31 202-42 172-58l-5-2q-60-28-152-52t-202-44-228-38-231-30-212-23-168-16l-389-35q-25-2-41-21t-17-43q0-27 19-45t45-19zm1088 1156q2 70 48 123-36 5-98 12t-135 18-152 24-148 32-122 42-76 51l-4 6q-2 3-3 7 0 5 4 12t10 14 11 13 9 9q27 26 71 52t94 49 99 41 85 30l337 104q20 6 33 23t13 39q0 26-19 44t-45 19q-7 0-33-7t-62-18-77-24-79-25-67-21-41-13q-34-10-82-27t-101-41-103-53-92-64-66-73-26-83q0-47 28-84t77-67 111-52 133-39 139-28 134-20 114-14 81-11zm448-324q26 0 45 19l256 256q19 19 19 45t-19 45-45 19q-26 0-45-19l-147-146v714l147-146q19-19 45-19t45 19 19 45q0 26-19 45l-256 256q-19 19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19q26 0 45 19l147 146v-714l-147 146q-19 19-45 19t-45-19-19-45q0-26 19-45l256-256q19-19 45-19z"})),xO=c.a.createElement("svg",{width:"14",height:"15",viewBox:"0 0 14 15",xmlns:"http://www.w3.org/2000/svg"},c.a.createElement("path",{d:"M0.5 14.3242C0.364583 14.3242 0.247396 14.2747 0.148438 14.1758C0.0494792 14.0768 0 13.9596 0 13.8242C0 13.6888 0.0494792 13.5716 0.148438 13.4727C0.247396 13.3737 0.364583 13.3242 0.5 13.3242H4.24219C4.38281 13.3242 4.51302 13.2982 4.63281 13.2461C4.7526 13.194 4.85677 13.1237 4.94531 13.0352C5.03385 12.9466 5.10677 12.8398 5.16406 12.7148C5.22135 12.5898 5.2474 12.457 5.24219 12.3164C5.24219 12.0768 5.16146 11.8633 5 11.6758L3.24219 9.62891C3.08594 9.44661 2.96615 9.24609 2.88281 9.02734C2.79948 8.80859 2.75781 8.57682 2.75781 8.33203C2.75781 8.1862 2.77344 8.04297 2.80469 7.90234C2.83594 7.76172 2.88281 7.6237 2.94531 7.48828C3.11198 7.12891 3.35677 6.84505 3.67969 6.63672C4.0026 6.42839 4.36198 6.32422 4.75781 6.32422H8.69531C8.83594 6.32422 8.96615 6.29818 9.08594 6.24609C9.20573 6.19401 9.3125 6.1237 9.40625 6.03516C9.5 5.94661 9.57292 5.83984 9.625 5.71484C9.67708 5.58984 9.70312 5.45964 9.70312 5.32422C9.70312 5.17839 9.66927 5.03255 9.60156 4.88672C9.53385 4.74089 9.44792 4.59505 9.34375 4.44922C9.23958 4.30339 9.1276 4.14974 9.00781 3.98828C8.88802 3.82682 8.77604 3.66016 8.67188 3.48828C8.56771 3.31641 8.48177 3.13411 8.41406 2.94141C8.34635 2.7487 8.3099 2.54297 8.30469 2.32422C8.30469 2.04297 8.35677 1.78255 8.46094 1.54297C8.5651 1.30339 8.70573 1.09245 8.88281 0.910156C9.0599 0.727865 9.27083 0.584635 9.51562 0.480469C9.76042 0.376302 10.0234 0.324219 10.3047 0.324219H13C13.1354 0.324219 13.2526 0.373698 13.3516 0.472656C13.4505 0.571615 13.5 0.688802 13.5 0.824219C13.5 0.959635 13.4505 1.07682 13.3516 1.17578C13.2526 1.27474 13.1354 1.32422 13 1.32422H10.3047C10.1693 1.32422 10.0417 1.35026 9.92188 1.40234C9.80208 1.45443 9.69531 1.52474 9.60156 1.61328C9.50781 1.70182 9.4349 1.80859 9.38281 1.93359C9.33073 2.05859 9.30208 2.1888 9.29688 2.32422C9.29688 2.47005 9.33073 2.61589 9.39844 2.76172C9.46615 2.90755 9.55469 3.05599 9.66406 3.20703C9.77344 3.35807 9.88542 3.51172 10 3.66797C10.1146 3.82422 10.2266 3.99089 10.3359 4.16797C10.4453 4.34505 10.5312 4.52734 10.5938 4.71484C10.6562 4.90234 10.6927 5.10547 10.7031 5.32422C10.7031 5.65755 10.6224 5.97266 10.4609 6.26953C10.2839 6.59766 10.0391 6.85547 9.72656 7.04297C9.41406 7.23047 9.07031 7.32422 8.69531 7.32422H4.75781C4.61719 7.32422 4.48698 7.35026 4.36719 7.40234C4.2474 7.45443 4.14323 7.52474 4.05469 7.61328C3.96615 7.70182 3.89323 7.80859 3.83594 7.93359C3.77865 8.05859 3.7526 8.1888 3.75781 8.32422C3.75781 8.56901 3.83854 8.78516 4 8.97266L5.75781 11.0195C5.91406 11.2018 6.03385 11.4023 6.11719 11.6211C6.20052 11.8398 6.24219 12.0716 6.24219 12.3164C6.24219 12.5924 6.1901 12.8529 6.08594 13.0977C5.98177 13.3424 5.84115 13.556 5.66406 13.7383C5.48698 13.9206 5.27604 14.0638 5.03125 14.168C4.78646 14.2721 4.52344 14.3242 4.24219 14.3242H0.5Z"})),CO=!1;function OO(){var e;CO||(Object(u.registerIcons)({icons:(e={},e["OneByTwoAspect-Havana"]=NC,e["TwoByOneAspect-Havana"]=BC,e["TwoByThreeAspect-Havana"]=jC,e["ThreeByTwoAspect-Havana"]=VC,e["ThreeByFourAspect-Havana"]=zC,e["FourByThreeAspect-Havana"]=GC,e["FourByFiveAspect-Havana"]=KC,e["FiveByFourAspect-Havana"]=WC,e["NineBySixteenAspect-Havana"]=qC,e["SixteenByNineAspect-Havana"]=QC,e["FreeformAspect-Havana"]=JC,e["OriginalAspect-Havana"]=XC,e["SquareAspect-Havana"]=YC,e["Brightness-Havana"]=ZC,e["Highlights-Havana"]=eO,e["Exposure-Havana"]=tO,e["Contrast-Havana"]=nO,e["Saturation-Havana"]=$C,e["Shadows-Havana"]=rO,e["Tint-Havana"]=aO,e["Vignette-Havana"]=iO,e["Temperature-Havana"]=oO,e["FlipHorizontal-Havana"]=sO,e["FlipVertical-Havana"]=cO,e["ImageFilter-Havana"]=dO,e["FitPageRoundedEdge-Havana"]=uO,e["ActualSizeRoundedEdge-Havana"]=lO,e["ActiveFilterCheckmark-Havana"]=fO,e["Back-Havana"]=pO,e["Forward-Havana"]=mO,e["ArrowMaximize-Havana"]=_O,e["SmallArrowMaximize-Havana"]=hO,e["SmallSingleArrow-Havana"]=bO,e["freehandNoArrowIcon-Havana"]=SO,e["freehandSingleArrowIcon-Havana"]=DO,e["freehandDoubleArrowIcon-Havana"]=IO,e["lineStyleIcon-Havana"]=xO,e["UndoIcon-Havana"]=gO,e["RedoIcon-Havana"]=vO,e["RetouchIcon-Havana"]=yO,e)}),CO=!0)}var wO={position:"absolute",top:-1,width:1,height:1,margin:-1,padding:0,border:0,overflow:"hidden"},EO=c.a.memo(function(e){var t=e.message;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{role:"status","aria-live":"assertive","aria-atomic":"true",style:wO},t))}),AO=c.a.memo(function(e){var t=e.cropWidth,n=e.cropHeight,a=e.aspectRatio,i=e.cropTopLeftCornerFromImageOrigin,r=e.panViewTopLeftCornerFromCropOrigin,o=e.currentZoom,d=e.ariaAnnouncementScenario,l=e.ariaAnnouncementMessage,u=e.setAriaAnnouncement,f=e.setAriaAnnouncementScenario;return function(e,t,n,a,i,r){var o=Lp(n,a,i);Object(s.useEffect)(function(){"CropImageDimension"===(null==r?void 0:r.type)&&(r.cropDimension.width===n&&r.cropDimension.height===a||e(o),t(void 0))},[o,n,a,i,e,t,r])}(u,f,t,n,a,d),function(e,t,n,a){var i=Object(s.useContext)(Ze).strings;Object(s.useEffect)(function(){if("CropImageMove"===(null==a?void 0:a.type)){var r=Ra(n,a.cropTopLeftCornerFromImageOrigin),o=n.x.toString(),s=n.y.toString();e(vt(r?i.crop_rectangleCannotMoveInCurrentDirectionAriaLive:i.crop_rectanglePositionAriaLive,o,s)),t(void 0)}},[a,n,e,t,i])}(u,f,i,d),function(e,t,n,a){var i=Object(s.useContext)(Ze).strings;Object(s.useEffect)(function(){if("Zoom"===(null==a?void 0:a.type)){var r=Math.round(100*a.zoom),o=Math.round(100*n);if(r!==o){var s=vt(i.editor_zoomPercentAriaLive,o.toString());e(s)}t(void 0)}},[a,n,i,e,t])}(u,f,o,d),function(e,t,n,a){var i=Object(s.useContext)(Ze).strings;Object(s.useEffect)(function(){if("PanView"===(null==a?void 0:a.type)){var r=n.x.toString(),o=n.y.toString();e(vt(i.nonCrop_panViewPositionAriaLive,r,o)),t(void 0)}},[a,n,e,t,i])}(u,f,r,d),c.a.createElement(EO,{message:l})}),LO={setAriaAnnouncement:Jn,setAriaAnnouncementScenario:Xn},kO=Object(ee.connect)(function(e){var t=e.ariaAnnouncement,n=t.ariaAnnouncementScenario,a=t.ariaAnnouncementMessage,i=zy(e);return{cropWidth:rp(e),cropHeight:op(e),aspectRatio:Yo(e),cropTopLeftCornerFromImageOrigin:Wp(e),currentZoom:Kp(e),ariaAnnouncementScenario:n,ariaAnnouncementMessage:a,panViewTopLeftCornerFromCropOrigin:i}},LO)(AO),MO=function(e){var t=e.enableAdjustments,n=e.enableFilters,a=e.enableAutoEnhance,i=e.useBuiltInAutoEnhance,r=e.autoEnhanceInstallationInfo,o=e.enableMarkup,s=e.enableSpotFix,d=e.experimental_enableInPainting,l=e.experimental_enableMaskLayer,u=e.enableUndoRedo,f=e.children,p=e.enableMarkupText;return c.a.createElement(dh.Provider,{value:{enableAdjustments:!!t,enableFilters:!!n,enableAutoEnhance:!!a,useBuiltInAutoEnhance:!!i,autoEnhanceInstallationInfo:r||v_,enableMarkup:!!o,enableSpotFix:!!s,experimental_enableInPainting:!!d,experimental_enableMaskLayer:!!l,enableUndoRedo:!!u,enableMarkupText:!!p}},f)},PO=Object(ee.connect)(function(e){return{activeEditorActivity:e.uiState.activeEditorActivity,activeEditorActivityInputType:e.uiState.activeEditorActivityInputType}})(function(e){var t=e.activeEditorActivity,n=e.activeEditorActivityInputType,a=Object(s.useRef)(t),i=Object(s.useContext)(Zt).logEditorActivityEvent;return Object(s.useLayoutEffect)(function(){var e,r=window.requestAnimationFrame(function(){e=setTimeout(function(){var e=function(e){var t=performance.getEntriesByName(e);if(1===t.length){var n=performance.now()-t[0].startTime;return performance.clearMarks(e),n}performance.clearMarks(e)}(t);e&&i({editorActivityName:t,previousEditorActivityName:a.current,loadTimeInMs:e,inputType:n}),a.current=t})});return function(){clearTimeout(e),window.cancelAnimationFrame(r)}},[t,n,i]),c.a.createElement(c.a.Fragment,null)});function TO(e){return e.redoStack.length+e.undoStack.length}function UO(e,t){var n=[];e.forEach(function(e){n.push.apply(n,e)});var a=n.sort(function(e,t){return e.sequence-t.sequence}),i=a[a.length-1-(null!=t?t:0)];return{sequence:null==i?void 0:i.sequence,id:null==i?void 0:i.id,sequentialDuplicateAction:null==i?void 0:i.sequentialDuplicateAction}}var FO=function(){function e(){this.listeners=[]}return e.prototype.addListener=function(e){this.listeners.push(e)},e.prototype.removeListener=function(e){this.listeners.includes(e)&&(this.listeners=this.listeners.filter(function(t){return t!==e}))},e.prototype.notifyListeners=function(e){this.listeners.length>0&&this.listeners.forEach(function(t){return t(e)})},e}(),HO=function(){function e(e,t,n){this.stackOverrideDisableUndo=!1,this.stackOverrideDisableRedo=!1,this.maxStackSize=e,this.undoRedoStacks=[],this.undoRedoDispatcher=t,this.onChange=new FO,this.onUndoRedo=new FO,this.logUndoRedoEvent=n}return e.prototype.undo=function(){var e;if(!this.stackOverrideDisableUndo){var t=UO(this.undoRedoStacks.map(function(e){return e.undoStack}));t.sequence&&(this.undoRedoDispatcher.undo({timestamp:t.sequence,id:t.id}),this.onUndoRedo.notifyListeners({payloadId:t.id,actionType:"Undo"}),null===(e=this.logUndoRedoEvent)||void 0===e||e.call(this,{undoRedoItemId:t.id,actionType:"Undo",currentStackSize:this.totalStackSize()}))}},e.prototype.canUndo=function(){return!this.stackOverrideDisableUndo&&this.undoRedoStacks.some(function(e){return e.undoStack.length>0})},e.prototype.setDisableUndoOverride=function(e){this.stackOverrideDisableUndo=e,this.onChange.notifyListeners()},e.prototype.redo=function(){var e;if(!this.stackOverrideDisableRedo){var t=UO(this.undoRedoStacks.map(function(e){return e.redoStack}));t.sequence&&(this.undoRedoDispatcher.redo({timestamp:t.sequence,id:t.id}),this.onUndoRedo.notifyListeners({payloadId:t.id,actionType:"Redo"}),null===(e=this.logUndoRedoEvent)||void 0===e||e.call(this,{undoRedoItemId:t.id,actionType:"Redo",currentStackSize:this.totalStackSize()}))}},e.prototype.canRedo=function(){return!this.stackOverrideDisableRedo&&this.undoRedoStacks.some(function(e){return e.redoStack.length>0})},e.prototype.setDisableRedoOverride=function(e){this.stackOverrideDisableRedo=e,this.onChange.notifyListeners()},e.prototype.registerOrNotifyStackChanged=function(e){var t=this.getStackIndex(e.id);if(t>=0){var n=TO(this.undoRedoStacks[t])<TO(e);this.undoRedoStacks[t]=e,n&&this.undoRedoDispatcher.clearRedoStacks()}else this.undoRedoStacks.push(e);this.onChange.notifyListeners();var a=this.undoRedoStacks.map(function(e){return e.undoStack}),i=UO(a),r=UO(a,1),o=this.getDuplicateSequenceRange(i,r);o&&this.undoRedoDispatcher.collapseStackItems(o);var s=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([],this.verifyMaxSizeAndGetCleanupSequence(),!0);this.undoRedoDispatcher.removeStackItems(s),function(e){for(var t=e.length-1;t>0;t--)if(e[t].sequence<e[t-1].sequence)throw new Error("The undo redo stack contains sequences that are out of order")}(e.undoStack)},e.prototype.getStackIndex=function(e){return this.undoRedoStacks.findIndex(function(t){return t.id===e})},e.prototype.totalStackSize=function(){return this.undoRedoStacks.reduce(function(e,t){return TO(t)+e},0)},e.prototype.verifyMaxSizeAndGetCleanupSequence=function(){var e=[];if(this.totalStackSize()>=this.maxStackSize){for(var t=Km(this.undoRedoStacks[0].undoStack),n=0;n<=this.undoRedoStacks.length-2;n++){var a=Km(this.undoRedoStacks[n].undoStack),i=Km(this.undoRedoStacks[n+1].undoStack);t=a&&i?a.sequence<i.sequence?a:i:null!=a?a:i}t&&e.push(t.sequence)}return e},e.prototype.getDuplicateSequenceRange=function(e,t){if(e.sequence&&t.sequence&&e.id===t.id&&e.sequentialDuplicateAction===t.sequentialDuplicateAction)switch(e.sequentialDuplicateAction){case Le.KeepFirst:return{start:e.sequence,end:t.sequence};case Le.KeepLast:return{start:t.sequence,end:e.sequence};case Le.KeepAll:}},e}(),RO={undo:pe,redo:me,clearRedoStacks:he,removeStackItems:_e,collapseStackItems:be},NO=Object(ee.connect)(null,RO)(function(e){var t=e.undo,n=e.redo,a=e.clearRedoStacks,i=e.removeStackItems,r=e.collapseStackItems,o=e.children,d=Object(s.useContext)(Zt).logUndoRedoEvent,l=Object(s.useMemo)(function(){return new HO(100,{undo:t,redo:n,clearRedoStacks:a,removeStackItems:i,collapseStackItems:r},d)},[a,r,d,n,i,t]);return c.a.createElement(g0.Provider,{value:{combinedUndoRedoCoordinator:l}},o)}),BO=function(e){var t=e.undoRedoStack,n=e.disableUndoOverride,a=e.disableRedoOverride,i=Object(s.useContext)(g0).combinedUndoRedoCoordinator;return Object(s.useEffect)(function(){null==i||i.registerOrNotifyStackChanged(t),null==i||i.setDisableUndoOverride(n),null==i||i.setDisableRedoOverride(a)},[t,i,n,a]),null},jO=Object(ee.connect)(function(e){return{undoRedoStack:e.colorAdjustments.undoRedoStack,disableUndoOverride:e.colorAdjustments.disableUndoOverride,disableRedoOverride:e.colorAdjustments.disableRedoOverride}})(BO),VO=Object(ee.connect)(function(e){return{undoRedoStack:e.filters.undoRedoStack}})(BO),zO=Object(ee.connect)(function(e){return{undoRedoStack:e.autoEnhance.undoRedoStack}})(BO),GO=Object(ee.connect)(function(e){return{undoRedoStack:e.markup.undoRedoStack,disableUndoOverride:e.uiState.waitingForMarkupOverlayTexture,disableRedoOverride:e.uiState.waitingForMarkupOverlayTexture}})(BO),KO=Object(ee.connect)(function(e){return{undoRedoStack:e.transformTools.undoRedoStack}})(BO),WO=function(e){var t,n,a,i,r=e.htmlElementForKeyboardControl,o=Object(s.useContext)(dh).enableUndoRedo;return t=Object(s.useContext)(g0).combinedUndoRedoCoordinator,n=r,a=o,i=[{code:"KeyZ",keyCode:Uy.Z,handler:function(e){e&&(null==t||t.undo())},ctrlKey:!0,shiftKey:!1},{code:"KeyY",keyCode:Uy.Y,handler:function(e){e&&(null==t||t.redo())},ctrlKey:!0,shiftKey:!1}],My(n,a?i:[]),null},qO=Object(ee.connect)(function(e){return{undoRedoStack:e.texturePatch.undoRedoStack}})(BO);function QO(e,t,n){var a={};return e.forEach(function(e){var i;Object.assign(a,((i={})[t[e.key]]=vt(n,"{0}",e.locString),i))}),a}var YO=function(){return YO=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},YO.apply(this,arguments)},JO={setAriaAnnouncement:Jn},XO=Object(ee.connect)(null,JO)(function(e){var t=e.setAriaAnnouncement,n=Object(s.useContext)(g0).combinedUndoRedoCoordinator,a=Object(s.useContext)(Ze).strings,i=Object(s.useMemo)(function(){return function(e){var t;return YO(YO(YO({},function(e){return QO([{key:De.Brightness,locString:e.adjustment_brightness},{key:De.Contrast,locString:e.adjustment_contrast},{key:De.Exposure,locString:e.adjustment_exposure},{key:De.Highlights,locString:e.adjustment_highlights},{key:De.Saturation,locString:e.adjustment_saturation},{key:De.Shadows,locString:e.adjustment_shadows},{key:De.Temperature,locString:e.adjustment_temperature},{key:De.Tint,locString:e.adjustment_tint},{key:De.Vignette,locString:e.adjustment_vignette}],Ne,e.undoRedo_colorAdjustmentsAriaLive)}(e)),function(e){var t=[{key:"Original",locString:e.filter_nameOriginal},{key:"Punch",locString:e.filter_namePunch},{key:"Golden",locString:e.filter_nameGolden},{key:"Radiate",locString:e.filter_nameRadiate},{key:"Warm Contrast",locString:e.filter_nameWarmContrast},{key:"Calm",locString:e.filter_nameCalm},{key:"Cool Light",locString:e.filter_nameCoolLight},{key:"Vivid Cool",locString:e.filter_nameVividCool},{key:"Dramatic Cool",locString:e.filter_nameDramaticCool},{key:"BW",locString:e.filter_nameBw},{key:"BW Cool",locString:e.filter_nameBwCool},{key:"BW Warm",locString:e.filter_nameBwWarm},{key:"BW High Contrast",locString:e.filter_nameBwHighContrast},{key:"Burn",locString:e.filter_nameBurn},{key:"Film",locString:e.filter_nameFilm},{key:"Vintage",locString:e.filter_nameVintage}],n={customFilter:vt(e.undoRedo_filterAriaLive,"{0}","")};return Object.assign(n,QO(t,US,e.undoRedo_filterAriaLive)),n}(e)),((t={}).autoEnhance=e.undoRedo_autoEnhanceAriaLive,t.markupInkContent=e.undoRedo_markupInkContentAriaLive,t.markupEraseInkContent=e.undoRedo_markupEraseContentAriaLive,t.markupClearAllMarkupContent=e.undoRedo_markupClearAllMarkupContentAriaLive,t.zoomToCrop=e.undoRedo_transformCropAriaLive,t.pinchToCrop=e.undoRedo_transformCropAriaLive,t.cropWithCropHandles=e.undoRedo_transformCropAriaLive,t.mirrorImageX=e.undoRedo_transformMirrorImageAriaLive,t.mirrorImageY=e.undoRedo_transformMirrorImageAriaLive,t.rotateCropBy90=e.undoRedo_transformRotationAriaLive,t.rotateWithRotationBar=e.undoRedo_transformRotationAriaLive,t.setAspectRatio=e.undoRedo_transformAspectRatioAriaLive,t.texturePatchUndoRedoPayloadId=e.undoRedo_spotFixAriaLive,t))}(a)},[a]),r=Object(s.useCallback)(function(e){t(vt(i[e.payloadId],"Undo"===e.actionType?a.toolbar_undo:a.toolbar_redo))},[a.toolbar_redo,a.toolbar_undo,t,i]);return Object(s.useEffect)(function(){return null==n||n.onUndoRedo.addListener(r),function(){null==n||n.onUndoRedo.removeListener(r)}},[n,r]),null}),ZO=function(){return ZO=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},ZO.apply(this,arguments)},$O={getEdits:function(){},resetEdits:function(){},setEdits:function(){}},ew={resetEdits:se,setEdits:ce},tw=Object(ee.connect)(function(e){var t=e.colorAdjustments,n=e.filters,a=e.autoEnhance,i=e.markup;return{transformOperationProps:{imageMatrix:Pp(e),cropMatrix:e.transformTools.cropInteraction.uvToWorld,originalImageSize:e.transformTools.image.originalPixelSize,aspectRatio:e.transformTools.cropInteraction.aspectRatio,shouldInvertOriginalAspectRatio:e.transformTools.cropInteraction.shouldInvertOriginalAspectRatio,undoRedoStack:e.transformTools.undoRedoStack},colorAdjustmentProps:t,filterProps:n,autoEnhanceProps:a,markupProps:i,texturePatchProps:e.texturePatch,aspectRatiosList:e.transformTools.cropInteraction.aspectRatiosList}},ew)(function(e){var t=e.transformOperationProps,n=e.colorAdjustmentProps,a=e.filterProps,i=e.autoEnhanceProps,r=e.markupProps,o=e.texturePatchProps,c=e.aspectRatiosList,d=e.resetEdits,l=e.setEdits,u=e.onEditsChanged,f=e.forwardedRef,p=Object(s.useMemo)(function(){return $_(t,n,a,i,r,o)},[t,n,a,i,r,o]),m=Rm();Object(s.useEffect)(function(){u&&u()},[p,u]);var _=Object(s.useCallback)(function(e){var t=lC(e,c),n=t.isValid,a=t.message;n?l(e):m({id:"SetEditsIgnored",message:"ValidationError: ".concat(a)})},[c,l,m]);return Object(s.useImperativeHandle)(f,function(){return{getEdits:function(){return p},resetEdits:function(){return d(!1)},setEdits:_}},[p,d,_]),null}),nw=Object(s.forwardRef)(function(e,t){return c.a.createElement(tw,ZO({},e,{forwardedRef:t}))}),aw=function(){return aw=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},aw.apply(this,arguments)},iw={getUiState:function(){},resetUiState:function(){},setUiState:function(){}},rw={setUiState:ks,resetUiState:Ms},ow=Object(ee.connect)(function(e){return{uiState:e.uiState}},rw)(function(e){var t=e.uiState,n=e.resetUiState,a=e.setUiState,i=e.onUiStateChanged,r=e.forwardedRef,o=Object(s.useRef)(t);return Object(s.useEffect)(function(){o.current=t,i&&i()},[t,i]),Object(s.useImperativeHandle)(r,function(){return{getUiState:function(){return aw({},o.current)},resetUiState:n,setUiState:a}},[n,a]),null}),sw=Object(s.forwardRef)(function(e,t){return c.a.createElement(ow,aw({},e,{forwardedRef:t}))}),cw=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},dw=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function lw(){var e=this,t=Object(s.useContext)(lh),n=t.image,a=t.offscreenRenderer,i=function(e){var t=Rm(),n=Object(s.useContext)(Em);return Object(s.useCallback)(function(){return!Mm(e,n)&&(t({id:"SaveFailed",message:"Full size image has not loaded."}),!0)},[t,e,n])}(n);return{getEditedImage:Object(s.useCallback)(function(t){return void 0===t&&(t=n),cw(e,void 0,void 0,function(){return dw(this,function(e){return i()?[2,null]:a?[2,a.getEditedImage(t)]:[2,null]})})},[i,n,a]),getEditedImageBytes:Object(s.useCallback)(function(t){return void 0===t&&(t=n),cw(e,void 0,void 0,function(){return dw(this,function(e){return i()?[2,null]:a?[2,a.getEditedImageBytes(t)]:[2,null]})})},[i,n,a]),getImageLayerBytes:Object(s.useCallback)(function(t){return cw(e,void 0,void 0,function(){return dw(this,function(e){return a?[2,a.getImageLayerBytes(t)]:[2,null]})})},[a])}}var uw=function(){return uw=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},uw.apply(this,arguments)},fw={zoomIn:function(){},zoomOut:function(){}},pw={handleZoomDeltaChange:ad},mw=Object(ee.connect)(function(e){var t=!e.transformTools.cropInteraction.enableZoomToCrop&&!e.transformTools.view.enableZoomToView;return{zoomInDisabled:t||o0(e),zoomOutDisabled:t||s0(e)}},pw)(function(e){var t=e.forwardedRef,n=e.handleZoomDeltaChange,a=e.zoomInDisabled,i=e.zoomOutDisabled;return Object(s.useImperativeHandle)(t,function(){return{zoomIn:function(){a||n(-.05)},zoomOut:function(){i||n(.05)}}},[a,i,n]),null}),_w=Object(s.forwardRef)(function(e,t){return c.a.createElement(mw,uw({},e,{forwardedRef:t}))});function hw(e,t,n,a){var i=e.length/a/t;return{x:t+n.left+n.right,y:i+n.top+n.bottom}}var bw={top:0,left:0,right:0,bottom:0},gw=Object(s.forwardRef)(function(e,t){var n=e.onEditsChanged,a=e.onUiStateChanged,i=function(e){var t=lw(),n=t.getEditedImage,a=t.getEditedImageBytes,i=t.getImageLayerBytes,r=Object(s.useRef)($O),o=Object(s.useRef)(iw),c=Object(s.useRef)(fw),d=Object(s.useContext)(lh),l=d.setImage,u=d.setImageLayer;return Object(s.useImperativeHandle)(e,function(){return{getEdits:function(){return r.current.getEdits()},setEdits:function(e){return r.current.setEdits(e)},resetEdits:function(){r.current.resetEdits()},experimental_bakeEditsWithFrame:function(e){return n=function(){var t;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,function(n){switch(n.label){case 0:return[4,a()];case 1:return(t=n.sent())&&(r.current.resetEdits(),o=bw,((i=e).top!==o.top||i.left!==o.left||i.right!==o.right||i.bottom!==o.bottom)&&(t=function(e,t){var n=function(e,t,n,a,i,r){void 0===r&&(r=0);var o=hw(e,t,n,a),s=o.x,c=o.y,d=new i(s*c*a);if(d.fill(r),s<1||c<1)throw new Error("Invalid frame size for pixels bytes");for(var l=Math.max(0,-n.top),u=Math.max(0,-n.left),f=Math.max(0,n.top),p=Math.max(0,n.left),m=Math.max(0,n.bottom),_=Math.max(0,n.right),h=t*a,b=s*a,g=d.length-m*b-_*a,v=(s-p-_)*a,y=l*h+u*a,S=f*b+p*a,D=h,I=v+(_+p)*a;S<g;){var x=e.subarray(y,y+v);d.set(x,S),S+=I,y+=D}return d}(e.bytes,e.width,t,om(e.format),Uint8Array),a=hw(e.bytes,e.width,t,om(e.format));return{bytes:n,width:a.x,height:a.y,format:e.format,id:"imageWithFrame_"+Sl().toString()}}(t,e)),l(t)),[2]}var i,o})},new((t=void 0)||(t=Promise))(function(e,a){function i(e){try{o(n.next(e))}catch(e){a(e)}}function r(e){try{o(n.throw(e))}catch(e){a(e)}}function o(n){var a;n.done?e(n.value):(a=n.value,a instanceof t?a:new t(function(e){e(a)})).then(i,r)}o((n=n.apply(void 0,[])).next())});var t,n},experimental_setImageLayer:u,getEditedImage:n,getEditedImageBytes:a,getImageLayerBytes:i,getUiState:function(){return o.current.getUiState()},setUiState:function(e){return o.current.setUiState(e)},resetUiState:function(){return o.current.resetUiState()},zoomIn:function(){return c.current.zoomIn()},zoomOut:function(){return c.current.zoomOut()}}},[n,a,i,l,u]),{editOperationsRef:r,editUiStateRef:o,editViewingRef:c}}(t),r=i.editOperationsRef,o=i.editUiStateRef,d=i.editViewingRef;return c.a.createElement(c.a.Fragment,null,c.a.createElement(nw,{ref:r,onEditsChanged:n}),c.a.createElement(_w,{ref:d}),c.a.createElement(sw,{ref:o,onUiStateChanged:a}))});gw.displayName="ImageEditorRefContainer",OO();var vw=Object(s.forwardRef)(function(e,t){var n=e.image,a=e.componentSize,i=e.onSave,r=e.onRenderSaveMenu,o=e.localization,d=e.telemetryCallback,l=e.onError,u=e.onClose,f=e.onEditsChanged,p=e.onUiStateChanged,m=e.onResetEditsConfirmationDialog,_=e.defaultEdits,h=e.initialEdits,b=e.initialUiState,g=e.serializedState,v=e.layout,y=e.customCommandBarButtons,S=e.enableAdjustments,D=e.enableFilters,I=e.enableAutoEnhance,x=e.useBuiltInAutoEnhance,C=e.autoEnhanceInstallationInfo,O=e.enableSpotFix,w=e.experimental_enableInPainting,E=e.experimental_enableMaskLayer,A=e.enableUndoRedo,L=e.cssToPhysicalPixelRatio,k=e.onDecideEnabledSaveTypes,M=e.sessionFullImageSize,P=e.animationSpeedMultiplier,T=e.onRequestAutoEnhance,U=e.onRequestAutoEnhanceInstall,F=e.children,H=e.enableMarkupText,R=e.aspectRatiosDisplayedInOrder;Object(s.useEffect)(function(){performance.mark(Im.Editor)},[]);var N,B,j,V,z=$(),G=Object(s.useState)(!1),K=G[0],W=G[1],q=Object(s.useContext)(Wb).enableMarkup;N=!0,B=null!=D&&D,j=q,V=Object(s.useContext)(Wb).scriptsToLoadJSBundles,Object(s.useEffect)(function(){B&&B===N&&lS()},[B,N]),Object(s.useEffect)(function(){j&&j===N&&V.forEach(function(e){e()})},[j,N,V]);var Q=Object(s.useMemo)(function(){return function(e,t,n,a,i){var r=[{itemIcon:"Crop",itemKey:to,localizationKey:"pivot_crop"}];return e&&r.push({itemIcon:"Equalizer",itemKey:no,localizationKey:"pivot_adjustment"}),t&&r.push({itemIcon:"ImageFilter-Havana",itemKey:ao,localizationKey:"pivot_filter"}),n&&r.push({itemIcon:"Brush",itemKey:io,localizationKey:"pivot_markup"}),a&&r.push({itemIcon:"RetouchIcon-Havana",itemKey:ro,localizationKey:"pivot_retouch"}),i&&r.push({itemIcon:"Brush",itemKey:oo,localizationKey:"pivot_inpaint"}),r}(S,D,q,O,w)},[S,D,q,O,w]),Y=z.semanticColors.bodyBackground,J=Object(s.useCallback)(function(){W(!0)},[W]),X=Object(s.useCallback)(function(){W(!1)},[W]),Z={layout:v,componentSize:a,onSave:i,onRenderSaveMenu:r,onClose:u,pivotItems:Q,isEditorFocused:K,onEditsChanged:f,onUiStateChanged:p,cssToPhysicalPixelRatio:L,animationSpeedMultiplier:P,customCommandBarButtons:y};return c.a.createElement("div",{onFocus:J,onBlur:X,style:{width:a.width,height:a.height,backgroundColor:Y}},c.a.createElement(MO,{enableAdjustments:S,enableFilters:D,enableAutoEnhance:!!I,useBuiltInAutoEnhance:!!x,autoEnhanceInstallationInfo:C||v_,enableMarkup:q,enableSpotFix:O,experimental_enableInPainting:w,experimental_enableMaskLayer:E,enableUndoRedo:A,enableMarkupText:H},c.a.createElement(UC,{image:n,localization:o,telemetryCallback:d,onComponentError:l,defaultEdits:_,initialEdits:h,initialUiState:b,serializedState:g,sessionFullImageSize:M,onDecideEnabledSaveTypes:k,onResetEditsConfirmationDialog:m,onRequestAutoEnhance:T,onRequestAutoEnhanceInstall:U,ariaConfig:v.getAriaConfig?v.getAriaConfig():void 0,aspectRatiosDisplayedInOrder:R},c.a.createElement(NO,null,c.a.createElement(XO,null),c.a.createElement(WO,{htmlElementForKeyboardControl:document.body}),c.a.createElement(KO,null),c.a.createElement(jO,null),c.a.createElement(VO,null),c.a.createElement(zO,null),c.a.createElement(GO,null),c.a.createElement(qO,null),v.reactNode(Z),c.a.createElement(gw,{onEditsChanged:f,onUiStateChanged:p,ref:t}),F),c.a.createElement(PO,null),c.a.createElement(kO,null))))});vw.displayName="ImageEditor";var yw=Object(s.createContext)({fabricCanvas:null,setFabricCanvas:function(e){}}),Sw=Object(s.createContext)({fabric:null,loadFabric:function(){}}),Dw=function(e){var t=e.children,n=function(){var e=Object(s.useState)(null),t=e[0],n=e[1],a=Object(s.useRef)(null),i=Object(s.useContext)(Sw).fabric,r=Object(s.useCallback)(function(e){var t;if(i)if(e){var r=new i.Canvas(e,{enableRetinaScaling:!1,stopContextMenu:!0,enablePointerEvents:!0,selection:!1});a.current=r,r.renderOnAddRemove=!1,n(r);var o=r.getElement().parentElement;o&&(o.style.position="absolute")}else null===(t=a.current)||void 0===t||t.dispose(),a.current=null,n(null)},[i]);return[t,r]}(),a=n[0],i=n[1];return c.a.createElement(yw.Provider,{value:{fabricCanvas:a,setFabricCanvas:i}},t)},Iw=Object(s.createContext)({wetInkCanvas:void 0,setWetInkCanvas:function(e){}}),xw=function(e){var t=e.children,n=Object(s.useState)(),a=n[0],i=n[1];return c.a.createElement(Iw.Provider,{value:{wetInkCanvas:a,setWetInkCanvas:i}},t)};function Cw(e,t,n){var a=vi(n);t.clipPath=new e.Rect(a)}function Ow(e,t,n){if(pn(e,n)){var a=oi(gi(n)),i=a[0],r=a[1],o=a[2],s=a[3],c=[{lineStart:i,lineEnd:r},{lineStart:r,lineEnd:o},{lineStart:o,lineEnd:s},{lineStart:s,lineEnd:i}],d=Math.min.apply(Math,c.map(function(n){var a,i=n.lineStart,r=n.lineEnd;return null!==(a=Ci(e,t,i,r))&&void 0!==a?a:1}));return{x:e.x+(t.x-e.x)*d,y:e.y+(t.y-e.y)*d}}}function ww(e){return 5===e.button||32==(32&e.buttons)}function Ew(e,t){return ci(ei(t),bi(_i(e.calcTransformMatrix())))}function Aw(e,t,n){var a=e.util.qrDecompose(n),i=new e.Point(a.translateX,a.translateY);t.flipX=!1,t.flipY=!1,t.set(a),t.setPositionByOrigin(i,"center","center"),t.setCoords()}function Lw(e,t,n){if(t.id){var a=hi(ci(n,t.fabricToViewTransform));t.updateFabricToViewTransform=function(){t.fabricToViewTransform=Ew(t,n)},Aw(e,t,a)}}var kw=function(){return kw=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},kw.apply(this,arguments)};function Mw(e,t,n,a,i){a&&t.getObjects().forEach(function(t){Lw(e,t,a)}),n&&t.setDimensions({width:n.x,height:n.y},{backstoreOnly:!0}),i?Cw(e,t,i):a&&Cw(e,t,a),t.renderAll()}function Pw(e,t){for(var n=0,a=e.getObjects();n<a.length;n++){var i=a[n];if(i&&i.id&&t.has(i.id)&&(t.delete(i.id),e.remove(i)),t.size<1)break}e.requestRenderAll()}function Tw(e,t,n,a){var i=function(e,t,n,a){var i=ci(t,n);return e.util.multiplyTransformMatrices(hi(i),a)}(e,t,n,a.calcTransformMatrix());Aw(e,a,i),a.fabricToViewTransform=Ew(a,t)}function Uw(e,t){t.add(e),t.requestRenderAll()}var Fw="MARKUP_HIGHLIGHTER_CURSOR",Hw=function(){return Hw=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Hw.apply(this,arguments)},Rw="MARKUP_PEN_CURSOR";function Nw(e){var t=new Set;return e.forEach(function(e){if(!e.id)throw new Error("there is no id for : ".concat(e));t.add(e.id)}),t}var Bw=function(){return Bw=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Bw.apply(this,arguments)};var jw=function(){return jw=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},jw.apply(this,arguments)},Vw=function(){return Vw=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Vw.apply(this,arguments)},zw=Object(s.memo)(function(e){var t,n,a,i=e.cropViewTransform,r=e.imageViewTransform,o=e.width,d=e.height,l=e.cssWidth,u=e.cssHeight,f=e.styles,p=e.activeMarkupToolType,m=e.previousActiveMarkupToolType,_=e.markupContentItems,b=e.pointerIdToCaptureWhenEraserBrushIsCreated,g=e.setActiveMarkupToolType,v=e.removeMarkupContent,y=e.convertToFabricContent,S=e.setPointerIdToCaptureWhenEraserBrushIsCreated,D=e.cursorScreenPos,I=e.activeInkBrush,x=e.isKeyboardInputActive,C=e.linePreviewCoords,O=e.cssToPhysicalPixelRatio,w=e.addMarkupContent,E=e.setActiveMarkupContentId,A=e.setMarkupTextSelection,L=Object(s.useContext)(yw).setFabricCanvas;return t=Object(s.useContext)(Sw).loadFabric,Object(s.useLayoutEffect)(function(){t()},[t]),n=Object(s.useContext)(yw).fabricCanvas,a=Object(s.useContext)(Wb).setWetCanvasIsReady,Object(s.useEffect)(function(){return n&&a(!0),function(){a(!1)}},[n,a]),function(e,t,n,a,i){var r=Object(s.useContext)(yw).fabricCanvas,o=Object(s.useContext)(Sw).fabric;Object(s.useLayoutEffect)(function(){(null==r?void 0:r.getContext())&&(null==r||r.setDimensions({width:e,height:t},{backstoreOnly:!0}),null==r||r.setDimensions({width:n,height:a},{cssOnly:!0}),null==r||r.renderAll())},[e,t,n,a,r]),Object(s.useEffect)(function(){o&&(null==r?void 0:r.getContext())&&(Cw(o,r,i),r.renderAll())},[i,o,r])}(o,d,l,u,i),function(e,t,n,a,i,r,o,c,d){var l=Object(s.useContext)(yw).fabricCanvas,u=Object(s.useContext)(Sw).fabric,f=Object(s.useContext)(Wb).localizationStrings;Object(s.useEffect)(function(){if(c!==e&&l&&u){l.isDrawingMode=function(e){switch(e){case gs:case bs:case hs:return!0;default:return!1}}(e);var i=vi(t);e===gs&&(l.freeDrawingBrush=new(function(e){return e.util.createClass(e.PencilBrush,{color:"rgb(255, 255, 255)",opacity:0,width:32,initialize:function(e,t,n,a,i,r){this.canvas=e,this.width=t,this._points=[],this.bounds=n,this.removeMarkupContent=a,this.onPointerEvent=i,r&&(this.canvas.upperCanvasEl.setPointerCapture(r),this.canvas.upperCanvasEl.dispatchEvent(new Event("pointerdown")))},_render:function(){},_finalizeAndAddPath:function(){this._resetShadow(),this.canvas.clearContext(this.canvas.contextTop),this.canvas.requestRenderAll(),this.previousPoint=null},getIdsAtBrushLocation:function(t){var n=[],a=this.width/2,i=this.canvas.getObjects(),r=function(e,t){for(var n=Math.asin(1.5/t),a=[],i=0;i<2*Math.PI;i+=n)a.push({x:e.x+t*Math.cos(i),y:e.y+t*Math.sin(i)});return a}(t,a),o=new e.Circle({radius:a,top:t.y-a,left:t.x-a,fill:"rgba(255,0,255,0)"});o.setCoords();for(var s=0,c=i;s<c.length;s++){var d=c[s];d&&d.visible&&(d.isContainedWithinObject(o)||d.intersectsWithObject(o)&&this.objectCollidesWithPoints(d,r))&&n.push(d.id)}return n},objectCollidesWithPoints:function(e,t){for(var n=0,a=t;n<a.length;n++){var i=a[n];if(!this.canvas.isTargetTransparent(e,i.x,i.y))return!0}return!1},getPointsToEraseBetween:function(e,t){var n=pn(e,this.bounds),a=pn(t,this.bounds);if(n){if(a)return[t,e];var i=Ow(e,t,this.bounds);if(i)return[i,e]}else if(a){var r=Ow(t,e,this.bounds);if(r)return[t,r]}},erase:function(e){var t=this;if(pn(e,this.bounds)&&this.eraseIdsFromCanvas(this.getIdsAtBrushLocation(e)),this.previousPoint){var n=this.getPointsToEraseBetween(e,this.previousPoint);n&&window.requestAnimationFrame(function(){t.eraseIdsFromCanvas(t.getIdsBetweenPoints(n[0],n[1]))})}},getIdsBetweenPoints:function(t,n){var a=[],i=Math.hypot(n.x-t.x,n.y-t.y);if(i>this.width){var r=Math.atan2(n.y-t.y,n.x-t.x),o=ka(La(n,t)),s={x:-1*o.y*this.width/2,y:o.x*this.width/2},c=new e.Rect({width:i,height:this.width,left:t.x-s.x,top:t.y-s.y,angle:180*r/Math.PI,fill:"rgba(255,255,0,0)"});c.setCoords();for(var d=[],l=0,u=this.canvas.getObjects();l<u.length;l++)if((_=u[l])&&_.id&&_.visible){if(_.isContainedWithinObject(c)){a.push(_.id);continue}if(_.intersectsWithObject(c)){d.push(_);continue}}if(d.length>0)for(var f=function(e,t,n,a){void 0===a&&(a=1);for(var i=[],r=wa(La(e,t)),o=ka(La(t,e)),s=-1*o.y*n/2,c=o.x*n/2,d=0;d<r;d+=a)i.push({x:e.x+d*o.x+s,y:e.y+d*o.y+c}),i.push({x:e.x+d*o.x-s,y:e.y+d*o.y-c});return i}(t,n,this.width),p=0,m=d;p<m.length;p++){var _;(_=m[p]).id&&this.objectCollidesWithPoints(_,f)&&a.push(_.id)}}return a},eraseIdsFromCanvas:function(e){e.length>0&&this.removeMarkupContent(e)},onMouseDown:function(e,t){this.onPointerEvent(t.e),this.canvas._isMainEvent(t.e)&&(this.previousPoint=e,this.erase(e))},onMouseMove:function(e,t){if(this.onPointerEvent(t.e),this.canvas._isMainEvent(t.e)&&(!this.limitedToCanvasSize||!this._isOutSideCanvas(e))){if(void 0!==(n=t.e.buttons)&&!bp(n,mp)&&!ww(t.e))return this._finalizeAndAddPath(),void(this.canvas._isCurrentlyDrawing=!1);this._captureDrawingPath(e)&&this._points.length>1&&(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this._render()):this.erase(e),this.previousPoint=e)}var n},onMouseUp:function(e){return this.onPointerEvent(e.e),!this.canvas._isMainEvent(e.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)}})}(u))(l,32,i,n,function(t){ww(t)&&"pointerup"===t.type&&(null==o||o(void 0),c&&c!==e&&a(c))},d),l.freeDrawingCursor="inherit",l.defaultCursor="inherit")}},[t,l,e,n,u,c,a,o,d,f,r,i])}(p,i,v,g,r,O,S,m,b),function(e,t){var n=Object(s.useContext)(yw).fabricCanvas,a=Object(s.useRef)(null),i=Object(s.useContext)(Sw).fabric;Object(s.useLayoutEffect)(function(){a.current=new Set},[n]),Object(s.useLayoutEffect)(function(){if((null==n?void 0:n.getContext())&&a.current&&i){for(var r=[],o=new Set(a.current),s=0,c=e;s<c.length;s++){var d=c[s];o.delete(d.id),a.current.has(d.id)||(r.push(d),a.current.add(d.id))}for(var l=0,u=Array.from(o);l<u.length;l++){var f=u[l];a.current.delete(f)}!function(e,t,n,a){var i=function(e){e.forEach(function(e){t.add(e)}),t.requestRenderAll()};a?i(n.map(a)):e.util.enlivenObjects(n,i,"fabric")}(i,n,r,t),Pw(n,o)}},[t,i,n,e])}(_,y),function(e){var t=Object(s.useContext)(yw).fabricCanvas,n=Object(s.useContext)(Sw).fabric;Object(s.useLayoutEffect)(function(){t&&n&&t.getObjects().forEach(function(t){Lw(n,t,e)})},[n,t,e])}(r),function(e,t){var n=Object(s.useContext)(yw).fabricCanvas,a=Object(s.useContext)(Wb).setCanvasMethods,i=Object(s.useContext)(Sw).fabric,r=Object(s.useRef)(n);n&&(r.current=n);var o=Object(s.useRef)(void 0);Object(s.useEffect)(function(){return a(function(e){return kw(kw({},e),{getHTMLCanvas:function(e,t){if(r.current&&i){var n=r.current.getElement();if(r.current.discardActiveObject(),n)return(e||t)&&(o.current={x:r.current.getWidth(),y:r.current.getHeight()},Mw(i,r.current,e,t),n=r.current.getElement()),n}return null}})}),function(){r.current=null}},[i,a]),Object(s.useEffect)(function(){return a(function(n){return kw(kw({},n),{restoreHTMLCanvas:function(){r.current&&i&&r.current.getElement()&&Mw(i,r.current,o.current,e,t)}})}),function(){r.current=null}},[t,i,e,a])}(r,i),function(e,t,n,a,i){var r=Object(s.useContext)(yw).fabricCanvas,o=Object(s.useContext)(Sw).fabric;Object(s.useEffect)(function(){if((null==r?void 0:r.getContext())&&o&&n){var s=function(e,t,n){switch(n.inkType){case os.Highlighter:return function(e,t,n){var a=Math.min(.1*n.thicknessInCssPixels,1),i=n.thicknessInCssPixels/2,r=n.thicknessInCssPixels,o=new e.Rect({left:t.x-i/2,top:t.y-r/2,width:i,height:r,fill:n.htmlColor,stroke:"white",strokeWidth:a}),s=new e.Group([o]);return s.id=Sl(),s.name=Fw,s}(e,t,n);case os.Pen:return function(e,t,n){var a=new e.Group,i=K9(n.thicknessInCssPixels),r=G9(i),o=i+r,s=2*o,c=new e.Circle({radius:i,left:t.x-o+1,top:t.y-o+1,fill:n.htmlColor,stroke:"white",strokeWidth:r});if(a.addWithUpdate(c),c.left&&c.top){var d={stroke:"white",fill:"black",left:c.left+s,top:c.top+o,strokeLineCap:"round",strokeLineJoin:"round"};if(n.strokeShape.arrowMode===is.SingleArrow){var l=new e.Path(W9,Hw({},d));a.add(l)}if(n.strokeShape.arrowMode===is.DoubleArrow){var u=new e.Path(q9,Hw({},d));a.add(u)}}return a.id=Sl(),a.name=Rw,a}(e,t,n);default:throw new h(n.inkType)}}(o,e,t);return s?(Tw(o,i,ci(ei(i),Ka(a)),s),Uw(s,r),function(){Pw(r,Nw([s]))}):void 0}},[t,a,e,o,r,i,n])}(D,I,x,O,r),function(e,t,n,a,i){var r=Object(s.useContext)(yw).fabricCanvas,o=Object(s.useContext)(Sw).fabric;Object(s.useEffect)(function(){if((null==r?void 0:r.getContext())&&o&&e){var s=function(e,t,n){switch(t.inkType){case os.Highlighter:return function(e,t,n){if(n.startPoint&&n.endPoint){var a=new e.Group,i=t.thicknessInCssPixels/2,r=new e.Polygon(function(e,t,n){var a,i=e,r=t,o=n/2,s=i.x-r.x,c=i.y-r.y;return r.y>i.y&&(i=(a=[r,i])[0],r=a[1]),s>0&&c<0||s<0&&c>=0?[{x:r.x-o,y:r.y-n},{x:r.x+o,y:r.y-n},{x:r.x+o,y:r.y+n},{x:i.x+o,y:i.y+n},{x:i.x-o,y:i.y+n},{x:i.x-o,y:i.y-n}]:[{x:r.x-o,y:r.y-n},{x:r.x+o,y:r.y-n},{x:i.x+o,y:i.y-n},{x:i.x+o,y:i.y+n},{x:i.x-o,y:i.y+n},{x:r.x-o,y:r.y+n}]}(n.startPoint,n.endPoint,i),{fill:t.htmlColor,opacity:.5});return a.addWithUpdate(r),a.id=Sl(),a}}(e,t,n);case os.Pen:return function(e,t,n){if(n.startPoint&&n.endPoint){var a=t.thicknessInCssPixels,i=n.startPoint,r=n.endPoint,o=a/2,s=Ba(i,r),c=function(e,t){if(!Ra(e,t))return 180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI-90}(i,r);if(void 0!==c){var d={originX:"center",originY:"center",opacity:1,fill:t.htmlColor,strokeWidth:0,radius:o,angle:90+c},l=new e.Circle(Bw(Bw({},d),{left:i.x,top:i.y})),u=new e.Rect({left:i.x,top:i.y,width:a,height:s,fill:t.htmlColor,angle:c,originX:"center",strokeWidth:0,opacity:1}),f=new e.Circle(Bw(Bw({},d),{left:r.x,top:r.y,startAngle:270,endAngle:90})),p=new e.Group([l,u,f]);return p.id=Sl(),p}}}(e,t,n);default:throw new h(t.inkType)}}(o,t,n);return s?(Tw(o,i,ci(ei(i),Ka(a)),s),Uw(s,r),function(){Pw(r,Nw([s]))}):void 0}},[t,a,o,r,i,e,n])}(x,I,C,O,r),function(e){var t=Object(s.useContext)(yw).fabricCanvas;Object(s.useEffect)(function(){if(null==t?void 0:t.getContext()){var n=function(){!function(e,t){var n=function(e,t){var n=e.getObjects().filter(function(e){return e.name===t});if(n.length>0)return n[0]}(e,function(e){switch(e){case os.Highlighter:return Fw;case os.Pen:return Rw;default:throw new h(e)}}(t.inkType));n&&e.bringToFront(n)}(t,e)};return t.on("object:added",n),function(){t.off("object:added",n)}}},[e,t])}(I),function(e){var t=Object(s.useContext)(yw).fabricCanvas,n=Object(s.useContext)(Sw).fabric;Object(s.useEffect)(function(){if(t&&n){var a=new Map(t.getObjects("textbox").map(function(e){return[e.id,e]})),i=new Map(e.filter(function(e){return e.id&&e.contentType===R_.TextContent}).map(function(e){return[e.id,e]}));null==a||a.forEach(function(e){var n=i.get(e.id),a=null==n?void 0:n.drawingAttributes,r=e.toObject();a&&!Wc(a,r,5)&&(e.set(a),t.requestRenderAll())})}},[e,n,t])}(_),function(e){var t=Object(s.useContext)(yw).fabricCanvas;Object(s.useEffect)(function(){var n=function(t){var n,a;if("textbox"===(null===(a=null===(n=t.selected)||void 0===n?void 0:n[0])||void 0===a?void 0:a.type)){var i=t.selected[0]._unwrappedTextLines.reduce(function(e,t,n){var a;return jw(jw({},e),((a={})[n]={selectionStart:0,selectionEnd:t.length},a))},{});e(i)}else e(void 0)},a=function(t){var n=t.target;if("textbox"===(null==n?void 0:n.type)){var a=n,i=a.selectionStart,r=a.selectionEnd;if(void 0===i||void 0===r)return void e(void 0);for(var o={},s=i;s<=r;s++){var c=n.get2DCursorLocation(s,!0),d=c.lineIndex,l=c.charIndex;void 0===o[d]&&(o[d]={selectionStart:l,selectionEnd:l}),o[d].selectionEnd=l}e(o)}else e(void 0)};return null==t||t.on("text:selection:changed",a),null==t||t.on("selection:updated",n),null==t||t.on("selection:cleared",n),null==t||t.on("selection:created",n),function(){null==t||t.off("text:selection:changed",a),null==t||t.off("selection:updated",n),null==t||t.off("selection:cleared",n),null==t||t.off("selection:created",n)}},[t,e])}(A),function(e){var t=Object(s.useContext)(yw).fabricCanvas;Object(s.useEffect)(function(){var n=function(){var n;e(null===(n=null==t?void 0:t.getActiveObject())||void 0===n?void 0:n.id)};return null==t||t.on("selection:created",n),null==t||t.on("selection:updated",n),null==t||t.on("selection:cleared",n),function(){null==t||t.off("selection:created",n),null==t||t.off("selection:updated",n),null==t||t.off("selection:cleared",n)}},[t,e])}(E),function(e,t,n){var a=Object(s.useContext)(yw).fabricCanvas,i=Object(s.useContext)(Wb).localizationStrings,r=Object(s.useRef)(!1);Object(s.useEffect)(function(){if(a&&n===vs){a.defaultCursor="Text";var o=function(n){if(n.target||r.current)r.current=!1;else if(n.absolutePointer){var a=n.absolutePointer,o=a.x,s=a.y;e({text:i.markup_textboxDefaultContent,contentType:R_.TextContent,invertedPhysicalImageTransformDuringContentSerialization:ei(t),initialPosition:{positionType:"AtLocation",left:o,top:s}})}},s=function(){r.current=!0};return a.on("selection:cleared",s),a.on("mouse:up",o),function(){a.off("mouse:up",o),a.off("selection:cleared",s)}}},[a,e,t,i,n])}(w,r,p),function(e){var t=Object(s.useContext)(yw).fabricCanvas;Object(s.useEffect)(function(){var n=function(t){"textbox"===t.type&&void 0!==t.id&&e([t.id])},a=function(e){e.target&&"text"in e.target&&!e.target.text&&n(e.target)};function i(e){var a=null==t?void 0:t.getActiveObject();"Delete"===e.key&&a&&"isEditing"in a&&!a.isEditing&&n(a)}return null==t||t.on("before:selection:cleared",a),document.addEventListener("keydown",i),function(){null==t||t.off("before:selection:cleared",a),document.removeEventListener("keydown",i)}},[t,e])}(v),function(e){var t=Object(s.useContext)(yw).fabricCanvas;Object(s.useEffect)(function(){function n(){var e;"textbox"===(null===(e=null==t?void 0:t.getActiveObject())||void 0===e?void 0:e.type)&&(null==t||t.discardActiveObject(),null==t||t.requestRenderAll())}function a(e){"Escape"===e.key&&n()}if("Text"===e)return document.addEventListener("keydown",a),function(){document.removeEventListener("keydown",a)};n()},[t,e])}(p),c.a.createElement("canvas",{ref:L,style:Vw({},f)})});function Gw(e,t){e.output=t}function Kw(e,t,n){Gw(e,t),Gw(t,n)}function Ww(e,t,n,a){Gw(e,t),Kw(t,n,a)}function qw(e,t,n,a,i){Kw(e,t,n),Kw(n,a,i)}const Qw=.5;function Yw(e){return{x:e.offsetX,y:e.offsetY,pressure:e.pressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timeStamp}}function Jw(e){return{x:e.offsetX,y:e.offsetY,pressure:Qw,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timeStamp}}class Xw{onPointerDown(e){this.output.beginStroke(Jw(e))}onPointerMove(e){this.output.addPoint(Jw(e))}onPointerUp(e){this.output.endStroke(Jw(e))}}class Zw{onPointerDown(e){this.output.beginStroke(Yw(e))}onPointerMove(e){this.output.addPoint(Yw(e))}onPointerUp(e){this.output.endStroke(Yw(e))}}function $w(){return-1===navigator.userAgent.indexOf("Firefox")?new Zw:new Xw}class eE{beginStroke(e){this.lastPoint=e,this.output.beginStroke(e)}addPoint(e){this.lastPoint=e,this.output.addPoint(e)}endStroke(e){this.lastPoint=e,this.output.endStroke(e)}}class tE{beginStroke(e){this.output.beginStroke(e),this.point=e}addPoint(e){this.point.x===e.x&&this.point.y===e.y||(this.output.addPoint(e),this.point=e)}endStroke(e){this.output.endStroke(e)}}class nE{beginStroke(e){this.out1={x:e.x,y:e.y},this.out2=this.out1,this.output.beginStroke(e)}addPoint(e){this.output.addPoint(this.filter(e))}endStroke(e){this.output.endStroke(this.filter(e))}filter(e){const t={x:aE(e.x,this.out1.x,this.out2.x),y:aE(e.y,this.out1.y,this.out2.y)};return this.out2=this.out1,this.out1=t,{x:t.x,y:t.y,pressure:e.pressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timestamp}}}function aE(e,t,n){return.16999999999999993*e+1.33*t+-.5*n}class iE{constructor(){this.lastPressure=Qw}beginStroke(e){this.output.beginStroke(e),this.lastPressure=e.pressure}addPoint(e){this.output.addPoint(e),this.lastPressure=e.pressure}endStroke(e){this.output.endStroke(0===e.pressure?{x:e.x,y:e.y,pressure:this.lastPressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timestamp}:e)}}class rE{constructor(e){this.deduper=new tE,this.endStrokePressure=new iE,this.jitter=new nE,e?(this.preJitterLastPointExtractor=new eE,Ww(this.deduper,this.endStrokePressure,this.preJitterLastPointExtractor,this.jitter)):Kw(this.deduper,this.endStrokePressure,this.jitter)}beginStroke(e){Gw(this.jitter,this.output),this.deduper.beginStroke(e)}addPoint(e){this.deduper.addPoint(e)}endStroke(e){this.deduper.endStroke(e)}}function oE(e,t,n,a){const i=(e+t)/2,r=(t+n)/2,o=(n+a)/2,s=(i+r)/2,c=(r+o)/2;return[e,i,s,(s+c)/2,c,o,a]}function sE(e,t,n,a){return[(n-e)/6+t,(t-a)/6+n]}class cE{constructor(){this.began=!1}beginStroke(e){this.output.beginStroke(e),this.cp=[e,e,e,e],this.began=!0}addPoint(e){const[t,n]=this.push(e);this.began?this.began=!1:this.output.addSegment(t,n,this.cp[2])}endStroke(e){this.addPoint(e);const[t,n]=this.push(e);this.output.endStroke(t,n,this.cp[2])}push(e){return this.cp.shift(),this.cp.push(e),function(e,t,n,a){const[i,r]=sE(e.x,t.x,n.x,a.x),[o,s]=sE(e.y,t.y,n.y,a.y),[c,d]=dE(t.pressure,n.pressure),[l,u]=dE(t.tiltX,n.tiltX),[f,p]=dE(t.tiltY,n.tiltY),[m,_]=dE(t.timestamp,n.timestamp);return[{x:i,y:o,pressure:c,tiltX:l,tiltY:f,timestamp:m},{x:r,y:s,pressure:d,tiltX:u,tiltY:p,timestamp:_}]}(this.cp[0],this.cp[1],this.cp[2],this.cp[3])}}function dE(e,t){const n=(t-e)/3;return[e+n,t-n]}class lE{constructor(){this.deduperJitterTransform=new rE(!1),this.fitter=new cE,Gw(this.deduperJitterTransform,this.fitter)}beginStroke(e){Gw(this.fitter,this.output),this.deduperJitterTransform.beginStroke(e)}addPoint(e){this.deduperJitterTransform.addPoint(e)}endStroke(e){this.deduperJitterTransform.endStroke(e)}}function uE(e,t){return e.x*t.x+e.y*t.y}function fE(e,t){return{x:e.x-t.x,y:e.y-t.y}}function pE(e,t){const n=fE(e,t);return uE(n,n)}class mE{constructor(e){this.flatness=e*e}beginStroke(e){this.output.beginStroke(e),this.beginPoint=e}addSegment(e,t,n){_E(this.beginPoint,e,t,n,this.flatness,this.output),this.output.addPoint(n),this.beginPoint=n}endStroke(e,t,n){_E(this.beginPoint,e,t,n,this.flatness,this.output),this.output.endStroke(n)}}function _E(e,t,n,a,i,r){const[o,s,c,d,l,u,f]=function(e,t,n,a){const[i,r,o,s,c,d,l]=oE(e.x,t.x,n.x,a.x),[u,f,p,m,_,h,b]=oE(e.y,t.y,n.y,a.y),[g,v,y,S,D,I,x]=oE(e.pressure,t.pressure,n.pressure,a.pressure),[C,O,w,E,A,L,k]=oE(e.tiltX,t.tiltX,n.tiltX,a.tiltX),[M,P,T,U,F,H,R]=oE(e.tiltY,t.tiltY,n.tiltY,a.tiltY),[N,B,j,V,z,G,K]=oE(e.timestamp,t.timestamp,n.timestamp,a.timestamp);return[{x:i,y:u,pressure:g,tiltX:C,tiltY:M,timestamp:N},{x:r,y:f,pressure:v,tiltX:O,tiltY:P,timestamp:B},{x:o,y:p,pressure:y,tiltX:w,tiltY:T,timestamp:j},{x:s,y:m,pressure:S,tiltX:E,tiltY:U,timestamp:V},{x:c,y:_,pressure:D,tiltX:A,tiltY:F,timestamp:z},{x:d,y:h,pressure:I,tiltX:L,tiltY:H,timestamp:G},{x:l,y:b,pressure:x,tiltX:k,tiltY:R,timestamp:K}]}(e,t,n,a);(function(e,t,n){const a=pE(t,e);if(0===a)return pE(n,e);const i=(n.x-t.x)*(t.y-e.y)-(t.x-e.x)*(n.y-t.y);return i*i/a})(o,f,d)<=i||(_E(o,s,c,d,i,r),r.addPoint(d),_E(d,l,u,f,i,r))}class hE{constructor(e){this.bezierStrokePath=new lE,this.flattener=new mE(e),Gw(this.bezierStrokePath,this.flattener)}beginStroke(e){Gw(this.flattener,this.output),this.bezierStrokePath.beginStroke(e)}addPoint(e){this.bezierStrokePath.addPoint(e)}endStroke(e){this.bezierStrokePath.endStroke(e)}}class bE{constructor(e){this.pointerToStroke=$w(),this.strokeSmoothener=new hE(e),Gw(this.pointerToStroke,this.strokeSmoothener)}onPointerDown(e){Gw(this.strokeSmoothener,this.output),this.pointerToStroke.onPointerDown(e)}onPointerMove(e){this.pointerToStroke.onPointerMove(e)}onPointerUp(e){this.pointerToStroke.onPointerUp(e)}}class gE{constructor(e){this.onPointerDown=e=>{this.output.onPointerDown(e)},this.onTouchStart=e=>{this.output.onTouchStart(e)},this.element=e}activate(){this.element.addEventListener("pointerdown",this.onPointerDown,!0),this.element.addEventListener("touchstart",this.onTouchStart,!0)}deactivate(){this.element.removeEventListener("pointerdown",this.onPointerDown,!0),this.element.removeEventListener("touchstart",this.onTouchStart,!0)}}class vE{constructor(){this.active=!1}onMouseDown(e){this.output.onMouseDown(e),this.active=!0}onMouseMove(e){this.active&&this.output.onMouseMove(e)}onMouseUp(e){this.active=!1,this.output.onMouseUp(e)}}class yE{constructor(e){this.onMouseDown=e=>{this.output.onMouseDown(e)},this.onMouseMove=e=>{this.output.onMouseMove(e)},this.onMouseUp=e=>{this.output.onMouseUp(e)},this.element=e}activate(){this.element.addEventListener("mousedown",this.onMouseDown),this.element.addEventListener("mousemove",this.onMouseMove),this.element.addEventListener("mouseup",this.onMouseUp)}deactivate(){this.element.removeEventListener("mousedown",this.onMouseDown),this.element.removeEventListener("mousemove",this.onMouseMove),this.element.removeEventListener("mouseup",this.onMouseUp)}}function SE(e){e.preventDefault()}function DE(e){e.preventDefault(),e.stopPropagation()}class IE{onMouseDown(e){this.output.onMouseDown(e),DE(e)}onMouseMove(e){this.output.onMouseMove(e),DE(e)}onMouseUp(e){this.output.onMouseUp(e),DE(e)}}class xE{constructor(e){Kw(this.head=new yE(e),new IE,this.tail=new vE)}activate(){this.head.activate()}deactivate(){this.head.deactivate()}set output(e){this.tail.output=e}}function CE(e){return{offsetX:e.offsetX,offsetY:e.offsetY,pressure:.5,tiltX:0,tiltY:0,timeStamp:e.timeStamp,pointerType:"mouse"}}class OE{onMouseDown(e){this.output.onPointerDown(CE(e))}onMouseMove(e){this.output.onPointerMove(CE(e))}onMouseUp(e){this.output.onPointerUp(CE(e))}}class wE{constructor(e){this.element=e}onPointerDown(e){try{this.element.setPointerCapture(e.pointerId)}finally{this.output.onPointerDown(e)}}onPointerMove(e){this.output.onPointerMove(e)}onPointerUp(e){this.output.onPointerUp(e)}}class EE{constructor(e){this.onPointerDown=e=>{this.output.onPointerDown(e)},this.onPointerMove=e=>{this.output.onPointerMove(e)},this.onPointerUp=e=>{this.output.onPointerUp(e)},this.element=e}activate(){this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("pointermove",this.onPointerMove),this.element.addEventListener("pointerup",this.onPointerUp)}deactivate(){this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("pointermove",this.onPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp)}}class AE{constructor(e){this.element=e}activate(){this.element.addEventListener("touchmove",SE)}deactivate(){this.element.removeEventListener("touchmove",SE)}}class LE{onPointerDown(e){this.output.onPointerDown(e),DE(e)}onPointerMove(e){this.output.onPointerMove(e),DE(e)}onPointerUp(e){this.output.onPointerUp(e),DE(e)}}var kE=function(){function e(e,t){this.activePointerId=void 0,this.setMarkupCursorScreenPosition=e,this.setIsKeyboardInputActive=t}return e.prototype.onPointerDown=function(e){void 0===this.activePointerId&&(this.activePointerId=e.pointerId,this.output.onPointerDown(e))},e.prototype.onPointerMove=function(e){this.setIsKeyboardInputActive(!1),this.setMarkupCursorScreenPosition({x:e.offsetX,y:e.offsetY}),this.activePointerId===e.pointerId&&this.output.onPointerMove(e)},e.prototype.onPointerUp=function(e){this.activePointerId===e.pointerId&&(this.output.onPointerUp(e),this.activePointerId=void 0)},e}();class ME{onPointerDown(e){this.output.onPointerDown(e)}onPointerMove(e){(function(e){if("getCoalescedEvents"in e){const t=e.getCoalescedEvents();if(t.length>=1)return t}return[e]})(e).forEach(e=>{this.output.onPointerMove(e)})}onPointerUp(e){this.output.onPointerUp(e)}}var PE=function(){function e(e,t,n){qw(this.head=new EE(e),new wE(e),new LE,new kE(t,n),this.tail=new ME),this.preventDefaultOnTouchMove=new AE(e)}return e.prototype.activate=function(){var e;this.head.activate(),null===(e=this.preventDefaultOnTouchMove)||void 0===e||e.activate()},e.prototype.deactivate=function(){var e;this.head.deactivate(),null===(e=this.preventDefaultOnTouchMove)||void 0===e||e.deactivate()},Object.defineProperty(e.prototype,"output",{set:function(e){this.tail.output=e},enumerable:!1,configurable:!0}),e}();class TE{constructor(){this.wasPenDown=!1}onPointerDown(e){this.wasPenDown=function(e){return"pen"===e.pointerType}(e)}onTouchStart(e){this.wasPenDown&&DE(e)}}class UE{constructor(){this.activeIdentifier=-1}onTouchStart(e,t){-1===this.activeIdentifier&&(this.activeIdentifier=t.identifier,this.output.onTouchStart(e,t))}onTouchMove(e,t){this.activeIdentifier===t.identifier&&this.output.onTouchMove(e,t)}onTouchEnd(e,t){this.activeIdentifier===t.identifier&&(this.output.onTouchEnd(e,t),this.activeIdentifier=-1)}}class FE{onTouchStart(e){for(let t=0;t<e.changedTouches.length;t+=1)this.output.onTouchStart(e,e.changedTouches[t])}onTouchMove(e){for(let t=0;t<e.changedTouches.length;t+=1)this.output.onTouchMove(e,e.changedTouches[t])}onTouchEnd(e){for(let t=0;t<e.changedTouches.length;t+=1)this.output.onTouchEnd(e,e.changedTouches[t])}}class HE{constructor(e){this.onTouchStart=e=>{this.output.onTouchStart(e)},this.onTouchMove=e=>{this.output.onTouchMove(e)},this.onTouchEnd=e=>{this.output.onTouchEnd(e)},this.element=e}activate(){this.element.addEventListener("touchstart",this.onTouchStart),this.element.addEventListener("touchmove",this.onTouchMove),this.element.addEventListener("touchend",this.onTouchEnd)}deactivate(){this.element.removeEventListener("touchstart",this.onTouchStart),this.element.removeEventListener("touchmove",this.onTouchMove),this.element.removeEventListener("touchend",this.onTouchEnd)}}class RE{onTouchStart(e){this.output.onTouchStart(e),DE(e)}onTouchMove(e){this.output.onTouchMove(e),DE(e)}onTouchEnd(e){this.output.onTouchEnd(e),DE(e)}}class NE{constructor(e){Ww(this.head=new HE(e),new RE,new FE,this.tail=new UE)}activate(){this.head.activate()}deactivate(){this.head.deactivate()}set output(e){this.tail.output=e}}function BE(e){return 180*e/Math.PI}function jE(e,t){const n=t.target.getBoundingClientRect();return{offsetX:t.clientX-n.left,offsetY:t.clientY-n.top,pressure:t.force,tiltX:BE(Math.atan(Math.cos(t.azimuthAngle)/Math.tan(t.altitudeAngle))),tiltY:BE(Math.atan(Math.sin(t.azimuthAngle)/Math.tan(t.altitudeAngle))),timeStamp:e.timeStamp,pointerType:"touch"}}class VE{onTouchStart(e,t){this.output.onPointerDown(jE(e,t))}onTouchMove(e,t){this.output.onPointerMove(jE(e,t))}onTouchEnd(e,t){this.output.onPointerUp(jE(e,t))}}const zE={type:0},GE={width:4,height:4,color:{r:0,g:0,b:0,a:1},effect:zE,tip:"ellipse",rasterOperation:"copy"};function KE(e){return{width:e.width,height:e.height,color:e.color,effect:e.effect,tip:e.tip,rasterOperation:e.rasterOperation}}class WE{constructor(e){this.attributes=KE(void 0!==e?e:GE)}setWidth(e){return this.attributes.width=e,this}setHeight(e){return this.attributes.height=e,this}setColor(e){return this.attributes.color=e,this}setEffect(e){return this.attributes.effect=e,this}setTip(e){return this.attributes.tip=e,this}setRasterOperation(e){return this.attributes.rasterOperation=e,this}build(){return KE(this.attributes)}}class qE{constructor(){this.offsetX=0,this.offsetY=0}setDrawingAttributes(e){this.output.setDrawingAttributes(1===e.effect.type?new WE(e).setEffect({type:1,pattern:e.effect.pattern,offsetX:this.offsetX,offsetY:this.offsetY}).build():e)}beginStroke(e){this.output.beginStroke(e),this.begin=e}addPoint(e){this.output.addPoint(e)}endStroke(e){this.output.endStroke(e);const t=e.x-this.begin.x,n=e.y-this.begin.y,a=t>0?48:-48;this.offsetX+=t+a,this.offsetY+=n+a,this.offsetX%=540,this.offsetY%=540}}class QE{constructor(e=GE){this.offset=new qE,this.setDrawingAttributes(e)}setDrawingAttributes(e){this.attributes=e}beginStroke(e){Gw(this.offset,this.output),this.out=1===this.attributes.effect.type?this.offset:this.output,this.out.setDrawingAttributes(this.attributes),this.out.beginStroke(e)}addPoint(e){this.out.addPoint(e)}endStroke(e){this.out.endStroke(e)}}function YE(e){return 5===e.button||32==(32&e.buttons)}function JE(e){return function(e){var t=0===e.pressure,n="mouse"===e.pointerType||""===e.pointerType;return t&&n}(e)?function(e,t){return new PointerEvent(e.type,{pressure:.5,clientX:e.offsetX,clientY:e.offsetY,altKey:e.altKey,bubbles:e.bubbles,button:e.button,buttons:e.buttons,cancelable:e.cancelable,composed:e.composed,ctrlKey:e.ctrlKey,detail:e.detail,height:e.height,isPrimary:e.isPrimary,metaKey:e.metaKey,movementX:e.movementX,movementY:e.movementY,pointerId:e.pointerId,pointerType:e.pointerType,relatedTarget:e.relatedTarget,screenX:e.screenX,screenY:e.screenY,shiftKey:e.shiftKey,tangentialPressure:e.tangentialPressure,tiltX:e.tiltX,tiltY:e.tiltY,twist:e.twist,width:e.width})}(e):e}var XE=function(){function e(e,t,n,a,i,r){this.wetCanvas=e,this.wetInkDryer=t,this.inkRenderer=n,this.activeInkBrush=a,this.wetStrokeCollector=i,this.onPointerEvent=r,this.ignoreStroke=!1,this.drawingBounds=fn,this.makeStrokeStraightTimer=void 0}return e.prototype.getShouldIgnoreStrokeOnPointerDown=function(e){return!function(e){return void 0===(t=e.button)||function(e,t){return e===t.initiatingButtonId}(t,mp);var t}(e)||!pn({x:e.offsetX,y:e.offsetY},this.drawingBounds)},e.prototype.forceInkRendererToLineMode=function(e){this.inkRenderer.setIncrementalRender(!e&&function(e){switch(e.inkType){case os.Highlighter:return!1;case os.Pen:return e.strokeShape.lineMode!==rs.StraightLine;default:throw new h(e.inkType)}}(this.activeInkBrush)),this.inkRenderer.setIsLineMode(e||this.activeInkBrush.strokeShape.lineMode===rs.StraightLine)},e.prototype.onPointerDown=function(e){var t,n=JE(e);if(null===(t=this.onPointerEvent)||void 0===t||t.call(this,n),(YE(n)||function(e){return 2===e.button||2==(2&e.buttons)}(n))&&this.wetInkDryer.dryAllStrokes(),this.ignoreStroke=this.getShouldIgnoreStrokeOnPointerDown(n),!this.ignoreStroke){try{this.wetCanvas.setPointerCapture(n.pointerId)}catch(e){}this.forceInkRendererToLineMode(n.shiftKey),this.output.onPointerDown(n)}},e.prototype.onPointerMove=function(e){var t,n=this,a={x:e.offsetX,y:e.offsetY};this.prevPointerMovePos&&!Ra(a,this.prevPointerMovePos)&&(this.makeStrokeStraightTimer&&window.clearTimeout(this.makeStrokeStraightTimer),this.makeStrokeStraightTimer=window.setTimeout(function(){n.wetStrokeCollector.makeCurrentStrokeStraight(),n.forceInkRendererToLineMode(!0)},1e3)),this.prevPointerMovePos=a;var i=JE(e);null===(t=this.onPointerEvent)||void 0===t||t.call(this,i),this.ignoreStroke||(this.forceInkRendererToLineMode(i.shiftKey||this.inkRenderer.getIsLineMode()),this.output.onPointerMove(i))},e.prototype.onPointerUp=function(e){var t;this.makeStrokeStraightTimer&&window.clearTimeout(this.makeStrokeStraightTimer);var n=JE(e);if(null===(t=this.onPointerEvent)||void 0===t||t.call(this,n),this.ignoreStroke)this.ignoreStroke=!1;else{this.forceInkRendererToLineMode(n.shiftKey),this.output.onPointerUp(n);try{this.wetCanvas.releasePointerCapture(n.pointerId)}catch(e){}}},e.prototype.setDrawingBounds=function(e){this.drawingBounds=e},e}(),ZE=function(){function e(e){var t=this;this.onPointerOut=function(e){t.output.onPointerOut(e)},this.element=e}return e.prototype.activate=function(){this.element.addEventListener("pointerout",this.onPointerOut)},e.prototype.deactivate=function(){this.element.removeEventListener("pointerout",this.onPointerOut)},e}(),$E=function(){function e(){}return e.prototype.onPointerDown=function(e){this.output.onPointerDown(e),this.lastStrokeInProgressEvent=e},e.prototype.onPointerMove=function(e){this.output.onPointerMove(e),this.lastStrokeInProgressEvent=e},e.prototype.onPointerUp=function(e){this.output.onPointerUp(e),this.lastStrokeInProgressEvent=void 0},e.prototype.getLastStrokeInProgressEvent=function(){return this.lastStrokeInProgressEvent},e}(),eA=function(){function e(e,t,n){void 0===t&&(t=250),void 0===n&&(n=5),this.onLongPressPointerEvent=e,this.longPressMinimalDurationMs=t,this.longPressMaxDistanceCssPixels=n}return e.prototype.onPointerDown=function(e){this.resetLongPress(),this.pointerDownEventData=e,this.longPressTimerId=this.startLongPressTimer(),this.output.onPointerDown(e)},e.prototype.onPointerMove=function(e){var t,n,a;!this.pointerDownEventData||(t={x:e.x,y:e.y},n={x:this.pointerDownEventData.x,y:this.pointerDownEventData.y},a=this.longPressMaxDistanceCssPixels,Ba(t,n)<=a)||this.resetLongPress(),this.output.onPointerMove(e)},e.prototype.onPointerUp=function(e){this.pointerDownEventData&&this.resetLongPress(),this.output.onPointerUp(e)},e.prototype.resetLongPress=function(){this.pointerDownEventData=void 0,this.longPressTimerId&&(clearTimeout(this.longPressTimerId),this.longPressTimerId=void 0)},e.prototype.startLongPressTimer=function(){var e=this;return window.setTimeout(function(){e.pointerDownEventData&&e.onLongPressPointerEvent(e.pointerDownEventData)},this.longPressMinimalDurationMs)},e}(),tA=function(){function e(){}return e.prototype.onPointerDown=function(e){this.output.onPointerDown(e)},e.prototype.onPointerMove=function(e){this.output.onPointerMove(e)},e.prototype.onPointerUp=function(e){this.output.onPointerUp(e)},e}(),nA=function(){function e(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m){if(r?Kw(this.drawer=new bE(o),this.injector=new QE,n):Ww(this.drawer=$w(),new tE,this.injector=new QE,n),void 0!==window.PointerEvent){var _=new PE(e,d,l),h=new XE(i,a,s,c,n,u),b=new $E;qw(this.input=_,this.pointerEventTransform=h,b,f?new eA(f,p,m):new tA,this.drawer),Gw(this.inputPointerUpOnPointerOut=new ZE(e),function(e,t){return{onPointerOut:function(n){var a=t.getLastStrokeInProgressEvent();a&&e.head.onPointerUp(a)}}}(_,b))}else if(void 0!==window.TouchEvent){var g=new NE(e);Kw(g,new VE,this.drawer),this.input=g}else{var v=new xE(e);Kw(v,new OE,this.drawer),this.input=v}Gw(this.preventTouchStartOnStylusDown=new gE(t),new TE)}return e.prototype.activate=function(){var e;this.input.activate(),null===(e=this.inputPointerUpOnPointerOut)||void 0===e||e.activate(),this.activateStylus()},e.prototype.deactivate=function(){var e;this.deactivateStylus(),null===(e=this.inputPointerUpOnPointerOut)||void 0===e||e.deactivate(),this.input.deactivate()},e.prototype.activateStylus=function(){this.preventTouchStartOnStylusDown.activate()},e.prototype.deactivateStylus=function(){this.preventTouchStartOnStylusDown.deactivate()},e.prototype.setDrawingAttributes=function(e){this.injector.setDrawingAttributes(e)},e.prototype.setDrawingBounds=function(e){var t;null===(t=this.pointerEventTransform)||void 0===t||t.setDrawingBounds(e)},e}();class aA{constructor(e){this.isLoopActive=!1,this.animationCallback=()=>{this.delegate(),this.isLoopActive&&window.requestAnimationFrame(this.animationCallback)},this.delegate=e}onStrokeBegin(){this.isLoopActive=!0,window.requestAnimationFrame(this.animationCallback)}onStrokeEnd(){this.isLoopActive=!1}}function iA(e){throw e}class rA{constructor(e){this.context=e}beginPath(){this.context.beginPath()}arc(e,t,n,a,i,r){this.context.arc(e,t,n,a,i,r)}circularArc(e,t,n,a,i,r,o,s,c){let d=Math.atan2(t-a,e-n),l=Math.atan2(o-a,r-n);d=d<0?2*Math.PI+d:d,l=l<0?2*Math.PI+l:l,this.arc(n,a,i,d,l,c)}lineTo(e,t){this.context.lineTo(e,t)}moveTo(e,t){this.context.moveTo(e,t)}closePath(){this.context.closePath()}}class oA{toCSSColor(e){return function(e){return`rgba(${e.r},${e.g},${e.b},${e.a})`}(e)}}function sA(e,t,n=1e-6){return function(e,t=1e-6){return-t<=e&&e<=t}(e-t,n)}function cA(e){return 1.5*e+.25}class dA{constructor(e,t,n){this.incomingTangent1={x:Number.NaN,y:Number.NaN},this.incomingTangent2={x:Number.NaN,y:Number.NaN},this.outgoingTangent1={x:Number.NaN,y:Number.NaN},this.outgoingTangent2={x:Number.NaN,y:Number.NaN},this.center={x:e,y:t},this.radius=n}}class lA{constructor(e,t){this.stroke=[],this.builder=e,this.tipRadius=t.width/2}beginStroke(e){this.builder.beginPath(),this.stroke=[],this.addPoint(e)}addPoint(e){const t=new dA(e.x,e.y,this.tipRadius*cA(e.pressure));this.stroke.push(t)}endStroke(e){this.addPoint(e),function(e){for(let t=1;t<e.length;t++){const n=e[t-1],a=e[t],i=n.center.x,r=n.center.y,o=n.radius,s=a.center.x,c=a.center.y,d=a.radius,l=i-s,u=r-c,f=Math.sqrt(l*l+u*u),p=Math.abs(d-o);if(p>f)continue;const m=1/f,_=p*m;let h=Math.sqrt(1-_*_),b=l*m,g=u*m;o>d&&(h=-h,b=-b,g=-g);const v=b*_,y=g*_,S=b*h,D=g*h,I=v+D,x=y-S,C=v-D,O=y+S;n.outgoingTangent1.x=i+o*I,n.outgoingTangent1.y=r+o*x,n.outgoingTangent2.x=i+o*C,n.outgoingTangent2.y=r+o*O,a.incomingTangent1.x=s+d*I,a.incomingTangent1.y=c+d*x,a.incomingTangent2.x=s+d*C,a.incomingTangent2.y=c+d*O}}(this.stroke),function(e,t){let n=0;for(let a=0;a<t.length;a++)(a===t.length-1||isNaN(t[a].outgoingTangent1.x))&&(uA(e,t,n,a),n=a+1)}(this.builder,this.stroke),this.builder.closePath()}}function uA(e,t,n,a){if(n===a){const a=t[n];return e.moveTo(a.center.x-a.radius,a.center.y),e.circularArc(a.center.x-a.radius,a.center.y,a.center.x,a.center.y,a.radius,a.center.x+a.radius,a.center.y,!1,!0),void e.circularArc(a.center.x+a.radius,a.center.y,a.center.x,a.center.y,a.radius,a.center.x-a.radius,a.center.y,!1,!0)}let i=t[n];e.moveTo(i.outgoingTangent1.x,i.outgoingTangent1.y);let r,o=i;i=t[n+1];for(let s=n+1;s<a;s++){r=t[s+1];const n=fA(o.outgoingTangent1,i.incomingTangent1,i.outgoingTangent1,r.incomingTangent1);void 0!==n?e.lineTo(n.x,n.y):(e.lineTo(i.incomingTangent1.x,i.incomingTangent1.y),e.circularArc(i.incomingTangent1.x,i.incomingTangent1.y,i.center.x,i.center.y,i.radius,i.outgoingTangent1.x,i.outgoingTangent1.y,!1,!0)),o=i,i=r}const s=i.radius>t[a-1].radius;e.lineTo(i.incomingTangent1.x,i.incomingTangent1.y),e.circularArc(i.incomingTangent1.x,i.incomingTangent1.y,i.center.x,i.center.y,i.radius,i.incomingTangent2.x,i.incomingTangent2.y,s,!0),o=i,i=t[a-1];for(let s=a-1;s>n;s--){r=t[s-1];const n=fA(o.incomingTangent2,i.outgoingTangent2,i.incomingTangent2,r.outgoingTangent2);void 0!==n?e.lineTo(n.x,n.y):(e.lineTo(i.outgoingTangent2.x,i.outgoingTangent2.y),e.circularArc(i.outgoingTangent2.x,i.outgoingTangent2.y,i.center.x,i.center.y,i.radius,i.incomingTangent2.x,i.incomingTangent2.y,!1,!0)),o=i,i=r}const c=i.radius>t[n+1].radius;e.lineTo(i.outgoingTangent2.x,i.outgoingTangent2.y),e.circularArc(i.outgoingTangent2.x,i.outgoingTangent2.y,i.center.x,i.center.y,i.radius,i.outgoingTangent1.x,i.outgoingTangent1.y,c,!0)}function fA(e,t,n,a){if((a.x-n.x)*(t.y-e.y)-(t.x-e.x)*(a.y-n.y)>0)return;const i=t.y-e.y,r=e.x-t.x,o=i*e.x+r*e.y,s=a.y-n.y,c=n.x-a.x,d=s*n.x+c*n.y,l=i*c-s*r;if(function(e,t=1e-6){return e<-t||t<e}(l)){const u=1/l,f=(c*o-r*d)*u,p=(i*d-s*o)*u;if(pA(f,p,e,t)&&pA(f,p,n,a))return{x:f,y:p}}}function pA(e,t,n,a){return(Math.min(n.x,a.x)<e||sA(Math.min(n.x,a.x),e))&&(Math.max(n.x,a.x)>e||sA(Math.max(n.x,a.x),e))&&(Math.min(n.y,a.y)<t||sA(Math.min(n.y,a.y),t))&&(Math.max(n.y,a.y)>t||sA(Math.max(n.y,a.y),t))}function mA(e,t,n,a,i,r,o){const s=e.x-t,c=e.y-n,d=e.x+t,l=e.y+n,u=a.x-i,f=a.y-r,p=a.x+i,m=a.y+r;if(u>=s&&f>=c&&p<=d&&m<=l||s>=u&&c>=f&&d<=p&&l<=m)return!1;const _=a.x-e.x>0?1:-1,h=a.y-e.y>0?1:-1;return o.p1.x=e.x-h*t,o.p1.y=e.y+_*n,o.p2.x=e.x+h*t,o.p2.y=e.y-_*n,o.p3.x=a.x+h*i,o.p3.y=a.y-_*r,o.p4.x=a.x-h*i,o.p4.y=a.y+_*r,!0}const _A=2*Math.PI;function hA(e,t,n){e.arc(t.x,t.y,n,0,_A)}function bA(e,t,n,a){const i=t.x-n,r=t.x+n,o=t.y-a,s=t.y+a;e.moveTo(i,o),e.lineTo(r,o),e.lineTo(r,s),e.lineTo(i,s),e.lineTo(i,o)}function gA(e,t){e.moveTo(t.p1.x,t.p1.y),e.lineTo(t.p2.x,t.p2.y),e.lineTo(t.p3.x,t.p3.y),e.lineTo(t.p4.x,t.p4.y),e.lineTo(t.p1.x,t.p1.y)}class vA{constructor(e,t){this.quad={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}},this.builder=e,this.tipRadius=t.width/2}beginStroke(e){this.builder.beginPath(),this.updateRadius(e),hA(this.builder,e,this.radius),this.lastPoint=e}addPoint(e){this.updateRadius(e),function(e,t,n,a,i){const r=n.x-e.x,o=n.y-e.y,s=Math.sqrt(r*r+o*o);if(s<=Math.abs(a-t))return!1;const c=r/s,d=-o/s,l=(a-t)/s,u=Math.sqrt(1-l*l),f=d*u+c*l,p=c*u-d*l,m=d*u-c*l,_=c*u+d*l;return i.p1.x=e.x-f*t,i.p1.y=e.y-p*t,i.p2.x=n.x-f*a,i.p2.y=n.y-p*a,i.p3.x=n.x+m*a,i.p3.y=n.y+_*a,i.p4.x=e.x+m*t,i.p4.y=e.y+_*t,!0}(e,this.radius,this.lastPoint,this.lastRadius,this.quad)&&(gA(this.builder,this.quad),hA(this.builder,e,this.radius)),this.lastPoint=e}endStroke(e){this.addPoint(e),this.builder.closePath()}updateRadius(e){this.lastRadius=this.radius,this.radius=this.tipRadius*cA(e.pressure)}}class yA{constructor(e){this.builder=e}beginStroke(e){this.builder.beginPath(),this.builder.moveTo(e.x,e.y)}addPoint(e){this.builder.lineTo(e.x,e.y)}endStroke(e){this.addPoint(e)}}class SA{constructor(e,t,n,a){this.center={x:e,y:t},this.halfWidth=n,this.halfHeight=a}}class DA{constructor(e,t){this.stroke=[],this.quads=[],this.builder=e,this.tipWidth=t.width/2,this.tipHeight=t.height/2}beginStroke(e){this.builder.beginPath(),this.stroke=[],this.quads=[],this.addPoint(e)}addPoint(e){const t=cA(e.pressure),n=new SA(e.x,e.y,this.tipWidth*t,this.tipHeight*t),a=this.stroke.length;a>0&&function(e,t,n){const a={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}};mA(e.center,e.halfWidth,e.halfHeight,t.center,t.halfWidth,t.halfHeight,a)&&n.push(a)}(this.stroke[a-1],n,this.quads),this.stroke.push(n)}endStroke(e){this.addPoint(e),function(e,t,n){if(IA(e,t[0]),0!==n.length){e.moveTo(n[0].p1.x,n[0].p1.y);for(let t=0;t<n.length;t++)e.lineTo(n[t].p2.x,n[t].p2.y),e.lineTo(n[t].p3.x,n[t].p3.y);for(let t=n.length-1;t>=0;t--)e.lineTo(n[t].p4.x,n[t].p4.y),e.lineTo(n[t].p1.x,n[t].p1.y);t.length>2&&IA(e,t[t.length-2]),IA(e,t[t.length-1])}}(this.builder,this.stroke,this.quads),this.builder.closePath()}}function IA(e,t){bA(e,t.center,t.halfWidth,t.halfHeight)}class xA{constructor(e,t){this.quad={p1:{x:0,y:0},p2:{x:0,y:0},p3:{x:0,y:0},p4:{x:0,y:0}},this.builder=e,this.tipHalfWidth=t.width/2,this.tipHalfHeight=t.height/2}beginStroke(e){this.builder.beginPath(),this.updateSize(e),bA(this.builder,e,this.halfWidth,this.halfHeight),this.lastPoint=e}addPoint(e){this.updateSize(e),mA(e,this.halfWidth,this.halfHeight,this.lastPoint,this.lastHalfWidth,this.lastHalfHeight,this.quad)&&(gA(this.builder,this.quad),bA(this.builder,e,this.halfWidth,this.halfHeight)),this.lastPoint=e}endStroke(e){this.addPoint(e),this.builder.closePath()}updateSize(e){this.lastHalfWidth=this.halfWidth,this.lastHalfHeight=this.halfHeight;const t=cA(e.pressure);this.halfWidth=this.tipHalfWidth*t,this.halfHeight=this.tipHalfHeight*t}}class CA{constructor(e,t,n=new oA){this.renderMode=0,this.context=e,this.canvasPathBuilder=new rA(e),this.effectResolver=t,this.colorResolver=n}setDrawingAttributes(e){this.attributes=e}beginStroke(e){this.pathBuilder=this.makeNewPathBuilder(),this.pathBuilder.beginStroke(e),this.beginPoint=e}addPoint(e){this.pathBuilder.addPoint(e)}endStroke(e){this.pathBuilder.endStroke(e),this.context.save(),function(e,t,n,a,i){e.lineWidth=t.height;const r=function(e,t,n,a,i){if(1===t.effect.type){const a=t.effect,r=n.toCanvasImageSource(a);if(void 0!==r){const n=e.createPattern(r,"repeat");if(null!==n){const r=.5;return e.scale(r,r),e.lineWidth=t.width/r,e.translate(i.x-a.offsetX,i.y-a.offsetY),n}}}return a.toCSSColor(t.color,t)}(e,t,n,a,i);switch(e.strokeStyle=r,e.fillStyle=r,t.tip){case"ellipse":e.lineCap="round",e.lineJoin="round";break;case"rectangle":e.lineCap="butt",e.lineJoin="miter";break;default:iA(t.tip)}switch(t.rasterOperation){case"copy":e.globalCompositeOperation="source-over";break;case"mask":e.globalCompositeOperation="darken";break;default:iA(t.rasterOperation)}}(this.context,this.attributes,this.effectResolver,this.colorResolver,this.beginPoint),2===this.renderMode?this.context.stroke():this.context.fill(),this.context.restore()}makeNewPathBuilder(){switch(this.renderMode){case 0:return"ellipse"===this.attributes.tip?new vA(this.canvasPathBuilder,this.attributes):new xA(this.canvasPathBuilder,this.attributes);case 1:return"ellipse"===this.attributes.tip?new lA(this.canvasPathBuilder,this.attributes):new DA(this.canvasPathBuilder,this.attributes);case 2:return new yA(this.canvasPathBuilder);default:iA(this.renderMode)}}}class OA{toCanvasImageSource(){}toSVGImageElement(){}}const wA={alpha:!0,desynchronized:!1};function EA(e){return function(e,t){const n=e.getContext("2d",t);if(null===n)throw new Error("Could not get 2D context from canvas.");return n}(e,wA)}var AA=function(){function e(e,t){var n,a=this;this.strokeBeginEndListener={onStrokeBegin:function(){a.renderLoop.onStrokeBegin()},onStrokeEnd:function(){a.renderLoop.onStrokeEnd()}},this.isIncrementalRender=!0,this.render=function(){a.isIncrementalRender||a.clear(),a.store.streamWetStroke(a.wetRenderer,a.isIncrementalRender)},this.store=t,this.wetCanvasContext=EA(e),this.wetRenderer=(n=this.wetCanvasContext,new CA(n,new OA)),this.renderLoop=new aA(this.render)}return e.prototype.clear=function(){var e;(e=this.wetCanvasContext).save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},e.prototype.setIncrementalRender=function(e){this.isIncrementalRender=e},e.prototype.onStrokeBegin=function(){this.strokeBeginEndListener.onStrokeBegin()},e.prototype.onStrokeEnd=function(){this.strokeBeginEndListener.onStrokeEnd()},e.prototype.setIsLineMode=function(e){this.store.setIsLineMode(e)},e.prototype.getIsLineMode=function(){return this.store.getIsLineMode()},e}();function LA(){}class kA{constructor(){this.baseId=0}generate(){return this.baseId+=1}setBaseId(e){this.baseId=e}}class MA{constructor(){this.id=0,this.drawingAttributes=GE,this.points=[]}streamChannels(e){this.points.forEach(t=>{e.addPoint(t),e.addPressure(function(e){return e.pressure}(t)),e.addTilt(t),e.addTimestamp(function(e){return e.timestamp}(t))})}streamPoints(e){this.points.forEach(t=>{e.add(t)})}streamPath(e){PA(this,e,0)}stream(e){TA(this,e,0)}add(e){this.points.push(e)}}function PA(e,t,n){if(n+2>e.points.length)return n;t.beginStroke(e.points[n]);for(let a=n+1;a<e.points.length-1;a+=1)t.addPoint(e.points[a]);return t.endStroke(e.points[e.points.length-1]),e.points.length-1}function TA(e,t,n){return t.setDrawingAttributes(e.drawingAttributes),PA(e,t,n)}class UA{constructor(e){this.idGenerator=new kA,this.currentStroke=new MA,this.isLineMode=!1,this.inputStrokes=[],this.newPointsIndex=0,this.noop={add:LA},this.output=this.noop,this.beginEndSink=e}setDrawingAttributes(e){this.currentStroke.drawingAttributes=e}beginStroke(e){this.newPointsIndex=0,this.currentStroke.id=this.idGenerator.generate(),this.beginEndSink.onStrokeBegin(),this.output=this.currentStroke,this.output.add(this.isLineMode?this.getConstantPressurePoint(e):e)}addPoint(e){this.isLineMode&&1===this.currentStroke.points.length?this.output.add(this.getConstantPressurePoint(e)):this.isLineMode&&this.currentStroke.points.length>1?this.currentStroke.points[this.currentStroke.points.length-1]=this.getConstantPressurePoint(e):this.output.add(e)}endStroke(e){this.output!==this.noop&&(this.isLineMode&&this.currentStroke.points.length>1?this.currentStroke.points[this.currentStroke.points.length-1]=this.getConstantPressurePoint(e):this.output.add(e),this.inputStrokes.push([this.currentStroke,this.newPointsIndex]),this.cancel())}makeCurrentStrokeStraight(){const e=this.currentStroke.points.length;e>=2&&(this.linePressure=this.getAveragePressureAcrossStroke(this.currentStroke),0===this.linePressure&&(this.linePressure=Qw),this.currentStroke.points.splice(1,e-2),this.currentStroke.points[0]=this.getConstantPressurePoint(this.currentStroke.points[0]),this.currentStroke.points[1]=this.getConstantPressurePoint(this.currentStroke.points[1]))}cancel(){this.output!==this.noop&&(this.output=this.noop,this.linePressure=void 0,this.currentStroke=new MA,this.beginEndSink.onStrokeEnd())}streamCollectedStrokes(e){this.inputStrokes.forEach(t=>{e.add(t[0]),t[1]=t[0].points.length-1})}streamCollectedStrokesNewPoints(e){this.inputStrokes.forEach(t=>{t[1]=TA(t[0],e,t[1])})}resetCollectedStrokes(){this.inputStrokes=[]}streamCurrentStroke(e){this.newPointsIndex=TA(this.currentStroke,e,0)}streamCurrentStrokeNewPoints(e){this.newPointsIndex=TA(this.currentStroke,e,this.newPointsIndex)}getAveragePressureAcrossStroke(e){let t=0;for(let n=0;n<e.points.length;n+=1)t+=e.points[n].pressure;return 0===t||0===e.points.length?0:t/e.points.length}getConstantPressurePoint(e){return void 0===this.linePressure&&(this.linePressure=0===e.pressure?Qw:e.pressure),{x:e.x,y:e.y,pressure:this.linePressure,tiltX:e.tiltX,tiltY:e.tiltY,timestamp:e.timestamp}}}var FA=function(){function e(){var e=this;this.collectedWetStrokesSink=null,this.wetStrokeCollector=new UA({onStrokeBegin:function(){e.wetInkDryer.onStrokeBegin()},onStrokeEnd:function(){e.wetInkDryer.onStrokeEnd()}})}return e.prototype.streamWetStroke=function(e,t){t?(this.wetStrokeCollector.streamCurrentStrokeNewPoints(e),this.wetStrokeCollector.streamCollectedStrokesNewPoints(e)):(this.wetStrokeCollector.streamCurrentStroke(e),this.wetStrokeCollector.streamCollectedStrokes({add:function(t){t.stream(e)}}))},e.prototype.setCollectedWetStrokesSink=function(e){this.collectedWetStrokesSink=e},e.prototype.clearCollectedWetStrokesSink=function(){this.collectedWetStrokesSink=null},e.prototype.setInkDryer=function(e){this.wetInkDryer=e,this.initializeDryStrokesCallback()},e.prototype.initializeDryStrokesCallback=function(){var e=this;this.wetInkDryer.setTask(function(){e.wetStrokeCollector.streamCollectedStrokes({add:function(t){var n;null===(n=e.collectedWetStrokesSink)||void 0===n||n.add(t)}}),e.wetStrokeCollector.resetCollectedStrokes()})},e.prototype.dryAllStrokes=function(){this.wetInkDryer.dryAllStrokes()},e.prototype.getWetStrokeCollector=function(){return this.wetStrokeCollector},e.prototype.setIsLineMode=function(e){this.wetStrokeCollector.isLineMode=e},e.prototype.getIsLineMode=function(){return this.wetStrokeCollector.isLineMode},e}(),HA=function(){function e(e,t){var n=this;this.task=function(){},this.executeTask=function(){n.task(),n.renderer.clear(),n.resetPendingTask()},this.renderer=e,this.idleTimeToDryInkInMs=t}return e.prototype.setTask=function(e){this.task=e},e.prototype.onStrokeBegin=function(){this.renderer.onStrokeBegin(),void 0!==this.timeoutTask&&this.resetPendingTask()},e.prototype.onStrokeEnd=function(){this.renderer.onStrokeEnd(),this.timeoutTask=window.setTimeout(this.executeTask,this.idleTimeToDryInkInMs)},e.prototype.dryAllStrokes=function(){this.executeTask(),this.resetPendingTask()},e.prototype.resetPendingTask=function(){window.clearTimeout(this.timeoutTask)},e}();function RA(e,t){var n=ma(e);if(!n)throw new Error("A valid color must be provided: ".concat(e));return{r:n.r,g:n.g,b:n.b,a:t}}function NA(e){var t=new WE,n=e.inkType,a=e.htmlColor,i=e.thicknessInCssPixels;switch(n){case os.Highlighter:var r=RA(a,.5);t.setTip("rectangle").setWidth(i/2).setHeight(i).setColor(r).setRasterOperation("copy");break;case os.Pen:r=RA(a,1),t.setTip("ellipse").setWidth(i).setHeight(i).setColor(r).setRasterOperation("copy");break;default:throw new h(n)}return t.build()}function BA(e){var t=EA(e),n=e.width/(e.clientWidth||1),a=e.height/(e.clientHeight||1);t.setTransform(1,0,0,1,0,0),t.scale(n,a)}var jA=function(){function e(e,t,n,a,i,r,o,s,c,d,l,u){this.wetCanvas=e,BA(e),this.store=new FA,this.renderer=new AA(this.wetCanvas,this.store);var f=new HA(this.renderer,a);this.store.setInkDryer(f),this.pipeline=new nA(this.wetCanvas,t,this.store.getWetStrokeCollector(),f,this.wetCanvas,i,r,this.renderer,n,o,s,c,d,l,u)}return e.prototype.startPipeline=function(){this.pipeline.activate(),this.enableCanvasPointerEvents()},e.prototype.stopPipeline=function(){this.disableCanvasPointerEvents(),this.renderer.clear(),this.pipeline.deactivate()},e.prototype.enableCanvasPointerEvents=function(){this.wetCanvas.style.pointerEvents="auto"},e.prototype.disableCanvasPointerEvents=function(){this.wetCanvas.style.pointerEvents="none"},e.prototype.updateInkAttributes=function(e){var t=NA(e);this.pipeline.setDrawingAttributes(t)},e.prototype.setCollectedWetStrokesSink=function(e){this.store.setCollectedWetStrokesSink(e)},e.prototype.clearCollectedWetStrokesSink=function(){this.store.clearCollectedWetStrokesSink()},e.prototype.onCanvasDimensionsUpdated=function(e){BA(e)},e.prototype.dryAllStrokes=function(){this.store.dryAllStrokes()},e.prototype.setDrawingBounds=function(e){this.pipeline.setDrawingBounds(e)},e.prototype.getLineMode=function(){return this.store.getIsLineMode()?rs.StraightLine:rs.FreeHand},e}();function VA(e,t){return{x:t.x,y:t.y,pressure:Qw,tiltX:0,tiltY:0,timestamp:e.timeStamp}}var zA=function(){return zA=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},zA.apply(this,arguments)},GA=function(){return GA=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},GA.apply(this,arguments)},KA=Object(s.memo)(function(e){var t=e.cropViewTransform,n=e.cssToPhysicalPixelRatio,a=e.imageViewTransform,i=e.width,r=e.height,o=e.cssWidth,d=e.cssHeight,l=e.styles,u=e.setActiveMarkupToolType,f=e.setPointerIdToCaptureWhenEraserBrushIsCreated,p=e.activeInkBrush,m=e.setStrokeShapeTipVisibilityState,_=e.setMarkupCursorScreenPosition,h=e.moveMarkupCursorScreenPositionBy,b=e.addMarkupContent,g=e.cursorScreenPos,v=e.setIsKeyboardInputActive,y=e.setShowInkStylePicker,S=e.linePreviewCoords,D=e.setLinePreviewCoords,I=e.isEditorFocused,x=e.isKeyboardInputActive,C=e.onLongPressAtStrokeStartPointerEvent,O=e.longPressMinimalDurationMs,w=e.longPressMaxDistanceCssPixels,E=e.onPointerEvent,A=Object(s.useContext)(Iw),L=A.wetInkCanvas,k=A.setWetInkCanvas,M=Object(s.useRef)(),P=Object(s.useState)(null),T=P[0],U=P[1],F=Object(s.useState)(null),H=F[0],R=F[1];return up(H),Object(s.useEffect)(function(){if(H&&T){var e=function(e,t,n,a,i,r,o,s,c){return new jA(e,t,n,0,!0,.5,a,i,r,o,s,c)}(H,T,p,_,v,function(e){"pointerdown"===e.type&&(m("alreadyShown"),YE(e)&&(f(e.pointerId),u(gs))),null==E||E(e)},C,O,w);e.startPipeline(),k(e)}return function(){var e;null===(e=M.current)||void 0===e||e.stopPipeline(),k(void 0)}},[p,H,u,_,f,m,v,k,T,C,O,w,E]),M.current=L,function(e,t,n,a){var i=Object(s.useCallback)(function(){if(e){var i=(null==t?void 0:t.clientWidth)||0,r=(null==t?void 0:t.clientHeight)||0;e.style.width="".concat(i,"px"),e.style.height="".concat(r,"px"),function(e,t){if(e){e.restore(),e.save(),e.beginPath();var n=oi(t),a=n[0],i=n[1],r=n[2],o=n[3];e.moveTo(a.x,a.y),e.lineTo(i.x,i.y),e.lineTo(r.x,r.y),e.lineTo(o.x,o.y),e.clip()}}(e.getContext("2d"),a),null==n||n.onCanvasDimensionsUpdated(e)}},[e,a,t,n]);fy(t,i)}(H,T,L,t),function(e,t,n){Object(s.useEffect)(function(){var a=vi(ci(Ka(1/n),t));null==e||e.setDrawingBounds(a)},[t,n,e])}(L,t,n),function(e,t,n){Object(s.useEffect)(function(){n&&t||e({})},[e,n,t])}(D,x,I),function(e,t,n,a,i,r,o,c,d){var l=Object(s.useState)(!1),u=l[0],f=l[1],p=Object(s.useContext)(Wb).enableMarkupKeyboarding,m=Object(s.useCallback)(function(e){var n,a=null!==(n=c.startPoint)&&void 0!==n?n:{x:t.x,y:t.y},i=Ea(t,zA({x:0,y:0},e));d({startPoint:a,endPoint:i})},[t,d,c.startPoint]),_=Object(s.useCallback)(function(e){if(e&&c.startPoint&&c.endPoint){var t=new MA,n=VA(e,c.startPoint);t.points.push(n);var a=VA(e,c.endPoint);return t.points.push(a),t}},[c]),h=Object(s.useCallback)(function(e){var t=_(e);t&&n({points:t.points,drawingAttributes:NA(r),arrowMode:r.strokeShape.arrowMode||is.NoArrow,contentType:R_.InkContent,invertedPhysicalImageTransformDuringContentSerialization:ci(ei(a),Ka(i))}),d({})},[r,n,d,_,i,a]),b=Object(s.useMemo)(function(){return[{code:"KeyD",keyCode:Uy.D,handler:function(t,n){t?(o(!1),e({x:1}),u&&m({x:1})):u&&h(n)},ctrlKey:!1,shiftKey:!1},{code:"KeyA",keyCode:Uy.A,handler:function(t,n){t?(o(!1),e({x:-1}),u&&m({x:-1})):u&&h(n)},ctrlKey:!1,shiftKey:!1},{code:"KeyS",keyCode:Uy.S,handler:function(t,n){t?(o(!1),e({y:1}),u&&m({y:1})):u&&h(n)},ctrlKey:!1,shiftKey:!1},{code:"KeyW",keyCode:Uy.W,handler:function(t,n){t?(o(!1),e({y:-1}),u&&m({y:-1})):u&&h(n)},ctrlKey:!1,shiftKey:!1},{code:"ArrowRight",keyCode:Uy.ArrowRight,handler:function(t,n){t?(o(!1),e({x:1}),u&&m({x:1})):u&&h(n)},ctrlKey:!0,shiftKey:!1},{code:"ArrowLeft",keyCode:Uy.ArrowLeft,handler:function(t,n){t?(o(!1),e({x:-1}),u&&m({x:-1})):u&&h(n)},ctrlKey:!0,shiftKey:!1},{code:"ArrowDown",keyCode:Uy.ArrowDown,handler:function(t,n){t?(o(!1),e({y:1}),u&&m({y:1})):u&&h(n)},ctrlKey:!0,shiftKey:!1},{code:"ArrowUp",keyCode:Uy.ArrowUp,handler:function(t,n){t?(o(!1),e({y:-1}),u&&m({y:-1})):u&&h(n)},ctrlKey:!0,shiftKey:!1},{code:"KeyD",keyCode:Uy.D,handler:function(t){t&&(o(!1),e({x:1}),m({x:1}))},ctrlKey:!1,shiftKey:!0},{code:"KeyA",keyCode:Uy.A,handler:function(t){t&&(o(!1),e({x:-1}),m({x:-1}))},ctrlKey:!1,shiftKey:!0},{code:"KeyS",keyCode:Uy.S,handler:function(t){t&&(o(!1),e({y:1}),m({y:1}))},ctrlKey:!1,shiftKey:!0},{code:"KeyW",keyCode:Uy.W,handler:function(t){t&&(o(!1),e({y:-1}),m({y:-1}))},ctrlKey:!1,shiftKey:!0},{code:"ArrowRight",keyCode:Uy.ArrowRight,handler:function(t){t&&(o(!1),e({x:1}),m({x:1}))},ctrlKey:!0,shiftKey:!0},{code:"ArrowLeft",keyCode:Uy.ArrowLeft,handler:function(t){t&&(o(!1),e({x:-1}),m({x:-1}))},ctrlKey:!0,shiftKey:!0},{code:"ArrowDown",keyCode:Uy.ArrowDown,handler:function(t){t&&(o(!1),e({y:1}),m({y:1}))},ctrlKey:!0,shiftKey:!0},{code:"ArrowUp",keyCode:Uy.ArrowUp,handler:function(t){t&&(o(!1),e({y:-1}),m({y:-1}))},ctrlKey:!0,shiftKey:!0},{code:"ShiftLeft",keyCode:Uy.Shift,handler:function(e,t){e||h(t)},ctrlKey:!1,shiftKey:!1},{code:"ShiftLeft",keyCode:Uy.Shift,handler:function(e,t){e||h(t)},ctrlKey:!0,shiftKey:!1},{code:"Space",keyCode:Ny,handler:function(e){f(e)},ctrlKey:!1,shiftKey:!1},{code:"Space",keyCode:Ny,handler:function(e){f(e)},ctrlKey:!0,shiftKey:!1}]},[o,e,m,h,u]);My(window,p?b:[],!0)}(h,g,b,a,n,p,y,S,D),c.a.createElement("div",{ref:U,style:{width:o,height:d,position:"absolute",top:0,left:0}},c.a.createElement("canvas",{ref:R,width:i,height:r,style:GA({touchAction:"none",pointerEvents:"none",position:"absolute",top:0,left:0},l)}))}),WA=function(){return WA=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},WA.apply(this,arguments)},qA=function(){return qA=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},qA.apply(this,arguments)};function QA(e,t){if((null==e?void 0:e.contentType)===R_.TextContent){if(t&&"text"in t&&"string"==typeof t.text&&"styles"in t){var n=function(e){return ci(e.fabricToViewTransform,ei(bi(_i(e.calcTransformMatrix()))))}(t);return qA(qA({},e),{text:t.text,drawingAttributes:qA(qA({},t.toObject()),{styles:t.styles}),invertedPhysicalImageTransformDuringContentSerialization:n})}throw new Error("Fabric Textbox not found")}throw new Error("Unhandled Fabric Object type:"+(null==t?void 0:t.type))}var YA,JA=function(){return JA=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},JA.apply(this,arguments)},XA={bottomLeft:"bl",bottomRight:"br",middleBottom:"mb",middleLeft:"ml",middleRight:"mr",middleTop:"mt",topLeft:"tl",topRight:"tr",rotationHandle:"mtr"};function ZA(e,t){var n=e.textLines.length-1,a=e._measureWord([" "],0,0);return e.textLines.reduce(function(n,a,i){return n+e._measureWord(t.util.string.graphemeSplit(a),i,n+a.length)},0)+n*a}class $A{constructor(e,t,n){this.arrowLength=e*Math.cos(t/2),this.arrowWidth=e*Math.sin(t/2),this.directionThreshold=n}getArrowhead(e){const t=this.getDirection();if(null===t)return null;const n=Math.sqrt(uE(t,t)),a={x:t.x/n,y:t.y/n},i=-a.y,r=a.x,o=Object.assign(Object.assign({},e),{pressure:this.getPressure()});return{vertex:o,left:{x:o.x-this.arrowLength*a.x+this.arrowWidth*i,y:o.y-this.arrowLength*a.y+this.arrowWidth*r,pressure:o.pressure,tiltX:o.tiltX,tiltY:o.tiltY,timestamp:o.timestamp},right:{x:o.x-this.arrowLength*a.x-this.arrowWidth*i,y:o.y-this.arrowLength*a.y-this.arrowWidth*r,pressure:o.pressure,tiltX:o.tiltX,tiltY:o.tiltY,timestamp:o.timestamp}}}}class eL extends $A{constructor(e,t,n){super(e,t,n),this.candidatePoints=[]}addPoint(e){if(0===this.candidatePoints.length)this.candidatePoints.push(e);else{for(;this.candidatePoints.length>0&&Math.sqrt(pE(this.candidatePoints[0],e))>this.directionThreshold;)this.nearestPointFartherThanThreshold=this.candidatePoints[0],this.candidatePoints.shift();this.candidatePoints.push(e)}}getDirection(){return void 0===this.nearestPointFartherThanThreshold?null:fE(this.candidatePoints[this.candidatePoints.length-1],this.nearestPointFartherThanThreshold)}getPressure(){return Math.max(...Array.from(this.candidatePoints).map(e=>e.pressure),this.nearestPointFartherThanThreshold.pressure)}}class tL extends $A{constructor(e,t,n){super(e,t,n),this.pressure=Qw,this.nextPoints=[]}addPoint(e){0===this.nextPoints.length?(this.nextPoints.push(e),this.pressure=e.pressure):1===this.nextPoints.length&&(this.pressure=Math.max(this.pressure,e.pressure),Math.sqrt(pE(this.nextPoints[0],e))>this.directionThreshold&&this.nextPoints.push(e))}getDirection(){return this.nextPoints.length<=1?null:fE(this.nextPoints[0],this.nextPoints[1])}getPressure(){return this.pressure}}class nL extends $A{constructor(){super(...arguments),this.initialPoint=null,this.psudoStartPoint=null,this.psudoEndPoint=null}addPoint(e){null!==this.initialPoint&&null!==this.psudoEndPoint&&null!==this.psudoStartPoint||(this.initialPoint=this.psudoStartPoint=this.psudoEndPoint=e),((e.x-this.initialPoint.x)*(this.psudoEndPoint.x-this.psudoStartPoint.x)<0||(e.y-this.initialPoint.y)*(this.psudoEndPoint.y-this.psudoStartPoint.y)<0)&&([this.psudoStartPoint,this.psudoEndPoint]=[this.psudoEndPoint,this.psudoStartPoint]),(Math.abs(e.x-this.initialPoint.x)>Math.abs(this.psudoEndPoint.x-this.initialPoint.x)||Math.abs(e.y-this.initialPoint.y)>Math.abs(this.psudoEndPoint.y-this.initialPoint.y))&&(this.psudoEndPoint=e)}getDirection(){return null===this.initialPoint||null===this.psudoEndPoint||null===this.psudoStartPoint||Math.sqrt(pE(this.psudoEndPoint,this.psudoStartPoint))<this.directionThreshold?null:fE(this.psudoEndPoint,this.psudoStartPoint)}getStartPoint(){return this.psudoStartPoint}getEndPoint(){return this.psudoEndPoint}}class aL extends nL{getArrowhead(){const e=this.getStartPoint();return e?super.getArrowhead(e):null}getPressure(){var e,t;return null!==(t=null===(e=this.getStartPoint())||void 0===e?void 0:e.pressure)&&void 0!==t?t:Qw}getDirection(){const e=super.getDirection();return e?{x:-1*(t=e).x,y:-1*t.y}:null;var t}}class iL extends nL{getArrowhead(e){const t=this.getEndPoint();return t?super.getArrowhead(t):null}getPressure(){var e,t;return null!==(t=null===(e=this.getEndPoint())||void 0===e?void 0:e.pressure)&&void 0!==t?t:Qw}}class rL{constructor(e,t,n,a,i){this.strokeLengthThreshold=n,this.isStraightLine=i,this.startArrowAdder=new tL(e,t,a),this.startArrowAdderForStraightLine=new aL(e,t,a),this.endArrowAdder=i?new iL(e,t,a):new eL(e,t,a),this.pendingPoints=[],this.strokeLength=0}beginStroke(e){this.prevPoint=e,this.endArrowAdder.addPoint(e),this.isStraightLine?this.startArrowAdderForStraightLine.addPoint(e):this.startArrowAdder.addPoint(e),this.pendingPoints.push(e)}addPoint(e){this.strokeLength+=Math.sqrt(pE(e,this.prevPoint)),this.isStraightLine?this.startArrowAdderForStraightLine.addPoint(e):this.startArrowAdder.addPoint(e),null!==this.startArrowAdder.getDirection()&&this.strokeLength>this.strokeLengthThreshold?this.validateAndAddStartArrowhead(!this.isStraightLine):this.pendingPoints.push(e),this.endArrowAdder.addPoint(e),0===this.pendingPoints.length&&this.output.addPoint(e),this.prevPoint=e}endStroke(e){if(this.strokeLength+=Math.sqrt(pE(e,this.prevPoint)),this.isStraightLine?(this.startArrowAdderForStraightLine.addPoint(e),this.addStartArrowheadForStraightLine(this.strokeLength>this.strokeLengthThreshold)):(this.startArrowAdder.addPoint(e),this.validateAndAddStartArrowhead(this.strokeLength>this.strokeLengthThreshold)),this.endArrowAdder.addPoint(e),this.strokeLength>this.strokeLengthThreshold){const t=this.endArrowAdder.getArrowhead(e);null!==t&&(this.output.addPoint(t.vertex),this.output.addPoint(t.left),this.output.addPoint(t.vertex),this.output.addPoint(t.right),this.output.addPoint(t.vertex))}this.output.endStroke(e)}validateAndAddStartArrowhead(e){0!==this.pendingPoints.length&&(this.pendingPoints.forEach((t,n)=>{if(0===n){this.output.beginStroke(t);const n=this.startArrowAdder.getArrowhead(t);null!==n&&e&&(this.output.addPoint(n.vertex),this.output.addPoint(n.left),this.output.addPoint(n.vertex),this.output.addPoint(n.right),this.output.addPoint(n.vertex))}else this.output.addPoint(t)}),this.pendingPoints=[])}addStartArrowheadForStraightLine(e){this.pendingPoints.forEach(e=>{this.output.addPoint(e)}),this.pendingPoints=[];const t=this.startArrowAdderForStraightLine.getArrowhead();null!==t&&e&&(this.output.addPoint(t.vertex),this.output.addPoint(t.left),this.output.addPoint(t.vertex),this.output.addPoint(t.right),this.output.addPoint(t.vertex))}}class oL{constructor(e,t,n,a,i){this.strokeLengthThreshold=n,this.endArrowAdder=i?new iL(e,t,a):new eL(e,t,a),this.strokeLength=0}beginStroke(e){this.prevPoint=e,this.endArrowAdder.addPoint(e),this.output.beginStroke(e)}addPoint(e){this.strokeLength+=Math.sqrt(pE(e,this.prevPoint)),this.endArrowAdder.addPoint(e),this.prevPoint=e,this.output.addPoint(e)}endStroke(e){if(this.strokeLength+=Math.sqrt(pE(e,this.prevPoint)),this.endArrowAdder.addPoint(e),this.strokeLength>this.strokeLengthThreshold){const t=this.endArrowAdder.getArrowhead(e);null!==t&&(this.output.addPoint(t.vertex),this.output.addPoint(t.left),this.output.addPoint(t.vertex),this.output.addPoint(t.right),this.output.addPoint(t.vertex))}this.output.endStroke(e)}}!function(e){e[e.NoArrow=0]="NoArrow",e[e.InkSingleArrow=1]="InkSingleArrow",e[e.InkDoubleArrow=2]="InkDoubleArrow"}(YA||(YA={}));const sL=3*Math.sqrt(2),cL=Math.PI/2;class dL{constructor(e=1){this.path="",this.precision=e}beginPath(){this.path=""}arc(e,t,n){const a=this.format(n),i=this.format(t),r=this.format(e-n),o=this.format(e+n);this.path+=`M${r},${i}`,this.path+=`A${a},${a} 0 0,1 ${o},${i}`,this.path+=`A${a},${a} 0 0,1 ${r},${i}`}circularArc(e,t,n,a,i,r,o,s,c){this.path+=`A${this.format(i)},${this.format(i)} 0 ${s?1:0} ${c?0:1} ${this.format(r)},${this.format(o)}`}lineTo(e,t){this.path+=`L${this.format(e)},${this.format(t)}`}moveTo(e,t){this.path+=`M${this.format(e)},${this.format(t)}`}closePath(){}getPath(){return this.path}format(e){return t=e,n=this.precision,`${parseFloat(t.toFixed(n))}`;var t,n}}var lL=function(){return lL=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},lL.apply(this,arguments)};function uL(e,t,n){for(var a=Number.POSITIVE_INFINITY,i=e,r=0,o=t;r<o.length;r++){var s=o[r];if(s!==e){var c=pE(s,e);c<a&&(a=c,i=lL(lL({},e),{x:s.x,y:s.y}))}}return a<n?i:e}var fL=function(){function e(e,t,n,a){void 0===a&&(a=1),this.attributes=e,this.svgPathBuilder=new dL(a),this.snappingPoints=this.getMarkupContentStartAndEndPoints(t),this.lineMode=n}return e.prototype.beginStroke=function(e){this.output="ellipse"===this.attributes.tip?new lA(this.svgPathBuilder,this.attributes):new xA(this.svgPathBuilder,this.attributes),this.output.beginStroke(this.lineMode===rs.StraightLine?uL(e,this.snappingPoints,25):e)},e.prototype.addPoint=function(e){this.output.addPoint(e)},e.prototype.endStroke=function(e){this.output.endStroke(this.lineMode===rs.StraightLine?uL(e,this.snappingPoints,25):e)},e.prototype.getSvgAttributes=function(){var e=new oA;return{path:this.svgPathBuilder.getPath(),fill:e.toCSSColor(this.attributes.color)}},e.prototype.getMarkupContentStartAndEndPoints=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var i=a[n];if(i.contentType===R_.InkContent){var r=i.points;t.push(r[0]),t.push(r[r.length-1])}}return t},e}(),pL=function(){return pL=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},pL.apply(this,arguments)},mL=function(){return mL=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},mL.apply(this,arguments)};var _L=function(){return _L=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},_L.apply(this,arguments)},hL=Object(s.memo)(function(e){var t=Object(s.useContext)(Sw).fabric,n=Object(s.useContext)(Iw).wetInkCanvas,a=null==n?void 0:n.getLineMode(),i=Object(s.useContext)(Wb),r=i.showWetCanvas,o=i.enableMarkupKeyboarding,d=Object(s.useMemo)(function(){if(t)return function(e,t,n,a,i){return void 0===i&&(i=rs.FreeHand),function(r){return function(e,t,n,a,i,r){switch(t.contentType){case R_.InkContent:return function(e,t,n,a,i){var r=function(e,t,n){var a=e.points,i=e.drawingAttributes,r=e.arrowMode,o=pL(pL({},i),{effect:zE}),s=function(e,t){var n=new MA;return n.points=e,n.drawingAttributes=t,n}(a,o),c=i.width,d=new fL(o,t,n);if(r===is.NoArrow)s.streamPath(d);else{var l=function(e,t,n){var a,i,r,o,s;const c=t*(null!==(a=null==n?void 0:n.arrowSize)&&void 0!==a?a:sL),d=null!==(i=null==n?void 0:n.arrowAngle)&&void 0!==i?i:cL,l=null!==(r=null==n?void 0:n.directionThreshold)&&void 0!==r?r:5,u=null!==(o=null==n?void 0:n.strokeLengthThreshold)&&void 0!==o?o:25,f=null!==(s=null==n?void 0:n.isStraightLine)&&void 0!==s&&s;if(d<0||d>=Math.PI)return null;switch(e){case YA.InkSingleArrow:return new oL(c,d,u,l,f);case YA.InkDoubleArrow:return new rL(c,d,u,l,f);case YA.NoArrow:default:return null}}(function(e){switch(e){case is.NoArrow:return YA.NoArrow;case is.SingleArrow:return YA.InkSingleArrow;case is.DoubleArrow:return YA.InkDoubleArrow;default:throw new h(e)}}(r),c,{strokeLengthThreshold:0});if(null===l)throw new Error("Arrow head transformer should not be null");Gw(l,d),s.streamPath(l)}return d.getSvgAttributes()}(t,a,i),o=function(e,t,n){var a=t.path;return new e.Path(a,mL({},n))}(e,r,{selectable:!1,hoverCursor:"default",fill:r.fill,id:t.id});return Tw(e,n,t.invertedPhysicalImageTransformDuringContentSerialization,o),o}(e,t,a,i,r);case R_.TextContent:return function(e,t,n,a){var i=new(function(e){return e.util.createClass(e.Textbox,{initialize:function(e,t){var n=this;this.callSuper("initialize",e,t),this.dashedBorderBackgroundCssColor=null==t?void 0:t.dashedBorderBackgroundCssColor,this.hoverBorderCssColor=null==t?void 0:t.hoverBorderCssColor;var a=null==t?void 0:t.controlsVisibility;a&&Object.entries(XA).forEach(function(e){var t,i=e[0],r=e[1],o=null===(t=a[i])||void 0===t||t;n.setControlVisible(r,o)}),this.addMouseListeners(),this.addEditingListeners()},getBorderScaleFactor:function(){return void 0===this.borderScaleFactor?1:this.borderScaleFactor},drawBorders:function(e,t){return this.borderDashArray&&this.dashedBorderBackgroundCssColor&&this.renderDashedBorderBackgroundColor(e),this.callSuper("drawBorders",e,t)},addMouseListeners:function(){var e=this;this.on("mouseover",function(){var t,n;(null===(n=null===(t=e.canvas)||void 0===t?void 0:t.getActiveObject())||void 0===n?void 0:n.id)!==e.id&&e.drawHoverBorders()}),this.on("mousedown",function(){var t;null===(t=e.canvas)||void 0===t||t.requestRenderAll()}),this.on("mouseout",function(){var t;null===(t=e.canvas)||void 0===t||t.requestRenderAll()}),this.on("selected",function(){e.hoverCursor="text"}),this.on("deselected",function(){e.hoverCursor=void 0})},addEditingListeners:function(){var e=this;this.on("editing:entered",function(){e.hasControls=!0})},drawControls:function(e){var t=this.getBorderScaleFactor(),n=e.arc;e.arc=function(a,i,r,o,s,c){e.lineWidth=t,n.call(e,a,i,r,o,s,c)};var a=this.callSuper("drawControls",e);return e.arc=n,a},toObject:function(e){return this.callSuper("toObject",function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}(["hoverBorderCssColor","borderColor","editingBorderColor","dashedBorderBackgroundCssColor","borderScaleFactor","borderDashArray","cornerStyle","cornerColor","cornerStrokeColor","transparentCorners","controlsVisibility","width"],e||[],!0))},fire:function(e,t){return(null==t?void 0:t.target)?this.callSuper("fire",e,t):this.callSuper("fire",e,JA(JA({},t),{target:this}))},renderDashedBorderBackgroundColor:function(e){var t=this.getBorderScaleFactor(),n=this.getScaledWidth()+t,a=this.getScaledHeight()+t;e.save(),e.strokeStyle=this.dashedBorderBackgroundCssColor||"#000",e.strokeRect(-.5*n,-.5*a,n,a),e.restore()},drawHoverBorders:function(){var e,t=null===(e=this.canvas)||void 0===e?void 0:e.getContext();if(t){var n=this.getBoundingRect(),a=n.left,i=n.top,r=n.width,o=n.height;t.save(),t.strokeStyle=this.hoverBorderCssColor||"#000",t.lineWidth=3,t.beginPath(),t.rect(a,i,r,o),t.stroke(),t.restore()}}})}(e))(t.text,function(e){return e.drawingAttributes?WA(WA({},e.drawingAttributes),{id:e.id}):{fill:ps,borderColor:"#000",editingBorderColor:"#000",dashedBorderBackgroundCssColor:"#fff",borderScaleFactor:2,borderDashArray:[5,5],cornerStyle:"circle",transparentCorners:!1,cornerColor:"#fff",cornerStrokeColor:"#000",hasControls:!0,controlsVisibility:{middleBottom:!1,middleTop:!1},fontSize:36,hoverBorderCssColor:"#0fb7ff",id:e.id}}(t));return["changed","modified"].forEach(function(e){i.on(e,function(e){var a,i;null===(i=null===(a=e.target)||void 0===a?void 0:a.updateFabricToViewTransform)||void 0===i||i.call(a),n(QA(t,e.target))})}),i.on("added",function(i){var r,o=i.target,s=null==o?void 0:o.canvas,c=t.initialPosition.positionType;if(s){if(s.setActiveObject(o),!t.drawingAttributes){switch(c){case"CenteredOnCanvas":s.centerObject(o);break;case"AtLocation":o.setPositionByOrigin(new e.Point(t.initialPosition.left||0,t.initialPosition.top||0),"left","top"),o.setCoords();break;default:throw new Error("Unexpected creationType:"+c)}o.set({width:ZA(o,e)}),o.enterEditing(),o.selectAll(),null===(r=o.hiddenTextarea)||void 0===r||r.focus()}Tw(e,a,t.invertedPhysicalImageTransformDuringContentSerialization,o),o.updateFabricToViewTransform=function(){o.fabricToViewTransform=Ew(o,a)},n(QA(t,o),!1)}}),i.on("removed",function(){i.off()}),i}(e,t,n,a);default:throw new Error("To be implemented for ".concat(t.contentType))}}(e,r,a,t,n,i)}}(t,e.imageViewTransform,e.markupContentItems,e.updateMarkupContent,a)},[t,e.imageViewTransform,e.markupContentItems,a,e.updateMarkupContent]),l=Object(s.useState)(void 0),u=l[0],f=l[1],p=o&&ds(e.activeMarkupToolType)&&e.isKeyboardInputActive;return c.a.createElement("div",{style:{cursor:p?"none":e.cursor,display:e.hidden?"none":void 0}},c.a.createElement(zw,_L({},e,{convertToFabricContent:d,pointerIdToCaptureWhenEraserBrushIsCreated:u,setPointerIdToCaptureWhenEraserBrushIsCreated:f})),r&&c.a.createElement(KA,_L({},e,{setPointerIdToCaptureWhenEraserBrushIsCreated:f})))}),bL=Object(s.memo)(function(e){var t=e.inkBrush;return function(e,t){Object(s.useLayoutEffect)(function(){e&&e.updateInkAttributes(t)},[e,t])}(Object(s.useContext)(Iw).wetInkCanvas,t),null}),gL=function(){return gL=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},gL.apply(this,arguments)},vL=Object(s.memo)(function(e){var t=e.imageViewTransform,n=e.cssToPhysicalPixelRatio,a=e.addInkContent,i=e.inkBrush,r=e.shouldOmitInkContent,o=Object(s.useContext)(Iw).wetInkCanvas,d=Object(s.useContext)(Sw).fabric;return function(e,t){Object(s.useEffect)(function(){return e&&e.setCollectedWetStrokesSink({add:function(e){t(e)}}),function(){null==e||e.clearCollectedWetStrokesSink()}},[e,t])}(o,Object(s.useCallback)(function(e){if(d){var o=e;(!r||!r(o))&&a(gL(gL({},o),{arrowMode:i.strokeShape.arrowMode||is.NoArrow,contentType:R_.InkContent,invertedPhysicalImageTransformDuringContentSerialization:ci(ei(t),Ka(n))}))}},[a,n,d,t,i.strokeShape,r])),c.a.createElement(bL,gL({},e))}),yL={Pen:{cssThicknesses:[1,2,4,6,8,12],minSliderValue:1},Highlighter:{cssThicknesses:[8,12,16,24,28,32],minSliderValue:1}},SL=function(e){var t=e.children,a=Object(s.useState)(null),i=a[0],r=a[1],o=Rm(),d=Object(s.useCallback)(function(){Promise.all([n.e(0),n.e(1)]).then(n.t.bind(null,"M9Rf",7)).then(function(e){r(e.default.fabric)}).catch(function(e){return o({id:"CodeSplitFailed",message:"Failed to load Fabric package"})})},[o]);return c.a.createElement(Sw.Provider,{value:{fabric:i,loadFabric:d}},t)};function DL(){return Promise.all([n.e(0),n.e(1)]).then(n.t.bind(null,"M9Rf",7))}var IL={markup_markupToolbarPenTooltip:"",markup_markupToolbarPenAriaLabel:"",markup_markupToolbarPenAriaDescription:"",markup_markupToolbarEraserTooltip:"",markup_markupToolbarEraserAriaLabel:"",markup_markupToolbarEraserAriaDescription:"",markup_markupToolbarHighlighterTooltip:"",markup_markupToolbarHighlighterAriaLabel:"",markup_markupToolbarHighlighterAriaDescription:"",markup_markupToolbarClearAllMarkupTooltip:"",markup_markupToolbarClearAllMarkupAriaLabel:"",markup_markupToolbarThickness:"",markup_clearAllMarkupDialogCloseButtonAriaLabel:"",markup_clearAllMarkupDialogTitle:"",markup_clearAllMarkupDialogSubText:"",markup_clearAllMarkupDialogConfirmButtonText:"",markup_clearAllMarkupDialogConfirmButtonAriaLabel:"",markup_clearAllMarkupDialogCancelButtonText:"",markup_clearAllMarkupDialogCancelButtonAriaLabel:"",markup_markupToolbarBrushFormatString:"",markup_markupToolbarBrushFormatWithArrowModeString:"",markup_markupToolbarTooltipChangeInkProperties:"",markup_inkThicknessSliderHeaderLabel:"",markup_inkThicknessSliderAriaLabel:"",markup_addedInkStrokeAriaLive:"",markup_removedInkStrokesAriaLive:"",markup_clearedAllMarkupAriaLive:"",markup_inkPenThicknessSliderAriaLabel:"",markup_inkHighlighterThicknessSliderAriaLabel:"",markup_inkThicknessSliderTitle:"",markup_markupToolbarAriaLandmark:"",markup_colorDarkYellow:"",markup_colorLightOrange:"",markup_colorOrange:"",markup_colorRed:"",markup_colorDarkPurple:"",markup_colorPurple:"",markup_colorMagenta:"",markup_colorDarkRed:"",markup_colorLightBlue:"",markup_colorBlue:"",markup_colorDarkBlue:"",markup_colorLightGreen:"",markup_colorGreen:"",markup_colorLightGray:"",markup_colorGray:"",markup_colorBlack:"",markup_colorTableAriaLabel:"",markup_noArrowButtonText:"",markup_straightNoArrowButtonTooltip:"",markup_straightNoArrowButtonAriaLabel:"",markup_singleArrowButtonText:"",markup_straightSingleArrowButtonTooltip:"",markup_straightSingleArrowButtonAriaLabel:"",markup_doubleArrowButtonText:"",markup_straightDoubleArrowButtonTooltip:"",markup_straightDoubleArrowButtonAriaLabel:"",markup_freehandNoArrowButtonTooltip:"",markup_freehandNoArrowButtonAriaLabel:"",markup_freehandSingleArrowButtonTooltip:"",markup_freehandSingleArrowButtonAriaLabel:"",markup_freehandDoubleArrowButtonTooltip:"",markup_freehandDoubleArrowButtonAriaLabel:"",markup_markupToolbarNoArrowTip:"",markup_markupToolbarSingleArrowTip:"",markup_markupToolbarDoubleArrowTip:"",markup_strokeShapeCalloutHeaderText:"",markup_strokeShapeCalloutMainText:"",markup_strokeShapeToastText:"",markup_freehandLine:"",markup_straightLine:"",markup_textboxDefaultContent:""};function xL(e){var t;return null!==(t=null==e?void 0:e.markupToolbarPosition)&&void 0!==t?t:"Bottom"}var CL=function(e){var t=e.enableMarkup,n=void 0===t||t,a=e.inkConfigurations,i=void 0===a?yL:a,r=e.localizationStrings,o=void 0===r?IL:r,d=e.getMarkupToolbarPosition,l=void 0===d?xL:d,u=e.initialMarkupToolsConfigurations,f=void 0===u?zb:u,p=e.markupToolbarStyles,m=void 0===p?void 0:p,_=e.enableArrowhead,h=void 0!==_&&_,b=e.enableStraightLineMarkup,g=void 0!==b&&b,v=e.onClearAllMarkupConfirmationDialog,y=void 0===v?void 0:v,S=e.isStrokeShapeCalloutEnabled,D=void 0===S?g:S,I=e.enableMarkupKeyboarding,x=void 0!==I&&I,C=e.children,O=Object(s.useState)(Kb),w=O[0],E=O[1],A=Object(s.useState)(!1),L=A[0],k=A[1],M=Object(s.useState)(!0),P=M[0],T=M[1],U=gC(f);return c.a.createElement(Wb.Provider,{value:{enableMarkup:n,Canvas:hL,canvasMethods:w,setCanvasMethods:E,InkCanvasInteraction:vL,inkConfigurations:i,getMarkupToolbarPosition:l,localizationStrings:o,scriptsToLoadJSBundles:[DL],markupToolsConfigurations:U,markupToolbarStyles:m,enableArrowhead:h,enableStraightLineMarkup:g,showWetCanvas:P,setShowWetCanvas:T,wetCanvasIsReady:L,setWetCanvasIsReady:k,onClearAllMarkupConfirmationDialog:y,isStrokeShapeCalloutEnabled:D,enableMarkupKeyboarding:x}},c.a.createElement(xw,null,c.a.createElement(SL,null,c.a.createElement(Dw,null,C))))},OL=n("ut3N"),wL=n("hiL/"),EL=n("UWqr");function AL(){return EL._SPKillSwitch.isActivated("206fa16f-84fe-4d43-9d7f-55f3523ad796")}function LL(){return EL._SPKillSwitch.isActivated("96aaa9ce-24cc-4048-8433-e18f6aff7aaf")}var kL,ML=n("kPO2"),PL={markup_markupToolbarPenTooltip:ML.Jt,markup_markupToolbarPenAriaLabel:ML.Yt,markup_markupToolbarPenAriaDescription:ML.Qt,markup_markupToolbarEraserTooltip:ML.zt,markup_markupToolbarEraserAriaLabel:ML.Vt,markup_markupToolbarEraserAriaDescription:ML.jt,markup_markupToolbarHighlighterTooltip:ML.Wt,markup_markupToolbarHighlighterAriaLabel:ML.Kt,markup_markupToolbarHighlighterAriaDescription:ML.Gt,markup_markupToolbarClearAllMarkupTooltip:ML.Nt,markup_markupToolbarClearAllMarkupAriaLabel:ML.Rt,markup_markupToolbarThickness:ML.Zt,markup_clearAllMarkupDialogCloseButtonAriaLabel:ML.$e,markup_clearAllMarkupDialogTitle:ML.at,markup_clearAllMarkupDialogSubText:ML.nt,markup_clearAllMarkupDialogConfirmButtonText:ML.tt,markup_clearAllMarkupDialogConfirmButtonAriaLabel:ML.et,markup_clearAllMarkupDialogCancelButtonText:ML.Ze,markup_clearAllMarkupDialogCancelButtonAriaLabel:ML.Xe,markup_markupToolbarBrushFormatString:ML.Ft,markup_markupToolbarTooltipChangeInkProperties:ML.$t,markup_inkThicknessSliderHeaderLabel:ML.Pt,markup_inkThicknessSliderAriaLabel:ML.Mt,markup_addedInkStrokeAriaLive:ML.Je,markup_removedInkStrokesAriaLive:ML.tn,markup_clearedAllMarkupAriaLive:ML.it,markup_inkPenThicknessSliderAriaLabel:ML.kt,markup_inkHighlighterThicknessSliderAriaLabel:ML.Lt,markup_markupToolbarAriaLandmark:ML.Ut,markup_colorDarkYellow:ML.lt,markup_colorLightOrange:ML.ht,markup_colorOrange:ML.gt,markup_colorRed:ML.yt,markup_colorDarkPurple:ML.ct,markup_colorPurple:ML.vt,markup_colorMagenta:ML.bt,markup_colorDarkRed:ML.dt,markup_colorLightBlue:ML.pt,markup_colorBlue:ML.ot,markup_colorDarkBlue:ML.st,markup_colorLightGreen:ML._t,markup_colorGreen:ML.ft,markup_colorLightGray:ML.mt,markup_colorGray:ML.ut,markup_colorBlack:ML.rt,markup_colorTableAriaLabel:ML.St,markup_noArrowButtonText:ML.en,markup_straightNoArrowButtonTooltip:ML.cn,markup_straightNoArrowButtonAriaLabel:ML.sn,markup_singleArrowButtonText:ML.nn,markup_straightSingleArrowButtonTooltip:ML.ln,markup_straightSingleArrowButtonAriaLabel:ML.dn,markup_doubleArrowButtonText:ML.Dt,markup_straightDoubleArrowButtonTooltip:ML.rn,markup_straightDoubleArrowButtonAriaLabel:ML.an,markup_markupToolbarSingleArrowTip:ML.Xt,markup_markupToolbarDoubleArrowTip:ML.Bt,markup_markupToolbarBrushFormatWithArrowModeString:ML.Ht,markup_inkThicknessSliderTitle:ML.Tt,markup_freehandNoArrowButtonTooltip:ML.wt,markup_freehandSingleArrowButtonTooltip:ML.At,markup_freehandNoArrowButtonAriaLabel:ML.Ot,markup_freehandDoubleArrowButtonTooltip:ML.xt,markup_markupToolbarNoArrowTip:ML.qt,markup_freehandSingleArrowButtonAriaLabel:ML.Et,markup_freehandDoubleArrowButtonAriaLabel:ML.It,markup_strokeShapeCalloutHeaderText:ML.un,markup_strokeShapeToastText:ML.pn,markup_strokeShapeCalloutMainText:ML.fn,markup_freehandLine:ML.Ct,markup_straightLine:ML.on,markup_textboxDefaultContent:ML.mn},TL={strings:{toolbar_imageSave:ML.Zn,toolbar_imageSaveTooltip:ML.ra,toolbar_imageSaveAsOriginal:ML.na,toolbar_imageSaveAsOriginalAriaLabel:ML.aa,toolbar_imageSaveAsOriginalTooltip:ML.ia,toolbar_imageSaveAsCopy:ML.$n,toolbar_imageSaveAsCopyAriaLabel:ML.ea,toolbar_imageSaveAsCopyTooltip:ML.ta,toolbar_imageReset:ML.Qn,toolbar_imageResetAriaLabel:ML.Yn,toolbar_imageResetFinishedAriaLive:ML.Jn,toolbar_imageResetTooltip:ML.Xn,toolbar_resetConfirmDialogContentTitle:ML.ma,toolbar_resetConfirmDialogContentSubText:ML.pa,toolbar_resetConfirmDialogCloseButtonAriaLabel:ML.la,toolbar_resetConfirmDialogConfirmText:ML.fa,toolbar_resetConfirmDialogConfirmAriaLabel:ML.ua,toolbar_resetConfirmDialogCancelText:ML.da,toolbar_resetConfirmDialogCancelAriaLabel:ML.ca,toolbar_zoomLevelAriaLabel:ML.Sa,toolbar_zoomInAriaLabel:ML.va,toolbar_zoomInTooltip:ML.ya,toolbar_zoomOutTooltip:ML.Ia,toolbar_zoomOutAriaLabel:ML.Da,toolbar_cancelAriaLabel:ML.Vn,toolbar_cancelTooltip:ML.zn,toolbar_fitToViewTooltip:ML.qn,toolbar_saveMenuSplitButtonAriaLabel:ML._a,toolbar_viewActualSizeTooltip:ML.ga,toolbar_done:ML.Gn,toolbar_doneAriaLabel:ML.Kn,toolbar_doneTooltip:ML.Wn,toolbar_cancel:ML.jn,toolbar_undo:ML.ha,toolbar_undoAriaLabel:ML.ba,toolbar_redo:ML.oa,toolbar_redoAriaLabel:ML.sa,rotate_left90:ML.wn,rotate_left90AriaLabel:ML.En,rotate_left90FinishedAriaLive:ML.An,rotate_right90:ML.Ln,rotate_right90AriaLabel:ML.kn,rotate_right90FinishedAriaLive:ML.Mn,rotate_sliderAriaLabel:ML.Pn,rotate_degree:ML.On,rotate_sliderTooltip:ML.Tn,flip_horizontal:ML.Ne,flip_horizontalAriaLabel:ML.Be,flip_horizontalFinishedAriaLive:ML.je,flip_vertical:ML.We,flip_verticalAriaLabel:ML.qe,flip_verticalFinishedAriaLive:ML.Qe,aspectRatio_listTitle:ML.D,aspectRatio_freeform:ML.y,aspectRatio_freeformAriaLabel:ML.S,aspectRatio_original:ML.I,aspectRatio_originalAriaLabel:ML.x,aspectRatio_square:ML.w,aspectRatio_squareAriaLabel:ML.E,aspectRatio_ratioAriaLabelFormatString:ML.C,aspectRatio_ratioLabelFormatString:ML.O,aspectRatio_tooltip:ML.A,aspectRatio_changedAriaLive:ML.v,footer_done:ML.Ye,flip_portrait:ML.Ge,flip_portraitAriaLabel:ML.Ke,flip_landscape:ML.Ve,flip_landscapeAriaLabel:ML.ze,crop_topLeftCornerAriaLabel:ML.X,crop_topRightCornerAriaLabel:ML.Z,crop_bottomLeftCornerAriaLabel:ML.G,crop_bottomRightCornerAriaLabel:ML.K,crop_cornerTooltip:ML.W,crop_rectangleAriaLabel:ML.q,crop_rectangleTooltip:ML.J,crop_rectanglePositionAriaLive:ML.Y,crop_rectangleCannotMoveInCurrentDirectionAriaLive:ML.Q,adjustment_brightness:ML.e,adjustment_color:ML.t,adjustment_lightAriaLandmark:ML.s,adjustment_colorAriaLandmark:ML.n,adjustment_contrast:ML.a,adjustment_exposure:ML.i,adjustment_highlights:ML.r,adjustment_light:ML.o,adjustment_saturation:ML.d,adjustment_shadows:ML.l,adjustment_temperature:ML.m,adjustment_tint:ML.b,adjustment_vignette:ML.g,adjustment_mobileChangedAriaLive:ML.c,adjustment_sliderChangedAriaLive:ML.f,adjustment_sliderAriaLabelFormatString:ML.u,adjustment_sliderTooltip:ML.p,adjustment_tileMobileTooltip:ML.h,adjustment_tileMobileAriaLabel:ML._,editor_viewingOriginal:ML.ae,editor_viewingOriginalAriaLive:ML.ie,editor_zoomPercentAriaLive:ML.re,editor_imageDimensionLabelFormatString:ML.te,editor_imageDimensionAriaLabelFormatString:ML.$,editor_imageDimensionAriaLive:ML.ee,editor_imageDimensionWithAspectRatioAriaLive:ML.ne,pivot_crop:ML.Sn,pivot_adjustment:ML.yn,pivot_filter:ML.Dn,pivot_markup:ML.xn,pivot_retouch:ML.Cn,pivot_inpaint:ML.In,pivot_AriaLabel:ML.vn,nonCrop_imageTooltip:ML.bn,nonCrop_imageAriaLabelWithEdits:ML._n,nonCrop_imageAriaLabelWithoutEdits:ML.hn,nonCrop_panViewPositionAriaLive:ML.gn,filter_listTitle:ML.fe,filter_intensitySliderHeader:ML.fe,filter_intensitySliderAriaLabelFormatString:ML.ue,filter_nameOriginal:ML.Ae,filter_nameBurn:ML._e,filter_nameBw:ML.he,filter_nameBwAriaLabel:ML.be,filter_nameBwCool:ML.ge,filter_nameBwCoolAriaLabel:ML.ve,filter_nameBwHighContrast:ML.ye,filter_nameBwHighContrastAriaLabel:ML.Se,filter_nameBwWarm:ML.De,filter_nameBwWarmAriaLabel:ML.Ie,filter_nameCoolLight:ML.Ce,filter_nameCalm:ML.xe,filter_nameDramaticCool:ML.Oe,filter_nameFilm:ML.we,filter_nameGolden:ML.Ee,filter_namePunch:ML.Le,filter_nameRadiate:ML.ke,filter_nameVintage:ML.Me,filter_nameVividCool:ML.Pe,filter_nameWarmContrast:ML.Te,filter_filtersAriaLandmark:ML.le,filter_changedAriaLive:ML.ce,filter_changedAriaLiveWithIntensity:ML.de,filter_mobileChangedAriaLive:ML.pe,filter_mobileChangedAriaLiveWithIntensity:ML.me,filter_sliderTooltip:ML.Ue,filter_tileMobileTooltip:ML.Re,filter_tileAriaLabel:ML.Fe,filter_tileAriaLabelWhenOriginalFilterIsSelected:ML.He,filter_activeTileAriaLabel:ML.se,filter_activeOriginalFilterAriaLabel:ML.oe,autoEnhance_name:ML.N,autoEnhance_generatingAriaLive:ML.U,autoEnhance_appliedAriaLive:ML.L,autoEnhance_removedAriaLive:ML.j,autoEnhance_intensitySliderHeader:ML.R,autoEnhance_intensitySliderAriaLabel:ML.H,autoEnhance_downloadButton:ML.P,autoEnhance_downloadingStatus:ML.T,autoEnhance_retryDownloadButton:ML.V,autoEnhance_installTooltip:ML.F,autoEnhance_retryInstallTooltip:ML.z,autoEnhance_appliedTooltip:ML.k,autoEnhance_notAppliedTooltip:ML.B,autoEnhance_disabledBySpotFixTooltip:ML.M,undoRedo_colorAdjustmentsAriaLive:ML.Ca,undoRedo_autoEnhanceAriaLive:ML.xa,undoRedo_filterAriaLive:ML.Oa,undoRedo_markupInkContentAriaLive:ML.Aa,undoRedo_markupEraseContentAriaLive:ML.Ea,undoRedo_markupClearAllMarkupContentAriaLive:ML.wa,undoRedo_transformCropAriaLive:ML.Ma,undoRedo_transformAspectRatioAriaLive:ML.ka,undoRedo_transformMirrorImageAriaLive:ML.Pa,undoRedo_transformRotationAriaLive:ML.Ta,undoRedo_spotFixAriaLive:ML.La,spotFix_toastText:ML.Bn,spotFix_calloutHeaderText:ML.Un,spotFix_calloutMainText:ML.Fn,spotFix_header:ML.Hn,spotFix_sizeSliderTooltip:ML.Nn,spotFix_sizeSliderHeader:ML.Rn}},UL=n("Z95U"),FL=Sa;function HL(e){var t=this,n="AdvancedEditor",a="EditImage",i=l(e.imageUrl)[0],r={errorModuleName:"Image ".concat(n," Failure"),logFailure:e.serviceScope.consume(UL._EditModeCustomerPromiseHandler.serviceKey).logFailure},c=new OL._QosMonitorShareFailureWithCP("".concat(n,".").concat(a),!1,[r]),d=s.useRef(null),f={width:window.innerWidth-100<2e3?window.innerWidth-100:2e3,height:window.innerHeight-100<1e3?window.innerHeight-100:1e3},p=Zx;if(Object(wL.isControlHostCommunicatorForCoAuthEnabled)()){var m=s.useMemo(function(){return e.serviceScope.consume(wL.ControlHostCommunicatorEdit.serviceKey)},[]);s.useLayoutEffect(function(){e.isOpen?m.notifyNonDataChangingEdit():m.notifyNonDataChangingEditEnded()},[e.isOpen]),s.useLayoutEffect(function(){return m.on("disposed",e.handleClose),m.notifyNonDataChangingEditEnded},[])}var _=s.useCallback(function(i){return Object(o.__awaiter)(t,void 0,void 0,function(){var t,r,s,l,u,f,p;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return t=wL.ExtensionHelper.getExtension(i),r=t?"image/".concat("jpg"===t?"jpeg":t):void 0,OL._EngagementLogger.logEvent("AdvancedEditor.SaveButton.Click"),[4,null===(u=d.current)||void 0===u?void 0:u.getEditedImage()];case 1:if(s=o.sent())try{s.toBlob(function(t){var i;if(t)e.handleSave(t,s.width,s.height),c.writeSuccess();else{var r=Error("Blob was not defined");c.writeUnexpectedFailure("".concat(n,".").concat(a,".BlobUndefinedFailure"),r),LL()||null===(i=e.handleError)||void 0===i||i.call(e,r)}},r)}catch(t){l=Error("Error in canvas.toblob: ".concat(t)),c.writeUnexpectedFailure("".concat(n,".").concat(a,".CanvasToBlobFailure"),l),LL()||null===(f=e.handleError)||void 0===f||f.call(e,l)}else l=Error("Canvas was not defined"),c.writeUnexpectedFailure("".concat(n,".").concat(a,".CanvasFailure"),l),LL()||null===(p=e.handleError)||void 0===p||p.call(e,l);return e.handleClose(),[2]}})})},[]),h=s.useCallback(function(t){var i,r=Error("Message: ".concat(t.message));c.writeUnexpectedFailure("".concat(n,".").concat(a,".").concat(t.id),r),LL()||null===(i=e.handleError)||void 0===i||i.call(e,r)},[]),b=s.useCallback(function(){c.writeSuccess(),OL._EngagementLogger.logEvent("AdvancedEditor.CloseButton.Click"),EL._SPKillSwitch.isActivated("9c9a5baf-09a9-47c9-9a59-7f0b75aab5b4")?e.handleClose():e.handleClose(!0)},[]),g=p.getTheme(!0,!1),v=PL,y="Bottom",S=s.useMemo(function(){return p.getMarkupToolbarStyles(g,y,!0,!0)},[y,p.getMarkupToolbarStyles,g]),D=s.useMemo(function(){return e.allowedAspectRatios},[]),I=(null==D?void 0:D[0])&&(null==i?void 0:i.width)&&(null==i?void 0:i.height)?{aspectRatio:D[0],imageTransform:{x:0,y:0,width:i.width,height:i.height,rotation:0},cropRectangle:{left:0,top:0,width:i.width,height:i.height}}:void 0;return s.createElement(Eg,{isOpen:e.isOpen,styles:{root:{"z-index":999999},main:{"z-index":999999},scrollableContent:{"z-index":999999},layer:{"z-index":999999},keyboardMoveIconContainer:{"z-index":999999},keyboardMoveIcon:{"z-index":999999}}},s.createElement(CL,{enableMarkup:!0,localizationStrings:v,markupToolbarStyles:S,enableArrowhead:!0},s.createElement(vw,{ref:d,componentSize:f,image:i,onSave:function(){return _(e.imageUrl)},onClose:b,onError:h,onRenderSaveMenu:function(){return s.createElement(u.PrimaryButton,{text:TL.strings.toolbar_imageSaveAsOriginal,title:TL.strings.toolbar_imageSaveAsOriginalTooltip,onClick:function(){return _(e.imageUrl)},"aria-label":TL.strings.toolbar_imageSaveAsOriginalAriaLabel})},localization:TL,enableAdjustments:!0,enableFilters:!0,enableAutoEnhance:!1,enableUndoRedo:!0,layout:p,"data-automation-id":"advancedImageEditor",aspectRatiosDisplayedInOrder:!AL()&&I?D:void 0,defaultEdits:AL()?void 0:I})))}Object($e.loadStyles)([{rawString:".canvas_container_d20d2454{position:relative;width:100%;height:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}"}]),OO();var RL=((kL={}).Crop={top:30,left:30,right:30,bottom:30},kL),NL=Object(s.forwardRef)(function(e,t){var n=e.componentSize,a=e.cropHandleSize,i=e.cssToPhysicalPixelRatio,r=e.onEditsChanged,o=$(),d=o.semanticColors.bodyBackground,l=Object(s.useContext)(lh),u=l.image,f=l.setOffscreenRenderer,p=function(e){var t=lw(),n=t.getEditedImage,a=t.getEditedImageBytes,i=t.getImageLayerBytes,r=Object(s.useRef)($O);return Object(s.useImperativeHandle)(e,function(){return{getEdits:function(){return r.current.getEdits()},setEdits:function(e){return r.current.setEdits(e)},resetEdits:function(){r.current.resetEdits()},experimental_bakeEditsWithFrame:function(e){throw new Error("not implemented.")},getEditedImage:n,getEditedImageBytes:a,getImageLayerBytes:i}},[n,a,i]),{editOperationsRef:r}}(t).editOperationsRef;return c.a.createElement("div",{style:{width:n.width,height:n.height,backgroundColor:d}},c.a.createElement("div",{className:"canvas_container_d20d2454",role:"main"},c.a.createElement(xb,{canvasSize:n,cssToPhysicalPixelRatio:i},c.a.createElement(Om,{backgroundColor:Hl(o.semanticColors.bodyBackground)},c.a.createElement(ap,{handleSizeCss:a.handleCssSize,handleHitAreaSizeCss:a.hitAreaCssSize}),c.a.createElement(qf,null),c.a.createElement(mb,{image:u,color:dl,zIndex:1},c.a.createElement(v8,{ref:f}),c.a.createElement(p7,null),c.a.createElement(L6,null)))),c.a.createElement(Yp,null)),c.a.createElement(nw,{ref:p,onEditsChanged:r}),c.a.createElement(Yy,{cssPixelMarginByActivity:RL}),c.a.createElement(kO,null))});NL.displayName="ImageCropper";var BL={setAspectRatio:vd},jL=Object(ee.connect)(function(e){return{aspectRatio:e.transformTools.cropInteraction.aspectRatio}},BL)(function(e){var t=new Map([[16/9,mo],[4/3,_o],[2/3,ho],[1.5,bo],[1,fo],[9/16,po],[0,lo]]).get(e.aspectRatioNumber);if(t){var n=OL._LogSource.create("AdvancedCropper");OL._TraceLogger.logVerbose(n,"AdvancedCropperConnector AspectRatio: ".concat(e.aspectRatioNumber)),e.setAspectRatio(t)}return c.a.createElement(c.a.Fragment,null)}),VL=OL._LogSource.create("AdvancedCropper"),zL={handleCssSize:28,hitAreaCssSize:50};function GL(e){var t=this,n=Object(o.__assign)({},e),a=n.componentSize,i=n.onCropComplete,r=l(e.imageUrl)[0],c=s.useRef(null),d=s.useCallback(function(e){return Object(o.__awaiter)(t,void 0,void 0,function(){var t,n,a,r;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return t=wL.ExtensionHelper.getExtension(e),n=t?"image/".concat("jpg"===t?"jpeg":t):void 0,[4,null===(r=c.current)||void 0===r?void 0:r.getEditedImage()];case 1:if(a=o.sent())try{a.toBlob(function(e){if(!e)throw Error("Canvas to blob failed, no blob");var t={width:a.width,height:a.height};i(t,e)},n)}catch(e){OL._TraceLogger.logError(OL._LogSource.create("AdvancedCropper"),e)}else OL._TraceLogger.logError(OL._LogSource.create("AdvancedCropper"),Error("No canvas found when getting edited image"));return[2]}})})},[]),u=function(e){return Object(o.__awaiter)(t,void 0,void 0,function(){return Object(o.__generator)(this,function(t){switch(t.label){case 0:return OL._EngagementLogger.logEvent("AdvancedCropper.Save.Click"),[4,d(e).catch(function(e){OL._TraceLogger.logError(OL._LogSource.create("AdvancedCropper"),e)}).then(function(){OL._TraceLogger.logVerbose(VL,"Successfully cropped image")})];case 1:return t.sent(),[2]}})})},f=function(t){var n=t.target||document.activeElement,a=e.workingAreaRef&&e.workingAreaRef.current;a?a.contains(n)||u(e.imageUrl):OL._TraceLogger.logError(OL._LogSource.create("AdvancedImageEditor"),Error("No host found when checking workingAreaRef.current"))},p=function(t){"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),u(e.imageUrl))};return s.useEffect(function(){return document.addEventListener("click",f),document.addEventListener("keydown",p),function(){document.removeEventListener("click",f),document.removeEventListener("keydown",p)}},[]),s.createElement(s.Fragment,null,s.createElement(UC,{image:r,onComponentError:function(){OL._TraceLogger.logError(OL._LogSource.create("AdvancedCropper"),Error("Component error in AdvancedCropper"))},localization:TL},s.createElement(jL,{aspectRatioNumber:e.aspectRatio?e.aspectRatio:0}),s.createElement(NL,Object(o.__assign)({},{componentSize:a,cropHandleSize:zL},{ref:c}))))}},qkRx:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("17wl"),i=n("Oukv"),r={settings:{},scopedSettings:{},inCustomizerContext:!1},o=i.e.getValue("customizations",{settings:{},scopedSettings:{},inCustomizerContext:!1}),s=[],c=function(){function e(){}return e.reset=function(){o.settings={},o.scopedSettings={}},e.applySettings=function(t){o.settings=Object(a.__assign)(Object(a.__assign)({},o.settings),t),e._raiseChange()},e.applyScopedSettings=function(t,n){o.scopedSettings[t]=Object(a.__assign)(Object(a.__assign)({},o.scopedSettings[t]),n),e._raiseChange()},e.getSettings=function(e,t,n){void 0===n&&(n=r);for(var a={},i=t&&n.scopedSettings[t]||{},s=t&&o.scopedSettings[t]||{},c=0,d=e;c<d.length;c++){var l=d[c];a[l]=i[l]||n.settings[l]||s[l]||o.settings[l]}return a},e.applyBatchedUpdates=function(t,n){e._suppressUpdates=!0;try{t()}catch(e){}e._suppressUpdates=!1,n||e._raiseChange()},e.observe=function(e){s.push(e)},e.unobserve=function(e){s=s.filter(function(t){return t!==e})},e._raiseChange=function(){e._suppressUpdates||s.forEach(function(e){return e()})},e}()},sx5R:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_Popup},tPTD:function(e,t,n){"use strict";n.r(t),t.default=n.p+"penCursorFallback_7b354f455c946fdc473f6f85e17e1a97.cur"},tj93:function(e,t,n){var a;!function(i,r,o,s){"use strict";var c,d=["","webkit","Moz","MS","ms","o"],l=r.createElement("div"),u=Math.round,f=Math.abs,p=Date.now;function m(e,t,n){return setTimeout(S(e,n),t)}function _(e,t,n){return!!Array.isArray(e)&&(h(e,n[t],n),!0)}function h(e,t,n){var a;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==s)for(a=0;a<e.length;)t.call(n,e[a],a,e),a++;else for(a in e)e.hasOwnProperty(a)&&t.call(n,e[a],a,e)}function b(e,t,n){var a="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=i.console&&(i.console.warn||i.console.log);return r&&r.call(i.console,a,n),e.apply(this,arguments)}}c="function"!=typeof Object.assign?function(e){if(e===s||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var a=arguments[n];if(a!==s&&null!==a)for(var i in a)a.hasOwnProperty(i)&&(t[i]=a[i])}return t}:Object.assign;var g=b(function(e,t,n){for(var a=Object.keys(t),i=0;i<a.length;)(!n||n&&e[a[i]]===s)&&(e[a[i]]=t[a[i]]),i++;return e},"extend","Use `assign`."),v=b(function(e,t){return g(e,t,!0)},"merge","Use `assign`.");function y(e,t,n){var a,i=t.prototype;(a=e.prototype=Object.create(i)).constructor=e,a._super=i,n&&c(a,n)}function S(e,t){return function(){return e.apply(t,arguments)}}function D(e,t){return"function"==typeof e?e.apply(t&&t[0]||s,t):e}function I(e,t){return e===s?t:e}function x(e,t,n){h(E(t),function(t){e.addEventListener(t,n,!1)})}function C(e,t,n){h(E(t),function(t){e.removeEventListener(t,n,!1)})}function O(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function w(e,t){return e.indexOf(t)>-1}function E(e){return e.trim().split(/\s+/g)}function A(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var a=0;a<e.length;){if(n&&e[a][n]==t||!n&&e[a]===t)return a;a++}return-1}function L(e){return Array.prototype.slice.call(e,0)}function k(e,t,n){for(var a=[],i=[],r=0;r<e.length;){var o=t?e[r][t]:e[r];A(i,o)<0&&a.push(e[r]),i[r]=o,r++}return n&&(a=t?a.sort(function(e,n){return e[t]>n[t]}):a.sort()),a}function M(e,t){for(var n,a,i=t[0].toUpperCase()+t.slice(1),r=0;r<d.length;){if((a=(n=d[r])?n+i:t)in e)return a;r++}return s}var P=1;function T(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||i}var U="ontouchstart"in i,F=M(i,"PointerEvent")!==s,H=U&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),R="touch",N="mouse",B=["x","y"],j=["clientX","clientY"];function V(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){D(e.options.enable,[e])&&n.handler(t)},this.init()}function z(e,t,n){var a=n.pointers.length,i=n.changedPointers.length,r=1&t&&a-i==0,o=12&t&&a-i==0;n.isFirst=!!r,n.isFinal=!!o,r&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,a=t.pointers,i=a.length;n.firstInput||(n.firstInput=G(t)),i>1&&!n.firstMultiple?n.firstMultiple=G(t):1===i&&(n.firstMultiple=!1);var r=n.firstInput,o=n.firstMultiple,c=o?o.center:r.center,d=t.center=K(a);t.timeStamp=p(),t.deltaTime=t.timeStamp-r.timeStamp,t.angle=Y(c,d),t.distance=Q(c,d),function(e,t){var n=t.center,a=e.offsetDelta||{},i=e.prevDelta||{},r=e.prevInput||{};1!==t.eventType&&4!==r.eventType||(i=e.prevDelta={x:r.deltaX||0,y:r.deltaY||0},a=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=i.x+(n.x-a.x),t.deltaY=i.y+(n.y-a.y)}(n,t),t.offsetDirection=q(t.deltaX,t.deltaY);var l,u,m=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=m.x,t.overallVelocityY=m.y,t.overallVelocity=f(m.x)>f(m.y)?m.x:m.y,t.scale=o?(l=o.pointers,Q((u=a)[0],u[1],j)/Q(l[0],l[1],j)):1,t.rotation=o?function(e,t){return Y(t[1],t[0],j)+Y(e[1],e[0],j)}(o.pointers,a):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,a,i,r,o=e.lastInterval||t,c=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(c>25||o.velocity===s)){var d=t.deltaX-o.deltaX,l=t.deltaY-o.deltaY,u=W(c,d,l);a=u.x,i=u.y,n=f(u.x)>f(u.y)?u.x:u.y,r=q(d,l),e.lastInterval=t}else n=o.velocity,a=o.velocityX,i=o.velocityY,r=o.direction;t.velocity=n,t.velocityX=a,t.velocityY=i,t.direction=r}(n,t);var _=e.element;O(t.srcEvent.target,_)&&(_=t.srcEvent.target),t.target=_}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function G(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:u(e.pointers[n].clientX),clientY:u(e.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:t,center:K(t),deltaX:e.deltaX,deltaY:e.deltaY}}function K(e){var t=e.length;if(1===t)return{x:u(e[0].clientX),y:u(e[0].clientY)};for(var n=0,a=0,i=0;i<t;)n+=e[i].clientX,a+=e[i].clientY,i++;return{x:u(n/t),y:u(a/t)}}function W(e,t,n){return{x:t/e||0,y:n/e||0}}function q(e,t){return e===t?1:f(e)>=f(t)?e<0?2:4:t<0?8:16}function Q(e,t,n){n||(n=B);var a=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return Math.sqrt(a*a+i*i)}function Y(e,t,n){n||(n=B);var a=t[n[0]]-e[n[0]],i=t[n[1]]-e[n[1]];return 180*Math.atan2(i,a)/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&x(this.element,this.evEl,this.domHandler),this.evTarget&&x(this.target,this.evTarget,this.domHandler),this.evWin&&x(T(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(T(this.element),this.evWin,this.domHandler)}};var J={mousedown:1,mousemove:2,mouseup:4},X="mousedown",Z="mousemove mouseup";function $(){this.evEl=X,this.evWin=Z,this.pressed=!1,V.apply(this,arguments)}y($,V,{handler:function(e){var t=J[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:N,srcEvent:e}))}});var ee={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},te={2:R,3:"pen",4:N,5:"kinect"},ne="pointerdown",ae="pointermove pointerup pointercancel";function ie(){this.evEl=ne,this.evWin=ae,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}i.MSPointerEvent&&!i.PointerEvent&&(ne="MSPointerDown",ae="MSPointerMove MSPointerUp MSPointerCancel"),y(ie,V,{handler:function(e){var t=this.store,n=!1,a=e.type.toLowerCase().replace("ms",""),i=ee[a],r=te[e.pointerType]||e.pointerType,o=r==R,s=A(t,e.pointerId,"pointerId");1&i&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):12&i&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,i,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),n&&t.splice(s,1))}});var re={touchstart:1,touchmove:2,touchend:4,touchcancel:8},oe="touchstart",se="touchstart touchmove touchend touchcancel";function ce(){this.evTarget=oe,this.evWin=se,this.started=!1,V.apply(this,arguments)}function de(e,t){var n=L(e.touches),a=L(e.changedTouches);return 12&t&&(n=k(n.concat(a),"identifier",!0)),[n,a]}y(ce,V,{handler:function(e){var t=re[e.type];if(1===t&&(this.started=!0),this.started){var n=de.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:R,srcEvent:e})}}});var le={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ue="touchstart touchmove touchend touchcancel";function fe(){this.evTarget=ue,this.targetIds={},V.apply(this,arguments)}function pe(e,t){var n=L(e.touches),a=this.targetIds;if(3&t&&1===n.length)return a[n[0].identifier]=!0,[n,n];var i,r,o=L(e.changedTouches),s=[],c=this.target;if(r=n.filter(function(e){return O(e.target,c)}),1===t)for(i=0;i<r.length;)a[r[i].identifier]=!0,i++;for(i=0;i<o.length;)a[o[i].identifier]&&s.push(o[i]),12&t&&delete a[o[i].identifier],i++;return s.length?[k(r.concat(s),"identifier",!0),s]:void 0}function me(){V.apply(this,arguments);var e=S(this.handler,this);this.touch=new fe(this.manager,e),this.mouse=new $(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function _e(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,he.call(this,t)):12&e&&he.call(this,t)}function he(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var a=this.lastTouches;setTimeout(function(){var e=a.indexOf(n);e>-1&&a.splice(e,1)},2500)}}function be(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,a=0;a<this.lastTouches.length;a++){var i=this.lastTouches[a],r=Math.abs(t-i.x),o=Math.abs(n-i.y);if(r<=25&&o<=25)return!0}return!1}y(fe,V,{handler:function(e){var t=le[e.type],n=pe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:R,srcEvent:e})}}),y(me,V,{handler:function(e,t,n){var a=n.pointerType==R,i=n.pointerType==N;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(a)_e.call(this,t,n);else if(i&&be.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ge=M(l.style,"touchAction"),ve=ge!==s,ye="compute",Se="auto",De="manipulation",Ie="none",xe="pan-x",Ce="pan-y",Oe=function(){if(!ve)return!1;var e={},t=i.CSS&&i.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||i.CSS.supports("touch-action",n)}),e}();function we(e,t){this.manager=e,this.set(t)}we.prototype={set:function(e){e==ye&&(e=this.compute()),ve&&this.manager.element.style&&Oe[e]&&(this.manager.element.style[ge]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return h(this.manager.recognizers,function(t){D(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(w(e,Ie))return Ie;var t=w(e,xe),n=w(e,Ce);return t&&n?Ie:t||n?t?xe:Ce:w(e,De)?De:Se}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var a=this.actions,i=w(a,Ie)&&!Oe.none,r=w(a,Ce)&&!Oe["pan-y"],o=w(a,xe)&&!Oe["pan-x"];if(i){var s=1===e.pointers.length,c=e.distance<2,d=e.deltaTime<250;if(s&&c&&d)return}if(!o||!r)return i||r&&6&n||o&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Ee=32;function Ae(e){this.options=c({},this.defaults,e||{}),this.id=P++,this.manager=null,this.options.enable=I(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Le(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ke(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function Me(e,t){var n=t.manager;return n?n.get(e):e}function Pe(){Ae.apply(this,arguments)}function Te(){Pe.apply(this,arguments),this.pX=null,this.pY=null}function Ue(){Pe.apply(this,arguments)}function Fe(){Ae.apply(this,arguments),this._timer=null,this._input=null}function He(){Pe.apply(this,arguments)}function Re(){Pe.apply(this,arguments)}function Ne(){Ae.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Be(e,t){return(t=t||{}).recognizers=I(t.recognizers,Be.defaults.preset),new je(e,t)}function je(e,t){this.options=c({},Be.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(F?ie:H?fe:U?me:$))(this,z),this.touchAction=new we(this,this.options.touchAction),Ve(this,!0),h(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Ve(e,t){var n,a=e.element;a.style&&(h(e.options.cssProps,function(i,r){n=M(a.style,r),t?(e.oldCssProps[n]=a.style[n],a.style[n]=i):a.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}Ae.prototype={defaults:{},set:function(e){return c(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(_(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=Me(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return _(e,"dropRecognizeWith",this)||(e=Me(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(_(e,"requireFailure",this))return this;var t=this.requireFail;return-1===A(t,e=Me(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(_(e,"dropRequireFailure",this))return this;e=Me(e,this);var t=A(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function a(n){t.manager.emit(n,e)}n<8&&a(t.options.event+Le(n)),a(t.options.event),e.additionalEvent&&a(e.additionalEvent),n>=8&&a(t.options.event+Le(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Ee},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=c({},e);if(!D(this.options.enable,[this,t]))return this.reset(),void(this.state=Ee);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},y(Pe,Ae,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,a=6&t,i=this.attrTest(e);return a&&(8&n||!i)?16|t:a||i?4&n?8|t:2&t?4|t:2:Ee}}),y(Te,Pe,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Ce),24&e&&t.push(xe),t},directionTest:function(e){var t=this.options,n=!0,a=e.distance,i=e.direction,r=e.deltaX,o=e.deltaY;return i&t.direction||(6&t.direction?(i=0===r?1:r<0?2:4,n=r!=this.pX,a=Math.abs(e.deltaX)):(i=0===o?1:o<0?8:16,n=o!=this.pY,a=Math.abs(e.deltaY))),e.direction=i,n&&a>t.threshold&&i&t.direction},attrTest:function(e){return Pe.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ke(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),y(Ue,Pe,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),y(Fe,Ae,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Se]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime>t.time;if(this._input=e,!a||!n||12&e.eventType&&!i)this.reset();else if(1&e.eventType)this.reset(),this._timer=m(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return Ee},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),y(He,Pe,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ie]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),y(Re,Pe,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Te.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&f(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ke(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),y(Ne,Ae,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[De]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,a=e.distance<t.threshold,i=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(a&&i&&n){if(4!=e.eventType)return this.failTimeout();var r=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Q(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&r?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=m(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return Ee},failTimeout:function(){return this._timer=m(function(){this.state=Ee},this.options.interval,this),Ee},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Be.VERSION="2.0.7",Be.defaults={domEvents:!1,touchAction:ye,enable:!0,inputTarget:null,inputClass:null,preset:[[He,{enable:!1}],[Ue,{enable:!1},["rotate"]],[Re,{direction:6}],[Te,{direction:6},["swipe"]],[Ne],[Ne,{event:"doubletap",taps:2},["tap"]],[Fe]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},je.prototype={set:function(e){return c(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var a=this.recognizers,i=t.curRecognizer;(!i||i&&8&i.state)&&(i=t.curRecognizer=null);for(var r=0;r<a.length;)n=a[r],2===t.stopped||i&&n!=i&&!n.canRecognizeWith(i)?n.reset():n.recognize(e),!i&&14&n.state&&(i=t.curRecognizer=n),r++}},get:function(e){if(e instanceof Ae)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(_(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(_(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=A(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==s&&t!==s){var n=this.handlers;return h(E(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(e!==s){var n=this.handlers;return h(E(e),function(e){t?n[e]&&n[e].splice(A(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=r.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var a=0;a<n.length;)n[a](t),a++}},destroy:function(){this.element&&Ve(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},c(Be,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Ee,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:je,Input:V,TouchAction:we,TouchInput:fe,MouseInput:$,PointerEventInput:ie,TouchMouseInput:me,SingleTouchInput:ce,Recognizer:Ae,AttrRecognizer:Pe,Tap:Ne,Pan:Te,Swipe:Re,Pinch:Ue,Rotate:He,Press:Fe,on:x,off:C,each:h,merge:v,extend:g,assign:c,inherit:y,bindFn:S,prefixed:M}),(void 0!==i?i:"undefined"!=typeof self?self:{}).Hammer=Be,(a=function(){return Be}.call(t,n,t,e))===s||(e.exports=a)}(window,document)},ut3N:function(e,t){e.exports=u},vNcA:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},yHxl:function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}})});