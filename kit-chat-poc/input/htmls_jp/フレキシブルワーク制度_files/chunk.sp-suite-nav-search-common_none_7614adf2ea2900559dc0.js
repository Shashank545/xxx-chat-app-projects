(window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0=window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0||[]).push([[1],{gbBp:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return h});var a=n("Pk8u"),i=n("UWqr");function r(e,t,n){return void 0===n&&(n=!1),function(a,r,o,s,c){void 0===o&&(o=!1),void 0===s&&(s=""),void 0===c&&(c=!1);var d,l,u=0,f=function(){return c&&u>0&&u<=2};return a.withPeriodicRefresh(e,(d=function(){return(o?a.fetchSharePointDigestV2({endpoint:r,overrideDigest:s,tokenProvider:function(){return Promise.resolve("")}}):a.fetchSharePointDigest({endpoint:r,forceDigestRefresh:f})).then(function(e){return JSON.parse(e.xhr.responseText).d.GetContextWebInformation.FormDigestValue}).then(function(e){return a.fetchAcquireToken({portalUrl:r,resourceUrl:t,digest:e,useSTI:n})}).then(function(e){var t=JSON.parse(e.xhr.responseText),n=t.access_token,a=t.expires_on;return u=0,i._SPKillSwitch.isActivated("add015d8-3cd4-4362-b552-524729334435")?n:a?{token:n,expiry:a}:n}).catch(function(e){throw e&&e.status&&403===e.status&&c&&u++,new Error("Failed to retrieve a valid token")})},l=void 0,function(e){return!e.attempt&&l?l:l=d()}))}}var o,s,c=Object(a.once)(r("bingSerpTokenProvider","https://www.bing.com")),d=Object(a.once)(r("lokiAadSearchBoxTokenProvider","https://loki.delve.office.com")),l=Object(a.once)(r("aadSubstrateTokenProvider","https://outlook.office365.com/search",!1)),u=Object(a.once)(r("aadGallatinSubstrateTokenProvider","https://partner.outlook.cn/search",!1)),f=Object(a.once)(r("aadGCCHSubstrateTokenProvider","https://outlook.office365.us/search",!1)),p=function(e,t,n,a,i,r){return void 0===n&&(n=!1),void 0===r&&(r="Prod"),function(e){switch(e){case"Gallatin":return u;case"GccHigh":return f;default:return l}}(r)(e,t,n,a,i)},m=n("FeTS");function _(e){switch(Object(m.e)(e)||"prod"){case"o365test":case"onebox":case"edog":case"spdf":return"Df";case"prodbubble":return"Msit";default:return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09"}}function h(e,t,n,a,i){t.legacyPageContext;var r=function(e,t,n,a){return o||(o={BingForBusiness:c(n,t),Loki:d(n,t),Substrate:p(n,t,!1,void 0,void 0,_(a)),SharePointSites:function(a){return!a.attempt&&s||(s=function(e,t){return t.fetch({url:"".concat(e,"/_api/sphomeservice/context?$expand=Token,Payload"),method:"GET",headers:{Accept:"application/json","SPHome-ClientType":"Web"}}).then(function(e){var t=e.responseText;return JSON.parse(t)})}(t,n).then(function(t){var n=t.Payload,a=t.Token,i=a.access_token,r=a.resource;if(!e||!e.Search)throw new Error("No search shim available.");return e.Search.SetSharePointHomeApiRequestInfo({url:"".concat(r,"/api/v1"),context:JSON.parse(n)}),i}))}})}(e,t.web.absoluteUrl,i,t.legacyPageContext);return n.markHeaderBoot(),{tokenProviders:r}}}}]);