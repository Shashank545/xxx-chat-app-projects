(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[12],{PpcB:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"r",function(){return s}),n.d(t,"i",function(){return c}),n.d(t,"e",function(){return d});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("b27c283f-9033-4ffd-b8f3-fa2d0df94179")}function r(){return a._SPKillSwitch.isActivated("ca79b9bc-75c7-408c-a782-3d77c04d41e9")}function o(){return a._SPKillSwitch.isActivated("03fe1e3a-35a4-4d30-9d7d-eba1b4537dbb")}function s(){return a._SPKillSwitch.isActivated("e857fd57-8c06-424c-ab9c-ad26d18e5e3f")}function c(){return a._SPKillSwitch.isActivated("9243c796-7671-4ca8-9aab-3c6252d8379b")}function d(){return a._SPKillSwitch.isActivated("6658790a-b037-4ffb-b32b-6003c514c0ef")}},TuXc:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){return console.log("No session storage accessible: "+e),!1}}},koVq:function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"a",function(){return c});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("5d59e193-3eba-43ce-bb04-4614661bd72a")}function r(){return a._SPKillSwitch.isActivated("5aac75ed-6e15-4ab2-be51-058c09a81215")}function o(){return a._SPKillSwitch.isActivated("9534e3ff-04aa-4200-b1c0-5fe423ea194e")}function s(){return a._SPKillSwitch.isActivated("3055acfe-e542-48bd-b875-d979ccb9b3b8")}function c(){return a._SPKillSwitch.isActivated("8166a067-67d3-43dd-9c4a-59adddad4cb6")}},tvCX:function(e,t,n){"use strict";n.r(t),n.d(t,"SubstrateGetTopicByIdDataProvider",function(){return C});var a,i=n("17wl"),r=n("UWqr"),o=n("Pk8u"),s=n("TuXc"),c=n("ut3N"),d=n("X+PM"),l=n("vlQI"),u=n("RSuA"),f=n("koVq"),p="CSIKM.Substrate",m=["Turing","YggdrasilAndTuring"],_=n("WZz6"),h=n("PpcB"),b="lastCortexDisableFlagLogged",g=function(e){function t(n,a,i,r){void 0===n&&(n="unknown"),void 0===a&&(a=200),void 0===r&&(r=!1);var o=e.call(this,n)||this;return"unknown"===n&&(o.isUnknown=!0),o.__proto__=t.prototype,o.status=a,o.code=i,o.isExpected=r,o.errorType="RestApiError",o}return Object(i.__extends)(t,e),t}(Error),v=function(e){function t(n){var a=e.call(this,n)||this;return a._isExpected=!1,a.__proto__=t.prototype,a.errorType="AadTokenError",a}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"isExpected",{get:function(){return this._isExpected||!1},set:function(e){this._isExpected=e},enumerable:!1,configurable:!0}),t}(Error);!function(e){e.Deserialization="DeserializationError",e.Offline="Offline",e.TokenFetch="TokenFetchError",e.CortexDisabled="CortexDisabled",e.GroupMembershipNotAvailable="GroupMembershipNotAvailable",e.GuestUserNotSupported="GuestUserNotSupported"}(a||(a={}));var y=function(){function e(){}return e.processSubstrateHttpResponse=function(e,t,n,i,o,d,l,u,f){var p=this;if(r.Validate.isNotNullOrUndefined(e,"response"),r.Validate.isNotNullOrUndefined(t,"requestId"),r.Validate.isNotNullOrUndefined(n,"qosMonitorAPI"),r.Validate.isNotNullOrUndefined(o,"qosMonitorTotal"),r.Validate.isNotNullOrUndefined(i,"qosMonitorAPI"),r.Validate.isNotNullOrUndefined(d,"qosMonitorTotal"),r.Validate.isNotNullOrUndefined(l,"useSetCortexDisabledFlag"),l&&function(e){if(!Object(s.e)()&&403===(null==e?void 0:e.status)){var t=new Date((new Date).getTime()+36e5);if(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.setItem){sessionStorage.setItem("cortexDisableFlag",t.toISOString());var n="CSIKM.CortexEnabledFlag.Set.True";Object(h.t)()?c._EngagementLogger.logEvent(n):(a=n,void 0===i&&(i=!0),(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.getItem)&&(null!==(r=sessionStorage.getItem(b))&&void 0!==r?r:"")!==a&&(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.setItem)&&(i&&c._EngagementLogger.logEvent(a),sessionStorage.setItem(b,a))),!Object(h.t)()&&(null===sessionStorage||void 0===sessionStorage?void 0:sessionStorage.removeItem)&&sessionStorage.removeItem(b)}}var a,i,r}(e),e.headers&&(t.value=e.headers.get("request-id"),u.requestId=t.value),u.status=e.status,!e.ok){var m="Substrate Cortex API server failure: $tag::".concat(e.status,"::").concat(e.statusText);return 403===e.status?this._processSubstrateHttpResponseFailure(m,e,!0,n,i,o,d,a.CortexDisabled,u,f):this._getInnerErrorFromResponse(e).then(function(t){var r=null==t?void 0:t.error.message,s=null==t?void 0:t.error.code;return 400===e.status&&/Guest user is not supported/i.test(r)?p._processSubstrateHttpResponseFailure(m,e,!0,n,i,o,d,a.GuestUserNotSupported,u,f):(m+=t?", ErrorCode:".concat(s,", ErrorMessage:").concat(r):", ErrorMessage: Failed to retrieve",p._processSubstrateHttpResponseFailure(m,e,!1,n,i,o,d,p._getFormattedHttpStatus(e.status),u,f))})}try{return n.writeSuccess(u),o.writeSuccess(u),i.writeSuccess(u),d.writeSuccess(u),e.json()}catch(r){var _=r;return this._processSubstrateHttpResponseFailure("Substrate Cortex API deserialization failure: $tag::[RequestId: ".concat(t.value,", Name:").concat(_.name,", message:").concat(_.message,", stack:").concat(_.stack),e,!1,n,i,o,d,a.Deserialization,u,f)}},e.handleSubstrateAPIException=function(e,t,n,i,o,s,c,d,l){if(r.Validate.isNotNullOrUndefined(e,"error"),e instanceof g)throw e;var u=void 0;if(t)window.navigator.onLine?(u=void 0===e.status?new Error("Substrate Cortex API failure: $tag::[Name:".concat(e.name,", message:").concat(e.name,", stack:").concat(e.stack)):e,null==o||o.writeUnexpectedFailure(e.message,u,l),null==c||c.writeUnexpectedFailure(e.message,u,l),null==s||s.writeUnexpectedFailure(e.message,u,l),null==d||d.writeUnexpectedFailure(e.message,u,l)):(u=new Error("Substrate Cortex API failure Offline: $tag::[Name:".concat(e.name,", message:").concat(e.message,", stack:").concat(e.stack)),null==o||o.writeExpectedFailure(a.Offline,u,l),null==c||c.writeExpectedFailure(a.Offline,u,l),null==s||s.writeExpectedFailure(a.Offline,u,l),null==d||d.writeExpectedFailure(a.Offline,u,l));else{var p="Substrate Cortex token failure: $tag::[Name:".concat(e.name,", message:").concat(e.message,", stack:").concat(e.stack,", aadTokenFetchSucceeded:").concat(t);u=new v(p),window.navigator.onLine?(null==n||n.writeUnexpectedFailure(e.message,u),null==i||i.writeUnexpectedFailure(e.message,u)):(null==n||n.writeExpectedFailure(a.Offline,u),null==i||i.writeExpectedFailure(a.Offline,u),Object(f.t)()&&(u.isExpected=!0)),Object(f.t)()||(u.isExpected=!0),null==o||o.writeExpectedFailure(a.TokenFetch,u,l),null==c||c.writeExpectedFailure(a.TokenFetch,u,l),null==s||s.writeExpectedFailure(a.TokenFetch,u,l),null==d||d.writeExpectedFailure(a.TokenFetch,u,l)}throw u},e._processSubstrateHttpResponseFailure=function(e,t,n,a,i,r,o,s,c,d){var l=new g(e,t.status,s,n);return d&&(d.restApiError=l),n?(a.writeExpectedFailure(s,l,c),r.writeExpectedFailure(s,l,c),i.writeExpectedFailure(s,l,c),o.writeExpectedFailure(s,l,c)):(a.writeUnexpectedFailure(s,l,c),r.writeUnexpectedFailure(s,l,c),i.writeUnexpectedFailure(s,l,c),o.writeUnexpectedFailure(s,l,c)),Promise.reject(l)},e._getFormattedHttpStatus=function(e){return"HTTP ".concat(e.toString())},e._getInnerErrorFromResponse=function(e){return e.json().then(function(e){return e}).catch(function(){return Promise.resolve(void 0)})},e}(),S=n("y88i"),D=function(){function e(e,t,n){void 0===t&&(t=!0);var a=this;this._requestId={value:""},this._language=void 0,this._serviceScope=e,this._useSetCortexDisabledFlag=t,this._extraData={},e.whenFinished(function(){a._pageContext=e.consume(d.PageContext.serviceKey),a._tokenDataProvider=new _.TokenDataProvider(a._serviceScope,a._pageContext)}),this._scenario=n}return Object.defineProperty(e.prototype,"_authTokenEndpoint",{get:function(){return _.SUBSTRATE_REQUEST_DOMAIN},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_substrateEndpoint",{get:function(){return"".concat(_.SUBSTRATE_REQUEST_DOMAIN,"/").concat("KnowledgeGraph/api/v1.0","/").concat(this.apiName).concat(this.apiParams)},enumerable:!1,configurable:!0}),e.getRoutingKMAPIKey=function(e){var t=new c._QosMonitor("".concat(p,".getRoutingKMAPIKey"));if(!Object(f.i)()){if(e.aadInfo&&e.aadInfo.userId&&e.aadInfo.tenantId)return t.writeSuccess(),"OID:".concat(e.aadInfo.userId,"@").concat(e.aadInfo.tenantId);t.writeUnexpectedFailure("PageContext AadInfo is missing")}return"SMTP:".concat(e.user.email)},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fetchRetryOptions",{get:function(){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPost",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiName",{get:function(){return"Topics"},enumerable:!1,configurable:!0}),e.prototype.getCustomRequestOptions=function(e){},Object.defineProperty(e.prototype,"xScenario",{get:function(){return this._scenario},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qosTag",{get:function(){throw new Error("Needs to be overridden by the derived class")},enumerable:!1,configurable:!0}),e.prototype.getRequest=function(e,t,n){var a,i=this;void 0===e&&(e=""),void 0===n&&(n=!1);var r="".concat(p,".AuthTokenFetch").concat(this._qosSuffix),o="".concat(p,".").concat(this.qosTag,".").concat(n?"Init":"API",".").concat("DP").concat(this._qosSuffix),s="".concat(p,".").concat(this.qosTag,".").concat("DP").concat(this._qosSuffix),d=null!==(a=this._getAuthTokenType())&&void 0!==a?a:"AAD";return this._qosMonitorAuthTokenFetch=new c._QosMonitor(r),this._qosMonitorAuthTokenFetchWithTokenType=new c._QosMonitor("".concat(r,".").concat(d)),this._qosMonitorTotal=new c._QosMonitor(s),this._qosMonitorTotalWithTokenType=new c._QosMonitor("".concat(s,".").concat(d)),this._aadTokenFetchSucceeded=!1,c._EngagementLogger.logEvent(s),Object(u.e)()&&(this._providerType=new URL(window.location.href).searchParams.get("provider")),this._makeRequest(this._substrateEndpoint,this._authTokenEndpoint,e,function(){i._aadTokenFetchSucceeded=!0,i._qosMonitorAuthTokenFetch.writeSuccess(),i._qosMonitorAuthTokenFetchWithTokenType.writeSuccess(),i._qosMonitorAPI=new c._QosMonitor(o),i._qosMonitorAPIWithTokenType=new c._QosMonitor("".concat(o,".").concat(d))}).then(function(e){return y.processSubstrateHttpResponse(e,i._requestId,i._qosMonitorAPI,i._qosMonitorAPIWithTokenType,i._qosMonitorTotal,i._qosMonitorTotalWithTokenType,i._useSetCortexDisabledFlag,i._extraData)}).catch(function(e){return y.handleSubstrateAPIException(e,i._aadTokenFetchSucceeded,i._qosMonitorAuthTokenFetch,i._qosMonitorAuthTokenFetchWithTokenType,i._qosMonitorAPI,i._qosMonitorAPIWithTokenType,i._qosMonitorTotal,i._qosMonitorTotalWithTokenType,i._extraData)})},Object.defineProperty(e.prototype,"correlationId",{get:function(){return this._requestId.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apiParams",{get:function(){var e=new URLSearchParams("");if(this._isDebugUrl){var t=new URL(window.location.href).searchParams.get("pipeline");t&&e.append("pipeline",t)}Object(u.a)()&&this.isPost||e.append("provider","Yggdrasil");var n=e.toString();return n?"?".concat(n):""},enumerable:!1,configurable:!0}),e.prototype._getAPI=function(e,t,n,a,i){var r=this,o=function(){return r.isPost?t.post(e+n,l.AadHttpClient.configurations.v1,r._getRequestOptions(a)):t.get(e+n,l.AadHttpClient.configurations.v1,r._getRequestOptions(a))};return i?function(e,t){var n=Object(S.Retry)({callback:e,retries:t.retries,delay:t.retryDelay,canRetry:function(e){return t.logError(e),t.shouldRetryOnError(e)}});return n.then(function(e){t.logResponse(e),t.logFinal("RESOLVED")},function(e){t.logError(e),t.logFinal("CAUGHT")}),n}(o,i):o()},Object.defineProperty(e.prototype,"_shouldRetryAPIFailures",{get:function(){return!!this.fetchRetryOptions},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_qosSuffix",{get:function(){return Object(_.isHeartbeatTenant)(this.pageContext)?".Heartbeat":""},enumerable:!1,configurable:!0}),e.prototype._getAPIRetryOptions=function(){var e=this,t=[],n=0,a=0,r=void 0;this._apiRetryQosMonitor=new c._QosMonitor("".concat(p,".").concat(this.qosTag,".Retry").concat(this._qosSuffix)),n=performance.now();var o,s,d,l,u=function(){return{sr:t.length+1,clientReqId:e._extraData.clientRequestId,duration:(a=performance.now(),i=(a-n).toFixed(1),n=a,+i)};var a,i};return Object(i.__assign)(Object(i.__assign)({},{retries:void 0===(s=(o=this.fetchRetryOptions).retries)?1:s,retryDelay:void 0===(d=o.retryDelay)?500:d,shouldRetryOnError:void 0===(l=o.shouldRetryOnError)?function(){return!0}:l}),{logResponse:function(e){var n=u();n.httpStatus=e.status,t.push(n),a=e.status},logError:function(e){var n=u();n.error=e.toString(),n.onLine=navigator.onLine,t.push(n),r=e},logFinal:function(n){e._extraData.FinalStatus=n,e._extraData.AttemptsInfo=JSON.stringify(t),e._extraData.TotalRetryAttempts=t.length-1,t.length>1&&("RESOLVED"===n?e._apiRetryQosMonitor.writeExpectedFailure("HTTP ".concat(a.toString()," ").concat(t.length-1),void 0,e._extraData):e._apiRetryQosMonitor.writeUnexpectedFailure("".concat(r.message," ").concat(t.length-1),r,e._extraData))}})},e.prototype._getRequestOptions=function(t){var n;n=(new Date).getTime();var a={},i=r.Guid.newGuid().toString(),o=e.getRoutingKMAPIKey(this.pageContext);return a.headers={},a.headers["Content-Type"]="application/json",a.headers["X-AnchorMailbox"]=o,a.headers["X-RoutingParameter-SessionKey"]=o,a.headers["Client-Request-Id"]=i,a.headers["request-id"]=i,this._enableTestFeedback()&&(a.headers["X-SPDF-TestFeedback"]="true"),t&&(a.headers.Authorization="Bearer ".concat(t)),this.xScenario&&(a.headers["X-Scenario"]=this.xScenario),this._language&&(a.headers["X-Accept-Language"]=this._language),this.getCustomRequestOptions(a),this._clientRequestId=i,this._extraData.clientRequestId=i,this._extraData.getRequestOptionsTime="".concat((new Date).getTime()-n," ms"),this._extraData.culture=this._language,this._extraData.scenario=this.xScenario,a},e.prototype._getAuthTokenType=function(){return Object(_.isUseAADTokenForKmAPIEnabled)()?void 0:"STI"},e.prototype._makeRequest=function(e,t,n,a){var i=this;return this._tokenDataProvider.getOAuthToken(t,this._getAuthTokenType()).then(function(t){a();var r=i._serviceScope.consume(l.HttpClient.serviceKey);return i._getAPI(e,r,n,t,i._shouldRetryAPIFailures?i._getAPIRetryOptions():void 0)})},e.prototype._enableTestFeedback=function(){var e,t=new URL(window.location.href).searchParams;return 0===window.location.href.toLowerCase().indexOf("https://microsoft.sharepoint-df.com/teams/knowledgehub")||0===window.location.href.toLowerCase().indexOf("https://microsoft.sharepoint-df.com")&&"true"===(null===(e=t.get("feedbackDebugMode"))||void 0===e?void 0:e.toLocaleLowerCase().trim())},Object.defineProperty(e.prototype,"_isDebugUrl",{get:function(){var e=new URL(window.location.href).searchParams;return r._SPFlight.isDebugFlightEnabled&&"true"===e.get("debug")},enumerable:!1,configurable:!0}),e}(),I=function(e){function t(n){var a=e.call(this,n)||this;return a.__proto__=t.prototype,a}return Object(i.__extends)(t,e),t}(Error),x=n("7sGm"),C=function(e){function t(t,n,a){var i=e.call(this,t,!0,a)||this;return i._handleResponse=function(e){if(0===e.value.length)throw new I(x.t);return e.value[0]},i._useMined=n,i}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"qosTag",{get:function(){return"GetTopicById"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"apiName",{get:function(){return Object(u.a)()?"Topics/Ids":this._useMined?"Topics/Mined":"Topics"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"xScenario",{get:function(){return Object(f.n)()?"SPPages.TopicPage.Read":this._scenario||"SPPages.TopicPage.Read"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPost",{get:function(){return Object(u.a)()},enumerable:!1,configurable:!0}),t.prototype.getTopic=function(e,t,n,a,i){if(void 0===t&&(t=this._useMined),r.Validate.isNonemptyString(e,"topicId"),Object(s.e)()){var c=this._getTABMockMinedData(),d={value:[]};return c&&(d=JSON.parse(c)).value.length>0&&(d.value[0].Id=e),Promise.resolve(d).then(this._handleResponse)}if(this._useMined=t,this._language=a,Object(f.e)()||(this._customOptions=i),Object(u.a)())return this._resourceOptions=n,this._topicId=e,this.getRequest().then(this._handleResponse);var l="";return Object(o.isEmpty)(n)||Object(o.each)(n,function(e,t){return l+="&".concat(t.toLowerCase(),"=").concat(e)}),this.getRequest("&id=".concat(e).concat(l)).then(this._handleResponse)},t.prototype.getCustomRequestOptions=function(t){var n;e.prototype.getCustomRequestOptions.call(this,t),Object(u.a)()&&(t.body=JSON.stringify(Object(i.__assign)({TopicIds:[this._topicId],IsMinedOnly:this._useMined,ResourceOptions:this._resourceOptions},Object(u.e)()&&-1!==m.indexOf(this._providerType)&&{ProviderType:this._providerType}))),Object(f.e)()||(t.headers=Object(i.__assign)(Object(i.__assign)({},t.headers),null===(n=this._customOptions)||void 0===n?void 0:n.headers)),Object(u.n)()&&"true"===new URL(window.location.href).searchParams.get(x.n.DisableMergeRedirect)&&(t.headers["X-DisableMergeRedirect"]="true")},t.prototype._getTABMockMinedData=function(){return window.sessionStorage.getItem("MOCK_TOPIC_MINED_RESPONSE")},t}(D)}}]);