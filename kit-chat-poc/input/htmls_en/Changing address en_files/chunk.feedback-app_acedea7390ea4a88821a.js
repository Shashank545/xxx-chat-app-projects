(window.webpackJsonp_63be6d0b_999c_45a2_ad79_ab068457f32f_4_6_0=window.webpackJsonp_63be6d0b_999c_45a2_ad79_ab068457f32f_4_6_0||[]).push([[16],{WbvF:function(e,t,n){"use strict";n.r(t);var a,i=n("cDcd"),r=n("Zod+"),o=function(){function e(){}return e.mapMenuItem=function(e){var t;return{listSiteUrl:e.rawProperties?e.rawProperties.ListSiteUrl:void 0,listUrl:e.rawProperties?e.rawProperties.ListUrl:void 0,description:e.description,title:e.text,isRichTextMessage:null===(t=e.rawProperties)||void 0===t?void 0:t.IsRichTextMessage}},e}(),s=n("Gqmf"),c=n("xsR8"),d=n("m5jf"),l=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e){function t(t){var a=e.call(this,t)||this;return a.FeedbackForm=i.lazy(function(){return Promise.all([n.e(6),n.e(47),n.e(17)]).then(n.bind(null,"+enx"))}),a.state={config:o.mapMenuItem(a.props.appItem),isPanelOpen:!1,userHasPermissions:!1},a.onDismissFeedbackFormClick=a.onDismissFeedbackFormClick.bind(a),a}return l(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.state.config,n=t.listSiteUrl,a=t.listUrl;r.e.checkIfUserHasPermissions(n,a).then(function(t){t&&e.setState({userHasPermissions:t})}).catch(function(e){return s.e.error(e)})},t.prototype.render=function(){var e=this;if(!this.state.userHasPermissions)return null;var t=this.props.appItem;return i.createElement(i.Fragment,null,i.createElement("div",{className:[c.e.appItem,this.props.appItem.className].join(" ")},i.createElement("button",{onClick:function(){return e.onOpenFeedbackFormClick()},title:t.iconName&&t.displayIconOnly?t.text:void 0},t.iconName&&i.createElement(d.e,{iconName:t.iconName}),!(t.iconName&&t.displayIconOnly)&&i.createElement("span",{className:c.e.appLabel},t.text))),this.state.isPanelOpen&&i.createElement(i.Suspense,{fallback:i.createElement("div",{style:{display:"none"}})},i.createElement(this.FeedbackForm,{config:this.state.config,isOpen:this.state.isPanelOpen,onDismiss:this.onDismissFeedbackFormClick})))},t.prototype.onOpenFeedbackFormClick=function(){this.setState({isPanelOpen:!this.state.isPanelOpen})},t.prototype.onDismissFeedbackFormClick=function(){this.setState({isPanelOpen:!1})},t}(i.Component);t.default=u},"Zod+":function(e,t,n){"use strict";var a=n("U++1"),i=n("vV1t"),r=n("hBC6"),o=n("fXcD"),s=n("Pk8u"),c=function(){function e(){}return e.checkIfUserHasPermissions=function(e,t){return r.e.getListByUrl(e,t).then(function(e){return r.e.userCanAddItems(e.effectiveBasePermissions)}).catch(function(e){return!1})},e.saveFeedback=function(e,t,n,r,o,c,d,l){var u={isSiteRelative:!1,endpoint:"".concat(e,"/_api/web/getlist('").concat(e).concat(t,"')/items")},f="",p="",m="";switch(r){case 1:f="Page",p=i.e.context.pageContext.site.serverRequestPath,m=i.e.context.pageContext.web.title;break;case 2:f="Site",p=i.e.context.pageContext.site.serverRelativeUrl,m=i.e.context.pageContext.web.title;break;case 3:f="Intranet"}var _={Description:p,Url:p},h={Title:Object(s.escape)(n),CandC_FeedbackType:o,CandC_FeedbackArea:f,CandC_FeedbackSiteName:m,CandC_FeedbackUrl:p.length?_:null,CandC_FeedbackMessage:l?c:Object(s.escape)(c),CandC_RequiresAnswer:d};return a.default.postData(u,h)},e.getFeedbackType=function(e,t){var n={isSiteRelative:!1,endpoint:"".concat(e,"/_api/web/getlist('").concat(e).concat(t,"')/fields"),select:"Choices",filter:"InternalName eq '".concat(o.e.CandCFeedbackType,"'")};return a.default.getData(n).then(function(e){return e&&e[0]&&e[0].Choices?e[0].Choices:[]})},e}();t.e=c},hBC6:function(e,t,n){"use strict";var a,i=n("CFY9");!function(e){e[e.emptyMask=0]="emptyMask",e[e.viewListItems=1]="viewListItems",e[e.addListItems=2]="addListItems",e[e.editListItems=3]="editListItems",e[e.deleteListItems=4]="deleteListItems",e[e.approveItems=5]="approveItems",e[e.openItems=6]="openItems",e[e.viewVersions=7]="viewVersions",e[e.deleteVersions=8]="deleteVersions",e[e.cancelCheckout=9]="cancelCheckout",e[e.managePersonalViews=10]="managePersonalViews",e[e.manageLists=12]="manageLists",e[e.viewFormPages=13]="viewFormPages",e[e.anonymousSearchAccessList=14]="anonymousSearchAccessList",e[e.open=17]="open",e[e.viewPages=18]="viewPages",e[e.addAndCustomizePages=19]="addAndCustomizePages",e[e.applyThemeAndBorder=20]="applyThemeAndBorder",e[e.applyStyleSheets=21]="applyStyleSheets",e[e.viewUsageData=22]="viewUsageData",e[e.createSSCSite=23]="createSSCSite",e[e.manageSubwebs=24]="manageSubwebs",e[e.createGroups=25]="createGroups",e[e.managePermissions=26]="managePermissions",e[e.browseDirectories=27]="browseDirectories",e[e.browseUserInfo=28]="browseUserInfo",e[e.addDelPrivateWebParts=29]="addDelPrivateWebParts",e[e.updatePersonalWebParts=30]="updatePersonalWebParts",e[e.manageWeb=31]="manageWeb",e[e.anonymousSearchAccessWebLists=32]="anonymousSearchAccessWebLists",e[e.useClientIntegration=37]="useClientIntegration",e[e.useRemoteAPIs=38]="useRemoteAPIs",e[e.manageAlerts=39]="manageAlerts",e[e.createAlerts=40]="createAlerts",e[e.editMyUserInfo=41]="editMyUserInfo",e[e.enumeratePermissions=63]="enumeratePermissions",e[e.fullMask=65]="fullMask"}(a||(a={}));var r=n("vV1t"),o=n("U++1"),s=n("F6U+"),c=function(){return c=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},c.apply(this,arguments)},d=function(){function e(){}return e.getList=function(e,t){if(!t)return Promise.reject("The parameter listGuid is null");var n={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists('").concat(t,"')"),select:"Title,EffectiveBasePermissions,BaseTemplate",expand:"defaultView,ParentWeb"};return o.default.getData(n).then(function(e){return{title:e.Title,effectiveBasePermissions:e.EffectiveBasePermissions}})},e.getListBaseTemplate=function(e,t){if(!t)return Promise.reject("The parameter listGuid is null");var n={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists('").concat(t,"')"),select:"BaseTemplate",expand:"defaultView,ParentWeb"};return o.default.getData(n).then(function(e){return{baseTemplate:e.BaseTemplate}})},e.getListByName=function(e,t){if(!t)return Promise.reject("The parameter listName is null");var n={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists/GetByTitle('").concat(t,"')"),select:"Title,EffectiveBasePermissions",expand:"defaultView,ParentWeb"};return o.default.getData(n).then(function(e){return{title:e.Title,effectiveBasePermissions:e.EffectiveBasePermissions}})},e.getListByUrl=function(e,t){if(!t)return Promise.reject("The parameter listUrl is null");var n={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/getlist('").concat(e||"").concat(t,"')"),select:"Title,EffectiveBasePermissions",expand:"defaultView,ParentWeb"};return o.default.getData(n).then(function(e){return{title:e.Title,effectiveBasePermissions:e.EffectiveBasePermissions}})},e.getListUrl=function(e){if(!e)return Promise.reject("The parameter listGuid is null");var t=r.e.context.pageContext.site.id,n="listUrl_".concat(t,"_").concat(e),a=s.e.getStoredDataByKey(n);if(a)return Promise.resolve(a);var d=c({},i.e.listDefaultView);return d.endpoint=d.endpoint.replace("$$0",e),o.default.getData(d).then(function(e){return e.ServerRelativePath?(s.e.setStoredDataByKey(n,e.ServerRelativePath.DecodedUrl,s.e.dataCacheExpiresMin),e.ServerRelativePath.DecodedUrl):null})},e.getListUrlInSite=function(e,t){if(!t)return Promise.reject("The parameter listGuid is null");var n="listUrl_".concat(e,"_").concat(t),a=s.e.getStoredDataByKey(n);if(a)return Promise.resolve(a);var r={endpoint:"".concat(e).concat(i.e.listDefaultView.endpoint),select:i.e.listDefaultView.select,isSiteRelative:!1};return r.endpoint=r.endpoint.replace("$$0",t),o.default.getData(r).then(function(e){return e.ServerRelativePath?(s.e.setStoredDataByKey(n,e.ServerRelativePath.DecodedUrl,s.e.dataCacheExpiresMin),e.ServerRelativePath.DecodedUrl):null}).catch(function(e){return null})},e.userCanAddItems=function(t){return e.hasPermissions(t,a.addListItems)},e.userCanEditItems=function(t){return e.hasPermissions(t,a.editListItems)},e.userCanConfigureList=function(t){return e.hasPermissions(t,a.manageLists)},e.getListViews=function(e,t){if(!t)return Promise.reject("The parameter listUrl is null");var n={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists/getById('").concat(t,"')/Views")};return o.default.getData(n).then(function(e){return e}).catch(function(e){return null})},e.getListViewFields=function(e,t,n){if(!t)return Promise.reject("The parameter listId is null");var a={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists/getById('").concat(t,"')/Views('").concat(n,"')/viewfields")};return o.default.getData(a).then(function(e){return e}).catch(function(e){return null})},e.getListViewQuery=function(e,t,n){if(!t)return Promise.reject("The parameter listUrl is null");if(!n)return Promise.reject("The parameter viewId is null");var a={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists/getById('").concat(t,"')/Views/getbyId('").concat(n,"')/ViewQuery")};return o.default.getData(a)},e.getListViewQueryAndRowLimit=function(e,t,n){if(!t)return Promise.reject("The parameter listUrl is null");if(!n)return Promise.reject("The parameter viewId is null");var a={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists/getById('").concat(t,"')/Views/getbyId('").concat(n,"')?$select=ViewQuery,RowLimit\n      ")};return o.default.getData(a)},e.getListViewQueryByViewName=function(e,t,n){if(!t)return Promise.reject("The parameter listUrl is null");if(!n)return Promise.reject("The parameter viewName is null");var a={isSiteRelative:!e,endpoint:"".concat(e||"","/_api/web/lists/getById('").concat(t,"')/Views/getbytitle('").concat(n,"')/ViewQuery")};return o.default.getData(a)},e.getListItemsFromViewQuery=function(e,t,n){if(!t)return Promise.reject("The parameter listUrl is null");if(!n)return Promise.reject("The parameter viewQuery is null");var a={query:{__metadata:{type:"SP.CamlQuery"},ViewXml:"<View><Query>".concat(n,"</Query></View>")}},i={endpoint:"".concat(e||"","/_api/web/lists/getById('").concat(t,"')/getitems"),isSiteRelative:!e};return o.default.postData(i,a,void 0,void 0,{accept:"application/json;odata=nometadata","odata-version":"3.0"}).then(function(e){return e.json()}).then(function(e){return e.value||e})},e.getListItemsFromViewQueryAsDataStream=function(e,t,n,a,i){return r=this,void 0,c=function(){var r,s,c,d,l,u,f;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(p){switch(p.label){case 0:return t?(r=a?"<ViewFields>".concat(a.filter(function(e){return e}).map(function(e){return"<FieldRef Name='".concat(e,"' />")}).join(""),"</ViewFields>"):"",s="<RowLimit>".concat(i||500,"</RowLimit>"),c=n?"<Query>".concat(n,"</Query>"):"",d="<View>".concat(s).concat(c).concat(r,"</View>"),l={parameters:{ViewXml:d,RenderOptions:2}},u={endpoint:"".concat(e||"","/_api/web/lists(guid'").concat(t,"')/RenderListDataAsStream"),isSiteRelative:!e},[4,o.default.postData(u,l,void 0,void 0,{accept:"application/json;odata=nometadata","odata-version":"3.0"})]):[2,Promise.reject("The parameter listUrl is null")];case 1:return[4,p.sent().json()];case 2:return[2,(f=p.sent()).value||f]}})},new((s=void 0)||(s=Promise))(function(e,t){function n(e){try{i(c.next(e))}catch(e){t(e)}}function a(e){try{i(c.throw(e))}catch(e){t(e)}}function i(t){var i;t.done?e(t.value):(i=t.value,i instanceof s?i:new s(function(e){e(i)})).then(n,a)}i((c=c.apply(r,[])).next())});var r,s,c},e.hasPermissions=function(e,t){if(!t)return!0;if(t===a.fullMask)return 32767==(32767&e.High)&&65535===e.Low;var n=1;return(t-=1)>=0&&t<32?(n<<=t,0!=(e.Low&n)):t>=32&&t<64&&(n<<=t-32,0!=(e.High&n))},e.getListsWithContentType=function(e,t){var n={endpoint:"".concat(t||"").concat(i.e.siteLists.endpoint),isSiteRelative:!t,filter:i.e.siteLists.filter+(e?" and ContentTypesEnabled eq true":""),expand:"ContentTypes",select:"Id,Title,EffectiveBasePermissions,ContentTypes/Id"};return o.default.getData(n).then(function(t){return t.filter(function(t){return!e||t.ContentTypes.some(function(t){var n,a;return(null===(a=null===(n=null==t?void 0:t.Id)||void 0===n?void 0:n.StringValue)||void 0===a?void 0:a.indexOf(e))>-1})})}).catch()},e.addContentType=function(e,t,n){var a={endpoint:"".concat(n||"","/_api/web/lists('").concat(e,"')/ContentTypes/AddAvailableContentType"),isSiteRelative:!n},i={contentTypeId:t};return o.default.postData(a,i,void 0,void 0,{accept:"application/json;odata.metadata=none","content-type":"application/json;odata=verbose"})},e}();t.e=d}}]);