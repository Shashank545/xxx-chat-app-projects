(window.webpackJsonp_6da60671_741f_47c5_b35b_5078edaf312f_0_1_0=window.webpackJsonp_6da60671_741f_47c5_b35b_5078edaf312f_0_1_0||[]).push([[6],{"/ZsA":function(e){e.exports=JSON.parse('{"e":"Close"}')},V0zg:function(e,t,n){"use strict";var a=n("cDcd"),i=n("5pbq"),r=/\{[^{}]*\}/g,o=/\<[A-Z]*\>/gi,s=function(){function e(){}return e.ContentWithLink=function(e,t){var n=0;return a.createElement(a.Fragment,null,null==e?void 0:e.map(function(e,o){var s=e.split(r),c=e.match(r);return a.createElement("p",{key:o},s.map(function(e,r){if(c&&c.length>r&&t){var o=c[r].slice(1,c[r].length-1),s=t.length>n?t[n++]:void 0;return a.createElement("div",{key:r},e,a.createElement(i.Link,{href:s,target:"_blank"},o))}return e}))}))},e.ContentWithIcon=function(e,t){return a.createElement(a.Fragment,null,null==e?void 0:e.map(function(e,n){var r=e.split(o),s=e.match(o);return a.createElement("p",{key:n},r.map(function(e,n){var r;if(!(s&&s.length>n))return e;var o=s[n].slice(1,s[n].length-1);if("DYNAMIC"!==o)return a.createElement(a.Fragment,null,e,a.createElement(i.Icon,{iconName:o}));try{var c=null===(r=document.querySelector('[data-sp-fre-iconref="'.concat(t,'"]')))||void 0===r?void 0:r.getElementsByTagName("i")[0],d=null==c?void 0:c.getAttribute("class");return a.createElement(a.Fragment,null,e,a.createElement(i.Icon,{className:null==d?void 0:d.toString()}))}catch(t){return e}}))}))},e}();t.e=s},ZSiH:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("5pbq"),r=function(e){var t,n,r,o,s,c,d,l,u,f,p,m,_,h,b=e.theme,g=Object(i.getRTL)();return Object(a.__assign)(Object(a.__assign)({scrollableContent:(null===(t=e.freModalProps)||void 0===t?void 0:t.removeBodyMinHeight)?{overflowY:"hidden",paddingBottom:"24px"}:void 0,container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch",maxWidth:(null===(n=e.freModalProps)||void 0===n?void 0:n.removeBodyMinHeight)?"650px":"588px",overflowY:(null===(r=e.freModalProps)||void 0===r?void 0:r.removeBodyMinHeight)?"hidden":void 0},header:[b.fonts.xLarge,{flex:"1 1 auto",borderTop:"4px solid ".concat(b.palette.themePrimary),color:b.palette.neutralPrimary,display:"flex",fontWeight:i.FontWeights.semibold,padding:g?"24px 24px ".concat((null===(s=e.freModalProps)||void 0===s?void 0:s.carouselProps)?"12px":"24px"," 12px"):"24px 12px ".concat((null===(o=e.freModalProps)||void 0===o?void 0:o.carouselProps)?"12px":"24px"," 24px"),selectors:{"span:only-child":{margin:"auto"}}}],headerMiddle:[b.fonts.xLarge,{flex:"1 1 auto",color:b.palette.neutralPrimary,fontWeight:i.FontWeights.semibold,selectors:{"span:only-child":{margin:"auto"}}}],pagination:{display:"block",textAlign:"center"},paignationIconSecondary:{margin:"0 6px 12px 6px",fontSize:"8px"},paignationIconPrimary:{margin:"0 6px 12px 6px",fontSize:"8px",color:b.palette.themePrimary},body:{flex:"4 4 auto",padding:"0 24px",overflowY:"hidden",maxWidth:(null===(c=e.freModalProps)||void 0===c?void 0:c.removeBodyMinHeight)?"600px":"540px",minHeight:(null===(d=e.freModalProps)||void 0===d?void 0:d.removeBodyMinHeight)?void 0:"420px",display:"flex",alignItems:"center",justifyContent:"center",selectors:{img:{maxWidth:"100%",maxHeight:"240px"},p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}},inner:{height:"100%",padding:"0 24px 20px",color:b.palette.neutralSecondary,textAlign:(null===(l=e.freModalProps)||void 0===l?void 0:l.centerModalInnerText)?"center":void 0},subHeadline:{textAlign:"center"},illustration:{maxWidth:(null===(u=e.freModalProps)||void 0===u?void 0:u.swapHeadlineAndImage)?"517px":void 0,textAlign:"center",minHeight:(null===(f=e.freModalProps)||void 0===f?void 0:f.carouselProps)?"246px":void 0},link:[b.fonts.medium,{color:b.palette.neutralPrimary,selectors:{":only-child":{margin:"auto"}}}],actions:(null===(p=e.freModalProps)||void 0===p?void 0:p.isFreCustomModal)?{display:"flex",gap:"8px",justifyContent:"flex-end"}:{position:"relative",display:"flex",justifyContent:(null===(m=e.freModalProps)||void 0===m?void 0:m.primaryButtonOnRight)?"flex-end":"center",margin:"20px 0",width:"100%",selectors:{button:{margin:"0 18px"}}},choiceTitle:[b.fonts.medium,{padding:"10px"}],choiceText:[b.fonts.small,{padding:"10px"}]},{footerContainer:(null===(_=e.freModalProps)||void 0===_?void 0:_.isFreCustomModal)?{display:"grid",gridTemplateColumns:"330px 72px auto",padding:"30px 48px 0 60px"}:void 0,footerContent:(null===(h=e.freModalProps)||void 0===h?void 0:h.isFreCustomModal)?{display:"block"}:void 0}),e.overrideStyles)}},brtj:function(e,t,n){"use strict";n.r(t),n.d(t,"FeatureHostControl",function(){return M});var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("UWqr"),s=n("ut3N"),c="FRE_Cached_Data",d="1.0",l=n("5pbq"),u=n("YIBf"),f=n("ybJ9"),p=n("dUIr"),m=n("pefs"),_=n("Pk8u"),h=n("fCCa"),b=n("/ZsA");n("jOlS").loadStyles(".a_a_6e28872b .ms-TeachingBubble-headline,.a_a_6e28872b .ms-TeachingBubble-subText{color:#fff!important}.a_a_6e28872b.b_a_6e28872b .ms-TeachingBubble-headline,.a_a_6e28872b.b_a_6e28872b .ms-TeachingBubble-subText{color:#000!important}",!0);var g="a_a_6e28872b",v=n("lJtf"),y=n("ZSiH"),S=n("oeX7"),D=Object(l.classNamesFunction)(),I=function(e){function t(t){var n=e.call(this,t)||this;return n._buttonRef=i.createRef(),n._renderModalContent=function(){var e=n.modalEntry.secondaryButtonLabel?i.createElement(l.DefaultButton,{onClick:n._onSecondaryButtonClick},n.modalEntry.secondaryButtonLabel):void 0,t=n.modalEntry.primaryButtonLabel?i.createElement(l.PrimaryButton,{onClick:n._currentCarouselSlideIsLast?n._onDismissButtonClick:n._onPrimaryButtonClick},n.modalEntry.primaryButtonLabel):void 0,a=i.createElement(l.IconButton,{styles:{root:{display:"flex",color:n.theme.palette.neutralPrimary,top:"16px",marginLeft:n.isRTL?"16px":"auto",marginRight:n.isRTL?"auto":"16px"},rootHovered:{color:n.theme.palette.neutralDark}},iconProps:{iconName:"Cancel"},ariaLabel:S.e,onClick:n.props.modalProps.onDismissed,className:n.contentStyles.freModalCloseButton,"data-automation-id":"closeFREModal",componentRef:n._buttonRef}),r=i.createElement("div",{className:n.contentStyles.pagination},n._createPaginationButtons());return i.createElement("div",{key:"FRE_Modal_".concat(n.state.carouselIndex),className:n.contentStyles.container},i.createElement("div",{className:n.contentStyles.header},!!n.modalEntry.modalHeaderContent&&n.modalEntry.modalHeaderContent,"Header"===n.props.paginationLocation&&r,a),i.createElement("div",{className:n.contentStyles.body},!!n.modalEntry.modalMainContent&&n.modalEntry.modalMainContent,"Main"===n.props.paginationLocation&&r),i.createElement("div",{className:n.contentStyles.footerContainer},i.createElement("div",{className:n.contentStyles.footerContent},!!n.modalEntry.modalFooterContent&&n.modalEntry.modalFooterContent),n.props.paginationLocation&&"Footer"!==n.props.paginationLocation?i.createElement(i.Fragment,null):r,i.createElement("div",{className:n.contentStyles.actions},n.modalEntry.swapButtonPositions?i.createElement(i.Fragment,null,t,e):i.createElement(i.Fragment,null,e,t))))},n._createPaginationButtons=function(){var e=[];if(!n._hasCarouselData)return e;for(var t=0;t<n.props.customCarouselProps.length;t++)e.push(i.createElement(l.Icon,{className:t!==n.state.carouselIndex?n.contentStyles.paignationIconSecondary:n.contentStyles.paignationIconPrimary,iconName:t===n.state.carouselIndex?"circleFill":"CircleRing",key:t,style:{order:t}}));return e},n._onDismissButtonClick=function(){n.modalEntry.onPrimaryButtonClicked?n.modalEntry.onPrimaryButtonClicked():n.props.modalProps.onDismissed&&n.props.modalProps.onDismissed(),n.state.carouselIndex===n._lastPageIndex?s._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.Complete")):s._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.").concat(n.state.carouselIndex+1,".Close"))},n._onKeyDownHandler=function(e){"Escape"===e.key&&n.props.modalProps.onDismissed&&n.props.modalProps.onDismissed()},n._onSecondaryButtonClick=function(){var e=n.state.carouselIndex-1>0?n.state.carouselIndex-1:0;n.setState({carouselIndex:e}),s._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.").concat(n.state.carouselIndex+1,".Back.Click"))},n._onPrimaryButtonClick=function(){var e=n.state.carouselIndex+1<n._lastPageIndex?n.state.carouselIndex+1:n._lastPageIndex;n.setState({carouselIndex:e}),s._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.").concat(n.state.carouselIndex+1,".Click"))},n.state={carouselIndex:0},n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"modalEntry",{get:function(){return this.props.customCarouselProps[this.state.carouselIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"theme",{get:function(){return Object(l.getTheme)()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRTL",{get:function(){return Object(l.getRTL)()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contentStyles",{get:function(){var e=this.theme,t=this.modalEntry.overrideStyles,n=this.modalEntry;return n.isFreCustomModal=!0,D(this.props.styles,{theme:e,overrideStyles:t,freModalProps:n})},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){document.addEventListener("keydown",this._onKeyDownHandler)},t.prototype.componentDidUpdate=function(e,t){var n=this;t.carouselIndex!==this.state.carouselIndex&&setTimeout(function(){var e;null===(e=n._buttonRef.current)||void 0===e||e.focus()},10)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this._onKeyDownHandler)},t.prototype.render=function(){return i.createElement(f.e,Object(a.__assign)({},this.props.modalProps,{focusTrapZoneProps:{isClickableOutsideFocusTrap:!0,firstFocusableTarget:"FREModalCloseButton"}}),this._renderModalContent())},Object.defineProperty(t.prototype,"_lastPageIndex",{get:function(){return this.props.customCarouselProps?this.props.customCarouselProps.length-1:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_hasCarouselData",{get:function(){return!!this.props.customCarouselProps&&this.props.customCarouselProps.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_currentCarouselSlideIsLast",{get:function(){return this._hasCarouselData&&this.props.customCarouselProps.length-1===this.state.carouselIndex},enumerable:!1,configurable:!0}),t}(i.Component),x=Object(l.styled)(I,y.e),C=function(e){function t(t){var n=e.call(this,t)||this;return n._onContentScroll=function(e){n.setState({lastKnownScrollPosition:window.scrollY})},n.state={lastKnownScrollPosition:0},n._shouldTBScrollWithTarget=Boolean("TeachingBubble"===n.props.type&&n.props.targetScrollElement),n._shouldTBScrollWithTarget&&(n._onContentScroll=Object(_.debounce)(n._onContentScroll,50)),n}return Object(a.__extends)(t,e),t.prototype.render=function(){return"Coachmark"===this.props.type?this._renderCoachmark():"TeachingBubble"===this.props.type?this._renderTeachingBubble():"Modal"===this.props.type?this._renderModal():"FRECustomModal"===this.props.type?this._renderFRECustomModal():"FREModal"===this.props.type?this._renderFREModal():void 0},t.prototype.componentDidMount=function(){var e,t,n;null===(t=(e=this.props).onDidMount)||void 0===t||t.call(e),this._shouldTBScrollWithTarget&&(null===(n=this.props.targetScrollElement)||void 0===n||n.addEventListener("scroll",this._onContentScroll))},t.prototype.componentWillUnmount=function(){var e;this._shouldTBScrollWithTarget&&(null===(e=this.props.targetScrollElement)||void 0===e||e.removeEventListener("scroll",this._onContentScroll))},t.prototype._renderCoachmark=function(){var e=this.props,t=e.content,n=e.onBeforeDismiss,r=e.target,o=e.teachingBubbleProps;return i.createElement(u.e,Object(a.__assign)({},this.props,{target:r}),i.createElement("div",{className:Object(l.css)(g,!Object(h.i)()&&Object(l.getTheme)().isInverted&&"b_a_6e28872b")},i.createElement(p.e,Object(a.__assign)({},o,{closeButtonAriaLabel:b.e,hasCloseIcon:!0,hasCondensedHeadline:!(!Object(h.p)()&&void 0!==o.hasCondensedHeadline)||o.hasCondensedHeadline,isWide:!1,onDismiss:n,targetElement:o.targetElement||r}),t)))},t.prototype._renderTeachingBubble=function(){var e=this.props,t=e.calloutProps,n=e.content,r=e.onBeforeDismiss,o=e.targetElement;return i.createElement("div",{className:g},i.createElement(m.e,Object(a.__assign)({},this.props,{calloutProps:t,closeButtonAriaLabel:b.e,onDismiss:r,targetElement:o}),n))},t.prototype._renderModal=function(){var e=this.props,t=e.modalProps,n=e.onRenderModalContent;return i.createElement(f.e,Object(a.__assign)({},t),n())},t.prototype._renderFRECustomModal=function(){var e=this.props;return i.createElement(x,Object(a.__assign)({},e))},t.prototype._renderFREModal=function(){var e=this.props.modalProps;return i.createElement(v.e,Object(a.__assign)({},e))},t}(i.Component),O=function(){return!1};function w(e,t){return Number(window.localStorage.getItem(L(e,t))||"0")}function E(e){return{maxDisplayTimes:(null==e?void 0:e.maxDisplayTimes)||1,reappearIntervalInDays:(null==e?void 0:e.reappearIntervalInDays)||7,shouldAbortReappearanceOnDismiss:(null==e?void 0:e.shouldAbortReappearanceOnDismiss)||O}}function A(e,t){return"".concat(e,"_").concat(t,"_LastShowTime")}function L(e,t){return"".concat(e,"_").concat(t,"_ShowedCount")}var k=n("ZVdo"),M=function(){function e(e){this._activeMaxDisplayTimes=1,this._cacheEnabled=!1,this._serviceScope=e,this._featureGroups=new Map,this._featureKeys=this._featureGroups.keys(),this._cacheEnabled=o._SPFlight.isEnabled(1348)}return Object.defineProperty(e.prototype,"mySiteCacheManager",{get:function(){return void 0===this._mySiteCacheManager&&(this._mySiteCacheManager=this._serviceScope.consume(k.mySiteCacheManagerServiceKey),this._mySiteCacheManager.setCacheConfiguration({folderPath:c})),this._mySiteCacheManager},enumerable:!1,configurable:!0}),e.prototype.attachFeatureHost=function(t){var n=this;return this._cacheEnabled?this._isValid(t)?(t.localStorageKey||(t.localStorageKey=o.Guid.newGuid().toString()),this._getMySiteCachePromise.then(function(e){if(e&&(null==e?void 0:e.value)){n._cacheResultMap=new Map;var a=!1;e.value.forEach(function(e){Object(h.I)()||e.CacheValue?n._writeToLocalStorage(e.CacheKey,JSON.parse(e.CacheValue).version):a=!0}),n._cacheQosMonitor&&(!Object(h.I)()&&a?n._cacheQosMonitor.writeUnexpectedFailure("AtLeastOneCacheValueWasFalsy"):n._cacheQosMonitor.writeSuccess())}Object(h.n)()&&(n._hostElem?n._addToFeatureMap(t):n._renderFeatureHost(t))}).catch(function(t){n._cacheResultMap=void 0,n._cacheQosMonitor&&n._cacheQosMonitor.writeUnexpectedFailure("UnableToReadCache"),s._TraceLogger.logError(e._logSource,t)}).then(function(){Object(h.n)()||(n._hostElem?n._addToFeatureMap(t):n._renderFeatureHost(t))}),t.localStorageKey):void 0:this.attachFeatureHostOriginal(t)},e.prototype.attachFeatureHostOriginal=function(e){if(this._isValid(e))return this._hostElem?this._addToFeatureMap(e):this._renderFeatureHost(e)},e.prototype.dismissFeatureHost=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1),this._activeKey===e&&this._dismissFeatureHost(t,n?1:this._activeMaxDisplayTimes)},e.prototype.clearFeatureHosts=function(){this._activeKey&&this._dismissFeatureHost(!1),this._featureGroups=new Map,this._featureKeys=this._featureGroups.keys()},e.prototype.normalizeCoachmarkHostProps=function(e){var t={};Object(h.x)()||(t={preventFocusOnMount:!0,positioningContainerProps:{setInitialFocus:!1}});var n=Object(a.__assign)(Object(a.__assign)({},t),e);return n.version=n.version||d,n.type=n.type||"Coachmark",n},e.prototype.normalizeFeatureHostProps=function(e){var t=Object(a.__assign)({},e);return t.version=t.version||d,t.type=t.type||"TeachingBubble",t},Object.defineProperty(e.prototype,"_getMySiteCachePromise",{get:function(){return this._cacheResultMap?Promise.resolve(void 0):(this._cacheQosMonitor=new s._QosMonitor("CoachmarkUtility.GetMySiteCache"),this.mySiteCacheManager.getCachedDataByFolder(c))},enumerable:!1,configurable:!0}),e.prototype._isValid=function(e){if(Object(h.e)())return!0;var t,n,a,i,r=!1;if(e.localStorageKey){var s=window.localStorage.getItem(e.localStorageKey)||"0.0",c=o.Version.parse(e.version);try{var l=o.Version.parse(s),u=E(e.reappearanceProps);r=l.lessThan(c)&&this._activeKey!==e.localStorageKey&&(!(u.maxDisplayTimes>1)||(t=e.localStorageKey,n=e.version||d,a=u.reappearIntervalInDays,i=window.localStorage.getItem(A(t,n))||void 0,!Boolean(i&&Date.now()<Number(i)+24*a*60*60*1e3))),this._cacheEnabled&&!r&&this._cacheResultMap&&!this._cacheResultMap.has(e.localStorageKey)&&this._markFeatureCompletion(e.localStorageKey,s)}catch(e){r=!0}}return e.displayEvaluator&&(r=e.displayEvaluator()||r),r},e.prototype._renderFeatureHost=function(e){var t;if(this._isValid(e)){var n=document.createElement("div");return e.layerElement&&(n.style.width="100%",n.style.position="absolute",e.layerElement.appendChild(n)),this._activeKey=e.localStorageKey||o.Guid.newGuid().toString(),this._activeVersion=null===(t=e.version)||void 0===t?void 0:t.toString(),this._activeMaxDisplayTimes=E(e.reappearanceProps).maxDisplayTimes,this._hostElem=n,this._currentGroupKey=e.featureGroupKey||"","Coachmark"===e.type?this._renderCoachmark(e):"TeachingBubble"===e.type?this._renderTeachingBubble(e):"Modal"!==e.type&&"FREModal"!==e.type&&"FRECustomModal"!==e.type||this._renderModal(e),this._activeKey}},e.prototype._renderCoachmark=function(e){var t,n=this,o=i.createElement(C,Object(a.__assign)(Object(a.__assign)({},e),{onBeforeDismiss:function(t){e.onBeforeDismiss&&e.onBeforeDismiss(t);var a=!!Object(h.t)()||void 0===e.displayEvaluator;n._dismissFeatureHost(a,n._getOverridedMaxDisplayTimes(e,t),t)}}));this._hostElem&&(Object(h.a)()||(null===(t=document.body)||void 0===t?void 0:t.contains(e.target)))&&r.render(o,this._hostElem)},e.prototype._getOverridedMaxDisplayTimes=function(e,t){var n=E(e.reappearanceProps);return!n.shouldAbortReappearanceOnDismiss(t)&&n.maxDisplayTimes>1?n.maxDisplayTimes:1},e.prototype._renderTeachingBubble=function(e){var t,n=this,o=i.createElement(C,Object(a.__assign)(Object(a.__assign)({},e),{onBeforeDismiss:function(t){e.onBeforeDismiss&&e.onBeforeDismiss(t);var a=!!Object(h.t)()||void 0===e.displayEvaluator;n._dismissFeatureHost(a,n._getOverridedMaxDisplayTimes(e,t),t)}}));this._hostElem&&(Object(h.a)()||(null===(t=document.body)||void 0===t?void 0:t.contains(e.targetElement)))&&r.render(o,this._hostElem)},e.prototype._renderModal=function(e){var t=this,n=i.createElement(C,Object(a.__assign)(Object(a.__assign)({},e),{modalProps:Object(a.__assign)(Object(a.__assign)({},e.modalProps),{onDismiss:function(n){var a,i,r=void 0===e.displayEvaluator;t._dismissFeatureHost(r,t._getOverridedMaxDisplayTimes(e,n),n),null===(i=(a=e.modalProps).onDismiss)||void 0===i||i.call(a)}})}));this._hostElem&&r.render(n,this._hostElem)},Object.defineProperty(e.prototype,"_nextFeatureInMap",{get:function(){var e,t=this._featureGroups.get(this._currentGroupKey);if(t){if(t.length>0)return t.shift();this._featureGroups.delete(this._currentGroupKey)}return this._currentGroupKey=this._featureKeys.next().value,this._currentGroupKey?null===(e=this._featureGroups.get(this._currentGroupKey))||void 0===e?void 0:e.shift():void(this._featureKeys=this._featureGroups.keys())},enumerable:!1,configurable:!0}),e.prototype._addToFeatureMap=function(e){var t=e.featureGroupKey||o.Guid.newGuid().toString(),n=this._featureGroups.get(t);return n||(this._featureGroups.set(t,[]),n=this._featureGroups.get(t)),Object(h.t)()||e.localStorageKey||(e.localStorageKey=o.Guid.newGuid().toString()),null==n||n.push(e),Object(h.t)()?"".concat(t).concat(e.localStorageKey||""):e.localStorageKey},e.prototype._dismissFeatureHost=function(e,t,n){if(this._hostElem){if(e&&(!n||"scroll"!==n.type)){var a=this._activeKey,i=this._activeVersion;a&&i&&this._setAndGetShouldMarkFeatureCompleted(a,i,t)&&(this._cacheEnabled?this._markFeatureCompletion(a,i):this._writeToLocalStorage(a,i),function(e,t){window.localStorage.removeItem(A(e,t)),window.localStorage.removeItem(L(e,t))}(a,i))}r.findDOMNode(this._hostElem)&&(r.unmountComponentAtNode(this._hostElem),this._hostElem=void 0,this._activeKey=void 0,this._activeVersion=void 0,this._activeMaxDisplayTimes=1);var o=this._nextFeatureInMap;o&&this._renderFeatureHost(o)}},e.prototype._writeToLocalStorage=function(t,n){var a;null===(a=this._cacheResultMap)||void 0===a||a.set(t,n);try{window.localStorage.setItem(t,n)}catch(t){s._TraceLogger.logError(e._logSource,t,"CoachmarkUtility.localStorageSetItem")}},e.prototype._setAndGetShouldMarkFeatureCompleted=function(e,t,n){void 0===n&&(n=1);var a=!0;return n>1&&(function(e,t){window.localStorage.setItem(L(e,t),(w(e,t)+1).toString()),window.localStorage.setItem(A(e,t),Date.now().toString())}(e,t),w(e,t)<n&&(a=!1)),a},e.prototype._markFeatureCompletion=function(e,t){this._writeToLocalStorage(e,t);var n=new s._QosMonitor("CoachmarkUtility.WriteMySiteCache");this.mySiteCacheManager.setCachedData(e,{version:t,lastDismissedTime:(new Date).toISOString()},void 0).then(function(){n.writeSuccess()}).catch(function(e){n.writeUnexpectedFailure("UnabledToWriteCache",e)})},e._logSource=s._LogSource.create("CoachmarkUtility"),e}()},lJtf:function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("ut3N"),s=n("Ntwx"),c=n("ybJ9"),d=n("V0zg"),l=n("oeX7"),u=n("ZSiH"),f=n("fCCa"),p=Object(r.classNamesFunction)(),m=function(e){function t(t){var n=e.call(this,t)||this;return n._choiceGroupKey="onPrimaryButtonClicked",n._renderModalContent=function(e){var t,o=Object(r.getTheme)(),c=Object(r.getRTL)(),u=n.props.overrideStyles,m=n.props,_=p(n.props.styles,{theme:o,overrideStyles:u,freModalProps:m}),h=e||n.props,b=h.secondaryButtonLabel?i.createElement(r.DefaultButton,{onClick:n._onSecondaryButtonClick},h.secondaryButtonLabel):void 0,g=h.primaryButtonLabel?i.createElement(r.PrimaryButton,{onClick:n._currentCarouselSlideIsLast?n._onDismissButtonClick:n._onPrimaryButtonClick},h.primaryButtonLabel):void 0;return i.createElement("div",{key:n.props.carouselProps?"FRE_Modal_".concat(n.state.carouselIndex):void 0},i.createElement("div",{className:_.header},n.props.swapHeadlineAndImage?i.createElement("div",{className:_.illustration},h.imageUrl&&i.createElement("img",{src:h.imageUrl,className:_.topImage,alt:l.i})):i.createElement("span",null,h.headline),i.createElement(r.IconButton,{styles:{root:{color:Object(f.r)()?o.palette.neutralPrimary:o.palette.black,marginLeft:c?"2px":"auto",marginRight:c?"auto":"2px",backgroundColor:Object(f.r)()?void 0:o.palette.white},rootHovered:{color:Object(f.r)()?o.palette.neutralDark:o.palette.black}},iconProps:{iconName:"Cancel"},ariaLabel:l.e,onClick:n._onDismissButtonClick,className:_.freModalCloseButton,"data-automation-id":Object(f.o)()?void 0:"closeFREModal"})),n._hasCarouselData&&i.createElement("div",{className:_.pagination},n._createPaginationButtons()),i.createElement("div",{className:_.body},i.createElement("div",{className:_.inner},h.subHeadlineAbove&&i.createElement("p",{className:_.subHeadline},i.createElement("b",null,h.subHeadlineAbove)),d.e.ContentWithLink(h.contentAbove,h.links),n.props.swapHeadlineAndImage?i.createElement("div",{className:_.headerMiddle},i.createElement("span",null,h.headline)):i.createElement("div",{className:_.illustration},h.imageUrl&&i.createElement("img",{src:h.imageUrl,alt:l.i})),h.subHeadline&&i.createElement("p",{className:_.subHeadline},i.createElement("b",null,h.subHeadline)),d.e.ContentWithLink(h.content,h.links),h.choices&&i.createElement(s.e,{defaultSelectedKey:"onPrimaryButtonClicked",options:null===(t=h.choices)||void 0===t?void 0:t.map(function(e,t){return Object(a.__assign)({onRenderLabel:function(e,t){return i.createElement(i.Fragment,null,i.createElement("span",{className:_.choiceTitle},i.createElement("b",null,null==e?void 0:e.title)),i.createElement("br",null),i.createElement("br",null),i.createElement("span",{className:_.choiceText},null==e?void 0:e.text))},styles:{choiceFieldWrapper:{width:"240px",backgroundColor:o.palette.white,selectors:Object(a.__assign)({"label:before":{display:"none"},"label:after":{display:"none"}},!Object(f.m)()&&{".fui-Radio__indicator":{display:"none"}})},labelWrapper:{height:"auto",maxWidth:"240px",minHeight:"96px",margin:"24px"}}},e)}),onChange:n._onChoiceGroupChanged}))),i.createElement("div",{className:_.actions},h.swapButtonPositions?i.createElement(i.Fragment,null,g,b):i.createElement(i.Fragment,null,b,g)))},n._createPaginationButtons=function(){var e=Object(r.getTheme)(),t=[];if(!n._hasCarouselData)return t;for(var a=n.props.overrideStyles,o=n.props,s=p(n.props.styles,{theme:e,overrideStyles:a,freModalProps:o}),c=0;c<n.props.carouselProps.length;c++)t.push(i.createElement(r.Icon,{className:c!==n.state.carouselIndex?s.paignationIconSecondary:s.paignationIconPrimary,iconName:c===n.state.carouselIndex?"circleFill":"CircleRing",key:c,style:{order:c}}));return t},n._onDismissButtonClick=function(){n.props.modalProps.onDismissed&&n.props.modalProps.onDismissed(),n.state.carouselIndex===n._lastPageIndex?o._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.Complete")):o._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.").concat(n.state.carouselIndex+1,".Close"))},n._onKeyDownHandler=function(e){"Escape"===e.key&&n.props.modalProps.onDismissed&&n.props.modalProps.onDismissed()},n._onSecondaryButtonClick=function(){if(n.props.carouselProps){var e=n.state.carouselIndex-1>0?n.state.carouselIndex-1:0;n.setState({carouselIndex:e}),o._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.").concat(n.state.carouselIndex+1,".Back.Click"))}else n.props.onSecondaryButtonClicked&&n.props.onSecondaryButtonClicked()},n._onPrimaryButtonClick=function(){if(n.props.choices){n.props[n._choiceGroupKey]();for(var e=0;e<n.props.choices.length;e++)n.props.choices[e].key===n._choiceGroupKey&&o._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.choices[e].id))}else if(n.props.carouselProps){var t=n.state.carouselIndex+1<n._lastPageIndex?n.state.carouselIndex+1:n._lastPageIndex;n.setState({carouselIndex:t}),o._EngagementLogger.logEvent("FirstRunExp.".concat(n.props.engagementName,".Modal.").concat(n.state.carouselIndex+1,".Click"))}else n.props.onPrimaryButtonClicked&&n.props.onPrimaryButtonClicked()},n._onChoiceGroupChanged=function(e,t){t&&(n._choiceGroupKey=t.key)},n.state={carouselIndex:0},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){document.addEventListener("keydown",this._onKeyDownHandler)},t.prototype.componentWillUnmount=function(){document.removeEventListener("keydown",this._onKeyDownHandler)},t.prototype.render=function(){var e=Object(r.getTheme)(),t=this.props.overrideStyles,n=this.props,a=p(this.props.styles,{theme:e,overrideStyles:t,freModalProps:n});return i.createElement(c.e,{isOpen:!0,isBlocking:!!this.props.carouselProps,containerClassName:a.container,scrollableContentClassName:a.scrollableContent,onDismissed:this._onDismissButtonClick,firstFocusableSelector:"FREModalCloseButton",isAlert:Object(f.l)()?void 0:this.props.isModalAlert,popupProps:{ariaLabel:Object(f.l)()?void 0:this.props.modalAriaLabel}},this.props.carouselProps?i.createElement(r.FocusTrapZone,{isClickableOutsideFocusTrap:!0},this._renderModalContent(this.props.carouselProps[this.state.carouselIndex])):this._renderModalContent())},Object.defineProperty(t.prototype,"_lastPageIndex",{get:function(){return this.props.carouselProps?this.props.carouselProps.length-1:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_hasCarouselData",{get:function(){return!!this.props.carouselProps&&this.props.carouselProps.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_currentCarouselSlideIsLast",{get:function(){return this._hasCarouselData&&this.props.carouselProps.length-1===this.state.carouselIndex},enumerable:!1,configurable:!0}),t}(i.Component),_=Object(r.styled)(m,u.e)},oeX7:function(e){e.exports=JSON.parse('{"e":"Close","i":"Main image","o":"End tour","n":"End the tour?","t":"Go back to tour","a":"Learn more about creating and publishing pages by reading {0} or {1}.","r":"Next"}')}}]);