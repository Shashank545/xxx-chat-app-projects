(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["pro-3sepa"],{JCJM:function(e,n,t){"use strict";t.d(n,"b",(function(){return m})),t.d(n,"a",(function(){return O}));var r=t("+zb2"),i=t("W4Bk");function s(e,n){var t=o();return{iframe:t,initialize:function(){return document.body.contains(t)||(t.src=e,t.style.display="none",document.body.appendChild(t)),t},postMessage:function(r,i,s){var o=function(e,r){return a(t.contentWindow,n,e,r)}(i,s);return t.contentWindow&&t.contentWindow.postMessage(r,e),o}}}var o=function(){return document.createElement("iframe")},a=function(e,n,t,r){return new Promise((function(i,s){return c((function o(a){if(a.source===e&&a.origin===n){var c=void 0,l=!1;try{c=t(a)}catch(e){return u(o),void s(e)}try{l=r(c,a)}catch(e){return u(o),void s(e)}l&&(u(o),i(c))}}))}))},c=function(e){return addEventListener("message",e,!1)},u=function(e){return removeEventListener("message",e,!1)},l=t("LLyz");var d=t("qBZW"),g={},f={},p={};function b(e,n){return g[e]?g[e]:function(e,n,t){if(e){var r=document.getElementById("ms-searchux-3s-proxy"),i=function(e,n){if(e&&e.src===n&&e.ready&&e.postMessage)return{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}};return null}(r,n);g[t]=i||v(!r,n,t)}else g[t]=v(!1,n,t);return g[t]}((t=window).mssearchux&&t.mssearchux.reuseIframe||!1||n,e+"/search/api/v2/resources",e);var t}function v(e,n,t){var i=s(n,t),o=i.initialize(),c=a(o.contentWindow,t,(function(e){return e.data}),(function(e){return"loaded"===e}));return e&&(o.id="ms-searchux-3s-proxy",o.postMessage=i.postMessage,o.ready=c),Object(r.__assign)(Object(r.__assign)({},i),{ready:c})}var m=function(e,n,t){return void 0===n&&(n="https://substrate.office.com"),void 0===t&&(t=!1),n=Object(d.c)(n),p[n]?_(e,n,t):function(e,n){return void 0===e&&(e="https://substrate.office.com"),void 0===n&&(n=!1),e=Object(d.c)(e),void 0===f[e]&&(f[e]=b(e,n).ready),f[e].then((function(){return p[e]=!0,function(t){return _(t,e,n)}}))}(n,t).then((function(n){return n(e)}))};function _(e,n,t){var r=Object(i.a)(),s=e.action,o=e.token,a=e.prefix,c=e.cvid,u=e.additionalInfo,l=e.headers;return b(n,t).postMessage(JSON.stringify({requestId:r,action:s,token:o,prefix:a,cvid:c,additionalInfo:u,headers:l}),h,(function(e){return e.requestId===r}))}function O(e){var n=JSON.parse(e)[0];n.name;return Object(r.__rest)(n,["name"])}function h(e){try{return JSON.parse(e.data)}catch(e){return Object(l.a)("Failed to parse substrate API JSON response.")}}},NC4U:function(e,n,t){"use strict";t.r(n),t.d(n,"default",(function(){return I}));var r=t("+zb2"),i=t("W4Bk"),s=t("2npF"),o=t("0DrU"),a=t("9Rby"),c=t("T3Ke"),u=t("D7WJ"),l=t("Ku/Y"),d=t("9vHv");function g(e,n,t){var i,s,o,a=e.appInfo,c=void 0===a?{}:a,u=e.hostAppInfo,l=e.hostComponentInfo,d=e.tenantInfo,g=e.spInfo,p=e.searchTextCharacteristics,b=t.userId,v=t.reasonForScrubbing,m=t.version,_=t.environment;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(((i={}).SearchUXCorrelationId=n.correlationId||"",i.AppInfo_Component=c.component||"",i),function(e,n){var t,r,i=function(e,n){return("hostAppInfo"in n?n.hostAppInfo:e)||e}(e,n),s=i.id,o=i.userRing,a=i.version,c=i.variant;return(t={}).clientId=s,t.environment=(null===(r=n.serviceEnvInfo)||void 0===r?void 0:r.environment)||(u=o,u&&f[u]||u),t.HostAppInfo_Version=a,t.HostAppInfo_Variant=c||"",t;var u}(u,n)),function(e){var n;return(n={}).HostComponentInfo_Id=e&&e.id||"",n.HostComponentInfo_Version=e&&e.version||"",n.HostComponentInfo_UserRing=e&&e.userRing||"",n}(l)),((s={}).TenantInfo_OmsId=d.omsId||"",s)),function(e){var n;return(n={siteSubscriptionId:e&&e.siteSubscriptionId||""}).SpInfo_Environment=e&&e.environment||"",n.farmLabel=e&&e.farmLabel||"",n.SpInfo_WebId=e&&e.webId||"",n.SpInfo_SiteId=e&&e.siteId||"",n}(g)||""),((o={}).QueryInfo_QueryLength=p&&p.characterCount.toString()||"",o.environment=_,o.UserInfo_Id=b,o.AppInfo_Id=c.id||"",o.ReasonForScrubbing=v,o.AppInfo_Version=m,o))}var f={test:"test",inner:"inner",outer:"prodbubble",insiders:"insiders",generalAudience:"prod"};var p=new RegExp("\\.","g");function b(e,n){var t=e.getSettingsForLogging(),r=Object.keys(t).map((function(e){return{name:e,value:t[e]}})).filter((function(e){return!!e.value})).map((function(e){return function(e){if(!e)return"";return e.replace(p,"_")}(e.name.replace("searchux.",""))}));return r.length||n&&n.length?{flights:r.concat(n||[]).join(";")}:{}}var v;function m(e){var n,t,f,p,m,O,h=(e.getBufferedLogEvents&&e.getBufferedLogEvents()||e.logEventBuffer||[]).slice(),I=null,y=e.oneds,S=e.instrumenter,E={},T={setProperty:function(e,n){E[e]=n},getProperty:function(e){return E[e]||""}},w=e.logCtx,x=w.userInfo,A=w.hostAppInfo,P=w.tenantInfo,k=x,C=A&&A.userRing&&"test"===A.userRing||Object(s.f)(P&&P.omsId),N=Object(s.c)(null==S?void 0:S.props.serviceEnvInfo,Object(d.b)(),!0),L=Object(s.d)(null===(n=null==S?void 0:S.props.serviceEnvInfo)||void 0===n?void 0:n.environment,C),D=Object(r.__assign)({instrumentationKey:"",extensions:[],extensionConfig:[],channelConfiguration:{eventsLimitInMem:50,ignoreMc1Ms0CookieProcessing:!0,overrideEndpointUrl:N},propertyConfiguration:{userAgent:"SearchUX",populateBrowserInfo:!0}},e.disableCookies&&{disableCookiesUsage:!0,propertyStorageOverride:T}),M=function(){return b(e.conf,e.logCtx.userInfo.flights)},U=Object(s.h)(Object(d.b)(),null===(t=null==S?void 0:S.props.serviceEnvInfo)||void 0===t?void 0:t.environment,null===(f=null==S?void 0:S.props.hostAppInfo)||void 0===f?void 0:f.id)?new a.a([c.a]):new a.a([]),R=j(D,y,L);S&&!S.props.correlationId&&S.setProps({correlationId:Object(i.a)()});var B=(null==S?void 0:S.props.serviceEnvInfo)&&(null===(p=null==S?void 0:S.props.hostAppInfo)||void 0===p?void 0:p.id)||"",F=Object(s.h)(Object(d.b)(),null===(m=null==S?void 0:S.props.serviceEnvInfo)||void 0===m?void 0:m.environment,B);if(F)k={id:o.b,flights:k.flights};else{var z=Object(o.a)(Object(s.b)(x.id)||"");k={id:z,flights:k.flights}}var W=(null==S?void 0:S.props.serviceEnvInfo)?null===(O=null==S?void 0:S.props.serviceEnvInfo)||void 0===O?void 0:O.environment:"";function H(){return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e.conf.getSettingsForLogging()),g(e.logCtx,S?S.props:{},{reasonForScrubbing:F,environment:W,userId:k.id,version:"1.20230918.5.0"})),function(e){var n;return(n={}).QueryInfo_QueryLength=e&&e.characterCount.toString()||"",n}(null==S?void 0:S.props.searchTextCharacteristics))}function G(n){switch((n=U.processEvent(n)).eventType){case"QOSSTOP":"FAILURE"===(t=n).result?function(e){var n={name:e.name,data:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({priority:v.Normal,nameDetail:e.nameDetail,startTime:e.startTimestamp,totalTime:e.totalTime},e.properties),M()),_(e))};e.error?J(e.error.bucketId||"unknown",e.error.detail||"unknown","error",void 0,n):J("unknown","unknown","error",void 0,n)}(t):function(e){var n;R.log({name:e.name,baseType:s.a.Qos,data:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)((n={},n.EventInfo_BaseType=s.a.Qos,n.nameDetail=e.nameDetail,n.startTime=e.startTimestamp,n.totalTime=e.totalTime,n.result=e.result,n.priority=v.Normal,n),e.properties),M()),_(e)),H())})}(t);break;case"USAGE":"engagement"===n.name&&function(n){var t=Object(l.a)(n);t&&setTimeout((function(){return e.dispatcher.dispatch(t)}))}(n),function(e){var n;R.log({name:e.name,baseType:s.a.Usage,data:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)((n={},n.EventInfo_BaseType=s.a.Usage,n.priority=v.Normal,n.EventInfo_RelativeTime=Math.round(Object(u.a)()),n.nameDetail=e.nameDetail,n),e.properties),M()),_(e)),H())})}(n);break;case"ERROR":!function(e){var n,t=e.errorType||"generic_error";switch(t){case"resultsrendered_error":n={name:t,data:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({priority:v.Normal,nameDetail:e.name},e.properties),M()),_(e))};break;case"generic_error":default:n={name:"generic_error",data:Object(r.__assign)(Object(r.__assign)({priority:v.Normal,nameDetail:e.nameDetail?e.nameDetail:"undefined"},M()),_(e))}}J(e.name||"unknown",e.detail||"unknown","error",void 0,n)}(n);break;case"PERF":!function(e){var n;R.log({name:e.metricType,baseType:s.a.Perf,data:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)((n={},n.EventInfo_BaseType=s.a.Perf,n.priority=v.Normal,n),e.metrics),M()),_(e)),H())})}(n)}var t}function J(e,n,t,i,s){var o;s&&R.log({name:s.name,baseType:"failure",data:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},s.data),H()),(o={},o.EventInfo_BaseType=s.baseType,o.Failure_Signature=e,o.Failure_Detail=n,o.Failure_Category=t,o.Failure_Id=i,o))})}return{enable:function(){h.forEach(G),h=[],null===I&&(I=e.dispatcher.register(G))},disable:function(){I&&(e.dispatcher.unregister(I),I=null)}}}function _(e){var n;return(n={}).EventInfo_DispatchTime=e.dispatchTime,n}!function(e){e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Immediate_sync=5]="Immediate_sync"}(v||(v={}));var O,h,j=(O=null,function(e,n,t,i){return O||null==(O=n.initializeLogManager())||O.initialize(e,i),{log:function(e){null==O||O.track(Object(r.__assign)(Object(r.__assign)({},e),{iKey:t}))}}});function I(e,n,t){h||(h=m(Object(r.__assign)(Object(r.__assign)({},e),{conf:n,oneds:t}))).enable()}},hlAE:function(e,n,t){"use strict";t.r(n),t.d(n,"registration",(function(){return I}));var r=t("+zb2"),i=t("KUM7"),s=t("UlRC"),o=t("rpSO"),a=t("KmCS"),c=t("F6lS"),u=t("FzQG"),l=t("2qGI"),d=t("2VtW"),g=t("POWj"),f=t("TBqy"),p=t("a7o/"),b=t("ohlq"),v=t("xo1z"),m=function(e){return"hierarchy.manager.hops:1"===e},_=t("lbO3"),O=t("q9uV");function h(e){return{displayName:e.DisplayName,userPrincipalName:e.UserPrincipalName||e.EmailAddresses[e.EmailAddresses.length-1],icon:Object(f.b)(f.a.m,e.EmailAddresses[0],!1)}}let j=class{constructor(e,n,t,r){this.searchBox=e,this.config=n,this.fetcher=t,this.conversation=r}getId(){return"AutoSuggestExtractedPeopleAnswerSuggestionProvider"}fetchSuggestionGroups(e){return Object(l.a)({searchText:e,entityTypes:Object(O.b)(this.config,e),scenario:Object(v.a)(Object(b.a)()),appOverride:Object(g.a)(),logicalSearchId:this.conversation&&this.conversation.getLogicalSearchId("sb"),conversationId:this.conversation&&this.conversation.conversationId},Object(u.a)(this.fetcher)).selectMany(e=>s.Observable.fromArray(e.value.body.Groups||[]).where(e=>"People"===e.Type).select(n=>{var t;return Object.assign(Object.assign({},n),{logProps:{traceId:Object(d.a)(e.value.body),entityId:null===(t=n.Suggestions[0])||void 0===t?void 0:t.ReferenceId},originalLogicalSearchId:e.value.logicalSearchId})}))}isValidExtractedPeopleAnswerSuggestionGroup(e){if(!e.Intent)return!1;if(!e.Suggestions||e.Suggestions.length<1)return!1;if("Organization"===e.Intent){if(e.Suggestions.length<2)return!1;let n=!1;for(let t=1;t<e.Suggestions.length;++t){if(n=e.Suggestions[t].PropertyHits.some(m),n)break}if(!n)return!1}return!0}createStream(e){return this.fetchSuggestionGroups(e).where(this.isValidExtractedPeopleAnswerSuggestionGroup).select(n=>{const t=n.Suggestions[0],r={id:"ExtractedPeopleAnswerSuggestion",searchText:e,url:"",displayText:""};switch(n.Intent){case"PhoneNumber":return Object.assign(Object.assign({},r),function(e){var n;const t=Object(_.a)(e.Phones,e=>"Mobile"===e.Type),r=null!=t?t:null===(n=e.Phones)||void 0===n?void 0:n[0];return Object.assign(Object.assign({},h(e)),{kind:"PhoneNumber",phone:r})}(t));case"EmailAddress":return Object.assign(Object.assign({},r),function(e){const n=h(e);return Object.assign(Object.assign({},n),{kind:"EmailAddress",emailAddress:n.userPrincipalName})}(t));case"OfficeLocation":return Object.assign(Object.assign({},r),function(e){return Object.assign(Object.assign({},h(e)),{kind:"OfficeLocation",officeLocation:e.OfficeLocation})}(t));case"Organization":return Object.assign(Object.assign({},r),function(e,n,t){const r=e=>({id:e.Id,searchText:n,url:"",displayText:Object(p.c)([n],e.DisplayName),secondaryDisplayText:Object(p.c)([n],e.JobTitle||""),userUpn:e.UserPrincipalName||e.EmailAddresses[e.EmailAddresses.length-1],displayName:e.DisplayName,icon:Object(f.b)(f.a.m,e.EmailAddresses[0],!1)});for(let n=1;n<t.length;++n){const i=t[n],s="hierarchy.manager.hops:1";if(i.PropertyHits.indexOf(s)>-1)return Object.assign(Object.assign({},h(e)),{kind:"Manager",relatedPerson:r(i)})}}(t,e,n.Suggestions));default:return Object(i.b)(n.Intent,void 0)}})}};j=Object(r.__decorate)([Object(O.a)({entityType:"People"}),Object(r.__param)(0,Object(o.a)("searchBox")),Object(r.__param)(1,Object(o.a)("config")),Object(r.__param)(2,Object(o.a)("fetcher")),Object(r.__param)(3,Object(o.a)("conversation"))],j);n.default=j;const I=Object(a.regs)(c.a+".autosuggestextractedpeopleanswer",j)}}]);