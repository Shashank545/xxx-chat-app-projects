(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[22],{"7lLr":function(e,t,n){"use strict";n.r(t),n.d(t,"PreventSPAppBarCalloutDismissContext",function(){return R});var a=n("17wl"),i=n("cDcd"),r=n("Q+Pn"),o=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return Object(a.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){this.props.onError(e,JSON.stringify(t))},t.prototype.render=function(){return this.state.hasError?i.createElement(i.Fragment,null):i.createElement(i.Fragment,null,this.props.children)},t}(i.Component),s=n("FEK+"),c=n("p5NW"),d=n("f6ry"),l=n("jidH"),u=n("jxDT"),f=n("Tqto");function p(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}var m,_=n("K9kD"),h=!(!(null===window||void 0===window?void 0:window.Flight)||"dev"!==window.Flight.version&&!window.Flight.devMode),b=-1!==(null===(m=null===window||void 0===window?void 0:window.document)||void 0===m?void 0:m.cookie.indexOf("srr"))||h,g="/files/fabric-cdn-prod_20230524.001",v="".concat("https://res-1.cdn.office.net").concat(g,"/"),y=b?v:"";!function(e){var t;if(!y){var n=null===(t=window.require)||void 0===t?void 0:t.toUrl("");if(n){var a=new _.Uri(n);y=_.Uri.concatenate(a.getLeftPart(_.UriPartial.authority),g)}else y=v}_.Uri.concatenate(y,"")}();var S=n("76q2"),D=i.lazy(function(){return Promise.all([n.e(38),n.e(1),n.e(6)]).then(n.bind(null,"cvwl"))}),I=i.lazy(function(){return Promise.all([n.e(1),n.e(10)]).then(n.bind(null,"C8/4"))}),x=i.lazy(function(){return n.e(11).then(n.bind(null,"kaTZ"))}),C=i.lazy(function(){return Promise.all([n.e(1),n.e(4),n.e(12)]).then(n.bind(null,"q9Gl"))}),O=i.lazy(function(){return Promise.all([n.e(4),n.e(13)]).then(n.bind(null,"5W9z"))}),w=i.lazy(function(){return Promise.all([n.e(1),n.e(15)]).then(n.bind(null,"59bo"))}),E=i.lazy(function(){return n.e(16).then(n.bind(null,"TDhT"))}),A=i.lazy(function(){return Promise.all([n.e(1),n.e(17)]).then(n.bind(null,"ndIK"))}),L=i.lazy(function(){return n.e(18).then(n.bind(null,"E460"))}),k=i.lazy(function(){return Promise.all([n.e(1),n.e(26)]).then(n.bind(null,"Ib2S"))}),M=i.lazy(function(){return n.e(27).then(n.bind(null,"ePbC"))}),P=i.lazy(function(){return n.e(23).then(n.bind(null,"Tn2r"))}),T=i.lazy(function(){return Promise.all([n.e(1),n.e(4),n.e(29)]).then(n.bind(null,"AcXC"))}),U=function(e){function t(t){var a,i=this;(i=e.call(this,t)||this).componentData={},i._initializedIcons=!1,i._isMultipleVivaConnectionsFeatureEnabled=s.e(),i._isAppBarCallsCurrentResourcesNavKSActivated=r.n(),i._isAppBarCreatePageCurrentSiteUpdateKSActivated=r.a(),i._isSpAppBarOAuthGetMySiteEnabled=!r.h()&&s.t(),i._initializeFileTypeIcons=function(){n.e(32).then(n.bind(null,"eyxc")).then(p).then(function(e){var t,n;i._initializedIcons=!0,e.initializeFileTypeIcons(null===(n=null===(t=i.props.spPageContextInfo)||void 0===t?void 0:t.spAppBarManifestScript)||void 0===n?void 0:n.replace(/\/files.*/,"".concat(g,"/assets/item-types/")))})},i._shouldPrewarm=function(e){return"false"!==new URLSearchParams(window.location.search).get("appbarprewarm")&&!i._hasGottenFreshData&&("blank"===e.workload&&"blank"!==i.state.workload||"teams"===i.state.workload)},i._handleWorkloadMessages=function(e){if(e.origin===i._windowOrigin&&e.data&&e.data.type)if("spAppBarWorkload"===e.data.type){var t=Object(d.n)("workload",e.data.payload);i.setState({workload:t})}else if("setRTL"===e.data.type){var n=e.data.isRTL?"rtl":"ltr";document.documentElement.setAttribute("dir",n)}else"spAppBarWorkloadBlank"===e.data.type&&i.setState({workload:"blank"})},i._messageParentAppStarted=function(){window.postMessage({type:"spAppBarPanelStarted"},i._windowOrigin)},i._setUpAndPrewarm=function(e){i._hasGottenFreshData=!0,i._prewarmDataClick(e)},i._prewarmDataClick=function(e){n.e(8).then(n.bind(null,"0eCT")).then(p).then(function(t){var n,a;"files"!==e&&i.props.getRecentFilesDataSource&&(t.logData({name:"SPAppBar.Files.DataClick"}),Object(c.b)(i.props.getRecentFilesDataSource,i._pageContext.webAbsoluteUrl).then(function(e){return i.receivedNewData(e,"files")}).catch()),"globalnav"!==e&&i.props.getGlobalNavDataSource&&(i._isMultipleVivaConnectionsFeatureEnabled?i._pageContext.isHomeSiteEnabled&&(_.Engagement.logData({name:"SPAppBar.GlobalNav.DataClick"}),i._isVivaHomeScenarioFlag?i.props.getGlobalNavDataSource().then(function(e){return e.getHomeSiteNav(l.NavigationSource.None,!1,!1,!0)}).catch():new u.e(i._pageContext).invokeWithAffinityHomeSite(function(e){e&&Object(f.e)(i._pageContext,e.SiteId)&&i.props.getGlobalNavDataSource&&i.props.getGlobalNavDataSource().then(function(e){return e.getGlobalNav(!1)}).catch()})):(null===(n=i._pageContext.appBarParams)||void 0===n?void 0:n.isGlobalNavEnabled)&&((null===(a=i._pageContext.companyPortalReference)||void 0===a?void 0:a.SiteId)||i._isVivaHomeScenarioFlag)&&(_.Engagement.logData({name:"SPAppBar.GlobalNav.DataClick"}),i._isVivaHomeScenarioFlag?i.props.getGlobalNavDataSource().then(function(e){return e.getHomeSiteNav(l.NavigationSource.None,!1,!1,!0)}).catch():i.props.getGlobalNavDataSource().then(function(e){return e.getGlobalNav(!1)}).catch())),"news"!==e&&i.props.getNewsFeedDataSource&&(t.logData({name:"SPAppBar.News.DataClick"}),Object(c.m)(i.props.getNewsFeedDataSource,i._pageContext.webAbsoluteUrl).then(function(e){i.receivedNewData(e,"news")}).catch()),"sites"!==e&&"create"!==e&&i.props.getSitesDataSource&&(t.logData({name:"SPAppBar.Recent.DataClick"}),Object(c.d)(i.props.getSitesDataSource,i._pageContext.webAbsoluteUrl).then(function(e){i.receivedNewData(e,"recentSites")})),"sites"!==e&&i.props.getSitesDataSource&&(t.logData({name:"SPAppBar.Frequent.DataClick"}),Object(c.f)(i.props.getSitesDataSource,i._pageContext.webAbsoluteUrl).then(function(e){i.receivedNewData(e,"frequentSites")}),t.logData({name:"SPAppBar.Followed.DataClick"}),Object(c.u)(i.props.getSitesDataSource,i._pageContext.webAbsoluteUrl).then(function(e){i.receivedNewData(e,"followedSites")})),"lists"!==e&&i.props.getRecentListsDataSource&&i.props.getFavoriteListsDataSource&&(_.Engagement.logData({name:"SPAppBar.Lists.Recent.DataClick"}),Object(c.g)(i.props.getRecentListsDataSource,i.props.getPersonalSiteDataSource,i.props.getTokenProvider,i._pageContext.webAbsoluteUrl).then(function(e){i.receivedNewData(e,"recentLists")}).catch(),_.Engagement.logData({name:"SPAppBar.Lists.Favorite.DataClick"}),Object(c.l)(i.props.getFavoriteListsDataSource,i.props.getPersonalSiteDataSource,i.props.getTokenProvider,i._pageContext.webAbsoluteUrl).then(function(e){i.receivedNewData(e,"favoriteLists")}).catch())})},i._isVivaHome=function(){return!i._isAppBarCallsCurrentResourcesNavKSActivated&&s.n()&&-1!==window.location.pathname.toLowerCase().indexOf("/_layouts/15/vivahome.aspx")};var o=Object(d.n)("workload",t.query);return i._pageContext=null!==(a=i.props.spPageContextInfo)&&void 0!==a?a:window._spPageContextInfo,i._windowOrigin=window.location.origin,i._currentSite={icon:i._pageContext.webLogoUrl,serverRelativeUrl:i._pageContext.webAbsoluteUrl,title:i._pageContext.webTitle,WebTemplate:i._pageContext.webTemplate,id:i._pageContext.siteId},i.state={workload:o},i.receivedNewData=c.x.bind(i),i._isVivaHomeScenarioFlag=i._isVivaHome(),i}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){!this._isAppBarCreatePageCurrentSiteUpdateKSActivated&&this.props.spPageContextInfo&&this._currentSite.serverRelativeUrl!==this.props.spPageContextInfo.webAbsoluteUrl&&(this._currentSite={icon:this.props.spPageContextInfo.webLogoUrl,serverRelativeUrl:this.props.spPageContextInfo.webAbsoluteUrl,title:this.props.spPageContextInfo.webTitle,WebTemplate:this.props.spPageContextInfo.webTemplate,id:this.props.spPageContextInfo.siteId}),this._shouldPrewarm(t)&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentDidMount=function(){window.addEventListener("message",this._handleWorkloadMessages),this._messageParentAppStarted(),"blank"!==this.state.workload&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentWillUnmount=function(){window.removeEventListener("message",this._handleWorkloadMessages)},t.prototype.render=function(){var e,t=null,n={useRouterNavigation:!1,pageContext:this._pageContext,onDismissAppBarPanel:this.props.onDismissAppBarPanel};switch(this.state.workload){case"globalnav":if(!this.props.getGlobalNavDataSource)break;t=this.componentData.globalnav?i.createElement(O,Object(a.__assign)({rawNavData:this.componentData.globalnav},n)):i.createElement(C,Object(a.__assign)({},n,{getGlobalNavDataSource:this.props.getGlobalNavDataSource,sendUpdatedDataToParent:this.receivedNewData}));break;case"sites":if(!this.props.getSitesDataSource)break;if(this.componentData.frequentSites&&this.componentData.followedSites&&this.componentData.recentSites){var r=this.componentData.frequentSites,o=this.componentData.followedSites,s=this.componentData.recentSites;t=Object(c.y)(r.cacheStats.lastModified,c.i)&&Object(c.y)(o.cacheStats.lastModified,c.i)&&Object(c.y)(s.cacheStats.lastModified,c.i)?i.createElement(M,Object(a.__assign)({},n,{frequentSites:Object(c.I)(r.data||[]),followedSites:Object(c.I)(o.data||[]),recentSites:Object(c.I)(s.data||[]),hideFrequentSites:!1,countToRender:Object(d.e)(window.innerHeight,!1)})):i.createElement(k,Object(a.__assign)({},n,{getSitesDataSource:this.props.getSitesDataSource,sendUpdatedDataToParent:this.receivedNewData,countToRender:Object(d.e)(window.innerHeight,!1)}))}else t=i.createElement(k,Object(a.__assign)({},n,{getSitesDataSource:this.props.getSitesDataSource,sendUpdatedDataToParent:this.receivedNewData,countToRender:Object(d.e)(window.innerHeight,!1)}));break;case"news":if(!this.props.getNewsFeedDataSource)break;if(this.componentData.news){var l=this.componentData.news;t=Object(c.y)(l.cacheStats.lastModified,c.a)?i.createElement(L,Object(a.__assign)({},n,{news:Object(c.D)(l.data),countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(A,Object(a.__assign)({},n,{getNewsFeedDataSource:this.props.getNewsFeedDataSource,sendUpdatedDataToParent:this.receivedNewData,countToRender:Object(d.e)(window.innerHeight,!0)}))}else t=i.createElement(A,Object(a.__assign)({},n,{getNewsFeedDataSource:this.props.getNewsFeedDataSource,sendUpdatedDataToParent:this.receivedNewData,countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"files":if(!this.props.getRecentFilesDataSource)break;if(this.componentData.files){this._initializedIcons||this._initializeFileTypeIcons();var u=this.componentData.files;t=Object(c.y)(u.cacheStats.lastModified,c.t)?i.createElement(x,Object(a.__assign)({},n,{files:u.data,countToRender:Object(d.e)(window.innerHeight,!0)})):i.createElement(I,Object(a.__assign)({},n,{getRecentFilesDataSource:this.props.getRecentFilesDataSource,countToRender:Object(d.e)(window.innerHeight,!0)}))}else this._initializedIcons||this._initializeFileTypeIcons(),t=i.createElement(I,Object(a.__assign)({},n,{getRecentFilesDataSource:this.props.getRecentFilesDataSource,countToRender:Object(d.e)(window.innerHeight,!0)}));break;case"teams":if(!this.props.getSitesDataSource||!this.props.getNewsFeedDataSource||!this.props.getGlobalNavDataSource)break;t=i.createElement(T,Object(a.__assign)({},n,{getGlobalNavDataSource:this.props.getGlobalNavDataSource,getSitesDataSource:this.props.getSitesDataSource,getNewsFeedDataSource:this.props.getNewsFeedDataSource,vivaHomeScenarioFlag:this._isVivaHomeScenarioFlag}));break;case"create":if(!(this.props.getTokenProvider&&this.props.getAppBarDataSource&&this.props.getSitesDataSource&&this.props.getCreatePageDataSource&&this.props.getSearchDataSource&&this.props.getGroupSiteDataSource&&this.props.getPersonalSiteDataSource))break;this._initializedIcons||this._initializeFileTypeIcons();var f=this.componentData.recentSites&&Object(c.y)(this.componentData.recentSites.cacheStats.lastModified,c.i)?Object(c.I)(null!==(e=this.componentData.recentSites.data)&&void 0!==e?e:[]):void 0;t=i.createElement(D,Object(a.__assign)({},n,{currentSite:this._currentSite,getAppBarDataSource:this.props.getAppBarDataSource,getSitesDataSource:this.props.getSitesDataSource,getCreatePageDataSource:this.props.getCreatePageDataSource,getSearchDataSource:this.props.getSearchDataSource,getGroupSiteDataSource:this.props.getGroupSiteDataSource,getPersonalSiteDataSource:this.props.getPersonalSiteDataSource,getTokenProvider:this.props.getTokenProvider,sendUpdatedDataToParent:this.receivedNewData,recentSitesFromParent:f}));break;case"lists":if(!this.props.getRecentListsDataSource||!this.props.getFavoriteListsDataSource||this._isSpAppBarOAuthGetMySiteEnabled&&!this.props.getPersonalSiteDataSource)break;if(this.componentData.recentLists&&this.componentData.favoriteLists){var p=this.componentData.recentLists,m=this.componentData.favoriteLists;t=Object(c.y)(p.cacheStats.lastModified,c.n)&&Object(c.y)(m.cacheStats.lastModified,c.n)?i.createElement(E,Object(a.__assign)({},n,{recentLists:p.data,favoriteLists:m.data,countToRender:Object(d.e)(window.innerHeight,!1,"lists")})):i.createElement(w,Object(a.__assign)({},n,{getRecentListsDataSource:this.props.getRecentListsDataSource,getFavoriteListsDataSource:this.props.getFavoriteListsDataSource,getPersonalSiteDataSource:this.props.getPersonalSiteDataSource,getTokenProvider:this.props.getTokenProvider,sendUpdatedDataToParent:this.receivedNewData,countToRender:Object(d.e)(window.innerHeight,!1,"lists")}))}else t=i.createElement(w,Object(a.__assign)({},n,{getRecentListsDataSource:this.props.getRecentListsDataSource,getFavoriteListsDataSource:this.props.getFavoriteListsDataSource,getPersonalSiteDataSource:this.props.getPersonalSiteDataSource,getTokenProvider:this.props.getTokenProvider,sendUpdatedDataToParent:this.receivedNewData,countToRender:Object(d.e)(window.innerHeight,!1,"lists")}))}return t?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S.e,{style:{height:"100%"}},i.createElement(P,{content:i.createElement(i.Suspense,{fallback:i.createElement("div",null)},t)}))):i.createElement(i.Fragment,null)},t}(i.PureComponent),F=n("5pbq"),H="/_layouts/15/spappbar.aspx?workload=".concat("blank"),R=i.createContext([!1,function(){}]),N=function(e){function t(t){var n=e.call(this,t)||this;return n._isAppBarHoverUpdateKSActive=r.i(),n._isHrElementRemovedFromAppBarKSActivated=r.u(),n._hrElementKSActivatedClassString="-372KsAct",n._preventDismissOnEvent=function(e){var t;return null!==(t=n.state.preventDismissal)&&void 0!==t&&t},n._onErrorBoundary=function(e,t){e&&n._qos&&n._qos.end({resultType:_.ResultTypeEnum.Failure,error:e.message,extraData:{errorInfo:t}})},n._handleEventFromAppBar=function(e){e.origin===window.location.origin&&e.data&&e.data.type&&("spAppBarWorkload"===e.data.type?e.data.payload!==n.state.appbarQueryString?n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload})):"CLOSE_CALLOUT"!==e.data.type&&"spAppBarCreateSite"!==e.data.type||n.state.showAppBarCallout&&n.setState({showAppBarCallout:!1}))},n._dismissAppBarPanel=function(e){if(n.state.showAppBarCallout){var t="sp-appBar-link";if((n._isHrElementRemovedFromAppBarKSActivated||n._isAppBarHoverUpdateKSActive)&&(t=n._isHrElementRemovedFromAppBarKSActivated?n._isAppBarHoverUpdateKSActive?"sp-appBar-linkOld sp-appBar-link"+n._hrElementKSActivatedClassString:"sp-appBar-link sp-appBar-link"+n._hrElementKSActivatedClassString:"sp-appBar-linkOld"),!e||!e.target||e.target.className!==t){if("focus"===(null==e?void 0:e.type))return;n.setState({showAppBarCallout:!1}),window.postMessage({type:"CLOSE_CALLOUT"},window.location.origin),window.postMessage({type:"spAppBarWorkloadBlank"},window.location.origin)}}},window.addEventListener("message",n._handleEventFromAppBar),n.state={showAppBarCallout:!1,appbarQueryString:H,firstClose:!1,preventDismissal:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._qos=new _.Qos({name:"SPAppBar.Callout.Render"})},t.prototype.render=function(){var e=this,t=document.getElementById("sp-appBar");if(!t)return null;var n=t.classList.contains("sp-appBar-mobile"),a={root:{height:"100%",display:"flex",flexDirection:"column",minWidth:n?"100%":"320px",maxWidth:n?"unset":"320px",borderRadius:0,boxShadow:"10px 5.4px 14.4px -10px rgb(0 0 0 / 13%), 10px 0.2px 3.6px -10px rgb(0 0 0 / 11%)",animation:"none",bottom:"0px !important"},container:{height:"100%",zIndex:11,minWidth:this.state.showAppBarCallout&&n?"100%":"unset"},calloutMain:{display:"flex",flexDirection:"column",height:"100%",borderRadius:0},beak:{height:"97%"},beakCurtain:{height:"96%"}},r=i.createElement(R.Provider,{value:[this.state.preventDismissal,function(t){return e.setState({preventDismissal:t})}]},i.createElement(F.Callout,{className:"spappbar-callout",id:"sp-appBar-callout",gapSpace:0,target:".sp-appBar",isBeakVisible:!1,directionalHint:F.DirectionalHint.topCenter,setInitialFocus:!0,styles:a,doNotLayer:!0,minPagePadding:-1,hidden:!this.state.showAppBarCallout,onDismiss:this._dismissAppBarPanel,shouldUpdateWhenHidden:!0,dismissOnTargetClick:!0,preventDismissOnEvent:this._preventDismissOnEvent,role:"dialog"},i.createElement(U,{query:this.state.appbarQueryString,onDismissAppBarPanel:this._dismissAppBarPanel,spPageContextInfo:this.props.spPageContextInfo,getTokenProvider:this.props.getTokenProvider,getSearchDataSource:this.props.getSearchDataSource,getGroupSiteDataSource:this.props.getGroupSiteDataSource,getCreatePageDataSource:this.props.getCreatePageDataSource,getAppBarDataSource:this.props.getAppBarDataSource,getGlobalNavDataSource:this.props.getGlobalNavDataSource,getNewsFeedDataSource:this.props.getNewsFeedDataSource,getRecentFilesDataSource:this.props.getRecentFilesDataSource,getSitesDataSource:this.props.getSitesDataSource,getRecentListsDataSource:this.props.getRecentListsDataSource,getFavoriteListsDataSource:this.props.getFavoriteListsDataSource,getPersonalSiteDataSource:this.props.getPersonalSiteDataSource})));return i.createElement(o,{onError:this._onErrorBoundary},r)},t}(i.Component);t.default=N},"Q+Pn":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"g",function(){return o}),n.d(t,"v",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"f",function(){return l}),n.d(t,"s",function(){return u}),n.d(t,"c",function(){return f}),n.d(t,"d",function(){return p}),n.d(t,"i",function(){return m}),n.d(t,"b",function(){return _}),n.d(t,"l",function(){return h}),n.d(t,"u",function(){return b}),n.d(t,"r",function(){return g}),n.d(t,"h",function(){return v}),n.d(t,"_",function(){return y}),n.d(t,"m",function(){return S}),n.d(t,"p",function(){return D}),n.d(t,"t",function(){return I});var a=n("K9kD");function i(){return a.Killswitch.isActivated("ae67ff4d-6bb3-41e6-9e75-8cbecc57c50d","02/02/2023","Add Viva navigation engagement")}function r(){return a.Killswitch.isActivated("9c2a08f8-c5fb-431f-a3a8-f30c5f9e1823","10/19/2022","Have app bar call CurrentResourcesNav rather than Global Nav")}function o(){return a.Killswitch.isActivated("42e7c12b-b9c9-4d34-ab55-b33a555c2a3b","08/04/2023","when navigating to viva home via header action, include useSecureBroker=true query param if actually using secure broker")}function s(){return a.Killswitch.isActivated("526C20AD-A49A-425E-B8B4-4A01AA3B4A2A","1/9/2023","Turn on subheadings for Viva app bar panel")}function c(){return a.Killswitch.isActivated("AA764640-A11C-4CB9-96BA-0D0FA5C8D1FF","01/09/2023","Update app bar create page to use current site")}function d(){return a.Killswitch.isActivated("B90C417C-128E-48A3-B61C-9C1FADB39FDA","01/24/2023","Make padding even for all sections in Viva panel")}function l(){return a.Killswitch.isActivated("fd4c9bf5-64de-4232-9d61-c6c3845b49a3","01/30/2023","Move Microsoft Viva link out of global nav in appbar in teams")}function u(){return a.Killswitch.isActivated("ae75b1f1-a7db-445f-a2e6-31626420d983","02/09/2023","When clicking Microsoft Viva link in appbar the panel should now close")}function f(){return a.Killswitch.isActivated("1A5E7C7B-F249-4639-A3AA-5BF175897343","02/16/2023","Add QoS event for rendering search results")}function p(){return a.Killswitch.isActivated("9F454574-4595-4775-8A75-2D58BF33E335","03/03/2023","Add focus to link with no href in Viva panel")}function m(){return a.Killswitch.isActivated("e79df8d9-8be2-43ce-b47b-9dde3991dbbf","04/14/2023","appBar iconButtons hover state - One level darker in nuetralPalette")}function _(){return a.Killswitch.isActivated("FE61F300-883C-4298-9533-BA4B1EFDB522","04/20/2023","Update list keys to be unique")}function h(){return a.Killswitch.isActivated("9abdc658-f9b2-4b16-a9c9-aaf458c1662f","05/25/2023","Global nav support for multi instances")}function b(){return a.Killswitch.isActivated("372B3BFB-0F0B-4976-84B4-E4A8C204153C","04/05/2023","Remove HR from app bar for accessibility.")}function g(){return a.Killswitch.isActivated("7f4b1b6b-460d-42de-a6e9-e8fd783ee82a","05/18/2023","Add loading shimmers to app bar panel workloads")}function v(){return a.Killswitch.isActivated("07D47605-E9FA-4096-9067-C779519BC747","06/06/2023","Use OAuth to get my site url for lists in app bar panel")}function y(){return a.Killswitch.isActivated("8263023F-71B4-44F7-BD42-A6B45CBBD342","07/07/2023","sanitize urls")}function S(){return a.Killswitch.isActivated("dbf5367d-296c-485f-bf80-a6cad987c189","07/14/2023","Make panel header support fluent UI V9 button border styles")}function D(){return a.Killswitch.isActivated("4BE11B0D-258E-4554-A9B4-5B974B195A43","07/13/2023","Remove old SPHome API code")}function I(){return a.Killswitch.isActivated("a7e079a9-5e3a-481f-9ca4-a591e32e6b39","07/18/2023","Override global nav rel attribute to allow referrer")}},f6ry:function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"n",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"a",function(){return o});var a=function(e,t){return e.replace("spappbarwebpack/spappbarwebpack.js","odsp-media/images/".concat(t))},i=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp(e+"=([^&]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},r=function(e,t,n){return e<768?"lists"===n?3:t?10:5:e<1024?"lists"===n?9:t?15:10:"lists"===n?14:t?20:15},o=function(){return!!new URL(window.location.href).searchParams.get("useSecureBroker")||!!(window&&window.sessionStorage&&window.sessionStorage.getItem("useSecureBroker"))}},p5NW:function(e,t,n){"use strict";n.d(t,"v",function(){return d}),n.d(t,"a",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"e",function(){return _}),n.d(t,"y",function(){return h}),n.d(t,"S",function(){return b}),n.d(t,"O",function(){return g}),n.d(t,"h",function(){return v}),n.d(t,"D",function(){return y}),n.d(t,"I",function(){return S}),n.d(t,"o",function(){return D}),n.d(t,"c",function(){return I}),n.d(t,"s",function(){return x}),n.d(t,"x",function(){return C}),n.d(t,"m",function(){return O}),n.d(t,"d",function(){return w}),n.d(t,"u",function(){return E}),n.d(t,"f",function(){return A}),n.d(t,"b",function(){return L}),n.d(t,"r",function(){return k}),n.d(t,"C",function(){return M}),n.d(t,"p",function(){return P}),n.d(t,"_",function(){return T}),n.d(t,"l",function(){return U}),n.d(t,"g",function(){return F});var a=n("17wl"),i=n("FEK+"),r=n("Q+Pn"),o=n("w0LS"),s=n("K9kD"),c=n("5pbq");function d(e){var t=new URL(e);return"https:"===t.protocol||"http:"===t.protocol?t.href:""}var l=36e5,u=3e5,f=4*l,p=9e5,m=1*l,_=4*l,h=function(e,t){return Date.now()-e<=t},b=function(e){return function(t){1!==t.button&&2!==t.button||s.Engagement.logData({name:e})}},g=function(e){return e.which===Object(c.getRTLSafeKeyCode)(c.KeyCodes.right)},v=function(e){return function(t){if(t.which===c.KeyCodes.enter){var n=document.getElementById(e);null==n||n.click()}}},y=function(e){return e.map(function(e){var t,n,a,i,r,o,s,c,d;return{author:{Title:null!==(a=null===(n=null===(t=e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.displayName)&&void 0!==a?a:""},description:null!==(i=e.description)&&void 0!==i?i:"",publishDate:new Date(e.firstPublishedDate),title:null!==(r=e.title)&&void 0!==r?r:"",url:e.webUrl,isAuthoritative:!1,site:{id:null!==(o=e.sharepointIds.siteId)&&void 0!==o?o:"",serverRelativeUrl:null!==(s=e.parentReference.path)&&void 0!==s?s:"",title:null!==(c=e.parentReference.siteTitle)&&void 0!==c?c:"",webTemplateId:0},image:null===(d=e.thumbnails)||void 0===d?void 0:d[0].source.url}})},S=function(e){return e.map(function(e){var t,n,a,i;return{id:e.id,serverRelativeUrl:e.webUrl,title:e.title,WebTemplate:null===(t=e.template)||void 0===t?void 0:t.name,color:null===(n=e.resourceVisualization)||void 0===n?void 0:n.color,acronym:null===(a=e.resourceVisualization)||void 0===a?void 0:a.acronym,icon:null===(i=e.resourceVisualization)||void 0===i?void 0:i.previewImageUrl}})},D=function(e,t,n){return null==e?void 0:e.filter(function(e){return null==t?void 0:t.reduce(function(t,a){return t&&!n(e,a)},!0)})},I=function(e,t,n,a){var i,r=null===(i=a?null==t?void 0:t.filter(function(e){return e.serverRelativeUrl!==a}):t)||void 0===i?void 0:i.slice(0,n),o=null==e?void 0:e.filter(function(e){return!a||e.serverRelativeUrl!==a});return[D(o,r,function(e,t){return e.serverRelativeUrl===t.serverRelativeUrl||e.serverRelativeUrl===a}),r]},x=function(e,t){return[D(e,t,function(e,t){return e.listUrl===t.listUrl}),t]};function C(e,t){var n;if(e&&t)if(e.name)this.componentData[t]=e;else{var a=this.componentData[t];(null===(n=null==a?void 0:a.cacheStats)||void 0===n?void 0:n.lastModified)?e.cacheStats.lastModified>a.cacheStats.lastModified?this.componentData[t]=e:isNaN(e.cacheStats.lastModified)&&(e.cacheStats.lastModified=Date.now(),this.componentData[t]=e):this.componentData[t]=e}}var O=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n={language:s.Locale.language,expandClause:"$expand=analytics($expand=allTime),thumbnails",section:"SharePointNewsFeedTargeted",webAbsoluteUrl:t,cacheRequestKey:"SPAppBarGetNewsFeed",cacheTimeoutTime:u,cachingStrategy:o.e.useCacheIfNotExpired,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetNewsFeed",caller:"WebAppBar",scenario:"SharePointAppBar"},[4,e()];case 1:return[2,(i=a.sent()).getNewsFeed(n).catch(function(e){return n.cachingStrategy=o.e.onlyCache,i.getNewsFeed(n).then(function(t){if(null===t)throw e;return t}).catch(function(e){throw e})})]}})})},w=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=30,[4,e()];case 1:return[2,a.sent().getRecentSites({webAbsoluteUrl:t,top:n,cacheRequestKey:"SPAppBarGetRecentSites_top".concat(n),cacheTimeoutTime:f,cachingStrategy:o.e.useCacheAndUpdateInTheBackground,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetRecentSites",caller:"WebAppBar"})]}})})},E=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=30,[4,e()];case 1:return[2,a.sent().getFollowedSites({webAbsoluteUrl:t,top:30,cacheRequestKey:"SPAppBarGetFollowedSites_top".concat(n),cacheTimeoutTime:f,cachingStrategy:o.e.useCacheAndUpdateInTheBackground,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetFollowedSites",caller:"WebAppBar"})]}})})},A=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=30,[4,e()];case 1:return[2,a.sent().getFrequentSites({webAbsoluteUrl:t,top:n,cacheRequestKey:"SPAppBarGetFrequentSites_top".concat(n),cacheTimeoutTime:f,cachingStrategy:o.e.useCacheAndUpdateInTheBackground,returnStatistics:!0,qosName:"SharePointDataSource.spAppBarGetFrequentSites",caller:"WebAppBar"})]}})})},L=function(e,t,n){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e()];case 1:return[2,a.sent().getRecentFiles({webAbsoluteUrl:t,cachingStrategy:n?o.e.bypassCache:o.e.useCacheAndUpdateInTheBackground,cacheTimeoutTime:p,returnStatistics:!0,maxItems:30,cacheRequestKey:"SPAppBarGetRecentFiles",qosName:"SharePointDataSource.spAppBarGetRecentFiles"})]}})})},k=function(e,t){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,e()];case 1:return[2,n.sent().canCreatePageForMultipleSitesWithBatching({sitesInfo:t,qosName:"SharePointDataSource.spAppBarCreatePageForMultipleSites",cacheTimeoutTime:9e5})]}})})},M=function(e,t,n,i){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var r,o,s,c,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=t.trim().split(/\s+/),o=r.reduce(function(e,t,n){var a="";return n===r.length-1&&(a="*"),e+' AND Title:"'.concat(t.replace(/"/g,'""')).concat(a,'"')},"contentclass:STS_Site AND -WebTemplate:SPSPERS"),s={request:{ClientType:"AppBar",QueryTemplate:"({searchterms}) (contentclass:STS_Web OR contentclass:STS_Site) AND (-SiteTemplateId:21 AND -webtemplate:APP AND -webtemplate:TEAMCHANNEL)",Querytext:o,RowLimit:null!=n?n:13,StartRow:null!=i?i:0,SelectProperties:["Title","Path","SiteID","WebId","Acronym","Color","SiteLogo","WebTemplate"],Properties:[{Name:"TrimSelectProperties",Value:{StrVal:"1",QueryPropertyValueTypeIndex:1}},{Name:"EnableDynamicGroups",Value:{BoolVal:"True",QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:"True",QueryPropertyValueTypeIndex:3}}],TrimDuplicates:!0}},[4,e()];case 1:return[4,a.sent().postQuery({qosName:"SharePointDataSource.spAppBarSearchSitesByTitle",query:s})];case 2:return c=a.sent(),d=[],c.PrimaryQueryResult.RelevantResults.Table.Rows.results.forEach(function(e){var t={};e.Cells.results.forEach(function(e){t[e.Key]=e.Value}),d.push({icon:t.SiteLogo,serverRelativeUrl:t.Path,title:t.Title,color:t.Color,acronym:t.Acronym,WebTemplate:t.WebTemplate,id:t.WebId})}),[2,d]}})})},P=function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,e()];case 1:return[4,n.sent().getPersonalSiteUrl({returnStatistics:!1,cacheTimeoutTime:144e5,cachingStrategy:o.e.useCacheAndUpdateInTheBackground})];case 2:if(!(t=n.sent()))throw new Error("no my-site");return[2,t]}})})},T=function(e,t,n){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return i=void 0,[4,t()];case 1:return r=a.sent(),[4,null===(s=r.getAuthToken)||void 0===s?void 0:s.call(r,{url:e,webAbsoluteUrl:n})];case 2:if(o=a.sent(),!(i="string"==typeof o?o:null==o?void 0:o.authToken))throw new Error("no authToken");return[2,i]}})})},U=function(e,t,n,s){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var c,d,l;return Object(a.__generator)(this,function(u){switch(u.label){case 0:return[4,e()];case 1:return c=u.sent(),!r.h()&&i.t()&&t&&n&&s?[4,P(t)]:[3,4];case 2:return d=u.sent(),[4,T(d,n,s)];case 3:return l=u.sent(),[3,5];case 4:d=void 0,l=void 0,u.label=5;case 5:return[2,c.getListsBy({qosName:"spAppBarGetFavoriteLists",returnStatistics:!0,cachingStrategy:o.e.useCacheAndUpdateInTheBackground,cacheTimeoutTime:m,mySiteUrl:d,authToken:l}).then(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{data:e.data.map(function(e){return"number"==typeof e.color&&"number"==typeof e.icon&&e.listId&&e.listUrl&&e.siteTitle&&e.siteUrl?{listColor:e.color,listIcon:e.icon,listId:e.listId,listUrl:e.listUrl,listTitle:e.title,siteId:e.siteId,siteTitle:e.siteTitle,siteUrl:e.siteUrl}:void 0}).filter(function(e){return void 0!==e})})})]}})})},F=function(e,t,n,s){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var c,d,l;return Object(a.__generator)(this,function(u){switch(u.label){case 0:return[4,e()];case 1:return c=u.sent(),!r.h()&&i.t()&&t&&n&&s?[4,P(t)]:[3,4];case 2:return d=u.sent(),[4,T(d,n,s)];case 3:return l=u.sent(),[2,c.getRecentLists({qosName:"spAppBarGetRecentListsDirect",returnStatistics:!0,cachingStrategy:o.e.useCacheAndUpdateInTheBackground,cacheTimeoutTime:m,mySiteUrl:d,authToken:l}).then(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{data:e.data.map(function(e){return{listColor:e.color,listIcon:e.icon,listId:e.listId,listUrl:e.listUrl,listTitle:e.listTitle,siteId:e.siteId,siteTitle:e.siteTitle,siteUrl:e.siteUrl}})})})];case 4:return[2,c.getRecentListsProxy({qosName:"spAppBarGetRecentLists",returnStatistics:!0,cachingStrategy:o.e.useCacheAndUpdateInTheBackground,cacheTimeoutTime:m}).then(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{data:e.data.map(function(e){return{listColor:e.color,listIcon:e.icon,listId:e.listId,listUrl:e.listUrl,listTitle:e.listTitle,siteId:e.siteId,siteTitle:e.siteTitle,siteUrl:e.siteUrl}})})})]}})})}}}]);