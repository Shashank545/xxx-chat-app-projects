define("af8be689-990e-492a-81f7-ba3e4cd3ed9c_1.2.2",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-component-base","@microsoft/sp-loader","@ms/odsp-core-bundle","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@ms/sp-image-edit","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-pages-core","@ms/sp-rich-image","@microsoft/sp-diagnostics","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={11:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{4:[{i:"2c46c8f0-e214-4f49-951e-fd5b9d7b4ae1",v:"1.19.0",m:"8dK2"},{i:"f9e737b7-f0df-4597-ba8c-3060f82380db",v:"1.19.0",m:"26ea"},{i:"974a7777-0990-4136-8fa6-95d80114c2e0",v:"1.19.0",m:"br4S"},{i:"1c4541f7-5c31-41aa-9fa8-fbc9dc14c0a8",v:"1.19.0",m:"X+PM"},{i:"c07208f0-ea3b-4c1a-9965-ac1b825211a6",v:"1.19.0",m:"vlQI"},{i:"1cea229f-b208-4202-8014-22503d92a019",v:"0.1.0",m:"QZHX"},{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({2:"dnd-wrappers",3:"image-gallery-brick-layout",4:"image-gallery-edit-mode",5:"image-gallery-grid-layout",14:"sp-light-box",25:"vendors~dnd-wrappers",26:"vendors~image-gallery-edit-mode",28:"vendors~sp-light-box"}[e]||e)+"_"+(["en-us","none"])[{"2":1,"3":1,"4":0,"5":1,"14":0,"25":1,"26":1,"28":1}[e]]+"_"+{2:"aa921cb588e89a310cf7",3:"45a36ce950ea223d8887",4:"5cccd654793a71cca791",5:"c71aa5c6b46a5e244645",14:"3a6f0d87d16ca0c9ed01",25:"a3da84c03802430fe8d7",26:"ed4c608e8835c5a38762",28:"2db1dee47f48ac8e7c42"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp\-image\-gallery\-webpart\-bundle_en-us_ea21e88f6c7fccaab7fa\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="Pxw3")}({"0uvb":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"s",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"o",function(){return u}),n.d(t,"r",function(){return f});var a=n("UWqr"),i=function(){function e(){}return e.isAutoCycleKillSwitchActivated=function(){return a._SPKillSwitch.isActivated(a.Guid.parse("a3063379-c3c4-45b6-8751-bd68d628db59"),"11/27/2017","Image Gallery auto cycle feature")},e.isWEXWithinWebpartDragAndDropFlight=function(){return a._SPFlight.isEnabled(1982)},e}();function r(){return a._SPKillSwitch.isActivated("0b07391e-ffed-48b9-a78e-c869ccb03a4c")}function o(){return a._SPKillSwitch.isActivated("9022c1a0-3c75-4282-8448-94bd33aedf6d")}function s(){return a._SPFlight.isEnabled(60803)}function c(){return a._SPKillSwitch.isActivated("b755a0ae-076c-4f75-a2b9-17156160e5eb")}function d(){return a._SPKillSwitch.isActivated("d83479e9-d29c-4d3e-8a7c-a73fc74840a6")}function l(){return a._SPKillSwitch.isActivated("77d69655-ebe0-4f51-8777-ffe2153527ed")}function u(){return a._SPKillSwitch.isActivated("43fb0ae1-afea-4b96-a159-926eb206873d")}function f(){return!a._SPKillSwitch.isActivated("ce4cc389-2efa-4907-8afd-1661cfca2bca")&&a._SPFlight.isEnabled(61064)}},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"5AJ/":function(e){e.exports=JSON.parse('{"e":"Add","v":"Add a title","n":"0||1||2-","l":"{0} images in selected library||{0} image in selected library||{0} images in selected library","h":"Add images","b":"Spotlight your favorite images in a gallery. Drag images here to upload.","c":"Uploading {0} image...||Uploading {0} images...","o":"1||2-","d":"All images uploaded successfully.","s":"Upload completed, but there was {0} error. Use the arrow keys to see the result for each image.||Upload completed, but there were {0} errors. Use the arrow keys to see the result for each image.","a":"Removed image {0}.","g":"Uploading image {0}","f":"\\n      Use left and right arrow keys to to move between images. Use up and down arrow keys to move between the buttons for Remove, Edit.\\n    ","t":"\\n      Press Enter to go into the carousel layout. Use left and right arrow keys to to move between images. Use up and down arrow keys to move between the buttons for Remove, Edit.\\n    ","p":"\\n      Use ctrl + left or ctrl + right arrow keys to reorder images.\\n    ","m":"\\n      Use left and right arrow keys to move between images.\\n    ","_":"Press enter to open a panel showing detailed information about this image.","i":"Image: {0}, {1}, {2}","r":"Image: {0} has been deleted from Image Gallery.","u":"\\n      There are {0} items in the Image Gallery as {1} layout. {2} {3}. {4}.\\n    "}')},"5pbq":function(e,t){e.exports=i},"7Awa":function(e,t){e.exports=r},GBZ2:function(e){e.exports=JSON.parse('{"o":"Image gallery","e":"{0}","a":"You don\\u0027t have permissions to access the selected library. If you select a different library, you won\\u0027t be able to return to this selection.","i":"You don\\u0027t have permissions to access the selected library. Contact your site administrator.","t":"No images are available to show. The document library used as the source for the images may have been removed.","r":"Selected list was not enable private CDN, please contact admin to enable it.","n":"Can\\u0027t get document library information. Try again later."}')},I6O9:function(e,t){e.exports=o},K9kD:function(e,t){e.exports=s},Pk8u:function(e,t){e.exports=c},Pxw3:function(e,t,n){"use strict";n.r(t);var a,i=n("17wl"),r=n("cDcd"),o=n("faye"),s=n("y88i"),c=n("hiL/"),d=n("XCtM"),l=n("mMzb"),u=n("2q6Q"),f=n("U4ag"),p=n("7Awa"),m=n("UWqr"),_=n("ut3N"),h=n("Pk8u"),b=n("lxgo"),g=function(){function e(){}return Object.defineProperty(e,"componentId",{get:function(){return""},enumerable:!1,configurable:!0}),e.import=function(){return n.e(3).then(n.bind(null,"EZa7")).then(function(e){return e.BrickLayout})},e}(),v=n("acy6"),y=function(){function e(){}return e.import=function(){return Promise.all([n.e(26),n.e(4)]).then(n.bind(null,"eRmg"))},e}(),S=n("h92K"),D=n("Qeeh"),I=function(){function e(e){this._validExtensions=e.validExtensions,this._maxSizeBytes=e.maxSizeBytes}return e.prototype.validate=function(e){var t=[];return e instanceof File&&(this._hasValidExtension(e.name)||t.push(new Error(D.e)),this._isWithinSizeLimits(e.size)||t.push(new Error(D.t))),t},e.prototype._hasValidExtension=function(e){for(var t=0;t<this._validExtensions.length;t++)if(-1!==e.toLowerCase().indexOf(this._validExtensions[t],e.length-this._validExtensions[t].length))return!0;return!1},e.prototype._isWithinSizeLimits=function(e){return e<this._maxSizeBytes},e}(),x=n("vNcA"),C=n("5pbq"),O=n("r9Fm"),w=n("0uvb"),E=function(){function e(){}return e.recordCountOfUploadingFile=function(e){var t=new _._LogEntry("ImageGalleryWP","DragAndDropUpload",_._LogType.Event,{files:e});u._EngagementLogger.logEventWithLogEntry(t)},e.recordClickCountInDifferentLayout=function(e){u._EngagementLogger.logEventWithLogEntry(new _._LogEntry("ImageGalleryWebPart","LightBoxShowedInDifferentLayout",_._LogType.Event,{layout:S.t[e]}))},e.recordReorderInGrid=function(e,t,n,a){u._EngagementLogger.logEventWithLogEntry(new _._LogEntry("ImageGalleryWebPart","ReorderGird",_._LogType.Event,{totalCount:String(e),oldIndex:String(t),newIndex:String(n),temporaryItemsCount:String(a)}))},e.recordOpenFilerPicker=function(){u._EngagementLogger.logEvent("ImageGalleryWP.FilePicker","Open")},e.recordCancelFilePicker=function(){u._EngagementLogger.logEvent("ImageGalleryWP.FilePicker","UserCancelled")},e.recordSelectItemInFilePicker=function(e,t,n){var a=new _._LogEntry("ImageGalleryWP","FilePicker",_._LogType.Event,{onFileSelectedSuccess:String(e),localUpload:String(t),numFilesSelected:String(n)});u._EngagementLogger.logEventWithLogEntry(a)},e}(),A=Object(C.classNamesFunction)(),L=function(e){var t=e.variantTheme;return t?{root:[{color:t.semanticColors.bodyText+" !important"}],focusHover:[{selectors:{"&:hover::after":{borderColor:t.semanticColors.variantBorderHovered+" !important"}}}],addImageButton:{borderColor:"transparent",selectors:{"& .ms-Button-label":{color:t.semanticColors.actionLink},"&:hover .ms-Button-label, &:focus .ms-Button-label, &:active .ms-Button-label":{color:t.semanticColors.actionLinkHovered+" !important"},"& .ms-Button-icon":{color:t.semanticColors.link},"&:hover .ms-Button-icon, &:focus .ms-Button-icon, &:active .ms-Button-icon":{color:t.semanticColors.linkHovered+" !important"}}}}:{root:void 0,focusHover:void 0,addImageButton:void 0}},k=n("K9kD"),M=[300,480,750,1024,1600,2560];function P(e){var t=e.pageContext,n=e.img,a=e.src,i=e.siteId,o=e.listId,d=e.webId,l=e.uniqueId;if(!a||""===a.trim())return n;var u=new k.SPResourcePath(a),f=u.domain,p=c.ExtensionHelper.getExtension(u)||"",m=".sharepointonline.com",_=Boolean(f)&&-1!==f.indexOf(m,f.length-m.length);if(!_&&!T(f,".sharepoint.com")&&!T(f,".spoppe.com")||!c.ThumbnailUrlGenerator.isFileTypeSupported(p))return n;for(var h=function(e){if(_){var n=new s.Uri(a);return n.setQueryParameter("width",String(e)),n.setQueryParameter("height",String(e)),n.toString()}var r={absoluteUrl:t&&t.web&&t.web.absoluteUrl,spResource:a,siteId:i,webId:d,listId:o,uniqueId:l,fileType:p,width:e,callerId:"imageGalleryGrid"};return c.ThumbnailUrlGenerator.getThumbnailUrl(r)},b=[],g=0;g<M.length;g++){var v="(max-width:".concat(M[g],"px)"),y=h(M[g]);b.push(r.createElement("source",{srcSet:y,media:v,key:M[g]}))}return b.length?r.createElement("picture",{onError:function(e){var t=e.target,n="srcSet";if(t&&null!==t.parentNode&&null!==t.parentNode.firstChild&&t.parentNode.firstChild.getAttribute&&t.parentNode.firstChild.getAttribute(n)!==a)for(var i=t.parentElement.getElementsByTagName("source"),r=0;r<i.length;r++)i[r].setAttribute(n,a)}},b,n):n}function T(e,t){return!e||-1!==e.indexOf(t,e.length-t.length)}!function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(a||(a={}));var U=n("tGpx"),F=n("hUCW"),H=n("jOlS");H.loadStyles('.jx_ai_9f38462c{display:flex;height:100%;position:absolute;top:0}[dir=ltr] .jx_ai_9f38462c{right:0}[dir=rtl] .jx_ai_9f38462c{left:0}.jy_ai_9f38462c{background-color:"[theme:neutralQuaternaryAlt, default: #e1dfdd]";bottom:0;color:#767676;height:40px;opacity:.8;position:absolute;transition:opacity .167s cubic-bezier(.1,.9,.2,1);width:100%}[dir=ltr] .jy_ai_9f38462c{right:0}[dir=rtl] .jy_ai_9f38462c{left:0}.jy_ai_9f38462c .jz_ai_9f38462c{font-size:15px;padding:6px;vertical-align:sub}.jy_ai_9f38462c .ka_ai_9f38462c{font-size:13px}.jy_ai_9f38462c .kb_ai_9f38462c{font-size:21px;padding:8px;vertical-align:sub}.jy_ai_9f38462c .kc_ai_9f38462c{font-size:17px}[dir=ltr] .jy_ai_9f38462c .fx_ai_9f38462c.w_ai_9f38462c{padding-right:70px}[dir=rtl] .jy_ai_9f38462c .fx_ai_9f38462c.w_ai_9f38462c{padding-left:70px}[dir=ltr] .jy_ai_9f38462c .fx_ai_9f38462c:not(.w_ai_9f38462c){right:70px}[dir=rtl] .jy_ai_9f38462c .fx_ai_9f38462c:not(.w_ai_9f38462c){left:70px}[dir=ltr] .jy_ai_9f38462c .hi_ai_9f38462c.w_ai_9f38462c{padding-right:9px}[dir=rtl] .jy_ai_9f38462c .hi_ai_9f38462c.w_ai_9f38462c{padding-left:9px}[dir=ltr] .jy_ai_9f38462c .hi_ai_9f38462c:not(.w_ai_9f38462c){right:9px}[dir=rtl] .jy_ai_9f38462c .hi_ai_9f38462c:not(.w_ai_9f38462c){left:9px}.jy_ai_9f38462c .ke_ai_9f38462c{flex-direction:column}.jy_ai_9f38462c .kf_ai_9f38462c{flex-direction:row}.kg_ai_9f38462c{color:"[theme:themePrimary, default: #0078d4]";font-size:21px;font-weight:100;padding:9px;vertical-align:top}.kh_ai_9f38462c{background-color:transparent;border:0;box-shadow:none;box-sizing:border-box;color:#767676;cursor:pointer;display:inline-block;font-size:17px;font-weight:300;height:100%;margin:0;min-width:auto;padding:10px}.kh_ai_9f38462c::-moz-focus-inner{border:0}.kh_ai_9f38462c{outline:transparent;position:relative}.kh_ai_9f38462c.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .kh_ai_9f38462c:focus:after{border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;bottom:0;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.kh_ai_9f38462c:hover{color:#333}.ki_ai_9f38462c{font-size:17px;padding:9px}.kj_ai_9f38462c{word-wrap:normal;color:"[theme:neutralPrimary, default: #323130]";overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.kj_ai_9f38462c:not(.w_ai_9f38462c){font-size:17px;font-weight:300}.kj_ai_9f38462c.w_ai_9f38462c{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}[dir=ltr] .kj_ai_9f38462c.w_ai_9f38462c{padding-left:9px}[dir=rtl] .kj_ai_9f38462c.w_ai_9f38462c{padding-right:9px}.kk_ai_9f38462c{position:absolute}[dir=ltr] .kk_ai_9f38462c{left:9px}[dir=rtl] .kk_ai_9f38462c{right:9px}.kl_ai_9f38462c{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;speak:none;color:"[theme:neutralPrimary, default: #323130]";display:inline-block;font-style:normal;font-weight:400;line-height:1}.km_ai_9f38462c:hover .jy_ai_9f38462c{color:#333}.km_ai_9f38462c{height:100%;position:relative;width:100%}.kn_ai_9f38462c{top:50%;transform:translateY(-50%)}.ko_ai_9f38462c{position:absolute}[dir=ltr] .ko_ai_9f38462c{left:0}[dir=rtl] .ko_ai_9f38462c{right:0}.kp_ai_9f38462c{position:relative;width:100%}.kp_ai_9f38462c:not(.kr_ai_9f38462c):hover:after,.kp_ai_9f38462c[data-is-focused-in=true]:not(.kq_ai_9f38462c):after{border:2px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;bottom:-2px;content:"";left:-2px;pointer-events:none;position:absolute;right:-2px;top:-2px}.ks_ai_9f38462c{bottom:8px;opacity:0;position:absolute;transition:all .15s ease;visibility:hidden}[dir=ltr] .ks_ai_9f38462c{right:8px}[dir=rtl] .ks_ai_9f38462c{left:8px}.kp_ai_9f38462c[data-is-focused-in=true] .ks_ai_9f38462c{opacity:1;visibility:visible}.kt_ai_9f38462c{outline-style:solid;outline-width:1px}.ku_ai_9f38462c{border:1px solid "[theme:neutrallight, default: #edebe9]"}.kv_ai_9f38462c{left:50%;top:50%;transform:translate(-50%,-50%)}.kw_ai_9f38462c{position:absolute}.kx_ai_9f38462c{padding:9px}.ky_ai_9f38462c{display:inline-block}.kz_ai_9f38462c{vertical-align:super}.la_ai_9f38462c{color:"[theme:themePrimary, default: #0078d4]"}.lb_ai_9f38462c{color:"[theme:redDark, default: #a4262c]"}.lc_ai_9f38462c{font-size:17px;font-weight:300}.le_ai_9f38462c{background-color:"[theme:neutralLighterAlt, default: #faf9f8]";position:relative}.le_ai_9f38462c .lf_ai_9f38462c{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.lg_ai_9f38462c{background-color:"[theme:neutralLighter, default: #f3f2f1]";position:relative}.lh_ai_9f38462c{background-color:transparent;background-image:linear-gradient(180deg,transparent 15%,rgba(0,0,0,.7));display:flex;flex-direction:column;height:100%;justify-content:flex-end;left:0;position:absolute;top:0;width:100%}.li_ai_9f38462c{color:#fff;padding:32px}.li_ai_9f38462c .z_ai_9f38462c{-webkit-line-clamp:2;font-size:"[theme:xxLargePlusFontSize, default: 32px]";font-weight:"[theme:xxLargePlusFontWeight, default: 600]";margin:0;max-height:2.7em}.li_ai_9f38462c .lj_ai_9f38462c,.li_ai_9f38462c .z_ai_9f38462c{-webkit-box-orient:vertical;box-sizing:content-box;display:-webkit-box;overflow:hidden}.li_ai_9f38462c .lj_ai_9f38462c{-webkit-line-clamp:3;font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";margin-top:16px;max-height:4.05em}.lk_ai_9f38462c{word-wrap:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}[dir=ltr] .lk_ai_9f38462c{padding-left:9px}[dir=rtl] .lk_ai_9f38462c{padding-right:9px}.lk_ai_9f38462c:not(.w_ai_9f38462c){font-size:14px;font-weight:100}.lk_ai_9f38462c.w_ai_9f38462c{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}',!0);var R="jx_ai_9f38462c",N="kl_ai_9f38462c",B="km_ai_9f38462c",j="kp_ai_9f38462c",V="kw_ai_9f38462c",z="kx_ai_9f38462c",G="lb_ai_9f38462c",K="lc_ai_9f38462c";function W(e){var t=Object(C.getTheme)(),n=t.effects,a=t.isInverted,i=t.palette;return r.createElement("div",{className:Object(C.mergeStyles)("ks_ai_9f38462c",Object(w.t)()&&{borderRadius:n.roundedCorner4,backgroundColor:a?i.neutralQuaternary:i.neutralLighter,button:{borderRadius:n.roundedCorner4}})},e.shouldShowMoveButton&&r.createElement(c.ToolbarButton,{fabricIconKey:"Move",title:F.a}),r.createElement(c.ToolbarButton,{fabricIconKey:"Edit",title:F.t,automationId:"edit-button",onClick:e.onEdit}),r.createElement(c.ToolbarButton,{fabricIconKey:"Delete",title:F.e,automationId:"delete-button",onClick:e.onDelete}))}var q=function(e){function t(t){var n=e.call(this,t)||this;return n._isNewDndExperience=w.e.isWEXWithinWebpartDragAndDropFlight(),n._handleFocus=function(){n.props.onEdit(n.props.image,!0),n.setState({isFocusedInside:!0})},n._handleBlur=function(){n.setState({isFocusedInside:!1})},n._handleKeyDown=function(e){!n._isCarouselMode()||e.keyCode!==C.KeyCodes.left&&e.keyCode!==C.KeyCodes.right||e.preventDefault()},n._onImageLoad=function(e,t){var a,i;n.setState({serviceTypeWhenLoaded:t}),null===(i=(a=n.props).onImageLoadOrFail)||void 0===i||i.call(a,e)},n._onImageLoadFailure=function(e,t){var a,i;null===(i=(a=n.props).onImageLoadOrFail)||void 0===i||i.call(a,t)},n._onDeleteClick=function(){n.props.onDelete(n.props.image)},n._onEditClick=function(){n.props.onEdit(n.props.image)},n.state={serviceTypeWhenLoaded:void 0,isFocusedInside:!1},n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props.image.altText||this.props.image.title||this.props.image.url&&this.props.image.url.split("/").pop(),t=this.props.host===S.t.Carousel||this.props.edit?void 0:F.n,n={uniqueId:this.props.image.id,webId:this.props.image.webId,imageUrl:this.props.image.url,siteId:this.props.image.siteId,listId:this.props.image.listId},a=r.createElement(U.SPImg,{alt:Object(w.r)()?this.props.image.isDecorative?"":this.props.image.altText||void 0:e,"aria-label":t,callerId:"ImageGallery",height:this.props.renderHeightStyle,imageData:n,imageFit:this._getImageFit(),onInViewport:this.props.onInViewport,onLazyTimeout:this.props.onLazyTimeout,onImageLoad:this._onImageLoad,onImageLoadFailure:this._onImageLoadFailure,getDefaultImage:c.DefaultImageHelper.getDefaultImage,serviceScope:this.props.serviceScope,thumbnailWidth:this.props.thumbnailWidth,width:this.props.renderWidthStyle,draggable:!this._isNewDndExperience}),i=Object(C.css)(j,this._isCarouselMode()&&"kq_ai_9f38462c","kr_ai_9f38462c");return r.createElement("div",{className:i,key:this.props.image.id,"data-automation-id":"image-item","data-is-focusable":!0,onFocus:this._handleFocus,onBlur:this._handleBlur,"data-is-focused-in":this.state.isFocusedInside,onKeyDown:this._handleKeyDown},r.createElement(C.FocusZone,{className:B,direction:C.FocusZoneDirection.vertical,isCircularNavigation:!0},r.createElement("div",{"data-is-focus-item":!0,"aria-label":e,className:"lg_ai_9f38462c"},a,this._renderTitleAndCaption(),this._renderToolBar())))},t.prototype._getImageFit=function(){return"stockImage"===this.state.serviceTypeWhenLoaded?"none":1===this.props.imageCropping?"cover":3===this.props.imageCropping?"contain":void 0},t.prototype._renderToolBar=function(){return this.props.edit&&r.createElement(W,{shouldShowMoveButton:this.props.host===S.t.Grid,onEdit:this._onEditClick,onDelete:this._onDeleteClick})},t.prototype._isCarouselMode=function(){return this.props.host===S.t.Carousel},t.prototype._renderTitleAndCaption=function(){return this._isCarouselMode()&&(this.props.image.title||this.props.image.description)&&r.createElement("div",{className:"lh_ai_9f38462c"},r.createElement("div",{className:"li_ai_9f38462c"},r.createElement("h3",{className:"z_ai_9f38462c"},r.createElement(C.TooltipHost,{content:this.props.image.title,overflowMode:a.Parent},this.props.image.title)),r.createElement("div",{className:"lj_ai_9f38462c"},r.createElement(C.TooltipHost,{content:this.props.image.description,overflowMode:a.Parent},this.props.image.description))))},t}(r.Component),Q=n("wfAw"),Y=function(e){function t(t){var n=e.call(this,t)||this;return n._dismissFailedUpload=n._dismissFailedUpload.bind(n),n._registerStateHandlers(t),n}return Object(i.__extends)(t,e),t.prototype.render=function(){return this._getUploadProgressContent.call(this)},t.prototype._registerStateHandlers=function(e){var t=this;this.state||(this.state={uploadState:1},e.uploadPromise.catch(function(e){t.setState({uploadState:3,errorMessage:e.message})}))},t.prototype._getUploadProgressContent=function(){var e=void 0,t=this.props.host===S.t.Carousel?"kv_ai_9f38462c":"kn_ai_9f38462c";switch(this.state.uploadState){case 1:e=r.createElement("div",null,r.createElement("div",{className:Object(C.css)(V,z,t)},r.createElement("div",{className:"ky_ai_9f38462c"},r.createElement(C.Spinner,{type:C.SpinnerType.large})),r.createElement("span",{className:Object(C.css)("kz_ai_9f38462c",z)},Q.a)),r.createElement("div",{className:R},r.createElement("div",{className:"ki_ai_9f38462c"},s.StringHelper.format(Q.n,this.props.currentIndex,this.props.totalUploading))));break;case 2:e=r.createElement("div",null,r.createElement("div",{className:Object(C.css)("la_ai_9f38462c",V,K,t)},r.createElement(C.Icon,{className:Object(C.css)(N,"kg_ai_9f38462c"),iconName:"CheckMark"}),Q.e));break;case 3:var n=void 0,a=void 0;this.props.host===S.t.Carousel?(n="kb_ai_9f38462c",a="kc_ai_9f38462c"):(n="jz_ai_9f38462c",a="ka_ai_9f38462c"),e=r.createElement("div",{role:"alert","aria-live":"assertive",className:G},r.createElement("div",{className:Object(C.css)(t,V)},r.createElement(C.Icon,{className:Object(C.css)(N,G,n),iconName:"Info"}),r.createElement("span",{className:Object(C.css)(a,G)},this.state.errorMessage)),r.createElement("div",{className:R},r.createElement("button",{onClick:this._dismissFailedUpload,className:Object(C.css)("kh_ai_9f38462c",K),title:Q.t,"data-automation-id":"remove-button"},r.createElement(C.Icon,{className:Object(C.css)(N,G),iconName:"Cancel"}))));break;default:_._TraceLogger.logVerbose(_._LogSource.create("ImageGallery.WP.GridItem"),"UploadState not handled")}return r.createElement("div",{className:j},r.createElement(C.FocusZone,{className:B,direction:C.FocusZoneDirection.vertical,isCircularNavigation:!0},r.createElement("div",{className:Object(C.css)("le_ai_9f38462c","kt_ai_9f38462c"),style:{width:this.props.renderWidthStyle,height:this.props.renderHeightStyle}},r.createElement("img",{src:U.STOCK_IMAGE,className:"lf_ai_9f38462c",alt:"",role:"presentation"})),r.createElement("div",{className:Object(C.css)("jy_ai_9f38462c","itemActionsBar")},e)))},t.prototype._dismissFailedUpload=function(){this.props.id&&this.props.dismissItem(this.props.id,!0)},t}(r.Component),J=function(){function e(){}return e.getThumbnailSource=function(e,t,n){var a=!!(t.url&&t.siteId&&t.webId&&t.id),i=c.ExtensionHelper.getExtension(new k.SPResourcePath(t.url))||"";return a?c.ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:e,spResource:t.url,siteId:t.siteId,webId:t.webId,listId:t.listId,uniqueId:t.id,fileType:i,width:n,callerId:"imageGallery"}):t.url},e}();H.loadStyles('.cq_h_9f38462c div{outline:0}.cq_h_9f38462c .cr_h_9f38462c{display:inline-block}.cq_h_9f38462c .cs_h_9f38462c{background-color:"[theme:redDark, default: #a4262c]"}.cq_h_9f38462c .ct_h_9f38462c{color:"[theme:neutralPrimary, default: #323130]";font-size:28px;font-weight:100;margin:0}.cq_h_9f38462c .cu_h_9f38462c{background:none;border:0;color:"[theme:neutralPrimary, default: #323130]";cursor:pointer;font-size:14px;font-weight:400;height:16px;margin-bottom:23px;text-decoration:none}.cq_h_9f38462c .cv_h_9f38462c{color:"[theme:themePrimary, default: #0078d4]";font-size:16px}[dir=ltr] .cq_h_9f38462c .cv_h_9f38462c{margin-right:8px}[dir=rtl] .cq_h_9f38462c .cv_h_9f38462c{margin-left:8px}.cw_h_9f38462c{display:inline}.cx_h_9f38462c{border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;text-indent:-9999px;width:1px}.cy_h_9f38462c{background:"[theme:neutralPrimary, default: #323130]";color:"[theme:white, default: #ffffff]";padding:10px}.cy_h_9f38462c,.cy_h_9f38462c .z_h_9f38462c{word-wrap:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.cy_h_9f38462c:not(.w_h_9f38462c) .z_h_9f38462c{font-size:28px;font-weight:lighter}.cy_h_9f38462c:not(.w_h_9f38462c) .bm_h_9f38462c{font-size:14px}.cy_h_9f38462c:not(.w_h_9f38462c) .bm_h_9f38462c,.cy_h_9f38462c:not(.w_h_9f38462c) .z_h_9f38462c{font-weight:100}.cy_h_9f38462c.w_h_9f38462c .z_h_9f38462c{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.cy_h_9f38462c.w_h_9f38462c .bm_h_9f38462c{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}.cz_h_9f38462c{align-content:center;height:calc(100% - 60px);margin:30px auto;position:relative;width:90%}.ea_h_9f38462c{height:100%;margin:auto;position:relative}.eb_h_9f38462c{bottom:0;height:auto;left:0;margin:auto;max-height:100%;max-width:100%;position:absolute;right:0;top:0;width:auto}.ec_h_9f38462c:not(.w_h_9f38462c){font-size:14px}.ec_h_9f38462c.w_h_9f38462c{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.ee_h_9f38462c{border-bottom:1px solid "[theme:neutrallight, default: #edebe9]";border-top:1px solid "[theme:neutrallight, default: #edebe9]";margin:12px 0 0}.ef_h_9f38462c{color:"[theme:neutralSecondary, default: #605e5c]";display:inline-block;font-size:17px;font-weight:300;margin:10px 0 15px;overflow:hidden;position:relative}.eg_h_9f38462c{margin-bottom:20px;position:relative}',!0);var X="cq_h_9f38462c",Z="w_h_9f38462c",$=function(){function e(){}return e.renderLightBoxItem=function(e,t){if(e&&e.url){var n=e.url;c.PreviewUtility.getDefaultImage(new k.SPResourcePath(e.url))&&(n=J.getThumbnailSource(t.web.absoluteUrl,e));var a=r.createElement("img",{src:n,alt:Object(w.r)()?e.altText:e.altText||e.title,className:"eb_h_9f38462c"}),i=0;(e.title||e.description)&&(e.title&&e.description?i=132:e.title?i=113:e.description&&(i=67));var o={height:"calc(100% - ".concat(i,"px)")},s=Object(C.mergeStyles)("cy_h_9f38462c",Z);return r.createElement("div",{className:"cz_h_9f38462c"},r.createElement("div",{className:"ea_h_9f38462c",style:o},r.createElement(P,{pageContext:t,img:a,src:e.url,siteId:e.siteId,webId:e.webId,listId:e.listId,uniqueId:e.id})),r.createElement("div",{className:s},r.createElement("h3",{className:"z_h_9f38462c","data-automation-id":"lightBoxTitle"},e.title),r.createElement("span",{className:"bm_h_9f38462c"},e.description)))}},e.renderLayoutItem=function(e,t,n,a,o,s){switch(t.renderWidthStyle=n,t.renderHeightStyle=a,t.host=e,t.type){case 1:return t.imageCropping=t.imageCropping||1,t.theme=o.theme,t.cdnBaseUrls=o.cdnBaseUrls,r.createElement(q,Object(i.__assign)({},t,{thumbnailWidth:s}));case 2:return r.createElement(Y,Object(i.__assign)({},t));default:throw new Error("ImageGridLayoutItemType is not handled in Image ".concat(S.t[e]," Layout renderItem"))}},e}(),ee=n("qtZ+"),te=n("GBZ2"),ne=n("5AJ/"),ae="ImageGallery",ie=function(e){function t(a){var i=e.call(this,a)||this;return i._placeholderRef=r.createRef(),i._itemsCompleted=0,i._itemsLoading=0,i._renderCompleted=!1,i._maxWidthUsedForFetchingImages=0,i._addButtonRef=r.createRef(),i._galleryContainer=r.createRef(),i._eventListenersAdded=!1,i._isNewDndExperience=w.e.isWEXWithinWebpartDragAndDropFlight(),i._loadDndWrappers=function(){var e=i.props.edit,t=i.state,a=t.DndChildWrapper,r=t.DndParentWrapper;i._isNewDndExperience&&e&&!a&&!r&&Promise.all([n.e(25),n.e(2)]).then(n.bind(null,"+tbV")).then(function(e){i.setState({DndChildWrapper:e.Reorderable,DndParentWrapper:e.DragDropContextProviderWrapper})}).catch(function(e){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),e,"LoadImageGalleryDndWrapperComponents")})},i._renderBrickItem=function(e,t,n){return $.renderLayoutItem(S.t.Brick,i._itemsToDisplay[e],t,n,i.props,t)},i._renderCarouselItem=function(e,t,n){var a=i._itemsToDisplay[t];return 1===a.type&&(a.imageCropping=3),$.renderLayoutItem(S.t.Carousel,a,n,n?.5625*n:void 0,i.props,i.props.width)},i._clickLayoutItem=function(e){i.props.edit||i._clickLayoutItemOnViewMode(e)},i._getItemRatio=function(e){var t=i._itemsToDisplay[e];return 2===t.type?Promise.resolve(1):(t.thumbnailSource||(t.thumbnailSource=i._getThumbnailSource(t.image)),ee.e.readThumbnailImageRatio({imageData:{uniqueId:t.image.id,webId:t.image.webId,imageUrl:t.image.url,siteId:t.image.siteId,listId:t.image.listId},serviceScope:i.props.serviceScope,thumbnailWidth:i._maxWidthUsedForFetchingImages,callerId:"ImageGalleryReadRatio",getDefaultImage:c.DefaultImageHelper.getDefaultImage,cdnBaseUrls:void 0}).catch(function(){return 1}))},i._getThumbnailSource=function(e){return i._maxWidthUsedForFetchingImages=Math.max(i._maxWidthUsedForFetchingImages,600),J.getThumbnailSource(i.props.pageContext.web.absoluteUrl,e,i._maxWidthUsedForFetchingImages)},i._wrapDnDIfFlighted=function(e,t){var n=i.props.edit,a=i.state.DndChildWrapper;return i._isNewDndExperience&&n&&a?r.createElement(a,{dragDropType:"ImageItem",dropTargetPlaceholderZIndex:1,index:t,onReorder:i._onReorderGrid,renderDropTargetPlaceholder:!0,listId:"ImageGallery"},e):e},i._wrapGalleryControlInDnd=function(e){var t=i.state.DndParentWrapper;return i._isNewDndExperience&&t?r.createElement(r.Suspense,{fallback:!1},r.createElement(t,null,e)):e},i._setDelayedFocus=function(){setTimeout(i._setFocus,400)},i._setFocus=function(){return 0===i.props.images.length&&i._addButtonRef.current?i._addButtonRef.current.focus():i._currentFocusElement?i._currentFocusElement.focus():i._lastFocusElement?i._lastFocusElement.focus():void(i._focusZone&&i._focusZone.focus(!0))},i._onReorderGrid=function(e,t){E.recordReorderInGrid(i.props.images.length,e,t,i.state.items.length);var n=i.state.items.length;if(e-=n,t-=n,!i._getIsReorderIndexOutOfBoundary(e,t)){var a=i.props.images.splice(e,1)[0];i.props.images.splice(t,0,a),i.forceUpdate()}},i._onFileSelected=function(e){var n=Boolean(e&&e.localFilesPickedToUpload&&e.localFilesPickedToUpload.length>0),a=Boolean(e&&e.externalImagesPickedToUpload&&e.externalImagesPickedToUpload.length>0);if(n||a){var r=[];e.localFilesPickedToUpload&&r.push.apply(r,e.localFilesPickedToUpload.map(function(e){return e.file})),e.externalImagesPickedToUpload&&r.push.apply(r,e.externalImagesPickedToUpload),E.recordSelectItemInFilePicker(!0,Boolean(e.localFilesPickedToUpload),r.length),i._onUploadFiles(r)}else if(e&&e.selectedItems&&e.selectedItems.length>0){for(var o=0,s=e.selectedItems;o<s.length;o++){var c=s[o];if(c.Link){var d={siteId:c.SiteId,webId:c.WebId,listId:c.ListId,id:c.UniqueId,url:c.ServerAbsoluteUrl||c.Link,title:"",isInList:!0,description:"",altText:"",imageTileWidth:t.getImageTileWidth(i.props.webPartProps.layout),galleryImgId:i._isNewDndExperience?m.Guid.newGuid().toString():void 0};i.props.images.unshift(d)}}i.forceUpdate(),E.recordSelectItemInFilePicker(!0,!1,e.selectedItems.length)}else E.recordSelectItemInFilePicker(!1,!1,0);i._addButtonRef.current&&i._addButtonRef.current.focus(),Object(w.o)()||m._SPEventManager.instance.raiseEvent("recordSurveyEvent",{name:"ImageEditUsage"})},i._onFileCanceled=function(){i._placeholderRef.current&&i._placeholderRef.current.focusOnPlaceHolderButton(),E.recordCancelFilePicker()},i._onTitleChange=function(e){i.props.onTitleSet(e)},i._openFilePicker=function(){i._ensureFilePicker().then(function(e){e.open(),E.recordOpenFilerPicker()}).catch(function(e){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),e,"OpenFilePicker")})},i._ensureFilePicker=function(){if(!i._filePickerPromise){var e={onSelect:i._onFileSelected,onCancel:i._onFileCanceled,selectionMode:x.SelectionMode.multiple,itemTypes:new Set([O.t.Images]),callerName:"ImageGalleryWebPart"};i._filePickerPromise=f.EditModeUtilitiesLoader.GetUtilities().then(function(t){return t.FilePickerLoader.load(i.props.serviceScope,e)})}return i._filePickerPromise},i._addDragAndDropListeners=function(){!i._eventListenersAdded&&i._galleryContainer.current&&i.props.edit&&(i._eventListenersAdded=!0,i._galleryContainer.current.addEventListener("drop",i._onDrop),i._galleryContainer.current.addEventListener("dragover",i._allowDrop))},i._removeDragAndDropListeners=function(){i._eventListenersAdded&&i._galleryContainer.current&&(i._eventListenersAdded=!1,i._galleryContainer.current.removeEventListener("drop",i._onDrop),i._galleryContainer.current.removeEventListener("dragover",i._allowDrop))},i._allowDrop=function(e){e.preventDefault(),e.stopPropagation()},i._onDrop=function(e){var t;(null===(t=e.dataTransfer)||void 0===t?void 0:t.files)&&(e.preventDefault(),e.stopPropagation(),E.recordCountOfUploadingFile(e.dataTransfer.files&&e.dataTransfer.files.length.toString()),i._onUploadFiles(e.dataTransfer.files,"DataTransferDropped"))},i._onUploadFiles=function(e,t){_._TraceLogger.logVerbose(i._logSource,s.StringHelper.format("Files uploaded: {0}",e.length));for(var n=Object(d.setEditModeCustomerPromiseHandlerInfo)("ImageGallery Webpart ".concat(t||"UploadFiles"," Failure"),i.props.serviceScope),a=new _._QosMonitorShareFailureWithCP("".concat(ae,".").concat(t||"UploadFiles"),!1,[n]),r=e.length,o=0,l=function(t){var n=i.state.items,d=m.Guid.newGuid().toString(),l=i.props.onFileReadyToUpload(e[t]).then(function(e){return i.props.webPartProps.layout===S.t.Brick?ee.e.loadThumbnailImage({imageData:{uniqueId:e.id,webId:e.webId,imageUrl:e.url,siteId:e.siteId,listId:e.listId},serviceScope:i.props.serviceScope,thumbnailWidth:i._maxWidthUsedForFetchingImages,cdnBaseUrls:void 0,callerId:"ImageGalleryUpload",getDefaultImage:c.DefaultImageHelper.getDefaultImage}).then(function(){return i._dismissTemporaryItem(d),null==a||a.writeSuccess(),e}):(i._dismissTemporaryItem(d),null==a||a.writeSuccess(),Promise.resolve(e))},function(e){return++i._failedItemCount===n.length&&i.setState({screenReaderAlert:i._createUploadStateMessage(n.length,i._failedItemCount)}),null==a||a.writeUnexpectedFailure("UploadFailure",e),Promise.reject(e)});o++,n.push({id:d,type:2,edit:i.props.edit,uploadPromise:l,totalUploading:r,currentIndex:o,dismissItem:i._dismissTemporaryItem}),i.setState({items:n,screenReaderAlert:s.StringHelper.formatWithLocalizedCountValue(ne.c,ne.o,e.length)})},u=0;u<e.length;u++)l(u)},i._dismissTemporaryItem=function(e,t){t&&i._failedItemCount--;var n=i.state.items.filter(function(t){return t.id!==e});i.setState({items:n,screenReaderAlert:i._createUploadStateMessage(n.length,i._failedItemCount)})},i._handleDeleteImage=function(e){i._currentFocusElement=void 0,i.props.onDeleteImage(e),c.ScreenReaderAlert.read(s.StringHelper.format(ne.r,e.title||e.url&&e.url.split("/").pop()),c.ReadingMode.ReadImmediately),i._setStateAfterDeleteDialog(!0)},i._onLoadOrError=function(e){i._itemsCompleted++;var t=i.props,n=t.webPartProps,a=t.images;!i._renderCompleted&&(1===i._itemsCompleted&&n.layout===S.t.Carousel||a&&i._itemsCompleted===Math.min(a.length,20)||i._itemsCompleted>=i._itemsLoading)&&(i.props.renderCompleted(),i._renderCompleted=!0)},i._onInViewport=function(){i._itemsLoading++},i._onLazyTimeout=function(){0!==i._itemsCompleted||0!==i._itemsLoading||i._renderCompleted||(i.props.renderCompleted(),i._renderCompleted=!0)},i._logSource=_._LogSource.create("".concat(ae,".WP.Main")),i._failedItemCount=0,i.state={currentImage:void 0,items:[],screenReaderAlert:void 0},i}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"_classNames",{get:function(){return Boolean(this.props.theme)&&A(L,{variantTheme:this.props.theme})},enumerable:!1,configurable:!0}),t.getImageTileWidth=function(e){switch(e){case S.t.Grid:return 300;case S.t.Brick:return 600;case S.t.Carousel:default:return}},t._getItemAriaLabel=function(e,n){void 0===n&&(n=!1);var a=e;switch(a.type){case 1:return n?t._getLightBoxImageAriaLabel(a.image):t._getViewModeImageAriaLabel(a.image);case 2:return s.StringHelper.format(ne.g,a.currentIndex)}},t._getLightBoxImageAriaLabel=function(e){return e.title||e.description||e.altText?s.StringHelper.format(ne.i,e.title||"",e.description||"",e.altText||""):e.url&&e.url.split("/").pop()},t._getViewModeImageAriaLabel=function(e){return e.altText||e.title||e.url&&e.url.split("/").pop()},t._getAriaLabelForLayout=function(e,n,a){return s.StringHelper.format(ne.u,n.toString(),S.t[a],t._getNavigationInstructionAriaLabel(e,a),e&&a===S.t.Grid?ne.p:"",e||a!==S.t.Grid&&a!==S.t.Brick?"":ne._)},t._getNavigationInstructionAriaLabel=function(e,t){return e?t===S.t.Carousel?ne.t:ne.f:ne.m},t.prototype.render=function(){var e=this;return this._itemsToDisplay=Object(i.__spreadArray)(Object(i.__spreadArray)([],this.props.edit?this.state.items:[],!0),this.props.images.map(function(t){return{id:t.id?t.id:e._isNewDndExperience&&t.galleryImgId?t.galleryImgId:void 0,type:1,edit:e._isEditable,image:t,webAbsoluteUrl:e.props.webAbsoluteUrl,onDelete:e._handleDeleteImage,onEdit:e.props.onEditImage,onImageLoadOrFail:e._onLoadOrError,onInViewport:e._onInViewport,onLazyTimeout:e._onLazyTimeout,getDefaultImage:c.DefaultImageHelper.getDefaultImage,serviceScope:e.props.serviceScope}}),!0),this.props.edit?this._editModeContent:this._viewModeContent},t.prototype.componentDidMount=function(){this._addDragAndDropListeners(),this._loadDndWrappers()},t.prototype.componentDidUpdate=function(){this._addDragAndDropListeners(),this._loadDndWrappers()},t.prototype.componentWillUnmount=function(){this._removeDragAndDropListeners()},t.prototype._webPartTitle=function(){var e=this.props.edit&&this.props.webPartProps.imageSourceType===S.e.Curated,t=this._classNames?this._classNames.root:"";return r.createElement(f.WebPartTitle,{className:t,edit:this.props.edit,title:this.props.webPartProps.title,placeholder:ne.v,onTitleChange:this._onTitleChange,marginBottomSize:e?"Middle":"Large",theme:this.props.theme})},t.prototype._clickLayoutItemOnViewMode=function(e){this._showLightBox(e),E.recordClickCountInDifferentLayout(this.props.webPartProps.layout)},Object.defineProperty(t.prototype,"_galleryControl",{get:function(){var e=this;if(0!==this._itemsToDisplay.length){var n={componentRef:function(t){return e._focusZone=t},onActiveElementChanged:function(t){e._lastFocusElement===t?e._lastFocusElement=void 0:e._lastFocusElement=e._currentFocusElement===t?e._lastFocusElement:e._currentFocusElement,e._currentFocusElement=t}};switch(this.props.edit?(n.direction=C.FocusZoneDirection.horizontal,n.isCircularNavigation=!0,n.isInnerZoneKeystroke=function(e){return e.which===C.KeyCodes.up||e.which===C.KeyCodes.down}):(n.direction=C.FocusZoneDirection.bidirectional,n.isCircularNavigation=!1),this.props.webPartProps.layout){case S.t.Grid:var a={width:this.props.width,items:this._itemsToDisplay,getReactKey:function(t,n){return e._getLayoutItemKey(n)},onRenderItem:function(t,n,a,i){var r=$.renderLayoutItem(S.t.Grid,e._itemsToDisplay[n],a,i,e.props,a);return e._wrapDnDIfFlighted(r,n)},itemSize:this.props.webPartProps.gridSettings.imageSize,onItemClick:function(t,n){return e._clickLayoutItem(n)},canReorder:this.props.edit&&this.props.webPartProps.imageSourceType!==S.e.Dynamic,ariaLabel:t._getAriaLabelForLayout(this.props.edit,this.props.images.length,S.t.Grid),getItemAriaLabel:t._getItemAriaLabel,focusZoneProps:n,aspectRatio:this.props.webPartProps.gridSettings.imageAspectRatio,onReorder:this.props.edit?this._onReorderGrid:void 0,theme:this.props.theme};return this.props.gridComponentClass?r.createElement(this.props.gridComponentClass,a):void 0;case S.t.Carousel:var i=h.cloneDeep(this.props.webPartProps.carouselSettings);w.e.isAutoCycleKillSwitchActivated()&&(i.autoplay=!1);var o={items:this._itemsToDisplay,settings:i,edit:this.props.edit,onRenderItem:this._renderCarouselItem,strings:{containerAriaLabelEditMode:t._getAriaLabelForLayout(!0,this.props.images.length,S.t.Carousel),containerAriaLabelReadMode:t._getAriaLabelForLayout(!1,this.props.images.length,S.t.Carousel)},width:this.props.width,theme:this.props.theme,stopAutoplayAfterFirstRun:!1};return this.props.carouselComponentClass?r.createElement(this.props.carouselComponentClass,o):void 0;case S.t.Brick:var s={items:this._itemsToDisplay.map(function(t,n){return{index:n,key:e._getLayoutItemKey(n)}}),width:this.props.width,onRenderItem:this._renderBrickItem,onClickItem:this._clickLayoutItem,getItemRatio:this._getItemRatio,ariaLabel:t._getAriaLabelForLayout(this.props.edit,this.props.images.length,S.t.Brick),getItemAriaLabel:function(n){return t._getItemAriaLabel(e._itemsToDisplay[n])},focusZoneProps:n,theme:this.props.theme};return this.props.brickComponentClass?r.createElement(this.props.brickComponentClass,s):void 0;default:return}}},enumerable:!1,configurable:!0}),t.prototype._getLayoutItemKey=function(e){var t=this._itemsToDisplay[e],n=this._itemsToDisplay.filter(function(e){return e.id===(null==t?void 0:t.id)}).indexOf(t);return"".concat(t.id,"_").concat(n)},t.prototype._showLightBox=function(e){var a=this,o=[];this._itemsToDisplay.forEach(function(e){1===e.type&&o.push(e.image)});var s={items:o,startIndex:e,isShown:!0,showPagination:!0,lightDismiss:!0,onClose:this._setDelayedFocus,getItemAriaLabel:function(e){return t._getItemAriaLabel(a._itemsToDisplay[e],!0)||""},onRenderItem:function(e){return $.renderLightBoxItem(e,a.props.pageContext)}};this._lightBox?this._lightBox.show(s):Promise.all([n.e(28),n.e(14)]).then(n.bind(null,"PiBD")).then(function(n){n.LightBox.show({callerId:"ImageGalleryLightBox",items:o,startIndex:e,isShown:!0,onClose:a._setDelayedFocus,showPagination:!0,onRenderItem:function(e){var t=Object(i.__assign)({imageUrl:e.url},e);return r.createElement(d.ImageLightBoxItem,{image:t,serviceScope:a.props.serviceScope,callerId:"ImageGalleryLightBox"})},getItemAriaLabel:function(e){return t._getItemAriaLabel(a._itemsToDisplay[e],!0)||""}})}).catch(function(e){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),e,"LoadLibraryLightBoxChunk")})},Object.defineProperty(t.prototype,"_editModeContent",{get:function(){var e=this._showPlaceholder&&r.createElement("div",null,r.createElement(f.Placeholder,{icon:"Picture",ref:this._placeholderRef,iconText:te.o,buttonLabel:ne.h,description:ne.b,onAdd:this._openFilePicker,webpartWidth:this.props.width})),t=Object(C.css)(this._classNames&&this._classNames.addImageButton,"cu_h_9f38462c"),n=this.props.webPartProps.imageSourceType===S.e.Curated&&r.createElement(C.ActionButton,{className:t,"data-automation-id":"addImages-button",onClick:this._openFilePicker,"aria-label":ne.h,iconProps:{iconName:"CalculatorAddition"},text:ne.e,componentRef:this._addButtonRef}),a=r.createElement("h2",{className:"ct_h_9f38462c"},this._webPartTitle(),n);return r.createElement("div",{className:X,"data-automation-id":"imageGallery"},a,this._imageCountHintText,this._errorMessage,r.createElement("div",{ref:this._galleryContainer},this._showPlaceholder?e:this._wrapGalleryControlInDnd(this._galleryControl)),this._screenReaderAlert)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_imageCountHintText",{get:function(){var e=s.StringHelper.formatWithLocalizedCountValue(ne.l,ne.n,this.props.images?this.props.images.length:0),t=Object(C.mergeStyles)("ec_h_9f38462c",Z);return this._isImageSourceDynamic&&!this.props.errorMessage?r.createElement("p",{className:t},e):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_viewModeContent",{get:function(){return r.createElement("div",{onLoad:this._onLoadOrError,onError:this._onLoadOrError,className:X,"data-automation-id":"imageGallery"},this.props.webPartProps.title&&this._webPartTitle(),this._errorMessage,this._galleryControl)},enumerable:!1,configurable:!0}),t.prototype._getIsReorderIndexOutOfBoundary=function(e,t){return e<0||e>=this.props.images.length||t<0||t>=this.props.images.length},t.prototype._createUploadStateMessage=function(e,t){return 0===e?ne.d:e===t?s.StringHelper.formatWithLocalizedCountValue(ne.s,ne.o,t):void 0},t.prototype._setStateAfterDeleteDialog=function(e){this._setDelayedFocus(),this.setState({screenReaderAlert:!0===e&&this.state.currentImage?s.StringHelper.format(ne.a,this.state.currentImage.title):this.state.screenReaderAlert,currentImage:void 0})},Object.defineProperty(t.prototype,"_errorMessage",{get:function(){return this.props.errorMessage?r.createElement("div",{className:"ee_h_9f38462c"},r.createElement("p",{className:"ef_h_9f38462c"},this.props.errorMessage)):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_screenReaderAlert",{get:function(){return void 0!==this.state.screenReaderAlert&&r.createElement("p",{role:"alert","aria-live":"assertive",className:"cx_h_9f38462c"},this.state.screenReaderAlert)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isImageSourceDynamic",{get:function(){return this.props.webPartProps.imageSourceType===S.e.Dynamic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isEditable",{get:function(){return this.props.edit&&this.props.webPartProps.imageSourceType===S.e.Curated},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_showPlaceholder",{get:function(){return 0===this._itemsToDisplay.length&&this.props.webPartProps.imageSourceType===S.e.Curated},enumerable:!1,configurable:!0}),t}(r.Component),re=n("RxoY"),oe=function(){function e(){}return Object.defineProperty(e,"componentId",{get:function(){return""},enumerable:!1,configurable:!0}),e.import=function(){return n.e(5).then(n.bind(null,"81fD")).then(function(e){return e.ImageGridLayout})},e}(),se=_._LogSource.create("ImageGalleryWebPart"),ce="ImageGalleryWebPart.CDN.{0}",de=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._hasDocumentLibrariesRetrieved=!1,t._delayedGetImagesFromDocLib=h.debounce(t._instantlyGetImagesFromDocLib,600),t._originalImageCount=void 0,t.dataReceived=function(e){if(t._isImageSourceDynamic){if(e.data&&e.data.length>0)t._imagesFromSelectedDocLib=e.data[0].images;else{var n=e.data;n&&n.data&&n.data.length>0&&(t._imagesFromSelectedDocLib=n.data[0].images)}t.render()}},t.fetchData=function(){return t._isImageSourceDynamic?t._instantlyGetImagesFromDocLib(!1).then(function(){return[{images:t._imagesFromSelectedDocLib}]}):Promise.resolve([{images:[]}])},t._clearInternalAndBaseWebpartErrors=function(){t._errorMessage=void 0,t.clearError()},t._selectDocumentLibrary=function(e){var n,a=null===(n=t._documentLibrariesEnabledPrivateCDN)||void 0===n?void 0:n.filter(function(t){return t.Id===e});if(null==a?void 0:a.length){t.properties.listId=a[0].Id,t.properties.listUrl=h.get(a[0],"RootFolder.ServerRelativeUrl");var i=a[0].RootFolder,r=i?i.ServerRelativeUrl:void 0;r?t._dataAggregator.then(function(e){return e.isDocumentLibraryCdnEnabled(r)}).then(function(e){t.properties.isCdnEnabledForList=e,u._EngagementLogger.logEvent(m.Text.format(ce,e?"Enabled":"Disabled")),e||(t.properties.maxImagesCount=Math.min(t.properties.maxImagesCount,v.e)),t.context.propertyPane.refresh()}).catch(function(e){return _._TraceLogger.logError(se,e,"ImageGalleryWebPart.CheckCdnStatus")}):t.properties.isCdnEnabledForList=!1,t.context.propertyPane.refresh(),t._delayedGetImagesFromDocLib(!0)}else t._handleNoPermissionAndRender()},t._handleNoEnablePrivateCDNAndRender=function(){t._errorMessage=te.r,t.render()},t._handleNoPermissionAndRender=function(){t._errorMessage=t.displayMode===m.DisplayMode.Edit?te.a:te.i,t.render()},t._getDocumentLibrarySelectionsAndSetDefaultSelection=function(){t._documentLibrarySelections.then(function(){if(t._errorMessageFetchingDocLibs="",t._documentLibraries&&t._documentLibraries.length>0){if(!t._documentLibrariesEnabledPrivateCDN||t._documentLibrariesEnabledPrivateCDN.length<=0)return;var e=t._documentLibraries.filter(function(e){return e.Id===t.properties.listId}),n=t._documentLibrariesEnabledPrivateCDN.filter(function(e){return e.Id===t.properties.listId});if(n.length)return t._selectDocumentLibrary(n[0].Id);if(void 0===t.properties.listId)return t._selectDocumentLibrary(t._documentLibrariesEnabledPrivateCDN[0].Id);e.length?t._handleNoEnablePrivateCDNAndRender():t._handleNoPermissionAndRender()}}).catch(t.renderError)},t._logFirstViewData=function(){if(!t.renderedOnce&&t.displayMode!==m.DisplayMode.Edit){var e,n,a;switch(t.properties.imageSourceType){case S.e.Curated:case S.e.Dynamic:e=S.e[t.properties.imageSourceType];break;default:e="UnexpectedImageSourceType"}if(t.properties.imageSourceType===S.e.Dynamic){switch(t.properties.isRecursive){case!0:case!1:n=String(t.properties.isRecursive);break;default:n="UnexpectedIsRecursiveValue"}a=t.properties.maxImagesCount}var i=t.properties.carouselSettings&&t.properties.carouselSettings.autoplay,r=t.properties.carouselSettings&&t.properties.carouselSettings.autoplaySpeed,o=new _._LogEntry("ImageGalleryWebPart","FirstViewData",_._LogType.Event,{imageSourceType:String(e),isRecursive:String(n),layoutName:S.t[t.properties.layout],isAutoCycleEnabled:String(i),autoCycleSpeed:String(r),maxImagesCount:String(a),imagesCount:String(t._images&&t._images.length)});u._EngagementLogger.logEventWithLogEntry(o)}},t._onEditImage=function(e,n){t.properties.imageSourceType===S.e.Curated&&(t._editingImage=e,n?t.context.propertyPane.refresh():t.context.propertyPane.open())},t._onTitleSet=function(e){t.properties.title=e},t._onDeleteImage=function(e){return t.properties.imageSourceType===S.e.Curated?t._dataAggregator.then(function(t){return t.deleteImage(e)}).then(t.render,t.renderError):Promise.resolve()},t._handleUpload=function(e){return t._dataAggregator.then(function(t){return t.uploadImage(e)})},t._handleThemeChangedEvent=function(e){t._theme=e.theme,t.render()},t}return Object(i.__extends)(t,e),t._calculateItemSize=function(e){return e===re.e.Wide?re.t.Large:re.t.Medium},Object.defineProperty(t.prototype,"previewImageUrl",{get:function(){var e=this._hasImages?this._images[0]:void 0;if(e)return Object(f.webPartPreviewThumbnail)({pageContext:this.context.pageContext,url:e.url,siteId:e.siteId,webId:e.webId,listId:e.listId,uniqueId:e.id})},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this;this.renderedOnce||this.renderedFromPersistedData||this.context.propertyPane.open();var t=this._getImageOverride();this._originalImageCount||(this._originalImageCount=t.length);var n={cdnBaseUrls:this._cdnBaseUrls,edit:this.displayMode===m.DisplayMode.Edit,errorMessage:this._errorMessage,images:t,onDeleteImage:this._onDeleteImage,onEditImage:this._onEditImage,onFileReadyToUpload:this._handleUpload,onTitleSet:this._onTitleSet,pageContext:this.context.pageContext,renderCompleted:this.renderCompleted.bind(this),renderedFromPersistedData:this.renderedFromPersistedData,serviceScope:this.context.serviceScope,theme:this._theme,webAbsoluteUrl:this.context.pageContext.web.absoluteUrl,webPartProps:this.properties,width:this.width},a=this.context.webPartTag;this.renderedOnce||u._EngagementLogger.logEventWithLogEntry(new _._LogEntry("ImageGalleryWebPart","LayoutAndCorrespondingImagesCountWhenRender",_._LogType.Event,{layoutType:String(S.t[n.webPartProps.layout]),imageCount:String(t.length)}));var i=n.webPartProps.layout;(u._PerformanceLogger.saveTempData("".concat(a,".loadLayoutStart"),u._PerformanceLogger.now()),i===S.t.Carousel?b.e.loadCarousel().then(function(e){n.carouselComponentClass=e}):i===S.t.Brick?g.import().then(function(e){n.brickComponentClass=e}):oe.import().then(function(e){n.gridComponentClass=e})).then(function(){o.render(r.createElement(ie,n),e.domElement),u._PerformanceLogger.saveTempData("".concat(a,".syncLayoutRenderComplete"),u._PerformanceLogger.now())}).catch(function(e){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),e,"Load".concat(S.t[i],"LayoutDuringRender"))}),this._logFirstViewData()},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return m.Version.parse("1.9")},enumerable:!1,configurable:!0}),t.prototype.onBeforeSerialize=function(){var e,t=this.properties;t.imageSourceType!==S.e.Dynamic||t.hasDynamicModeEnabled||(t.hasDynamicModeEnabled=!0);var n=t.layout;if(n===S.t.Carousel)t.layoutComponentId=b.e.carouselComponentId;else if(n===S.t.Grid)t.layoutComponentId=oe.componentId;else if(n===S.t.Brick)t.layoutComponentId=g.componentId;else if(n)throw new Error("Add component Id for new layout ".concat(n," here"));if(t.images&&t.images.filter(function(e){return!e.id&&!e.url}).length>0)throw new Error("One or more image is missing required property to identify image");var a=this._getImageOverride().length;(null===(e=this._originalProperties)||void 0===e?void 0:e.layout)===this.properties.layout&&this._originalImageCount===a||u._EngagementLogger.logEventWithLogEntry(new _._LogEntry("ImageGalleryWebPart","LayoutAndCorrespondingImagesCountWhenChanged",_._LogType.Event,{layoutType:String(S.t[this.properties.layout]),imageCount:String(a)})),this._updateImageTileWidth(t)},t.prototype.onAfterDeserialize=function(e,n){this._originalProperties=h.cloneDeep(e),e.layout===S.t.Masonry&&(e.layout=S.t.Grid);var a=!!e.gridSettings&&1===n.major&&n.minor<3;return a&&!e.gridSettings.imageAspectRatio&&(e.gridSettings.imageAspectRatio=1),a&&e.gridSettings.imageAspectRatio&&(e.gridSettings.imageSize=t._calculateItemSize(e.gridSettings.imageAspectRatio)),n.lessThan(m.Version.parse("1.4"))&&(e.imageSourceType||(e.imageSourceType=S.e.Curated),void 0===e.isRecursive&&(e.isRecursive=!1),void 0===e.maxImagesCount&&(e.maxImagesCount=10)),!!e.carouselSettings&&1===n.major&&n.minor<5&&void 0===e.carouselSettings.autoplaySpeed&&(e.carouselSettings.autoplay=!1,e.carouselSettings.autoplaySpeed=5),e.carouselSettings&&n.lessThan(m.Version.parse("1.6"))&&(e.carouselSettings.lazyLoad=!0),e.images=e.images.filter(Boolean),e},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return this._hasImages},enumerable:!1,configurable:!0}),t.prototype.onPropertyPaneConfigurationStart=function(){this._isImageSourceDynamic&&this._getDocumentLibrarySelectionsAndSetDefaultSelection()},t.prototype.loadPropertyPaneResources=function(){var e=this;return y.import().then(function(t){e._imageGalleryPropertyPaneDefaultSettings=t.PropertyPaneSettings.getDefaultSettings,e._imageGalleryPropertyPaneItemEditSettings=t.PropertyPaneSettings.getItemEditSettings})},t.prototype.getPropertyPaneConfiguration=function(){var e=new u._QosMonitor("ImageGalleryWebPart.GetPropertyPaneConfiguration");try{if(this.context.propertyPane.isRenderedByWebPart()&&this._editingImage){var t=this._imageGalleryPropertyPaneItemEditSettings({image:this._editingImage,webPartProps:this.properties});return e.writeSuccess(),t}return t=this._imageGalleryPropertyPaneDefaultSettings({webPartProps:this.properties,documentLibrariesEnabledPrivateCDN:this._documentLibrariesEnabledPrivateCDN,documentLibraries:this._documentLibraries,hasDocumentLibrariesRetrieved:this._hasDocumentLibrariesRetrieved,errorMessageFetchingDocLibs:this._errorMessageFetchingDocLibs,isScribeHosted:this._isScribeHosted()}),e.writeSuccess(),t}catch(t){throw e.writeUnexpectedFailure("Failure",t),t}},t.prototype.onInit=function(){var t=this.properties.layout;return this._getEmphasisTheme(),u._PerformanceLogger.markComponent(this.context.webPartTag,"".concat(u._PerformanceDataDimensions.Layout).concat(S.t[t])),t===S.t.Carousel?b.e.loadModule().catch(function(e){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),e,"LoadCarouselLayoutDuringInit")}):t===S.t.Brick?g.import().catch(function(e){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),e,"LoadBrickLayoutDuringInit")}):t===S.t.Grid&&oe.import().catch(function(e){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),e,"LoadGridLayoutDuringInit")}),e.prototype.onInit.call(this)},Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){return s.StringHelper.format(te.e,this.properties.title||te.o)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){var e={title:{isSearchablePlainText:!0},"images[*].title":{isSearchablePlainText:!0},"images[*].description":{isSearchablePlainText:!0},"images[*].altText":{isSearchablePlainText:!0},"images[*].url":{isImageSource:!0}},t=this.properties,n={};return t&&(t.layout!==S.t.Carousel&&t.layout!==S.t.Grid&&t.layout!==S.t.Brick||(n.siteId="images[*].siteId",n.webId="images[*].webId",n.listId="images[*].listId",n.uniqueId="images[*].id",n.fixedWidth="images[*].imageTileWidth",n.minCanvasWidth="images[*].minCanvasWidth"),e["images[*].url"].customMetadata=n),e.layoutComponentId={isComponentDependency:!0},e},enumerable:!1,configurable:!0}),t.prototype.onAfterResize=function(e){this.render()},t.prototype.onPropertyPaneFieldChanged=function(n,a,i){if("gridSettings.imageAspectRatio"===n&&a!==i)this.properties.gridSettings.imageSize=t._calculateItemSize(i);else if(a!==i)switch(n){case"imageSourceType":i===S.e.Dynamic?this._getDocumentLibrarySelectionsAndSetDefaultSelection():i===S.e.Curated&&this._clearInternalAndBaseWebpartErrors();break;case"listId":this._selectDocumentLibrary(i);break;case"isRecursive":case"maxImagesCount":this._delayedGetImagesFromDocLib(!0);break;case"layout":this._updateImageTileWidth(this.properties)}e.prototype.onPropertyPaneFieldChanged.call(this,n,a,i)},t.prototype.onDispose=function(){o.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(p.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),e.prototype.onDispose.call(this)},t.prototype._instantlyGetImagesFromDocLib=function(e){var t=this,n=Object(d.setEditModeCustomerPromiseHandlerInfo)("ImageGallery Webpart GetDocLibImages Failure",this.context.serviceScope),a=new _._QosMonitorShareFailureWithCP("ImageGalleryWebPart.GetDocLibImages",!1,[n]);return this._dataAggregator.then(function(e){return t.properties.listId?e.getImagesFromDocumentLibrary(t.properties.listId,{maxItemsCount:t.properties.maxImagesCount,isRecursive:t.properties.isRecursive}):(a.writeUnexpectedFailure("NoListId"),Promise.reject(void 0))}).then(function(n){t._imagesFromSelectedDocLib=n,t._clearInternalAndBaseWebpartErrors(),e&&t.render(),a.writeSuccess()}).catch(function(e){t._imagesFromSelectedDocLib=[],403===e.status?(t._handleNoPermissionAndRender(),a.writeExpectedFailure("NoPermissionToAccessDocLib")):401===e.status?(t._handleNoPermissionAndRender(),a.writeExpectedFailure("UnAuthorizedUser")):404===e.status?(t._errorMessage=te.t,a.writeExpectedFailure("DocLibRemoved"),t.render()):e.text().then(function(e){return Promise.reject(new Error(e))}).catch(function(e){t.renderError(e),a.writeUnexpectedFailure("UnexpectedError",e)})})},t.prototype._getImageOverride=function(){return this.properties.imageSourceType===S.e.Dynamic?this._imagesFromSelectedDocLib||[]:this.properties.images},Object.defineProperty(t.prototype,"_images",{get:function(){return this.properties.imageSourceType===S.e.Dynamic?this._imagesFromSelectedDocLib:this.properties.images},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_hasImages",{get:function(){return this._images&&this._images.length>0},enumerable:!1,configurable:!0}),t.prototype._isScribeHosted=function(){return!Object(w.c)()&&l._ScribeUtilities.isScribeHosted(Number(this.context.pageContext.legacyPageContext.webTemplate))},Object.defineProperty(t.prototype,"_documentLibrarySelections",{get:function(){var e=this;return new Promise(function(t,n){if(!e._documentLibraries)return e._dataAggregator.then(function(a){return e._getDocumentLibraries(a,t).catch(function(e){n(e)})});t(void 0)}).catch(function(t){_._TraceLogger.logError(_._LogSource.create("ImageGalleryWebPart"),t,"GetDocumentLibraries"),e._errorMessageFetchingDocLibs=te.n,e.context.propertyPane.refresh()})},enumerable:!1,configurable:!0}),t.prototype._getDocumentLibraries=function(e,t){var n=this;return e.getDocumentLibraries().then(function(e){n._documentLibraries=e,n._documentLibrariesEnabledPrivateCDN=e,n._hasDocumentLibrariesRetrieved=!0,n.context.propertyPane.refresh(),t()})},Object.defineProperty(t.prototype,"_isImageSourceDynamic",{get:function(){return this.properties.imageSourceType===S.e.Dynamic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_dataAggregator",{get:function(){var e=this;return this._imageGalleryDataAggregator||(this._imageGalleryDataAggregator=y.import().then(function(t){var n=new t.ImageGalleryDataProvider(e.context.serviceScope),a=new I({validExtensions:c.spConstants.imageExtensions,maxSizeBytes:2e8});return new t.ImageGalleryDataAggregator(n,e.properties,a,e.context.pageContext)})),this._imageGalleryDataAggregator},enumerable:!1,configurable:!0}),t.prototype._updateImageTileWidth=function(e){if(e)for(var t=0;e.images&&t<e.images.length;t++)e.images[t].imageTileWidth=ie.getImageTileWidth(e.layout),e.layout===S.t.Carousel&&t>0&&(e.images[t].minCanvasWidth=32767)},t.prototype._getEmphasisTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(p.ThemeProvider.serviceKey);e._theme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},Object.defineProperty(t.prototype,"_cdnBaseUrls",{get:function(){var e=this.context.pageContext.legacyPageContext.publicCdnBaseUrl;return e?[e]:[]},enumerable:!1,configurable:!0}),t}(f.BaseDataWebPart);t.default=de},Qeeh:function(e){e.exports=JSON.parse('{"e":"File type not supported","t":"The image is too large"}')},RxoY:function(e,t,n){"use strict";var a=n("vqeV");n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n("W6VI")},U4ag:function(e,t){e.exports=d},UWqr:function(e,t){e.exports=l},W6VI:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("vqeV");function i(e,t){return e/function(e){switch(e){case a.e.Wide:return 16/9;case a.e.Standard:return 4/3;default:return 1}}(t)}},XCtM:function(e,t){e.exports=u},acy6:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=30},cDcd:function(e,t){e.exports=f},faye:function(e,t){e.exports=p},fglE:function(e,t){e.exports=m},h92K:function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e[e.Curated=1]="Curated",e[e.Dynamic=2]="Dynamic"}(a||(a={})),function(e){e[e.Carousel=1]="Carousel",e[e.Grid=2]="Grid",e[e.Masonry=3]="Masonry",e[e.Brick=4]="Brick"}(i||(i={}))},hUCW:function(e){e.exports=JSON.parse('{"a":"Move item. When selected, use ctrl + left arrow or ctrl + right arrow to reorder items.","n":"Press enter to open a panel showing detailed information about this image.","t":"Edit details","e":"Remove"}')},"hiL/":function(e,t){e.exports=_},jOlS:function(e,t){e.exports=h},lxgo:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("I6O9"),i=function(){function e(){}return e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=a.SPComponentLoader.loadComponentById(e.carouselComponentId)),e._loadedModulePromise},e.loadCarousel=function(){return e.loadModule().then(function(e){return e.CarouselLayoutLoader.loadCarousel()})},e.carouselComponentId="8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027",e}()},mMzb:function(e,t){e.exports=b},"qtZ+":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("tGpx"),s=function(){function e(){}return e.loadImage=function(e){return new Promise(function(t,n){var a=document.createElement("img");a.onload=function(e){t(a)},a.onerror=function(e){n(e)},a.setAttribute("src",e)})},e.readImageRatio=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.loadImage(t)];case 1:return[2,(n=a.sent()).naturalWidth/n.naturalHeight]}})})},e.loadThumbnailImage=function(e){return new Promise(function(t,n){var s=document.createElement("div");e.disableBlobRevoke=!0,r.render(i.createElement(o.SPImg,Object(a.__assign)(Object(a.__assign)({},e),{onImageLoad:function(e){t(null==e?void 0:e.target),r.unmountComponentAtNode(s)},onImageLoadFailure:function(e,t){"stockImage"===e&&(n(e),r.unmountComponentAtNode(s))},renderedInDetachedDOM:!0})),s)})},e.readThumbnailImageRatio=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.loadThumbnailImage(t)];case 1:return[2,(n=a.sent()).naturalWidth/n.naturalHeight]}})})},e}()},r9Fm:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return a}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o});var a,i={Square:"Square",Wide:"Wide",Tall:"Tall",All:"All"};!function(e){e[e.Documents=1]="Documents",e[e.Images=2]="Images",e[e.Pages=3]="Pages",e[e.Videos=4]="Videos",e[e.Audios=5]="Audios",e[e.Models=6]="Models",e[e.BasicDocuments=7]="BasicDocuments",e[e.Transcripts=8]="Transcripts",e[e.VideosWithWebm=9]="VideosWithWebm"}(a||(a={}));var r={Files:1,FoldersOnly:2,FoldersAndFiles:3},o={Recent:1,OneDrive:2,DocLib:3,Local:4,Link:5,BingImageSearch:6,OrgAssets:7,StockAssets:8,Office3DCatalog:9,MultipleSites:10,Search:11}},tGpx:function(e,t){e.exports=g},ut3N:function(e,t){e.exports=v},vNcA:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},vqeV:function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.Small=1]="Small",e[e.Medium=2]="Medium",e[e.Large=3]="Large"}(a||(a={})),function(e){e[e.Square=1]="Square",e[e.Wide=2]="Wide",e[e.Standard=3]="Standard"}(i||(i={}))},wfAw:function(e){e.exports=JSON.parse('{"a":"Uploading...","n":"{0}/{1}","e":"Added","t":"Remove"}')},y88i:function(e,t){e.exports=y}})});