(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[38],{"3Ilx":function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n("17wl"),i=n("6o44"),r=n("OpjN"),o=n("4AK9"),s=n("fTUh"),c=n("K9kD"),d=function(){function e(e,t,n,a,i){this._groupsProvider=e,this._parentGroup=t,this._loadPageFromServerDelegate=n,this._pageSize=a&&"number"==typeof a.pageSize?a.pageSize:20,this._shouldAddOwnershipInformation=!a||(a.ownershipInformation,!1)||a.ownershipInformation,this._userLoginName=i,this._foundOwnersDictionary={},this._numberOfOwnersFound=0}return e.prototype.loadPage=function(e){var t=this,n=e||0;return this._groupsProvider&&this._parentGroup.id?this._loadPageFromServerDelegate(this._parentGroup.id,n,this._pageSize).then(function(e){return t._processPage(e,n)},function(e){return t.error=e,c.Promise.reject(e)}):c.Promise.reject(void 0)},e.prototype._processPage=function(e,t){var n=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var a=t+this._pageSize>=this.totalNumberOfMembers,i=a?void 0:this._computeGetNextPagePromise(t+this._pageSize);return this._shouldAddOwnershipInformation?this._ownersDictionary?(this._addOwnershipInformationToPage(e,a),c.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})):this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(t){return n._addOwnershipInformationToPage(e,a,t),c.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})}):c.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})},e.prototype._addOwnershipInformationToPage=function(e,t,n){var a=this;if(n&&(this.totalNumberOfOwners=n.totalNumberOfOwners,this._ownersDictionary={},n.ownersList.members.forEach(function(e){e.userId&&(a._ownersDictionary[e.userId]=e)}),this.isOwner=n.ownersList.containsUserByPrincipalName(this._userLoginName)),e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=a._ownersDictionary&&!!a._ownersDictionary[e.userId],e.isOwnerOfCurrentGroup&&(a._numberOfOwnersFound++,a._foundOwnersDictionary[e.userId]=!0)}),t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var i in this._ownersDictionary){var r=this._ownersDictionary[i];this._foundOwnersDictionary[r.userId]||(r.isOwnerOfCurrentGroup=!0,e.membersList.members.push(r),this.totalNumberOfMembers++)}},e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}},e}(),l=n("3HEj"),u=n("mxVm"),f=n("8wzk"),p="Yammer.FeedURL",m="MicrosoftTeams.TeamHomeURL",_="Missing group id.",h="CurrentUser",b=function(){function e(e){this._missingLoginNameError="Missing user login name information.",this._partnerUser="PartnerUser",this._pageContext=e.pageContext,this._dataRequestor=new c.DataRequestor({qosName:"GroupsProvider"},{pageContext:e.pageContext}),this._dataSource=e.dataSource||new o.e(e.pageContext);var t=function(e){return e.name?Object(a.__assign)(Object(a.__assign)({},e),{name:"GroupsProvider.PersistentCache.".concat(e.name)}):e};this._persistentCache=new u.e({secret:void 0,cacheType:f.e.indexedDB,telemetry:{engagement:c.Engagement.withData(t),qos:c.Qos.withData(t)}}),this._userLoginName=e.pageContext&&e.pageContext.userLoginName,this._groups=[],this._eventGroup=new c.EventGroup(this),this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.getSPPageContext=function(){return this._pageContext},e.prototype.getMembershipPager=function(e){var t=this;return new d(this,this.group,function(e,n,a){return e?t._userLoginName?t._dataSource.getGroupMembershipPage(e,t._userLoginName,n,a):c.Promise.reject(t._missingLoginNameError):c.Promise.reject(_)},e,this._userLoginName)},e.prototype.loadGroupInfoFromCache=function(e){return e?c.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data})):c.Promise.resolve(void 0)},e.prototype.saveGroupToCache=function(e){if(e)return c.Promise.resolve(this._persistentCache.update({key:e.id},e))},e.prototype.saveMembershipToCache=function(e,t){var n=this;return this.loadGroupInfoFromCache(e).then(function(e){if(e)return e.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer},n.saveGroupToCache(e)})},e.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){return t._performBasicPropertiesPostProcessing(e),Object(l.c)(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties(),e}):c.Promise.reject(_)},e.prototype.loadMembershipContainerFromServer=function(e,t,n,a){return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=this._userLoginName),e?a?this._dataSource.getGroupMembership(e,a,t,n):c.Promise.reject(this._missingLoginNameError):c.Promise.reject(_)},e.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):c.Promise.reject(_)},e.prototype.loadUserGroups=function(e){var t=this;return this.loadUserGroupsFromCache(e).then(function(n){return n&&0!==n.length?c.Promise.resolve(n):t.getCurrentUser().then(function(n){return e?t._dataSource.getUserGroupsFromAAD(n).then(function(e){return t._persistentCache.update({key:"UserGroupsFromAAD"+n.userId},e),e}):t._dataSource.getUserGroups(n).then(function(e){return t._persistentCache.update({key:"UserGroups"+n.userId},e),t._setUsersGroups(e,r.e.Server),e})})})},e.prototype.loadUserGroupsFromCache=function(e){var t=this;return this.getCurrentUser().then(function(n){return(e?c.Promise.resolve(t._persistentCache.read({key:"UserGroupsFromAAD"+n.userId}).then(function(e){return e.data})):c.Promise.resolve(t._persistentCache.read({key:"UserGroups"+n.userId}).then(function(e){return e.data}))).then(function(n){return n&&!e&&t._setUsersGroups(n,r.e.Cache),n})})},e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(t){for(var n=0,a=t.length;n<a;n++)if(t[n].id===e)return!0;return!1})},e.prototype.getGroup=function(e,t){var n=this;if(void 0===t&&(t=!1),e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");return t||e&&0!==e.length&&(!this.group||e!==this.group.id)?(e&&0!==e.length||(e=this.group.id),this.loadGroupInfoContainerFromServer(e)):new c.Promise(function(e,t){var a=n.group;n.group?a.source===r.e.None?n._eventGroup.on(a,i.t.onSourceChange,function(i){i!==r.e.Error?i===r.e.None||e(a):t(n.group.error)}):e(a):t("There is no group currently being managed by GroupsProvider.")})},e.prototype.getCurrentUser=function(){var e=this;return this._userLoginName?this.currentUser?c.Promise.resolve(this.currentUser):this._getUserFromCache(h).then(function(t){return e.currentUser=t,t||e._dataSource.getUserInfo(e._userLoginName).then(function(t){return e._saveUserToCache(t,h),e.currentUser=t,t})}):c.Promise.reject(this._missingLoginNameError)},e.prototype.addUserToGroupMembership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupMember(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.Promise.reject(_)},e.prototype.addUserToGroupOwnership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupOwner(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.Promise.reject(_)},e.prototype.removeUserFromGroupMembership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupMember(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.Promise.reject(_)},e.prototype.removeUserFromGroupOwnership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupOwner(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.Promise.reject(_)},e.prototype.addUsersToGroup=function(e,t,n,a,i){var r,o=this;return e?this._isPartnerUser()?this._dataSource.addUsersToGroup(e,t,n,a,i):this.currentUser?(r=this.currentUser.userId,this._dataSource.addUsersToGroup(e,t,n,a,i).then(function(e){return o._clearUserGroupsCache(r),e})):this.getCurrentUser().then(function(e){r=e.userId}).then(function(){return o._dataSource.addUsersToGroup(e,t,n,a,i)}).then(function(e){return o._clearUserGroupsCache(r),e}):c.Promise.reject(_)},e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)},e.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var n=this.getCachedGroup(e);n.load(),this.group=n}},e.prototype.getCachedGroup=function(e,t){var n=this._groups[e];return n||(n=new i.t(t,this,e,this._pageContext),this._groups[e]=n),n},e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})},e.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})},e.prototype.doesCachedGroupPropertiesDiffer=function(e){var t,n,a=this._pageContext;return a.groupId===e.id&&(a.webTitle!==e.name||(a.siteClassification||e.classification)&&a.siteClassification!==e.classification||(a.sensitivityLabel||e.assignedLabels)&&(null===(t=a.sensitivityLabel)||void 0===t?void 0:t.toLocaleLowerCase())!==(null===(n=e.assignedLabels)||void 0===n?void 0:n.toLocaleLowerCase())||null===a.groupType||void 0===a.groupType||a.groupType===s.t.public!==e.isPublic||!a.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)},e.prototype.teamify=function(){return this._dataSource.teamify()},e.prototype.teamifyV2=function(e,t){return this._dataSource.teamifyV2(e,t)},e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();return c.Promise.resolve(this._persistentCache.update({key:e},{}))},e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()},e.prototype.getTeamifyBannerHidden=function(e){var t=this;return c.Promise.resolve(this._persistentCache.read({key:this._makeHideTeamifyKey()}).then(function(n){return!!n.data||t._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})}))},e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)},e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)},e.prototype._makeHideTeamifyKey=function(e){var t=e||this._pageContext.siteId;return"".concat("HideTeamify",":").concat(t)},e.prototype._setUsersGroups=function(t,n){var a=this;this.userGroups=t.map(function(e){var t=a.getCachedGroup(e.id,e);return n!==r.e.Server&&t.source===r.e.Server||t.extend(e),t.pictureUrl||t.load(),t}),this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)},e.prototype._performBasicPropertiesPostProcessing=function(e){this._pageContext&&(e.hasPictureUrl=!!e.pictureUrl,e.pictureUrl="".concat(this._pageContext.webAbsoluteUrl).concat("/_api/GroupService/GetGroupImage"),e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations",p),e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null),e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null),e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,m))},e.prototype._getWorkloadUrl=function(e,t,n,a){var i=null,r=e.yammerResources,o=e.teamsResources,s=function(e){var t=e.filter(function(e){return e.Key===a});return t&&t[0]?t[0].Value:null};return a===m?o&&o.results&&o.results.length>0&&(i=s(o.results)):r&&r.results&&r.results.length>0?a===p&&(i=s(r.results)):i=e[t]?e[t]:"".concat(this._pageContext.webAbsoluteUrl,"/_layouts/15/groupstatus.aspx?id=").concat(e.id,"&target=").concat(n),i},e.prototype._saveUserToCache=function(e,t){if(e)return this._persistentCache.update({key:t},e)},e.prototype._getUserFromCache=function(e){return c.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data}).catch(function(){}))},e.prototype._clearUserGroupsCache=function(e){if(e)return c.Promise.all([this._persistentCache.remove({key:"UserGroupsFromAAD"+e}),this._persistentCache.remove({key:"UserGroups"+e})]).then(function(e){})},e.prototype._getUserIdForCacheClear=function(e,t){var n;return this.currentUser&&e?(n=e===this.currentUser.userId?e:null,c.Promise.resolve(n)):this.getCurrentUser().then(function(a){return n=e?e===a.userId?a.userId:null:t===a.principalName?a.userId:null})},e.prototype._isPartnerUser=function(){var e,t;try{var n=window.parent;return!!n&&(null===(t=null===(e=n.window)||void 0===e?void 0:e.adminPageContext)||void 0===t?void 0:t.userType)===this._partnerUser}catch(e){return!1}},e.onUserGroupsChange="userGroups",e}()},"403U":function(e,t,n){"use strict";n.r(t),n.d(t,"TeamifyBanner",function(){return D}),n.d(t,"default",function(){return D});var a=n("17wl"),i=n("cDcd"),r=n("vNcA"),o=n("skSa"),s=n("tS6Z"),c=n("EH0/"),d=n("fxVk"),l=n("jOlS");Object(l.loadStyles)([{rawString:".teamifyBanner_0b9df28c{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";position:relative}.titleWrapper_0b9df28c{display:flex;align-items:center;padding-bottom:4px}.teamsIcon_0b9df28c{color:#5558af;font-size:17px}.teamsName_0b9df28c{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-weight:600;font-size:"},{theme:"mediumFontSize",defaultValue:"14px"},{rawString:";padding:0 8px 0 4px}[dir=rtl] .teamsName_0b9df28c{padding:0 4px 0 8px}.infoIcon_0b9df28c{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";padding-top:6px}.toolTipContainer_0b9df28c{padding:0 4px}.tooltip_0b9df28c{font-size:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:"}.createTeamText_0b9df28c{font-weight:600}.description_0b9df28c{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:'}.teamifySpinner_0b9df28c.teamifySpinner_0b9df28c{display:"inline-block"}.hideTeamifyButton_0b9df28c{position:absolute;top:0;right:0}.hideTeamifyIcon_0b9df28c{font-size:'},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";height:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:";line-height:"},{theme:"smallFontSize",defaultValue:"12px"},{rawString:"}.hideTeamifyDialogButtonContainer_0b9df28c{display:flex;width:100%;justify-content:flex-end}.hideTeamifyDialogButton_0b9df28c{padding:0 4px}.createTeamLink_0b9df28c{padding-top:8px}.dismissPermanentlyLink_0b9df28c{padding-top:20px}"}]);const u="tooltip_0b9df28c",f="hideTeamifyDialogButtonContainer_0b9df28c",p="hideTeamifyDialogButton_0b9df28c";var m,_=n("ITuu"),h=n("c4/U"),b=n("K9kD"),g=n("3Ilx"),v=n("ynV5");!function(e){e.TipsNTricks="TipsNTricks",e.TeamifyBanner="TeamifyBanner"}(m||(m={}));var y=n("cNe7"),S=i.lazy(function(){return Promise.all([n.e(1),n.e(3),n.e(11),n.e(42),n.e(40)]).then(n.bind(null,"fVj+"))}),D=function(e){function t(t){var n=e.call(this,t)||this;return n._experimentKillswitch=!1,n._renderTooltipContent=function(){return n._experimentKillswitch?i.createElement("div",{className:u},_.d,i.createElement("br",null),i.createElement("br",null),Object(h.e)(_.l,_.e,"span",{className:"createTeamText_0b9df28c"})):i.createElement("div",{className:u},_.f)},n._onHideTeamifyBanner=function(){new g.e({pageContext:n.props.pageContext}).hideTeamifyBanner(),b.Engagement.logData({name:"TeamifyBanner.Hide",isIntentional:!0}),n.setState({hasDismissed:!0}),n._onCloseHideTeamifyDialog()},n._onDismissTeamifyBanner=function(){var e=new g.e({pageContext:n.props.pageContext});b.Engagement.logData({name:"TeamifyBanner.DismissPermanently",isIntentional:!0}),e.dismissTeamifyBanner().then(function(){n._onCloseHideTeamifyDialog(),n.setState({hasDismissed:!0})})},n._onClick=function(){n._onClickV2Experience(),b.Engagement.logData({name:"TeamifyBanner.Click",isIntentional:!0})},n._onClickV2Experience=function(){n._teamifyQos=new y.Qos({name:"TeamifyWizardLoader.Load"}),n._toggleTeamify()},n._onCloseHideTeamifyDialog=function(){n.setState({hideTeamifyDialogOpen:!1})},n._onOpenHideTeamifyDialog=function(){b.Engagement.logData({name:"TeamifyBanner.OpenHideDialog",isIntentional:!0}),n.setState({hideTeamifyDialogOpen:!0})},n._toggleTeamify=function(){n.setState(function(e){return{showTeamifyWizard:!e.showTeamifyWizard}})},n.state={},n._experimentKillswitch=b.Killswitch.isActivated("DB52012D-C103-4653-928C-16AC57D214B9","11/05/2020","Enable v2 Experiment"),n}return Object(a.__extends)(t,e),t.prototype.render=function(){return this._renderV2Experience()},t.prototype.componentDidMount=function(){b.Engagement.logData({name:"TeamifyBanner.Render",isIntentional:!1})},t.prototype._renderV2Experience=function(){var e=i.createElement(o.TooltipHost,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(d.Icon,{iconName:"Info",className:"infoIcon_0b9df28c",tabIndex:0,ariaLabel:_.f}));return i.createElement("div",null,i.createElement("div",{className:Object(r.css)(this.props.className,"teamifyBanner_0b9df28c")},this._renderHideTeamifyButton(),i.createElement("div",{className:"titleWrapper_0b9df28c"},i.createElement(d.Icon,{className:"teamsIcon_0b9df28c",iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_0b9df28c"},_.u)),i.createElement("div",{className:"description_0b9df28c"},_.c,i.createElement("span",{className:"toolTipContainer_0b9df28c"},e),i.createElement("br",null),i.createElement(o.Link,{onClick:this._onClick,className:"createTeamLink_0b9df28c"},_.s))),this.state.showTeamifyWizard&&i.createElement(i.Suspense,{fallback:null},i.createElement(S,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:m.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos})))},t.prototype._renderHideTeamifyButton=function(){return this.state.hasDismissed?null:[i.createElement(o.IconButton,{className:"hideTeamifyButton_0b9df28c",ariaLabel:_.t,iconProps:{iconName:"ChromeClose",className:"hideTeamifyIcon_0b9df28c"},onClick:this._onOpenHideTeamifyDialog}),this._renderHideTeamifyDialog()]},t.prototype._renderHideTeamifyDialog=function(){return i.createElement(s.e,{hidden:!this.state.hideTeamifyDialogOpen,type:c.e.close,dialogContentProps:{type:c.e.close,title:_.r,subText:v.format(_.n,_.i),showCloseButton:!0,onDismiss:this._onCloseHideTeamifyDialog},modalProps:{onDismiss:this._onCloseHideTeamifyDialog},isBlocking:!1},i.createElement("div",{className:f},i.createElement("div",{className:p},i.createElement(o.PrimaryButton,{onClick:this._onHideTeamifyBanner}," ",_.o," ")),i.createElement("div",{className:p},i.createElement(o.DefaultButton,{onClick:this._onCloseHideTeamifyDialog}," ",_.a," "))),i.createElement("div",{className:f},i.createElement(o.Link,{className:"dismissPermanentlyLink_0b9df28c",onClick:this._onDismissTeamifyBanner},_.i)))},t}(r.BaseComponent)},"4AK9":function(e,t,n){"use strict";var a=n("17wl"),i=n("tOru"),r=n("1tKF"),o=n("K9kD"),s=n("ynV5"),c=n("y88i"),d=n("C21W"),l=n("QVYh"),u=n("w0LS"),f="Group('{0}')",p="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",m="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",_="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",h="Group('{0}')/Members/Remove('{1}')",b="Group('{0}')/Owners/Remove('{1}')",g="/_layouts/15/groupstatus.aspx?id={0}&target={1}",v="isTeamifyPromptHidden",y=function(e){function t(t){var n=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource"},{pageContext:t})||this;return n._isTeamifyPromptHiddenCacheKey=t?v+"_".concat(t.siteId+t.groupId):v,n}return Object(a.__extends)(t,e),t._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}},t._parseUser=function(e){var n=JSON.parse(e);return t._copyMember(n.d)},t._copyMembers=function(e){var n=new i.t;return n.members=e.map(function(e){return t._copyMember(e)}),n},t._parseGroup=function(e){var n=JSON.parse(e);return t._copyGroup(n.d)},t._parseMembership=function(e){var n=JSON.parse(e);return t._copyMembership(n.d)},t._copyGroup=function(e){return{description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,assignedLabels:e.assignedLabels,membership:t._copyMembership(e)}},t._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?t._copyMembers(e.results):void 0}},t._parseOwnership=function(e){var n=JSON.parse(e);return t._copyOwnership(n.d)},t._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?t._copyMembers(e.results):void 0}},t.prototype.getGroupBasicProperties=function(e){var n=this;return this.getData(function(){return n._getUrl(s.format("Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels",e),"SP.Directory.DirectorySession")},function(a){var i=t._parseGroup(a);return i.id||(i.id=e),n._calculateMissingGroupProperties(i,e),i},"GetBasicProperties",void 0,"GET",void 0,void 0,3)},t.prototype.setGroupBasicProperties=function(e){var t=this;return e?this.getData(function(){return t._getUrl(s.format(f,e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var t={__metadata:{type:"SP.Directory.Group"}};return e.name&&(t.displayName=e.name),e.description&&(t.description=e.description),e.assignedLabels?(null!=e.isPublic&&(t.isPublic=e.isPublic),e.assignedLabels===o.Guid.Empty?t.assignedLabels="":t.assignedLabels=e.assignedLabels):(null!=e.isPublic&&(t.isPublic=e.isPublic),e.classification&&(t.classification=e.classification)),JSON.stringify(t)},"PATCH",void 0,void 0,3):o.Promise.reject("Group parameter is null or undefined")},t.prototype.getGroupByAlias=function(e){var n=this;return this.getData(function(){return n._getUrl(s.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return t._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)},t.prototype.getGroupMembership=function(e,n,a,i){var r=this;void 0===a&&(a=!1),void 0===i&&(i=!1);var c=a?"100":"3";return this.getData(function(){return r._getUrl(s.format(p,e,"members","0",c),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(t){return i?r._addOwnerInformation(e,n,t):o.Promise.resolve(t)})},t.prototype.getGroupMembershipPage=function(e,n,a,i){var r=this;return this.getData(function(){return r._getUrl(s.format(p,e,"members",a,i),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembershipPage",void 0,"GET",void 0,void 0,3)},t.prototype.getGroupOwnership=function(e,n){var a=this,i=n||"100";return this.getData(function(){return a._getUrl(s.format(p,e,"owners","0",i),"SP.Directory.DirectorySession")},function(e){var n=t._parseOwnership(e);return a._calculateMissingOwnershipProperties(n),n},"GetOwnership",void 0,"GET",void 0,void 0,3)},t.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return s.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")},t.prototype.getUserGroups=function(e){var t=this,n=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(s.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:n()},n)},t.prototype.addGroupMember=function(e,t,n,a){var i=this;return t=t||o.Guid.Empty,n=n||"",this.getData(function(){return i._getUrl(s.format(m,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddMember",void 0,"POST",void 0,void 0,3)},t.prototype.addGroupOwner=function(e,t,n,a){var i=this;return t=t||o.Guid.Empty,n=n||"",this.getData(function(){return i._getUrl(s.format(_,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddOwner",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupMember=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(s.format(h,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveMember",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupOwner=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(s.format(b,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveOwner",void 0,"POST",void 0,void 0,3)},t.prototype.addUsersToGroup=function(e,t,n,i,r){var c=this,l=o.Guid.generate(),u="multipart/mixed; boundary=batch_"+l,f=[],p=[],h=0,b=0,g=function(t,n,a){for(var i=n?_:m,r=0;r<t.length;r++){var d=void 0,l=void 0;if(a?l=t[r]:d=t[r],d||l){d=d||o.Guid.Empty,l=l||"";var u=c._getUrl(s.format(i,e,d,l),"SP.Directory.DirectorySession");n?p.push(u):f.push(u)}}};if(t?(g(t,!0,!1),h=t.length):i&&(g(i,!0,!0),h=i.length),n?(g(n,!1,!1),b=n.length):r&&(g(r,!1,!0),b=r.length),!(p.length<1&&f.length<1)){var v=this.getData(function(){return d.e.getBatchOperationUrl(c._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return d.e.getBatchContent(l,[p,f],"POST",d.e.defaultBatchRequestPostData)},"POST",void 0,u,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersNumber:h,MembersNumber:b},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new o.Promise(function(e,t){v.then(function(n){var a=d.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.addRemoveGroupUsers=function(e,t,n,i,r){var c=this,l=o.Guid.generate(),u="multipart/mixed; boundary=batch_"+l,f=[],p=[],g=[],v=[],y=function(t,n,a){var i="SP.Directory.DirectorySession";if(void 0!==t)for(var r=0;r<t.length;r++)if(n)if(a){var o=c._getUrl(s.format(_,e,t[r],""),i);f.push(o)}else o=c._getUrl(s.format(b,e,t[r]),i),g.push(o);else a?(o=c._getUrl(s.format(m,e,t[r],""),i),p.push(o)):(o=c._getUrl(s.format(h,e,t[r]),i),v.push(o))};if(y(t,!0,!0),y(i,!0,!1),y(n,!1,!0),y(r,!1,!1),0!==f.length||0!==p.length||0!==g.length||0!==v.length){var S=this.getData(function(){return d.e.getBatchOperationUrl(c._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return d.e.getBatchContent(l,[f,p,g,v],"POST",d.e.defaultBatchRequestPostData)},"POST",void 0,u,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersToAdd:f.length,MembersToAdd:p.length,OwnersToRemove:g.length,MembersToRemove:v.length},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new o.Promise(function(e,t){S.then(function(n){var a=d.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.getUserInfo=function(e){var n=this;return this.getData(function(){return n._getUrl(s.format("User(principalName='{0}')",c.UriEncoding.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(n){var a=t._parseUser(n);return a.email=e,a},"GetGraphUser",void 0,"GET",void 0,void 0,3)},t.prototype.deleteGroup=function(e){var t=this;return e?this.getData(function(){return t._getUrl(s.format(f,e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3):o.Promise.reject("Group parameter is null or undefined")},t.prototype.deleteSite=function(e){var t=this;return this.getData(function(){return t._pageContext.siteAbsoluteUrl+s.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)},t.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)},t.prototype.teamifyV2=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(a){return t(a),a&&a.teamsId?n._pinToTeam(a,e):void 0})},t.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+s.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){e.flushCache(e._isTeamifyPromptHiddenCacheKey),e.getTeamifyBannerHidden(!0)})},t.prototype.getTeamifyBannerHidden=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return t._pageContext.siteAbsoluteUrl+s.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",t._pageContext.siteAbsoluteUrl)},qosName:"TeamifyBannerHidden",parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsTeamifyPromptHidden},additionalPostData:"",method:"Get",cachingStrategy:e?u.e.bypassCache:u.e.useCacheAndUpdateInTheBackground,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})},t.prototype._getUrl=function(e,t){return"".concat(this._pageContext.webAbsoluteUrl,"/_api/").concat(t,"/").concat(e)},t.prototype._getCsomUrl=function(e){return"".concat(this._pageContext.webAbsoluteUrl,"/_vti_bin/client.svc/").concat(e)},t.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+s.format(g,e,"notebook")},t.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+s.format(g,e,"documents")},t.prototype._addOwnerInformation=function(e,t,n){return this.getGroupOwnership(e,"100").then(function(e){var a=e.ownersList.members,i=n.membersList.members,r=[],s={};a.forEach(function(e){s[e.userId]=!0,e.principalName.toLowerCase()===t.toLowerCase()&&(n.isOwner=!0)});var c=0,d={};return i.forEach(function(e){s[e.userId]?(e.isOwnerOfCurrentGroup=!0,r.push(e),c++,d[e.userId]=!0):r.push(e),e.principalName===t&&(n.isMember=!0)}),c<a.length&&a.forEach(function(e){d[e.userId]||(e.isOwnerOfCurrentGroup=!0,r.push(e))}),n.membersList.members=r,n.totalNumberOfMembers<r.length&&(n.totalNumberOfMembers=r.length),n.totalNumberOfOwners=e.totalNumberOfOwners,o.Promise.resolve(n)})},t.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(l.getUserPhotoUrl)(e.email)),!e.profilePage&&e.email&&(e.profilePage=s.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))},t.prototype._calculateMissingMembershipProperties=function(e,t){var n=this;e.membersList.members.forEach(function(e){n._fixUserImages(e)})},t.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})},t.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now()),e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto")),!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t)),!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))},t.prototype._parseResponseForGetUserGroups=function(e){var t=this,n=JSON.parse(e);if(n.constructor===Array)return n[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var a=n.d.results.map(function(e){var n={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};return t._calculateMissingGroupProperties(n,n.id),n}),i=a.filter(function(e){return e.isFavorite});return i.push.apply(i,a.filter(function(e){return!e.isFavorite})),i},t.prototype._pinToTeam=function(e,t){var n=this;return t=t.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url,itemType:e.itemType}}),this.getData(function(){return n._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(t){if(t){var n=JSON.parse(t);if(n&&n.d)return{pinToTeam:n.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(n._pageContext&&n._pageContext.navigationInfo&&n._pageContext.navigationInfo.quickLaunch){var a={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:t}}};return JSON.stringify(a)}},"POST",void 0,void 0,0)},t}(r.t);t.e=y},"6o44":function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"e",function(){return c});var a=n("7KUI"),i=n("K9kD"),r=n("ynV5"),o=n("OpjN");function s(){var e,t=new i.PlatformDetection,n=!1;if(window.indexedDB&&t.isFirefox)try{var a=window.indexedDB.open("FF_INPRIVATE");a.onerror=function(){return n=!0},"InvalidStateError"===(null===(e=null==a?void 0:a.error)||void 0===e?void 0:e.name)&&(n=!0)}catch(e){n=!0}return n}var c=function(){function e(t,n,r,s){this._eventGroup=new i.EventGroup(this),this.source=o.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=n,this.id=r,t?this.extend(t):this.load(),this.membership=new a.n(void 0,this._groupsProvider,this),!s&&n&&(s=n.getSPPageContext()),this.plannerUrl=e._getPlannerUrl(s,r)}return e._getPlannerUrl=function(e,t){if(e)return t||(t=e.groupId),e.webAbsoluteUrl+r.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.load=function(t){var n=this;if(this._groupsProvider&&this.id){var a=i.Promise.resolve();return this.source!==o.e.None||s()||(a=this._groupsProvider.loadGroupInfoFromCache(this.id).then(function(t){t&&t.lastLoadTimeStampFromServer>0&&(n.extend(t),n.source=o.e.Cache,n._eventGroup.raise(e.onSourceChange,n.source))})),a.then(function(){if(n._shouldLoadNewData(t))return n._startLoadingFromServer(),n._groupsProvider.loadGroupInfoContainerFromServer(n.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now(),n.extend(e),n._finishLoadingFromServer(),n._groupsProvider.saveGroupToCache(e)},function(e){n._errorLoading(e)})})}return i.Promise.resolve()},e.prototype.extend=function(e){this.name=e.name,this.principalName=e.principalName,this.alias=e.alias,this.mail=e.mail,this.description=e.description,this.creationTime=e.creationTime,this.profileUrl=e.profileUrl,this.inboxUrl=e.inboxUrl,this.calendarUrl=e.calendarUrl,this.filesUrl=e.filesUrl,this.notebookUrl=e.notebookUrl,this.pictureUrl=e.pictureUrl,this.hasPictureUrl=e.hasPictureUrl,this.sharePointUrl=e.sharePointUrl,this.editUrl=e.editUrl,this.membersUrl=e.membersUrl,this.teamsUrl=e.teamsUrl,this.isPublic=e.isPublic,this.classification=e.classification,this.assignedLabels=e.assignedLabels,this.allowToAddGuests=e.allowToAddGuests,this.isDynamic=e.isDynamic,this.yammerResources=e.yammerResources,this.teamsResources=e.teamsResources,this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==o.e.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>864e5))},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.source=o.e.Server,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._errorLoading=function(t){this.isLoadingFromServer=!1,this.error=t,this._eventGroup.raise(e.onSourceChange,o.e.Error)},e.onSourceChange="source",e}();t.t=c},"7KUI":function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return c});var a,i=n("tOru"),r=n("6o44"),o=n("OpjN"),s=n("K9kD");!function(e){e[e.none=0]="none",e[e.allMembers=1]="allMembers",e[e.ownershipInformation=2]="ownershipInformation",e[e.forceSkipCache=4]="forceSkipCache"}(a||(a={}));var c=function(){function e(e,t,n){this._eventGroup=new s.EventGroup(this),this.source=o.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=t,this._parent=n,e&&this.extend(e,o.e.None),this.membersList||(this.membersList=new i.t)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0),this._parent=void 0},e.prototype.load=function(e,t){var n=this;if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._groupsProvider&&this._parent.id){var i=0;e&&(i|=a.allMembers),t&&(i|=a.ownershipInformation);var c=s.Promise.resolve();return Object(r.n)()||this.source!==o.e.None||i||(c=this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&n.extend(e.membership,o.e.Cache)})),c.then(function(){if(n._shouldLoadNewData(i))return n._startLoadingFromServer(i),n._groupsProvider.loadMembershipContainerFromServer(n._parent.id,e,t).then(function(e){n.extend(e,o.e.Server),n._finishLoadingFromServer(),i||(e.lastLoadTimeStampFromServer=n.lastLoadTimeStampFromServer,n._groupsProvider.saveMembershipToCache(n._parent.id,e))},function(e){n._errorLoading(e)})})}return s.Promise.resolve()},e.prototype.loadWithOptions=function(e){var t=this;return this._groupsProvider&&this._parent.id&&(this.source!==o.e.None||e||this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&t.extend(e.membership,o.e.Cache)}),this._shouldLoadNewData(e))?(this._startLoadingFromServer(e),this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&a.allMembers)===a.allMembers,e&&(e&a.ownershipInformation)===a.ownershipInformation).then(function(n){t.extend(n,o.e.Server),t._finishLoadingFromServer(),e&&e!==a.forceSkipCache||(n.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,t._groupsProvider.saveMembershipToCache(t._parent.id,n))},function(e){t._errorLoading(e)})):s.Promise.resolve(void 0)},e.prototype.extend=function(t,n){this.isMember=t.isMember,this.isOwner=t.isOwner,this.isJoinPending=t.isJoinPending,this.membersList=t.membersList,this.totalNumberOfMembers=t.totalNumberOfMembers,this.totalNumberOfOwners=t.totalNumberOfOwners,this.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,this._parent.membership=this,this.source=n,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==o.e.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>864e5)||e&&(e&a.forceSkipCache)===a.forceSkipCache||e&&(e&a.allMembers)===a.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.allMembers)===a.allMembers)||e&&(e&a.ownershipInformation)===a.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.ownershipInformation)===a.ownershipInformation)},e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0,this._currentLoadOptions=e},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.lastLoadTimeStampFromServer=Date.now()},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.error=e},e.onSourceChange="source",e}();t.n=c},C21W:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("K9kD"),i=n("m1i4"),r=n("y88i"),o=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new r.SimpleUri(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),i=Number(a[0]),r=e.message.value;n.error={code:i,message:r}}return{items:[n]}},e.getBatchResponseText=function(e){var t,n,a,i=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var r=1;r<n.length;r++)(a=n[r].split("\n\r")).length>2&&i.push(a[2])}return i},e.processBatchResponse=function(e,t,n){var a,i,r,o,s=[],c=!1;if(e&&e.split("\n").length>0&&(a=e.split("\n")[0]),a){i=(e=e.replace(a.trim()+"--","")).split(a);for(var d=1;d<i.length;d++)if((r=i[d].split("\n\r")).length>2){try{o=JSON.parse(r[2])}catch(e){o=r[2]}var l=t&&t[d-1],u=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var f=o.code?o.code.split(","):o.error.code.split(","),p=Number(f[0]),m=o.message.value;u.error={code:p,message:m},c=!0}s.push(u)}}return{items:s,hasError:c}},e.getBatchContent=function(e,t,n,i){for(var r=[],o=0;o<t.length;o++){for(var s=t[o],c=a.Guid.generate(),d=[],l=0;l<s.length;l++){var u=s[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(n+" "+u+" HTTP/1.1"),d.push(i),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");r.push("--batch_"+e),r.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),r.push("Content-Length: "+f.length),r.push("Content-Transfer-Encoding: binary"),r.push(""),r.push(f),r.push("")}return r.push("--batch_"+e+"--"),r.join("\r\n")},e.getBatchContentExtended=function(e,t,n,i,r,o,s){var c=a.Guid.generate(),d=[];r&&r.length!==t.length&&(r=null);for(var l=0;l<t.length;l++){var u=t[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),s?d.push(s[l]+" "+u+" HTTP/1.1"):d.push(n+" "+u+" HTTP/1.1"),d.push(i),o&&d.push(o),r&&(d.push(""),d.push(r[l])),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");return(d=[]).push("--batch_"+e),d.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),d.push("Content-Length: "+f.length),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(f),d.push(""),d.push("--batch_"+e+"--"),d.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.t=o},Ddmm:function(e,t,n){"use strict";n.r(t),n("qkfK");var a=n("gM97");n.d(t,"TokenFetchServerErrorCodes",function(){return a.e}),n.d(t,"default",function(){return a.t})},Gu0Z:function(e,t,n){"use strict";n.r(t);var a,i=n("17wl"),r=function(){function e(){}return e.tokenCacheSessionStorageId="tokenCache",e.aboutToExpireIntervalSeconds=600,e.apiUrl="/_api/SP.OAuth.Token/Acquire",e.retries=3,e.retriableErrorCodes=[10006,10008],e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>",e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format",e.npmPackageVersion="0.1.5",e}();!function(e){e[e.unknownError=0]="unknownError",e[e.malformedResponseBody=1]="malformedResponseBody",e[e.serverError=2]="serverError"}(a||(a={}));var o=function(e){function t(n,a){var i=e.call(this,a.message)||this;return i.__proto__=t.prototype,i._type=n,i._httpResponseStatus=a.httpResponseStatus,i._cultureName=a.cultureName,i._message=a.message,i._serverErrorCode=a.serverErrorCode,i._correlationId=a.correlationId,i._redirectUrl=a.redirectUrl,i}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==a.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!1,configurable:!0}),t}(Error),s=function(){function e(e){var t=this;this._context=e,this._dispose=this._dispose.bind(this),window.addEventListener("unload",this._dispose),window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()},window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}return e._getCorrelationId=function(e){return e.headers.get("sprequestguid")},e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e},e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})},e.prototype.getInstrumentedOAuthToken=function(e,t){var n=this;this._receiveMediaServiceFlushedToken();var a=this._getCachedTokenData(e);if(a&&!this._isExpiring(a)){var i={token:a.accessToken,isGuest:!1,expirationTimeMs:a.expiresOn};return Promise.resolve({tokenInfo:i,spRequestId:a.correlationId,spRequestTimestamp:a.requestTimestamp})}return this._retriableFetchWithDigest(e,r.retries,t).then(function(t){return n._storeTokenData(e,t),{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})},e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)},Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){return this._keysToDispose||(this._keysToDispose=new Array),this._keysToDispose},enumerable:!1,configurable:!0}),e.prototype._retriableFetchWithDigest=function(t,n,i){var r=this,s=this._context.qosMonitor(),c=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(d){if(200!==d.status){r._context.logger.logError("fetchWithDigest failed. Server responded with "+d.statusText);var l=new o(a.unknownError,{httpResponseStatus:d.status,message:d.statusText,correlationId:e._getCorrelationId(d)});return 400!==d.status?(s.writeUnexpectedFailure("UnknownError",l),Promise.reject(l)):d.json().then(function(a){var o=e._extractRealError(a),c=r._getErrorCodeFromResponseCode(o);if(!r._isRetriableError(c)||0===n){var d=r._buildErrorFromResponse(o);return s.writeUnexpectedFailure("SharepointServerError",d),Promise.reject(d)}return r._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n),r._retriableFetchWithDigest(t,n-1,i)})}return r._instrumentedParseResponseData(d,s,c)})},e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))},e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))},e.prototype._getCacheKey=function(e){var t=["sp-client-shared",r.npmPackageVersion,"OAuthUtility",e].join(";");return-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t),t},e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<r.aboutToExpireIntervalSeconds},e.prototype._isRetriableError=function(e){return-1!==r.retriableErrorCodes.indexOf(e)},e.prototype._buildTokenRequest=function(e,t){var n=new Headers;n.append("Content-Type","application/json; charset=utf-8"),n.append("Odata-Version","4.0"),n.append("Accept","application/json;odata.metadata=minimal");var a={method:"POST",headers:n,body:JSON.stringify(this._buildRequestBody(e))},i=t;return i&&i.lastIndexOf("/")===i.length-1&&(i=i.substr(0,i.length-1)),new Request(i+r.apiUrl,a)},e.prototype._buildRequestBody=function(e){return{resource:e}},e.prototype._buildErrorFromResponse=function(e){var t,n,i=this._getErrorCodeFromResponseCode(e);if(void 0===i)return new o(a.malformedResponseBody,{httpResponseStatus:400,message:r.unexpectedErrorCodeFormat,correlationId:e.correlationId});e.message&&("string"==typeof e.message?t=e.message:(t=e.message.value,n=e.message.lang));var s="error.redirectUrl";return new o(a.serverError,{httpResponseStatus:400,message:t,cultureName:n,serverErrorCode:i,correlationId:e.correlationId,redirectUrl:e[s]||e["@".concat(s)]})},e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var a=t.indexOf(",");-1!==a&&(n=Number(t.substr(0,a)))}return n},e.prototype._instrumentedParseResponseData=function(t,n,i){try{return t.json().then(function(a){return n.writeSuccess(),{accessToken:a.access_token,expiresOn:Number(a.expires_on),notBefore:Number(a.not_before),resource:a.resource,tokenType:a.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:i}})}catch(i){return n.writeUnexpectedFailure("ResponseParseError",i),Promise.reject(new o(a.malformedResponseBody,{httpResponseStatus:200,message:r.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}},e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var a=n[t];window.sessionStorage.removeItem(a)}},e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e),window._spMSBT=void 0}},e}(),c=n("dq6a"),d=n("K9kD"),l=n("3HEj"),u=function(){function e(){this._qos=new d.Qos({name:"OAuthTokenDataSource"})}return e.prototype.writeSuccess=function(){this._qos.end({resultType:d.ResultTypeEnum.Success})},e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:d.ResultTypeEnum.Failure,error:JSON.stringify(t)})},e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:d.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})},e}(),f=function(){function e(){}return e.prototype.logWarning=function(e){},e.prototype.logError=function(e){},e}(),p=function(e){function t(t,n){var a=e.call(this,{},{pageContext:t})||this;return a.logger=new f,n&&(n.logger&&(a.logger=n.logger),n.useAbsoluteUrlForOAuth&&(a._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)),a._oAuthUtility=new s(a),a}return Object(i.__extends)(t,e),t.prototype.qosMonitor=function(){return new u},Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:Object(l.r)(this._pageContext)},enumerable:!1,configurable:!0}),t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var a=e.headers.get("Content-Type");return e.headers.delete("Content-Type"),t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),a,void 0,!0).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})},t.prototype.getToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))},t.prototype.getInstrumentedToken=function(e,t){return t&&this._oAuthUtility.clearCachedToken(e),this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))},t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};return t.forEach(function(e,t){n[t]=e}),n},t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t.prototype._es6PromiseToOdspPromise=function(e){return new d.Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})},t}(c.t);t.default=p},ITuu:function(e){e.exports=JSON.parse('{"e":"Create a Team","d":"Microsoft Teams is a real-time collaboration and communication tool that is part of the Office 365 suite of services.","l":"Clicking {0} will add a new Microsoft Team and connect it to the Microsoft 365 Group associated with this site. This action cannot be reversed.","r":"Hide","n":"Are you sure you want to hide the Microsoft Teams banner for this browser session? To remove it permanently, click \\u0022{0}\\u0022","i":"Don\\u0027t show me again","o":"Yes","a":"No","t":"Hide","u":"Add real-time chat","c":"Add Microsoft Teams to collaborate in real-time and share resources across Microsoft 365 with your team.","s":"Add Microsoft Teams","f":"Adding Microsoft Teams will connect your team site to a Microsoft 365 Group and create a new workspace to share resources and collaborate in real-time. "}')},Iznc:function(e,t,n){"use strict";var a,i,r,o,s;n.d(t,"e",function(){return m});var c=!1,d=function(){function e(){}return e.initSPExpFeatures=function(e){o=e},e.isFeatureEnabled=function(e){c||function(){var e;a=window.PageContext;var t=window.Flight;i=t&&t.Ramps,r=window.FilesConfig;var n=window.Flighting,l=window._spPageContextInfo;s=null===(e=window.Flight)||void 0===e?void 0:e.ecsRolloutsEnabled,!o&&l&&(!l.ExpFeatures&&n&&n.ExpFeatures&&(l.ExpFeatures=n.ExpFeatures),d.initSPExpFeatures(l.ExpFeatures)),c=!0}();var t=!!e.Fallback,n=e.ODB,l=e.ODC,u=e.ECS,f=e.OneDrive;return void 0!==n&&o&&(t=function(e,t){var n,a,i=!!e.Fallback,r=e.ODB;if("boolean"==typeof r)i=r;else if(r>0){if(r>=6e4){var o=r-6e4+2e3+1;n=Math.floor(o/32),a=1<<o%32}else{if(!(r<=2e3))return!1;n=Math.floor(r/32),a=1<<r%32}i=n<t.length&&0!=(t[n]&a)}return i}(e,o)),void 0!==l&&r&&("boolean"==typeof l?t=l:(i&&i[l]||r&&r[l])&&(t=!0)),void 0!==u&&s&&s.indexOf(u)>=0&&(t=!0),void 0!==f&&a&&(t=f),t},e.On={Fallback:!0},e.Off={},e}(),l=d,u=n("ydon"),f={forceEnabledFlights:[],forceDisabledFlights:[],flights:void 0,flightsMap:void 0,isInitialized:!1,queryParams:void 0};function p(e,t){if(-1!==f.forceEnabledFlights.indexOf(e))return!0;if(-1!==f.forceDisabledFlights.indexOf(e))return!1;if(!t||0===t.length)return!1;var n=Object.values(u.e).indexOf(e);if(-1===n)return console.error("The flight which needs to be checked is not in the fluent UI V9 component flights list"),!1;if(t.length<1+(n>>5))return console.error("The fluent UI V9 component flights list is not initialized correctly"),!1;var a=1<<(31&n);return 0!=(t[n>>5]&a)}function m(e,t,n){return function(e){return window.__FUIV9Flights?function(e){return f.isInitialized||(f.flights||(f.flights=window.__FUIV9Flights),function(e){if(e&&e.length>0){var t=e.split(",");f.forceEnabledFlights=[],f.forceDisabledFlights=[];for(var n=0,a=t;n<a.length;n++){var i=a[n];if("!"===i[0]){var r=parseInt(i.slice(1),10);isNaN(r)||f.forceDisabledFlights.push(r)}else r=parseInt(i,10),isNaN(r)||f.forceEnabledFlights.push(r)}}}(function(e){if(f.queryParams||(f.queryParams=new URLSearchParams(window.location.search)),f.queryParams.has(e))return f.queryParams.get(e)}("debugFlights")),function(){if(new Set(f.forceEnabledFlights.concat(f.forceDisabledFlights)).size<f.forceEnabledFlights.length+f.forceDisabledFlights.length)throw new Error("There are flights that are forced to be both enabled and disabled")}(),f.isInitialized=!0),!(!e||e<0)&&p(u.e.FluentUIV9ShimOverallControl,f.flights)&&p(e,f.flights)}(e):function(e){if(!f.flightsMap){f.flightsMap=new Map;for(var t=0,n=Object.keys(u.e);t<n.length;t++){var a=n[t],i=u.e[a];f.flightsMap.set(i,a)}}var r={ODB:e,ODC:f.flightsMap.get(e)},o={ODB:u.e.FluentUIV9ShimOverallControl,ODC:f.flightsMap.get(u.e.FluentUIV9ShimOverallControl)};return l.isFeatureEnabled(o)&&l.isFeatureEnabled(r)}(e)}(n)?t:e}},OpjN:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(a||(a={}))},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},"c4/U":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("cDcd");function r(e,t,n,r){var o=e.split("{0}");return r=Object(a.__assign)({key:"key"},r||{}),[o[0],i.createElement(n,r,t),o[1]]}},eoM9:function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return d});var a,i=n("17wl"),r=n("K9kD"),o=n("1tKF"),s=n("xkft"),c=n("h/Eh");!function(e){e.odbFirstRun="sharePointOneDriveBusinessFirstRun",e.filtersPaneFirstRun="sharePointFiltersPaneFirstRun",e.teamsTeachingBubble="sharePointTeamsTeachingBubble",e.librariesFirstRun="sharePointLibrariesFirstRun",e.listsFirstRun="sharePointListsFirstRun",e.modernDocSetsFirstRun="sharePointModernDocSetsFirstRun",e.listsHomeFirstRun="sharePointListsHomeFirstRun",e.goMobileFirstRun="sharePointListsGoMobileFirstRun"}(a||(a={}));var d=function(e){function t(t,n){var a=e.call(this,{dataSourceName:"UserInfo",id:"UserInfo"},n)||this,i=a._pageContext,r=n.itemUrlHelper||new s.e({},{pageContext:i});return a.apiUrlHelper=n.apiUrlHelper||new c.e({},{pageContext:i,itemUrlHelper:r}),a._additionalHeaders={"X-ClientType":"SharePointFirstRunUserFlag"},a}return Object(i.__extends)(t,e),t.prototype.getUserFlagValue=function(e){var t=this;if(!this._pageContext.userLoginName&&!this._pageContext.aadUserId)return r.Promise.resolve(!0);if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||this._pageContext.isExternalGuestUser)return r.Promise.resolve(!0);var n={url:this._getApiUrl()+"&$select="+e,qosName:"GetUserFlag",method:"GET",cacheRequestKey:e};return this.getDataUtilizingLegacyCache(Object(i.__assign)({onlyCache:!0,useStale:!0},n)).then(function(a){return a||t.getDataUtilizingLegacyCache(Object(i.__assign)(Object(i.__assign)({},n),{additionalHeaders:Object(i.__assign)({},t._additionalHeaders),parseResponse:function(t){var n=JSON.parse(t);if(n&&n.d&&void 0!==n.d[e])return!!n.d[e];throw new Error("Response did not contain flag: "+e)}}))}).catch(function(){return null})},t.prototype.setUserFlagValue=function(e,t){var n;return this.getDataUtilizingLegacyCache({url:this._getApiUrl(),qosName:"SetUserFlag",additionalPostData:JSON.stringify((n={},n[e]=t,n)),method:"POST",additionalHeaders:Object(i.__assign)({"X-HTTP-Method":"PATCH",Accept:"application/json; odata=minimalmetadata"},this._additionalHeaders),contentType:"application/json; odata=minimalmetadata",cacheRequestKey:e,bypassCache:!0,parseResponse:function(){return t}})},t.prototype._getApiUrl=function(){return this.apiUrlHelper.build().segment("SP.Directory.DirectorySession").methodWithAliases("User",this._pageContext.aadUserId?{id:this._pageContext.aadUserId}:{principalName:this._pageContext.userLoginName}).toString()},t}(o.e)},fz6G:function(e,t,n){"use strict";n.r(t),n.d(t,"GraphUserInfoDataSource",function(){return l});var a=n("17wl"),i=n("K9kD"),r=n("y88i"),o=n("aABS"),s=n("dq6a"),c=n("w0LS"),d={method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"}},l=function(e){function t(t,n){var a=e.call(this,{dataSourceName:"GraphUserInfo"},n)||this;return a._oAuthTokenProvider=n.oAuthTokenProvider,a._canUseGraph=a._pageContext.isSPO,a._persistentRequestCache=new o.e({id:"GraphUserInfo"},{pageContext:a._pageContext}),a}return Object(a.__extends)(t,e),t.prototype.canUseTeams=function(){var e=this;return this._canUseGraph?this._persistentRequestCache.getDataUtilizingCache({cachingStrategy:c.e.useCacheIfNotExpired,cacheTimeoutTime:r.ONE_WEEK,cacheRequestKey:"CanUseTeams",getData:function(){return e._oAuthTokenProvider.getToken(e._pageContext.msGraphEndpointUrl).then(function(t){return e._canUseTeams(t)})}}).catch(function(){return null}):i.Promise.resolve(null)},t.prototype._canUseTeams=function(e){return this.dataRequestor.getData(Object(a.__assign)(Object(a.__assign)({url:this._pageContext.msGraphEndpointUrl+"/beta/me/licenseDetails",authToken:e,qosName:"CanUseTeams"},d),{parseResponse:function(e){return JSON.parse(e).value.some(function(e){for(var t=e.servicePlans||[],n=0;n<t.length;n++)if("57ff2da0-773e-42df-b2af-ffb7a2317929"===t[n].servicePlanId)return"Success"===t[n].provisioningStatus;return!1})}}))},t}(s.e)},gM97:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a,i=n("K9kD");!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(a||(a={}));var r=function(){function e(e,t){void 0===e&&(e={}),this._dataSource=t.oAuthTokenDataSource}return e.prototype.getToken=function(e,t){var n=new i.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){return n.end({resultType:i.ResultTypeEnum.Success}),e},function(e){return n.end({resultType:i.ResultTypeEnum.Failure}),i.Promise.reject(e)})},e.prototype.getInstrumentedToken=function(e,t){var n=new i.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){return n.end({resultType:i.ResultTypeEnum.Success}),e},function(e){return n.end({resultType:i.ResultTypeEnum.Failure}),i.Promise.reject(e)})},e}();t.t=r},jViZ:function(e,t,n){"use strict";n.r(t),n.d(t,"NavLinkCoachmark",function(){return d});var a=n("17wl"),i=n("cDcd"),r=n("YIBf"),o=n("dUIr"),s=n("5pbq"),c=n("PuC3"),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onDismiss=function(){t.setState({isDismissed:!0}),t.props.onDismiss()},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=this.state;return t&&t.isDismissed?null:i.createElement(r.e,Object(a.__assign)({target:"#"+e.id,positioningContainerProps:{directionalHint:s.DirectionalHint.rightCenter}},e.coachmarkProps||{}),i.createElement(o.e,Object(a.__assign)({headline:e.teachingBubbleHeadline,calloutProps:{doNotLayer:!0},hasCloseIcon:!0,closeButtonAriaLabel:c.i,primaryButtonProps:{text:c.r,onClick:this._onDismiss},hasSmallHeadline:!0,onDismiss:this._onDismiss},e.teachingBubbleProps||{}),e.teachingBubbleContent))},t}(i.Component)},lR8E:function(e,t,n){"use strict";n.r(t),n.d(t,"TeamsProvider",function(){return o});var a=n("K9kD"),i=n("3HEj"),r=n("eoM9"),o=function(){function e(e,t){var n=this._pageContext=t.pageContext;this._groupsProvider=t.groupsProvider,this._graphUserInfoDataSource=t.graphUserInfoDataSource,this._userInfoDataSource=t.userInfoDataSource,this._isTeamsRelevant=Object(i.c)(n)}return e.prototype.getTeamsUrl=function(){return this._isTeamsRelevant?this._groupsProvider.getGroup().then(function(e){return e&&e.teamsUrl}):a.Promise.resolve()},e.prototype.canTeamify=function(){var e=this,t=this._pageContext;return this._isTeamsRelevant&&t.isSiteAdmin?t.isTeamsConnectedSite?a.Promise.resolve(!1):this._groupsProvider.getTeamifyBannerHidden().then(function(t){return!t&&e._groupsProvider.getGroup().then(function(t){return!t.teamsUrl&&!t.yammerResources&&e._graphUserInfoDataSource.canUseTeams().then(function(e){return e})}).catch(function(){return!1})}):a.Promise.resolve(!1)},e.prototype.shouldShowTeamsCoachmark=function(){var e=this;return(-1!==(window.location.search||"").indexOf("resetbubble=1")?this._userInfoDataSource.setUserFlagValue(r.t.teamsTeachingBubble,!1).then(function(){return!1}):this._userInfoDataSource.getUserFlagValue(r.t.teamsTeachingBubble)).then(function(t){if(!1===t)return e._graphUserInfoDataSource.canUseTeams()})},e.prototype.findTeamsLink=function(e,t){if(e&&e.length){var n=new a.Uri(t.toLowerCase());t=decodeURIComponent(n.getStringWithoutQueryAndFragment());for(var i=0,r=e;i<r.length;i++){var o=r[i],s=decodeURIComponent((o.url||"").toLowerCase());if(s.substring(0,t.length)===t||-1!==s.indexOf("/_layouts/15/groupstatus.aspx?target=team"))return o}}},e.prototype.setTeamsBubbleFlag=function(e){return this._userInfoDataSource.setUserFlagValue(r.t.teamsTeachingBubble,e)},e}()},lXIE:function(e,t,n){"use strict";n.r(t);var a=n("eoM9");n.d(t,"UserInfoFlag",function(){return a.t}),n.d(t,"UserInfoDataSource",function(){return a.e})},m7jy:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n("17wl");function i(e,t,n,a){}function r(e,t){var n=Object(a.__assign)({},e);return Object.keys(n).forEach(function(e){t.has(e)&&delete n[e]}),n}},qkfK:function(e,t){!function(e){"use strict";if(!e.fetch){var t="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,a="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,r="ArrayBuffer"in e;if(r)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=function(e){return e&&DataView.prototype.isPrototypeOf(e)},c=ArrayBuffer.isView||function(e){return e&&o.indexOf(Object.prototype.toString.call(e))>-1};m.prototype.append=function(e,t){e=u(e),t=f(t);var n=this.map[e];this.map[e]=n?n+","+t:t},m.prototype.delete=function(e){delete this.map[u(e)]},m.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},m.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},m.prototype.set=function(e,t){this.map[u(e)]=f(t)},m.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},m.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),p(e)},m.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),p(e)},m.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),p(e)},n&&(m.prototype[Symbol.iterator]=m.prototype.entries);var d=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},v.call(y.prototype),v.call(D.prototype),D.prototype.clone=function(){return new D(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new m(this.headers),url:this.url})},D.error=function(){var e=new D(null,{status:0,statusText:""});return e.type="error",e};var l=[301,302,303,307,308];D.redirect=function(e,t){if(-1===l.indexOf(t))throw new RangeError("Invalid status code");return new D(null,{status:t,headers:{location:e}})},e.Headers=m,e.Request=y,e.Response=D,e.fetch=function(e,t){return new Promise(function(n,i){var r=new y(e,t),o=new XMLHttpRequest;o.onload=function(){var e,t,a={status:o.status,statusText:o.statusText,headers:(e=o.getAllResponseHeaders()||"",t=new m,e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),a=n.shift().trim();if(a){var i=n.join(":").trim();t.append(a,i)}}),t)};a.url="responseURL"in o?o.responseURL:a.headers.get("X-Request-URL");var i="response"in o?o.response:o.responseText;n(new D(i,a))},o.onerror=function(){i(new TypeError("Network request failed"))},o.ontimeout=function(){i(new TypeError("Network request failed"))},o.open(r.method,r.url,!0),"include"===r.credentials&&(o.withCredentials=!0),"responseType"in o&&a&&(o.responseType="blob"),r.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send(void 0===r._bodyInit?null:r._bodyInit)})},e.fetch.polyfill=!0}function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function f(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function m(e){this.map={},e instanceof m?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function _(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function b(e){var t=new FileReader,n=h(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(a&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(r&&a&&s(e))this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!r||!ArrayBuffer.prototype.isPrototypeOf(e)&&!c(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=g(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=_(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(b)}),this.text=function(){var e,t,n,a=_(this);if(a)return a;if(this._bodyBlob)return e=this._bodyBlob,n=h(t=new FileReader),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),a=0;a<t.length;a++)n[a]=String.fromCharCode(t[a]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var n,a,i=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new m(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new m(t.headers)),this.method=(a=(n=t.method||this.method||"GET").toUpperCase(),d.indexOf(a)>-1?a:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function S(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),a=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(a),decodeURIComponent(i))}}),t}function D(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new m(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},tOru:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){this.members=new Array}return e.prototype.addUserToList=function(e){this.members.unshift(e)},e.prototype.removeUserFromList=function(e){for(var t=-1,n=0;n<this.members.length;n++)this.members[n].userId===e.userId&&(t=n);t>=0&&this.members.splice(t,1)},e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),n=0;n<this.members.length;n++)if(this.members[n].principalName&&this.members[n].principalName.toLowerCase()===t)return!0;return!1},e}();t.t=a},tS6Z:function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n("twj5"),i=n("17wl"),r=n("cDcd"),o=n("5pbq"),s=n("EH0/"),c=n("5swM"),d=n("nkDD"),l=n("xgjy"),u=n("dy9P"),f=n("5eMg"),p=n("xEt3"),m=n("CAi2"),_=n("iGDd"),h=n("xBsZ"),b=n("zhGz"),g=n("U15J"),v=n("m7jy"),y=new Set(["ariaDescribedById","ariaLabelledById","className","closeButtonAriaLabel","componentRef","containerClassName","contentClassName","dialogContentProps","firstFocusableSelector","forceFocusInsideTrap","hidden","ignoreExternalFocusing","isBlocking","isDarkOverlay","isOpen","maxWidth","minWidth","modalProps","onDismiss","onDismissed","onLayerDidMount","onLayerMounted","responsiveMode","styles","subText","theme","title","topButtonsProps","type"]),S=new Set(["ariaDescribedById","ariaLabelledById","className","closeButtonAriaLabel","containerClassName","contentClassName","dialogContentProps","hidden","isOpen","maxWidth","minWidth","modalProps","onDismiss","subText","title","type"]),D=function(e){if(Array.isArray(e))return e.map(D);if(r.isValidElement(e)){var t=e.props;return t.onClick?r.createElement(p.e,null,e):r.cloneElement(e,{},D(t.children))}return e},I=n("fglE"),x=Object(c.makeStyles)({DialogContent:{overflowX:"hidden"}}),C=Object(o.classNamesFunction)({useStaticStyles:!0}),O=n("Iznc"),w=n("ydon"),E=Object(O.e)(a.e,function(e){var t,n,a,O=function(e){var t=[],n=[],a=void 0;return r.Children.toArray(e.children).forEach(function(e){var i;i=e,r.isValidElement(i)&&i.type.displayName===g.e.displayName?(n.push(e.props.children),a=e.props):t.push(e)}),{content:t,footer:n,footerProps:a}}(e),w=O.content,E=O.footer,A=O.footerProps,L=E&&D(E),k=function(e){var t=e.title;return Object(i.__assign)({},e.dialogContentProps).title||t}(e),M=function(e){var t=e.subText;return Object(i.__assign)({},e.dialogContentProps).subText||t}(e),P=function(e){Object(v.t)(e,y,S,"Dialog");var t=e.ariaDescribedById,n=e.ariaLabelledById,a=e.closeButtonAriaLabel,r=e.dialogContentProps,o=e.hidden,s=e.isBlocking,c=e.isOpen,d=e.modalProps,l=e.onDismiss,u=function(e){return e?"alert":"modal"}(s||(null==d?void 0:d.isBlocking)),f={modalType:u,open:void 0!==o?!o:c,onOpenChange:function(e,t){var n,a;null==l||l(e),null===(n=null==r?void 0:r.onDismiss)||void 0===n||n.call(r,e),null===(a=null==d?void 0:d.onDismissed)||void 0===a||a.call(d)},closeButtonAriaLabel:a};return Object(i.__assign)(Object(i.__assign)({"aria-labelledby":n||(null==d?void 0:d.titleAriaId),"aria-describedby":t||(null==d?void 0:d.subtitleAriaId)},f),Object(v.e)(e,y))}(e),T=e.closeButtonAriaLabel,U=e.className,F=e.contentClassName,H=e.containerClassName,R=e.dialogContentProps,N=e.minWidth,B=e.maxWidth,j=e.modalProps,V=(null==j?void 0:j.className)||U,z=(null==j?void 0:j.containerClassName)||H,G=(null==R?void 0:R.className)||F,K=C(function(e,t,n){void 0===n&&(n=["styles","theme"]);var a=Object(r.useContext)(o.CustomizerContext),s=o.Customizations.getSettings(n,"Modal",a.customizations),c={};if(s.styles&&"function"==typeof s.styles&&(s.styles=s.styles(Object(i.__assign)(Object(i.__assign)({},s),t))),s.styles){if(c.default!==s.styles||c.component!==t.styles){var d=Object(I.concatStyleSets)(s.styles,t.styles);c.default=s.styles,c.component=t.styles,c.merged=d}return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},s),t),{styles:c.merged})}return Object(i.__assign)(Object(i.__assign)({},s),t)}(0,e.modalProps).styles),W=x(),q=r.useState(document.activeElement),Q=q[0],Y=q[1],J=r.useRef(!1);(N||B)&&(a={minWidth:N&&"".concat(N,"px"),maxWidth:B&&"".concat(B,"px")});var X=null!==(n=null!==(t=null==R?void 0:R.showCloseButton)&&void 0!==t?t:null==j?void 0:j.isBlocking)&&void 0!==n&&n,Z=null==R?void 0:R.type,$=function(){J.current&&Q&&Q.focus&&(Q.setAttribute("data-fui-focus-visible",""),Q.focus())};r.useLayoutEffect(function(){return P.open?Y(document.activeElement):$(),function(){$()}},[P.open]);var ee=function(){J.current=!1};return r.createElement(d.e,Object(i.__assign)({},P),r.createElement(l.e,{style:a,className:Object(c.mergeClasses)(K.main,V)},r.createElement(o.FocusTrapZone,null,r.createElement(u.e,{className:Object(c.mergeClasses)("ms-Dialog-main",z),onPointerDown:ee,onMouseDown:ee,onKeyDown:function(){J.current=!0}},r.createElement(f.e,{action:Z===s.e.close||X&&Z!==s.e.largeHeader?r.createElement(p.e,{action:"close"},r.createElement(m.Button,{appearance:"subtle","aria-label":T||"Close",icon:r.createElement(b.t,null)})):void 0,className:"ms-Dialog-title"},k),M||(null==w?void 0:w.length)?r.createElement(_.e,{className:Object(c.mergeClasses)("ms-Dialog-inner",W.DialogContent,G)},M&&r.createElement("p",null,M),w):null,r.createElement(h.e,{fluid:!!(null==A?void 0:A["data-isFluid"]),className:Object(c.mergeClasses)("ms-Dialog-actions",null==A?void 0:A.className)},L)))))},w.e.FluentUIV9ShimDialog)},ydon:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={FluentUIV9ShimOverallControl:60077,FluentUIV9ShimDefaultButton:60337,FluentUIV9ShimPrimaryButton:60344,FluentUIV9ShimIconButton:60355,FluentUIV9ShimActionButton:60356,FluentUIV9ShimImage:60357,FluentUIV9ShimToggle:60461,FluentUIV9ShimCommandBarButton:60466,FluentUIV9ShimCommandBar:60480,FluentUIV9ShimCommandButton:60501,FluentUIV9ShimTooltipHost:60634,FluentUIV9ShimTooltip:60633,FluentUIV9ShimLink:60405,FluentUIV9ShimStack:60413,FluentUIV9ShimCheckbox:60414,FluentUIV9ShimDialog:60426,FluentUIV9ShimChoiceGroup:60415,FluentUIV9ShimPersona:60419,FluentUIV9ShimFacepile:60569,FluentUIV9ShimPivot:60105,FluentUIV9ShimContextualMenu:60556,FluentUIV9ShimOverlay:60547,FluentUIV9ShimOverflowSet:60555,FluentUIV9ShimIcon:60446,FluentUIV9ShimSpinner:60450,FluentUIV9ShimSlider:60454,FluentUIV9ShimLayer:60460,FluentUIV9ShimText:60566,FluentUIV9ShimCustomizer:60650,FluentUIV9ShimThemeProvider:60567,FluentUIV9ShimSpinButton:60557,FluentUIV9ShimLabel:60382,FluentUIV9ShimSeparator:60384,FluentUIV9ShimCompoundButton:60540}}}]);