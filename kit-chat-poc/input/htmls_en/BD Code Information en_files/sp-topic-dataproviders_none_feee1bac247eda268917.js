define("69ea40d8-80e5-4ed2-8e45-f5c904e94161_0.1.0",["tslib","@microsoft/sp-http-base","@ms/sp-telemetry","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@ms/sp-topic-sdk","@microsoft/sp-page-context","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http"],function(n,a,i,r,o,s,c,d,l,u){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2SXB":function(e,t){e.exports=a},"2q6Q":function(e,t){e.exports=i},Pk8u:function(e,t){e.exports=r},UWqr:function(e,t){e.exports=o},WZz6:function(e,t){e.exports=s},"X+PM":function(e,t){e.exports=c},"hiL/":function(e,t){e.exports=d},mwqp:function(e,t,n){"use strict";var a;n.r(t),n.d(t,"TopicPageDataProvider",function(){return S}),n.d(t,"OCPSPolicyDataProvider",function(){return x}),n.d(t,"TopicMultilingualDataProvider",function(){return C}),function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(a||(a={}));var i,r=n("17wl"),o=n("X+PM"),s=n("hiL/"),c=n("UWqr"),d=n("ut3N"),l=n("vlQI"),u=n("Pk8u"),f=n("2q6Q"),p=n("WZz6");!function(e){e[e.BadRequest=400]="BadRequest",e[e.Conflict=409]="Conflict",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.NotAcceptable=406]="NotAcceptable",e[e.ServerError=500]="ServerError",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.NotImplemented=501]="NotImplemented"}(i||(i={}));var m=i,_=function(e){function t(n,a,i,r){void 0===n&&(n="unknown"),void 0===a&&(a=200),void 0===r&&(r=!1);var o=e.call(this,n)||this;return"unknown"===n&&(o.isUnknown=!0),o.__proto__=t.prototype,o.status=a,o.code=i,o.isExpected=r,o}return Object(r.__extends)(t,e),t}(Error);function h(e){var t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return"[HTTP]:".concat(e.status," - ").concat(e.statusText," [CorrelationId]:").concat(t," [Version]:").concat(n)}function b(){return c._SPKillSwitch.isActivated("9c8c4dbb-309c-473c-8e35-e420d68f34f7")}var g=function(){function e(e){this.serviceScope=e,this._spHttpClient=e.consume(l.SPHttpClient.serviceKey)}return e._getOdataRestApiError=function(e,t){void 0===t&&(t=m.ServerError);var n=e["odata.error"];return(null==n?void 0:n.message)?new _("Message: ".concat(n.message.value),t,n.code):void 0},e.prototype.fetchJson=function(t,n,a,i){var r=new f._QosMonitor("".concat(this.qosPrefixName,".fetchDataFailed")),o={body:i,headers:n};return d._TraceLogger.logVerbose(d._LogSource.create(this.qosPrefixName),a),this._spHttpClient.post(t,l.SPHttpClient.configurations.v1,o).then(function(t){if(b()&&!t.ok)throw new _(h(t),t.status);return t.json().then(function(n){var a=e._getOdataRestApiError(n,null==t?void 0:t.status);if(a)throw a;return n}).catch(function(e){throw b()||e instanceof _?e:new _(h(t),t.status)})}).catch(function(e){throw e.status===m.Forbidden?r.writeExpectedFailure("FailedResponseForbidden",e):r.writeUnexpectedFailure("FailedResponseStatus",e),e})},e.prototype.getRestTopicsEndPointUrl=function(){return this.getRestSitePagesEndPointUrl().then(function(e){return"".concat(e,"/topics")})},e.prototype.getRestSitePagesEndPointUrl=function(){return this.getKnowledgeCenterRelativeUrl().then(function(e){return"".concat(e,"/_api/sitepages/pages")})},e.prototype.getKnowledgeCenterRelativeUrl=function(){var e=this;if(this._knowledgeCenterUrl)return Promise.resolve(this._knowledgeCenterUrl);var t=this.serviceScope.consume(o.PageContext.serviceKey);return Object(s.isSiteKnowledgeCenter)(t.legacyPageContext)?(this._knowledgeCenterUrl=c.UrlUtilities.removeEndSlash(t.legacyPageContext.webServerRelativeUrl),Promise.resolve(this._knowledgeCenterUrl)):Object(p.getTopicsSdk)(this.serviceScope).then(function(t){if(!t.getKnowledgeCenterInfo())throw new Error("Can not get valid knowledge center info");var n=t.getKnowledgeCenterInfo().url;return e._knowledgeCenterUrl=n,n})},e}(),v=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},y=function(){function e(e){this.__metadata={type:"SP.Publishing.TopicSitePage"},e&&Object(u.assign)(this,e)}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.createTopicPage=function(e){var t=this,n=e.topic,a=e.canvasContent1,i=e.layoutWebpartsContent,o=e.language;return this.getRestTopicsEndPointUrl().then(function(e){var d=new y(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({Title:n.Name,EntityId:n.Id!==s.NULL_TOPIC_ENTITY.Id?n.Id:"",EntityType:"",EntityRelations:s.EntityRelationsService.getRelationsAsString(t.serviceScope)},c._SPFlight.isEnabled(1601)?{VerifiedTopicAllowedEditors:s.VerifiedTopicAllowedEditorsService.getEditorsAsString(t.serviceScope)}:void 0),c._SPFlight.isEnabled(60475)&&o&&{Language:o}),{LayoutWebpartsContent:i,CanvasContent1:JSON.stringify(a),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:"Topic"}));return t.fetchJson(e,new v("POST"),"createTopicPage",JSON.stringify(d))}).catch(function(e){throw e.name=function(e){var t,n,a,i,r,o;return-1!==(null===(t=e.code)||void 0===t?void 0:t.indexOf("-2146233086"))&&-1!==(null===(n=e.code)||void 0===n?void 0:n.indexOf("LanguageCodes"))?"UnsupportedLanguage":-1!==(null===(a=e.code)||void 0===a?void 0:a.indexOf("-2146232832"))&&-1!==(null===(i=e.code)||void 0===i?void 0:i.indexOf("Microsoft.SharePoint.SPException"))?"SourcePageCheckedOutByOtherUser":-1!==(null===(r=e.code)||void 0===r?void 0:r.indexOf("-2146232832"))&&-1===(null===(o=e.code)||void 0===o?void 0:o.indexOf("SPDuplicateValuesFoundException"))?"DuplicatePage":"UnknownError"}(e),e})},t.prototype.checkoutTopicPage=function(e,t){var n=this;return void 0===t&&(t=this.serviceScope.consume(o.PageContext.serviceKey).web.languageName),this.getRestTopicsEndPointUrl().then(function(a){return n.fetchJson("".concat(a,"/GetByEntityIdAndCulture(id='").concat(e.join(";"),"',culture='").concat(t,"')/checkoutpage"),new v("POST"),"CheckoutTopicPageByTopicId")})},t.prototype.checkoutPage=function(e){var t=this;return this.getRestSitePagesEndPointUrl().then(function(n){return t.fetchJson("".concat(n,"/GetByUrl('").concat(new URL(e).pathname,"')/checkoutpage"),new v("POST"),"CheckoutPageByUrl")})},t.prototype.publishTopicPage=function(e){var t=this;return this.getRestSitePagesEndPointUrl().then(function(n){var a="".concat(n,"(").concat(e,")/publish");return t.fetchJson(a,new v("POST"),"publishTopicPage")})},t.prototype.getTopicPageByEntityId=function(e,t){var n=this;return t?this.getRestTopicsEndPointUrl().then(function(a){return n.fetchJson("".concat(a,"/GetByEntityIdAndCulture(id='").concat(e.join(";"),"',culture='").concat(t,"')"),new v("GET"),"getTopicPageByEntityId")}):this.getDefaultTopicPageByEntityId(e)},t.prototype.getDefaultTopicPageByEntityId=function(e){var t=this;return this.getRestTopicsEndPointUrl().then(function(n){var a=t.serviceScope.consume(o.PageContext.serviceKey).web.languageName;return t.fetchJson("".concat(n,"/GetByEntityIdAndCulture(id='").concat(e.join(";"),"',culture='").concat(a,"')"),new v("GET"),"getDefaultTopicPageByEntityId")})},t.prototype.getSourcePageByEntityId=function(e,t){var n=this;if(0===e.length)throw new Error("Empty entityIds provided");return this.getRestTopicsEndPointUrl().then(function(a){var i="";(null==t?void 0:t.length)&&t.length>0&&(i="?$select=".concat(t.join(",")));var r="".concat(a,"/GetByEntityId('").concat(e.join(";"),"')").concat(i);return n.fetchJson(r,new v("GET"),"getSourcePageByEntityId")})},t.prototype.getTopicPagesByEntityId=function(e,t){var n=this;return 0===e.length?Promise.reject("Empty entityIds provided"):this.getRestTopicsEndPointUrl().then(function(a){var i="";(null==t?void 0:t.length)&&t.length>0&&(i="?$select=".concat(t.join(",")));var r="".concat(a,"/GetPagesByEntityId('").concat(e.join(";"),"')").concat(i);return n.fetchJson(r,new v("GET"),"getTopicPagesByEntityId").then(function(e){return e.value||[]})})},Object.defineProperty(t.prototype,"qosPrefixName",{get:function(){return"CSIKM.TopicPageDataProvider"},enumerable:!1,configurable:!0}),t}(g),D=n("2SXB"),I="https://clients.config.office.net",x=function(){function e(e){this._serviceScope=e,this._tokenProvider=D._AadTokenProviders.configurable}return e.prototype.getPolicies=function(){var e=this,t=new d._QosMonitor("".concat("CSIKM",".OCSPPolicy.").concat("DP",".getPolicies"));return this._tokenProvider._getTokenInternal(I,D._AadTokenProviders.preAuthorizedConfiguration).then(function(t){return e._serviceScope.consume(l.HttpClient.serviceKey).get(e._policiesEndPoint,l.AadHttpClient.configurations.v1,e._getRequestOptions(t)).then(function(e){return 204===e.status?{}:e.json()})}).catch(function(e){return t.writeUnexpectedFailure("FailedToOCPSPolicies",e),Promise.reject(e)})},e.prototype._getRequestOptions=function(e){var t={headers:{}};return t.headers["Content-Type"]="application/json",t.headers.Authorization="Bearer ".concat(e),t.headers["x-Cid"]="00000003-0000-0ff1-ce00-000000000000",t},Object.defineProperty(e.prototype,"_policiesEndPoint",{get:function(){return"".concat(I).concat("/user/v1.0/web/policies")},enumerable:!1,configurable:!0}),e}(),C=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.getDefaultPageUrlBySourceId=function(e){var t=this,n=new d._QosMonitor("".concat(this.qosPrefixName,".getDefaultPageUrlBySourceId")),a=!1;return this.getRestSitePagesEndPointUrl().then(function(i){var r="".concat(i,"/GetByUniqueId('").concat(e,"')?$select=AbsoluteUrl");return t.fetchJson(r,new v("GET"),"getDefaultPageUrlBySourceId").then(function(e){return a=!0,e.AbsoluteUrl?(n.writeSuccess(),e.AbsoluteUrl):Promise.reject(new Error("Response have no AbsoluteUrl returned for the default language page."))})}).catch(function(e){n.writeUnexpectedFailure(a?"SuccessResponseButWrongData":"FailedToGetDefaultUrl",e)})},t.prototype.getSourcePageByUniqueId=function(e,t){var n=this,a=new d._QosMonitor("".concat(this.qosPrefixName,".getDefaultPageBySourceId"));return this.getRestSitePagesEndPointUrl().then(function(i){var r="".concat(i,"/GetByUniqueId('").concat(e,"')").concat(function(e){var t="";return(null==e?void 0:e.length)&&e.length>0&&(t="?$select=".concat(e.join(","))),t}(t));return n.fetchJson(r,new v("GET"),"getDefaultPageBySourceId").then(function(e){return a.writeSuccess(),e})}).catch(function(e){a.writeUnexpectedFailure("FailedToGetSourcePage",e)})},Object.defineProperty(t.prototype,"qosPrefixName",{get:function(){return"CSIKM.TopicMultilingualDataProvider"},enumerable:!1,configurable:!0}),t}(g)},ut3N:function(e,t){e.exports=l},vlQI:function(e,t){e.exports=u}})});