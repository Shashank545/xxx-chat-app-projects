define("5f18a9a1-d34e-4b05-a71f-e5e554d8649b_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-listview-extensibility","@microsoft/sp-application-base","@microsoft/sp-loader","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-extension-base","@microsoft/sp-diagnostics"],function(n,a,i,r,o,s,c,d,l,u){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"7wVe":function(e,t){e.exports=i},GPet:function(e,t){e.exports=r},I6O9:function(e,t){e.exports=o},Pk8u:function(e,t){e.exports=s},UWqr:function(e,t){e.exports=c},"X+PM":function(e,t){e.exports=d},ZFc5:function(e,t){e.exports=l},mwqp:function(e,t,n){"use strict";var a;n.r(t),n.d(t,"ListViewStateChanges",function(){return a}),n.d(t,"SpfxAdapter",function(){return I}),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.View=2]="View",e[e.Columns=4]="Columns",e[e.SelectedRows=8]="SelectedRows",e[e.Rows=16]="Rows",e[e.AppliedFilters=32]="AppliedFilters",e[e.Sort=64]="Sort",e[e.FolderInfo=128]="FolderInfo"}(a||(a={}));var i=n("GPet"),r=n("17wl"),o=n("ZFc5"),s=n("UWqr"),c=n("7wVe"),d=n("2q6Q"),l=n("ut3N"),u=function(){function e(e,t,n){this._isDisposed=!1,this._domElement=n,this._column=e,this._row=t,this._error=void 0;var a=t.getValueByName(this._column.data.internalName),i=t.getUserData(this._column.data.internalName);this._event={domElement:n,row:t.accessor,listItem:t.accessor,fieldValue:a,userData:i};try{this._column.fieldCustomizer&&this._column.fieldCustomizer.onRenderCell(this._event),t.updateUserData(this._column.data.internalName,this._event.userData)}catch(e){this._error=e}}return Object.defineProperty(e.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"domElement",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cellDiv",{get:function(){return this._domElement},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.row=function(){return this._row},e.prototype.dispose=function(){if(!this._isDisposed){try{this._column.fieldCustomizer&&this._column.fieldCustomizer.onDisposeCell(this._event),this._row.onDisposeCell(this)}catch(t){l._TraceLogger.logError(e._logSource,t)}this._error=void 0,this._domElement=void 0,this._column=void 0,this._row=void 0,this._event=void 0,this._isDisposed=!0}},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e._logSource=l._LogSource.create("CellAdapter"),e}(),f=n("X+PM"),p=function(e){function t(t){var n=e.call(this)||this,a=t.data;return n._field=new f.SPField({id:a.id,internalName:a.internalName,fieldType:a.fieldType,isRequired:a.isRequired,displayName:a.displayName,clientSideComponentId:a.clientSideComponentId,clientSideComponentProperties:a.clientSideComponentProperties}),n._visible=a.isVisible,n._onSetVisible=a.onSetVisible,n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"field",{get:function(){return this._field},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"visible",{get:function(){return this._visible},set:function(e){this._onSetVisible(e),this._visible=e},enumerable:!1,configurable:!0}),t}(c.ColumnAccessor),m=function(){function e(e,t){this._data=e,this._accessor=new p(this),this._listViewAdapter=t,this._fieldCustomizer=void 0}return Object.defineProperty(e.prototype,"listViewAdapter",{get:function(){return this._listViewAdapter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldCustomizerLoaded",{get:function(){return void 0!==this._fieldCustomizer},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accessor",{get:function(){return this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldCustomizer",{get:function(){return this._fieldCustomizer},set:function(e){this._fieldCustomizer=e},enumerable:!1,configurable:!0}),e.prototype.renderCell=function(e,t){if(!this.fieldCustomizer)throw new Error("renderCell() should not have been called because fieldCustomizerLoaded is false");return new u(this,e,t)},e}(),_=function(e){function t(t){var n=e.call(this)||this;return n._fields=[],n._values=new Map,n.invalidateCache(t),n}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"fields",{get:function(){return this._fields},enumerable:!1,configurable:!0}),t.prototype.getValueByName=function(e){return this._values.get(e)},t.prototype.getValue=function(e){return this._values.get(e.internalName)},t.prototype.invalidateCache=function(e){for(var t in this._values.clear(),e.data.values)this._values.set(t,e.data.values[t]);this._fields=e.listViewAdapter.fields},t}(c.RowAccessor),h=function(){function e(e,t){this._data=e,this._listViewAdapter=t,this._userData=new Map}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"accessor",{get:function(){return this._accessor||(this._accessor=new _(this)),this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listViewAdapter",{get:function(){return this._listViewAdapter},enumerable:!1,configurable:!0}),e.prototype.onDisposeCell=function(e){this._userData.delete(e.column.data.internalName)},e.prototype.getValueByName=function(e){if(this.data.values.hasOwnProperty(e))return this.data.values[e]},e.prototype.getUserData=function(e){return this._userData.has(e)||this._userData.set(e,void 0),this._userData.get(e)},e.prototype.updateUserData=function(e,t){this._userData.set(e,t)},e.prototype.invalidateCache=function(e){this._data=e,this._accessor&&this._accessor.invalidateCache(this)},e}(),b=function(e){function t(t,n){var a=e.call(this,n)||this;return a._adapter=t,a}return Object(r.__extends)(t,e),Object.defineProperty(t.prototype,"columns",{get:function(){return this._adapter.columnAdapters.map(function(e){return e.accessor})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this._adapter.rowAdapters.map(function(e){return e.accessor})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedRows",{get:function(){var e;return null===(e=this._adapter.selectedRows)||void 0===e?void 0:e.map(function(e){return e.accessor})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"list",{get:function(){return this._adapter.list?Object(r.__assign)(Object(r.__assign)({},this._adapter.list),{guid:s.Guid.parse(this._adapter.list.guid)}):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"view",{get:function(){return this._adapter.view?Object(r.__assign)(Object(r.__assign)({},this._adapter.view),{id:s.Guid.parse(this._adapter.view.id)}):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"folderInfo",{get:function(){return this._adapter.folderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"appliedFilters",{get:function(){return this._adapter.appliedFilters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sortField",{get:function(){return this._adapter.sortField},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sortAscending",{get:function(){return this._adapter.sortAscending},enumerable:!1,configurable:!0}),t.prototype.tryGetColumnByName=function(e){return this._adapter.tryGetColumnAccessorByName(e)},t}(c.ListViewAccessor),g=n("Pk8u"),v=function(){function e(e,t,n,a){if(this.description="",this.itemKey="",this._lastSelectedRows=void 0,this._lastRootFolder="",this.listViewAdapter=t,this._commandSetAdapter=n,this._command=a,this.commandId=e,!this._command)throw new Error("No command found for command id '".concat(e,"'"));this._updateAdapter(),this.refresh([])}return e.prototype.refresh=function(e,t){var n=!1;if(this._lastSelectedRows&&1===this._lastSelectedRows.length&&1===e.length){var a=this._lastSelectedRows[0],i=e[0];if(a&&i&&a.data&&i.data&&a.data.values===i.data.values)return;n=!0}var r=t||"";!(n=n||this._lastRootFolder!==r)&&this._lastSelectedRows&&this._lastSelectedRows.length===e.length||(this._lastSelectedRows=e.slice(0),this._lastRootFolder=r,this._commandSetAdapter.onListViewUpdated(e),this._updateAdapter())},e.prototype.execute=function(){this._commandSetAdapter.onExecute(this.commandId,this._lastSelectedRows||[])},e.prototype._updateAdapter=function(){this.ariaLabel=void 0!==this._command.ariaLabel?this._command.ariaLabel:this._command.title,this.iconUrl=this._command.iconImageUrl},Object.defineProperty(e.prototype,"_state",{get:function(){return this._command?{visible:this._command.visible,title:this._command.title,disabled:this._command.disabled}:{visible:!1,title:"",disabled:void 0}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return!!this._command&&this._command.visible},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._command?this._command.title:""},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._command?this._command.disabled:void 0},enumerable:!1,configurable:!0}),e}(),y=function(){function e(e,t){var n=this;this.onChange=void 0,this._commandAdapters=[],this.raiseOnChange=function(){if(n.onChange){var e=n._collectCommandAdapersState(),t={};e.forEach(function(e,a){t[n._commandAdapters[a].itemKey]=e}),n.onChange(t)}},this._commandSet=e,this._commandSet._raiseOnChange=this.raiseOnChange;for(var a=e.manifest.items,i=0,r=Object.getOwnPropertyNames(a);i<r.length;i++){var o=r[i];"command"===a[o].type&&this._commandAdapters.push(new v(o,t,this,e.tryGetCommand(o)))}}return Object.defineProperty(e.prototype,"commandAdapters",{get:function(){return this._commandAdapters},enumerable:!1,configurable:!0}),e.prototype.onListViewUpdated=function(e){var t={selectedRows:e.map(function(e){return e.accessor})};this._commandSet.onListViewUpdated(t)},e.prototype.onExecute=function(e,t){var n=this._collectCommandAdapersState(),a={commandId:e,itemId:e,selectedRows:t.map(function(e){return e.accessor})};this._commandSet.onExecute(a),this._raiseOnChange(n)},e.prototype._collectCommandAdapersState=function(){return this._commandAdapters.map(function(e){return{title:e.title,visible:e.visible,disabled:e.disabled}})},e.prototype._raiseOnChange=function(e){var t=this;if(this.onChange){var n=void 0;e.forEach(function(e,a){var i=t._commandAdapters[a],r=i._state;Object(g.isEqual)(e,r)||(n||(n={}),n[i.itemKey]=r)}),n&&this.onChange(n)}},e}(),S=function(){function e(e){this._isDisposed=!1,this._columns=[],this._columsData=[],this._rows=[],this._instanceId=s.Guid.newGuid().toString(),this._cachedFields=void 0,this._cachedInternalNamesMap=new Map,this._fieldCustomizerManager=new o._ExtensionManager(e,c.BaseFieldCustomizer),this._commandSetManager=new o._ExtensionManager(e,c.BaseListViewCommandSet),this._accessor=new b(this,this._instanceId)}return Object.defineProperty(e.prototype,"accessor",{get:function(){return this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnAdapters",{get:function(){return this._columns},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowAdapters",{get:function(){return this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fields",{get:function(){return this._ensureColumnsCacheIsValid(),this._cachedFields},enumerable:!1,configurable:!0}),e.prototype.addColumnAdapter=function(e){var t,n=this._cachedInternalNamesMap.get(e.internalName);return n?this._columns[n]:(t=new m(e,this),this._columns.push(t),this._columsData.push(e),this._invalidateColumnsCache(),t)},e.prototype.removeColumnAdapter=function(e){var t=this._columsData.indexOf(e);-1!==t&&(this._columsData.splice(t,1),this._columns.splice(t,1),this._invalidateColumnsCache())},e.prototype.setColumnAdapters=function(e){this._columns.splice(0,this._columns.length),this._columsData.splice(0,this._columsData.length);for(var t=0,n=e;t<n.length;t++){var a=n[t];this._columns.push(a),this._columsData.push(a.data)}this._invalidateColumnsCache()},e.prototype.createRowAdapter=function(e){var t=new h(e,this);return this._rows.push(t),t},e.prototype.addRowAdapter=function(e){this._rows.push(e)},e.prototype.removeRowAdapter=function(e){var t=this._rows.indexOf(e);-1!==t&&this._rows.splice(t,1)},e.prototype.setRowAdapters=function(e){var t;this._rows.splice(0,this._rows.length),(t=this._rows).push.apply(t,e)},e.prototype.getRowAdapter=function(e,t){for(var n,a=0;a<this._rows.length;a++){var i=this._rows[a];if(i.getValueByName(e)===t){n=i;break}}return n},e.prototype.loadFieldCustomizers=function(){for(var t=this,n=[],a=function(a){var r=s.Guid.tryParse(a.data.clientSideComponentId);if(r&&!s.Guid.empty.equals(r)){if(a.fieldCustomizer)return"continue";var o=new d._QosMonitor("FieldCustomizer.Create");a.fieldCustomizer=void 0;var u=i._fieldCustomizerManager.createExtension(r.toString(),a.data.clientSideComponentProperties,function(e){return new c.FieldCustomizerContext(e,{listView:t.accessor,field:a.accessor.field})}).then(function(e){a.fieldCustomizer=e,o.writeSuccess({clientSideComponentId:r})}).catch(function(t){try{a.data.onFieldCustomizerError(t)}catch(t){l._TraceLogger.logError(e._logSource,t)}o.writeExpectedFailure("FailedCreateExtension",t,{clientSideComponentId:r})});n.push(u)}},i=this,r=0,o=this._columns;r<o.length;r++)a(o[r]);return Promise.all(n).then(function(){})},e.prototype.loadCommandSet=function(t,n){var a=this,i=new d._QosMonitor("ListViewCommandSet.Create");return this._commandSetManager.createExtension(t,n,function(e){return new c.ListViewCommandSetContext(e,{listView:a._accessor})}).then(function(e){return new y(e,a)}).then(function(e){return i.writeSuccess({clientSideComponentId:t}),e}).catch(function(n){throw i.writeExpectedFailure("FailedCreateExtension",n,{clientSideComponentId:t}),l._TraceLogger.logError(e._logSource,n),n})},e.prototype.tryGetColumnAccessorByName=function(e){this._ensureColumnsCacheIsValid();var t=this._cachedInternalNamesMap.get(e);if(t)return this._columns[t].accessor},e.prototype.raiseSelectedRowsChangedEvent=function(e){var t=e.map(function(e){return e.accessor});s._SPEventManager.instance.raiseStickyEvent(c.ListViewAccessor._selectedRowsChangedEventName,{selectedRows:t})},e.prototype.raiseListViewStateChangedEvent=function(e,t){s._SPEventManager.instance.raiseStickyEvent("".concat(c.ListViewAccessor._listViewStateChangedEventName).concat(this._instanceId),{prevState:this._mapListViewStateToListViewAccessorState(e),stateChanges:t})},e.prototype.dispose=function(){this._isDisposed||(this._fieldCustomizerManager.dispose(),delete this._fieldCustomizerManager,this._commandSetManager.dispose(),delete this._commandSetManager,this._accessor.dispose(),this._isDisposed=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype._invalidateColumnsCache=function(){this._cachedFields=void 0},e.prototype._ensureColumnsCacheIsValid=function(){var e=this;this._cachedFields||(this._cachedFields=[],this._cachedInternalNamesMap.clear(),this._columns.forEach(function(t,n){e._cachedFields.push(t.accessor.field),e._cachedInternalNamesMap.set(t.accessor.field.internalName,n)}))},e.prototype._mapListViewStateToListViewAccessorState=function(e){return Object(r.__assign)(Object(r.__assign)({},e),{list:e.list?Object(r.__assign)(Object(r.__assign)({},e.list),{guid:s.Guid.parse(e.list.guid)}):void 0,view:e.view?Object(r.__assign)(Object(r.__assign)({},e.view),{id:s.Guid.parse(e.view.id)}):void 0,columns:e.columns.map(function(e){return Object(r.__assign)(Object(r.__assign)({},e),{id:s.Guid.parse(e.id),clientSideComponentId:s.Guid.tryParse(e.clientSideComponentId)})})})},e._logSource=l._LogSource.create("ListViewAdapter"),e}(),D=n("I6O9"),I=function(){function e(e){var t=this;this._serviceScope=e,e.whenFinished(function(){t._placeholderManager=e.consume(i._PlaceholderManager.serviceKey)})}return Object.defineProperty(e.prototype,"serviceScope",{get:function(){return this._serviceScope},enumerable:!1,configurable:!0}),e.prototype.registerManifests=function(e){D.SPComponentLoader.registerManifests(e)},e.prototype.createListViewAdapter=function(){return new S(this._serviceScope)},e.prototype.definePlaceholders=function(e){for(var t=[],n=0,a=e;n<a.length;n++){var r=a[n];if("DialogContainer"===r.name)i._DialogManagerConfiguration.instance.initialize(r.div);else{var o=i.PlaceholderName[r.name];if("number"!=typeof o)throw new Error("definePlaceholders() was called with an unsupported name: "+r.name);t.push({name:o,domElement:r.div})}}this._placeholderManager.initializePlaceholders(t)},e}()},ut3N:function(e,t){e.exports=u}})});