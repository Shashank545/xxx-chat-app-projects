(window.webpackJsonpf92bf067_bc19_489e_a556_7fe95f508720_0_1_0=window.webpackJsonpf92bf067_bc19_489e_a556_7fe95f508720_0_1_0||[]).push([[61],{"2BHO":function(e){e.exports=JSON.parse('{"e":"Press enter to open the edit form for this item"}')},EOEZ:function(e,t,n){"use strict";n.d(t,"i",function(){return r}),n.d(t,"a",function(){return s}),n.d(t,"t",function(){return d}),n.d(t,"e",function(){return u}),n.d(t,"n",function(){return p});var a=n("5oS0"),i=Object(a.e)("cf.render.count"),r=Object(a.e)("cf.render",{dependentCounter:i}),o=Object(a.e)("cf.postRender.count"),s=Object(a.e)("cf.postRender",{dependentCounter:o}),c=Object(a.e)("cf.evaluate.count"),d=Object(a.e)("cf.evaluate",{dependentCounter:c}),l=Object(a.e)("cf.evalExpression.count"),u=Object(a.e)("cf.evalExpression",{dependentCounter:l}),f=Object(a.e)("cf.customFormatterProps.count"),p=Object(a.e)("cf.customFormatterProps",{dependentCounter:f})},IVmb:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("ziIv"),i=n("VFPM");function r(e,t){void 0===t&&(t=a.e);var n,r=e.extension,o=e.size,s=void 0===o?i.e:o,c=e.type,d=e.imageFileType,l=Object(i.t)(r,c),u=Object(i.a)(s,d).split("_");return 3===u.length?(n="".concat(t).concat(s,"_").concat(u[1],"/").concat(l,".").concat(u[2]),'<img src="'.concat(n,'" height="100%" width="100%" />')):2===u.length?(n="".concat(t).concat(s,"/").concat(l,".").concat(u[1]),'<img src="'.concat(n,'" alt="" />')):void 0}},PeVo:function(e,t,n){"use strict";n.d(t,"e",function(){return G});var a=n("17wl"),i=n("cDcd"),r=n("yxtM"),o=n("Oq/r"),s=n("LbJS"),c=n("HHDc"),d=n("Wb+Q"),l=n("Q0K9"),u=n("Mu92"),f=n("88C8"),p=n("Cr7w"),m=n("/0I7"),_=n("GgYY"),h=n("f6OE"),b=n("lSrV"),g=n("lxd+"),v=n("62LQ"),y=n("Opzy"),S=n("3FfR"),D="data-event-trigger";function I(e){var t=Object(i.useState)({}),n=t[0],r=t[1],o=function(e,t){var n=e.getAttribute("id");n&&r(function(e){var i;return Object(a.__assign)(Object(a.__assign)({},e),((i={})[n]=t,i))})},s=Object(S.e)(function(t){var n=t&&t.currentTarget,a=t&&t.target;if(null!==a.getAttribute(D)&&a===n){var i=e.itemCacheDispatch;i&&i(Object(g.e)({name:"CustomCardType",extraData:{CustomCardEvent:t.type},isIntentional:!0})),o(n,!0)}}),c=function(t){void 0===t&&(t=!1);var n=e.rootRef&&e.rootRef.current;if(n){var a=t?"removeEventListener":"addEventListener",i={click:"click",hover:"mouseover"};[].forEach.call(n.querySelectorAll("[".concat("data-custom-card-path","]")),function(e){var t=e.getAttribute(D);"click"!==t&&"hover"!==t||(e[a](i[t],s),"hover"===t&&e[a]("focus",s))})}};Object(i.useEffect)(function(){return c(),function(){c(!0)}},[e,n]);var d=function(t){if(t){var n=t?t.formatter:{};return e.onRenderContent(n)}return null},l=function(e){e&&o(e,!1)},u=e.rootRef&&e.rootRef.current;if(!u)return null;var f=Object.keys(n).filter(function(e){return n[e]}).map(function(t){var n,a=u.querySelector('[id = "'.concat(t,'"]'));return a&&(n=Object(y.a)(a,e.customFormatter)),Object(v.e)({customCardContent:d(n),customCardProps:n,id:t,targetElement:a,onCardHide:l})});return i.createElement(i.Fragment,null,f)}var x=n("hR5Q"),C=n("FfZc"),O=n("rmhP"),w=n("D2s4"),E=n("cNe7");function A(e){var t=i.useState(),n=t[0],a=t[1];i.useEffect(function(){function t(){n!==e.customFormatter&&a(e.customFormatter)}var i=e.rootRef.current;if(i&&(i.querySelector("[".concat("default-hovercard","]"))||o>0))return i.addEventListener("mouseenter",t),function(){i.removeEventListener("mouseenter",t)}},[e.rootRef.current,n,e.customFormatter]);var r=i.useCallback(function(){var t=new E.Qos({name:"CFDefaultCards"});return function(n){var a=n?{resultType:w.ResultTypeEnum.Failure,error:n.message,extraData:{stack:n.stack,name:n.name,itemData:e.item}}:{resultType:w.ResultTypeEnum.Success};t.end(a)}},[]),o=0,s=e.rootRef.current;return s&&n&&n===e.customFormatter?i.createElement(O.e,{componentName:"CFDefaultCards",onError:r},i.createElement(x.e,null,function(t){var n=t.itemCache,a=e.item,r=e.itemKey,c=e.forFieldRenderer,d=e.schema,l=s.parentElement||s,u=Object(C.e)(n,{item:a,itemKey:r,forFieldRenderer:c,schema:d,target:s,parent:l});return o=u.length,i.createElement(i.Fragment,null,u)})):null}var L=n("vDLL"),k=n("iODI"),M=n("SAeL"),P=n("EOEZ"),T=n("mCCr"),U=n("O/6m"),F=n("b+Rj"),H=n("nOpQ"),R=n("/3Dy"),N=n("Pe+L"),B=n("oCyF"),j=n("gBvU"),V="[data-iscustomformatter=true][data-actionname]",z=Object(k.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e(0),n.e(21),n.e(6),n.e(15),n.e(47)]).then(n.bind(null,"NxGm"))];case 1:return[2,e.sent().ItemOpenApprovalDialogAction]}})})}),G=function(e){function t(n){var r=e.call(this,n)||this;return r._onActionsUpdated=function(e){r._actions=e.actions},r._actionKeyPressHandler=function(e){var t=e;"Enter"!==t.code&&"Spacebar"!==t.code||r._actionClickHandler(t)},r._actionClickHandler=function(e){var t=e.currentTarget,n=Object(y.e)(t),a=n.actionKey,i=n.actionParams,o=n.actionPath,s=n.actionName,c=r._actions[a],d=new E.Qos({name:"CustomFormatter."+s}),l={actionParams:i,actionPath:o};c&&c.isAvailable&&!c.executingCount?c.execute({event:e}).then(function(){d.end({resultType:E.ResultTypeEnum.Success})}).catch(function(e){var t;if(e)if("string"==typeof e)t=new U.e({code:"OtherError.ErrorAsString",message:e});else if(e.hasOwnProperty("resultCode")||e.hasOwnProperty("resultType")){var n=e,a=n.resultCode,i=n.resultType;t=new U.e({code:"KnownError."+a,message:"CustomActionFailure: "+a,isExpected:i===E.ResultTypeEnum.ExpectedFailure})}else t=e;else t=new U.e({code:"UnkownError.NoErrorThrown",message:""});d.end(Object(T.e)(t))}):d.end({resultType:E.ResultTypeEnum.ExpectedFailure,error:"Action not available",extraData:l})},r._setupListeners=function(e){void 0===e&&(e=!1);var t=r._rootRef&&r._rootRef.current,n=e?"removeEventListener":"addEventListener",a=function(e){var t=e.currentTarget;""!==t.getAttribute("src")&&(t.src="")};t&&([].forEach.call(t.querySelectorAll(V),function(e){e[n]("click",r._actionClickHandler),e.getAttribute("data-inline-edit")&&e[n]("keydown",r._actionKeyPressHandler)}),[].forEach.call(t.querySelectorAll("img[data-iscustomformatterthumbnail=true]"),function(e){e[n]("error",a)}))},r._validateDeferredImageUrls=function(){var e=r.props,t=e.itemCacheDispatch,n=e.itemSetKey,a=e.itemKey,i=e.features;if(i&&i.validateImgUrls&&r._rootRef.current){var o=r._rootRef.current.querySelectorAll("img[data-untrusted-src]");if(!o||0===o.length)return;var s=N.e.matches(n)?N.e.deserialize(n).webAbsoluteUrl:"";s||(s=B.e.matches(a)?B.e.deserialize(a).webAbsoluteUrl:"");var c=H.e.serialize({webAbsoluteUrl:s});t(Object(F.e)(function(e){return e.demandItemFacet(R.e,c)})).then(function(e){e&&Object(j.e)(e,o)})}},r._onRenderContent=function(e){return i.createElement(t,Object(a.__assign)({},r.props,{customFormatter:e}))},r._rootRef=i.createRef(),r._actions={},r._cfError="",r}return Object(a.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.item!==e.item||this.props.customFormatter!==e.customFormatter||this.props.layoutType!==e.layoutType||this.props.isSelected!==e.isSelected},t.prototype.render=function(){var e=this.props,t=e.itemKey,n=e.itemSetKey,c=e.item,d=e.layoutType,l=e.customFormatter,u=e.features,f=e.rowIndex,p=e.forFieldRenderer,m=e.schema,g=e.isRecordVersionngFlightOn,v=e.currentField,y=e.thumbnails,S=e.pageContextInfo,D=e.itemCacheDispatch,x=e.fieldMetaData,C=e.filePreviewOptions,O=e.isSelected;if(!c)return null;var w=p?d&&d===h.e?_.n:_.t:d===b.e?_.a:void 0,E=function(e,t,n){return e.group||e.columnAggregate?e:Object(o.n)(e,t,n)}(c,m,!!g),L=M.i(),k={pageContextInfo:S,features:u,fieldRendererFormat:l,row:E,rowIndex:f,isSelected:!!O,fieldMetaData:x,currentFieldName:v,rowSchema:m,errorStrings:{},thumbnails:y,filePreviewOptions:C},T=new r.e(k),U=T&&T.evaluate(),F=M.i()-L;return P.t.add(F),this._cfError=T.errors(),U?i.createElement(s.a,{actions:K(Object(a.__assign)({itemKey:t,itemSetKey:n,rootRef:this._rootRef,html:U},k)),onActionsUpdated:this._onActionsUpdated},i.createElement("div",{className:w,dangerouslySetInnerHTML:{__html:U},ref:this._rootRef}),i.createElement(I,{rootRef:this._rootRef,customFormatter:l,onRenderContent:this._onRenderContent,itemCacheDispatch:D}),i.createElement(A,Object(a.__assign)({},this.props,{rootRef:this._rootRef}))):null},t.prototype.componentDidMount=function(){var e=M.i(),t=this.props,n=t.schema,a=t.currentField,i=t.customFormatter,r=t.rowIndex,o=t.forFieldRenderer,s=t.onMountEngagement,c=t.qosEvent;o&&0===r&&(this._log({name:"CustomFormatterField.".concat(n&&n[a]),extraData:{templateId:i.templateId},isIntentional:!0}),W(i)&&this._log({name:"FormatterReferenceField",isIntentional:!0})),s&&this._log(s),this._cfError&&c&&c({errorString:this._cfError}),this._setupListeners(),this._validateDeferredImageUrls();var d=M.i()-e;P.a.add(d)},t.prototype.componentDidUpdate=function(e){var t=M.i();this._setupListeners(),this._validateDeferredImageUrls();var n=M.i()-t;P.a.add(n)},t.prototype.componentWillUnmount=function(){this._setupListeners(!0)},t.prototype._log=function(e){(0,this.props.itemCacheDispatch)(Object(g.e)(e))},t}(i.Component);function K(e){var t=e.itemKey,n=e.itemSetKey,r=e.html,o={},s=(new DOMParser).parseFromString(r,"text/html");return[V].forEach(function(r){var _,h=s.querySelectorAll(r);if(h&&h.length)for(var b=0;b<h.length;b++){var g=Object(y.e)(h[b]),v=g.actionKey,S=g.actionName,D=g.actionParams,I=g.actionPath;if("defaultClick"===S)o[v]=i.createElement(c.e,{itemKey:t});else if("share"===S)o[v]=i.createElement(d.ItemShareAction,{itemKeys:[t]});else if("delete"===S)o[v]=i.createElement(l.ItemDeleteAction,{itemKeys:[t]});else if("editProps"===S)o[v]=i.createElement(u.e,{itemKey:t});else if("executeFlow"===S)o[v]=i.createElement(f.ItemExecuteFlowAction,{itemKey:t,actionParam:D||"",noCache:!0});else if("openContextMenu"===S)o[v]=i.createElement(p.e,{itemKey:t});else if("inlineEdit"===S){var x=String(h[b].getAttribute("data-inline-edit")||"").split(".")[0];x&&(o[v]=i.createElement(m.e,Object(a.__assign)({},{item:e.row,itemKey:t,itemSetKey:n||"",pageContextInfo:e.pageContextInfo,fieldInternalName:x,fieldType:null===(_=e.rowSchema)||void 0===_?void 0:_[x]})))}else if("setValue"===S){var C=h[b].getAttribute("data-foreach-row");if(C)try{e=Object(a.__assign)(Object(a.__assign)({},e),{row:Object(a.__assign)(Object(a.__assign)({},e.row),JSON.parse(unescape(C)))})}catch(e){}o[v]=i.createElement(L.e,{itemKey:t,itemSetKey:n||"",actionPath:I,customFormatterParams:e})}else"openApprovalDialog"===S&&(o[v]=i.createElement(z,{itemKeys:[t]}))}}),o}function W(e){if(e.columnFormatterReference)return!0;if(e.children)for(var t=e.children,n=0;n<t.length;n++)if(W(t[n]))return!0;return!1}},gAbP:function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.hover=0]="hover",e[e.hotKey=1]="hotKey"}(a||(a={})),function(e){e.plain="PlainCard",e.expanding="ExpandingCard"}(i||(i={}))},gBvU:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("K9kD");function r(e,t){var n=this;void 0!==t&&t.forEach(function(t){return Object(a.__awaiter)(n,void 0,void 0,function(){var n,r,o,s;return Object(a.__generator)(this,function(a){return n=t.getAttribute("data-untrusted-src")||"",r=new i.Uri(n).getHost(),e&&e.allowEmbedding&&0!==e.allowEmbedding?(o=2===e.allowEmbedding,2!==e.allowEmbedding&&(s=e.allowedDomains,o=!!s&&!!s.length&&!!s.some(function(e){return r.toLowerCase().endsWith(e.toLowerCase())})),o&&(t.setAttribute("src",n),t.removeAttribute("data-untrusted-src")),[2]):[2]})})})}},lIQt:function(e,t,n){"use strict";n.r(t),n.d(t,"customFormatterEvalExp",function(){return M}),n.d(t,"ColumnFormatterRenderer",function(){return T}),n.d(t,"CustomRowRenderer",function(){return U}),n.d(t,"CustomGroupHeaderRenderer",function(){return F}),n.d(t,"CustomFooterRenderer",function(){return H}),n.d(t,"CustomTileRenderer",function(){return R}),n.d(t,"tileDesigner",function(){return N}),n.d(t,"getCustomFormatterSchemaFromColumns",function(){return B}),n.d(t,"mapColumnNameToColumnCustomFormatter",function(){return j});var a=n("17wl"),i=n("cDcd"),r=n("MQWL"),o=n("yxtM"),s=n("Og92"),c=n("XIjh"),d=n("yhDP"),l=n("K9kD"),u=n("PeVo"),f=n("cEcs"),p=n("T2DP"),m=n("Yc8h"),_=n("dyvu"),h=n("x89N"),b=n("q+Aq"),g=n("J1xc"),v=n("EOEZ"),y=n("IVmb"),S=n("oCyF"),D=n("oveG"),I=n("aW/l"),x=n("o7xM"),C={ODB:1261},O={ODB:60024},w={ODB:60136},E="Title";function A(e,t){var n,a=performance.now(),i=t.itemKey,o=t.itemSetKey,s=t.rowIndex,d=t.customFormatter,l=t.currentFieldName,u=t.forFieldRenderer,f=t.schema,p=t.fieldMetaData,m=t.onMountEngagement,_=t.qosEvent,g=t.isSelected,A=e.demandItem({key:S.e,rowData:D.yt},i),L=Object(r.e)(e,o||i),k=Object(I.e)(e).itemsScopeItemKey,M=Object(x.e)(e,{itemsScopeItemKey:k}),P=Object(c.e)(e,{feature:C,pageContext:L}),T=Object(c.e)(e,{feature:O,pageContext:L}),U=Object(c.e)(e,{feature:w,pageContext:L}),F=A&&A.rowData;n={rowIndex:s,isSelected:!!g,customFormatter:d,item:F,isRecordVersionngFlightOn:P,itemKey:i,itemSetKey:o,currentField:l||E,schema:f||Object(h.o)({itemCache:e,itemSetKey:o}),forFieldRenderer:u,pageContextInfo:L,layoutType:M,itemCacheDispatch:e.dispatch,features:{filePreviewWithFallback:T,validateImgUrls:U},fieldMetaData:p||Object(h.s)(e,o,i,F&&F.ContentTypeId),onMountEngagement:m,qosEvent:_};var H=Object(b.e)(e,i,n);if(T){var R={fileTypeIconOptions:Object(b.n)(e,i),brandTypeIconOptions:Object(b.t)(e,i),getFileTypeIconHtml:y.e};H?H.filePreviewOptions=R:n.filePreviewOptions=R}var N=Math.round(performance.now()-a);return v.n.add(N),H||n}var L=n("2BHO"),k=l.Killswitch.isActivated("297A1C78-A2E3-46C9-9B1C-F91C8DF760CC","3/29/2023","Update aria-label after gallery render for a11y reasons");function M(e,t){var n=performance.now(),i=t.itemKey,s=t.itemSetKey,d=t.rowIndex,l=t.expression,u=t.isSelected,f=A(e,{itemKey:i,customFormatter:{},itemSetKey:s,rowIndex:d,forFieldRenderer:!1});if(f){var p={rowIndex:f.rowIndex,isSelected:!!u,fieldRendererFormat:{},row:f.item,currentFieldName:E,rowSchema:f.schema,errorStrings:{},pageContextInfo:f.pageContextInfo},m=Object(r.e)(e,s||i),_=Object(b.e)(e,i,p),h=Object(c.e)(e,{feature:O,pageContext:m})&&Object(a.__assign)(Object(a.__assign)({},_||p),{filePreviewOptions:{fileTypeIconOptions:Object(b.n)(e,i),brandTypeIconOptions:Object(b.t)(e,i),getFileTypeIconHtml:y.e}}),g=new o.e(h||_||p).evalExpression(l),S=performance.now()-n;return v.e.add(S),g}return""}var P=i.memo(Object(g.t)(v.i)(u.e)),T=Object(s.t)(function(e,t){var n=t.fieldName,a=t.customFormatter,i=t.itemSetKey,r=t.isSelected;return a?A(e,{itemKey:t.itemKey,rowIndex:t.rowIndex,customFormatter:a,currentFieldName:n,forFieldRenderer:!0,isSelected:!!r,itemSetKey:i}):{}})(P),U=Object(s.t)(function(e,t){return A(e,{itemKey:t.itemKey,rowIndex:t.rowIndex,itemSetKey:t.itemSetKey,customFormatter:t.formatter,forFieldRenderer:!1,isSelected:!!t.isSelected})})(P),F=Object(s.t)(function(e,t){var n,a=t.item,i=t.itemKey,r=void 0===i?"":i,o=t.rowIndex,s=A(e,{itemKey:r,rowIndex:void 0!==o?o:-1,itemSetKey:t.itemSetKey,customFormatter:t.formatter,forFieldRenderer:!1,currentFieldName:t.groupFieldName,schema:t.schema,fieldMetaData:t.fieldMetaData,isSelected:!!t.isSelected});return 0===o&&(n={name:"CustomGroupHeaderRenderer.Mount",isIntentional:!1,extraData:{layoutType:s.layoutType&&s.layoutType.name}}),s.item=a,s.onMountEngagement=n,s})(P),H=Object(s.t)(function(e,t){var n=t.item,a=t.itemKey,i=A(e,{itemKey:void 0===a?"":a,rowIndex:-1,itemSetKey:t.itemSetKey,customFormatter:t.formatter,forFieldRenderer:!1,isSelected:!!t.isSelected}),r={name:"CustomFooterRenderer.Mount",isIntentional:!1,extraData:{layoutType:i.layoutType&&i.layoutType.name}};return i.item=n,i.onMountEngagement=r,i})(P),R=Object(s.t)(function(e,t){var n=t.itemKey,a=t.itemSetKey,i=t.rowIndex,r=t.formatter,o=t.qosEvent,s=t.isSelected,c=function(e){var t,n;if(e&&(e.style||(e.style={}),e.style.height=e.style.height||"100%",e.style.overflow=e.style.overflow||"hidden",e.style["box-sizing"]=e.style["box-sizing"]||"border-box",!k&&e.attributes&&(null===(t=e.children)||void 0===t?void 0:t.length))){var a=e.children[0].customRowAction;(null===(n=e.children[0])||void 0===n?void 0:n.attributes)&&a&&("defaultClick"===a.action||"editProps"===a.action)&&(e.children[0].attributes["aria-label"]=L.e,e.children[0].attributes.role="button")}return e}(r);return A(e,{itemKey:n,rowIndex:i,itemSetKey:a,customFormatter:c,forFieldRenderer:!1,qosEvent:o,isSelected:!!s})})(P),N={defaultCardDimensions:_.i,topPreviewEligibleCols:_._,createDefaultTileProps:f.e,createJSONFromConfig:f.t,generateInitialTileDesignerConfig:f.a,decodeTileDesignerConfig:p.n,encodeTileDesignerConfig:f.n,encodeTileDesignerConfigForDocLib:m.t,shouldExcludeColumnInCards:p.d};function B(e){void 0===e&&(e=[]);for(var t={},n=0,a=e;n<a.length;n++){var i=a[n],r=i.internalName,o=i.mappedColumnFieldType,s=i.RealFieldName,c=i.FieldType;r&&c&&(r===h.n&&(t[h.t]=h.r),r===h.e?t[h.e]=h.e:r===h.a?t[h.a]=h.i:t[s||r]=void 0!==o&&d.e[o]||c)}return t}function j(e){void 0===e&&(e=[]);for(var t={},n=0,a=e;n<a.length;n++){var i=a[n];if(i.RealFieldName&&i.CustomFormatter)try{t[i.RealFieldName]=JSON.parse(i.CustomFormatter)}catch(e){}}return t}},nSuX:function(e,t,n){"use strict";n.d(t,"e",function(){return y});var a,i=n("5pbq"),r={host:"ms-HoverCard-host"},o=n("17wl"),s=n("cDcd"),c=n("gAbP"),d={root:"ms-ExpandingCard-root",compactCard:"ms-ExpandingCard-compactCard",expandedCard:"ms-ExpandingCard-expandedCard",expandedCardScroll:"ms-ExpandingCard-expandedCardScrollRegion"};!function(e){e[e.compact=0]="compact",e[e.expanded=1]="expanded"}(a||(a={}));var l=function(e){var t=e.gapSpace,n=void 0===t?0:t,a=e.directionalHint,r=void 0===a?i.DirectionalHint.bottomLeftEdge:a,c=e.directionalHintFixed,d=e.targetElement,l=e.firstFocus,u=e.trapFocus,f=e.onLeave,p=e.className,m=e.finalHeight,_=e.content,h=e.calloutProps,b=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},Object(i.getNativeProps)(e,i.divProperties)),{className:p,target:d,isBeakVisible:!1,directionalHint:r,directionalHintFixed:c,finalHeight:m,minPagePadding:24,onDismiss:f,gapSpace:n}),h);return s.createElement(s.Fragment,null,u?s.createElement(i.FocusTrapCallout,Object(o.__assign)({},b,{focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!l}}),_):s.createElement(i.Callout,Object(o.__assign)({},b),_))},u=Object(i.classNamesFunction)(),f=function(e){function t(t){var n=e.call(this,t)||this;return n._expandedElem=s.createRef(),n._onKeyDown=function(e){e.which===i.KeyCodes.escape&&n.props.onLeave&&n.props.onLeave(e)},n._onRenderCompactCard=function(){return s.createElement("div",{className:n._classNames.compactCard},n.props.onRenderCompactCard(n.props.renderData))},n._onRenderExpandedCard=function(){return!n.state.firstFrameRendered&&n._async.requestAnimationFrame(function(){n.setState({firstFrameRendered:!0})}),s.createElement("div",{className:n._classNames.expandedCard,ref:n._expandedElem},s.createElement("div",{className:n._classNames.expandedCardScroll},n.props.onRenderExpandedCard&&n.props.onRenderExpandedCard(n.props.renderData)))},n._checkNeedsScroll=function(){var e=n.props.expandedCardHeight;n._async.requestAnimationFrame(function(){n._expandedElem.current&&n._expandedElem.current.scrollHeight>=e&&n.setState({needsScroll:!0})})},n._async=new i.Async(n),Object(i.initializeComponentRef)(n),n.state={firstFrameRendered:!1,needsScroll:!1},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this._checkNeedsScroll()},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=this.props,t=e.styles,n=e.compactCardHeight,i=e.expandedCardHeight,r=e.theme,c=e.mode,d=e.className,f=this.state,p=f.needsScroll,m=f.firstFrameRendered,_=n+i;this._classNames=u(t,{theme:r,compactCardHeight:n,className:d,expandedCardHeight:i,needsScroll:p,expandedCardFirstFrameRendered:c===a.expanded&&m});var h=s.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this._onRenderCompactCard(),this._onRenderExpandedCard());return s.createElement(l,Object(o.__assign)({},this.props,{content:h,finalHeight:_,className:this._classNames.root}))},t.defaultProps={compactCardHeight:156,expandedCardHeight:384,directionalHintFixed:!0},t}(s.Component),p=Object(i.styled)(f,function(e){var t,n=e.theme,a=e.needsScroll,r=e.expandedCardFirstFrameRendered,o=e.compactCardHeight,s=e.expandedCardHeight,c=e.className,l=n.palette,u=Object(i.getGlobalClassNames)(d,n);return{root:[u.root,{width:320,pointerEvents:"none",selectors:(t={},t[i.HighContrastSelector]={border:"1px solid WindowText"},t)},c],compactCard:[u.compactCard,{pointerEvents:"auto",position:"relative",height:o}],expandedCard:[u.expandedCard,{height:1,overflowY:"hidden",pointerEvents:"auto",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)",selectors:{":before":{content:'""',position:"relative",display:"block",top:0,left:24,width:272,height:1,backgroundColor:l.neutralLighter}}},r&&{height:s}],expandedCardScroll:[u.expandedCardScroll,a&&{height:"100%",boxSizing:"border-box",overflowY:"auto"}]}},void 0,{scope:"ExpandingCard"}),m={root:"ms-PlainCard-root"},_=Object(i.classNamesFunction)(),h=function(e){function t(t){var n=e.call(this,t)||this;return n._onKeyDown=function(e){e.which===i.KeyCodes.escape&&n.props.onLeave&&n.props.onLeave(e)},Object(i.initializeComponentRef)(n),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme,a=e.className;this._classNames=_(t,{theme:n,className:a});var i=s.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this.props.onRenderPlainCard(this.props.renderData));return s.createElement(l,Object(o.__assign)({},this.props,{content:i,className:this._classNames.root}))},t}(s.Component),b=Object(i.styled)(h,function(e){var t,n=e.theme,a=e.className;return{root:[Object(i.getGlobalClassNames)(m,n).root,{pointerEvents:"auto",selectors:(t={},t[i.HighContrastSelector]={border:"1px solid WindowText"},t)},a]}},void 0,{scope:"PlainCard"}),g=Object(i.classNamesFunction)(),v=function(e){function t(t){var n=e.call(this,t)||this;return n._hoverCard=s.createRef(),n.dismiss=function(e){n._async.clearTimeout(n._openTimerId),n._async.clearTimeout(n._dismissTimerId),e?n._dismissTimerId=n._async.setTimeout(function(){n._setDismissedState()},n.props.cardDismissDelay):n._setDismissedState()},n._cardOpen=function(e){n._shouldBlockHoverCard()||"keydown"===e.type&&e.which!==n.props.openHotKey||(n._async.clearTimeout(n._dismissTimerId),"mouseenter"===e.type&&(n._currentMouseTarget=e.currentTarget),n._executeCardOpen(e))},n._executeCardOpen=function(e){n._async.clearTimeout(n._openTimerId),n._openTimerId=n._async.setTimeout(function(){n.setState(function(t){return t.isHoverCardVisible?t:{isHoverCardVisible:!0,mode:a.compact,openMode:"keydown"===e.type?c.t.hotKey:c.t.hover}})},n.props.cardOpenDelay)},n._cardDismiss=function(e,t){if(e){if(!(t instanceof MouseEvent))return;if("keydown"===t.type&&t.which!==i.KeyCodes.escape)return;n.props.sticky||n._currentMouseTarget!==t.currentTarget&&t.which!==i.KeyCodes.escape||n.dismiss(!0)}else{if(n.props.sticky&&!(t instanceof MouseEvent)&&t.nativeEvent instanceof MouseEvent&&"mouseleave"===t.type)return;n.dismiss(!0)}},n._setDismissedState=function(){n.setState({isHoverCardVisible:!1,mode:a.compact,openMode:c.t.hover})},n._instantOpenAsExpanded=function(e){n._async.clearTimeout(n._dismissTimerId),n.setState(function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:a.expanded}})},n._setEventListeners=function(){var e=n.props,t=e.trapFocus,a=e.instantOpenOnClick,i=e.eventListenerTarget,r=i?n._getTargetElement(i):n._getTargetElement(n.props.target),o=n._nativeDismissEvent;r&&(n._events.on(r,"mouseenter",n._cardOpen),n._events.on(r,"mouseleave",o),t?n._events.on(r,"keydown",n._cardOpen):(n._events.on(r,"focus",n._cardOpen),n._events.on(r,"blur",o)),a?n._events.on(r,"click",n._instantOpenAsExpanded):(n._events.on(r,"mousedown",o),n._events.on(r,"keydown",o)))},Object(i.initializeComponentRef)(n),n._async=new i.Async(n),n._events=new i.EventGroup(n),n._nativeDismissEvent=n._cardDismiss.bind(n,!0),n._childDismissEvent=n._cardDismiss.bind(n,!1),n.state={isHoverCardVisible:!1,mode:a.compact,openMode:c.t.hover},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this._setEventListeners()},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.componentDidUpdate=function(e,t){var n=this;e.target!==this.props.target&&(this._events.off(),this._setEventListeners()),t.isHoverCardVisible!==this.state.isHoverCardVisible&&(this.state.isHoverCardVisible?(this._async.setTimeout(function(){n.setState({mode:a.expanded},function(){n.props.onCardExpand&&n.props.onCardExpand()})},this.props.expandedCardOpenDelay),this.props.onCardVisible&&this.props.onCardVisible()):(this.setState({mode:a.compact}),this.props.onCardHide&&this.props.onCardHide()))},t.prototype.render=function(){var e=this.props,t=e.expandingCardProps,n=e.children,a=e.id,r=e.setAriaDescribedBy,d=void 0===r||r,l=e.styles,u=e.theme,f=e.className,m=e.type,_=e.plainCardProps,h=e.trapFocus,v=e.setInitialFocus,y=this.state,S=y.isHoverCardVisible,D=y.mode,I=y.openMode,x=a||Object(i.getId)("hoverCard");this._classNames=g(l,{theme:u,className:f});var C=Object(o.__assign)(Object(o.__assign)({},Object(i.getNativeProps)(this.props,i.divProperties)),{id:x,trapFocus:!!h,firstFocus:v||I===c.t.hotKey,targetElement:this._getTargetElement(this.props.target),onEnter:this._cardOpen,onLeave:this._childDismissEvent}),O=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},t),C),{mode:D}),w=Object(o.__assign)(Object(o.__assign)({},_),C);return s.createElement("div",{className:this._classNames.host,ref:this._hoverCard,"aria-describedby":d&&S?x:void 0,"data-is-focusable":!this.props.target},n,S&&(m===c.e.expanding?s.createElement(p,Object(o.__assign)({},O)):s.createElement(b,Object(o.__assign)({},w))))},t.prototype._getTargetElement=function(e){switch(typeof e){case"string":return Object(i.getDocument)().querySelector(e);case"object":return e;default:return this._hoverCard.current||void 0}},t.prototype._shouldBlockHoverCard=function(){return!(!this.props.shouldBlockHoverCard||!this.props.shouldBlockHoverCard())},t.defaultProps={cardOpenDelay:500,cardDismissDelay:100,expandedCardOpenDelay:1500,instantOpenOnClick:!1,setInitialFocus:!1,openHotKey:i.KeyCodes.c,type:c.e.expanding},t}(s.Component),y=Object(i.styled)(v,function(e){var t=e.className,n=e.theme;return{host:[Object(i.getGlobalClassNames)(r,n).host,t]}},void 0,{scope:"HoverCard"})}}]);