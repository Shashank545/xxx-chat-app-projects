(window.webpackJsonp_4ec0946ccf7b5264836bb62352873336=window.webpackJsonp_4ec0946ccf7b5264836bb62352873336||[]).push([[0],{"+f+R":function(e,t,n){"use strict";var a=n("17wl"),i=n("K9kD"),r=n("WIMm"),o=n("dq6a"),s=n("myym"),c=n("AfXp"),d=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._apiUrlHelper=i,a._itemUrlHelper=r,a}return Object(a.__extends)(t,e),t.prototype.isAdvancedRecordVersioningDisabled=function(){return this.dataRequestor.getData({url:this._buildRecordVersioningUrl(),qosName:"GetAdvancedRecordVersioningDisabled",method:"GET"}).then(function(e){return!!(e&&e.d&&e.d.GetAdvancedRecordVersioningDisabled)&&e.d.GetAdvancedRecordVersioningDisabled},function(e){return i.Promise.wrapError(e)})},t.prototype.getAvailableTagsForSite=function(){var e=this;return this.dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return i.Promise.wrapError(c.GetAvailableTagsForSiteFailed)})},t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length)return r.e.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n}),i.Promise.wrap([]);var a=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this.dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:a,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return i.Promise.wrapError(e)})},t.prototype.updateComplianceTag=function(e,t){var n="SetComplianceTag",a=t.blockEdit||t.blockDelete,r=t.blockEdit,o=t.isEventTag,s=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:a,isTagPolicyRecord:r,isEventBasedTag:o,isTagSuperLock:t.superLock,isUnlockedAsDefault:t.unlockedAsDefault});return this.dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,n),qosName:n,additionalPostData:s,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return i.Promise.wrapError(e)})},t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return s.s(t)}return!1},function(e){return i.Promise.wrapError(e)})},t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this.dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return s.s(t)}return!1},function(e){return i.Promise.wrapError(e)})},t.prototype._buildRecordVersioningUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAdvancedRecordVersioningDisabled",{}).toString()},t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()},t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()},t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:c.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:c.NoneComplianceTagDescription,tagTooltip:c.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1,tagId:"",unlockedAsDefault:!1};t.push(n);for(var a=0,i=e;a<i.length;a++){var r=i[a],o=s.a(r),d=s.i(r),l={tagName:r.TagName,tagValue:r.TagName,blockDelete:r.BlockDelete,blockEdit:!!r.BlockEdit,tagDescription:o,tagTooltip:d,hasRetentionAction:r.HasRetentionAction,autoDelete:r.AutoDelete,isEventTag:r.IsEventTag,reviewerEmail:r.ReviewerEmail,notes:r.Notes,displayName:r.DisplayName,superLock:r.SuperLock,tagId:r.TagId,unlockedAsDefault:r.UnlockedAsDefault};t.push(l)}return t},t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()},t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()},t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()},t}(o.e),l=n("h/Eh"),u=n("xkft"),f=function(){function e(e){var t=new u.e({},{pageContext:e.pageContext}),n=new l.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this._dataSource=new d({apiUrlHelper:n,itemUrlHelper:t},a)}return e.prototype.isAdvancedRecordVersioningDisabled=function(){return this._dataSource.isAdvancedRecordVersioningDisabled()},e.prototype.getAvailableTagsForSite=function(){return this._cachedTagsPromise||(this._cachedTagsPromise=this._dataSource.getAvailableTagsForSite()),this._cachedTagsPromise},e.prototype.updateComplianceTag=function(e,t){return this._dataSource.updateComplianceTag(e,t)},e.prototype.updateComplianceTagInBatch=function(e,t,n){return this._dataSource.updateComplianceTagInBatch(e,t,n)},e.prototype.unlockRecord=function(e,t){return this._dataSource.unlockRecord(e,t)},e.prototype.lockRecord=function(e,t){return this._dataSource.lockRecord(e,t)},e.prototype.hasComplianceTags=function(){return this.getAvailableTagsForSite().then(function(e){return!!(e&&e.length>1)})},e}();t.e=f},"3HEj":function(e,t,n){"use strict";n.d(t,"t",function(){return f}),n.d(t,"e",function(){return p});var a={};n.r(a),n.d(a,"Default",function(){return o}),n.d(a,"Tenant",function(){return s}),n.d(a,"Hub",function(){return c}),n.d(a,"Site",function(){return d});var i,r=n("K9kD"),o=0,s=1,c=2,d=3,l=r.Killswitch.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),u="undefined"!=typeof window&&r.FeatureOverrides.isFeatureEnabled({ODB:1737});function f(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl,a=e.isSiteListsHost;return"/"===n||""===n||!l&&a||u&&(null==e?void 0:e.isUnifiedAdminUrl)?t:t.substring(0,t.lastIndexOf(n))}function p(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(i||(i={}))},"6HcZ":function(e,t,n){"use strict";var a,i;n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),function(e){e[e.fail=0]="fail",e[e.partialSuccess=1]="partialSuccess",e[e.success=2]="success"}(a||(a={})),function(e){e[e.pending=0]="pending",e[e.success=1]="success"}(i||(i={}))},"6czb":function(e,t,n){var a=n("K9kD");e.exports=a.SingleEventBase},"7Xy9":function(e,t,n){"use strict";n.d(t,"e",function(){return Y});var a,i=n("17wl"),r=n("K9kD"),o=n("ftiL"),s=n("boye"),c=n("9kMg"),d=n("y88i"),l=n("PSxD"),u=n("GPRH"),f=n("yhDP"),p=n("h4x6"),m=!r.Killswitch.isActivated("5428C17B-A89D-4E63-A1C5-B3E989C1B7A3","8/21/2023","Remove color tag from edit view columns"),_=((a={})[u.t.icon]={key:"type",index:0,isVisibleMobile:!0,isCollapsable:!1,type:f.e.FileIcon},a[u.t.name]={key:"name",index:1,isRowHeader:!0,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.e.nameMin,width:u.e.nameODB,type:f.e.Name},a[u.t.title]={key:"Title",index:1,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.e.nameMin,width:u.e.nameODB,type:f.e.Title},a[u.t.shareHeroCommand]={key:"_shareHeroCommand",index:2,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:f.e.ShareCommand},a[u.t.calloutInvoker]={key:"_calloutInvoker",index:3,isVisibleMobile:!1,isCollapsable:!0,minWidth:16,width:18,type:f.e.DotDotDot},a[u.t.modified]={key:"dateModified",index:4,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.e.regularMin,width:u.e.regular,type:f.e.DateTime,sortDescFirst:!0},a[u.t.url]={key:"URL",index:5,isVisibleMobile:!0,isCollapsable:!1,minWidth:u.e.nameMin,width:u.e.nameODB,type:f.e.Hyperlink},a),h=Object(i.__spreadArray)(["_ip_UnifiedCompliancePolicyUIAction","_CommentFlags","_CommentCount","Edit","MediaServiceFastMetadata","MediaServiceTranscript","name.FileSystemItemId","SMTotalFileCount","SMTotalSize"],m?["_ColorTag"]:[],!0),b=h.concat(["FolderChildCount","ItemChildCount"]),g=[f.e.Text,f.e.Name,f.e.Title,f.e.DateTime,f.e.Number];function v(e){switch(e){case"FSObjType":case"DocIcon":return u.t.icon;case"LinkFilename":case"LinkFilenameNoMenu":case"FileLeafRef":case"LinkIssueIDNoMenu":return u.t.name;case"LinkTitle":case"LinkTitleNoMenu":case"Title":return u.t.title;case"_calloutInvoker":return u.t.calloutInvoker;case"_shareHeroCommand":return u.t.shareHeroCommand;case"Modified":return u.t.modified;case"URLwMenu":case"URLNoMenu":return u.t.url;default:return u.t.none}}function y(e,t,n,a,i,r){var o=e.Name,m=t?t.type:Object(p.e)(e),_=!!t&&"type"===t.key,h=g.indexOf(m)>-1,b=n.filterParams||"",v=!!Object(s.e)(b,o);if(!v&&r&&r.additionalFiltersXml&&(v=!!r.additionalFiltersXml.match(new RegExp('FieldRef Name="'+o+'"'))),n.viewXmlForRequest)try{var y=l.e(n.viewXmlForRequest);y&&y.where&&1===y.where.querySelectorAll('[id="'.concat(o,'"]')).length&&(v=!0)}catch(e){}var C={key:t?t.key:o,name:e.DisplayName,internalName:o,staticName:e.StaticName,fieldType:m,width:u.e.regular,minWidth:u.e.regularMin,isVisible:!0,isVisibleMobile:!t||t.isVisibleMobile,isCollapsable:!t||t.isCollapsable,canAutoResize:h,isIcon:_,resizable:!0,isRowHeader:!!t&&t.isRowHeader,sortable:"FALSE"!==e.Sortable,filterable:!("FALSE"===e.Filterable||"TRUE"===e.FilterDisable||"Note"===e.FieldType||"URL"===e.FieldType||"FileSizeDisplay"===o||"_IsRecord"===o),groupable:"FALSE"!==e.Groupable&&"FALSE"!==e.Sortable&&x(o,m),editable:!(e.FromBaseType&&"TRUE"===e.FromBaseType),isSealed:"TRUE"===e.Sealed,isGrouped:n.groupByOverride===o||i.group1===o||i.group2===o,isSorted:n.sortField===o,isAscending:n.sortField!==o||"true"===n.isAscending,sortDescFirst:!!t&&!!t.sortDescFirst,isFiltered:v,filterValues:Object(s.n)(b,o),isRequired:!!e.Required,isAutoHyperLink:t?a.serverSupportsAutoHyperLink:!!e.AutoHyperLink&&a.serverSupportsAutoHyperLink||m===f.e.Note&&"FALSE"!==e.RichText,isAppendOnly:e.AppendOnly&&"TRUE"===e.AppendOnly,choices:e.Choices,dispFormUrl:e.DispFormUrl,allowGridEditing:e.AllowGridEditing,pinnedToFiltersPane:e.PinnedToFiltersPane&&"TRUE"===e.PinnedToFiltersPane,showInFiltersPane:e.ShowInFiltersPane&&u.a[e.ShowInFiltersPane],clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,customFormatter:e.CustomFormatter,serverFieldType:e.Type,resultType:e.ResultType,isCalculated:"Calculated"===e.role,isNote:m===f.e.Note&&"FALSE"===e.RichText,clientSideColumnAdapter:e.ClientSideColumnAdapter,sspId:e.SspId,termSetId:e.TermSetId,anchorId:e.AnchorId,realFieldName:e.RealFieldName,hasListItemMenu:"TRUE"===e.listItemMenu,linkToItem:!!e.LinkToItem,isLink:"URLwMenu"===e.Name&&n.listTemplateType===c.e.links,richText:e.RichText,renderAsText:"TRUE"===e.RenderAsText};return e.ID&&(C.id=e.ID),t&&(C.minWidth=_?I(a.useCustomColumn):t.minWidth,C.width=_?D(a.useCustomColumn):t.width),m===f.e.SharedWith?C.width=u.e.sharedWith:m===f.e.Note?C.width=u.e.note:m===f.e.AverageRating?C.minWidth=u.e.ratingsMin:m===f.e.DateTime&&(C.getValue=function(e){return function(e,t){var n=void 0;return e&&t&&(n=(n=S(e.key+".FriendlyDisplay",t))?Object(d.getRelativeDateTimeStringForLists)(n):S(e.key,t)),n}(C,e)}),C}function S(e,t){var n="";return t&&void 0===(n=t[e])&&t.properties&&(void 0===(n=t.properties[e])&&t.recycleBinProperties&&(n=t.recycleBinProperties[e]),n&&Array.isArray(n)&&(n=n.join(", "))),n}function D(e){return e?u.e.bigIcon:u.e.icon}function I(e){return e?u.e.bigIcon:u.e.iconMin}function x(e,t){switch(t){case f.e.Attachments:case f.e.Hyperlink:case f.e.Image:case f.e.Note:case f.e.FileSize:case f.e.FileIcon:return!1;default:var n=v(e);return n!==u.t.name&&n!==u.t.title}}var C;!function(e){e.getItemKey=function(e,t){return t&&t.properties&&(e?t.properties.uniqueId:t.properties.ID)||t&&t.key||void 0},e.getWorkflowStatusFromRawHtml=function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("a"),a=n.querySelector("span[value]");return{url:n.href,display:n.innerText,value:a&&a.getAttribute("value")}}}(C||(C={}));var O,w=C,E=n("y3bW"),A=n("Q17Z"),L=/\.?0+$/;!function(e){function t(e,t,n){return e.replace("{0}",function(e,t){var n=t.language,a=void 0===n?"en-us":n,i=t.trimDecimal,r=t.numberOfDecimals,o=void 0===r?0:r;if(e>=100||e===Math.floor(e)){var s=e.toFixed(o?o+1:0),c=s.length;return s.slice(0,o?-1:c)}var d=e.toFixed(o?o+1:e>=10?1:2),l=d.length,u=d.slice(0,o?-1:l),f=1.2.toLocaleString(a).replace(/\d+/g,"");return(i?u.replace(L,""):u).replace(".",f)}(t,n))}e.getDisplayString=function(e,n){var a=n.onlyReturnGB,i=n.ignoreZero;return"number"!=typeof e||isNaN(e)||i&&0===e||!a&&e<0?"":a&&e<107374182.4?A.o:1===e?A.t:e<1024?t(A.e,e,n):e<1024e3?t(A.a,e/1024,n):!a&&e<1048576e3?t(A.i,e/1048576,n):e<0xfa00000000?t(A.n,e/1073741824,n):t(A.r,e/1099511627776,n)}}(O||(O={}));var k=O,M=n("H2k1"),P=n("ukhN");function T(e,t,n,a,i,o,s,c){var d,l=e.groupSchema,u=l&&l[n],f=0===a?n+".COUNT.group":n+".COUNT.group2",p=u?u.Type:void 0;u&&"Calculated"===u.FieldType&&(p=u.FieldType);var m=U(t,n,p),_=function(e,t){return e[t+".urlencoded"]}(t,n),h=function(e,t,n,a){var i=void 0,o=!r.Killswitch.isActivated("f8d2a10a-c9c1-4297-908c-7bbf23060808","2/22/2021","Use field value for calculated field that is number type to follow decimal setting"),s=!r.Killswitch.isActivated("4419770d-92ef-4577-a9aa-4605ac3d1297","11/28/2022","Show user-friendly Approval Status groups");if("string"!=typeof e[t+".groupdisp"]||"DateTime"===n&&!Boolean(e[t+".groupdisp"])){if("FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size"))i=k.getDisplayString(Number(e.File_x0020_Size),{language:a,ignoreZero:!0});else if("_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")){var c=+e._ComplianceFlags;i=4&c&&1&c?M.t:M.e}else if(s&&t===E.e)i=new E.t(e[t+".singleurlencoded"]).toString();else if(e.hasOwnProperty(t))switch(n){case"User":var d=e[t];d&&d.length>0&&(i=d[0].title);break;case"Lookup":var l=e[t];void 0!==l&&(l.Label&&l.TermID?i=l.Label:Array.isArray(l)&&l.length>0?i=l[0].lookupValue:"string"==typeof l&&(i=l));break;case"WorkflowStatus":i=e[t]?w.getWorkflowStatusFromRawHtml(e[t]).display:"";break;case"Calculated":if(o&&e.hasOwnProperty(t+".calculated")&&e[t+".calculated"]&&e[t]&&"float"===e[t+".calculated"].split(";#")[0]){i=e[t];break}case"Boolean":case"ModStat":case"Number":case"Currency":case"Text":case"DateTime":i=e[t]}}else i=e[t+".groupdisp"];return"string"!=typeof i&&(i=U(e,t,n)),i}(t,n,p,c),b=function(e,t,n,a){var i=void 0;switch(a){case"Lookup":var r=e[t];void 0!==r&&(r.Label&&r.TermID?i=r.Label+"|"+r.TermID:r.length>0?i=String(r[0].lookupId):"string"==typeof r&&(i=r));break;case"Boolean":i=e[t+".value"];break;case"User":var o=e[t];if(o&&o.length>0){var s=o[0].email;i=JSON.stringify([{Key:s,IsResolved:!1}])}else"string"==typeof o&&(i=o);break;default:i=n}return i}(t,n,m,p),g={groupingType:"SPListGroup",groupingId:(s?s.groupingId+"-":"")+(m||"(null)"),name:h,groupString:_,fieldSchema:u,fieldValue:b,count:Number(t[f]),isCollapsed:i,startIndex:o,isDropEnabled:u&&"TRUE"!==u.ReadOnly&&void 0!==b,parentKey:s?s.groupingId:void 0,level:s?s.level+1:0};if(!r.Killswitch.isActivated("232e6c76-2586-4e75-9883-5a728182ad4e","5/23/2023","add filter params for fetching next nested groups")){var v=function(e,t,n){var a=e.fieldValue;if(e&&e.fieldSchema&&e.fieldSchema.Type){var i=function(t){var i=n||e.level,r=decodeURIComponent(t).split(";#"),o=r[0];r.length>0&&(r=r.slice(1,r.length-1),void 0!==i&&r[i]&&(o=r[i])),o&&(a=o.substring(0,4)+"-"+o.substring(4,6)+"-"+o.substring(6,8))};"Lookup"===e.fieldSchema.Type&&"DateTime"===e.fieldSchema.ResultType&&e.groupString?i(e.groupString):"User"===e.fieldSchema.Type||"Lookup"===e.fieldSchema.Type?a=e.name:"DateTime"===e.fieldSchema.Type&&(t[e.fieldSchema.Name+".groupDate"]?a=t[e.fieldSchema.Name+".groupDate"]:e.groupString&&i(e.groupString))}return a}(g,t,a);g.fieldFilterByValue=v}return(null===(d=e.rawListSchema)||void 0===d?void 0:d.Aggregate)&&!r.Killswitch.isActivated("f0a3dee3-6a82-4d90-a75f-c4fc542c6215","11/8/2022","add aggregation data to group")&&(g.columnTotals=function(e,t,n){for(var a,i=void 0===n?"":n>0?".agg2":".agg",r=t.Aggregate,o=Object.getOwnPropertyNames(r),s={},c=function(n){var c,d={type:(c=(c=r[o[n]])?c.toUpperCase():c,P[c]||""),value:e[o[n]+"."+r[o[n]]+i],aggregateFunctionType:r[o[n]],aggregateFieldType:null===(a=t.Field.find(function(e){return e.Name===o[n]}))||void 0===a?void 0:a.FieldType};s[o[n]]=d},d=0;d<o.length;d++)c(d);return s}(t,e.rawListSchema,a)),s&&(s.children||(s.children=[]),s.children.push(g)),g}function U(e,t,n){var a=void 0;if("DateTime"===n)a=(a=e[t]).split(" ")[0];else if("Lookup"===n){var i=e[t];void 0!==i&&(i.Label&&i.TermID?a=i.Label:Array.isArray(i)&&i.length>0?a=i[0].lookupValue:"string"==typeof i&&(a=i))}else if(e.hasOwnProperty(t+".singleurlencoded")&&"Calculated"!==n)a=decodeURIComponent(e[t+".singleurlencoded"]);else if(e.hasOwnProperty(t+".urlencoded")){var r=(a=decodeURIComponent(e[t+".urlencoded"])).split(";#");r.length>=2&&(a=r[r.length-2])}else"FileSizeDisplay"===t&&e.hasOwnProperty("File_x0020_Size")?a=e.File_x0020_Size:"_IsRecord"===t&&e.hasOwnProperty("_ComplianceFlags")&&(a=e._ComplianceFlags);return a}function F(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},a=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(a){var i=void 0,r=void 0;(e=(e=a[2]||"0").slice(-16)).length<=8?(i=0,r=parseInt(e,16)):(i=parseInt(e.slice(0,-8),16),r=parseInt(e.slice(-8),16)),isNaN(i)||isNaN(r)||(n.High=i,n.Low=r)}return n}var H,R={ODB:563,ODC:null,Fallback:!1};!function(e){function t(e){return"url"===e||"website"===e}var n;e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))},e.isShortcutFileType=t,e.isShortcutEnabled=function(){return r.Features.isFeatureEnabled(R)},(n=e.ShortcutErrors||(e.ShortcutErrors={}))[n.UnknownError=0]="UnknownError",n[n.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError",n[n.InvalidCharacterError=2]="InvalidCharacterError"}(H||(H={}));var N,B,j=H,V={accdb:{extensions:["accdb","mdb"]},archive:{type:r.ItemType.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{type:r.ItemType.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},clipchamp:{extensions:["clipchamp"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{type:r.ItemType.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:r.ItemType.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:r.ItemType.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},loop:{extensions:["fluid","loop"]},folder:{type:r.ItemType.Folder,iconType:"svg"},form:{extensions:["form"]},font:{type:r.ItemType.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:r.ItemType.Unknown},html:{extensions:["htm","html","mht"]},link:{type:r.ItemType.Unknown,extensions:["lnk","link","url","website","webloc"]},splist:{type:r.ItemType.Unknown,extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},one:{type:r.ItemType.OneNote,extensions:["note","one"]},onetoc:{type:r.ItemType.OneNote,extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},powerbi:{extensions:["pbix"]},photo:{type:r.ItemType.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{type:r.ItemType.Folder,iconType:"svg"},linkedfolder:{type:r.ItemType.Shortcut,iconType:"svg"},spreadsheet:{extensions:["ods","gsheet","numbers"]},sysfile:{type:r.ItemType.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vector:{type:r.ItemType.Unknown,extensions:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{type:r.ItemType.Media,extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{type:r.ItemType.Unknown,extensions:["zip"]}};!function(e){e[e.Invalid=0]="Invalid",e[e.File=1]="File",e[e.FileVersion=2]="FileVersion",e[e.ListItem=3]="ListItem",e[e.List=4]="List",e[e.Folder=5]="Folder",e[e.FolderWithLists=6]="FolderWithLists",e[e.Attachment=7]="Attachment",e[e.ListItemVersion=8]="ListItemVersion",e[e.CascadeParent=9]="CascadeParent",e[e.Web=10]="Web",e[e.App=11]="App"}(N||(N={})),function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(B||(B={}));var z,G=B;function K(e){if(!z)for(var t in z={},V){var n=V[t].extensions;if(n)for(var a=0;a<n.length;a++)z[n[a]]=t}return e=e.replace(".","").toLowerCase(),z[e]||"genericfile"}var W,q=n("mU4d"),Q=n("zDdS");!function(e){function t(e,t,n,a){if(e){var i=Object(q.e)(function(e){return e.id||e.FileRef||e.ServerRelativeUrl}(e),n.listUrl),o={key:i};o.id=e.id||e.FileRef,o.itemId=e["name.FileSystemItemId"];var s=e.File_x0020_Type;o.extension=s?"."+s:void 0,o.policyTip=e._ip_UnifiedCompliancePolicyUIAction?Number(e._ip_UnifiedCompliancePolicyUIAction):u.n.none,o.type=function(e,t,n){var a=r.ItemType.File,i=e.File_x0020_Type;if("1"===e.FSObjType){var o=e["File_x0020_Type.mapapp"],s=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];a=o&&"onenote"===o.substring(0,7)||s&&-1!==s.indexOf("onenote")?r.ItemType.OneNote:r.ItemType.Folder}else j.isShortcutEnabled()&&j.isShortcutFileType(i)?a=r.ItemType.Shortcut:"pdf"===i?a=r.ItemType.Media:(a=function(e){var t;try{if(e){var n=K(e);if(V[n]){var a=V[n].type;void 0===a&&(a=r.ItemType.File),t=a}}}catch(e){}return void 0===t&&(t=r.ItemType.Unknown),t}(i))===r.ItemType.Unknown&&Object(c.n)(n.listTemplateType)&&(a=r.ItemType.File);return".ai"!==t.extension&&".eps"!==t.extension&&".psd"!==t.extension||(a=r.ItemType.Media),a===r.ItemType.Folder?t.isDocSet="Sharepoint.DocumentSet"===e.ProgId:a===r.ItemType.File&&n&&!n.isDocLib&&(t.listItem={}),a}(e,o,n),o.extension&&(o.iconName=function(e){var t,n="";return e.type===r.ItemType.Folder?(n=void 0===(t=e.sharingType)||t===G.Private||t===G.Unknown?"folder":"sharedfolder",e.isDocSet?n="docset":e.isMountPoint&&(n="linkedfolder")):n=e.type===r.ItemType.OneNote?"one":e.recycleBinProperties&&e.recycleBinProperties.itemType===N.List?"splist":e.listItem?"listitem":"text/typescript"===e.textEditorMimeType?"code":e.panorama?"photo360":K(e.extension),n}(o)),o.isRootFolder=e.isRootFolder;var l=function(e,t,n){return n&&!n.isDocLib&&t!==r.ItemType.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef}(e,o.type,n);l&&(o.displayName=o.name=l),o.dateModifiedValue=e.Modified,o.dateModified=e["Modified.FriendlyDisplay"]?Object(d.getRelativeDateTimeStringForLists)(e["Modified.FriendlyDisplay"]):String(e.Modified),o.permissions=e.PermMask?F(e.PermMask):void 0,o.isPlaceholder=!e.PermMask,o.hasMissingMetadata=function(e,t){if(!t.listSchema)return!1;var n=t.listSchema.filter(function(e){return e.isRequired&&Boolean(e.name)}),a=!1;if(n&&n.length>0)for(var i in n)if(i&&!e[n[i].internalName]){a=!0;break}return a}(e,n);var f=e["serverurl.progid"];if(o.openUrl=f?f.substring(1):e.FileRef,-1!==o.openUrl.toLowerCase().indexOf("/wopiframe?")&&(o.openUrl=o.openUrl.replace(/\/_layouts\/WopiFrame.aspx\?/,"/_layouts/15/WopiFrame.aspx?")),o.previewIFrameUrl=e.ServerRedirectedEmbedUrl,o.appMap=e["File_x0020_Type.mapapp"]||e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],o.size=e.File_x0020_Size?Number(e.File_x0020_Size):void 0,o.totalSize=e.SMTotalSize?Number(e.SMTotalSize):void 0,a.blockDownloadsExperienceEnabled&&(o.type===r.ItemType.Media||o.openUrl&&o.appMap)?o.itemStatus=4:a.blockDownloadsExperienceEnabled?o.itemStatus=3:a.viewOnlyExperienceEnabled&&(o.itemStatus=4),o.type===r.ItemType.Folder){o.folder={},o.childCount=Number(e.ItemChildCount)+Number(e.FolderChildCount);var p=Number(e.SMTotalFileCount);o.folder.totalCount=p>0?p:o.childCount,o.folder.childCount=o.childCount}for(var m in o.isDraggable=!0,o.isDropEnabled=o.type===r.ItemType.Folder,o.properties={},e)e.hasOwnProperty(m)&&(o.properties[m]=e[m]);var _=e.UniqueId&&r.Guid.normalizeLower(e.UniqueId);_&&(o.properties.uniqueId=_);var h=o.name;return o.extension&&(h=o.name.substring(0,o.name.toLowerCase().lastIndexOf(o.extension.toLowerCase()))),o.properties.FileName=h,Number(e.PrincipalCount)>0?o.sharingType=G.Shared:void 0===e.PrincipalCount?o.sharingType=G.Unknown:o.sharingType=G.Private,function(e,t,n,a,i,r){if((a=a||n.groupBy)&&a.length>0){var o=t&&t.length>0?t[t.length-1]:void 0,s=a[0],c=a[1];if(s&&"1"===e[s+".newgroup"]){var d=T(n,e,s,0,!1,o?o.startIndex+o.count:0,void 0,r);t||(t=[]),t.push(d),o=d}if(c&&"1"===e[c+".newgroup"]){var l=o&&o.children&&o.children.length>0?o.children[o.children.length-1]:void 0;T(n,e,c,1,!1,l?l.startIndex+l.count:o?o.startIndex:0,o,r)}}}(e,t,n),o}}e.buildItems=function(e,n,a,i,r){for(var o=[],s=[],c=e.Row,d=c.length,l=0;l<d;l++){var u=t(c[l],s,n,a);u.parent=i,u.parentKey=i.key,r&&r.setItem(u.key,u),o.push(u)}var f=0;if(s.length>0){var p=s[s.length-1];f=p.startIndex+p.count}else s=void 0,f=d>0?e.LastRow:0;return{items:o,groups:s,totalCount:f}},e.buildRootItem=function(e,t,n,a){var i=function(e){var t=e;return 0===e.indexOf("id")&&(t=Object(r.deserializeQuery)(e).id),t}(e),o=Object(q.e)(i,n.listUrl),s={key:o},d=t.ListTitle,l=t.AllowCreateFolder,u=t.EnableMinorVersions,f=t.verEnabled,p=t.AllowGridMode,m=t.DisableGridEditing,_=t.ListTemplateType,h=t.BasePermissions,b=void 0===h?{}:h,g=b.ManageLists,v=void 0===g?void 0:g,y=b.ManagePersonalViews,S=void 0===y?void 0:y,D=b.OpenItems,I=void 0===D?void 0:D,x=t.ListSchema,C=(void 0===x?{}:x).DefaultItemOpen,O=void 0===C?void 0:C,w=t.ExcludeFromOfflineClient,E=t.WebExcludeFromOfflineClient,A=t.ListData,L="string"==typeof O?"0"===O:void 0;if(a){var k=a.getItem(o);k&&(s=k)}return s.type=r.ItemType.Folder,s.isRootFolder=i===n.listUrl,Object(Q.t)(s,{permissions:Q.n(A?F(A.FolderPermissions):void 0)}),void 0===s.list&&(s.list={}),Object(Q.t)(s.list,{id:Q.n(t.listName),title:Q.n(d),allowGridMode:"boolean"==typeof p?p:Q.e(!0),allowCreateFolder:Q.n(l),disableCommenting:"boolean"==typeof t.DisableCommenting&&t.DisableCommenting,disableGridEditing:"boolean"==typeof m?m:Q.e(!1),enableMinorVersions:Q.n(u),enableVersions:Q.n(f),templateType:Q.n("string"==typeof _?Number(_):void 0),isDocumentLibrary:Q.n("string"==typeof _?Object(c.t)(_):void 0),isPromotedLinks:Q.n("string"==typeof _?Object(c.a)(_):void 0),isForceCheckout:Q.n(t.isForceCheckout),isModerated:Q.n(t.isModerated),enableRequestSignOff:Q.n(t.EnableRequestSignOff),newWOPIDocumentEnabled:Q.n(t.NewWOPIDocumentEnabled),newWOPIDocumentTypes:Q.n(t.NewWOPIDocumentTypes),permissions:{manageLists:Q.n(v),managePersonalViews:Q.n(S),openItems:Q.n(I)},openInClient:Q.n(L),excludeFromOfflineClient:Q.n("boolean"==typeof w||"boolean"==typeof E?w||E:void 0),contentTypesEnabled:Q.n(t.ContentTypesEnabled),metadataNavFeatureEnabled:Q.n(t.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:Q.n(t.canUserCreateMicrosoftForm),itemCount:Q.n(t.ListSchema&&t.ListSchema.ItemCount),rowLimit:Q.n(A&&A.RowLimit)}),s.isRootFolder&&(s.name=s.displayName=d),a&&a.setItem(o,s),s},e.buildItem=t}(W||(W={}));var Y=function(){function e(e){this._listContext=e.listContext,this._pageContext=e.pageContext,this._itemStore=e.itemStore,this._language=e.language}return e.prototype.processData=function(e,t){!function(e,t){Number(e.ListTemplateType)&&(t.listTemplateType=Number(e.ListTemplateType),t.isDocLib=Object(c.t)(t.listTemplateType)),"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled),e.ListSchema&&(t.listId=e.listName,t.rawListSchema=e.ListSchema,t.viewTitle=e.viewTitle,t.openInClient="0"===t.rawListSchema.DefaultItemOpen),e.ListTitle&&(t.listTitle=e.ListTitle),r.KillSwitch.isActivated("fdf54b03-dcaa-46b1-84c1-a78021883ff0","2/2/2022","Fix wrong listUrl in listContext")?e.listUrlDir&&(t.listUrl=decodeURIComponent(e.listUrlDir)):e.ListUrl&&(t.listUrl=e.ListUrl),e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments),e.Flags2&&(t.flags2=e.Flags2),e.Icon&&(t.icon=e.Icon),e.Color&&(t.color=e.Color);var n=e.BasePermissions;if(n&&(t.permissions={manageLists:n.ManageLists,managePersonalViews:n.ManagePersonalViews,openItems:n.OpenItems}),"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient)),"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled),"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled),"boolean"==typeof e.checkPowerAppState&&(t.checkPowerAppState=e.checkPowerAppState),"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions),"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled),"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes),"boolean"==typeof e.isForceCheckout&&(t.isForceCheckout=e.isForceCheckout),"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated),"boolean"==typeof e.EnableRequestSignOff&&(t.enableRequestSignOff=e.EnableRequestSignOff),"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder),"boolean"==typeof e.DisableCommenting&&(t.disableCommenting=e.DisableCommenting),"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0),e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl),e.editFormUrl&&(t.editFormUrl=e.editFormUrl),e.newFormUrl&&(t.newFormUrl=e.newFormUrl),e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled),e.AvailableContentTypes&&(t.availableContentTypes=e.AvailableContentTypes),e.ViewMetadata){var a=void 0;if(a=Object(i.__assign)({},e.ViewMetadata),e.VisualizationInfo)try{a.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}a.CustomFormatter=e.ListSchema&&e.ListSchema.CustomFormatter,t.viewResult=new o.e(a)}t.isPlaceholder=!1}(t,this._listContext),function(e){var t=void 0;e.groupByOverride?t=[e.groupByOverride]:e.rawListSchema&&e.rawListSchema.group1&&((t=[]).push(e.rawListSchema.group1),e.rawListSchema.group2&&t.push(e.rawListSchema.group2));var n=-1,a=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0&&(n=0,e.filterParams&&!a)){var i=Boolean(Object(s.e)(e.filterParams,t[0])),r=!(!i||!t[1])&&Boolean(Object(s.e)(e.filterParams,t[1]));(i&&1===t.length||r&&2===t.length)&&(n=-1)}e.groupLevel=n,e.groupBy=n>-1?t:void 0,e.isGrouped=Boolean(e.groupBy)}(this._listContext);var n=t.ListSchema&&"TRUE"===t.ListSchema.Collapse,a=this._processSchema(t.ListSchema),d=t.ListContenTypes,l=t.ListData||t,u=W.buildRootItem(e,t,this._listContext,this._itemStore),f=this._processItems(l,n,u,this._language);return{root:u,items:f.items,groups:f.groups,totalCount:f.totalCount,startIndex:this._getStartIndex(l),columns:a,contentTypes:d,nextRequestToken:this._getNextRequestToken(l),isAllGroupsCollapsed:n}},e.prototype._processSchema=function(e){if(e){var t={},n={hasFixedSchema:this._listContext.listTemplateType===c.e.mySiteDocumentLibrary};this._listContext.listSchema=function(e,t,n,a,i){if(e&&e.Field){for(var r=-1,o=0,s=0,c=e.Field;s<c.length;s++){if("TRUE"===(C=c[s]).listItemMenu){r=o;break}o++}!n.disableCalloutInvoker&&r>=0&&e.Field.splice(r+1,0,{DisplayName:n.calloutInvokerDisplayName,Name:"_calloutInvoker",Sortable:"FALSE",Type:"Computed"}),!n.disableShareHeroCommand&&r>=0&&e.Field.splice(r+1,0,{DisplayName:n.shareHeroCommandDisplayName,Name:"_shareHeroCommand",Sortable:"FALSE",Type:"Computed"});for(var d,l,p,m=new Array(n.hasFixedSchema?5:0),g={},S=0,x=e.Field;S<x.length;S++){var C,O=(C=x[S]).Name;if(-1===(n.hasFixedSchema?b:h).indexOf(O)){var w=v(O),E=_[w],A=y(C,E,t,n,e,undefined);if("TRUE"===C.GroupField&&a){if(a[O]=C,g[O])continue;A.isVisible=!1,A.isVisibleMobile=!1}switch(m[n.hasFixedSchema&&E&&!m[E.index]?E.index:m.length]=A,g[O]=A,w){case u.t.icon:d=A;break;case u.t.name:l=A;break;case u.t.modified:p=A}}}if((t.groupBy||e.group1||e.group2)&&(!d||d!==m[0])){var L={key:"other",name:"",minWidth:u.e.regularMin,width:u.e.regular,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isAscending:!0,fieldType:f.e.Text,filterable:!1,groupable:!1,resizable:!1,isGrouped:!1,isFiltered:!1};L.minWidth=I(n.useCustomColumn),L.width=D(n.useCustomColumn),L.fieldType=f.e.Computed,m.unshift(L)}return n.useCustomColumn?function(e,t,n){for(var a={key:"custom",name:"",minWidth:u.e.regularMin,width:u.e.custom,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:f.e.Text,filterable:!1,groupable:!1,customFields:[]},i=0;i<t.length;i++)for(var r=0,o=t[i];r<o.length;r++){var s=o[r];s.customRowNumber=i,a.customFields.push(s)}for(var c=[e,a],d=0,l=n;d<l.length;d++){var p=l[d];p.isVisible=!1,p.isVisibleMobile=!1,c.push(p)}return c}(d,[[l],[p]],[l,p]):m.filter(function(e){return!!e})}}(e,this._listContext,n,t),Object.keys(t).length&&(this._listContext.groupSchema=t)}return this._listContext.listSchema},e.prototype._processItems=function(e,t,n,a){var i;return i=t?function(e,t,n,a){for(var i=[],r=0,o=void 0,s=void 0,c=(n=n||t.groupBy)[0],d=n[1],l=0,u=e;l<u.length;l++){var f=u[l];if(c&&"1"===f[c+".newgroup"]){var p=T(t,f,c,0,!0,r,void 0,a);i.push(p),r+=p.count,o=p,s=void 0}d&&"1"===f[d+".newgroup"]&&(s=T(t,f,d,1,!0,s?s.startIndex+s.count:o?o.startIndex:0,o,a))}return{groups:i,totalCount:r}}(e.Row,this._listContext,void 0,a):W.buildItems(e,this._listContext,this._pageContext,n,this._itemStore),i.groups&&i.groups.length>0&&(this._listContext.lastGroup=i.groups[i.groups.length-1]),{items:i.items?i.items:[],groups:i.groups,totalCount:i.totalCount}},e.prototype._getStartIndex=function(e){var t=0;return this._listContext.group?t=this._listContext.group.startIndex:e.FirstRow&&(t=e.FirstRow-1),t},e.prototype._getNextRequestToken=function(e){var t="";return e.NextHref&&(t=(t=e.NextHref).replace("&View=00000000-0000-0000-0000-000000000000","")),t},e}()},"7qB6":function(e,t,n){"use strict";function a(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function i(e){var t=[];t.push(a(8,e)),t.push(a(4,e));var n="4"+a(3,e);t.push(n);var i=a(4,e),r=parseInt(i[0],16);return r&=3,i=(r|=8).toString(16)+i.substr(1),t.push(i),t.push(a(12,e)),t.join("-")}function r(e,t){return void 0===t&&(t=!1),e?s(e.toLowerCase(),t):""}function o(e,t){return void 0===t&&(t=!1),e?s(e.toUpperCase(),t):""}function s(e,t){var n=e.match(/^\{(.*)\}$/);return n?t?n[0]:n[1]:t?"{"+e+"}":e}n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o})},"8Uzg":function(e,t,n){"use strict";function a(){return void 0!==window._TeamsListApp}function i(){return a()?"TeamsList":void 0!==window._TeamsPageApp?"TeamsPage":"SP"}n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i})},"9kMg":function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"a",function(){return c}),function(e){e[e.invalidType=-1]="invalidType",e[e.noListTemplate=0]="noListTemplate",e[e.genericList=100]="genericList",e[e.documentLibrary=101]="documentLibrary",e[e.survey=102]="survey",e[e.links=103]="links",e[e.announcements=104]="announcements",e[e.contacts=105]="contacts",e[e.events=106]="events",e[e.tasks=107]="tasks",e[e.pictureLibrary=109]="pictureLibrary",e[e.webTemplateCatalog=111]="webTemplateCatalog",e[e.webPartCatalog=113]="webPartCatalog",e[e.listTemplateCatalog=114]="listTemplateCatalog",e[e.xmlFormLibrary=115]="xmlFormLibrary",e[e.masterPageCatalog=116]="masterPageCatalog",e[e.webPageLibrary=119]="webPageLibrary",e[e.customGrid=120]="customGrid",e[e.solutionCatalog=121]="solutionCatalog",e[e.themeCatalog=123]="themeCatalog",e[e.designCatalog=124]="designCatalog",e[e.appDataCatalog=125]="appDataCatalog",e[e.ganttTasks=150]="ganttTasks",e[e.promotedLinks=170]="promotedLinks",e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy",e[e.meetings=200]="meetings",e[e.externalList=600]="externalList",e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary",e[e.publishingPageLibrary=850]="publishingPageLibrary",e[e.publishingAsset=851]="publishingAsset",e[e.issueTracking=1100]="issueTracking",e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary",e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary",e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary",e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList",e[e.contentCenterExplanationList=1332]="contentCenterExplanationList",e[e.corporateCatalog=330]="corporateCatalog",e[e.siteCollectionCorporateCatalog=336]="siteCollectionCorporateCatalog",e[e.SyntexModernTemplateLibrary=4e3]="SyntexModernTemplateLibrary",e[e.SyntexSnippetLibrary=4200]="SyntexSnippetLibrary",e[e.SyntexFieldsLibrary=4201]="SyntexFieldsLibrary"}(a||(a={})),function(e){e[e.invalidType=-1]="invalidType",e[e.GenericList=0]="GenericList",e[e.DocumentLibrary=1]="DocumentLibrary"}(i||(i={}));var r=[a.mySiteDocumentLibrary,a.documentLibrary,a.pictureLibrary,a.xmlFormLibrary,a.webPageLibrary,a.publishingPageLibrary,a.publishingAsset];function o(e){var t=Number(e);return-1!==r.indexOf(t)}function s(e){return e===a.genericList||e===a.announcements||e===a.issueTracking||e===a.contacts||e===a.customGrid}function c(e){return Number(e)===a.promotedLinks}a.documentLibrary,a.contentCenterPrimeLibrary,t.e=a},AfXp:function(e){var t=e.exports=JSON.parse('{"NoneComplianceTagName":"None","NoneComplianceTagDescription":"Clear the label","GetAvailableTagsForSiteFailed":"Failed to get tags for site.","ComplianceTagFieldPlaceHolder":"Choose a label","NoRetentionTooltip":"This label has no retention settings.","RetainForeverText":"Retain forever","PreserveForeverTooltip":"Retains item forever.","PreserveTagText":"Retain for {0}","PreserveTagCreationAgeInDaysTooltip":"Retains item for {0}, based on when it was created. ","PreserveTagModificationAgeInDaysTooltip":"Retains item for {0}, based on when it was last modified. ","PreserveTagTaggedAgeInDaysTooltip":"Retains item for {0}, based on when the label was applied. ","PreserveTagEventAgeInDaysTooltip":"Retains item for {0}, based on when its event happened. ","PreserveIsRecordTooltipModifier":"You can\\u0027t edit or delete the item during this time. ","PreserveNoDeleteTooltipModifier":"After this period, you can delete it.","PreserveAutoDeleteTooltipModifier":"After this period, item is deleted.","RecordLabelHoverText":"Editing this item is blocked by a policy in your organization.","DeleteTagText":"Delete after {0}","DeleteTagCreationAgeInDaysTooltip":"Item is automatically deleted {0} after it was created.","DeleteTagModificationAgeInDaysTooltip":"Item is automatically deleted {0} after it was last modified.","DeleteTagTaggedAgeInDaysTooltip":"Item is automatically deleted {0} after the label was applied.","DeleteTagEventAgeInDaysTooltip":"Item is automatically deleted {0} after its event happened.","RetentionPeriodDay":"{0} day","RetentionPeriodDays":"{0} days","RetentionPeriodMonth":"{0} month","RetentionPeriodMonths":"{0} months","RetentionPeriodYear":"{0} year","RetentionPeriodYears":"{0} years","ReviewTooltip":"After this period, item must be reviewed by an admin before it\\u0027s deleted."}');t.default=t},D2s4:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"ResultTypeEnum")&&n.d(t,"ResultTypeEnum",function(){return a.ResultTypeEnum})},E01Q:function(e,t,n){"use strict";n.d(t,"e",function(){return f}),n.d(t,"t",function(){return f});var a=n("xCzz"),i=n("7qB6"),r="KillSwitchOverrides",o="".concat(r,"_").concat("enableKillSwitches"),s="".concat(r,"_").concat("disableKillSwitches");function c(e){try{var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}catch(e){return""}}function d(e){var t=[],n=[];for(var a in e)(e[a]?t:n).push(a);try{document.cookie="".concat(o,"=").concat(t.join(","),";path=/;samesite=none;secure;").concat(t.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;"),document.cookie="".concat(s,"=").concat(n.join(","),";path=/;samesite=none;secure;").concat(n.length?"":"expires=Thu, 01 Jan 1970 00:00:01 GMT;")}catch(e){}}var l={},u=function(){l=function(e,t,n,a){if(t)for(var r=0,o=t.split(",");r<o.length;r++){var s=o[r];e[i.n(s,!1)]=!0}if(n)for(var c=0,d=n.split(",");c<d.length;c++)s=d[c],e[i.n(s,!1)]=!1;return e}({},c(o),c(s));var e=function(){try{return location.search?location.search.substring(1):""}catch(e){return""}}(),t=Object(a.e)(e);t.enableKillSwitches,t.disableKillSwitches,t.debugKillSwitches,d(l);try{window.__debugSetKillSwitch=function(e,t){void 0===t&&(t=!0),l[i.n(e,!1)]=!!t,d(l)}}catch(e){}u=function(){}},f=function(){function e(){}return e.initKillSwitches=function(t){e._killSwitch=p({killSwitches:t||{}})},e.isActivated=function(t,n,a){var i;if(u(),e._killSwitch)return e.isActivated=e._killSwitch.isActivated,e._killSwitch.isActivated(t,n,a);try{if(window._spPageContextInfo){var r=p(window._spPageContextInfo);return(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.killSwitches)&&(e.isActivated=r.isActivated),r.isActivated(t,n,a)}if(window.Flight){var o=void 0;if(window.Flight.KillSwitches){o={};for(var s=0,c=Object.keys(window.Flight.KillSwitches);s<c.length;s++){var d=c[s];o[window.Flight.KillSwitches[d]]=!0}}var l=p({killSwitches:o});return o&&(e.isActivated=l.isActivated),l.isActivated(t,n,a)}}catch(e){return!1}return!1},e}();function p(e){var t=e&&e.killSwitches;return{isActivated:function(e,n,a){var r=!1;if(e){var o=i.n(e,!1);o in l?r=!!l[o]:t&&(r=!!t[o])}return r}}}},GPRH:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return h}),n.d(t,"a",function(){return _});var a={};n.r(a),n.d(a,"fileNotFound",function(){return o}),n.d(a,"invalidView",function(){return s}),n.d(a,"listNotFound",function(){return c}),n.d(a,"docAlreadyExists",function(){return d}),n.d(a,"queryThrottled",function(){return l}),n.d(a,"newExperieceRenderingNotSupported",function(){return u}),n.d(a,"onePageNavigationViewMismatch",function(){return f}),n.d(a,"onePageNavigationError",function(){return p}),n.d(a,"offline",function(){return m});var i,r,o=-2147024894,s=-2147024809,c=-1,d=-2130575257,l=-2147024860,u=-2,f=-3,p=-4,m=-5;!function(e){e[e.icon=16]="icon",e[e.iconMin=16]="iconMin",e[e.bigIcon=48]="bigIcon",e[e.bigIconMin=48]="bigIconMin",e[e.regularMin=90]="regularMin",e[e.regular=130]="regular",e[e.nameMin=220]="nameMin",e[e.nameODC=440]="nameODC",e[e.nameODB=280]="nameODB",e[e.originalLocation=300]="originalLocation",e[e.custom=900]="custom",e[e.sharedWith=150]="sharedWith",e[e.note=250]="note",e[e.dateModifiedMl=150]="dateModifiedMl",e[e.dotDotDot=32]="dotDotDot",e[e.ratingsMin=110]="ratingsMin"}(i||(i={})),function(e){e[e.none=0]="none",e[e.icon=1]="icon",e[e.name=2]="name",e[e.title=3]="title",e[e.calloutInvoker=4]="calloutInvoker",e[e.shareHeroCommand=5]="shareHeroCommand",e[e.modified=6]="modified",e[e.url=7]="url"}(r||(r={}));var _,h={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};!function(e){e[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed"}(_||(_={}))},H2k1:function(e){e.exports=JSON.parse('{"t":"Yes","e":"No"}')},IV9z:function(e,t,n){"use strict";n.d(t,"e",function(){return Ze});var a={};n.r(a),n.d(a,"localStorage",function(){return N}),n.d(a,"indexedDB",function(){return B}),n.d(a,"none",function(){return j});var i=n("K9kD"),r=n("y88i"),o=n("KTUx"),s=n("17wl"),c=n("TUic"),d=n("WIMm"),l=n("dq6a"),u=n("6HcZ"),f=["-2146232832, Microsoft.SharePoint.SPFieldValidationException","NoConnection"],p=n("Rg6q"),m=n("xkft"),_=n("b69B"),h=n("JyUB"),b=n("h/Eh"),g=n("3HEj"),v=n("yhDP"),y=n("boye"),S=n("mU4d"),D=n("zKK4"),I=i.Killswitch.isActivated("29873e89-d94c-4bb0-8f5b-dfd437f6422c","6/19/2021","Look for filters within the folder structure for doclib by using GetListUsingPath API"),x=function(e){function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;return n._listContext=t.listContext,n._itemUrlHelper=t.itemUrlHelper||new m.e({},{pageContext:t.pageContext}),n._apiUrlHelper=t.apiUrlHelper||new b.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper}),n._folderPath=t.folderPath,void 0===n._folderPath&&(n._folderPath=Object(S.t)(t.parentKey,n._listContext)),n}return Object(s.__extends)(t,e),t.prototype.getFilterData=function(e,t,n,a){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,a)},function(e){return e},"GetFilterData")},t.prototype._getFilterDataUrl=function(e,t,n,a){var i,o,s=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl});o=I?this._apiUrlHelper.build().webByItemUrl(s).method("GetList",s.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e):this._apiUrlHelper.build().webByItemUrl(s).methodWithAliases("GetListUsingPath",{DecodedUrl:s.serverRelativeListUrl}).segment("RenderListFilterData").parameter("FieldInternalName",e),n&&n!==D.e&&(o=o.parameter("ViewId",n)),this._folderPath&&(o=o.parameter("RootFolder",{raw:r.UriEncoding.encodeURIComponent(this._folderPath)})),a&&a===v.e.Taxonomy&&(o=o.parameter("ExcludeFieldFilteringHtml",!0));var c=Object(y.t)(t,!0,{replaceMeFormatFilterWithCurrentUser:!0,currentUserDisplayName:null===(i=this._pageContext)||void 0===i?void 0:i.userDisplayName});return(o=o.rawParameter(c)).toString()},t}(l.t),C=n("7Xy9"),O=n("o4HN"),w=n("+f+R"),E=n("myym"),A="OnChangingTags";function L(e,t){void 0===t&&(t=1);try{for(var n=e.fields.length,a=0;a<n;a++)if("TaxonomyFieldType"===e.fields[a].schema.FieldType||"TaxonomyFieldTypeMulti"===e.fields[a].schema.FieldType){var r=k(e.fields[a].serverData,e.fields[a].data);if(0===r.addedTagsCount&&0===r.deletedTagsCount)continue;var o=e.fields[a].schema.FieldType.toLowerCase();e.isBulkEdit||t>1?o+=".BulkEdit.":o+=".NotBulkEdit.",o+=A;for(var s=0;s<t;s++)i.Engagement.logData({name:o,isIntentional:!0,extraData:{deletedTagsCount:r.deletedTagsCount,addedTagsCount:r.addedTagsCount}})}}catch(e){return void i.OdspErrorHelper.logError(e,{eventName:A})}}function k(e,t){var n=M(e),a=M(t),i=0,r=Object.keys(n).length,o=Object.keys(a).length;if(r>0&&o>0)for(var s in n)a[s]&&i++;return{deletedTagsCount:r-i,addedTagsCount:o-i}}function M(e){if(!e)return{};for(var t={},n=0,a=e.split(";");n<a.length;n++)t[a[n]]=!0;return delete t[""],t}var P,T=n("8Uzg"),U=function(){function e(){}return e.newItemCreated="clientFormNewItemCreated",e.itemUpdated="clientFormItemUpdated",e}(),F=n("baHJ"),H=n("9kMg"),R=n("P8RM"),N=0,B=1,j=2,V=a,z=n("rqqu"),G=n("7qB6"),K="undefined"==typeof window?self:window,W=n("cNe7");!function(e){e.success="success",e.error="error"}(P||(P={}));var q="app",Q="app_lastRead",Y="ODSP_DB",J="ODSP_DB_TABLE",X="lastModified",Z="lastRead",$="ODSP_DB_METADATA_TABLE",ee="database_metadata",te="parentKey",ne="reads",ae=(new z.e).isFirefox,ie="indexedDB is not supported",re=function(){function e(t){if(!("indexedDB"in K)||!K.indexedDB)throw new Error(ie);this._logger=t,e._openDBPromise||(e._openDBPromise=this._openIndexedDB().then(function(t){return e._db=t,t}))}return e.prototype.freeSpace=function(t,n){return Object(s.__awaiter)(this,void 0,void 0,function(){var a,i,r,o=this;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,[2,new Promise(function(e,i){var r=a.transaction([J],"readwrite").objectStore(J).index(Q).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){o._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return Object(s.__awaiter)(this,void 0,void 0,function(){return Object(s.__generator)(this,function(t){return[2,this._readInternal(J,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return Object(s.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,c,d,l,u,f,p,m,_,h=this;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return n={},i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,o=a.transaction([J],"readonly"),c=o.objectStore(J),d=[],l=t.index,u=t.range,f=t.direction,p=t.count,m=c.index(l),(_=m.openKeyCursor(u,f)).onerror=function(e){h._errorHandling(e,n.reject)},_.onsuccess=function(e){var t=e.target.result;t?(d.push(t.primaryKey),d.length>=p?n.resolve(d):t.continue()):n.resolve(d)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return Object(s.__awaiter)(this,void 0,void 0,function(){var t;return Object(s.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:J,key:t,row:Object(s.__assign)(Object(s.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:J,key:t,row:void 0})]})})},e.prototype.statistics=function(){return Object(s.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(s.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(J,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=ae?indexedDB.open(Y,{version:4,storage:"temporary"}):indexedDB.open(Y,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(J,{keyPath:"key"})).createIndex(X,X,{unique:!1}),a.createIndex(ne,ne,{unique:!1}),t.createObjectStore($,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(J)).createIndex(q,q,{unique:!1}),a.createIndex(Z,Z,{unique:!1}),a.createIndex(Q,[q,Z],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(J)).createIndex("app_lastModified",[q,X],{unique:!1}),a.createIndex("app_reads",[q,ne],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(J)).createIndex(te,te,{unique:!1}),a.createIndex("parentKey_app",[te,q],{unique:!1}),a.createIndex("parentKey_app_lastModified",[te,q,X],{unique:!1}),a.createIndex("parentKey_app_lastRead",[te,q,Z],{unique:!1}),a.createIndex("parentKey_app_reads",[te,q,ne],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal($,function(e){return e.get(ee)}).then(function(t){if(t)return t.data;var n={id:G.e(),created:Date.now(),cacheType:V.indexedDB};return e._writeInternal({tableName:$,key:ee,row:{key:ee,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return Object(s.__awaiter)(this,void 0,void 0,function(){var a,i,r,o=this;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,[2,new Promise(function(e,i){var r=o._logger({name:"PersistentCacheIDB.readInternal"}),s=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){r({resultType:W.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-s)}}),e(d.result)},d.onerror=function(e){r({resultType:W.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-s)}}),o._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return Object(s.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,c=this;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,o=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(o.push(n(a.value)),a.continue()):e(o)},r.onerror=function(e){c._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return Object(s.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,c,d=this;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return n=t.tableName,a=t.key,i=t.row,o=e,(c=e._db)?[3,2]:[4,e._openDBPromise];case 1:c=s.sent(),s.label=2;case 2:return r=o._db=c,[2,new Promise(function(e,t){try{var o=r.transaction([n],"readwrite"),s=o.objectStore(n);o.oncomplete=function(){},o.onerror=function(e){d._errorHandling(e,t)};var c=i?s.put(i):s.delete(a);c.onsuccess=function(t){e()},c.onerror=function(e){d._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return Object(s.__awaiter)(this,void 0,void 0,function(){var t,n=this;return Object(s.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:te,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:J,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===P.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),oe="PersistentCache",se="PersistentCache_metadata",ce=function(){function e(){try{if("localStorage"in K&&K.localStorage&&(this._localStorage=K.localStorage,!this._localStorage.getItem(se))){var e={id:G.e(),created:Date.now(),cacheType:V.localStorage};this._localStorage.setItem(se,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=Object(s.__assign)(Object(s.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(oe)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(se)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return Object(s.__awaiter)(this,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(oe,"_").concat(e)},e}(),de=0,le=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return Object(s.__awaiter)(n,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:de++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=K.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function ue(){return K.performance&&performance.now?Math.round(performance.now()):Date.now()}var fe=n("D2s4"),pe="_odspcache_",me="_____",_e={cacheType:V.indexedDB},he=function(){function e(e){var t=e.cacheType,n=void 0===t?_e.cacheType:t,a=Object(s.__rest)(e,["cacheType"]);if(this._config=Object(s.__assign)(Object(s.__assign)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new le,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(t){return Object(s.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D;return Object(s.__generator)(this,function(s){switch(s.label){case 0:n=this._logQos({name:"PersistentCache.read"}),o=ue(),c=Date.now(),s.label=1;case 1:return s.trys.push([1,12,,13]),l=this._getCacheKey(t),u=!1,f={lastModified:NaN,lastRead:c,reads:1},p=void 0,l?(m=ue(),[4,this._storage.read(l)]):[3,11];case 2:return d=s.sent(),r=Math.round(ue()-m),d?(_=d.data,f={lastModified:d.lastModified,lastRead:c,reads:d.reads+1},(a=e._buffer[l])&&a.cacheStats.lastModified===d.lastModified?(a.app=d.app||this._app,a.key={original:t,encoded:d.key||l},a.cacheStats.lastRead=c,a.cacheStats.reads++,a.performance={total:Math.round(ue()-o)},[3,11]):[3,3]):[3,11];case 3:if(a=void 0,void 0===_)return[3,11];if(!this._dataIsEncrypted)return[3,10];h=_,b=this._cacheSecret,g=b.CurrentKey.Key,v=b.PreviousKey.Key,y=ue(),s.label=4;case 4:return s.trys.push([4,6,,9]),[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:g})];case 5:return p=s.sent(),[3,9];case 6:return(S=s.sent())&&S.message&&S.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:h,encryptionSecret:v})]:[3,8];case 7:p=s.sent(),u=void 0!==p,n({resultType:fe.ResultTypeEnum.ExpectedFailure,error:S.message,extraData:{cacheResult:"hit"}}),s.label=8;case 8:return[3,9];case 9:return i=Math.round(ue()-y),[3,11];case 10:p=_,s.label=11;case 11:return a=a||{key:{original:t,encoded:d&&d.key||l},app:d&&d.app||this._app,data:p,cacheStats:f,cacheType:this._cacheType,performance:{crypto:i,io:r,total:Math.round(ue()-o)}},e._buffer[l]=a,u&&this.update(t,p),[3,13];case 12:throw D=s.sent(),n({resultType:fe.ResultTypeEnum.Failure,error:D.message?D.message:D.toString(),extraData:{cacheResult:"miss"}}),D;case 13:return n({resultType:fe.ResultTypeEnum.Success,extraData:{cacheResult:"".concat(void 0!==a.data?"hit":"miss")}}),[2,Promise.resolve(a)]}})})},e.prototype.rangeQuery=function(e){return Object(s.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,c,d=this;return Object(s.__generator)(this,function(s){if(this._cacheType!==V.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=ue(),i=Date.now(),o={lastModified:NaN,lastRead:i,reads:1};try{c=ue(),r=this._storage.rangeQuery(e).then(function(e){return n=Math.round(ue()-c),{key:void 0,app:void 0,data:e.map(function(e){return{original:d._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:o,cacheType:d._cacheType,performance:{io:n,total:Math.round(ue()-a)}}})}catch(e){throw t({resultType:fe.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:fe.ResultTypeEnum.Success}),[2,r||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:o,cacheType:this._cacheType,performance:{io:n,total:Math.round(ue()-a)}})]})})},e.prototype.update=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,function(){var n,a=this;return Object(s.__generator)(this,function(i){switch(i.label){case 0:return n=this._getCacheKey(e),[4,this._cacheUpdateTaskManager.enqueue(n,function(){return a._doCacheUpdate(e,t)}).signal.promise];case 1:return i.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){return Object(s.__awaiter)(this,void 0,void 0,function(){return Object(s.__generator)(this,function(t){return[2,this.update(e,void 0)]})})},e.prototype.freeSpace=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,function(){return Object(s.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e,t){return Object(s.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,c,d=this;return Object(s.__generator)(this,function(s){switch(s.label){case 0:n=ue(),a=Date.now(),i=this._logQos({name:"PersistentCache.readAndUpdate"}),r=t().then(function(t){var i={app:d._app,key:{original:e,encoded:d._getCacheKey(e)},data:t,cacheType:V.none,cacheStats:{lastModified:void 0,lastRead:a,reads:1},performance:{total:Math.round(ue()-n)}};return d.update(e,t),i}),s.label=1;case 1:s.trys.push([1,8,,9]),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,Promise.race([this.read(e),r])];case 3:return o=s.sent(),[3,5];case 4:return s.sent(),[3,5];case 5:return!o||o.cacheType!==V.none&&void 0===o.data?[4,r]:[3,7];case 6:o=s.sent(),s.label=7;case 7:return[3,9];case 8:throw c=s.sent(),i({resultType:fe.ResultTypeEnum.Failure,error:c.message?c.message:c.toString()}),c;case 9:return i({resultType:fe.ResultTypeEnum.Success}),[2,o]}})})},e.prototype._initLocalStorage=function(e){if(e===V.localStorage)this._storage=new ce;else try{this._storage=new re(this._logQos.bind(this))}catch(e){e.message===ie&&(this._storage=new ce,this._cacheType=V.localStorage)}},e.prototype._getCacheKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?me+e.user:""));return"".concat(pe).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(pe,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(me)>=0){var i=a.split(me);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._doCacheUpdate=function(t,n){return Object(s.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,c,d,l;return Object(s.__generator)(this,function(u){switch(u.label){case 0:a=this._logQos({name:"PersistentCache.update"}),u.label=1;case 1:return u.trys.push([1,9,,10]),i=this._getCacheKey(t),void 0===n?[3,6]:((r=e._buffer[i]=Object(s.__assign)(Object(s.__assign)({},e._buffer[i]),{data:n,cacheType:this._cacheType})).cacheStats||(r.cacheStats={lastModified:NaN,lastRead:ue(),reads:1}),o=n,c=NaN,this._dataIsEncrypted?(d=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:d,data:n,doSerialize:this._cacheType===V.localStorage})]):[3,3]);case 2:return o=u.sent(),c=o.cipherText?o.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}u.label=4;case 4:return[4,this._storage.write({app:this._app,key:i,data:o,lastRead:r.cacheStats.lastRead,parentKey:t.parentKey,reads:r.cacheStats.reads,size:c})];case 5:return u.sent(),[3,8];case 6:return delete e._buffer[i],[4,this._storage.write({key:i,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:throw l=u.sent(),a({resultType:fe.ResultTypeEnum.Failure,error:l.message?l.message:l.toString()}),l;case 10:return a({resultType:fe.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return Object(s.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(s.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return Object(s.__awaiter)(e,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),be=function(){function e(e,t){this._getDataPromises={};var n=e.id,a=e.dataSourceName,r=e.cacheType,o=void 0===r?V.indexedDB:r,c=(t.pageContext||{}).aadUserId;this._id=n,this._userId=c;var d=a||n,l=i.Qos.withData(function(e){return e.name&&d&&!e.name.startsWith(d)?Object(s.__assign)(Object(s.__assign)({},e),{name:"".concat(d,".").concat(e.name)}):e});this._cache=new he({cacheType:o,telemetry:{qos:l}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,r=n.cachingStrategy,o=void 0===r?0:r,s=n.cacheTimeoutTime,c=void 0===s?864e5:s,d=n.getData,l=n.returnStatistics,u=void 0!==l&&l,f=n.cacheRequestParentKey,p={key:a,user:this._userId,parentKey:f},m=function(){var e=t._getDataPromises[a];if(!e){var n=d();t._getDataPromises[a]=n,e=n.then(function(e){return t._cache.update(p,e).catch(function(){}),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})}return e.then(function(e){return u?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1}}:e})};return 2===o?i.Promise.resolve(this._cache.read(p)).then(function(e){var t=e||{},n=t.data,a=t.cacheStats;return null==n?null:u?{data:n,cacheStats:a}:n}).catch(function(){return null}):i.Promise.resolve(this._cache.read(p)).then(function(e){var n=e||{},a=n.data,i=n.cacheStats;if(null==a)return m();var r=u?{data:a,cacheStats:i}:a,s=t._isCacheExpired(i.lastModified,c);switch(o){case 4:return r;case 0:return s&&m(),r;case 1:return s?m():r;default:return m()}},function(){return m()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove(n)},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update(n,t)},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}(),ge=i.KillSwitch.isActivated("8a599b0b-8859-422a-aa10-ca6a49ce77eb","04/04/2022","Switch to newer sensitivity label api path"),ve=i.KillSwitch.isActivated("3d8830f8-713c-444f-9c9f-1db6c603995a","04/06/2023","Throw an error when no auth is provided and not return an empty array"),ye=function(){function e(e,t){var n=t.pageContext,a=t.graphDataRequestor;this._pageContext=n,this._graphDataRequestor=a||new R.e({},{}),this._getOAuthToken=e.getOAuthToken,this._getOAuthToken2=t.getOAuthToken,this._cache=new be({id:"SensitivityLabelsDataSource"},{pageContext:n})}return e.prototype.getSensitivityLabels=function(){return Object(s.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(s.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:0,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return e._getSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabelsCached=function(){return Object(s.__awaiter)(this,void 0,void 0,function(){var e=this;return Object(s.__generator)(this,function(t){return[2,this._cache.getDataUtilizingCache({cachingStrategy:0,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return e.getDocLibSensitivityLabels()}}).catch(function(){return null})]})})},e.prototype.getDocLibSensitivityLabels=function(){return Object(s.__awaiter)(this,void 0,i.Promise,function(){var e,t,n,a,r=this;return Object(s.__generator)(this,function(o){switch(o.label){case 0:return!ve||this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,i.Promise.resolve([])];case 1:return n=o.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=o.sent(),o.label=4;case 4:return t=n,this._sensitivityLabels?(a=this._sensitivityLabels,[3,7]):[3,5];case 5:return[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,"/beta/me/informationprotection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){var t=JSON.parse(e.responseText).value;return r._sensitivityLabels=t,t}})];case 6:a=o.sent(),o.label=7;case 7:return[2,a]}})})},e.prototype.setSensitivityLabel=function(e,t,n,a){return Object(s.__awaiter)(this,void 0,void 0,function(){var i,r,o,c;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return i={id:n,assignmentMethod:"Privileged",justificationText:a||"",actionSource:"Manual"},this._getOAuthToken||this._getOAuthToken2?(r="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],r)]:[3,2]):[2,Promise.resolve("")];case 1:return c=s.sent(),[3,4];case 2:return[4,this._getOAuthToken2(r)];case 3:c=s.sent(),s.label=4;case 4:return o=c,[4,this._graphDataRequestor.send({endpoint:r,path:"".concat(r,"/beta/drives/").concat(e,"/items/").concat(t,"/setSensitivityLabel"),apiName:"GraphDataProvider.setSensitivityLabel",postData:JSON.stringify(i),accessToken:{accessToken:o},requestType:"POST",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,s.sent()]}})})},e.prototype._getSensitivityLabels=function(){return Object(s.__awaiter)(this,void 0,i.Promise,function(){var e,t,n;return Object(s.__generator)(this,function(a){switch(a.label){case 0:return this._getOAuthToken||this._getOAuthToken2?(e="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],e)]:[3,2]):[2,i.Promise.resolve([])];case 1:return n=a.sent(),[3,4];case 2:return[4,this._getOAuthToken2(e)];case 3:n=a.sent(),a.label=4;case 4:return(t=n)?[4,this._graphDataRequestor.send({endpoint:e,path:"".concat(e,ge?"/beta/me/informationprotection/policy/labels":"/beta/me/security/informationProtection/sensitivityLabels"),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:t},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){return JSON.parse(e.responseText).value.filter(function(e){return!0===e.isActive}).sort(function(e,t){return e.sensitivity>t.sensitivity?1:-1})}})]:[2,i.Promise.resolve([])];case 5:return[2,a.sent()]}})})},e}(),Se=n("KZze"),De=n("gvHJ"),Ie={id:"none",key:"none",text:De.e,title:De.e},xe=function(){function e(){}return e.processSensitivityLabelsForDropdownOption=function(e){var t={};e.forEach(function(e){var n,a,i=e.name,r=null===(n=null==e?void 0:e.parent)||void 0===n?void 0:n.name;r?t[r]?null===(a=t[r])||void 0===a||a.push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip}):(t[r]=[{name:r,id:"".concat(e.id,"isParent"),isParent:!0,tooltip:e.tooltip}],t[r].push({name:i,id:e.id,isParent:!1,tooltip:e.tooltip})):t[i]=[{name:i,id:e.id,isParent:!1,tooltip:e.tooltip}]});var n=[];return t&&Object.keys(t).length>0&&Object.keys(t).forEach(function(e){var a=t[e];if((null==a?void 0:a.length)>1){var i=a[0];a.forEach(function(e){var t=e.isParent?Se.e.Header:Se.e.Normal,a=e.isParent?e.name:"".concat(i.name," \\ ").concat(e.name);n.push({id:e.id,key:e.id,text:a,title:e.tooltip,data:{text:e.name,isParent:e.isParent},itemType:t})}),n.push({key:"divider_2",text:"-",itemType:Se.e.Divider})}else n.push({id:a[0].id,key:a[0].id,text:a[0].name,title:a[0].tooltip,data:{text:a[0].name}})}),n},e.processSensLabelsForDropdownOptionDocLib=function(e){var t=[];return t.push(Ie),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){if(Oe(e.labelActions)){var i=Ce(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,e.toolTip);t.push(i)}}else e.sublabels.forEach(function(e){var n;if(Oe(e.labelActions)){var i="".concat(a," \\ ").concat(e.displayName),r=Ce(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),i,e.toolTip);t.push(r)}})}),t},e.processLabelsForItem=function(e){var t=[];return t.push(Ie),e.forEach(function(e){var n,a=e.displayName;if(0===e.sublabels.length){var i=Oe(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o=Ce(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),a,r);t.push(o)}}else e.sublabels.forEach(function(e){var n,i=Oe(e.labelActions),r=e.tooltip||e.toolTip;if(i){var o="".concat(a," \\ ").concat(e.displayName),s=Ce(e.id,null===(n=e.priority)||void 0===n?void 0:n.toString(),o,r);t.push(s)}})}),t},e}();function Ce(e,t,n,a){return{id:e,key:t,text:n,title:a}}function Oe(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if("userDefinedRights"===e[t].encryptWith)return!1;return!0}var we="0x0120",Ee={ODB:788,OneDrive:!0},Ae={ODB:573,OneDrive:!0},Le={ODB:1261},ke={ODB:1293},Me={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},Pe={ODB:60092,ODC:void 0,Fallback:!1},Te={ODB:1770},Ue="CreateItem",Fe="UpdateItem",He={ODB:60925},Re=i.Killswitch.isActivated("d3ea1d30-dd0c-4885-9a95-d6788e1a67ba","03/20/2023","When thumbnail field does not contain data, do not set nucleusRedirection header in item creation/update request"),Ne=i.Killswitch.isActivated("3d8830f8-713c-444f-9c9f-1db6c603995a","04/06/2023","Throw an error when no auth is provided and not return an empty array"),Be=i.Killswitch.isActivated("4238f7c0-0161-41ec-8aae-e9f9004c503d","04/13/2023","stop making more calls when the error is expected"),je=i.Killswitch.isActivated("357e4924-b1c3-4e94-b358-f094d8dd1b08","05/04/2023","return when schema is undefined"),Ve=i.Killswitch.isActivated("a0716dce-3c16-4946-816a-62353a6978fc","05/18/2023","Fix none option for sensitivity label field"),ze=i.Killswitch.isActivated("f0894a83-9d51-4f5e-8cc7-d17b2b7ae430","05/31/2023","Add delay to allow Nucleus sync complete for creating item with images"),Ge=i.Killswitch.isActivated("b6f5c533-2596-4a15-b575-55a909ce2b80","06/29/2023","fix isSenFieldUpdated check"),Ke=i.Killswitch.isActivated("c6e5559b-37ee-4354-bf7d-708f2a1f328a","08/02/2023","fix error display for sen label field"),We=function(e){function t(t,n){var a=e.call(this,{},n)||this;return a._clientForms=null,a._init=function(e,t){var n=t.pageContext,r=t.apiUrlHelper,o=t.itemUrlHelper,s=t.listContext;a._itemUrlHelper=o||new m.e({},{pageContext:n}),a._apiUrlHelper=r||new b.e({},{itemUrlHelper:a._itemUrlHelper,pageContext:n}),e.complianceTagProvider?a._complianceTagProvider=e.complianceTagProvider:a._complianceTagProvider=new w.e({pageContext:n}),a._getSharedLockId=e.getSharedLockId,e.fileUploaderProvider?a._fileUploaderProvider=e.fileUploaderProvider:a._fileUploaderProvider=new O.e({pageContext:n,listUrl:null==s?void 0:s.listUrl}),a.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return i.FeatureOverrides.isFeatureEnabled(e,a._pageContext&&a._pageContext.ExpFeatures)},a.isFeatureEnabled(He)&&a._pageContext.isLabelIRMEnabled&&(a._sensitivityLabelsDataSource=new ye({},{pageContext:a._pageContext,getOAuthToken:null==t?void 0:t.getGraphAuthToken})),s&&(a._listContext=s)},a._getAdditionalPostData=function(e){return e.isListDataRenderOptionChangeFeatureEnabled=a.isFeatureEnabled(Ee),e.isSpotlightFeatureEnabled=a.isFeatureEnabled(Ae),h.e(e)},a._init(t,n),a._formRenderMode=i.Killswitch.isActivated("F0DEE101-8819-4628-B199-51D9800F6A22","08/28/2023","Updated FormRenderMode")?o.n:o.a,a}return Object(s.__extends)(t,e),Object.defineProperty(t.prototype,"listContext",{set:function(e){this._listContext=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fileUploaderProvider",{set:function(e){this._fileUploaderProvider=e},enumerable:!1,configurable:!0}),t.prototype.updateContext=function(e,t){this._init(e,t)},t.prototype.getClientFormSchema=function(e,t,n){var a,r=this,o=function(){var a=r._locateClientFormWithContentTypeInfos(e,t);if(n&&a&&a.fields){var i=a.fields.filter(function(e){return!r._isFieldRequireUniqueValue(e)});return Object(s.__assign)(Object(s.__assign)({},a),{fields:i})}return a};return e===p.e.newItem&&t&&this._contentTypeIdToNameMap&&(a=this._contentTypeIdToNameMap[t[0].contentTypeId]),null===this._clientForms||this._listContext.refreshClientForm||!a?(this._listContext.refreshClientForm=void 0,this.fetchAllClientFormSchemas().then(function(){return o()})):i.Promise.wrap(o())},t.prototype.getClientForm=function(e,t,n,a){var o=this;return new i.Promise(function(s,c){o.getData(function(){var t=r.UriEncoding.encodeRestUriStringToken(o._listContext.listUrl),n=new i.Uri(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",a=",cutoffVersion=".concat(n);return"".concat(o._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(30).concat(a,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData),n&&n.length>0&&!n[0].contentType&&t.ListData&&t.ListData.ContentType&&(n[0].contentType=t.ListData.ContentType,n[0].contentTypeId||(n[0].contentTypeId=t.ListData.ContentTypeId)),t.ListDataLite=t.ListData,t.ListData=t.Data,t.Data=void 0,t}return null},"GetItemDataForClientForm",function(){return""},"POST",o._getAdditionalHeaders()).then(function(e){var i;if(!a&&o.isFeatureEnabled(He)&&o._pageContext.isLabelIRMEnabled)null===(i=o._sensitivityLabelsDataSource)||void 0===i||i.getDocLibSensitivityLabelsCached().then(function(i){o._sensitivityLabelOptions=xe.processLabelsForItem(i);var r=o._processGetClientFormServerData(e,t,n,a);s(r)}).catch(function(i){Ne||(o._sensitivityLabelOptions=[]);var r=o._processGetClientFormServerData(e,t,n,a);s(r)});else{var r=o._processGetClientFormServerData(e,t,n,a);s(r)}},function(e){var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1;c({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})})},t.prototype.updatePanelViewInfo=function(e){var t=this;return new i.Promise(function(n,a){t.getData(function(){var n=r.UriEncoding.encodeRestUriStringToken(t._listContext.listUrl);return"".concat(t._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/contentTypes('".concat(e.contentTypeId,"')")+"/ReorderFields()"+"?@v1='".concat(n,"'")},function(){return null},"CustomPanelSaveDataToServer",function(){return JSON.stringify({fieldNames:e.data})}).then(function(){n(e.serverResponse({message:{value:"updated Information"}}))},function(t){a(e.serverResponse(t))})})},t.prototype.saveCustomShowHideRules=function(e,t,n){var a=this,i={__metadata:{type:"SP.Field"},ClientValidationFormula:e.rules,ClientValidationMessage:e.errMsg};return this.getData(function(){return a._getListApiUrl(t).segment("Fields").method("GetByInternalNameOrTitle",n).toString()},function(e){return e},"saveCustomValidationRules",function(){return JSON.stringify(i)},"MERGE")},t.prototype._isFieldRequireUniqueValue=function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"===t||"attachments"===t||"Title"===n||"LinkTitle"===n||"LinkTitleNoMenu"===n||"thumbnail"===t},t.prototype._getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e||this._pageContext.listUrl,listUrl:e||this._pageContext.listUrl});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)},t.prototype.saveClientFormCustomFormatter=function(e,t){var n=this,a={__metadata:{type:"SP.ContentType"},ClientFormCustomFormatter:JSON.stringify(e.ClientFormCustomFormatterJson)};return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e.ContentTypeId+"')").toString()},function(e){return e},"saveCustomFormFormatterJSON",function(){return JSON.stringify(a)},"MERGE")},t.prototype.getClientFormCustomFormatter=function(e,t){var n=this;return this.getData(function(){return n._getListApiUrl(t).segment("contentTypes('"+e+"')").toString()},function(e){return e},"GetCustomFormatter",null,"GET")},t.prototype.getResourceProviders=function(){return{ComplianceTagProvider:this._complianceTagProvider,FileUploaderProvider:this._fileUploaderProvider}},t.prototype._processGetClientFormServerData=function(e,t,n,a){var i=this,r=new C.e({listContext:this._listContext,pageContext:this._pageContext}).processData("parent",e),c=r&&r.items&&r.items[0];this._clientForms={};var d=e.ListSchema,l=e.ItemContentTypeId,u=e.ItemContentTypeName||e.ItemContentType,f=e.ClientFormCustomFormatter;f&&(this._ctIdToClientFormCustomFormatter=f),d&&(d.New&&this._processClientFormResponse(p.e.newItem,d.New,l,u),d.Edit&&(this._processClientFormResponse(p.e.editItem,d.Edit,l,u),this._processClientFormResponse(p.e.displayItem,d.Edit,l,u)));var m=this._locateClientFormWithContentTypeInfos(t,n);if(a&&m&&m.fields){var _=m.fields.filter(function(e){return!i._isFieldRequireUniqueValue(e)});m=Object(s.__assign)(Object(s.__assign)({},m),{fields:_})}var h={item:c,formType:null==m?void 0:m.formType,contentType:null==m?void 0:m.contentType,contentTypeId:null==m?void 0:m.contentTypeId,fields:[],isBulkEdit:a,clientFormCustomFormatter:null==m?void 0:m.clientFormCustomFormatter};this._generateFieldsFromSchema(h,m);for(var b=[],g=0,v=h.fields;g<v.length;g++)(D=v[g]).state===o.t.ready&&(D.state=o.t.updating,b.push(D));t!==p.e.newItem&&this._handleServerData(h,e,{},b);for(var y=0,S=b;y<S.length;y++){var D;(D=S[y]).state=o.t.ready}return h},t.prototype._generateFieldsFromSchema=function(e,t){var n=this._listContext&&(this._listContext.enableAttachments||void 0===this._listContext.enableAttachments);if(je||t){for(var a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}if(!e.isBulkEdit&&this.isFeatureEnabled(He)&&this._pageContext.isLabelIRMEnabled&&this._sensitivityLabelOptions){var o=this._generateSensitivityLabelField(this._sensitivityLabelOptions);e.fields.push(this._generateField(e,o))}}},t.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:o.t.ready}},t.prototype._generateSensitivityLabelField=function(e){return{Id:"sensitivitylabel",Name:"Sensitivity",Type:"SensitivityLabel",Hidden:!1,InternalName:"sensitivitylabel",Title:"Sensitivity",SensitivityLabelOptions:e,FieldType:"sensitivitylabel"}},t.prototype.updateFormValues=function(e,t){var n=this,a=e.item;if(!a||!a.properties||!a.properties.ID)return i.Promise.wrap();for(var s=[],c=0,d=e.fields;c<d.length;c++){var l=d[c];l.state===o.t.ready&&(l.state=o.t.updating,s.push(l))}return this.getData(function(){var e=a.properties.ID,t=r.UriEncoding.encodeRestUriStringToken(n._listContext.listUrl),o=new i.Uri(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",s=",cutoffVersion=".concat(o);return"".concat(n._pageContext.webAbsoluteUrl,"/_api/web/GetList(@v1)")+"/RenderExtendedListFormData(itemId=".concat(e,",formId='editform',mode='2',options=").concat(15).concat(s,")")+"?@v1='".concat(t,"'")},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders(),"",0,!0).then(function(a){n._handleServerData(e,a,t,s);for(var i=0,r=s;i<r.length;i++)r[i].state=o.t.ready},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,a=0,r=s;a<r.length;a++)r[a].state=o.t.ready;return i.Promise.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})},t.prototype.createItem=function(e){var t=this,n=this._getUrlInfo(),a=n.listUrl,r=n.itemUrlParts,o="AddValidateUpdateItemUsingPath",s=function(){return t._apiUrlHelper.build().webByItemUrl(r).method("GetList",a).method(o).toString()},c=!!e.clientForm.contentTypeId&&0===e.clientForm.contentTypeId.lastIndexOf(we,0),d=function(t){var n=e.rootFolder||a;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n},UnderlyingObjectType:c?"1":void 0},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(Te)?t._doCreateItem(s,d,e,o):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!0).then(function(n){var a=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(n,null,a)?(n&&n.length>0&&n.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n){var a=Object(F.e)(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl);try{n.data=JSON.stringify(a)}catch(e){n.data=""}}}}),t._doCreateItem(s,d,e,o)):i.Promise.wrap({status:u.e.fail})}):t._doCreateItem(s,d,e,o)})},t.prototype._doCreateItem=function(e,t,n,a){var i=this;return this._createOrUpdateItem(Ue,e,t,n,a).then(function(e){return i._postUpdateFields(Ue,n,[]).then(function(t){return e.status===u.e.success&&t.status===u.e.fail?(t.status=u.e.partialSuccess,t):e})})},t.prototype.updateItem=function(e){var t=this,n=e.clientForm.isBulkEdit&&e.itemdIds&&e.itemdIds.length>1?e.itemdIds:void 0,a=n&&n.length>1,r=function(e){var n=t._getUrlInfo(),i=n.listUrl,r=n.itemUrlParts;return a?t._apiUrlHelper.build().webByItemUrl(r).method("GetList",i).method("BulkValidateUpdateListItems").toString():t._apiUrlHelper.build().webByItemUrl(r).method("GetList",i).method("items",e.properties.ID).method("ValidateUpdateListItem").toString()},o=function(i){var r,o;a&&(o=t._listContext.folderPath);var c=null===(r=t._getSharedLockId)||void 0===r?void 0:r.call(t);return JSON.stringify(Object(s.__assign)({itemIds:n,formValues:i,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:o},c?{sharedLockId:c}:{}))};return this._ensureClientForms().then(function(){return t.isFeatureEnabled(Te)?t._doUpdateItem(r,o,e,a,n):t._fileUploaderProvider&&t._fileUploaderProvider.hasPendingImageOperations()?t._updateImages(!1).then(function(s){var c=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()});return t.handleFileUploaderErrors(s,null,c)?(s&&s.length>0&&s.forEach(function(t){if(t&&t.image){var n=e.clientForm.fields.filter(function(e){return"thumbnail"===e.schema.FieldType.toLowerCase()&&e.schema.Name===t.image.fieldName})[0];if(n&&n.data!==n.serverData){var a=Object(F.e)(n.data);a&&(a.serverRelativeUrl=t.image.serverRelativeUrl,a.id=t.image.id,a.serverUrl=t.image.serverUrl),n.data=a?JSON.stringify(a):""}}}),t._doUpdateItem(r,o,e,a,n)):i.Promise.wrap({status:u.e.fail})}):t._doUpdateItem(r,o,e,a,n)})},t.prototype._doUpdateItem=function(e,t,n,a,i){var r=this;return this._createOrUpdateItem(Fe,e,t,n,a?"BulkValidateUpdateListItems":"ValidateUpdateListItem",i).then(function(e){return r._postUpdateFields(Fe,n,i).then(function(t){return e.status===u.e.success&&t.status===u.e.fail?(t.status=u.e.partialSuccess,t):e})})},t.prototype.fetchAllClientFormSchemas=function(){var e=this;return this._clientFormsDebouncer||(this._clientFormsDebouncer=new c.e),this._clientFormsDebouncer.isExecuting()||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return e._getServerConnectionUrl().toString()},function(t){e._clientForms={};var n=JSON.parse(t);n.ContentTypeIdToNameMap&&(e._contentTypeIdToNameMap=n.ContentTypeIdToNameMap),n.ClientFormCustomFormatter&&(e._ctIdToClientFormCustomFormatter=n.ClientFormCustomFormatter);var a=n.ClientForms;a&&(a.New&&e._processClientFormResponse(p.e.newItem,a.New),a.Edit&&(e._processClientFormResponse(p.e.editItem,a.Edit),e._processClientFormResponse(p.e.displayItem,a.Edit))),n.Navigation&&(e._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes}),e._listContext.enableAttachments="true"===n.EnableAttachments,n.FormRenderModes&&e._processFormRenderMode(n.FormRenderModes),(n.PowerAppFormId||n.AppId)&&(e._powerAppFormId=n.PowerAppFormId||n.AppId),n.AppRenderInfo&&(e._powerAppFormInfo=n.AppRenderInfo||{}),n.AppAdditionalData&&(e._powerAppAdditionalData=n.AppAdditionalData),n.CachedFileUrlTemplate&&n.CacheAppFiles&&(e._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){return e._getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:!1})},"POST",this._getAdditionalHeaders()))),this._clientFormsPromise},t.prototype.getFieldFilterData=function(e,t,n){return new x({parentKey:void 0,listContext:this._listContext,pageContext:this._pageContext,folderPath:n,itemUrlHelper:this._itemUrlHelper,apiUrlHelper:this._apiUrlHelper}).getFilterData(e,"",t,void 0)},t.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t},t.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})},t.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})},t.prototype.getPowerAppFormId=function(){return this._powerAppFormId},t.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo},t.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData},t.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo},t.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return"".concat(t._pageContext.webAbsoluteUrl,"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='")+e+"'&visualizationTarget=1"},function(e){var t=JSON.parse(e),n="";return t.d&&t.d.Value&&(n=JSON.parse(t.d.Value)),n},"GetPowerAppFormDesignUrl",null,"GET")},t.prototype.getCustomAllowedExternalDomains=function(){return this.dataRequestor.getData({url:"".concat(this._pageContext.webAbsoluteUrl,"/_api/Site/AllowedExternalDomains"),qosName:"GetAllowedExternalDomains",method:"GET",contentType:"application/json",additionalHeaders:{accept:"application/json"},parseResponse:function(e){return JSON.parse(e)},noRedirect:!0})},t.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return _.t({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})},t.prototype._processClientFormResponse=function(e,t,n,a){this._clientForms[e]||(this._clientForms[e]={});var i=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!i[r]){var s;s=r===a?n:this._reverseLookupContentTypeIdByName(r);var c=this._ctIdToClientFormCustomFormatter?this._ctIdToClientFormCustomFormatter[s]:void 0;i[r]={contentType:r,contentTypeId:s,formType:e,fields:[],clientFormCustomFormatter:c?JSON.parse(c):void 0,mode:o.n.Unknown};for(var d=i[r],l=t[r],u=0,f=l.length;u<f;u++)d.fields.push(l[u])}this._clientForms[e]=i},t.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null},t.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var a=p.e.newItem;switch(n){case"Edit":a=p.e.editItem;break;case"Display":a=p.e.displayItem}var i=this._formRenderMode.Unknown;switch(e[t][n].RenderType){case 1:i=this._formRenderMode.Classic;break;case 2:i=this._formRenderMode.Modern;break;case 3:i=this._formRenderMode.PowerApp;break;case 4:i=this._formRenderMode.Customized;break;default:d.e.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[a][t].mode=i}},t.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var n=t[0],a=this._locateClientForm(e,n.contentType,n.contentTypeId);if(1===t.length||!a||!a.fields)return a;for(var i=a.fields.slice(),r=function(n){if(0===i.length)return"break";var a=t[n],r=o._locateClientForm(e,a.contentType,a.contentTypeId);i=i.filter(function(e){for(var t=0,n=r.fields;t<n.length;t++)if(n[t].Name===e.Name)return!0;return!1})},o=this,c=1;c<t.length&&"break"!==r(c);c++);return Object(s.__assign)(Object(s.__assign)({},a),{fields:i})},t.prototype._locateClientForm=function(e,t,n){if(!t&&n&&this._contentTypeIdToNameMap&&(t=this._contentTypeIdToNameMap[n]),!t&&this._clientForms[e])for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){t=a;break}if(n&&0===n.lastIndexOf(we,0)&&this._clientForms[e]&&!this._clientForms[e][t]){var i={FileLeafRef:1,Title:1,URL:1};for(var a in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(a)){var r=this._clientForms[e][a].fields.filter(function(e){return!!i[e.Name]})[0];if(r)return this._clientForms[e].Folder={contentType:"Folder",contentTypeId:n,formType:e,fields:[r],mode:o.n.Unknown},this._clientForms[e].Folder}}if(!this._clientForms[e]||!this._clientForms[e][t]){if("folder"===t.toLowerCase()&&!n)for(var a in this._clientForms[e])if(this._clientForms[e][a]&&!this._clientForms[e][a].contentTypeId)return this._clientForms[e][a];return null}return this._clientForms[e][t]},t.prototype._getAdditionalHeaders=function(e,t){var n=_.n(this._listContext);return this.isFeatureEnabled(Pe)&&n&&e&&(e===p.e.newItem?(n.Scenario="CreateListItem",n.ScenarioType="AUO"):e===p.e.editItem&&(n.Scenario="EditListItem",n.ScenarioType="AUO")),t&&(n.nucleusRedirection="false"),n},t.prototype._handleServerData=function(e,t,n,a){var i=t.ListDataLite?t.ListDataLite:t.ListData,r=t.ListDataLite?t.ListData.Row[0]:t.Data.Row[0],o=e.item;this._ctIdToClientFormCustomFormatter=t.ClientFormCustomFormatter,this.isFeatureEnabled(He)&&this._pageContext.isLabelIRMEnabled&&(e.sensitivityLabel=t.ListData.Row&&t.ListData.Row[0]&&t.ListData.Row[0]._DisplayName||"none");for(var s=0,c=a.length;s<c;s++){var d=a[s],l=d.schema;if(!n||!n.hasOwnProperty(l.Name)){if(void 0===d.data&&(d.data=null),void 0===d.serverData&&(d.serverData=null),i.hasOwnProperty(l.Name)){if(l.FieldType&&"boolean"===l.FieldType.toLowerCase()&&""===r[l.Name]&&"0"===i[l.Name]?d.serverData="":l.FieldType&&"thumbnail"===l.FieldType.toLowerCase()&&r[l.Name]?d.serverData=r[l.Name]:d.serverData=i[l.Name],o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=r[l.Name]),this.isFeatureEnabled(Me)&&(o.properties.hasOwnProperty("ItemExpirationDate")||(o.properties.ItemExpirationDate=r._ExpirationDate),!o.properties.hasOwnProperty("IsItemExpirationModifiable"))){var u=r.MetaInfo,f=u&&u[0]&&u[0].lookupValue||"",p=new RegExp(/vti_stream_isexpirationmodifiable:([a-zA-Z]{2})\|false/gi).test(f);o.properties.IsItemExpirationModifiable=!p}}else E.r(d)?(d.serverData=r[E.t],o.hasOwnProperty(l.Name)||o.properties.hasOwnProperty(l.Name)||(o.properties[l.Name]=r[l.Name])):o.folder&&d.schema.FieldType&&"file"===d.schema.FieldType.toLowerCase()&&d.schema.Title&&"name"===d.schema.Title.toLowerCase()&&i.Title?d.serverData=i.Title:l.FieldType&&"sensitivitylabel"===l.FieldType?d.serverData=e.sensitivityLabel:d.serverData=null;e.isBulkEdit&&(d.serverData=null),d.schema.AppendOnly?(d.appendOnlyData=t[d.schema.Name],d.data=""):d.schema.SensitivityLabelOptions?d.data="":d.data=d.serverData}}o.hasClientFormData=!0},t.prototype._createOrUpdateItem=function(e,t,n,a,r,s){var c=this,d=a.clientForm.fields,l=[],f=[],m={},_=[],h=!1,b=!1;a.clientForm.formType===p.e.editItem&&a.clientForm.item&&!a.clientForm.isBulkEdit&&this._listContext&&!this._listContext.isDocLib&&a.clientForm.item.properties&&"1"===a.clientForm.item.properties.FSObjType&&(b=!0),this.isFeatureEnabled(ke)&&(s?L(a.clientForm,s.length):L(a.clientForm));for(var v=void 0,y=!1,S=!1,D=0,I=d;D<I.length;D++){var x=I[D];if(this.isFeatureEnabled(Te)&&"thumbnail"===x.schema.FieldType.toLowerCase()&&(Re||this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations())&&(S=!0),null!==x.data&&void 0!==x.data){var C=x.data;if("thumbnail"===x.schema.FieldType.toLowerCase()){if(this.isFeatureEnabled(Te))continue;if("string"!=typeof C)try{C=JSON.stringify(C)}catch(e){}}if(!this._isClientFormFieldUpdated(a,C,x.serverData,x)||"attachments"===x.schema.FieldType.toLowerCase()||"sensitivitylabel"===x.schema.FieldType||E.r(x)||E.o(x))m[x.schema.Name]=!0,!v&&this._isEventField(x)&&(v=x);else{l.push(x);var O=x.schema.Name;"ContentType"===O&&(C=this._reverseLookupContentTypeIdByName(C.displayName),O="ContentTypeId",h=!0),f.push({FieldName:O,FieldValue:C,HasException:!1,ErrorMessage:null}),!y&&this._isEventField(x)&&(y=!0),"Title"===O&&b&&f.push({FieldName:"FileLeafRef",FieldValue:C,HasException:!1,ErrorMessage:null});var w=x.schema.FieldType.toLowerCase();i.Engagement.logData({name:"ClientFormUpdate",extraData:{FieldType:w,Host:Object(T.e)()}})}}}if(y&&v&&f.push({FieldName:v.schema.Name,FieldValue:v.data,HasException:!1,ErrorMessage:null}),h?4096==(4096&this._listContext.flags2)&&f.push({FieldName:"PrimeCorrectedByUser",FieldValue:"true",HasException:!1,ErrorMessage:null}):a.clientForm.formType===p.e.newItem?f.push({FieldName:"ContentType",FieldValue:a.clientForm.contentType,HasException:!1,ErrorMessage:null}):a.clientForm.formType===p.e.editItem&&a.clientForm.item&&a.clientForm.item.properties&&!a.clientForm.isBulkEdit&&f.push({FieldName:"ContentTypeId",FieldValue:a.clientForm.item.properties.ContentTypeId,HasException:!1,ErrorMessage:null}),0===l.length&&0===_.length)return i.Promise.wrap({status:u.e.success});var A=!1;return this.isFeatureEnabled(Te)&&a.clientForm.formType===p.e.newItem&&S&&(A=!0),_.push(this._getUpdateItemPromise(e,t,n,a,r,l,f,a.clientForm.item,s,A)),i.Promise.all(_).then(function(e){for(var t={status:u.e.success},n=0,a=e;n<a.length;n++){var i=a[n];i&&i.hasOwnProperty("status")&&(t.status=i.status,i.failedItemIds&&(t.failedItemIds=i.failedItemIds));break}return t},function(e){var t,n;if((e=Array.isArray(e)?e:[e])&&e[0]&&e[0].code){var i=e[0].code.split(", ");i&&2===i.length&&(t=i[0],n=i[1])}for(var r="-2146232832"===t&&"Microsoft.SharePoint.SPFieldValidationException"===n,s=0;s<l.length;s++){var d=l[s];d.hasException=0===s||r,d.state=o.t.ready}var u=Object(g.t)(c._pageContext)+a.clientForm.item.properties.FileRef;throw e.filter(function(e){return e&&e.message&&e.message.value}).map(function(e){return e.message.value=e.message.value.replace('"'.concat(u,'" '),""),e})})},t.prototype._isEventField=function(e){var t,n,a=null===(n=null===(t=e.schema)||void 0===t?void 0:t.Id)||void 0===n?void 0:n.toLowerCase();return"64cd368d-2f95-4bfc-a1f9-8d4324ecb007"===a||"2684f9f2-54be-429f-ba06-76754fc056bf"===a},t.prototype._getUpdateItemPromise=function(e,t,n,a,r,c,d,l,m,_){var h,b=this;return d&&0!==d.length&&c&&0!==c.length?this.getData(t.bind(null,l),function(e){var t=JSON.parse(e);if(!t.d||!t.d[r]||!t.d[r].results){for(var n=0,s=c;n<s.length;n++)(L=s[n]).state=o.t.ready;return Be?i.Promise.wrapError("The server response couldn't be processed"):h={status:u.e.partialSuccess,errorMessage:"The server response couldn't be processed"}}for(var d=null,f={},_="",g=0,v=t.d[r].results;g<v.length;g++){var y=v[g];if(a.clientForm.formType===p.e.newItem&&"Id"===y.FieldName){var S=l;S.properties||(S.properties={}),S.properties.ID=y.FieldValue}if(!0===y.HasException||null!==y.ErrorMessage){var D=y.FieldName;if(f[D]||(f[D]=[]),void 0!==y.ItemId&&f[D].indexOf(y.ItemId)<0&&f[D].push(y.ItemId),!d){d={};for(var I=0,x=a.clientForm.fields;I<x.length;I++){var C=x[I];d[C.schema.Name]=C}}if(d[D]){d[D].errorMessage=y.ErrorMessage,d[D].hasException=!0;var O=d[D].schema.Title;_=_?_+", "+O:O}}}if(h={status:_?u.e.fail:u.e.success},m&&m.length&&f.null){var w=f.null;w.length<m.length?h.status=u.e.partialSuccess:h.status=u.e.fail,h.failedItemIds=w}for(var E=0,A=c;E<A.length;E++){var L=A[E];_?!f[L.schema.Name]&&a.isInteractiveSave&&(L.errorMessage="Cannot save due to errors in other fields: "+_,L.hasException=!0):(L.errorMessage="",L.hasException=!1),L.state=o.t.ready}return b._raiseCreateOrUpdateEvents(a,h),h},e,function(){return n(d)},"POST",this._getAdditionalHeaders(a.clientForm.formType,_),void 0,5,void 0,void 0,function(e){if(!Be){var t=e.eventData,n=e.errorData;if(n){var a=!1;return f.indexOf(n.code)>-1&&(a=!0),{eventData:Object(s.__assign)(Object(s.__assign)({},t),t.resultType!==i.ResultTypeEnum.ExpectedFailure?{resultType:a?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure}:{}),canRetry:Be?void 0:!a}}return{eventData:t}}}):Be?i.Promise.wrap():(h={status:u.e.partialSuccess},i.Promise.wrap(h))},t.prototype._getUrlInfo=function(){var e=this._itemUrlHelper.getUrlParts({listUrl:this._listContext.listUrl});return{listUrl:e&&e.serverRelativeListUrl?e.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:e}},t.prototype._isClientFormFieldUpdated=function(e,t,n,a){return!(e.clientForm.isBulkEdit&&""===t&&null===n||a.schema.AppendOnly&&!t&&!Object(H.t)(this._pageContext.listBaseTemplate)||("thumbnail"===a.schema.FieldType.toLowerCase()?a.data.fileName&&n.fileName&&a.data.serverRelativeUrl===n.serverRelativeUrl:i.deepCompare(t,n)))},t.prototype._postUpdateFields=function(e,t,n){var a=this,r=t.clientForm,o=r.item;if(!this.isValidItem(o))return i.Promise.wrap({status:u.e.fail});for(var s=this._itemUrlHelper.getItemUrlParts(o.key).serverRelativeListUrl,c=n&&n.length>1,d=[],l=null,f=null,p=[],m=0;m<r.fields.length;m++){var _=r.fields[m];if(E.r(_)){if(!c&&_.data===_.serverData)continue;if(c){var h=this._updateMultipleComplianceTagsPromises(n,_,s);if(h)for(var b=0,g=h;b<g.length;b++){var v=g[b];d.push(v)}}else d.push(this._updateComplianceTagField(_,o));i.Engagement.logData({name:"ClientFormUpdate."+_.schema.FieldType.toLowerCase()})}else if(E.o(_)){if(!this.isFeatureEnabled(Le)||_.data===_.serverData)continue;var y=E.s(o.properties[E.e]);if(y===("1"===_.data)||c)continue;d.push(this._updateUnlockRecordField(o,_,s,y)),i.Engagement.logData({name:"ClientFormUpdate."+_.schema.FieldType.toLowerCase()})}else if("attachments"===_.schema.FieldType.toLowerCase())l=_;else if("sensitivitylabel"===_.schema.InternalName)f=_;else if("thumbnail"===_.schema.FieldType.toLowerCase()){if(!_.data&&!_.serverData)continue;if(_.data&&_.serverData&&_.data.serverRelativeUrl===_.serverData.serverRelativeUrl)continue;p.push(_)}}if(this.isFeatureEnabled(He)&&this._pageContext.isLabelIRMEnabled&&f){var S=t.graph,D=null==S?void 0:S.driveId,I=null==S?void 0:S.itemId,x=this._getCurrentSensitivityLabelTitle(this._sensitivityLabelOptions,f.data),C="none"===f.data;if((Ge?f.data!==x:C?r.sensitivityLabel!==f.data:f.data&&f.data.trim()&&r.sensitivityLabel!==x)&&D&&I){var O=!Ve&&C?"":f.data;i.Engagement.logData({name:"ClientFormSensitivityLabelUpdate",extraData:{Host:Object(T.e)()}}),d.push(i.Promise.resolve(this._sensitivityLabelsDataSource.setSensitivityLabel(D,I,O,f.justificationText).then(function(e){return r.sensitivityLabel=x,{status:u.e.success}},function(e){var t;if(Ke){var n=e.message;e.innerError&&(n=n+"."+e.innerError.message),f.errorMessage=n}else{var a=e.response.error;t=a&&a.code&&a.code.toString(),a.innerError&&(t=t+"."+a.innerError.code.toString()),f.hasException=!0,f.errorMessage=t}return{status:u.e.fail}})))}}return ze||(r.containsImageFieldData=p.length>0),n&&0!==n.length||(d.push(this._updateAttachmentsField(l,o,e)),this.isFeatureEnabled(Te)&&d.push(this._updateThumbnailFields(p,o,e===Ue))),i.Promise.all(d).then(function(e){var t;p.length>0&&a._pageContext.dataSyncClient&&a._pageContext.listId&&a._pageContext.siteId&&a._pageContext.dataSyncClient.then(function(e){e&&e.triggerListSyncNowForCurrentUser({listId:Object(G.t)(a._pageContext.listId,!1),siteId:Object(G.t)(a._pageContext.siteId,!1)})});for(var n={status:u.e.success},i=0,r=e;i<r.length;i++){var o=r[i];o&&o.status===u.e.fail&&(n.status=o.status),o&&o.failedItemIds&&o.failedItemIds.length>0&&(t=n.failedItemIds).push.apply(t,o.failedItemIds)}return n})},t.prototype._getCurrentSensitivityLabelTitle=function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return e[n].text;return""},t.prototype._updateComplianceTagField=function(e,t){var n,a=e.schema;return a.ComplianceTags&&(n=a.ComplianceTags.filter(function(t){return t&&t.tagValue===e.data})[0]),n?(e.state=o.t.saving,this._complianceTagProvider.updateComplianceTag(t,n).then(function(){return e.state=o.t.ready,{status:u.e.success}},function(t){return t&&e&&(e.errorMessage=t.message&&t.message.value?t.message.value:t,e.hasException=!0),e.state=o.t.ready,{status:u.e.fail}})):i.Promise.wrap(null)},t.prototype._updateMultipleComplianceTagsPromises=function(e,t,n){var a,i=t.schema,r=[];if(i.ComplianceTags&&(a=i.ComplianceTags.filter(function(e){return e&&e.tagValue===t.data})[0]),!a)return r;t.state=o.t.saving;for(var s=[],c=0,d=0,l=e.length;d<l;d++)s.push(e[d]),++c!==E.n&&d!==e.length-1||(r.push(this._complianceTagProvider.updateComplianceTagInBatch(s,a,n).then(function(e){return t.state=o.t.ready,e&&e.length>0?{status:u.e.fail,failedItemIds:e}:{status:u.e.success}},function(e){return e&&t&&(t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=o.t.ready,{status:u.e.fail,failedItemIds:s}})),s=[],c=0);return r},t.prototype._updateUnlockRecordField=function(e,t,n,a){var i="1"===t.data;return t.state=o.t.saving,i?this._complianceTagProvider.unlockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=o.t.ready,{status:u.e.success}},function(e){return e&&t&&(t.serverData=a?"1":"0",t.data="0",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=o.t.ready,{status:u.e.fail}}):this._complianceTagProvider.lockRecord(e,n).then(function(e){return t.serverData=e?"1":"0",t.state=o.t.ready,{status:u.e.success}},function(e){return e&&t&&(t.serverData=a?"1":"0",t.data="1",t.errorMessage=e.message&&e.message.value?e.message.value:e,t.hasException=!0),t.state=o.t.ready,{status:u.e.fail}})},t.prototype._updateAttachmentsField=function(e,t,n){var a=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingAttachmentOperations()?(e.state=o.t.saving,this._fileUploaderProvider.executeAttachmentOperations(n===Ue&&t&&t.properties?Number(t.properties.ID):void 0).then(function(t){return a._fileUploaderProvider.clearAttachmentOperations(),{status:a.handleFileUploaderErrors(t,e,[])?u.e.success:u.e.fail}},function(t){return a._fileUploaderProvider.clearAttachmentOperations(),{status:a.handleFileUploaderErrors(t,e,[])?u.e.success:u.e.fail}})):i.Promise.wrap(null)},t.prototype.isValidItem=function(e){return e&&e.properties&&e.properties.ID&&"0"!==e.properties.ID},t.prototype.handleFileUploaderErrors=function(e,t,n){var a={attachments:[]},r=!0;if(e.forEach(function(e){e.result||(e.attachment&&a.attachments.push(e.errorMsg),e.image&&(a[e.image.fieldName]=e.errorMsg),r=!1)}),t){if(a.attachments.length>0){var s=a.attachments.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage=s,t.hasException=!0}t.state=o.t.ready,i.Engagement.logData({name:"ClientFormUpdate."+t.schema.FieldType.toLowerCase()})}return n.forEach(function(e){a[e.schema.Name]&&(e.errorMessage=a[e.schema.Name],e.hasException=!0),e.state=o.t.ready,i.Engagement.logData({name:"ClientFormUpdate."+e.schema.FieldType.toLowerCase()})}),r},t.prototype._ensureClientForms=function(e){return this._clientForms&&this._contentTypeIdToNameMap&&!this._listContext.refreshClientForm?e?i.Promise.wrap(e()):i.Promise.wrap():(this._listContext.refreshClientForm=void 0,e?this.fetchAllClientFormSchemas().then(e):this.fetchAllClientFormSchemas().then(function(){return i.Promise.wrap()}))},t.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1},t.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],a=this._clientForms[e][n];return a?a.mode:this._checkRenderModes(this._formRenderMode.PowerApp)?this._formRenderMode.PowerApp:this._formRenderMode.Unknown},t.prototype._raiseCreateOrUpdateEvents=function(e,t){var n=e.clientForm;if(t&&t.status===u.e.success&&n){var a=n.item&&n.item.properties&&n.item.properties.ID?n.item.properties.ID:void 0,r=e.itemdIds&&e.itemdIds.length?e.itemdIds.map(String):a?[a]:void 0;r&&i.EventGroup.raise(window,n.formType===p.e.newItem?U.newItemCreated:U.itemUpdated,{itemIds:r})}},t.prototype._updateImages=function(e){return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(e?0:void 0,void 0,e):i.Promise.wrap([])},t.prototype._updateThumbnailFields=function(e,t,n){var a=this;return this._fileUploaderProvider&&this._fileUploaderProvider.hasPendingImageOperations()?this._fileUploaderProvider.executeImageOperationsOnSingleItem(Number(t.properties.ID),void 0,n).then(function(t){return{status:a.handleFileUploaderErrors(t,null,e)?u.e.success:u.e.fail}},function(t){return{status:a.handleFileUploaderErrors(t,null,e)?u.e.success:u.e.fail}}):i.Promise.resolve()},t}(l.t),qe=n("E01Q"),Qe="Folder",Ye={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},Je=qe.t.isActivated("1af89de3-0c7d-4708-a865-e33f368ec32c","06/08/2023","plumb ListContext to ClientFormDataSource as dependency"),Xe=qe.t.isActivated("37372d4f-59e8-4089-a035-603685b1fb7d","8/18/2023","updateListContextForFileUploaderProvider"),Ze=function(){function e(e,t){var n=this;this._buffer=[],this._bufferSize=5,this._init=function(e,t){var a,r;t&&t.pageContext?(n._pageContext=t.pageContext,n._listContext=t.listContext,a=t.apiUrlHelper,r=t.itemUrlHelper):(n._pageContext=e.pageContext,n._listContext=e.listContext,a=e.apiUrlHelper,r=e.itemUrlHelper,n._defaultValueOverride=e.defaultValueOverride||{});var o={isFeatureEnabled:e.isFeatureEnabled,fileUploaderProvider:e.fileUploaderProvider,complianceTagProvider:e.complianceTagProvider,getSharedLockId:e.getSharedLockId},s={pageContext:n._pageContext,apiUrlHelper:a,itemUrlHelper:r,getGraphAuthToken:null==e?void 0:e.getGraphAuthToken,listContext:n._listContext};n._clientFormDataSource?n._clientFormDataSource.updateContext(o,s):n._clientFormDataSource=new We(o,s),Je&&(n._clientFormDataSource.listContext=n._listContext),n.isFeatureEnabled=e.isFeatureEnabled?e.isFeatureEnabled:function(e){return i.FeatureOverrides.isFeatureEnabled(e,n._pageContext&&n._pageContext.ExpFeatures)}},this._getStoredClientFormId=function(e,t,n){return e+"|"+t+"|"+n},this._getClientFormData=function(e){if(e.status===u.t.pending){var t=new r.Signal;return e.onFinish=function(n){n=e.status||n,t.complete(e.clientForm)},t.getPromise()}return i.Promise.resolve(e.clientForm)},this._init(e,t)}return e.prototype.updateContext=function(e,t){this._init(e,t)},e.prototype.getClientForm=function(e,t,n){var a,r,o=this;void 0===t&&(t=!1),void 0===n&&(n=!1),t&&(this._listContext.refreshClientForm=!0);var s,c,d=e.itemId,l=e.item;if(!d&&l){var f=this._getBufferKeyFromItem(l,e.contentType);if(s=e.isBulkEdit?void 0:this._getClientFormFromBuffer(f),l.type!==i.ItemType.Folder||e.contentType||(e.contentType=Qe),s){if(l.hasClientFormData)return s.item=e.item,i.Promise.wrap(s);this._deleteClientFormFromBuffer(f)}}var m=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var _={},h=0,b=e.selection;h<b.length;h++){var g=b[h];if(g){var v=g.properties;if(v){var y=(I=g.type!==i.ItemType.Folder||v.ContentType?v.ContentType:Qe)+(S=v.ContentTypeId);_[y]||(m.push({contentType:I,contentTypeId:S}),_[y]=!0)}}}else m.push({contentType:e.contentType,contentTypeId:e.contentTypeId});if(d){var S,D=e.isBulkEdit,I=e.contentType,x=e.clientFormType,C=(S=e.contentTypeId)&&0===S.lastIndexOf(we,0),O="Media.Meeting"===(null===(r=null===(a=null==e?void 0:e.item)||void 0===a?void 0:a.properties)||void 0===r?void 0:r.ProgId)&&n&&!D&&!C;if(this.isFeatureEnabled(Ye)&&O){var w=this._getStoredClientFormId(d,I,D),E=this._getStoredClientForm(w);return E&&void 0!==E.status?this._getClientFormData(E).then(function(e){return o._deleteClientFormFromStoredClientForm(w),e}):(this._completeStoredClientForm(E,u.t.pending),this._clientFormDataSource.getClientForm(d,x,m,D).then(function(e){return o._completeStoredClientForm(E,u.t.success,e),e}))}return this._clientFormDataSource.getClientForm(d,e.clientFormType,m,e.isBulkEdit)}return this._clientFormDataSource.getClientFormSchema(e.clientFormType,m).then(function(t){if(e.item&&!e.item.properties.ContentTypeId&&(e.item.properties.ContentTypeId=t.contentTypeId,e.item.properties.ContentType=t.contentType),c={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],clientFormCustomFormatter:t.clientFormCustomFormatter,isBulkEdit:e.isBulkEdit},o._generateFieldsFromSchema(c,t),e.clientFormType!==p.e.newItem)return o.updateFormValues(c)}).then(function(){return o._addClientFormToBuffer(c),i.Promise.wrap(c)})},e.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)},e.prototype.updateItem=function(t){return t.clientForm.isBulkEdit&&t.itemdIds&&(this._buffer=[],e._clientFormStore=[]),this._clientFormDataSource.updateItem(t)},e.prototype.saveCustomShowHideRules=function(e,t,n){return this._clientFormDataSource.saveCustomShowHideRules(e,t,n)},e.prototype.saveClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.saveClientFormCustomFormatter(e,t)},e.prototype.getClientFormCustomFormatter=function(e,t){return this._clientFormDataSource.getClientFormCustomFormatter(e,t)},e.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)},e.prototype.getFieldFilterData=function(e,t,n){return this._clientFormDataSource.getFieldFilterData(e,t,n)},e.prototype.getClientFormSchema=function(e,t,n){return this._clientFormDataSource.getClientFormSchema(e,[{contentType:t,contentTypeId:n}])},e.prototype.updatePanelViewInfo=function(e){return this._clientFormDataSource.updatePanelViewInfo(e)},e.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)},e.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},a=0,r=e.selection;a<r.length;a++){var o=r[a];if(o){var s=o.properties;if(s){var c=o.type!==i.ItemType.Folder||s.ContentType?s.ContentType:Qe,d=s.ContentTypeId,l=c+d;n[l]||(t.push({contentType:c,contentTypeId:d}),n[l]=!0)}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t},e.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)},e.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)},e.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()},e.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()},e.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()},e.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()},e.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)},e.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()},e.prototype.clearBuffer=function(){this._buffer=[]},e.prototype.updateListContext=function(e){this._listContext=e,this._clientFormDataSource.listContext=e,Xe||(this._clientFormDataSource.fileUploaderProvider=new O.e({pageContext:this._pageContext,listUrl:null==e?void 0:e.listUrl}))},e.prototype.getResourceProviders=function(){return this._clientFormDataSource.getResourceProviders()},e.prototype.updateDefaultValueOverride=function(e){this._defaultValueOverride=e},e.prototype.clearStoreClientForm=function(){e._clientFormStore=[]},e.prototype.getCustomAllowedExternalDomains=function(){var t=this._pageContext.webAbsoluteUrl,n=e._customAllowedDomainsCache;return n[t]||(n[t]=this._clientFormDataSource.getCustomAllowedExternalDomains()),n[t]},e.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,a=0,i=t.fields.length;a<i;a++){var r=t.fields[a];void 0!==this._defaultValueOverride[r.InternalName]&&(r.DefaultValue=this._defaultValueOverride[r.InternalName],r.DefaultValueFormatted="",r.DefaultValueTyped=""),("Attachments"!==r.Type||n)&&(!e.isBulkEdit||!r.ReadOnlyField)&&e.fields.push(this._generateField(e,r))}},e.prototype._generateField=function(e,t){return{hasException:!1,errorMessage:"",schema:t,state:o.t.ready}},e.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t},e.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var a=this._buffer[t].key;if(a===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;return this._buffer.splice(t,1),this._buffer.unshift({key:a,form:i}),i}}return null},e.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit){var t=e.item;t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}},e.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++)if(this._buffer[t].key===e){this._buffer.splice(t,1);break}},e.prototype._getStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t)return e._clientFormStore[n];var a={onFinish:void 0,clientFormId:t,clientForm:void 0,status:void 0};return e._clientFormStore.push(a),a},e.prototype._deleteClientFormFromStoredClientForm=function(t){for(var n=0;n<e._clientFormStore.length;n++)if(e._clientFormStore[n].clientFormId===t){e._clientFormStore.splice(n,1);break}},e.prototype._completeStoredClientForm=function(t,n,a){for(var i=0;i<e._clientFormStore.length;i++)e._clientFormStore[i].clientFormId===t.clientFormId&&(e._clientFormStore[i].status=n,a&&(e._clientFormStore[i].clientForm=a),t.onFinish&&t.onFinish(n))},e._clientFormStore=[],e._customAllowedDomainsCache={},e}()},JyUB:function(e,t,n){"use strict";n.d(t,"e",function(){return u}),n.d(t,"t",function(){return f});var a,i=n("17wl");!function(e){e[e.any=0]="any",e[e.file=1]="file",e[e["!file"]=-1]="!file",e[e.folder=2]="folder",e[e["!folder"]=-2]="!folder",e[e.media=3]="media",e[e["!media"]=-3]="!media",e[e.photo=4]="photo",e[e["!photo"]=-4]="!photo",e[e.video=5]="video",e[e["!video"]=-5]="!video",e[e.document=6]="document",e[e["!document"]=-6]="!document",e[e.audio=7]="audio",e[e["!audio"]=-7]="!audio",e[e.word=8]="word",e[e["!word"]=-8]="!word",e[e.powerpoint=9]="powerpoint",e[e["!powerpoint"]=-9]="!powerpoint",e[e.excel=10]="excel",e[e["!excel"]=-10]="!excel",e[e.onenote=11]="onenote",e[e["!onenote"]=-11]="!onenote",e[e.zip=12]="zip",e[e["!zip"]=-12]="!zip",e[e.pdf=13]="pdf",e[e["!pdf"]=-13]="!pdf",e[e.text=14]="text",e[e["!text"]=-14]="!text",e[e.listItem=15]="listItem",e[e["!listItem"]=-15]="!listItem"}(a||(a={}));var r=n("iP7s"),o=n("K9kD"),s=n("PSxD"),c=n("mflv"),d=n("Z29y"),l=function(){var e=new(0,window.XMLSerializer);return l=function(){return e},e};function u(e,t,n){var a=function(e){var t=e.context,n=e.listContext,a=e.pageSize,i=t.viewXml,u=t.firstGroupOnly,f=t.expandGroups,p=t.allowMultipleValueFilterForTaxonomyFields,m=t.groupByOverride,_=t.requestDatesInUtc,h=t.groupReplace,b=t.additionalFiltersXml,g=t.mergeDefaultView,v=t.showStubFile,y=t.modernListBoot,S=t.requireFolderColoringFields,D=function(e){return"undefined"!=typeof _spPageContextInfo&&_spPageContextInfo&&_spPageContextInfo.webTemplate&&(e.webTemplate=_spPageContextInfo.webTemplate),function(e){var t=e.disableAutoHyperlink,n=e.fieldNames,a=void 0===n?[]:n,i=e.needsSchema,r=e.needsContentTypes,o=e.needsListAvailableContentTypes,s=e.needsContentTypeOrder,c=e.needsGridInitInfo,d=e.needsForms,l=e.needsQuickLaunch,u=e.needsSpotlight,f=e.needsViewMetadata,p=e.needsParentInfo,m=e.needsMountPoint,_=e.requestToken,h=e.isListDataRenderOptionChangeFeatureEnabled,b=e.isSpotlightFeatureEnabled,g=e.needUpdatePageContext,v=e.needClientSideComponentManifest,y=e.renderCustomActions,S=e.renderSpfxCustomActions,D=0;return(i||_)&&(i?(D|=7,h&&(D|=4096)):D|=2,a.indexOf("name.FileSystemItemId")>-1&&(D|=32)),r&&(D|=16),o&&(D|=65536),s&&(D|=131072),c&&(D|=262144),b&&u&&(D|=258),d?D|=64:h&&(D|=4098),l&&(D|=128),f&&(D|=1536),p&&(D|=8192),m&&(D|=1048576),g&&(D|=16384),v&&(D|=32768),t&&(D|=2048),y&&(D|=4194304),S&&(D|=2097152),D}(e)}(t),I=!(n&&n.urlParts&&n.urlParts.siteRelation===r.n.crossSite),x=m||b||"number"==typeof a?function(e){var t="",n="",a=e.groupByField,i=e.fetchNextGroupXml,r=e.additionalFiltersXml,o=e.pageSize;e.disableGrouping?t="<GroupBy />":a&&(t='<GroupBy Collapse="FALSE"><FieldRef Name="'.concat(a,'"/></GroupBy>'));var s="";return i&&(s=i),r&&(s=s?"<And>".concat(s).concat(r,"</And>"):r),s&&(t+="<Where>".concat(s,"</Where>")),o&&(n="<RowLimit>".concat(o,"</RowLimit>")),t&&(t="<Query>".concat(t,"</Query>")),n||t?"<View>".concat(t).concat(n,"</View>"):""}({groupByField:m,additionalFiltersXml:i?void 0:b,pageSize:a}):void 0;i&&b&&(i=function(e){var t=e.viewXml,n=e.additionalFiltersXml;if(t&&n)try{var a=s.e(t),i=a.where;if(i||(i=a.xmlDoc.createElement(c.n.where),a.query.appendChild(i)),o.Killswitch.isActivated("A87EA41A-CD8C-42DB-908F-ACEFFB8CB988","4/30/2021","Get CombinedViewXml without using innerHTML as innerHTML property has some problems in IE"))i.innerHTML=i.innerHTML?"<And>"+i.innerHTML+n+"</And>":n;else{var r=i.childElementCount?"<And>"+l().serializeToString(i.firstElementChild)+n+"</And>":n,u=Object(d.s)(r).documentElement;i.childElementCount?i.replaceChild(u,i.firstElementChild):i.appendChild(u)}t=l().serializeToString(a.view)}catch(e){}return t}({viewXml:i,additionalFiltersXml:b}));var C={__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:D>0?D:void 0,ViewXml:i||void 0,OverrideViewXml:x||void 0,AllowMultipleValueFilterForTaxonomyFields:p||void 0,AddRequiredFields:I||void 0,MergeDefaultView:g||void 0,FilterOutChannelFoldersInDefaultDocLib:t.filterOutChannelFoldersInDefaultDocLib||void 0};return y&&(C.ModernListBoot=!0),v&&(C.ShowStubFile=!0),_&&(C.DatesInUtc=!0),h&&(C.ReplaceGroup=!0),f&&(C.ExpandGroups=!0),u&&(C.FirstGroupOnly=!0),S&&(C.RequireFolderColoringFields=!0),C}({context:e,listContext:t,pageSize:n});return JSON.stringify({parameters:a})}function f(e){var t,n=e.sortField,r=e.itemIds,s=e.itemRefs,c=e.isAscending,d=e.pageSize,l=e.fetchNextGroup,u=e.lastGroup,f=e.recurseInFolders,y=e.typeFilter,S=void 0===y?{filters:[]}:y,D=e.fieldNames,I=void 0===D?[]:D,x=e.groupBy,C=void 0===x?[]:x,O=e.userIsAnonymous,w=void 0!==O&&O,E=e.requestMetaInfo,A=void 0!==E&&E,L=e.requestCommentFlags,k=void 0!==L&&L,M=e.fileTypeIconMap,P="",T="",U="",F="",H=!1;if(d||(d=1),C&&C.length>0){var R=C.map(function(e){return'<FieldRef Name="'.concat(e,'"/>')}).join("");P='<GroupBy Collapse="FALSE">'.concat(R,"</GroupBy>")}if(l&&(t=function(e){var t=e.fieldSchema.Name,n=!o.Killswitch.isActivated("69f4bf91-aa36-4e53-9659-8d083662b4ab","2/22/2021","Use ResultType as type if possible")&&!!e.fieldSchema.ResultType&&e.fieldSchema.ResultType||e.fieldSchema.Type,a=e.fieldSchema.Ascending&&"false"===e.fieldSchema.Ascending.toLowerCase(),i=a?"Lt":"Gt",r=e.groupingId;if("DateTime"===n){if("(null)"===r&&!a)return"<IsNotNull>"+'<FieldRef Name="'.concat(t,'" />')+"</IsNotNull>";if(e.fieldFilterByValue)r=e.fieldFilterByValue;else if("(null)"!==r)try{var s=new Date(r);r="".concat(s.getUTCFullYear(),"-").concat(s.getUTCMonth()+1,"-").concat(s.getUTCDate(),"T00:00:00Z")}catch(e){}}else"Boolean"===n&&""===r&&(r="-1");var c="<".concat(i,">")+'<FieldRef Name="'.concat(t,'" />')+'<Value Type="'.concat(n,'"><![CDATA[').concat(r,"]]></Value>")+"</".concat(i,">");return!a||"(null)"===r&&""===e.fieldFilterByValue||(c='<Or><IsNull><FieldRef Name="'.concat(t,'" /></IsNull>').concat(c,"</Or>")),c}(u)),r&&r.length>0||s&&s.length>0){var N=[],B=[];if(r)for(var j=0,V=r;j<V.length;j++){var z=V[j];isNaN(Number(z))?N.push(z):B.push(z)}t=g([v("ID",1===B.length?"Number":"Counter",B),v("UniqueId","Guid",N),v("FileRef","Text",s&&s.map(function(e){return"<![CDATA[".concat(e,"]]>")}))]),f&&(F='Scope="RecursiveAll"')}else U=n?'<OrderBy><FieldRef Name="'.concat(n,'" Ascending="').concat(c,'"></FieldRef></OrderBy>'):"",H=!0;return S.filters.length&&(t=function(e,t){void 0===t&&(t={});for(var n=t.fileTypeIconMap,r=[],o=[],s=[],c=[],d=0,l=0,u=e.filters;l<u.length;l++){var f=u[l];if("string"==typeof f){var y=f,S=!1;"!"===y[0]&&(y=y.slice(1),S=!0);var D="."===y[0],I=D?y.slice(1):y;if(D){var x=b.replace("${extType}",I);S?c.push(x):s.push(x)}else switch(a[I]){case a.photo:n&&(S?o.push(v("File_x0020_Type","String",n.photo.extensions,!0)):r.push(v("File_x0020_Type","String",n.photo.extensions,!1)));break;case a.video:n&&(S?o.push(v("File_x0020_Type","String",n.video.extensions,!0)):r.push(v("File_x0020_Type","String",n.video.extensions,!1)));break;case a.audio:n&&(S?o.push(v("File_x0020_Type","String",n.audio.extensions,!0)):r.push(v("File_x0020_Type","String",n.audio.extensions,!1)));break;case a.folder:d+=S?-1:1;break;case a.onenote:S?o.push(h):r.push(_)}}else switch(f){case a.listItem:case a.file:return"";case a.photo:case a["!photo"]:n&&(f<0?o.push(v("File_x0020_Type","String",n.photo.extensions,!0)):r.push(v("File_x0020_Type","String",n.photo.extensions,!1)));break;case a.video:case a["!video"]:n&&(f<0?o.push(v("File_x0020_Type","String",n.video.extensions,!0)):r.push(v("File_x0020_Type","String",n.video.extensions,!1)));break;case a.audio:case a["!audio"]:n&&(f<0?o.push(v("File_x0020_Type","String",n.audio.extensions,!0)):r.push(v("File_x0020_Type","String",n.audio.extensions,!1)));break;case a.folder:case a["!folder"]:d+=f<0?-1:1;break;case a.onenote:case a["!onenote"]:f<0?o.push(h):r.push(_)}}return s.length>0&&r.push(v("File_x0020_Type","",s,!1)),c.length>0&&o.push(v("File_x0020_Type","",c,!0)),g([d>0?p:"",(C=Object(i.__spreadArray)(Object(i.__spreadArray)([g(r)],o,!0),[d<0?m:""],!1),C.reduce(function(e,t){return e&&t?"<And>".concat(e).concat(t,"</And>"):t||e},""))]);var C}(S,{fileTypeIconMap:M})),t&&(T="<Where>".concat(t,"</Where>")),function(e){var t=e.viewParams,n=e.query,a=e.pageSize,r=void 0===a?30:a,s=e.fieldNames,c=void 0===s?[]:s,d=e.userIsAnonymous,l=void 0!==d&&d,u=e.requestMetaInfo,f=void 0!==u&&u,p=e.requestCommentFlags,m=void 0!==p&&p;if(e.includeFields){if(c=Object(i.__spreadArray)(["_ip_UnifiedCompliancePolicyUIAction","ItemChildCount","FolderChildCount","SMTotalFileCount","SMTotalSize"],c,!0),f){var _=["MediaServiceFastMetadata","MediaServiceOCR"];o.Features.isFeatureEnabled({ODB:1208})&&_.push("MediaServiceTranscript"),c=Object(i.__spreadArray)(Object(i.__spreadArray)([],_,!0),c,!0)}m&&(c=Object(i.__spreadArray)(["_CommentFlags"],c,!0)),l||(c=Object(i.__spreadArray)(["SharedWith"],c,!0)),c=Object(i.__spreadArray)(["DocIcon","LinkFilename","Modified","Editor","FileSizeDisplay"],c,!0)}c=function(e){var t;if(e){t=[];var n=void 0;n={};for(var a=0,i=e;a<i.length;a++){var r=i[a];n[r]||(n[r]=!0,t.push(r))}}return t}(c);var h="";return c.length&&(h="<ViewFields>".concat(c.map(function(e){return'<FieldRef Name="'.concat(e,'"/>')}).join(""),"</ViewFields>")),"<View ".concat(t,">")+"<Query>".concat(n,"</Query>")+h+'<RowLimit Paged="TRUE">'.concat(r,"</RowLimit>")+"</View>"}({viewParams:F,query:U+P+T,pageSize:d,includeFields:H,fieldNames:I,userIsAnonymous:w,requestMetaInfo:A,requestCommentFlags:k})}var p='<Or><And><Eq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Eq><Eq><FieldRef Name="SortBehavior" /><Value Type="Text">1</Value></Eq></And><Eq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Eq></Or>',m='<And><Neq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Neq><Neq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Neq></And>',_='<Eq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Eq>',h='<Neq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Neq>',b='<Value Type="Text">${extType}</Value>';function g(e){return e.reduce(function(e,t){return e&&t?"<Or>".concat(e).concat(t,"</Or>"):t||e},"")}function v(e,t,n,a){if(!n||0===n.length)return"";var i='<FieldRef Name="'.concat(e,'" />'),r=t?n.map(function(e){return'<Value Type="'.concat(t,'">').concat(e,"</Value>")}):n;return"".concat(1===r.length?"".concat(a?"<Neq>":"<Eq>").concat(i).concat(r[0]).concat(a?"</Neq>":"</Eq>"):"<In>".concat(i,"<Values>").concat(r.join(""),"</Values></In>"))}},KTUx:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a={Unknown:0,Legacy:1,Classic:2,Modern:3,PowerApp:4,Customized:5},i={Unknown:0,Classic:1,Modern:2,PowerApp:3,Customized:4,MultiColumnsView:5},r={ready:0,saving:1,updating:2},o={Dropdown:0,Radio:1}},LzHh:function(e){e.exports=JSON.parse('{"t":"Encountering issue when uploading attachment {0}","e":"Encountering issue when deleting attachment {0}","n":"Encountering issue when uploading image {0}","a":"Can\\u0027t upload that file. Please select a file in a standard image format such as .png or .jpg."}')},"O/6m":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(i.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(i,Error));var r=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError,r=t.wrapErrorCode,o=i||void 0,s=o?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},"string"==typeof o.correlationId?{correlationId:o.correlationId}:{}),"boolean"==typeof o.isExpected?{isExpected:o.isExpected}:{}),"string"==typeof o.name?{code:o.name}:{}),"string"==typeof o.code?{code:o.code}:{}),"object"==typeof o.extraData?{extraData:o.extraData}:{}):{},c=t.correlationId,d=void 0===c?s.correlationId:c,l=t.isExpected,u=void 0===l?s.isExpected:l,f=t.extraData;return n.correlationId=d,n.isExpected=!!u,n.code=r&&s.code&&t.code&&"".concat(t.code," (").concat(s.code,")")||t.code||s.code||"",n.extraData=Object(a.__assign)(Object(a.__assign)({},s.extraData||{}),f||{}),n}return Object(a.__extends)(t,e),t}(i)},P8RM:function(e,t,n){"use strict";n.d(t,"e",function(){return f});var a=n("17wl"),i=n("K9kD"),r=n("y88i"),o=n("O/6m"),s=n("UHMa"),c=n("w9oE"),d=window&&window.performance,l={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},u="Bearer",f=function(){function e(e,t){this._sendUrlToGetFormDigestKSActive=i.KillSwitch.isActivated("2F2E0E27-606F-4542-90E2-56D10E78DC5B","03/24/2023","send url to getFormDigest"),this._sendSyncClientHeadersKs=i.Killswitch.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,a=void 0!==n&&n,o=t.sessionManagementProvider,s=t.urlDataSource,c=t.apiEvent,d=void 0===c?r.Api:c,l=t.cookieOrigin,u=t.isOffline,f=t.dataSyncClient;this._sessionManagementProvider=o,this._alwaysSendContentType=a,this._apiEvent=d,this._apiName=s&&"function"==typeof s.getApiName?s.getApiName():"Vroom",this._urlDataSource=s,this._cookieOrigin=l,this._isOffline=u,this._dataSyncClient=f,this._encodingFixEnabled=!i.Killswitch.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!i.FeatureOverrides.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._isPassAuthTokenInHeaderFeatureEnabled=i.FeatureOverrides.isFeatureEnabled({ODB:!0,ODC:"PassAuthTokenInHeader"}),this._driveIdUrlCheckEnabled=!i.Killswitch.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(n){var f=e.headers,m=void 0===f?{}:f,_=e.endpoint,h=e.driveUrl,b=e.driveId,g=e.apiName,v=e.disableLogging,y=void 0!==v&&v,S=e.timeout,D=e.onProgress,I=e.onUploadProgress,x=e.qosExtraData,C=e.apiVersion,O=void 0===C?"v2.0":C,w=e.needsAuthorization,E=void 0===w||w,A=e.postProcessQos,L=e.breakCache,k=e.allowCookies,M=e.hasContentType,P=void 0===M||M,T=e.useMultiPart,U=void 0!==T&&T,F=e.getErrorAsMessage,H=void 0!==F&&F,R=e.expectedErrors,N=n.path,B=n.accessToken,j=n.forceContentType,V=void 0!==j&&j,z=n.useExactAuthToken,G=void 0!==z&&z,K=n.headers;if(!_){var W="v2.1"===O?O:void 0;_=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:W,driveId:b}):t._urlDataSource.getVroomApiBaseUrl():void 0}if(t._driveIdUrlCheckEnabled&&h&&b&&("me"!==b?"".concat(_,"/drives/").concat(b):h)!==h)throw new o.e({code:"DriveIdAndDriveUrlMismatch"});var q=e.useAuthorizationHeaders,Q=void 0!==q&&q;t._isPassAuthTokenInHeaderFeatureEnabled&&(Q=!0);var Y=Object(a.__assign)(Object(a.__assign)({},l),e.expectedErrorCodes||{}),J=e.requestType,X=void 0===J?"GET":J,Z=t._cookieOrigin,$=new r.SimpleUri(N).authority?N:"".concat(_).concat(N),ee=function(n){var o,l,u="",f={};U?(u=i.Guid.generate(),f={"Content-Type":"multipart/form-data;boundary=".concat(u)}):f=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&P||V?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),H?{prefer:"rich-error-as-message"}:{}),m),t._sendSyncClientHeadersKs?{}:K),n.sessionToken&&n.sessionToken.tokenUrl&&0===N.indexOf("/drive/")?l=new i.Uri("".concat(n.sessionToken.tokenUrl,"/").concat(N.substring(7))):(l=new i.Uri(N),_&&!l.getScheme()&&(l=new i.Uri(_+N))),U&&(l.setQueryParameter("ump","1"),"POST"!==X&&(m["X-HTTP-Method-Override"]=X),X="POST");var p,h=l.toString();if(!U&&n.sessionToken){var b=n.sessionToken,v=b.accessToken,C=b.proofToken,O=b.wlidToken,w=b.isBadger;if(O)f=Object(a.__assign)(Object(a.__assign)({},f),{Authorization:"wlid1.1 ".concat(O)});else if(Q){if(v){var E=w?"badger":"bearer",k=G?v:"".concat(E," ").concat(v);f=Object(a.__assign)(Object(a.__assign)({},f),{Authorization:k})}C&&(f=Object(a.__assign)(Object(a.__assign)({},f),{"X-PROOF_TOKEN":C}))}else v&&l.setQueryParameter("access_token",v),C&&l.setQueryParameter("prooftoken",C)}if(U){var M="";if(M+="--".concat(u,"\r\n"),M+="Content-Disposition: form-data;name=data\r\n",m)for(var T=0,F=Object.keys(m);T<F.length;T++){var B=F[T];M+="".concat(B,": ").concat(m[B],"\r\n")}M+="Content-Type: application/json\r\n";var j=n.sessionToken;v=j.accessToken,w=j.isBadger,v&&(M+="Authorization: ".concat(E=w?"badger":"bearer"," ").concat(v,"\r\n")),H&&(M+="prefer: rich-error-as-message\r\n"),M+="\r\n",M+="".concat(void 0!==e.postData?e.postData:"","\r\n"),M+="--".concat(u,"--")}if(L&&l.setQueryParameter("r",Math.random().toFixed(8)),(null===(o=n.sessionToken)||void 0===o?void 0:o.authKey)&&l.setQueryParameter("authKey",n.sessionToken.authKey),!y){var z=new r.SimpleUri(h),W={url:"".concat(z.authority,"/{ length: ").concat(z.path.length,", segments: ").concat(z.segments.length," }"),name:"".concat(t._apiName,"DataRequest.").concat(g),extraData:x};p=new t._apiEvent(W)}var q=l.toString(),J=d&&d.now();return r.XHRPromise.start({url:q,headers:f,method:X,json:M||e.postData||"",requestTimeoutInMS:S,withCredentials:n.useCookies,onProgress:D,onUploadProgress:I,responseType:e.responseType||void 0}).then(function(t){var n,a,i=Object(r.getRequestEntryDurationMetrics)(q,J);if(p){var o=null!==(a=null===(n=t.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==a?a:"",s={resultType:r.ResultTypeEnum.Success,extraData:{rawRequestDuration:i.duration,performanceEntry:JSON.stringify(i),requestId:o.indexOf("sprequestguid:")>=0?t.getResponseHeader("sprequestguid"):o.indexOf("request-id:")>=0?t.getResponseHeader("request-id"):null,MSCorrelationVector:o.indexOf("ms-cv:")>=0?t.getResponseHeader("MS-CV"):null}};p.end(s)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var o,d=function(e,t){return A&&(e=A(e,t)),p&&p.end(e),i.Promise.reject(t)},u=Object(r.getRequestEntryDurationMetrics)(q,J);if(e instanceof Error){var f=i.Promise.isCanceled(e),m=f?r.ResultTypeEnum.ExpectedFailure:r.ResultTypeEnum.Failure,_={error:e.message,resultCode:f?"Canceled":"",resultType:m,extraData:{rawRequestDuration:u.duration,performanceEntry:JSON.stringify(u)}};return d(_,e)}if(e.responseText)try{o=JSON.parse(e.responseText)}catch(e){}if(H)try{var h=t._encodingFixEnabled?JSON.parse((b=o.error.message,decodeURIComponent(escape(atob(b))))):JSON.parse(atob(o.error.message));o={error:h}}catch(e){}var b,g=e.status,v=e.statusText,y=(o||{}).error,S=void 0===y?{}:y,D=S.message,I=void 0===D?"":D,C=S.innerError,O=void 0===C?{}:C,w=O.stackTrace,E=void 0===w?"":w,L=O.debugMessage,k=void 0===L?"":L;return(g||!t._isOffline?i.Promise.resolve(!1):t._isOffline()).then(function(t){var i,f,p=t?"Offline":"",m=null!==(f=null===(i=e.getAllResponseHeaders())||void 0===i?void 0:i.toLowerCase())&&void 0!==f?f:"",_=m.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||m.indexOf("request-id")>=0&&e.getResponseHeader("request-id"),h=t||!!Object(s.t)(o,g,function(e){return Y[e]}),b=new s.e(new Error(I||p),{response:o,status:g,request:e,correlationId:_,isExpected:h});R&&Object(c.isExpectedError)({code:b.code,message:I},R)&&(h=!0);var y={resultType:h?r.ResultTypeEnum.ExpectedFailure:r.ResultTypeEnum.Failure,error:I,resultCode:b.code,extraData:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},x||{}),Object(s.n)(b)),{stack:E,httpStatus:g,httpStatusText:v,requestId:_,correlationId:_,MSCorrelationVector:m.indexOf("ms-cv:")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:k,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:l.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:u.duration,performanceEntry:JSON.stringify(u)})};return d(y,b)})})},te=t._sessionManagementProvider;if(E){if(B)return ee({sessionToken:B});var ne=new r.SimpleUri($).authority;if(k&&ne&&Z&&ne===Z){if("GET"===X)return ee({useCookies:!0});if(te&&te.getFormDigest)return te.getFormDigest(t._sendUrlToGetFormDigestKSActive?void 0:$).then(function(e){return ee({digestValue:e,useCookies:!0})})}if(te&&te.getSessionToken){var ae={apiVersion:O,endpoint:_,driveUrl:h,path:$};return i.Promise.resolve(te.getSessionToken(ae)).then(function(e){return ee({sessionToken:e}).catch(function(t){return e&&function(e){if(e instanceof s.e){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,u.length)===u&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?te.getSessionToken(Object(a.__assign)(Object(a.__assign)({},ae),{claimsChallenge:{sessionToken:e,claims:p(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?ee({sessionToken:n}):i.Promise.reject(t)}):i.Promise.reject(t)})})}if(te&&te.getToken)return te.getToken(O,$).then(function(e){return ee({sessionToken:e})})}return ee({})},f=Object(a.__assign)({},e);return!i.KillSwitch.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,r=e.getData,o=function(){return r(n)};return i.Promise.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t,n){var i=Object(a.__assign)(Object(a.__assign)({},e.options),{path:t.url,accessToken:{accessToken:t.authToken},forceContentType:!0,useExactAuthToken:!0,headers:n});return r(i)},o)}(t):o()})}({dataSyncClient:this._dataSyncClient,options:f,getData:n}):n(f)},e}();function p(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var r=t.indexOf('"',a+n.length);if(r>-1){var o=t.slice(a+n.length,r);return i.KillSwitch.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?o:atob(o)}}}}t.t=f},PSxD:function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"t",function(){return c}),n.d(t,"n",function(){return d});var a=n("mflv"),i=n("Z29y"),r=n("ynV5");function o(e){void 0===e&&(e="<View/>");var t,n,r,o,s,c,d,l,u,f,p,m=i.s(e),_=m.documentElement;if(_.tagName!==a.n.view)throw new Error('View XML outer element tag name must be "View" (case-sensitive)');for(var h=0,b=_.childNodes.length;h<b;h++)(v=_.childNodes[h]).nodeType===Node.ELEMENT_NODE&&(v.tagName!==a.n.viewFields||t?v.tagName!==a.n.query||n?v.tagName!==a.n.rowLimit||r?v.tagName===a.n.newDocumentTemplates?o=v:v.tagName===a.n.aggregations?s=v:v.tagName===a.n.viewType2?c=v:v.tagName===a.n.gridLayout?d=v:v.tagName===a.n.associatedContentTypeId?l=v:v.tagName===a.n.viewData?u=v:v.tagName===a.n.customOrder?f=v:v.tagName===a.n.viewStyles&&(p=v):r=v:n=v:t=v);t||(t=m.createElement(a.n.viewFields),_.appendChild(t)),n||(n=m.createElement(a.n.query),_.appendChild(n)),s&&_.appendChild(s);var g={xmlDoc:m,view:_,query:n,viewFields:t,rowLimit:r,newDocumentTemplates:o,aggregations:s,viewType2:c,gridLayout:d,associatedContentTypeId:l,viewData:u,customOrder:f,viewStyles:p};for(h=0,b=n.childNodes.length;h<b;h++){var v;(v=n.childNodes[h]).nodeType===Node.ELEMENT_NODE&&(v.tagName!==a.n.orderBy||g.orderBy?v.tagName!==a.n.groupBy||g.groupBy?v.tagName!==a.n.where||g.where||(g.where=v):g.groupBy=v:g.orderBy=v)}return g}function s(e){if(e)return Array.prototype.map.call(e.childNodes,function(e){return e.tagName===a.n.fieldRef?i.t(e,a.e.name):void 0}).filter(function(e){return!!e})}function c(e){if(e){var t={};t[a.e.name]=[],t[a.e.type]=[];for(var n=e.childNodes,r=0;r<n.length;r++){var o=n[r],s=i.t(o,a.e.type);o.tagName===a.n.fieldRef&&s.length>0&&(t[a.e.name].push(i.t(o,a.e.name)),t[a.e.type].push(s))}return t}}function d(e){if(e){for(var t="",n=e.childNodes,o=0;o<n.length;o++){var s=n[o],c=i.t(s,a.e.type);if(s.tagName===a.n.fieldRef&&c.length>0){var d=i.t(s,a.e.name);t+=r.format(a.t.aggregationsField,d,c)}}return t.length?t:void 0}}},Q17Z:function(e){e.exports=JSON.parse('{"r":"{0} TB","n":"{0} GB","i":"{0} MB","a":"{0} KB","e":"{0} bytes","t":"1 byte","o":"< 0.1 GB"}')},Rg6q:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i});var a={editItem:1,newItem:2,displayItem:3};function i(e){switch(e){case a.editItem:return"Edit";case a.newItem:return"New";case a.displayItem:return"Display";default:return"Unknown"}}},TUic:function(e,t,n){"use strict";var a=n("y88i"),i=function(){function e(){}return e.prototype.debounce=function(e){var t=this;this.clear(),this._originalPromise=e;var n=new a.Signal(function(){return t._originalPromise.cancel()});return this._originalPromise.done(function(e){t._clear(!1),n.complete(e)},function(e){t._clear(!1),n.error(e)}),n.getPromise()},e.prototype.clear=function(){this._clear(!0)},e.prototype.isExecuting=function(){return Boolean(this._originalPromise)},e.prototype._clear=function(e){this.isExecuting()&&(e&&this._originalPromise.cancel(),this._originalPromise=null)},e}();t.e=i},UHMa:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"t",function(){return s});var a=n("17wl"),i=function(e){function t(t,n){var i=this,r=n.response,o=(void 0===r?{}:r).error,c=(void 0===o?{}:o).innerError,d=(void 0===c?{}:c).stackTrace,l=void 0===d?"":d,u=n.response,f=n.request,p=n.status,m=n.code,_=void 0===m?s(u,p,function(e){return"".concat(e)})||"unhandled":m,h=Object(a.__assign)({innerError:t,code:_},n);return(i=e.call(this,h)||this).name="GraphError",i.response=u,i.status=p,i.serverStack=l,i.request=f,i.error=t,i}return Object(a.__extends)(t,e),t}(n("O/6m").e);function r(e){var t={};if(t.errorMessage=e.message,o(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function o(e){return e instanceof i}function s(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}},WIMm:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a={};n.r(a),n.d(a,"requiredDiagnostic",function(){return r}),n.d(a,"optionalDiagnostic",function(){return o}),n.d(a,"requiredService",function(){return s});var i=n("6czb"),r="requiredDiagnostic",o="optionalDiagnostic",s="requiredService",c=a,d=Object(i.createSingleEvent)({eventName:"Trace,",shortEventName:"Trace"},{message:1,privacyClassification:{isPrefixingDisabled:!0,type:1}}).withData({privacyClassification:c.requiredService,privacyDataTypes:["browsingHistory"]}),l=Object(i.createSingleEvent)({eventName:"Verbose,Trace,",shortEventName:"Verbose"},{name:{isKey:!0,type:1},privacyClassification:{isPrefixingDisabled:!0,type:1}},d).withData({privacyClassification:c.requiredService})},X39n:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl");function i(e,t,n,a){var i="",r=0;if(!e)return"";var o=e.length;for(r=0;r<o;r++){var s=e.charCodeAt(r),c=e.charAt(r);if(t&&("#"===c||"?"===c)){i+=e.substr(r);break}n&&"&"===c?i+=c:s<=127?a||s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(c)<0?i+=c:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase()):s<=2047?(i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):55296!=(64512&s)?(i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase()):r<e.length-1&&(s=(1023&s)<<10,r++,s|=1023&e.charCodeAt(r),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase())}return i}function r(e,t,n){var r="",o=!0;for(var s in t&&(e=Object(a.__assign)(Object(a.__assign)({},t),e)),e){var c,d=e[s];if(!n||"object"!=typeof d&&d||"object"==typeof d&&d&&d.uriValue||"number"==typeof d||"boolean"==typeof d)o?o=!1:r+="&",c="object"==typeof d&&d&&d.uriValue?d.uriValue:i("".concat(d)),r+="".concat(s,"=").concat(c)}return r}},YUrf:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.filters=0]="filters",e[e.sorts=1]="sorts",e[e.groupBy=2]="groupBy",e[e.fieldNames=3]="fieldNames",e[e.rowLimit=4]="rowLimit",e[e.columnWidth=5]="columnWidth",e[e.customFormatter=6]="customFormatter",e[e.newDocumentTemplates=7]="newDocumentTemplates",e[e.aggregations=8]="aggregations",e[e.viewType=9]="viewType",e[e.gridLayout=10]="gridLayout",e[e.customOrder=11]="customOrder",e[e.viewData=12]="viewData",e[e.viewStyles=13]="viewStyles",e[e.viewFields=14]="viewFields"}(a||(a={}))},Yw5A:function(e){e.exports=JSON.parse('{"t":"Not submitted","n":"Requested","a":"Rejected","e":"Approved"}')},Z29y:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"o",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"e",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"i",function(){return u}),n.d(t,"a",function(){return f});var a,i=n("mflv");function r(e,t){var n=e.attributes[t]||e.attributes[t.toLowerCase()];if(n&&n.value&&n.name===t)return n.value}function o(e,t){var n=e.createElement(i.n.fieldRef);return n.setAttribute(i.e.name,t.fieldName),"boolean"==typeof t.isAscending&&n.setAttribute(i.e.ascending,t.isAscending?"TRUE":"FALSE"),"boolean"==typeof t.lookupId&&n.setAttribute(i.e.lookupId,t.lookupId?"TRUE":"FALSE"),n}function s(e,t,n){"boolean"==typeof n?e.setAttribute(t,n?"TRUE":"FALSE"):e.removeAttribute(t)}function c(e,t,n,a){if(n&&r(n,i.e.name)===t.fieldName)s(n,i.e.ascending,t.isAscending);else{var c=o(e,t);n?a.replaceChild(c,n):a.appendChild(c)}}function d(e,t){if(void 0===t&&(t=i.n.and),e&&e.length){var n=new Array(e.length).join("<".concat(t,">")),a=e[0],r=e.slice(1).map(function(e){return"".concat(e,"</").concat(t,">")}).join("");return"".concat(n).concat(a).concat(r)}return""}function l(e){var t;try{t=a.parseFromString(e,i.t.doctype)}catch(e){throw new Error("Invalid XML (exception thrown)")}if(!t.documentElement)throw new Error("Invalid XML (documentElement does not exist)");if(t.querySelector("parsererror"))throw new Error("Invalid XML (parsererror found)");return t}function u(e){return i.t.todayRegex.test(e)}function f(e){return i.t.meRegex.test(e)}window.DOMParser&&(a=new DOMParser)},b69B:function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"n",function(){return d}),n.d(t,"e",function(){return l});var a=n("iP7s"),i=n("y88i"),r=n("WIMm"),o=n("K9kD");function s(e){var t,n,s=e.webUrl,d=e.webId,l=e.listId,u=e.view,f=e.searchTerm,p=e.rootFolder,m=e.sortField,_=e.sortDir,h=e.filterParams,b=e.groupString,g=e.requestToken,v=e.viewId,y=e.viewPath,S=e.urlParts,D=e.isOnePageNavigation,I=e.isPrefetchPageContext,x=e.uniqueId,C=e.remoteWebUrl,O=e.authToken,w=e.inplaceSearchMultiLineFieldQuery,E=C?[i.UriEncoding.escapeUrlForCallback(C)]:[i.UriEncoding.escapeUrlForCallback(s)];(C&&"/"!==C.slice(-1)||"/"!==s.slice(-1))&&E.push("/"),S&&(n=void 0===(t=S.siteRelation)?S.isCrossSite:t);var A=n!==a.n.sameSite;if(!O&&S&&(A||d)&&S.fullListUrl&&!D){E.push("_api/SP.List.GetListDataAsStream?listFullUrl='");var L=S.fullListUrl;if(C&&(L=new URL(C).origin+S.serverRelativeItemUrl),E.push(i.UriEncoding.encodeRestUriStringToken(L)),g)return"?"!==g[0]&&r.e.logData({name:"ListItemDataHelper.InvalidRequestToken",message:g}),E.push("'&"+g.substring(1)),E.join("");E.push("'&View=")}else{var k=S&&S.serverRelativeListUrl;if(k||(k=S&&S.serverRelativeItemUrl),k&&!I?E.push("_api/web/GetList(@listUrl)"):l?(E.push("_api/web/lists/GetById('"),E.push(l),E.push("')")):E.push("_api/web/DefaultDocumentLibrary"),g)return E.push("/RenderListDataAsStream"),E.push(g),E.push(c(k)),"string"==typeof f&&(E.push("&InplaceSearchQuery="),E.push(i.UriEncoding.encodeURIComponent(f))),E.join("");E.push("/RenderListDataAsStream?"),k&&E.push(c(k,!0)),E.push("View="),u&&E.push(u),y&&(E.push("&ViewPath="),E.push(i.UriEncoding.encodeURIComponent(y)))}return v&&E.push("&ViewId=".concat(v)),"string"==typeof f&&(E.push("&InplaceSearchQuery="),E.push(i.UriEncoding.encodeURIComponent(f))),p&&(E.push("&RootFolder="),E.push(i.UriEncoding.encodeURIComponent(p))),x&&(E.push("&RootFolderUniqueId="),E.push(i.UriEncoding.encodeURIComponent(x))),"string"==typeof b&&(E.push("&IsGroupRender=TRUE"),E.push("&DrillDown=1"),E.push("&GroupString=".concat(b))),m&&E.push("&SortField=".concat(m)),_&&E.push("&SortDir=".concat(_)),h&&(h.startsWith("&")||o.Killswitch.isActivated("8bcd8267-4968-45bc-b7f3-4cd9135477f7","3/07/2023","add & before filter params")?E.push(h):E.push("&".concat(h))),w&&(E.push("&InplaceSearchMultiLineFieldQuery="),E.push(i.UriEncoding.encodeURIComponent(w))),E.join("")}function c(e,t){var n=[];return e&&(t||n.push("&"),n.push("@listUrl='"),n.push(i.UriEncoding.encodeRestUriStringToken(e)),n.push("'"),t&&n.push("&")),n.join("")}function d(e,t){var n,a,r,o;return t&&(n=t.needsQuickLaunch,a=t.webId,r=t.siteId),e.listUrl?o="listUrl=".concat(i.UriEncoding.encodeURIComponent(e.listUrl)):e.listId&&(o="list=".concat(e.listId)),a&&(o+=",webId=".concat(a)),r&&(o+=",siteId=".concat(r)),{"X-SP-REQUESTRESOURCES":n?"NAVIGATIONSTRUCTURE,".concat(o):o}}function l(e,t,n){if(void 0===n&&(n="Text"),!t)return n;for(var a=0,i=t;a<i.length;a++){var r=i[a];if(r.Name===e)return r.FieldType}return n}},baHJ:function(e,t,n){"use strict";function a(e){if(e){if("string"!=typeof e)return e;var t=void 0;try{t=JSON.parse(e)}catch(e){}if(t&&0!==Object.getOwnPropertyNames(t).length)return t}}function i(e){var t=e.indexOf("?version=");return t>0?e.substring(0,t):e}n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n("E01Q").e.isActivated("3D3E7B22-3495-4C3E-9B4B-DEACF3B98622","08/16/2023","Show name of the image in Image field editor instead of the server-generated one with suffix and prefix")},boye:function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"t",function(){return l}),n.d(t,"a",function(){return f});var a=n("17wl"),i=n("y88i"),r=(n("YUrf"),n("b69B"),n("Z29y")),o=(n("y3bW"),n("chgu"),n("K9kD"),n("mflv"),"FilterLookupId");function s(e,t){t=i.UriEncoding.encodeURIComponent(t);var n=e.match(new RegExp("FilterField([0-9]+)="+t+"&"));return Boolean(n)||(n=e.match(new RegExp("FilterFields([0-9]+)="+t+"&"))),n}function c(e,t){t=i.UriEncoding.encodeURIComponent(t);var n=e.match(new RegExp("FilterField([0-9]+)="+t+"&FilterValue([0-9]+)=([^&]+)"));return Boolean(n)||(n=e.match(new RegExp("FilterFields([0-9]+)="+t+"&FilterValues([0-9]+)=([^&]+)"))),n?decodeURIComponent(n[n.length-1]):void 0}function d(e,t){return p("FilterField",e,t)}function l(e,t,n){var i,r="",o=0;do{i=d(e,++o),r+=u(e,o,Object(a.__assign)({excludeTodayFormatFilter:t},n||{}))}while(null!=i);return r}function u(e,t,n){void 0===n&&(n={});var a,s,c,l,u,f="",m=d(e,t),_=function(e,t){return p("FilterValue",e,t)}(e,t),h=function(e,t){return p("FilterType",e,t)}(e,t),b=function(e,t){return p("FilterDisplay",e,t)}(e,t),g=function(e,t){return p(o,e,t)}(e,t),v=function(e,t){return p("FilterOp",e,t)}(e,t),y=function(e,t){return function(e,t){var n=t.match(new RegExp(e+"=[^&#]*"));return Boolean(n)||(n=t.match(new RegExp(e+"s=[^&#]*"))),n}("FilterChannels",e)}(e),S=m&&m.toString(),D=_&&_.toString(),I=h&&h.toString(),x=b&&b.toString(),C=g&&g.toString(),O=v&&v.toString(),w=y&&y.toString(),E=n.excludeTodayFormatFilter,A=n.replaceMeFormatFilterWithCurrentUser,L=n.currentUserDisplayName;if((E||A&&L)&&I&&D){var k=String(I.substr(I.indexOf("=")+1)),M=String(D.substr(D.indexOf("=")+1)),P=k&&k.toLowerCase();if("datetime"===P||"user"===P||"usermulti"===P){var T=function(e,t,n){var a=";#".charAt(0),i=new RegExp(a+a,"g");return(e=decodeURIComponent(e)).split(";#").map(function(e){return e.replace(i,a)})}(M);if("datetime"===P&&T&&T.length&&Object(r.i)(T[0]))return;if("user"===P||"usermulti"===P){var U=!1,F=T.map(function(e){return Object(r.a)(e)?(U=!0,L):e});if(U){var H=(a=F,c=(s=";#").charAt(0),l=c+c,u=new RegExp(c,"g"),a.length>1&&(a=a.map(function(e){return e.replace(u,l)})),i.UriEncoding.encodeURIComponent(a.join(s)));D=F.length>1?"FilterValues".concat(t,"=").concat(H):"FilterValue".concat(t,"=").concat(H)}}}}return S&&D&&(f+="&"+S+"&"+D),I&&(f+="&"+I),x&&(f+="&"+x),C&&(f+="&"+C),O&&(f+="&"+O),w&&(f+="&"+w),f}function f(e){return Boolean(e.innerText)?e.innerText.toString():Boolean(e.textContent)?e.textContent.toString():e.innerHTML.toString()}function p(e,t,n){var a=t.match(new RegExp(e+String(n)+"=[^&#]*"));return Boolean(a)||(a=t.match(new RegExp(e+"s"+String(n)+"=[^&#]*"))),a}},cNe7:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"ResultTypeEnum")&&n.d(t,"ResultTypeEnum",function(){return a.ResultTypeEnum})},chgu:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a={standard:"HTML",datasheet:"GRID",calendar:"CALENDAR",recurrence:"RECURRENCE",chart:"CHART",gantt:"GANTT",power:"POWER",tiles:"TILES",compactList:"COMPACTLIST",modernCalendar:"MODERNCALENDAR",gridFixed:"GRIDFIXED",kanban:"KANBAN",listFixed:"LISTFIXED",playlistPlayback:"PLAYLISTPLAYBACK",forms:"FORMS"},i={dynamicHeight:0,fixedHeight:1},r={defaultScope:0,recursive:1,recursiveAll:2,filesOnly:3}},dq6a:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("K9kD"),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.noRedirect,s=t.dataRequestorType,c=void 0===s?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r,noRedirect:o})||this}return Object(a.__extends)(t,e),t}(i.DataRequestor):s,d=e.dataSourceName,l=void 0===d?"DataSource":d;this.dataRequestor=new c({qosName:l})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_){void 0===i&&(i="POST");var h=e(),b=a&&a(),g=this.needsRequestDigest(h);return this.dataRequestor.getData({url:h,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:g,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_})},e}();t.t=r},f3jH:function(e){e.exports=JSON.parse('{"e":"Missing info"}')},ftiL:function(e,t,n){"use strict";var a,i,r=n("17wl"),o=n("chgu"),s=n("YUrf"),c=n("K9kD"),d=n("mflv"),l=n("PSxD"),u=n("Z29y"),f=n("ynV5"),p=n("ozVI"),m=function(){var e=new(0,window.XMLSerializer);return m=function(){return e},e},_="CalendarViewStyle";!function(e){e[e.standard=1]="standard",e[e.datasheet=2048]="datasheet",e[e.calendar=524288]="calendar",e[e.recurrence=8193]="recurrence",e[e.chart=131072]="chart",e[e.gantt=67108864]="gantt",e[e.power=134217728]="power"}(a||(a={})),function(e){e.tiles="TILES",e.compactList="COMPACTLIST",e.modernCalendar="MODERNCALENDAR",e.gridFixed="GRIDFIXED",e.kanban="KANBAN",e.playlistPlayback="PLAYLISTPLAYBACK",e.listFixed="LISTFIXED",e.forms="FORMS"}(i||(i={}));var h=[o.n.tiles,o.n.compactList,o.n.modernCalendar,o.n.gridFixed,o.n.kanban,o.n.playlistPlayback,o.n.listFixed,o.n.forms],b=function(){function e(t){if("string"!=typeof t){var n=t;this.id=c.Guid.normalizeLower(n.Id,!1),this.title=n.Title,this.isDefault=n.DefaultView,this.isHidden=n.Hidden,this.isPersonal=!!n.PersonalView,this.isReadOnly=n.ReadOnlyView,this.modifiedInEditor=n.EditorModified,this.rowLimit=n.RowLimit,this.scope=n.Scope||o.t.defaultScope,this.serverRelativeUrl=n.ServerRelativeUrl,this.baseViewId=n.BaseViewId,this.baseViewXml=n.ListViewXml,this.customFormatter=n.CustomFormatter,this.viewData=n.ViewData;var a=n.TabularView,i=void 0===a||a;if(this.tabularView=i,e.isAppView(n))this.isHidden=!1,this.viewType=o.n.power,this.visualizationInfo=n.VisualizationInfo;else if(n.ViewType)switch(n.ViewType.toLowerCase()){case"html":this.viewType=o.n.standard;break;case"grid":this.viewType=o.n.datasheet;break;case"calendar":this.viewType=o.n.calendar;break;case"recurrence":this.viewType=o.n.recurrence;break;case"chart":this.viewType=o.n.chart;break;case"gantt":this.viewType=o.n.gantt}if(this._ensureDom(),this._viewDom&&this._viewDom.viewType2){if(this.viewType===o.n.standard)switch(this._viewDom.viewType2.textContent.toLowerCase()){case"tiles":this.viewType=o.n.tiles;break;case"compactlist":this.viewType=o.n.compactList;break;case"forms":this.viewType=o.n.forms;break;case"moderncalendar":this.viewType=o.n.modernCalendar;break;case"kanban":this.viewType=o.n.kanban;break;case"playlistplayback":this.viewType=o.n.playlistPlayback;break;case"listfixed":this.viewType=o.n.listFixed;break;default:this.viewType=o.n.standard}this.viewType===o.n.datasheet&&("gridfixed"===this._viewDom.viewType2.textContent.toLowerCase()?this.viewType=o.n.gridFixed:this.viewType=o.n.datasheet)}else this.getEffectiveGridLayout()===o.e.fixedHeight&&(this.viewType=o.n.gridFixed);this.viewData||c.Killswitch.isActivated("05F53EFF-C477-44AC-9D39-F630F46DCE8A","03/20/2021","Update ViewData from view XML")||(this.viewData=this.getViewData()),this._viewDom&&this._viewDom.customOrder&&(this.customOrder=this._viewDom.customOrder.textContent)}else this.baseViewXml=t}return e.isAppView=function(e){return!!(e&&e.Hidden&&e.VisualizationInfo&&2===e.VisualizationInfo.VisualizationType&&e.VisualizationInfo.VisualizationAppInfo&&e.VisualizationInfo.VisualizationAppInfo.Id)},e.prototype.canUserEdit=function(e){if(!e||this.isReadOnly)return!1;var t=e.managePersonalViews&&this.isPersonal;return e.manageLists||t},Object.defineProperty(e.prototype,"baseViewXml",{get:function(){return this._baseViewXml},set:function(e){this._baseViewXml=e,this.clearXmlOverrides()},enumerable:!1,configurable:!0}),e.prototype.getEffectiveViewXml=function(){var e=m();return this.isDirty()&&this._viewDom?e.serializeToString(this._viewDom.view):this._baseViewXml},e.prototype.getViewStyleFromViewXml=function(){var e=this.getDomParts();if(!e||!e.viewStyles)return"";try{var t=e.viewStyles;0===t.childElementCount&&t.textContent&&(t=this._parseDocumentFragment(t.textContent));var n=t.querySelector(_+'[Default="TRUE"]');return(null==n?void 0:n.getAttribute("Type"))||""}catch(e){return""}},e.prototype.getEffectiveQueryXml=function(e){this._ensureDom();var t=m();if(this._viewDom)return this._viewDom.query?e?t.serializeToString(this._viewDom.query):(this._viewDom.where?t.serializeToString(this._viewDom.where):"")+(this._viewDom.orderBy?t.serializeToString(this._viewDom.orderBy):"")+(this._viewDom.groupBy?t.serializeToString(this._viewDom.groupBy):""):e?"<Query/>":""},e.prototype.updateColumnWidths=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName("ColumnWidth"),n=t.length>0;this._viewDom.columnWidth=n?t[0]:this._xmlDoc.createElement(d.n.columnWidth);var a=c.Killswitch.isActivated("3D1A1888-230D-4B7B-B35B-40AB14EC5F11","10/19/2020","Column width query selector");for(var i in e){var r=e[i],o=a?"[Name=".concat(i,"]"):"[Name='".concat(i,"']"),l=this._viewDom.columnWidth.querySelector(o);if(l)l.setAttribute(d.e.width,r);else{var f=u.n(this._xmlDoc,{fieldName:i});f.setAttribute(d.e.width,r),this._viewDom.columnWidth.appendChild(f)}}n?this._viewDom.view.replaceChild(this._viewDom.columnWidth,t[0]):this._viewDom.view.appendChild(this._viewDom.columnWidth),this.setIsDirty(!0,s.e.columnWidth)},e.prototype.updateColumnAggregateType=function(e,t){if(this._ensureDom(),this._viewDom){var n=this._viewDom.aggregations,a=this._viewDom.view,i=!1;if(n){n.setAttribute(d.e.value,"On");var r=n.querySelector("[".concat(d.e.name,"=").concat(e,"]"));r?(t?r.setAttribute(d.e.type,t):(n.removeChild(r),0===n.childElementCount&&(this._viewDom.view.removeChild(n),this._viewDom.aggregations=void 0)),i=!0):t&&((o=this._xmlDoc.createElement(d.n.fieldRef)).setAttribute(d.e.name,e),o.setAttribute(d.e.type,t),n.appendChild(o),i=!0)}else if(t){var o;(n=this._xmlDoc.createElement(d.n.aggregations)).setAttribute(d.e.value,"On"),(o=this._xmlDoc.createElement(d.n.fieldRef)).setAttribute(d.e.name,e),o.setAttribute(d.e.type,t),n.appendChild(o),this._viewDom.aggregations=n,a.appendChild(n),i=!0}i&&this.setIsDirty(!0,s.e.aggregations)}},e.prototype.updateViewType=function(e){if(this._ensureDom(),this._viewDom){var t=void 0,n=void 0;switch(e){case o.n.standard:t=a.standard;break;case o.n.datasheet:t=a.datasheet;break;case o.n.calendar:t=a.calendar;break;case o.n.recurrence:t=a.recurrence;break;case o.n.chart:t=a.chart;break;case o.n.gantt:t=a.gantt;break;case o.n.tiles:t=a.standard,n=i.tiles;break;case o.n.compactList:t=a.standard,n=i.compactList;break;case o.n.modernCalendar:t=a.standard,n=i.modernCalendar;break;case o.n.gridFixed:t=a.datasheet,n=i.gridFixed;break;case o.n.kanban:t=a.standard,n=i.kanban;break;case o.n.playlistPlayback:t=a.standard,n=i.playlistPlayback;break;case o.n.listFixed:t=a.standard,n=i.listFixed;break;case o.n.forms:t=a.standard,n=i.forms}var r=this._viewDom.view,c=this._getViewType1String(t);r.setAttribute("Type",c),this._viewDom.viewType2&&(this._viewDom.view.removeChild(this._viewDom.viewType2),this._viewDom.viewType2=void 0),n&&(this._viewDom.viewType2=this._xmlDoc.createElement(d.n.viewType2),this._viewDom.viewType2.textContent=n,this._viewDom.view.appendChild(this._viewDom.viewType2)),t===a.datasheet&&this._viewDom.gridLayout&&(this._viewDom.view.removeChild(this._viewDom.gridLayout),this._viewDom.gridLayout=void 0),this.viewType=e,this.setIsDirty(!0,s.e.viewType)}},e.prototype.updateViewTitle=function(e){this.title=e,this._viewDom.view.setAttribute("DisplayName",e)},e.prototype.updateGridLayout=function(e){if(this._ensureDom(),this._viewDom&&!isNaN(e)){var t=this._viewDom.view.getElementsByTagName(d.n.gridLayout),n=t&&t.length;n||(this._viewDom.gridLayout=this._xmlDoc.createElement(d.n.gridLayout)),this._viewDom.gridLayout.setAttribute("Type",e.toString()),n?this._viewDom.view.replaceChild(this._viewDom.gridLayout,t[0]):this._viewDom.view.appendChild(this._viewDom.gridLayout),this.setIsDirty(!0,s.e.gridLayout)}},e.prototype.replaceAggregates=function(e){if(this._ensureDom(),this._viewDom){this._viewDom.aggregations&&(this._viewDom.view.removeChild(this._viewDom.aggregations),this._viewDom.aggregations=void 0);var t=this._viewDom.aggregations;if(e){var n=e[d.e.name],a=e[d.e.type];if(n&&a&&n.length===a.length)for(var i=0;i<n.length;i++){t||(t=this._xmlDoc.createElement(d.n.aggregations)).setAttribute(d.e.value,"On");var r=this._xmlDoc.createElement(d.n.fieldRef);r.setAttribute(d.e.name,n[i]),r.setAttribute(d.e.type,a[i]),t.appendChild(r)}}t&&(this._viewDom.aggregations=t,this._viewDom.view.appendChild(t)),this.setIsDirty(!0,s.e.aggregations)}},e.prototype.updateCustomFormatter=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName("CustomFormatter"),n=t.length>0;this._viewDom.customFormatter=n?t[0]:this._xmlDoc.createElement(d.n.customFormatter),this._viewDom.customFormatter.textContent="",e&&this._viewDom.customFormatter.appendChild(this._xmlDoc.createCDATASection(e)),n?this._viewDom.view.replaceChild(this._viewDom.customFormatter,t[0]):this._viewDom.view.appendChild(this._viewDom.customFormatter),this.setIsDirty(!0,s.e.customFormatter)},e.prototype.updateNewDocumentTemplates=function(e){this._ensureDom();var t=this._viewDom.view.getElementsByTagName(d.n.newDocumentTemplates),n=t.length>0;this._viewDom.newDocumentTemplates=n?t[0]:this._xmlDoc.createElement(d.n.newDocumentTemplates),this._viewDom.newDocumentTemplates.textContent=e,n?this._viewDom.view.replaceChild(this._viewDom.newDocumentTemplates,t[0]):this._viewDom.view.appendChild(this._viewDom.newDocumentTemplates),this.setIsDirty(!0,s.e.newDocumentTemplates)},e.prototype.getEffectiveGridLayout=function(){this._ensureDom();var e=this._viewDom&&this._viewDom.gridLayout&&u.t(this._viewDom.gridLayout,d.e.type),t=parseInt(e);return!t||t!==o.e.dynamicHeight&&t!==o.e.fixedHeight?void 0:t},e.prototype.getEffectiveFieldNames=function(){return this._ensureDom(),this._viewDom&&this._viewDom.viewFields?l.a(this._viewDom.viewFields):void 0},e.prototype.getEffectiveAggregatesData=function(){return this._ensureDom(),this._viewDom&&this._viewDom.aggregations?l.t(this._viewDom.aggregations):void 0},e.prototype.getEffectiveAggregatesFieldXml=function(){return this._ensureDom(),this._viewDom&&this._viewDom.aggregations?l.n(this._viewDom.aggregations):void 0},e.prototype.isDirty=function(e){return"number"==typeof e?!!this._modificationTypes&&-1!==this._modificationTypes.indexOf(e):this._isDirty},e.prototype.hasModification=function(e){return this._modificationTypes&&this._modificationTypes.indexOf(e)>-1},e.prototype.setIsDirty=function(e,t){this._isDirty=e,e?"number"==typeof t&&-1===this._modificationTypes.indexOf(t)&&this._modificationTypes.push(t):this._modificationTypes=[]},e.prototype.hasParseError=function(){return this._hasParseError},e.prototype.getDomParts=function(){return this._ensureDom(),this._viewDom},e.prototype.clearXmlOverrides=function(){this._hasParseError=!1,this._xmlDoc=void 0,this._viewDom=void 0,this.setIsDirty(!1)},e.prototype.prepareForSaving=function(){if(this._ensureDom(),this._viewDom&&this._viewDom.where)for(var e=this._viewDom.where.querySelectorAll("[id]"),t=0;t<e.length;t++)e[t].removeAttribute("id"),this._isDirty||(this._isDirty=!0)},e.prototype.updateSort=function(e,t){void 0===t&&(t={}),this._ensureDom();var n=t.removeSort,a=t.overwriteAll,i=t.prepend,r=!e&&a;if(this._viewDom&&(r||e)&&(!n||this._viewDom.orderBy)){var o=this._viewDom.orderBy;if(r)return o&&this._viewDom.query.removeChild(o),this._viewDom.orderBy=void 0,void this.setIsDirty(!0,s.e.sorts);var c=!1;o||r||(o=this._viewDom.orderBy=this._xmlDoc.createElement(d.n.orderBy),this._viewDom.query.appendChild(o),c=!0);var l=o.querySelector(f.format(d.t.fieldNameQuery,e.fieldName));if(n)l&&(o.removeChild(l),c=!0,o.childElementCount||(this._viewDom.query.removeChild(o),this._viewDom.orderBy=void 0));else{c=!0,l&&u.o(l,d.e.ascending,e.isAscending);var p=void 0;if(a){for(var m=o.lastChild;m;m=o.lastChild)o.removeChild(m);p=!0}else p=!l;p&&(l=l||u.n(this._xmlDoc,e),i?o.insertBefore(l,o.firstChild):o.appendChild(l))}c&&this.setIsDirty(!0,s.e.sorts)}},e.prototype.updateGroupBy=function(e){if(this._ensureDom(),this._viewDom){var t=this._viewDom.query,n=this._viewDom.groupBy;if(e&&e.group1&&e.group1.fieldName){var a,i,r=e.isCollapsed,o=e.group1,c=e.group2;n||(this._viewDom.groupBy=n=this._xmlDoc.createElement(d.n.groupBy),t.appendChild(n)),u.o(n,d.e.collapse,r),n.childElementCount>0&&(i=(a=n.firstElementChild).nextElementSibling),u.r(this._xmlDoc,o,a,n),c&&c.fieldName&&c.fieldName!==o.fieldName?u.r(this._xmlDoc,c,i,n):i&&n.removeChild(i),this.setIsDirty(!0,s.e.groupBy)}else n&&(t.removeChild(n),this._viewDom.groupBy=void 0,this.setIsDirty(!0,s.e.groupBy))}},e.prototype.updateGroupByCollapseAttribute=function(e){if(this._ensureDom(),this._viewDom){var t=this._viewDom.groupBy;t&&u.o(t,d.e.collapse,e),this.setIsDirty(!0,s.e.groupBy)}},e.prototype.updateGroupByGroupLimitAttribute=function(e){if(this._ensureDom(),this._viewDom){var t=this._viewDom.groupBy;t&&t.setAttribute(d.e.groupLimt,e.toString()),this.setIsDirty(!0,s.e.groupBy)}},e.prototype.updateField=function(e,t){if(this._ensureDom(),this._viewDom&&e){var n=!1,a=this._viewDom.viewFields,i=a.querySelector(f.format(d.t.fieldNameQuery,e));i&&(n=!0,a.removeChild(i)),"number"==typeof t&&(n=!0,i||(i=u.n(this._xmlDoc,{fieldName:e})),t>=a.childElementCount?a.appendChild(i):t>=0&&p.e.insertAtIndex(a,i,t,d.n.fieldRef)),n&&this.setIsDirty(!0,s.e.fieldNames)}},e.prototype.replaceFields=function(e,t){if(this._ensureDom(),this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){for(var n={},a=0;a<e.length;a++)n[e[a]]?n[e[a]].indexes.push(a):n[e[a]]={indexes:[a]},t&&"boolean"==typeof t[a]&&(n[e[a]].lookupId=t[a]);for(var i=this._viewDom.viewFields,r=i.firstElementChild;r;r=r.nextElementSibling){var o=u.t(r,d.e.name);n[o]&&(n[o].elem=r)}var c=this._viewDom.viewFields=this._xmlDoc.createElement(d.n.viewFields);this._viewDom.view.replaceChild(c,i);for(var l=[],f=function(e){var t=n[e],a=t.elem;a||(a=u.n(p._xmlDoc,{fieldName:e,lookupId:t.lookupId})),t.indexes.forEach(function(e,t){l[e]=0===t?a:a.cloneNode(!0)})},p=this,m=0,_=Object.keys(n);m<_.length;m++)f(o=_[m]);for(var h=0,b=l;h<b.length;h++)(r=b[h])&&c.appendChild(r);this.setIsDirty(!0,s.e.fieldNames)}},e.prototype.clearFilters=function(){this._ensureDom(),this._viewDom.where&&(this._viewDom.query.removeChild(this._viewDom.where),this._viewDom.where=void 0,this.setIsDirty(!0,s.e.filters))},e.prototype.addFilters=function(e){if(this._ensureDom(),this._viewDom&&e&&(e=e.filter(function(e){return!!e})).length){var t,n=u.e(e,d.n.and);if(!n)throw new Error("Invalid filter: must be defined and have values");this.setIsDirty(!0,s.e.filters);try{t=u.s(n).documentElement}catch(e){throw new Error("Generated filter was not valid XML!")}var a=this._viewDom.where;if(a||(a=this._viewDom.where=this._xmlDoc.createElement(d.n.where),this._viewDom.query.appendChild(a)),a.childElementCount){var i=a.firstElementChild,r=this._xmlDoc.createElement(d.n.and);r.appendChild(i),r.appendChild(t),a.appendChild(r)}else a.appendChild(t)}},e.prototype.updateRowLimit=function(e){if(this._ensureDom(),this._viewDom&&e&&"number"==typeof e.rowLimit){this.rowLimit=e.rowLimit;var t=this._viewDom.rowLimit;if(t||(this._viewDom.rowLimit=t=this._xmlDoc.createElement(d.n.rowLimit),this._viewDom.view.appendChild(t)),t.firstChild)t.firstChild.nodeValue=String(e.rowLimit);else{var n=this._xmlDoc.createTextNode(String(e.rowLimit));t.appendChild(n)}"boolean"==typeof e.isPerPage&&u.o(t,d.e.paged,e.isPerPage),this.setIsDirty(!0,s.e.rowLimit)}},e.prototype.updateViewStyles=function(e){if(this._ensureDom(),this._viewDom){var t,n=this._viewDom.viewStyles;n||(this._viewDom.viewStyles=n=this._xmlDoc.createElement(d.n.viewStyles),this._viewDom.view.appendChild(n));try{var a='<CalendarViewStyle Title="Day" Type="day" Template="CalendarViewdayChrome" Sequence="1" Default="'.concat("day"===(t=e)?"TRUE":"FALSE",'" />')+'<CalendarViewStyle Title="Week" Type="week" Template="CalendarViewweekChrome" Sequence="2" Default="'.concat("week"===t?"TRUE":"FALSE",'" />')+'<CalendarViewStyle Title="Month" Type="month" Template="CalendarViewmonthChrome" Sequence="3" Default="'.concat("month"===t?"TRUE":"FALSE",'" />'),i=this._parseDocumentFragment(a).querySelectorAll(_);n.innerHTML="";for(var r=0;r<i.length;r++)n.appendChild(i[r]);this.setIsDirty(!0,s.e.viewStyles)}catch(e){}}},e.prototype.updateCustomOrder=function(e){if(!c.Killswitch.isActivated("c81d2986-722b-4698-9b0c-c8906724ae3b","4/19/2021","updateCustomOrder killswitch")&&(this._ensureDom(),this._viewDom)){this.customOrder=e;var t=this._viewDom.customOrder;if(t||(this._viewDom.customOrder=t=this._xmlDoc.createElement(d.n.customOrder),this._viewDom.view.appendChild(t)),t.firstChild)t.firstChild.nodeValue=e;else{var n=this._xmlDoc.createTextNode(e);t.appendChild(n)}this.setIsDirty(!0,s.e.customOrder)}},e.prototype.updateViewData=function(e){if(this._ensureDom(),this._viewDom){if(this._viewDom.viewData&&(this._viewDom.view.removeChild(this._viewDom.viewData),this._viewDom.viewData=void 0),e){this._viewDom.viewData=this._xmlDoc.createElement(d.n.viewData);for(var t=u.s("<ViewData>".concat(e,"</ViewData>")).getElementsByTagName(d.n.fieldRef),n=0;n<t.length;n++)this._viewDom.viewData.appendChild(t[n]);this._viewDom.view.appendChild(this._viewDom.viewData)}this.viewData=e,this.setIsDirty(!0,s.e.viewData)}},e.prototype.updateAll=function(e){var t=e.fieldNames,n=e.groupBy,a=e.sorts,i=e.filters;if(t&&t.length&&this.replaceFields(t),n&&this.updateGroupBy(n),a&&a.length){this.updateSort(a[0],{overwriteAll:!0});for(var r=0,o=a.slice(1);r<o.length;r++){var s=o[r];this.updateSort(s)}}i&&i.length&&"string"==typeof i[0]&&(this.clearFilters(),this.addFilters(i))},e.prototype.compareTo=function(e){if(!e)return 1;if(this.viewType===o.n.power&&e.viewType!==o.n.power)return 1;if(this.viewType!==o.n.power&&e.viewType===o.n.power)return-1;var t=(this.title||"").toLocaleLowerCase(),n=(e.title||"").toLocaleLowerCase();return t===n?0:t<n?-1:1},e.prototype.clone=function(){var t;return this.isDirty()?((t=new e(this.getEffectiveViewXml()))._ensureDom(),t.setIsDirty(!0),t._modificationTypes=Object(r.__spreadArray)([],this._modificationTypes,!0),t._baseViewXml=this.baseViewXml):t=new e(this.baseViewXml),this._cloneViewProperties(t),t},e.prototype.setDom=function(e){e&&this._parseXmlStringToEnsureDom(e)},e.prototype.getViewData=function(){if(this._ensureDom(),this._viewDom&&this._viewDom.viewData&&this._viewDom.viewData.hasChildNodes())return m().serializeToString(this._viewDom.viewData).replace(/<ViewData>|<\/ViewData>/g,"")},e.prototype.getExplicitFields=function(){this._ensureDom();var e=new Set;try{this._viewDom.viewFields.querySelectorAll("[Explicit]").forEach(function(t){e.add(t.getAttribute("Name"))})}catch(e){return new Set}return e},e.prototype.getPivotalColumns=function(e){this._ensureDom();var t=new Set;switch(e){case o.n.kanban:var n=this._viewDom.viewData.querySelector('[Type="KanbanPivotColumn"]');t.add(n.getAttribute("Name"));break;case o.n.modernCalendar:var a=Array.from(this._viewDom.viewFields.children),i=Array.from(this._viewDom.viewData.children);this.getColumnNames(a,2).forEach(function(e){return t.add(e)}),this.getColumnNames(i,i.length).forEach(function(e){return t.add(e)})}return t},e.prototype.getViewFormatter=function(){this._ensureDom();var e=this._viewDom.view.getElementsByTagName("CustomFormatter");if(e&&e.length>0)try{return JSON.parse(e[0].textContent)}catch(e){return}},e.prototype.updateExplicitFields=function(e){this._ensureDom(),this._viewDom.viewFields.childNodes.forEach(function(t){e.has(t.getAttribute("Name"))&&t.setAttribute("Explicit","TRUE")}),this.setIsDirty(!0,s.e.viewFields)},e.getViewTypeInfo=function(t){return Object(r.__assign)({viewTypeKind:e._getViewType1Int(t)},-1!==h.indexOf(t)?{viewType2:t}:{})},e.prototype.getColumnNames=function(e,t){for(var n=new Set,a=0;a<t;a++)n.add(e[a].getAttribute("Name"));return n},e.prototype._parseDocumentFragment=function(e){return u.s("<Root>"+e+"</Root>").firstElementChild},e._getViewType1Int=function(e){switch(e){case o.n.standard:return a.standard;case o.n.datasheet:return a.datasheet;case o.n.calendar:return a.calendar;case o.n.recurrence:return a.recurrence;case o.n.chart:case o.n.gantt:return a.chart;case o.n.power:return a.power;default:return a.standard}},e.prototype._cloneViewProperties=function(e){e.id=this.id,e.title=this.title,e.isDefault=this.isDefault,e.isHidden=this.isHidden,e.isPersonal=this.isPersonal,e.isReadOnly=this.isReadOnly,e.modifiedInEditor=this.modifiedInEditor,e.rowLimit=this.rowLimit,e.scope=this.scope,e.serverRelativeUrl=this.serverRelativeUrl,e.baseViewId=this.baseViewId,e.customFormatter=this.customFormatter,e.tabularView=this.tabularView,e.viewType=this.viewType,e.viewData=this.viewData,e.visualizationInfo=this.visualizationInfo},e.prototype._ensureDom=function(){this._baseViewXml&&!this._viewDom&&(this._isDirty=!1,this._hasParseError=!1,this._parseXmlStringToEnsureDom(this._baseViewXml))},e.prototype._parseXmlStringToEnsureDom=function(e){var t=new c.Qos({name:"View.Parse"});try{this._viewDom=l.e(e),this._xmlDoc=this._viewDom.xmlDoc,t.end({resultType:c.ResultTypeEnum.Success})}catch(e){this._viewDom=void 0,this._xmlDoc=void 0,this._hasParseError=!0,t.end({resultType:c.ResultTypeEnum.Failure,error:e.message||JSON.stringify(e)})}},e.prototype._getViewType1String=function(e){switch(e){case a.standard:return"HTML";case a.datasheet:return"GRID";case a.calendar:return"CALENDAR";case a.recurrence:return"RECURRENCE";case a.chart:return"CHART";case a.gantt:return"GANTT";default:return"HTML"}},e}();t.e=b},gvHJ:function(e){e.exports=JSON.parse('{"e":"None"}')},"h/Eh":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("iP7s"),r=n("m1i4"),o=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(a.__extends)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,r=this;return(n||t===i.n.crossSite)&&(r=r.method("SP.RemoteWeb",a)),r.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(r.e),s=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,s=n.pageContext,c=n.encodeWebAbsoluteUrl,d=n.apiUrlType,l=void 0===d?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:s,encodeWebAbsoluteUrl:c})||this}return Object(a.__extends)(t,e),t}(o):d;return i._apiUrlType=l,i}return Object(a.__extends)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(r.t)},h4x6:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("yhDP");function i(e){var t=e.FieldType;if("Calculated"===t&&(t=e.ResultType),"Computed"===t)switch(e.Name){case"FileSizeDisplay":return a.e.FileSize;case"ImageSize":return a.e.ImageSize;case"SharedWith":return a.e.SharedWith;case"_IsRecord":return a.e.ComplianceRecordFlag;case"ThumbnailOnForm":case"Thumbnail":return a.e.Thumbnail;default:return a.e.Computed}var n=a.e[t];if("number"==typeof n)return n;switch(t){case"UserMulti":return a.e.User;case"URL":return"Hyperlink"===e.Format?a.e.Hyperlink:a.e.Image;case"LookupMulti":return a.e.Lookup;case"MultiChoice":return a.e.Choice;case"TaxonomyFieldType":case"TaxonomyFieldTypeMulti":return a.e.Taxonomy}return a.e.Text}},iP7s:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return s}),n.d(t,"e",function(){return p});var a,i,r=n("y88i"),o=n("ynV5");!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown"}(a||(a={})),function(e){e[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown"}(i||(i={}));var s=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,a=e.multiGeoInfo,i=e.options,r=void 0===i?{}:i,o=r.path,s=void 0===o?void 0:o,c=r.listUrl,l=void 0===c?void 0:c,u=r.webUrl,f=void 0===u?void 0:u,p=r.mayInferListUrl,m=void 0!==p&&p;this._rawPath=s||void 0,this._rawListUrl=l||void 0,this._rawWebUrl=f||void 0,this.defaultFullWebUrl=d(t||void 0),this.defaultListUrl=d(n||void 0),this.multiGeoInfo=a,this.mayInferListUrl=m}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return c(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return c(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return c(this._getNormalizedListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return c(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return c(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return c(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0}),e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=d(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}return this._getPath=function(){return e},e},e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=d(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}return this._getListUrl=function(){return e},e},e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;return t&&(e="/"===t[0]||t.indexOf("://")>-1?d(t):"".concat(this.defaultFullWebUrl,"/").concat(t)),this._getWebUrl=function(){return e},e},e.prototype._getCurrentAuthority=function(){var e=new r.SimpleUri(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e},e},e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!Object(o.equalsCaseInsensitive)(t,n)){var a=new r.SimpleUri(t);e=Object(o.equalsCaseInsensitive)(a.authority,this._getCurrentAuthority())?a.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new r.SimpleUri(t);e=Object(o.equalsCaseInsensitive)(n.authority,this._getCurrentAuthority())?n.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();return void 0===t||Object(o.equalsCaseInsensitive)(t,n)||(e=Object(o.equalsCaseInsensitive)(new r.SimpleUri(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e},e},e.prototype._getServerUrl=function(){var e=this.path&&new r.SimpleUri(this.path).authority||this.listUrl&&new r.SimpleUri(this.listUrl).authority||this.webUrl&&new r.SimpleUri(this.webUrl).authority||this.defaultListUrl&&new r.SimpleUri(this.defaultListUrl).authority||new r.SimpleUri(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e},e},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new r.SimpleUri(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var a=this._getServerRelativePath(),i=new r.SimpleUri(t).path;if(void 0===a&&(void 0===this.webUrl||i&&f(u(i),u(this._getServerRelativeWebUrl())))||i&&f(u(a),u(i)))e=i;else if(void 0!==a&&(""===this.defaultListUrl||n)){var o=this._getServerRelativeWebUrl();if(f(u(a),u(o))){var s=new r.SimpleUri(a).segments[new r.SimpleUri(o).segments.length];e="".concat(u(o)).concat(s)}}}}return this._getServerRelativeListUrl=function(){return e},e},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();return void 0!==n&&(e="".concat(t).concat(n)),e},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullItemUrl=function(){return e},e},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new r.SimpleUri(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new r.SimpleUri(this.defaultFullWebUrl).path);else{var n=new r.SimpleUri(t);e="".concat(n.segments.slice(0,-1).join("/"))}return this._getServerRelativeWebUrl=function(){return e},e},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new r.SimpleUri(this.path).path),this._getServerRelativePath=function(){return e},e},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e},e},e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==a&&f(u(n),t=u(a))&&(e=n&&n.substring(t.length)),this._getListRelativeItemUrl=function(){return e},e},e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==a&&f(u(n),t=u(a))&&(e=n&&n.substring(t.length)),this._getWebRelativeItemUrl=function(){return e},e},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new r.SimpleUri(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl)),this._getDefaultListUrl=function(){return e},e},e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!Object(o.equalsCaseInsensitive)(new r.SimpleUri(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t},t},e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!Object(o.equalsCaseInsensitive)(e,t);return this._getIsCrossList=function(){return n},n},e.prototype._getSiteRelation=function(){var e=a.unknown;if(this._getIsCrossDomain())e=a.crossSite;else if(void 0!==this.webUrl)e=Object(o.equalsCaseInsensitive)(l(this.defaultFullWebUrl),l(this._getFullWebUrl()))?a.sameSite:a.crossSite;else{var t=new r.SimpleUri(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(f(u(n),u(t))){var i=new r.SimpleUri(l(n)),s=new r.SimpleUri(l(t));e=i.segments.length-1===s.segments.length||i.segments.length-2===s.segments.length&&"Lists"===i.segments[i.segments.length-2]?a.sameSite:a.unknown}else e=a.crossSite}return this._getSiteRelation=function(){return e},e},e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullWebUrl=function(){return e},e},e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return i.sameGeo;var e=new r.SimpleUri(this._getServerUrl()).authority;if(!e)return i.unknown;var t=this._getCurrentGeo();if(!t)return i.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?Object(o.equalsCaseInsensitive)(n,t)?i.sameGeo:i.crossGeo:i.unknown},e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,a,i){var o=new r.SimpleUri(n).authority.toUpperCase();!i&&t[o]||(e[o]=a),i&&(t[o]=!0)}if(this.multiGeoInfo)for(var a=0,i=this.multiGeoInfo;a<i.length;a++){var o=i[a],s=o.InstanceId,c=o.IsDefaultDataLocation;if(n(o.MySiteHostUrl,s,c),n(o.PortalUrl,s,c),n(o.RootSiteUrl,s,c),n(o.TenantAdminUrl,s,c),o.AdditionalUrls)for(var d=0,l=o.AdditionalUrls;d<l.length;d++)n(l[d],s,c)}return this._getGeoByAuthority=function(){return e},e},e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];return this._getCurrentGeo=function(){return t},t}},e}();function c(e){return""===e?"/":e}function d(e){return"/"===e?"/":e}function l(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e}function u(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:"".concat(e,"/")}function f(e,t){var n=e.toUpperCase(),a=t&&t.toUpperCase();return n.substring(0,a&&a.length||0)===a}var p=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,a=void 0===n?s:n;this.itemUrlPartsType=a,this.itemUrlContext=t}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,a=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:a,multiGeoInfo:i,options:e})},e}()},jph1:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"Engagement")&&n.d(t,"Engagement",function(){return a.Engagement})},m1i4:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n("17wl"),i=n("y88i"),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.UriEncoding.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.UriEncoding.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},mU4d:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n("K9kD"),i=n("X39n");function r(e,t){var n=Object(a.deserializeQuery)(e).id;return t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0),n}function o(e,t){var n=e;return 0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t})),n}},mflv:function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a={view:"View",viewFields:"ViewFields",rowLimit:"RowLimit",query:"Query",columnWidth:"ColumnWidth",orderBy:"OrderBy",groupBy:"GroupBy",where:"Where",associatedContentTypeId:"AssociatedContentTypeId",and:"And",or:"Or",beginsWith:"BeginsWith",contains:"Contains",dateRangesOverlap:"DateRangesOverlap",eq:"Eq",greater:"Gt",greaterEq:"Geq",includes:"Includes",inTag:"In",isNotNull:"IsNotNull",isNull:"IsNull",less:"Lt",lessEq:"Leq",membership:"Membership",notEq:"Neq",notIncludes:"NotIncludes",fieldRef:"FieldRef",value:"Value",values:"Values",today:"Today",me:"UserID",customFormatter:"CustomFormatter",newDocumentTemplates:"NewDocumentTemplates",aggregations:"Aggregations",viewType2:"ViewType2",gridLayout:"GridLayout",viewData:"ViewData",customOrder:"CustomOrder",viewStyles:"CalendarViewStyles"},i={name:"Name",collapse:"Collapse",ascending:"Ascending",type:"Type",includeTimeValue:"IncludeTimeValue",paged:"Paged",offset:"Offset",offsetDays:"OffsetDays",lookupId:"LookupId",id:"id",width:"width",value:"Value",groupLimt:"GroupLimit"},r={doctype:"application/xml",fieldNameQuery:'FieldRef[Name="{0}"]',datetimeRegex:/^(\d{4}-\d{2}-\d{2})T\d{2}:\d{2}:\d{2}Z$/,datetimeNoTimeRegex:/^(\d{4}-\d{2}-\d{2})T00:00:00Z$/,dateRegex:/^\d{4}-\d{2}-\d{2}/,todayRegex:/^\[today\]([+-]\d+)?$/i,meRegex:/^\[me\]/i,calendarNullEvent:/.*<Or>.*<IsNull.*<\/IsNull.*<IsNull.*<\/IsNull>.*<\/Or>.*/,aggregationsField:'<FieldRef Name="{0}" Type="{1}"/>'}},myym:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"s",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"o",function(){return f}),n.d(t,"r",function(){return p});var a=n("ynV5"),i=n("AfXp"),r="_ComplianceTag",o="_ComplianceFlags",s=200;function c(e){return!!(256&e)}function d(e){if(!e.HasRetentionAction)return" ";if(0===e.TagDuration)return e.BlockDelete?i.RetainForeverText:" ";var t=u(e.TagDuration);return e.BlockDelete?a.format(i.PreserveTagText,t):e.AutoDelete?a.format(i.DeleteTagText,t):" "}function l(e){if(e.Notes)return e.Notes;if(!e.HasRetentionAction)return i.NoRetentionTooltip;if(0===e.TagDuration)return e.BlockDelete?i.PreserveForeverTooltip:i.NoRetentionTooltip;var t=u(e.TagDuration),n="",r="";e.BlockDelete?(n="PreserveTag"+e.TagRetentionBasedOn+"Tooltip",e.BlockEdit&&(r=i.PreserveIsRecordTooltipModifier),e.ReviewerEmail?r+=i.ReviewTooltip:r+=e.AutoDelete?i.PreserveAutoDeleteTooltipModifier:i.PreserveNoDeleteTooltipModifier):e.AutoDelete&&(n="DeleteTag"+e.TagRetentionBasedOn+"Tooltip");var o=i[n];return o?a.format(o,t)+r:null}function u(e){var t="";if(e>0){var n=Math.floor(e/365);if(n>0){var r=n>1?i.RetentionPeriodYears:i.RetentionPeriodYear;t=a.format(r,n)}else{var o=Math.floor(e/30);if(o>0){var s=o>1?i.RetentionPeriodMonths:i.RetentionPeriodMonth;t=a.format(s,o)}else{var c=e>1?i.RetentionPeriodDays:i.RetentionPeriodDay;t=a.format(c,e)}}}return t}function f(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"boolean"===t.toLowerCase()&&n&&n.toLowerCase()==="96BE7325-AFA4-48CF-8503-9258F0A7817D".toLowerCase()));var t,n}function p(e){return!!(e&&e.schema&&(t=e.schema.FieldType,n=e.schema.Id,t&&"lookup"===t.toLowerCase()&&n&&n.toLowerCase()==="D4B6480A-4BED-4094-9A52-30181EA38F1D".toLowerCase()));var t,n}},o4HN:function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a,i,r=n("K9kD"),o=n("ynV5");!function(e){e[e.remove=0]="remove",e[e.add=1]="add"}(a||(a={})),function(e){e[e.attachment=0]="attachment",e[e.image=1]="image"}(i||(i={}));var s=n("17wl"),c=n("dq6a"),d=n("3HEj"),l=r.Killswitch.isActivated("e4ab8057-1385-407d-b834-c536273f05d8","06/08/2023","Plumb list url to build attachment base url"),u=function(e){function t(t,n){var a=e.call(this,{},n)||this,i=t.apiUrlHelper,r=t.itemUrlHelper;return a._itemUrlHelper=r,a._apiUrlHelper=i,a._listUrl=t.listUrl,a}return Object(s.__extends)(t,e),t.prototype.getAttachments=function(e,t){var n=this;return this.getData(function(){return n.buildAttachmentBaseUrl(e,t).toString()},function(e){var t=JSON.parse(e);if(t&&t.d&&t.d.resultes&&0===t.d.results.length)return[];var a=t.d.results;return n.transformAttachmentData(a)},"Attachments")},t.prototype.addAttachment=function(e,t,n){var a=this;return new r.Promise(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUploadAttachment(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteAttachment=function(e,t,n,a){var i=this;return new r.Promise(function(r,o){i.doDeleteAttachment(e,t,n,a||!1).then(r,o)},function(){})},t.prototype.getDataSourceName=function(){return"AttachmentDataSource"},t.prototype.addImage=function(e,t,n,a,i,o,s){var c=this;return new r.Promise(function(r,d){var l=new FileReader;l.onload=function(u){var f=l.result;c.doUploadImage(t,a,i,s.name,f,n,e,o).then(r,d)},l.readAsArrayBuffer(s)},function(){})},t.prototype.attachImage=function(e,t,n){var a=this;return new r.Promise(function(i,r){var o=new FileReader;o.onload=function(s){var c=o.result;a.doUpdateImage(e,t,n.name,c).then(i,r)},o.readAsArrayBuffer(n)},function(){})},t.prototype.deleteImage=function(e,t,n){var a=this;return new r.Promise(function(i,r){a.doUpdateImage(e,t,n).then(i,r)},function(){})},t.prototype.doUpdateImage=function(e,t,n,a){var i=this._itemUrlHelper.getUrlParts(),r=this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).method("Items",e).methodWithAliases("AddThumbnailFieldData",{imageName:n,fieldInternalName:t});return this.dataRequestor.getData({url:r.toString(),parseResponse:function(e){var t=JSON.parse(e);return t.d&&void 0!==t.d.AddThumbnailFieldData},qosName:"AddThumbnailFieldData",noRedirect:!0,additionalPostData:a||void 0})},t.prototype.buildAttachmentBaseUrl=function(e,t,n){if(l){var a=this._itemUrlHelper.getItemUrlParts(t);return r=this._apiUrlHelper.build().webByItemUrl(a).method("GetList",a.serverRelativeListUrl).method("Items",e),n?r.method("AttachmentFiles",n):r.segment("AttachmentFiles")}var i=this._listUrl||this._itemUrlHelper.getUrlParts().serverRelativeListUrl,r=this._apiUrlHelper.build().segment("web").method("GetList",i).method("Items",e);return n?r.method("AttachmentFiles",n):r.segment("AttachmentFiles")},t.prototype.transformAttachmentData=function(e){var t=this;return e.map(function(e){return{type:"attachment",fileName:e.FileName,serverRelativeUrl:Object(d.t)(t._pageContext)+e.ServerRelativeUrl,uploaded:!0}})},t.prototype.doUploadAttachment=function(e,t,n,a){var i=this;return this.dataRequestor.getData({url:this.buildAttachmentBaseUrl(e,t).methodWithAliases("addUsingPath",{decodedUrl:n}).toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d)return null;var n=[t.d],a=i.transformAttachmentData(n);return a&&1===a.length?a[0]:null},qosName:"UploadAttachment",additionalPostData:a,noRedirect:!0})},t.prototype.doDeleteAttachment=function(e,t,n,a){var i=this;return this.getData(function(){return i.buildAttachmentBaseUrl(e,t,n).segment(a?"DeleteObject":"RecycleObject").toString()},function(e){try{var t=JSON.parse(e);return a&&void 0!==t.d.DeleteObject||!a&&void 0!==t.d.RecycleObject}catch(e){return!1}},a?"DeleteAttachment":"RecycleAttachment")},t.prototype.doUploadImage=function(e,t,n,a,i,o,s,c){var d=this,l=this._itemUrlHelper.getItemUrlParts(e),u=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:o,itemId:s,fieldId:c});return r.Killswitch.isActivated("dd617e52-55d0-40bc-9e0f-ffd875d6a25c","11/10/2021","pipe through filed id to UploadImage call")&&(u=this._apiUrlHelper.build().webByItemUrl(l).methodWithAliases("UploadImage",{listTitle:t,imageName:a,listId:o,itemId:s})),this.dataRequestor.getData({url:u.toString(),parseResponse:function(e){var t=JSON.parse(e);if(!t.d||!t.d.UploadImage)return null;var a=t.d.UploadImage;return d.transformImageData(a,n,c)||null},qosName:"UploadImage",additionalPostData:i,noRedirect:!0})},t.prototype.transformImageData=function(e,t,n){return{type:"thumbnail",fileName:e.Name,serverRelativeUrl:e.ServerRelativeUrl,id:e.UniqueId,fieldName:t,serverUrl:Object(d.t)(this._pageContext),fieldId:n}},t}(c.e),f=n("h/Eh"),p=n("xkft"),m=n("LzHh"),_=n("jph1"),h={ODB:1770},b=function(){function e(e){this.listTitle=e.pageContext.listTitle,this.listId=r.Guid.normalizeLower(e.pageContext.listId,!1);var t=new p.e({},{pageContext:e.pageContext}),n=new f.e({},{itemUrlHelper:t,pageContext:e.pageContext}),a={pageContext:e.pageContext};this.dataSource=new u({apiUrlHelper:n,itemUrlHelper:t,listUrl:e.listUrl},a),this.isImageColumnUsingAttachmentsInListEnabled=r.FeatureOverrides.isFeatureEnabled(h),this.imageOperationsPool=[],this.attachmentOperationsPool=[]}return e.prototype.createAddAttachmentOperation=function(e,t,n){var r={type:a.add,listItemId:e,listItemKey:t,fileType:i.attachment,fileName:n.name,file:n};this.handleNewOperation(r,this.attachmentOperationsPool)},e.prototype.createDeleteAttachmentOperation=function(e,t,n){var r={type:a.remove,listItemId:e,listItemKey:t,fileType:i.attachment,fileName:n};this.handleNewOperation(r,this.attachmentOperationsPool)},e.prototype.createAddImageOperation=function(e,t,n,r,o){var s={type:a.add,listItemId:e,listItemKey:t,fileType:i.image,fileName:n.name,file:n,fieldName:r,fieldId:o};this.handleNewOperation(s,this.imageOperationsPool)},e.prototype.createDeleteImageOperation=function(e,t,n,r){var o={type:a.remove,listItemId:e,listItemKey:t,fileType:i.image,fileName:n,fieldName:r};this.handleNewOperation(o,this.imageOperationsPool)},e.prototype.createAddListImageOperation=function(e){var t={type:a.add,fileType:i.image,fileName:e.name,file:e,useSiteAssets:!0};this.handleNewOperation(t,this.imageOperationsPool)},e.prototype.createDeleteListImageOperation=function(e){var t={type:a.remove,fileType:i.image,fileName:e,useSiteAssets:!0};this.handleNewOperation(t,this.imageOperationsPool)},e.prototype.executeImageOperationsOnSingleItem=function(e,t,n){var a=this.imageOperationsPool.slice();return this.clearImageOperations(e||0,t,n),this.executeAllOperationsCore(a,e,t)},e.prototype.executeImageOperationsOnMultipleItems=function(e){var t=this;if(0===e.length)return r.Promise.resolve([]);var n=[];return e.forEach(function(e){n.push(t.executeImageOperationsOnSingleItem(e,void 0,!1))}),r.Promise.all(n).then(function(e){var t=[];return e.forEach(function(e){e.forEach(function(e){t.push(e)})}),t})},e.prototype.executeAttachmentOperations=function(e){return this.executeAllOperationsCore(this.attachmentOperationsPool,e,void 0)},e.prototype.hasPendingImageOperations=function(){return this.imageOperationsPool.length>0},e.prototype.hasPendingAttachmentOperations=function(){return this.attachmentOperationsPool.length>0},e.prototype.clearAttachmentOperations=function(){this.attachmentOperationsPool=[]},e.prototype.executeAllOperationsCore=function(e,t,n){var i=this,o=e;return n&&(o=e.filter(function(e){return e.fieldName===n})),new r.Promise(function(e,r){if(o.length>0){var s=o[0],c=o.slice(1),d=void 0;s.type===a.add?(void 0===t||s.listItemId||(s.listItemId=t),d=i.processUpload(s.listItemId,s.listItemKey,s.file,s.fileType,s.fieldName,s.fieldId,s.useSiteAssets)):d=i.processDelete(s.listItemId,s.listItemKey,s.fileName,s.fileType,s.fieldName,s.fieldId,s.useSiteAssets);var l=function(a){i.executeAllOperationsCore(c,t,n).done(function(t){return e([a].concat(t))},r)};d.done(l,l),_.Engagement.logData({name:"ClientFormUpdate.attachments"})}else e([])})},e.prototype.processUpload=function(e,t,n,a,r,s,c){return a===i.image?this.isImageColumnUsingAttachmentsInListEnabled&&!c?this.dataSource.attachImage(e,r,n).then(function(e){return{result:e,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name},errorMsg:e?null:o.format(m.n,n.name)+"."}},function(e){var t=o.format(m.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=m.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name},errorMsg:t}}):this.dataSource.addImage(e,t,this.listId,this.listTitle,r,s,n).then(function(e){return{result:!0,attachment:null,image:e,errorMsg:e?null:o.format(m.n,n.name)+"."}},function(e){var t=o.format(m.n,n.name);throw e&&(e.code&&e.code.indexOf("InvalidDataException")>=0?t=m.a:e.message&&e.message.value&&(t+=" : "+e.message.value)),{result:!1,attachment:null,image:{type:"thumbnail",fieldName:r,fileName:n.name,serverUrl:null,fieldId:s},errorMsg:t}}):this.dataSource.addAttachment(e,t,n).then(function(e){return{result:!0,attachment:e,errorMsg:e?null:o.format(m.t,n.name)+"."}},function(e){throw{result:!1,attachment:{type:"attachment",uploaded:!1,fileName:n.name},errorMsg:o.format(m.t,n.name)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}})},e.prototype.processDelete=function(e,t,n,a,s,c,d){var l;if(a===i.image){if(!this.isImageColumnUsingAttachmentsInListEnabled||d)return r.Promise.wrap({result:!0,image:{type:"thumbnail",fieldName:s,fileName:n,serverRelativeUrl:null,serverUrl:null,fieldId:c},errorMsg:null});l=this.dataSource.deleteImage(e,s,n).then(function(e){return{result:e,errorMsg:e?null:o.format(m.n,n)+"."}},function(e){throw{result:!1,errorMsg:o.format(m.n,n)}})}else l=this.dataSource.deleteAttachment(e,t,n).then(function(e){return{result:e,errorMsg:e?null:o.format(m.e,n)+"."}},function(e){throw{result:!1,errorMsg:o.format(m.e,n)+(e&&e.message&&e.message.value?" : "+e.message.value:"")}});return l},e.prototype.handleNewOperation=function(e,t){var n=e.type,i=this.findDuplicateOperation(e,t);n===a.add?i<0&&t.push(e):i<0?t.push(e):t.splice(i,1)},e.prototype.findDuplicateOperation=function(e,t){var n=e.fileType,r=-1;return t.some(function(t,o){var s=!1;if((isNaN(t.listItemId)&&isNaN(e.listItemId)||t.listItemId===e.listItemId)&&(s=!0),t.type===a.add&&s&&t.fileName===e.fileName&&(n!==i.image||t.fieldName===e.fieldName))return r=o,!0}),r},e.prototype.clearImageOperations=function(e,t,n){if(this.imageOperationsPool.length>0)if(n||!e)this.imageOperationsPool=[];else{var a=this.imageOperationsPool.filter(function(n){return Number(n.listItemId)!==e||!!t&&n.fieldName!==t});this.imageOperationsPool=a}},e}()},ozVI:function(e,t,n){"use strict";var a,i=function(){function e(t,n){if(void 0===t&&(t=0),void 0===n&&(n=0),t instanceof e){var a=t;this.x=a.x,this.y=a.y}else this.x=t,this.y=n}return e.areEqual=function(e,t,n){return void 0===n&&(n=1e-6),Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n},e.getCenter=function(t){return t.reduce(function(e,t){return e.add(t)},e.ORIGIN).scale(1/t.length)},e.prototype.scale=function(t){return new e(this.x*t,this.y*t)},e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.subtract=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.distance=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},e.prototype.negate=function(){return new e(-this.x,-this.y)},e.prototype.abs=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.unit=function(){var e=this.abs();return this.scale(e&&1/e||0)},e.prototype.toString=function(){return"[Point ".concat(this.x,", ").concat(this.y,"]")},e.ORIGIN=new e,e}(),r=function(e,t){this.width=0,this.height=0,this.width=e,this.height=t},o=function(){function e(t,n,a,r){if(this.x=0,this.y=0,this.width=0,this.height=0,0===arguments.length)this.x=0,this.y=0,this.width=0,this.height=0;else if(t instanceof e){var o=t;this.x=o.x,this.y=o.y,this.width=o.width,this.height=o.height}else if(t instanceof i){var s=t,c=n;this.x=s.x,this.y=s.y,this.width=c.width,this.height=c.height}else if("object"==typeof t&&"number"==typeof t.left&&"number"==typeof t.top&&"number"==typeof t.width&&"number"==typeof t.height){var d=t;this.x=d.left,this.y=d.top,this.width=d.width,this.height=d.height}else this.x=t,this.y=n,this.width=a,this.height=r}return e.prototype.clip=function(t){var n=new e(this);return n.x<t.x&&(n.width-=t.x-n.x,n.x=t.x),n.getRight()>t.getRight()&&(n.width-=n.getRight()-t.getRight()),n.y<t.y&&(n.height-=t.y-n.y,n.y=t.y),n.getBottom()>t.getBottom()&&(n.height-=n.getBottom()-t.getBottom()),n},e.prototype.contains=function(e){if(e instanceof i){var t=e;return t.x>=this.x&&t.y>=this.y&&t.x<=this.getRight()&&t.y<=this.getBottom()}var n=e,a=n.getPoint(),r=new i(n.getRight(),n.getBottom());return this.contains(a)&&this.contains(r)},e.prototype.getCenter=function(){return new i(this.x+this.width/2,this.y+this.height/2)},e.prototype.getLeft=function(){return this.x},e.prototype.getTop=function(){return this.y},e.prototype.getRight=function(){return this.x+this.width},e.prototype.getBottom=function(){return this.y+this.height},e.prototype.getPoint=function(){return new i(this.x,this.y)},e.prototype.getSize=function(){return new r(this.width,this.height)},e.prototype.inflate=function(t,n){var a,i;if("object"==typeof t){var r=t;a=r.width,i=r.height}else a=t,i=n;return new e(this.x-a/2,this.y-i/2,this.width+a,this.height+i)},e.prototype.nudge=function(t){var n=new e(this);return n.x<t.x?n.x=t.x:n.getRight()>t.getRight()&&(n.x=t.getRight()-n.width),n.y<t.y?n.y=t.y:n.getBottom()>t.getBottom()&&(n.y=t.getBottom()-n.height),n},e.prototype.translate=function(t,n){var a;if(t instanceof i){var r=t;a=this.translate(r.x,r.y)}else{var o=t,s=n;a=new e(this.x+o,this.y+s,this.width,this.height)}return a},e.prototype.union=function(t){var n=Math.min(this.x,t.x),a=Math.min(this.y,t.y);return new e(n,a,Math.max(this.x+this.width,t.x+t.width)-n,Math.max(this.y+this.height,t.y+t.height)-a)},e.prototype.fit=function(t,n){var a=t;a=this.width&&this.height&&(n?this.width>a.width||this.height>a.height:this.width>a.width&&this.height>a.height)?this._scaleTo(t,n):this;var i=(t.width-a.width)/2,r=(t.height-a.height)/2;return new e(i+this.x,r+this.y,a.width,a.height)},e.prototype._scaleTo=function(t,n){var a=t.width/t.height,i=this.width/this.height,r=0,o=0;return(n?i:a)<(n?a:i)?(o=t.height,r=i*t.height):(r=t.width,o=t.width/i),new e(this.x,this.y,r,o)},e}(),s=o,c=n("K9kD"),d=function(){function e(){}return e.hasClass=function(e,t){return e.classList?e.classList.contains(t):-1!==(e.className?e.className.split(" "):[]).indexOf(t)},e.toggleClass=function(e,t,n){if(e.classList)n?e.classList.add(t):e.classList.remove(t);else{var a=e.className?e.className.split(" "):[],i=a.indexOf(t);n?-1===i&&a.push(t):i>-1&&a.splice(i,1),e.className=a.join(" ")}},e.loadStyles=function(t){e._platform.isUnlimitedStyleSheetsSupported?e.registerStyle(t):e.registerStyleIE(t)},e.registerStyle=function(e){var t=document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.appendChild(document.createTextNode(e)),t.appendChild(n)},e.registerStyleIE=function(t){var n=document.getElementsByTagName("head")[0],a=e._lastStyleElement?e._lastStyleElement.styleSheet.cssText:"";(!e._lastStyleElement||a.length+e._styleText.length>e.MAX_STYLE_CONTENT_SIZE)&&(e._lastStyleElement=document.createElement("style"),e._lastStyleElement.type="text/css",n.appendChild(e._lastStyleElement)),e._lastStyleElement.styleSheet.cssText+=t},e.loadStylesheet=function(e){var t=document.createElement("link");t.rel="stylesheet",t.type="text/css",t.href=e,document.head.appendChild(t)},e.setText=function(t,n){void 0===a&&(a=void 0!==e.ce("div").textContent?"textContent":"innerText"),t[a]=n},e.ce=function(e,t,n){var a=document.createElement(e);if(t)for(var i=Object.keys(t),r=0;r<i.length;r++){var o=i[r];a.setAttribute(o,t[o])}if(n)for(var s=0;s<n.length;s++)a.appendChild(n[s]);return a},e.setShadowParent=function(t,n){t[e.SHADOW_PARENT_KEY]=n},e.getParent=function(t,n){return void 0===n&&(n=!0),n&&t[e.SHADOW_PARENT_KEY]||t.parentElement},e.ct=function(e){return document.createTextNode(e)},e.createComment=function(e){return document.createComment(e)},e.clickElement=function(e){e.onclick?e.onclick(void 0):e.click&&e.click()},e.insertAfter=function(e,t){var n=t.parentNode,a=t.nextSibling;a?n.insertBefore(e,a):n.appendChild(e)},e.waitForElement=function(e,t,n){var a=document.querySelector(e);if(!a){var i=new MutationObserver(function(n,a){var i=document.querySelector(e);i&&(t(i),a.disconnect())});return i.observe(n||document.documentElement,{childList:!0,subtree:!0}),i}t(a)},e.getElementByTagAndPartialId=function(e,t,n){for(var a=[],i=e.getElementsByTagName(t),r=0;r<i.length;r++)i[r].id.indexOf(n)>=0&&a.push(i[r]);return a.length>0?a[0]:null},e.findAncestor=function(t,n,a){for(void 0===a&&(a=!0);t&&t!==document.body;){if(e.hasClass(t,n))return t;t=e.getParent(t,a)}return null},e.calculateRect=function(e,t){var n=e.getBoundingClientRect(),a=0,i=0,r=0,o=0;if(t){var c=window.getComputedStyle(e);a=parseFloat(c.marginLeft),i=parseFloat(c.marginRight),r=parseFloat(c.marginTop),o=parseFloat(c.marginBottom)}return new s(n.left-a,n.top-r,n.width+a+i,n.height+r+o)},e.calculateSubtreeRect=function(t){for(var n=null,a=[t];a.length>0;){t=a.shift();var i=e.calculateRect(t);i.width>0&&i.height>0&&(n=n?n.union(i):i);for(var r=0,o=t.children.length;r<o;r++)a.push(t.children[r])}return n||(n=new s),n},e.insertAtIndex=function(e,t,n,a){if(e&&t){n=n<0?0:n;for(var i=e.firstElementChild,r=0;r<n&&i;)a&&a!==i.tagName||r++,i=i.nextElementSibling;i?e.insertBefore(t,i):e.appendChild(t)}},e.MAX_STYLE_CONTENT_SIZE=1e4,e.SHADOW_PARENT_KEY="_OneDrive_shadowParent",e._platform=new c.PlatformDetection,e._lastStyleElement=null,e._styleText="",e}();t.e=d},rqqu:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("17wl"),i=function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,i=e,r=e.toLowerCase(),o=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("edge/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);return d&&n("version/"),{browserName:a?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(r),s={browserMajor:(n=o.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},c=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(r),d=c.isMobile,l=/electron\/\\d+[\\d.]*/.test(r),u=r.indexOf("winappwipenabled")>-1,f=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),p=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(r),m=!1,_=!1,h=!1,b=!1;if(t&&t.document){var g=document.createElement("style");g.type="text/css",m=!g.styleSheet,_="addBehavior"in HTMLDivElement.prototype;var v=document.createElement("input");v.type="file";var y=t.File,S=y&&y.prototype;b=!(!S||!(S.slice||S.mozSlice||S.webkitSlice)),h="webkitdirectory"in v&&!l}return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},o),s),c),{isElectron:l,osVersion:p?p[2]:"NA",isWindows81:!d&&/windows (?:8\.1|nt 6\.3)/.test(r),isWindows10:!d&&r.indexOf("windows nt 10")>-1,isWindows7:!d&&r.indexOf("windows nt 6.1")>-1,isWinAppWipEnabled:u,isPWA:f,areCSS3TransitionsSupported:!o.isIE||s.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:h,isHtml5FileUploadSupported:b,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:m,isWebDavSupported:_,userAgent:i})}},ukhN:function(e){var t=e.exports=JSON.parse('{"NONE":"None","SUM":"Sum","COUNT":"Count","AVG":"Average","MAX":"Maximum","MIN":"Minimum","STDEV":"Std Deviation","VAR":"Variance"}');t.default=t},w9oE:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"isExpectedError")&&n.d(t,"isExpectedError",function(){return a.isExpectedError})},xCzz:function(e,t,n){"use strict";function a(e){var t={};if(e)for(var n=e.split("&"),a=0;a<n.length;a++){var i=n[a].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]))}return t}n.d(t,"e",function(){return a})},xkft:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("iP7s"),r=n("K9kD"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(i.t),s=function(e){function t(t,n){var a=n.itemUrlPartsType,i=void 0===a?o:a;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}return Object(a.__extends)(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)},t.prototype.getItemUrlParts=function(e){var t=Object(r.deserializeQuery)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})},t}(i.e)},y3bW:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"n",function(){return l});var a,i=n("17wl"),r=n("Yw5A"),o=((a={})[r.t]="0",a[0]=r.t,a[r.n]="1",a[1]=r.n,a[r.a]="2",a[2]=r.a,a[r.e]="3",a[3]=r.e,a),s="ApprovalStatusType",c="_ApprovalStatus",d=function(e){function t(t){var n=e.call(this)||this;n.__type__=s,n.toString=function(){return n.display},n.valueOf=function(){return n.numeric};var a=t||"0",i=""!==a&&!isNaN(+a);return n.display=i?o[a]:a.toString(),n.numeric=i?a.toString():o[a.toString()],n}return Object(i.__extends)(t,e),t}(String);function l(e){return null!=e&&"object"==typeof e&&e.hasOwnProperty("__type__")&&e.__type__===s}},yhDP:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Text=0]="Text",e[e.Hyperlink=1]="Hyperlink",e[e.Image=2]="Image",e[e.User=3]="User",e[e.Boolean=4]="Boolean",e[e.DateTime=5]="DateTime",e[e.Currency=6]="Currency",e[e.Counter=7]="Counter",e[e.Number=8]="Number",e[e.Note=9]="Note",e[e.Computed=10]="Computed",e[e.Name=11]="Name",e[e.FileSize=12]="FileSize",e[e.Shared=13]="Shared",e[e.SharedWith=14]="SharedWith",e[e.FileIcon=15]="FileIcon",e[e.DotDotDot=16]="DotDotDot",e[e.Tag=17]="Tag",e[e.Lookup=18]="Lookup",e[e.Taxonomy=19]="Taxonomy",e[e.Hashtag=20]="Hashtag",e[e.Attachments=21]="Attachments",e[e.AverageRating=22]="AverageRating",e[e.Title=23]="Title",e[e.WorkflowStatus=24]="WorkflowStatus",e[e.ProgressBar=25]="ProgressBar",e[e.RatedBy=26]="RatedBy",e[e.Ratings=27]="Ratings",e[e.LikedBy=28]="LikedBy",e[e.Likes=29]="Likes",e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag",e[e.Custom=31]="Custom",e[e.Activity=32]="Activity",e[e.Choice=33]="Choice",e[e.ClientSideCustom=34]="ClientSideCustom",e[e.FileActivity=35]="FileActivity",e[e.MruName=36]="MruName",e[e.ShareCommand=37]="ShareCommand",e[e.PinCommand=38]="PinCommand",e[e.Thumbnail=39]="Thumbnail",e[e.ImageSize=40]="ImageSize",e[e.Location=41]="Location",e[e.Geolocation=42]="Geolocation"}(a||(a={}))},ynV5:function(e,t,n){var a=n("K9kD");e.exports=a.StringHelper},zDdS:function(e,t,n){"use strict";n.d(t,"n",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a,i=n("17wl");function r(e){return{graftOperationType:a.optional,value:e}}function o(e){return{graftOperationType:a.backup,value:e}}function s(e,t){if(!c(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!c(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n],p=t[o],m=e[o];if(p!==m){var _=p;if(u(_))if(_.graftOperationType===a.replace)m=void 0,p=h=_.value;else if(_.graftOperationType===a.backup){var h=_.value;if(void 0!==e[o])continue;p=h}else{if(_.graftOperationType!==a.optional){if(f(_)){delete e[o];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(h=_.value))continue;p=h}var b=void 0;if(d(p))b=new Date(p.getTime());else if(l(p)){var g=m;l(g)||(g=[]),g.splice.apply(g,Object(i.__spreadArray)([0,g.length],p,!1)),b=g}else if(c(p)){var v=m;c(v)||(v={}),s(v,p),b=v}else b=p;e[o]=b}}return e}function c(e){return"object"==typeof e&&!!e}function d(e){return e instanceof Date}function l(e){return Array.isArray(e)}function u(e){return c(e)&&!!e.graftOperationType}function f(e){return e.graftOperationType===a.remove}!function(e){e[e.none=0]="none",e[e.replace=1]="replace",e[e.optional=2]="optional",e[e.remove=3]="remove",e[e.backup=4]="backup"}(a||(a={}))},zKK4:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("f3jH"),i="f9ebc8b2-a976-48f0-a8fa-0846164c0466";a.e}}]);