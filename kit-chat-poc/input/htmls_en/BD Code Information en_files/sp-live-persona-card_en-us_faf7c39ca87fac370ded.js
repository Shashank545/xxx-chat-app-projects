define("7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0",["tslib","@ms/office-ui-fabric-react-bundle","@microsoft/sp-loader","@microsoft/sp-core-library","react","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics"],function(n,a,i,r,o,s,c,d){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{0:[{i:"1c4541f7-5c31-41aa-9fa8-fbc9dc14c0a8",v:"1.19.0",m:"X+PM"},{i:"cc2cc925-b5be-41bb-880a-f0f8030c6aff",v:"5.5.326",m:"y88i"},{i:"8217e442-8ed3-41fd-957d-b112e841286a",v:"0.31.18",m:"2q6Q"},{i:"a68dd513-949e-48c1-b210-23ad37dbbe13",v:"0.1.0",m:"WZz6"},{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.3.325",m:"K9kD"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"live-persona-card-loader",2:"vendors~live-persona-card-loader"}[e]||e)+"_"+"none"+"_"+{0:"75e71545449406d5dfe2",2:"7888a94103fd0f63ef0f"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_7d834519_e86f_4d2b_ad52_b9b35dab66f1_0_1_0=window.webpackJsonp_7d834519_e86f_4d2b_ad52_b9b35dab66f1_0_1_0||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp\-live\-persona\-card_en-us_faf7c39ca87fac370ded\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"17wl":function(e,t){e.exports=n},"5pbq":function(e,t){e.exports=a},I6O9:function(e,t){e.exports=i},UWqr:function(e,t){e.exports=r},b8Gs:function(e){e.exports=JSON.parse('{"n":"Opens Profile Card for {0}","e":"Opens Profile Card","t":"Getting detailsâ€¦","a":"Topic {0}"}')},cDcd:function(e,t){e.exports=o},"hiL/":function(e,t){e.exports=s},jOlS:function(e,t){e.exports=c},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"bootstrapLPC",function(){return p}),n.d(t,"LivePersonaCard",function(){return m}),n.d(t,"TopicCardHoverTarget",function(){return _});var a=n("17wl"),i=n("cDcd"),r=n("ut3N"),o=n("UWqr"),s=n("5pbq"),c=n("hiL/");n("jOlS").loadStyles(".a_a_434b99a9{cursor:pointer}.a_a_434b99a9:hover{outline:none}",!0);var d,l=n("b8Gs"),u="SPPeopleWebPart",f=new(function(){function e(){}return e.prototype.getLPCLoader=function(){return Promise.all([n.e(2),n.e(0)]).then(n.bind(null,"Mdbv")).then(function(e){return e.default})},Object(a.__decorate)([Object(c.monitor)("LivePersonaCard.Load")],e.prototype,"getLPCLoader",null),e}());function p(e,t,n){return void 0===t&&(t=u),void 0===n&&(n="User"),f.getLPCLoader().then(function(a){return a.bootstrap(e,t,n)})}!function(e){e.Mouse="Mouse",e.Keyboard="Keyboard"}(d||(d={}));var m=function(e){function t(n){var a=e.call(this,n)||this;return a._isUnMounted=!1,a._bootstrapLivePersonaCard=function(e){return!t._isLivePersonaCardFlightEnabled()||o._BrowserUtilities.isMobileWebView()?Promise.resolve():t.livePersonaCardHoverTarget?(a._updateBundleMountedState(null==e?void 0:e.nativeEvent),Promise.resolve()):(a._loadPromise||(a._loadPromise=a._bootstrapCore(null==e?void 0:e.nativeEvent)),a._loadPromise)},a._bootstrapCore=function(e){return r._TraceLogger.logVerbose(a._logSource,"LivePersonaCard._bootstrapCore"),f.getLPCLoader().then(function(e){return e.bootstrap(a.props.serviceScope,a._clientType,a._personaType,a.props.clientScenario,a.props.topicCardProps)}).then(function(){a._isUnMounted||a._updateBundleMountedState(e)}).catch(function(e){r._TraceLogger.logError(a._logSource,e,"BootstrapLivePersonaCard")})},a._manuallyDispatchEventToTriggerCallout=function(e){var t,n,i,r;"keydown"===(null==e?void 0:e.type)&&a._ref.current&&(null===(t=Object(s.getFirstTabbable)(a._ref.current,a._ref.current,!0))||void 0===t||t.focus(),null===(n=a._ref.current.firstElementChild)||void 0===n||n.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});var e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}())),"mouseover"===(null==e?void 0:e.type)&&a._ref.current&&a.state.shouldOpenLpcAfterBundleLoaded&&!a.props.disableHover&&(null===(i=a._ref.current.firstElementChild)||void 0===i||i.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("mousemove",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("mousemove",!0,!0),e}())),"click"===(null==e?void 0:e.type)&&a._ref.current&&a.state.shouldOpenLpcAfterBundleLoaded&&!a.props.disableClick&&(null===(r=a._ref.current.firstElementChild)||void 0===r||r.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("click",{bubbles:!0,cancelable:!0});var e=document.createEvent("MouseEvent");return e.initEvent("click",!0,!0),e}()))},a._triggerBootstrap=function(e,t){r._EngagementLogger.logEventWithLogEntry(new r._LogEntry("LivePersonaCard","".concat(a._logScenario,".Trigger"),r._LogType.Event,{hasUPN:Boolean(a.props.legacyUpn||a.props.upn).toString(),source:t,isBundleLoaded:a.state.isBundleLoaded.toString()})),a._isLPCBundleLoaded()||(a.setState({shouldOpenLpcAfterBundleLoaded:!0}),a._bootstrapLivePersonaCard(e).catch(a._traceBootstrapFailure))},a._triggerBootstrapByKeyboard=function(e){"Enter"===e.key&&(a._triggerBootstrap(e,d.Keyboard),a._isLPCBundleLoaded()||c.ScreenReaderAlert.read(l.t))},a._handleCardOpen=function(){r._EngagementLogger.logEvent("LivePersonaCard.".concat(a._logScenario),"Open");var e=a.props.onCardOpen;e&&e()},a._traceBootstrapFailure=function(e){r._TraceLogger.logError(a._logSource,e,"LivePersonaCard.bootstrap")},a._logSource=r._LogSource.create("LivePersonaCard"),a._ref=i.createRef(),a.state={isBundleLoaded:!1,shouldOpenLpcAfterBundleLoaded:!1},a}return Object(a.__extends)(t,e),t._isLivePersonaCardFlightEnabled=function(){return o._SPFlight.isEnabled(809)},Object.defineProperty(t,"livePersonaCardHoverTarget",{get:function(){return window.LivePersonaCardHoverTargetV2},enumerable:!1,configurable:!0}),t.prototype.componentWillUnmount=function(){this._isUnMounted=!0},t.prototype.render=function(){var e=this;if(this.props.disabled)return i.Children.only(this.props.children);if(o._BrowserUtilities.isMobileWebView())return i.cloneElement(i.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:Object(a.__assign)({upn:this.props.legacyUpn},o._BrowserUtilities.isTeamsVivaMobile()&&{displayName:this.props.displayName})}),onClick:function(){}});var t=this.props.useSpan?"span":"div",n=this.props.disableClick?void 0:function(t){return e._triggerBootstrap(t,d.Mouse)},r=this.props.disableHover?void 0:function(t){return e._triggerBootstrap(t,d.Mouse)},c=this.props.disableHover?void 0:function(){e.setState({shouldOpenLpcAfterBundleLoaded:!1})};return i.createElement(t,{className:Object(s.css)(this.props.className,"a_a_434b99a9"),onClickCapture:n,onKeyDownCapture:this._triggerBootstrapByKeyboard,onMouseOver:r,onMouseLeave:c,ref:this._ref},this._renderContent())},t.prototype._renderContent=function(){var e,n,r,c={cardParameters:{personaInfo:{identifiers:Object(a.__assign)({PersonaType:this._personaType,Smtp:this.props.legacyUpn||this.props.email,Upn:this.props.legacyUpn||this.props.upn,TopicId:null===(e=this.props.topicCardProps)||void 0===e?void 0:e.topicId},this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}),topicMetadata:null===(n=this.props.topicCardProps)||void 0===n?void 0:n.topicCardMetadata,displayName:this.props.displayName,personaCoinColor:Object(s.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick,cardPlacementMode:this.props.cardPlacementMode},ariaLabel:this.props.ariaLabel},tabIndex:this.props.tabIndex},d=Boolean(this.props.legacyUpn||(null===(r=this.props.topicCardProps)||void 0===r?void 0:r.topicId)||this.props.upn||this.props.email);return d&&this._isLPCBundleLoaded()?i.createElement(t.livePersonaCardHoverTarget,Object(a.__assign)({},c,{onCardOpen:this._handleCardOpen}),i.Children.only(this.props.children)):d&&!this._isLPCBundleLoaded()?i.cloneElement(i.Children.only(this.props.children),{tabIndex:0,"data-is-focusable":!0,role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?o.Text.format(l.n,this.props.displayName):l.e),"aria-haspopup":"dialog"}):i.Children.only(this.props.children)},t.prototype._isLPCBundleLoaded=function(){return this.state.isBundleLoaded&&!!t.livePersonaCardHoverTarget},Object.defineProperty(t.prototype,"_logScenario",{get:function(){return this.props.clientScenario||"unset"},enumerable:!1,configurable:!0}),t.prototype._updateBundleMountedState=function(e){var t=this;this.setState({isBundleLoaded:!0},function(){return t._manuallyDispatchEventToTriggerCallout(e)})},Object.defineProperty(t.prototype,"_clientType",{get:function(){return this.props.clientType||u},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_personaType",{get:function(){return this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User"},enumerable:!1,configurable:!0}),t}(i.PureComponent);function _(e){var t,n=o.Text.format(l.a,e.displayName||""),r=new URL(window.location.href).pathname.toLowerCase();return i.createElement(m,Object(a.__assign)({},Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e),{ariaLabel:e.ariaLabel||n}),-1!==r.toLowerCase().indexOf("_layouts/15/")&&{topicCardProps:Object(a.__assign)(Object(a.__assign)({},e.topicCardProps),{topicCardMetadata:Object(a.__assign)(Object(a.__assign)({},null===(t=e.topicCardProps)||void 0===t?void 0:t.topicCardMetadata),{hideFeedbackQuestions:!0,hideEntityAndContextQuestion:!0})})})))}},ut3N:function(e,t){e.exports=d}})});