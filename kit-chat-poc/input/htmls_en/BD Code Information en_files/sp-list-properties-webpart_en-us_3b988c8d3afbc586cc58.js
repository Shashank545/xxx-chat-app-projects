define("a8cd4347-f996-48c1-bcfb-75373fed2a27_1.0.0",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-webpart-base","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-deferred-component","@microsoft/sp-diagnostics","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={9:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){var t={i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.3.325",m:"K9kD"};return{0:[t],8:[t],10:[t],1:[t],6:[t],2:[t],5:[t]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"sp-fields-webparts~sp-list-webpart-setup",1:"CustomerPromise.event",2:"TagsForImageFeedbackControl",4:"list-properties-property-pane",5:"shared-react-approvals-dialog",6:"shared-react-roostereditor",8:"sp-fields-webparts",10:"sp-list-webpart-setup",11:"vendors~shared-react-roostereditor",12:"vendors~sp-list-webpart-setup"}[e]||e)+"_"+(["en-us","none"])[{"0":0,"1":1,"2":0,"4":0,"5":0,"6":0,"8":0,"10":0,"11":1,"12":1}[e]]+"_"+{0:"82cc97b986e1a68c0cad",1:"d92b87fd1d061b15c4b7",2:"520aed40075a7cc48aeb",4:"c93668e5185a03508961",5:"5592aaee1f022ab0ca7f",6:"f389a52c0d756ee3faf1",8:"34351217544ad19862be",10:"4e766e660586c409ab23",11:"e2351cae9bf6bb4df927",12:"e20e0e48d96cd0dca93e"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_4ec0946ccf7b5264836bb62352873336=window.webpackJsonp_4ec0946ccf7b5264836bb62352873336||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp\-list\-properties\-webpart_en-us_3b988c8d3afbc586cc58\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="rPBD")}({"+QxE":function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n("UWqr");function i(){return a._SPFlight.isEnabled(4680)}function r(){return a._SPKillSwitch.isActivated("ffb78048-43e8-4330-9a4a-59911d5c3650")}function o(){return a._SPKillSwitch.isActivated("4ee2920a-164b-449f-859e-b2928c4833e6")}},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"5pbq":function(e,t){e.exports=i},"7Awa":function(e,t){e.exports=r},"7nmW":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("cDcd");function i(e){var t=a.useRef();return void 0===t.current&&(t.current={value:"function"==typeof e?e():e}),t.current.value}},AdvT:function(e,t,n){"use strict";n("jOlS").loadStyles(".a_a_ff79d318{color:#0078d4}.b_a_ff79d318{overflow-x:auto;overflow-y:auto}",!0),t.e={highlightedTitle:"a_a_ff79d318",scrollable:"b_a_ff79d318"}},CP8q:function(e,t,n){"use strict";var a=n("fglE");n.o(a,"AnimationStyles")&&n.d(t,"AnimationStyles",function(){return a.AnimationStyles}),n.o(a,"FLUENT_CDN_BASE_URL")&&n.d(t,"FLUENT_CDN_BASE_URL",function(){return a.FLUENT_CDN_BASE_URL}),n.o(a,"FontSizes")&&n.d(t,"FontSizes",function(){return a.FontSizes}),n.o(a,"FontWeights")&&n.d(t,"FontWeights",function(){return a.FontWeights}),n.o(a,"HighContrastSelector")&&n.d(t,"HighContrastSelector",function(){return a.HighContrastSelector}),n.o(a,"concatStyleSets")&&n.d(t,"concatStyleSets",function(){return a.concatStyleSets}),n.o(a,"getFocusStyle")&&n.d(t,"getFocusStyle",function(){return a.getFocusStyle}),n.o(a,"getGlobalClassNames")&&n.d(t,"getGlobalClassNames",function(){return a.getGlobalClassNames}),n.o(a,"getHighContrastNoAdjustStyle")&&n.d(t,"getHighContrastNoAdjustStyle",function(){return a.getHighContrastNoAdjustStyle}),n.o(a,"keyframes")&&n.d(t,"keyframes",function(){return a.keyframes}),n.o(a,"normalize")&&n.d(t,"normalize",function(){return a.normalize}),n.o(a,"registerIconAlias")&&n.d(t,"registerIconAlias",function(){return a.registerIconAlias}),n.o(a,"registerIcons")&&n.d(t,"registerIcons",function(){return a.registerIcons})},DqWU:function(e){e.exports=JSON.parse('{"e":"Allow users to edit list items"}')},F8bv:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("cDcd"),i=n("vNcA");function r(e,t){var n=a.useRef(t);return n.current||(n.current=Object(i.getId)(e)),n.current}},I6O9:function(e,t){e.exports=o},LflB:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("cDcd"),i=n("7nmW");function r(e,t,n){var r=a.useState(t),o=r[0],s=r[1],c=Object(i.e)(void 0!==e),d=c?e:o,l=a.useRef(d),u=a.useRef(n);a.useEffect(function(){l.current=d,u.current=n});var f=Object(i.e)(function(){return function(e,t){var n="function"==typeof e?e(l.current):e;u.current&&u.current(t,n),c||s(n)}});return[d,f]}},M1bi:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_IconComponent},Pk8u:function(e,t){e.exports=s},U4ag:function(e,t){e.exports=c},UWqr:function(e,t){e.exports=d},"X+PM":function(e,t){e.exports=l},YxgS:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("cDcd");function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=i.useCallback(function(t){n.current=t;for(var a=0,i=e;a<i.length;a++){var r=i[a];"function"==typeof r?r(t):r&&(r.current=t)}},Object(a.__spreadArray)([],e,!0));return n}},br4S:function(e,t){e.exports=u},cDcd:function(e,t){e.exports=f},faye:function(e,t){e.exports=p},fglE:function(e,t){e.exports=m},"hOb+":function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n("vNcA"),i=n("17wl"),r=n("cDcd"),o=n("F8bv"),s=n("YxgS"),c=n("LflB"),d=n("M1bi"),l=Object(a.classNamesFunction)(),u=r.forwardRef(function(e,t){var n=e.disabled,u=e.required,f=e.inputProps,p=e.name,m=e.ariaLabel,_=e.ariaLabelledBy,h=e.ariaDescribedBy,b=e.ariaPositionInSet,g=e.ariaSetSize,v=e.title,y=e.checkmarkIconProps,S=e.styles,D=e.theme,I=e.className,x=e.boxSide,C=void 0===x?"start":x,O=Object(o.e)("checkbox-",e.id),w=r.useRef(null),E=Object(s.e)(w,t),A=r.useRef(null),L=Object(c.e)(e.checked,e.defaultChecked,e.onChange),k=L[0],M=L[1],P=Object(c.e)(e.indeterminate,e.defaultIndeterminate),T=P[0],U=P[1];Object(a.useFocusRects)(w);var F=l(S,{theme:D,className:I,disabled:n,indeterminate:T,checked:k,reversed:"start"!==C,isUsingCustomLabelRender:!!e.onRenderLabel}),H=r.useCallback(function(e){T?(M(!!k,e),U(!1)):M(!k,e)},[M,U,T,k]),R=r.useCallback(function(e){return e&&e.label?r.createElement("span",{className:F.text,title:e.title},e.label):null},[F.text]),N=r.useCallback(function(e){if(A.current){var t=!!e;A.current.indeterminate=t,U(t)}},[U]);!function(e,t,n,a,i){r.useImperativeHandle(e.componentRef,function(){return{get checked(){return!!t},get indeterminate(){return!!n},set indeterminate(e){a(e)},focus:function(){i.current&&i.current.focus()}}},[i,t,n,a])}(e,k,T,N,A),r.useEffect(function(){return N(T)},[N,T]);var B=e.onRenderLabel||R,j=T?"mixed":void 0,V=Object(i.__assign)(Object(i.__assign)({className:F.input,type:"checkbox"},f),{checked:!!k,disabled:n,required:u,name:p,id:O,title:v,onChange:H,"aria-disabled":n,"aria-label":m,"aria-labelledby":_,"aria-describedby":h,"aria-posinset":b,"aria-setsize":g,"aria-checked":j});return r.createElement("div",{className:F.root,title:v,ref:E},r.createElement("input",Object(i.__assign)({},V,{ref:A,title:v,"data-ktp-execute-target":!0})),r.createElement("label",{className:F.label,htmlFor:O},r.createElement("div",{className:F.checkbox,"data-ktp-target":!0},r.createElement(d.Icon,Object(i.__assign)({iconName:"CheckMark"},y,{className:F.checkmark}))),B(e,R)))});u.displayName="CheckboxBase";var f=n("CP8q"),p={root:"ms-Checkbox",label:"ms-Checkbox-label",checkbox:"ms-Checkbox-checkbox",checkmark:"ms-Checkbox-checkmark",text:"ms-Checkbox-text"},m="20px",_="200ms",h="cubic-bezier(.4, 0, .23, 1)",b=Object(a.styled)(u,function(e){var t,n,r,o,s,c,d,l,u,b,g,v,y,S,D,I,x,C,O=e.className,w=e.theme,E=e.reversed,A=e.checked,L=e.disabled,k=e.isUsingCustomLabelRender,M=e.indeterminate,P=w.semanticColors,T=w.effects,U=w.palette,F=w.fonts,H=Object(f.getGlobalClassNames)(p,w),R=P.inputForegroundChecked,N=U.neutralSecondary,B=U.neutralPrimary,j=P.inputBackgroundChecked,V=P.inputBackgroundChecked,z=P.disabledBodySubtext,G=P.inputBorderHovered,K=P.inputBackgroundCheckedHovered,W=P.inputBackgroundChecked,q=P.inputBackgroundCheckedHovered,Q=P.inputBackgroundCheckedHovered,Y=P.inputTextHovered,J=P.disabledBodySubtext,X=P.bodyText,Z=P.disabledText,$=[(t={content:'""',borderRadius:T.roundedCorner2,position:"absolute",width:10,height:10,top:4,left:4,boxSizing:"border-box",borderWidth:5,borderStyle:"solid",borderColor:L?z:j,transitionProperty:"border-width, border, border-color",transitionDuration:_,transitionTimingFunction:h},t[f.HighContrastSelector]={borderColor:"WindowText"},t)];return{root:[H.root,{position:"relative",display:"flex"},E&&"reversed",A&&"is-checked",!L&&"is-enabled",L&&"is-disabled",!L&&[!A&&(n={},n[":hover .".concat(H.checkbox)]=(r={borderColor:G},r[f.HighContrastSelector]={borderColor:"Highlight"},r),n[":focus .".concat(H.checkbox)]={borderColor:G},n[":hover .".concat(H.checkmark)]=(o={color:N,opacity:"1"},o[f.HighContrastSelector]={color:"Highlight"},o),n),A&&!M&&(s={},s[":hover .".concat(H.checkbox)]={background:q,borderColor:Q},s[":focus .".concat(H.checkbox)]={background:q,borderColor:Q},s[f.HighContrastSelector]=(c={},c[":hover .".concat(H.checkbox)]={background:"Highlight",borderColor:"Highlight"},c[":focus .".concat(H.checkbox)]={background:"Highlight"},c[":focus:hover .".concat(H.checkbox)]={background:"Highlight"},c[":focus:hover .".concat(H.checkmark)]={color:"Window"},c[":hover .".concat(H.checkmark)]={color:"Window"},c),s),M&&(d={},d[":hover .".concat(H.checkbox,", :hover .").concat(H.checkbox,":after")]=(l={borderColor:K},l[f.HighContrastSelector]={borderColor:"WindowText"},l),d[":focus .".concat(H.checkbox)]={borderColor:K},d[":hover .".concat(H.checkmark)]={opacity:"0"},d),(u={},u[":hover .".concat(H.text,", :focus .").concat(H.text)]=(b={color:Y},b[f.HighContrastSelector]={color:L?"GrayText":"WindowText"},b),u)],O],input:(g={position:"absolute",background:"none",opacity:0},g[".".concat(a.IsFocusVisibleClassName," &:focus + label::before")]=(v={outline:"1px solid "+w.palette.neutralSecondary,outlineOffset:"2px"},v[f.HighContrastSelector]={outline:"1px solid WindowText"},v),g),label:[H.label,w.fonts.medium,{display:"flex",alignItems:k?"center":"flex-start",cursor:L?"default":"pointer",position:"relative",userSelect:"none"},E&&{flexDirection:"row-reverse",justifyContent:"flex-end"},{"&::before":{position:"absolute",left:0,right:0,top:0,bottom:0,content:'""',pointerEvents:"none"}}],checkbox:[H.checkbox,(y={position:"relative",display:"flex",flexShrink:0,alignItems:"center",justifyContent:"center",height:m,width:m,border:"1px solid ".concat(B),borderRadius:T.roundedCorner2,boxSizing:"border-box",transitionProperty:"background, border, border-color",transitionDuration:_,transitionTimingFunction:h,overflow:"hidden",":after":M?$:null},y[f.HighContrastSelector]=Object(i.__assign)({borderColor:"WindowText"},Object(f.getHighContrastNoAdjustStyle)()),y),M&&{borderColor:j},E?{marginLeft:4}:{marginRight:4},!L&&!M&&A&&(S={background:W,borderColor:V},S[f.HighContrastSelector]={background:"Highlight",borderColor:"Highlight"},S),L&&(D={borderColor:z},D[f.HighContrastSelector]={borderColor:"GrayText"},D),A&&L&&(I={background:J,borderColor:z},I[f.HighContrastSelector]={background:"Window"},I)],checkmark:[H.checkmark,(x={opacity:A&&!M?"1":"0",color:R},x[f.HighContrastSelector]=Object(i.__assign)({color:L?"GrayText":"Window"},Object(f.getHighContrastNoAdjustStyle)()),x)],text:[H.text,(C={color:L?Z:X,fontSize:F.medium.fontSize,lineHeight:"20px"},C[f.HighContrastSelector]=Object(i.__assign)({color:L?"GrayText":"WindowText"},Object(f.getHighContrastNoAdjustStyle)()),C),E?{marginRight:4}:{marginLeft:4}]}},void 0,{scope:"Checkbox"})},"hiL/":function(e,t){e.exports=_},iqkW:function(e,t,n){"use strict";n.d(t,"e",function(){return l}),n.d(t,"t",function(){return h}),n.d(t,"n",function(){return b});var a=n("17wl"),i=n("faye"),r=n("UWqr"),o=n("ut3N"),s=n("Pk8u"),c=n("5pbq"),d=n("2q6Q"),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._delayedRender=Object(s.debounce)(t.render,100),t}return Object(a.__extends)(t,e),t.prototype.onInit=function(){var t=this;return e.prototype.onInit.call(this).then(function(){t.renderedFromPersistedData||t.context.propertyPane.open()})},t.prototype.onDisplayModeChanged=function(t){e.prototype.onDisplayModeChanged.call(this,t),t===r.DisplayMode.Edit&&d._EngagementLogger.logEventWithLogEntry(new o._LogEntry(this.getScenarioName(),"EditFinished",o._LogType.Event,{propertiesCount:String(this.properties.selectedFieldIds?this.properties.selectedFieldIds.length:0)}))},t.prototype.onDispose=function(){i.unmountComponentAtNode(this.domElement)},t.prototype.onClientFormChanged=function(e){if(this._currentClientForm=e,this.context&&this.context.propertyPane)try{this.context.propertyPane.refresh()}catch(e){o._TraceLogger.logError(o._LogSource.create("ListPropertiesWebPart"),e,"PropertyPaneRefresh")}this.render()},t.prototype.onTitleChanged=function(e){this.properties.title=e,this.render()},t.prototype.onPropertyPaneFieldChanged=function(e,t,n){e.indexOf("selectedFieldIds")>-1&&(this.properties.selectedFieldIds=this.properties.selectedFieldIds?this.properties.selectedFieldIds.slice():void 0)},t.prototype.fetchData=function(){var e=this;if(r._SPKillSwitch.isActivated("4ee2920a-164b-449f-859e-b2928c4833e6")){var t=this.getPropertiesDataProvider();return Promise.resolve().then(function(){return null==t?void 0:t.getClientForm(e.itemIds||[])}).then(function(e){return e||{}})}return this.getPropertiesDataProviderWithPromise().then(function(t){return Promise.resolve().then(function(){return null==t?void 0:t.getClientForm(e.itemIds||[])}).then(function(e){return e||{}})})},t.prototype.dataReceived=function(e){var t,n,a,i=e;(null===(t=i.data)||void 0===t?void 0:t.fields)?this._currentClientForm=e.data:(null===(a=null===(n=i.data)||void 0===n?void 0:n.data)||void 0===a?void 0:a.fields)&&(this._currentClientForm=i.data.data),this._delayedRender()},Object.defineProperty(t.prototype,"currentClientForm",{get:function(){return this._currentClientForm},enumerable:!1,configurable:!0}),Object(a.__decorate)([c.autobind],t.prototype,"fetchData",null),Object(a.__decorate)([c.autobind],t.prototype,"dataReceived",null),t}(n("U4ag").BaseDataWebPart),u=n("cDcd"),f=n("br4S"),p=n("hOb+");n("jOlS").loadStyles(".e_c_ff79d318{margin:5px 0}",!0);var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.fields.map(function(t){return u.createElement(p.e,{key:t.id,className:"e_c_ff79d318",label:t.name,checked:t.checked,onChange:function(n,a){return e._handleCheckBoxChange(a,t)}})});return u.createElement("div",null,t)},t.prototype._handleCheckBoxChange=function(e,t){return this.props.changeCallback&&this.props.changeCallback("selectedFieldIds",this._updateSelectedFieldIds(this._selectedFieldIds,t.id,e))},t.prototype._updateSelectedFieldIds=function(e,t,n){var a=e.indexOf(t);return n?-1===a&&e.push(t):-1!==a&&(e=e.slice(0,a).concat(e.slice(a+1,e.length))),e},Object.defineProperty(t.prototype,"_selectedFieldIds",{get:function(){return this.props.fields.filter(function(e){return e.checked}).map(function(e){return e.id})},enumerable:!1,configurable:!0}),Object(a.__decorate)([c.autobind],t.prototype,"_handleCheckBoxChange",null),t}(u.PureComponent),_=n("DqWU");function h(e){return Object(f.PropertyPaneToggle)("allowEditing",{label:_.e,checked:e})}function b(e){return Object(f.PropertyPaneCustomField)({key:"selectFieldsPicker",onRender:function(t,n,a){i.render(u.createElement(m,{changeCallback:a,fields:e}),t)},onDispose:function(e){i.unmountComponentAtNode(e)}})}},jOlS:function(e,t){e.exports=h},jRu2:function(e){e.exports=JSON.parse('{"i":"List properties","a":"Connect to a list or list web part on this site.","t":"This web part is connected to {0}.","n":"Select an item in {0} to view it here.","e":"Connect","r":"Add a title"}')},qjmy:function(e,t){e.exports=b},rPBD:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("7Awa"),s=n("UWqr"),c=n("ut3N"),d=n("Pk8u"),l=n("X+PM"),u=n("y88i"),f=n("5pbq"),p=n("hiL/"),m=n("iqkW"),_=n("U4ag"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype._internalLoad=function(){return Promise.all([n.e(12),n.e(0),n.e(10)]).then(n.bind(null,"WJLh")).then(function(e){return e.ReactClientFormSetup})},t}(n("qjmy")._DeferredComponent),b=h,g=n("AdvT"),v=n("jRu2"),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e;switch(this.props.viewType){case"Unselected":e=i.createElement("div",{"data-automation-id":"listProperties"},this._emptyStateInViewMode);break;case"RichView":e=i.createElement("div",null);break;case"Form":var t={clientForm:this.props.data,interactiveSave:this.props.isInteractiveSave,isInfoPane:!1,pageContext:this.props.pageContext,customFormatterRendererProps:this.props.customFormatterRendererProps,onCancel:function(){return""},isReadOnly:!this.props.allowEditing,clientFormProvider:this.props.clientFormProvider,itemIds:this.props.itemIds,onSaveCallback:this.props.onSaveCallback,listContext:this.props.listContext};e=i.createElement(b,{deferredProps:{initReactClientFormProps:t,sectionTheme:this.props.sectionTheme,size:this.props.size}});break;default:e=this._placeHolder}return(this.props.isEdit||!("Empty"===this.props.viewType))&&i.createElement("div",null,this._webPartTitle,e)},Object.defineProperty(t.prototype,"_webPartTitle",{get:function(){return i.createElement(_.WebPartTitle,{edit:this.props.isEdit,placeholder:this.props.title||v.r,title:this.props.title,onTitleChange:this.props.updateTitle,marginBottomSize:"Large",theme:this.props.sectionTheme})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_placeHolder",{get:function(){return i.createElement(_.Placeholder,{icon:"GroupedList",iconText:v.i,description:v.a,buttonLabel:v.e,onAdd:this.props.openPropertyPane})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_emptyStateInViewMode",{get:function(){var e=i.createElement("span",{className:g.e.highlightedTitle},this.props.sourceTitle),t=v.t.split("{0}"),n=v.n.split("{0}"),a=i.createElement("div",null,n[0],e,n[1]),r=i.createElement("div",{className:"Placeholder-description"},i.createElement("div",{className:"Placeholder-descriptionText"},t[0],e,t[1],i.createElement("br",null),!this.props.isEdit&&a));return i.createElement(_.Placeholder,{icon:"GroupedList",iconText:v.i,description:""},r)},enumerable:!1,configurable:!0}),t}(i.PureComponent),S=n("+QxE"),D="refreshItem";function I(){return Promise.all([n.e(0),n.e(8)]).then(n.bind(null,"MxUo")).then(function(e){return new e.default})}var x=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._cachedDynamicDataValue=void 0,t._registeredToSourceChanged=!1,t._postOnSaveActions=function(e,n){t._notifyDataSourceDataChange();var a=t.fetchData().then(function(e){return t.onClientFormChanged(e),!Object(S.n)()&&(null==e?void 0:e.fields)&&(e.fields=e.fields.filter(function(e){return e.schema&&t._isFieldChecked(e.schema.Id)})),n.clientForm=e,n},function(e){throw e});return u.Promise.wrap(a)},t._handleThemeChangedEvent=function(e){t._variantTheme=e.theme,t.render()},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this._dynamicPropertySource;if(t){this._registeredToSourceChanged||(this.context.dynamicDataProvider.registerSourceChanged(t.id,this.render),this._registeredToSourceChanged=!0);var n=t.getPropertyValue("selectedListUrl");n!==this._serverRelativeListUrl&&(this._resetCachesAndStates(),this._serverRelativeListUrl=n)}if(Object(S.t)())if(this.properties.requestedDynamicProperty){var a=this.properties.requestedDynamicProperty.tryGetValues();this._refreshClientForm(a).then(function(){e._cachedDynamicDataValue=a,e._renderIntoDom()}).catch(function(t){c._TraceLogger.logError(e._currentLogSource,t,"RefreshClientForm")})}else this._renderIntoDom();else if(this.properties.requestedDynamicProperty){var i=this.properties.requestedDynamicProperty.tryGetValues();this._refreshClientForm(i).then(function(){e._cachedDynamicDataValue=i,e.getPropertiesDataProviderWithPromise().then(function(t){e.__renderIntoDomWithProvider(t)}).catch(function(t){c._TraceLogger.logError(e._currentLogSource,t,"can not load provider")})}).catch(function(t){c._TraceLogger.logError(e._currentLogSource,t,"RefreshClientForm")})}else this.getPropertiesDataProviderWithPromise().then(function(t){e.__renderIntoDomWithProvider(t)}).catch(function(t){c._TraceLogger.logError(e._currentLogSource,t,"can not load provider")})},t.prototype.onInit=function(){return this._currentLogSource=c._LogSource.create("ListPropertiesWebPart"),this._getSectionBackgroundTheme(),e.prototype.onInit.call(this)},t.prototype.onDispose=function(){this.properties.requestedDynamicProperty&&this.properties.requestedDynamicProperty.dispose(),this.properties.requestedDynamicProperty&&this.properties.requestedDynamicProperty.dispose(),this._resetCachesAndStates(),this.context.serviceScope.consume(o.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),r.unmountComponentAtNode(this.domElement),e.prototype.onDispose.call(this)},t.prototype.getViewType=function(){var e="New"===this.properties.formOption||this.currentClientForm&&this.currentClientForm.fields&&this.currentClientForm.fields.length>0;return this._dynamicPropertySource&&e?"Form":this._dynamicPropertySource?"Unselected":"Empty"},t.prototype.getScenarioName=function(){return"ListPropertiesWebPart"},t.prototype.getPageContext=function(){return this.context.serviceScope.consume(l.PageContext.serviceKey)},t.prototype.getLegacyPageContext=function(){if(!this._legacyPageContext){var e=this.getPageContext();if(!(null==e?void 0:e.legacyPageContext))throw new p.UnexpectedFailure("NoLegacyPageContext",void 0,{doesPageContextExist:Boolean(e)});this._legacyPageContext=Object(d.cloneDeep)(e.legacyPageContext)}return this._legacyPageContext&&(this._legacyPageContext.listUrl=this._serverRelativeListUrl),this._legacyPageContext},t.prototype.getListContext=function(){var e=this.getPageContext();return{urlParts:{fullItemUrl:"",fullListUrl:"",isCrossDomain:!1,isCrossList:!1,listRelativeItemUrl:"",serverRelativeItemUrl:"",serverRelativeListUrl:this._serverRelativeListUrl||"",normalizedListUrl:"",normalizedItemUrl:""},listTitle:e.list?e.list.title:void 0,refreshClientForm:!0,listUrl:this._serverRelativeListUrl,enableAttachments:!0}},t.prototype.getPropertiesDataProvider=function(){var e=this;return this._propertiesDataProvider||I().then(function(t){e._propertiesDataProvider=t.createClientFormProvider({listContext:e.getListContext(),pageContext:e.getLegacyPageContext()})},function(e){console.log(e)}),this._propertiesDataProvider},t.prototype.getPropertiesDataProviderWithPromise=function(){var e=this;return this._propertiesDataProvider?Promise.resolve(this._propertiesDataProvider):I().then(function(t){return e._propertiesDataProvider=t.createClientFormProvider({listContext:e.getListContext(),pageContext:e.getLegacyPageContext()}),Promise.resolve(e._propertiesDataProvider)},function(e){return Promise.reject(e)})},t.prototype.loadPropertyPaneResources=function(){var e=this;return n.e(4).then(n.bind(null,"ZR9k")).then(function(t){e._listPropertiesPropertyPaneModule=t.ListPropertiesPropertyPane})},t.prototype.getPropertyPaneConfiguration=function(){var e=this,t={size:this.properties.size,allowEditing:this.properties.allowEditing,formOption:this.properties.formOption,lists:[],fields:this._getFieldsForPropertyPaneConfiguration()};return this._listPropertiesPropertyPaneModule.getConfiguration(t,this._shouldShowSecondaryGroup,function(){e.properties.requestedDynamicProperty&&e.properties.requestedDynamicProperty.dispose(),e._resetCachesAndStates(),e.properties.selectedFieldIds=void 0,e.properties.requestedDynamicProperty=void 0,e.render()},function(){e.context.propertyPane.refresh()})},t.prototype.onPropertyPaneFieldChanged=function(e,t,n){"dataSourceType"!==e?("requestedDynamicProperty"===e&&(this.properties.selectedFieldIds=void 0,this._resetCachesAndStates()),"selectedFieldIds"===e&&this.render()):"List"===n&&(this.properties.formOption="New")},t.prototype.onClientFormChanged=function(t){return this.properties.selectedFieldIds||this.displayMode!==s.DisplayMode.Edit||(this.properties.selectedFieldIds=t.fields.filter(function(e){return e.schema.Id}).map(function(e){return e.schema.Id})),e.prototype.onClientFormChanged.call(this,t)},t.prototype._getFieldsForPropertyPaneConfiguration=function(){var e=this;return this._serverRelativeListUrl&&(Object(S.t)()?this.getPropertiesDataProvider().getClientFormSchema().then(function(t){Object(d.isEqual)(e._cachedClientFormSchema,t)||(e._cachedClientFormSchema=t,e.context.propertyPane.refresh())}).catch(function(t){c._TraceLogger.logError(e._currentLogSource,t,"FailedFetchSchema")}):this.getPropertiesDataProviderWithPromise().then(function(t){t.getClientFormSchema().then(function(t){Object(d.isEqual)(e._cachedClientFormSchema,t)||(e._cachedClientFormSchema=t,e.context.propertyPane.refresh())}).catch(function(t){c._TraceLogger.logError(e._currentLogSource,t,"FailedFetchSchema")})}).catch(function(t){c._TraceLogger.logError(e._currentLogSource,t,"can not load provider")})),this._cachedClientFormSchema?this._cachedClientFormSchema.fields.map(function(t){return{id:t.Id,name:t.Title,checked:e._isFieldChecked(t.Id)}}):[]},t.prototype._renderIntoDom=function(){var e=this,t=Object(a.__assign)(Object(a.__assign)({isEdit:this.displayMode===s.DisplayMode.Edit,isInteractiveSave:!!this.itemIds&&this.itemIds.length<=1,viewType:this.getViewType(),openPropertyPane:function(){return e.displayMode===s.DisplayMode.Edit&&e.context.propertyPane.open()},updateTitle:function(t){return e.properties.title=t},data:this._unselectedFieldsClientForm,sourceTitle:this._dynamicPropertySource&&this._dynamicPropertySource.metadata.title,pageContext:this.getLegacyPageContext(),sectionTheme:this._variantTheme,clientFormProvider:this.getPropertiesDataProvider().getClientFormProvider(),onSaveCallback:this._postOnSaveActions,itemIds:this.itemIds,customFormatterRendererProps:this._dynamicPropertySource?this._dynamicPropertySource.getPropertyValue("selectedItemFormatterProps"):void 0},this.properties),{listContext:this._dynamicPropertySource?this._dynamicPropertySource.getPropertyValue("listContext"):void 0});r.render(i.createElement(y,t),this.domElement)},t.prototype.__renderIntoDomWithProvider=function(e){var t=this,n=Object(a.__assign)(Object(a.__assign)({isEdit:this.displayMode===s.DisplayMode.Edit,isInteractiveSave:!!this.itemIds&&this.itemIds.length<=1,viewType:this.getViewType(),openPropertyPane:function(){return t.displayMode===s.DisplayMode.Edit&&t.context.propertyPane.open()},updateTitle:function(e){return t.properties.title=e},data:this._unselectedFieldsClientForm,sourceTitle:this._dynamicPropertySource&&this._dynamicPropertySource.metadata.title,pageContext:this.getLegacyPageContext(),sectionTheme:this._variantTheme,clientFormProvider:e.getClientFormProvider(),onSaveCallback:this._postOnSaveActions,itemIds:this.itemIds,customFormatterRendererProps:this._dynamicPropertySource?this._dynamicPropertySource.getPropertyValue("selectedItemFormatterProps"):void 0},this.properties),{listContext:this._dynamicPropertySource?this._dynamicPropertySource.getPropertyValue("listContext"):void 0});r.render(i.createElement(y,n),this.domElement)},t.prototype._isFieldChecked=function(e){return!this.properties.selectedFieldIds||-1!==this.properties.selectedFieldIds.indexOf(e)},Object.defineProperty(t.prototype,"_unselectedFieldsClientForm",{get:function(){var e=this,t=Object(d.cloneDeep)(this.currentClientForm);return(null==t?void 0:t.fields)&&this.properties.selectedFieldIds&&(t.fields=t.fields.filter(function(t){return t.schema&&-1!==e.properties.selectedFieldIds.indexOf(t.schema.Id)})),t},enumerable:!1,configurable:!0}),t.prototype._resetCachesAndStates=function(){this._propertiesDataProvider=void 0,this._cachedClientFormSchema=void 0,this._cachedDynamicDataValue=void 0},t.prototype._notifyDataSourceDataChange=function(){var e=this,t=this._dynamicPropertySource;t&&t.sendEvent&&t.allowedEventsAsync&&t.allowedEventsAsync().then(function(n){n&&n.some(function(e){return e.name===D})&&t.sendEvent(D,{itemIds:e.itemIds})}).catch(function(t){return c._TraceLogger.logError(e._currentLogSource,t,"_notifyDataSourceDataChange")})},Object.defineProperty(t.prototype,"_dynamicPropertySource",{get:function(){return this.properties.requestedDynamicProperty&&this.properties.requestedDynamicProperty.tryGetSource()},enumerable:!1,configurable:!0}),t.prototype._refreshClientForm=function(e){var t=this;try{return!Object(d.isEqual)(e,this._cachedDynamicDataValue)&&(e&&0!==e.length||this._cachedDynamicDataValue&&0!==this._cachedDynamicDataValue.length)?(this.itemIds=this._serverRelativeListUrl?this._convertSelectedItemsToItemIds(e):[],this.fetchData().then(function(e){return Promise.resolve(t.onClientFormChanged(e))}).catch(function(e){c._TraceLogger.logError(t._currentLogSource,e,"RefreshClientForm")})):Promise.resolve()}catch(e){return Promise.resolve()}},t.prototype._convertSelectedItemsToItemIds=function(e){var t=[];if(e)for(var n=0,a=e;n<a.length;n++){var i=a[n],r=i&&i.ID;r&&t.push(r)}return t},Object.defineProperty(t.prototype,"_shouldShowSecondaryGroup",{get:function(){return Boolean(this.properties.requestedDynamicProperty instanceof o.DynamicProperty&&this.properties.requestedDynamicProperty.reference)},enumerable:!1,configurable:!0}),t.prototype._getSectionBackgroundTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(o.ThemeProvider.serviceKey);e._variantTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},Object(a.__decorate)([f.autobind],t.prototype,"render",null),Object(a.__decorate)([f.autobind],t.prototype,"_isFieldChecked",null),Object(a.__decorate)([f.autobind],t.prototype,"_refreshClientForm",null),t}(m.e);t.default=x},ut3N:function(e,t){e.exports=g},vNcA:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},y88i:function(e,t){e.exports=v}})});