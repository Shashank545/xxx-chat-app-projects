define("2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@ms/sp-office-browser-feedback","@ms/sp-a11y"],function(n,a,i,r,o,s,c,d,l,u){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"5pbq":function(e,t){e.exports=i},U9OY:function(e){e.exports=JSON.parse('{"o":"You just published a page! Tell us how it went.","i":"We have just two questions for you.","r":"Sure","a":"Not now","s":"How satisfied are you with creating and publishing a page?","c":"1 - Very dissatisfied","d":"2","l":"3","u":"4","f":"5 - Very satisfied","p":"Press alt + down arrow key to go to feedback form.","e":"You just edited an image! Tell us how it went.","t":"How would you rate your experience with images in SharePoint Pages?","n":"Please tell us more. Why did you choose that rating?"}')},UWqr:function(e,t){e.exports=r},"X+PM":function(e,t){e.exports=o},"hiL/":function(e,t){e.exports=s},jOlS:function(e,t){e.exports=c},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"SPFeedback",function(){return S}),n.d(t,"spFeedbackServiceKey",function(){return D});var a=n("17wl");n("jOlS").loadStyles("#obf-TFormContainer{color:#000!important}",!0);var i=n("UWqr"),r=n("ut3N"),o=n("X+PM"),s=n("5pbq"),c=n("hiL/"),d=n("ytfe"),l=function(e){function t(n){return e.call(this,n,{serviceKey:t.serviceKey,isShared:!1})||this}return Object(a.__extends)(t,e),t.prototype.createA11yManager=function(t){var n=this;i.Validate.isNotNullOrUndefined(t,"domElement"),e.prototype.createServiceComponent.call(this,this.componentConfiguration,function(e){return d.A11yManager.create(t,n.componentConfiguration||void 0)})},Object.defineProperty(t.prototype,"a11yManager",{get:function(){return this.serviceComponent},enumerable:!1,configurable:!0}),t.a11yServiceName="sp-pages-core:A11yManager",t.serviceKey=i.ServiceKey.create(t.a11yServiceName,t),t}(function(){function e(e,t){i.Validate.isNotNullOrUndefined(e,"serviceScope"),i.Validate.isNotNullOrUndefined(t,"serviceConfiguration"),i.Validate.isNotNullOrUndefined(t.serviceKey,"serviceConfiguration.serviceKey"),this._serviceScope=e,this._serviceConfiguration=t,this._isDisposed=!1}return e.prototype.dispose=function(){this._isDisposed||(this.onDispose(),this._isDisposed=!0)},Object.defineProperty(e.prototype,"componentConfiguration",{get:function(){return this._componentConfiguration},set:function(e){this._componentConfiguration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceConfiguration",{get:function(){return this._serviceConfiguration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serviceScope",{get:function(){return this._serviceScope},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this._isDisposed},enumerable:!1,configurable:!0}),e.prototype.createServiceComponent=function(e,t){i.Validate.isNotNullOrUndefined(t,"componentFactory"),void 0===this._serviceComponent&&(this._componentConfiguration=e,this._serviceComponent=t(e))},Object.defineProperty(e.prototype,"serviceComponent",{get:function(){return this._serviceComponent},enumerable:!1,configurable:!0}),e.prototype.onDispose=function(){},e}()),u=n("xxCU"),f=n("2q6Q"),p=r._LogSource.create("SPFeedback"),m=n("U9OY"),_=[{CampaignId:"dd025788-0c5d-4dde-812e-2b30af0d3bf9",StartTimeUtc:"2020-03-19T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"PublishFeatureUsage",Count:1,IsAggregate:!0},Content:{Prompt:{Title:m.o,Question:m.i,YesLabel:m.r,NoLabel:m.a},Rating:{isZeroBased:!1,Question:m.s,RatingValuesAscending:[m.c,m.d,m.l,m.u,m.f]},Question:{Question:m.n}}}},{CampaignId:"5ad3420d-1e81-40f3-80bd-812c7989977a",StartTimeUtc:"2023-03-10T00:00:00Z",EndTimeUtc:"2023-09-12T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7884e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ImageEditUsage",Count:5,IsAggregate:!0},Content:{Prompt:{Title:m.e,Question:m.i,YesLabel:m.r,NoLabel:m.a},Rating:{isZeroBased:!1,Question:m.t,RatingValuesAscending:[m.c,m.d,m.l,m.u,m.f]},Question:{Question:m.n}}}}],h=function(){function e(){}return e.EDOG="edog",e.PROD_BUBBLE="prodbubble",e.PROD="prod",e}(),b="SPFeedback",g=u.officeFeedbackIntlBaseUrl,v="AppUsageTime",y="UpdateFlightsForOfficeFeedback",S=function(){function e(e){var t=this;this.instanceId="f709c1cd-2daf-4093-a99a-a167b55ebc23",this.componentId="f709c1cd-2daf-4093-a99a-a167b55ebc23",this.isDisposed=!1,e.whenFinished(function(){t._pageContext=e.consume(o.PageContext.serviceKey),t._a11yService=e.consume(l.serviceKey),t._pageService=e.consume(c.PageService.serviceKey)})}return e.translateOfficeFeedbackPolicies=function(e){void 0===e&&(e=[]);var t=i._SPKillSwitch.isActivated("64935134-a0da-4b20-b841-483c33d590bf")?{}:{policyAllowFeedback:!0,policyAllowSurvey:!0};return e.forEach(function(e){if("common\\feedback"===e.key&&"Web"===e.platform)switch(e.settingId){case"office16;L_SendFeedback":t.policyAllowFeedback="1"===e.value;break;case"office16;L_SendSurvey":t.policyAllowSurvey="1"===e.value;break;case"office16;L_Screenshot":t.policyAllowScreenshot="1"===e.value;break;case"office16;L_EmailCollection":t.policyAllowContact="1"===e.value;break;case"office16;L_LogCollection":t.policyAllowContent="1"===e.value}}),t},e._handleDismiss=function(t,n){var i,o,s,c,d,l={campaignId:t},u=new r._LogEntry(b,n?"Submitted":"Dismissed",r._LogType.Event,l);if(r._EngagementLogger.logEventWithLogEntry(u),n){var f=null===(i=e._spFloodgate)||void 0===i?void 0:i.getEngine(),p="Unknown";if(f){var m=f.launchedSurveys;if(!m)return p="NoSurveys",void e._logNoBackupScore(p);var _=void 0;for(var h in m)if((null===(c=null===(s=null===(o=m[h])||void 0===o?void 0:o.surveyInfo)||void 0===s?void 0:s.data)||void 0===c?void 0:c.backEndIdentifier)===t){if(void 0!==(_=null===(d=m[h].rating)||void 0===d?void 0:d.selectedIndex)){var g=new r._LogEntry(b,"Rated",r._LogType.Event,Object(a.__assign)(Object(a.__assign)({},l),{rating:(++_).toString()}));r._EngagementLogger.logEventWithLogEntry(g)}else p="NoSurveyResult",e._logNoBackupScore(p);return}p="CampaignMismatch"}else p="NoEngine";e._logNoBackupScore(p)}},e._logNoBackupScore=function(e){new r._QosMonitor("".concat(b,".NoBackupScore")).writeUnexpectedFailure(e)},e._setFloodgateWindowEvents=function(){this&&(window.addEventListener("focus",e._resumeUsage),window.addEventListener("blur",e._pauseUsage),window.addEventListener("unload",e._stopFloodgate),document.addEventListener(y,this._handleFlightsForOfficeFeedback))},e._stopFloodgate=function(){e._spFloodgate?(e._pauseUsage(),e._spFloodgate.stop()):e._floodgateLogError("floodGateUndefinedAtStop",!1)},e._startFloodgateAsync=function(){return e._spFloodgate||e._floodgateLogError("floodGateUndefinedAtStart",!0),e._spFloodgate.start().then(function(){return e._resumeUsage()}).catch(function(t){e._floodgateLogError("floodGateStartFailed",!0,t)})},e._pauseUsage=function(){e._activityListener?e._activityListener.logActivityStopTime(v,new Date):e._floodgateLogError("floodGateUndefinedAtPause",!1)},e._resumeUsage=function(){e._activityListener?(e._activityListener.logActivity("AppResume"),e._activityListener.logActivityStartTime(v)):e._floodgateLogError("floodGateUndefinedAtResume",!1)},e._initializeStartFloodgateAsync=function(){return e._spFloodgate.initialize().then(function(){return e._startFloodgateAsync()}).then(function(){r._TraceLogger.logVerbose(e._logSource,"Initialized and started floodgate successfully")}).catch(function(t){e._floodgateLogError("_initializeStartFloodgateAsync",!0,t)})},e._floodgateLogError=function(t,n,a){if(a=a||new Error(t),r._TraceLogger.logError(e._logSource,a,t),n)throw new r._QosMonitor("".concat(b,".").concat(t)).writeUnexpectedFailure(void 0,a),a},e._getTheme=function(){var e,t,n=window.__themeState__;return(null==n?void 0:n.theme)&&(e=n.theme.themePrimary,t=n.theme.themeSecondary),{themePrimary:e||"#0078d4",themeSecondary:t||"#2b88d8"}},Object.defineProperty(e,"_buildNumber",{get:function(){var e=f._Telemetry.buildNumber,t=/[0-9]{1,4}-?[0-9]{1,2}-?[0-9]{1,2}\.[0-9]{1,9}/;return t.test(e)?e.match(t)[0].replace(/-/g,""):"0"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_activityListener",{get:function(){var t,n;return null===(n=null===(t=e._spFloodgate)||void 0===t?void 0:t.getEngine())||void 0===n?void 0:n.getActivityListener()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_infoOnUIAppHost",{get:function(){var e="Default";return i._BrowserUtilities.isTeamsWebViewHosted()||i._BrowserUtilities.isTeamsBrowserHosted()||i._BrowserUtilities.isEmbeddedInSite()?e="TeamsNonMobile":(i._BrowserUtilities.isTeamsAndroidHosted()||i._BrowserUtilities.isTeamsIOSHosted())&&(e="TeamsMobile"),e},enumerable:!1,configurable:!0}),e.prototype.startAppUsageAsync=function(){return this.setupFloodgate().then(function(){e._activityListener&&e._activityListener.logActivityStartTime(v)}).catch(function(t){r._TraceLogger.logError(e._logSource,t,"SPFeedbackUtility.startAppUsageAsync")})},e.prototype.setupFeedback=function(t){var n=this;if(e._isFeedbackInitialized)return Promise.resolve(e._spFeedback);var a=new r._QosMonitor("".concat(b,".setupFeedback"));return Object(u.loadFloodgateAsync)().then(function(){return e._spFeedback=window.OfficeBrowserFeedback,n._initializeFeedback(t),a.writeSuccess(),e._spFeedback}).catch(function(e){throw a.writeUnexpectedFailure("SetUpFail",e),e})},e.prototype.setupFloodgate=function(){var t=this;if(e._isFloodgateInitialized)return Promise.resolve(e._spFeedback);var n=new r._QosMonitor("".concat(b,".setupFloodgate"));return Object(u.loadFloodgateAsync)().then(function(){return e._spFeedback=window.OfficeBrowserFeedback,e._spFloodgate=e._spFeedback.floodgate,t._initializeFloodgate(),n.writeSuccess(),e._spFeedback}).catch(function(e){throw n.writeUnexpectedFailure("SetUpFail",e),e})},e.prototype.logActivityForFeedbackAsync=function(t){if(t&&(void 0===t.isDependentExpGroup||(null==t?void 0:t.isDependentExpGroup))){var n=new r._QosMonitor("".concat(b,".logActivityForFeedbackAsync"));return this.setupFloodgate().then(function(){e._activityListener.logActivity(t.name),n.writeSuccess()}).catch(function(e){n.writeUnexpectedFailure("FeedbackLogActivityFail",e)})}},e.prototype.onSurveyActivated=function(t){try{r._EngagementLogger.logEvent("".concat(b,".SurveyActivated")),window.addEventListener("keydown",this._handleKeyDown,!1)}catch(t){e._floodgateLogError("onSurveyActivatedPreLog",!1,t)}t.launch(),this._a11yService.a11yManager.alert(m.p)},e.prototype.dispose=function(){window.removeEventListener("focus",e._resumeUsage),window.removeEventListener("blur",e._pauseUsage),window.removeEventListener("unload",e._stopFloodgate),window.removeEventListener("keydown",this._handleKeyDown,!1),document.removeEventListener(y,e._handleFlightsForOfficeFeedback),i._SPEventManager.instance.unregisterEvent("recordSurveyEvent",this,this.logActivityForFeedbackAsync),e._isFeedbackInitialized=!1,e._isFloodgateInitialized=!1,this.isDisposed=!0},e.prototype._initializeFeedback=function(t){var n,a,o=function(e,t){var n=function(e){var t=!1;return e.getPageBasicInfo().then(function(e){t="Topic"===e.pageLayoutType}).catch(function(e){r._TraceLogger.logError(p,e,"SPFeedbackUtility.getFeedbackOptions")}),t}(t),a=Object(c.isManageTopicsQuerySelected)(),i=Object(c.isSiteKnowledgeCenter)(e.legacyPageContext);return n||i||a?{appId:2588,featureArea:n?"Topic Page":a?"Manage Topics":"Topic Center",isShowThanks:!0}:{appId:2144,featureArea:"Modern Pages and News Authoring (Floodgate)"}}(this._pageContext,this._pageService);if(!e._isFeedbackInitialized){!function(){try{if(window.localStorage){var e=_;window.localStorage.setItem("obf-CampaignDefinitions",JSON.stringify(e))}}catch(e){new r._QosMonitor("".concat(b,".CampaignDefinitions")).writeUnexpectedFailure("StorageFailure",e)}}();var s=i.Environment.type===i.EnvironmentType.Local?1:0,d=e._getTheme(),l=this._pageContext,f=null===(n=l.aadInfo)||void 0===n?void 0:n.tenantId.toString(),m=null===(a=l.aadInfo)||void 0===a?void 0:a.userId.toString(),h={feedbackTenant:window.location.hostname};h.appData=JSON.stringify({UiHost:e._infoOnUIAppHost});var v=e._buildNumber,y=l.legacyPageContext;e._spFeedback.initOptions={appId:o.appId,applicationGroup:h,build:v,environment:s,intlFilename:"officebrowserfeedbackstrings.js",intlUrl:g,locale:l.cultureInfo.currentUICultureName,onError:function(e){new r._QosMonitor("".concat(b,".initOnError")).writeUnexpectedFailure("SDKErrorHandler",new Error(e))},primaryColour:d.themePrimary,screenshot:!t||t.policyAllowScreenshot,secondaryColour:d.themeSecondary,stylesUrl:u.officeFeedbackCssUrl,telemetryGroup:{audienceGroup:this._pageEnvironment,deviceType:navigator.userAgent,loggableUserId:m,officeUILang:l.legacyPageContext.currentLanguage,platform:navigator.platform,tenantId:f,featureArea:o.featureArea},showEmailAddress:t?t.policyAllowContact:void 0,userEmail:l.user.email,webGroup:{browser:navigator.appCodeName,browserVersion:navigator.appVersion},bugForm:o.bugForm,isShowThanks:o.isShowThanks,telemetrySink:Object(u.getTelemetrySink)({featureArea:o.featureArea,legacyPageContext:y,pageContext:l,version:v})},e._spFeedback.initOptions.telemetryGroup.flights=Array.from(e._flightsForTelemetryGroup).join(","),e._isFeedbackInitialized=!0,i._SPEventManager.instance.registerEvent("recordSurveyEvent",this,this.logActivityForFeedbackAsync)}},e.prototype._initializeFloodgate=function(){this._initializeFeedback(),e._isFloodgateInitialized||(e._spFloodgate.initOptions={onSurveyActivatedCallback:this,onDismiss:e._handleDismiss},e._setFloodgateWindowEvents(),e._initializeStartFloodgateAsync().then(function(){e._isFloodgateInitialized=!0}))},e.prototype._handleKeyDown=function(t){if(t.altKey&&t.which===s.KeyCodes.pageDown){var n=document.getElementById("obf-TPromptContainer")||void 0;n?this._a11yService.a11yManager.focusTo(n):e._floodgateLogError("toastContainerNotFound",!1)}},Object.defineProperty(e.prototype,"_pageEnvironment",{get:function(){var e=this._pageContext;switch((e.legacyPageContext&&e.legacyPageContext.env||"").toLowerCase()){case h.EDOG:case h.PROD_BUBBLE:return"Dogfood";default:return"Production"}},enumerable:!1,configurable:!0}),e.feedbackServiceName="sp-feedback:SPFeedback",e._flightsForTelemetryGroup=new Set,e._logSource=r._LogSource.create(b),e._isFeedbackInitialized=!1,e._isFloodgateInitialized=!1,e._handleFlightsForOfficeFeedback=function(t){var n=t;if(n&&n.detail&&n.detail.flights){var a=!1,i=function(t){var n,i=t.split("_"),r=2===i.length?i[1]:void 0;void 0!==r&&(n="0"===r?"1":"0",n=i[0]+"_"+n),n&&e._flightsForTelemetryGroup.has(n)&&(e._flightsForTelemetryGroup.delete(n),a=!0)};if("string"==typeof n.detail.flights){var r=n.detail.flights;i(r),e._flightsForTelemetryGroup.has(r)||(e._flightsForTelemetryGroup.add(r),a=!0)}else n.detail.flights.forEach(function(t){i(t),e._flightsForTelemetryGroup.has(t)||(e._flightsForTelemetryGroup.add(t),a=!0)});a&&e._isFloodgateInitialized&&(e._isFloodgateInitialized=!1,e._stopFloodgate(),e._spFeedback.initOptions.telemetryGroup.flights=Array.from(e._flightsForTelemetryGroup).join(","),e._startFloodgateAsync().then(function(){e._isFloodgateInitialized=!0}))}},e}(),D=i.ServiceKey.create(S.feedbackServiceName,S)},ut3N:function(e,t){e.exports=d},xxCU:function(e,t){e.exports=l},ytfe:function(e,t){e.exports=u}})});