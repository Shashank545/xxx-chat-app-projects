(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[9],{"+HmL":function(e,t,n){"use strict";var a=n("jyrw"),i=function(){function e(){}return e.setIsHighlightsListEnabled=function(t){a.e._dispatchAction("SET_HIGHLIGHTS_LIST_FLAG",t,e._moduleName,"VivaTopicsSetHighlightsListEnabled")},e.setManualHighlightedTopics=function(t){a.e._dispatchAction("SET_MANUAL_HIGHLIGHTED_TOPICS",t,e._moduleName,"VivaTopicsSetHighlightedTopics")},e.setAutoHighlightedTopics=function(t){a.e._dispatchAction("SET_AUTO_HIGHLIGHTED_TOPICS",t,e._moduleName,"VivaTopicsSetHighlightedTopics")},e.setTopicBadges=function(t){a.e._dispatchAction("SET_TOPIC_BADGES_DESCRIPTION",t,e._moduleName,"VivaTopicsSetTopicBadgesDescription")},e.setTopicBadgesAllowedEditors=function(t){a.e._dispatchAction("SET_TOPIC_BADGES_ALLOWED_EDITORS",t,e._moduleName,"VivaTopicsSetTopicBadgesAllowedEditors")},e._moduleName="[VivaTopicsPaneActionCreator]",e}();t.e=i},"+Mf1":function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("2q6Q"),r=n("ut3N"),o=n("UWqr"),s=n("Pk8u"),c=n("hiL/"),d=n("sSDQ"),l=n("Z95U"),u=n("HVbJ"),f=n("YNug"),p=n("Tiid"),m=n("0SGS"),_=n("lF8N"),h=n("xs0R"),b=n("n1SJ"),g=n("Fn15"),v=n("7plR"),y=n("M+LP"),S=n("jyrw"),D=n("q+wp"),I=n("lmp7"),x=n("onFi"),C=n("XCkH"),O=n("EMa1"),w=n("ExwJ"),E=n("0IsF"),A=n("Hts7"),L=n("XdGY"),k=n("4qRg"),M=n("oR8w"),P=n("lDgI"),T=n("LjAQ"),U=n("9sBY"),F=n("67N2"),H=n("GDsS"),R=n("dInN"),N=n("k6KK"),B=n("Yo/j"),j=n("kJuR"),V=n("6U0E"),z=n("cDcd"),G=n("5pbq"),K=n("VCl9"),W=n("Gccx"),q=n("+HmL"),Q=n("aflJ"),Y=n("hSOH");function J(){return o._SPKillSwitch.isActivated("2a345ff1-dc22-4500-9a07-871c74c82326")}var X=[E.e.Article,E.e.NewsDigest,E.e.Topic],Z="[PageFieldStoreAction]",$=r._LogSource.create("PageFieldStoreActionCreator"),ee=(new DOMParser).parseFromString("","text/html"),te=function(){function e(){}var t;return e.scheduleNewMajorVersionToServerAsync=function(){return this._executeActionAsync(this._scheduleNewMajorVersionToServerAsync.bind(this),"SPPageFieldStorePublish")},e.publishNewMajorVersionToServerAsync=function(){return this._executeActionAsync(this._publishNewMajorVersionToServerAsync.bind(this),"SPPageFieldStorePublish")},e.discardPageOnServerAsync=function(){return this._executeActionAsync(this._discardPageOnServerAsync.bind(this),"SPPageFieldStoreDiscard")},e.getPreviousPageVersionInfoAsync=function(){return this._executeActionAsync(this._getPreviousPageVersionInfoAsync.bind(this),"SPPageFieldStoreDiscard")},e.setListItemModerationStatusAsync=function(e,t){return this._executeActionAsync(this._setListItemModerationStatusAsync.bind(this,e,t),"SPPageFieldStoreSetModerationStatus")},e.setFileCheckInCommentsAsync=function(){return this._executeActionAsync(this._setFileCheckInComments.bind(this),"SPPageFieldStoreSetCheckinComments")},e.startCoAuthAsync=function(e){return this._executeActionAsync(this._startCoAuthAsync.bind(this,e),"CoAuth.StartCoAuthSessionClient",!0)},e.savePageCoAuthFromServerAsync=function(e){var t=this;return this._executeActionAsync(function(){return t._saveOrPublishPageCoAuthFromServerAsync(!1,e)},"CoAuth.SavePageCoAuthClient",!0)},e.saveAndPublishPageCoAuthFromServerAsync=function(e){var t=this;return this._executeActionAsync(function(){return t._saveOrPublishPageCoAuthFromServerAsync(!0,{shouldSaveAsNewVersion:!1,lockAction:e.lockAction,isAutoSave:!1})},"CoAuth.PublishCoAuthClient",!0)},e.checkOutFieldsFromServerAsync=function(e,t){var n=this;return void 0===e&&(e=!1),void 0===t&&(t=!1),this._executeActionAsync(function(){return n._checkOutPageFromServerAsync(e,t)},"SPPageFieldStoreCheckout",!e&&!Object(F.n)())},e.saveDraftToServerAsync=function(){var e=this;return this._executeActionAsync(function(){return e._saveDraftToServerAsync()},"SPPageFieldStoreSaveDraft")},e.saveFieldsToServerAsync=function(e){var t=this;return void 0===e&&(e=!1),D.e.isNewTopicPage()&&!this.ensureValidPageTitle()?Promise.reject("Page title not valid"):this._executeActionAsync(function(){return t._saveFieldsToServerAsync(e)},"SPPageFieldStoreSave")},e.getPageUrlFromServerAsync=function(){var e=this,t=new i._QosMonitor("SPPageFieldStoreGetFileName");return v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return t.getPageUrlAsync(n)}).then(function(n){e._dispatchActionWithLogFeature("FIELDS_SET_FILENAME",n,"SPPageFieldStoreGetFileName",t)}).catch(function(n){e._errorFilter(n,t,"SPPageFieldStoreGetFileName")})},e.getHighlightsInfoAsync=function(){var e=this,t=new i._QosMonitor("VivaTopicGetHighlightsInfo");return v.e.instance.getPageDataProviderAsync().then(function(n){var a=e._getListItemID();return t.writeSuccess(),n.getHighlightsInfo(a)}).catch(function(e){throw t.writeExpectedFailure("VivaTopicGetHighlightsInfo",e),e})},e.checkInFileAsync=function(e,t,n){return this._executeActionAsync(this._checkInFile.bind(this,e,t,n),"SPPageCheckInFile")},e.ensureValidPageTitle=function(t){var n;void 0===t&&(t=!1);var a=null===(n=h.t.fields)||void 0===n?void 0:n.Title;if(!a)throw e._getBlankTitleError();if(a.length>=256)throw new C.e(T.k);if(t&&!h.t.hasTitleBeenCommitted&&!h.t.hasPageBeenRenamed&&X.indexOf(h.t.pageLayoutType)>-1)throw e._getBlankTitleError();return!0},e.promotePageToNewsAsync=function(){var e=this,t=new i._QosMonitor("SPPagePromoteToNews");return v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return t.promotePageToNewsAsync(n)}).then(function(){t.writeSuccess(),r._TraceLogger.logVerbose($,"Completed ".concat("SPPagePromoteToNews"))}).catch(function(e){throw r._TraceLogger.logError($,e),t.writeUnexpectedFailure("SPPagePromoteToNews",e),e})},e.ensurePageExistsAsync=function(){return h.t.doesPageExistOnServer?(r._TraceLogger.logVerbose($,"Page already Exists"),Promise.resolve()):(r._TraceLogger.logVerbose($,"Page does not Exists, calling createNewPageOnServerAsync"),this.createNewPageOnServerAsync())},e.enterOrExitFullTeamsView=function(e){void 0===e&&(e=!1);var t=new i._QosMonitor("TeamsInitializerMonitor"),n=new i._QosMonitor("TeamsFullScreenMonitor");f.e.load().then(function(a){var i=a.getTeamsSDKInitializer();if(i)if(t.writeSuccess(),e){var o={alias:"exitFullScreen"};try{r._EngagementLogger.logEvent("PagesInTeams.ExitFullScreen.Click"),i.getTeamsSDK().pages.fullTrust.exitFullscreen(),n.writeSuccess(o)}catch(e){n.writeUnexpectedFailure("Error: failed to exit full screen ".concat(e),e,o)}}else{o={alias:"enterFullScreen"};try{r._EngagementLogger.logEvent("PagesInTeams.EnterFullScreen.Click"),i.getTeamsSDK().pages.fullTrust.enterFullscreen(),n.writeSuccess(o)}catch(e){n.writeUnexpectedFailure("Error: failed to enter full screen ".concat(e),e,o)}}else{var s="Error: Failed to load TeamsInitializer";t.writeUnexpectedFailure(s),n.writeUnexpectedFailure(s)}}).catch(function(e){var a="Error: Failed to load TeamsLibLoader: ".concat(e);t.writeUnexpectedFailure(a),n.writeUnexpectedFailure(a)})},e.createNewPageOnServerAsync=function(t,n,a){var r,o=this,s=!0;return null===(r=v.e.instance.autoSaver)||void 0===r||r.clearAutoSaveTimer(),v.e.instance.getPageDataProviderAsync().then(function(r){var s,c,d,l,u,f=(null===(s=h.t.fields)||void 0===s?void 0:s.PromotedState)||0,p=h.t.fields&&h.t.fields.PageLayoutType,m=Object(y.e)(638)?null===(c=h.t.fields)||void 0===c?void 0:c.ContentTypeId:void 0;if(o._isPageCopyAction)return o._copyPage(r,null===(d=h.t.fields)||void 0===d?void 0:d.PageFlags);if(o._isPageBeingTemplated)return r.savePageAsTemplate(v.e.instance.templateSourceItemId);if(D.e.isNewTopicPage()){if(!Object(F.c)()&&!h.t.hasTitleBeenCommitted)return;return Object(k.e)().then(function(){var t=new i._QosMonitor("CSIKM.TopicPage.Save");return r.createTopicPageAsync().catch(function(n){throw e._isErrorExpected(n)?t.writeExpectedFailure("CreateNewTopicPageFailure",n,{stack:n.stack}):t.writeUnexpectedFailure("CreateNewTopicPageFailure",n,{stack:n.stack}),n})})}return t||a||n?r.createPageAsync(f,p,m,null===(l=h.t.fields)||void 0===l?void 0:l.PageFlags,n,a,t):r.createBlankPageAsync(f,p,m,null===(u=h.t.fields)||void 0===u?void 0:u.PageFlags)}).then(function(e){return I.t.overWritePageLayoutType(e.PageLayoutType),v.e.instance.resetCopiedItemId(),o._isPageBeingTemplated&&v.e.instance.resetTemplateSourceItemId(),o._dispatchActionWithLogFeature("PAGE_CREATE_FROM_SERVER",e,"SPPageFieldStoreCreateBlankPage"),e.PageLayoutType===E.e.Dashboard&&(o._dispatchAction("FIELDS_UPDATE",{Title:"Dashboard"},"SPPageFieldStoreSetFields"),o._dispatchAction("FIELDS_COMMIT_TITLE",void 0,"SPPageFieldStoreCommitTitle")),e.AbsoluteUrl}).catch(function(e){throw e instanceof x.e&&403===e.status&&(b.e.showError(T.O,T.C,e),s=!1),e}).then(this._updatePageContextForNewPage).finally(function(){var e;s&&(null===(e=v.e.instance.autoSaver)||void 0===e||e.resetAutoSaveAttempts())})},e.deletePageAsync=function(){return this._executeActionAsync(this._deletePageAsync.bind(this),"SPPageDelete")},e.getFieldsToSave=function(e){var t=this,n=v.e.instance.serviceScope.consume(c.HiddenHighlightsInfoService.serviceKey),a=e||h.t.unsavedFieldKeys,i=[w.e.CanvasContent,w.e.PreviewImageUrl,w.e.AuthorByline,w.e.TopicHeader,w.e.Title];i.push(w.e.Title),i.forEach(function(e){h.t.fields[e]&&a.add(e)}),Object(L.bn)()||a.add(w.e.Categories),Object(Q.c)()&&(a.add(w.e.HiddenHighlights),a.add(w.e.HideListEditor)),o._SPFlight.isEnabled(60127)&&Object(c.isSiteVivaAmplify)(v.e.instance.pageContext.legacyPageContext)&&a.add(w.e.EmailTranspileContent),(o._SPFlight.isEnabled(60127)||o._SPFlight.isEnabled(60812))&&Object(c.isSiteVivaAmplify)(v.e.instance.pageContext.legacyPageContext)&&a.add(w.e.TeamsTranspileContent);var r={};return a.forEach(function(e){switch(e){case w.e.CanvasContent:r[e]=JSON.stringify(t._updateCanvasContentBeforeSave(h.t.fields.CanvasContent1));break;case w.e.LayoutWebPartsMapName:r[w.e.LayoutContent]=t._serializeLayoutWebparts(h.t.fields);break;case w.e.Title:(h.t.hasPageBeenRenamed||h.t.hasTitleBeenCommitted)&&(r[e]=h.t.fields[e],o._SPKillSwitch.isActivated("671e1aed-fe91-4a69-a214-a395e2bd450d")||Object(M.t)(h.t.fields.Title,h.t.fields.PageLayoutType));break;case w.e.EntityType:case w.e.EntityRelations:case w.e.EntityId:break;case w.e.Categories:r[e]=t._convertTaxonomytoCategoryField(h.t.fields.Categories);break;case w.e.EmailTranspileContent:var a=t._generateEndpointTranspileBeforeSave(h.t.fields,p.DistributionType.Email);a&&(r[e]=a);break;case w.e.TeamsTranspileContent:var i=t._generateEndpointTranspileBeforeSave(h.t.fields,p.DistributionType.Teams);i&&(r[e]=i);break;case w.e.HiddenHighlights:Object(Q.c)()&&(r[e]=n.getHiddenHighlightsAsString());break;case w.e.HideListEditor:Object(Q.c)()&&(r[e]=n.getHideListEditorAsString());break;default:r[e]=h.t.fields[e]}}),r},e._pageTitleRenamedSuccess=function(){this._dispatchAction("PAGE_TITLE_RENAME_STATUS",!0,"SPPageFieldStorePageTitleRenamedSuccess")},e._executeActionAsync=function(t,n,a){void 0===a&&(a=!1);var o=new i._QosMonitor(n);return this._fieldActionQueue||(this._fieldActionQueue=_.e.instance),r._TraceLogger.logVerbose($,"_executeActionAsync Begin: "+n),this._fieldActionQueue.executeActionAsync(t,n).then(function(){o.writeSuccess()}).catch(function(t){var i=e._isErrorExpected(t);if(r._TraceLogger.logVerbose($,"_executeActionAsync ".concat(i?"expected":""," Failure: ").concat(n)),r._TraceLogger.logVerbose($,"actionInProgress=false"),r._TraceLogger.logError($,t),i?o.writeExpectedFailure("SPPageFields_EnsureNoInProgressActionMaxRetriesExpected",t):o.writeUnexpectedFailure("SPPageFields_EnsureNoInProgressActionMaxRetries",t),a){var s={errorCode:"".concat(n," Failure"),errorMessage:JSON.stringify(t),errorScenario:"SPPageFields_EnsureNoInProgressActionMaxRetries",resultType:i?l._ResultTypeEnum.ExpectedFailure:l._ResultTypeEnum.Failure,veto:"Page Life Cycle Failure"};Object(l._logFailuresForEditCustomerPromise)(s,v.e.instance.serviceScope)}throw t})},e._saveDraftToServerAsync=function(){var e=this;return D.e.invalidatePageCacheEntry(),this.ensurePageExistsAsync().then(function(){if(v.e.instance.savePage(!1),e.ensureValidPageTitle(!1)){var t=e._isFirstTitleSave,n=e._isFirstSave;return v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return t.savePageToServerAsync(n,e.getFieldsToSave(),!0,"SaveDraftAPI")}).then(function(a){var i=h.t.fields;if(i.Modified=(new Date).toISOString(),i.IsPageCheckedOutToCurrentUser=!a,a&&(i.CheckoutUserId=void 0),e._dispatchActionWithLogFeature("FIELDS_SET_PUBLISHINGSTATUSFIELDS",i,"SPPageFieldStoreSave"),e._dispatchAction("FIELDS_CLEAR_UNSAVED_FIELDS",i,"SPPageFieldStoreClearUnsavedFieldKeys"),!J()&&Object(Y.d)())return e._handlePublicationUrlUpdatesAsync(t);e._handlePageUrlUpdates(t,n)}).catch(function(t){throw e._isFirstTitleSave&&e._handlePageRenameFailure(t),t})}})},e._saveFieldsToServerAsync=function(e){var t=this;return void 0===e&&(e=!1),this.ensurePageExistsAsync().then(function(){if(v.e.instance.savePage(e),e||Object(k.t)()||t.ensureValidPageTitle(e)){var n=t._isFirstTitleSave,a=t._isFirstSave;return v.e.instance.getPageDataProviderAsync().then(function(n){var a=t._getListItemID(),i=e?"AutoSavePageToServer":"SavePageToServerAPI";return n.savePageToServerAsync(a,t.getFieldsToSave(),!1,i)}).then(function(){if(t._dispatchAction("FIELDS_CLEAR_UNSAVED_FIELDS",h.t.fields,"SPPageFieldStoreClearUnsavedFieldKeys"),!J()&&Object(Y.d)())return t._handlePublicationUrlUpdatesAsync(n);t._handlePageUrlUpdates(n,a)}).catch(function(e){throw t._isFirstTitleSave&&t._handlePageRenameFailure(e),e})}}).catch(function(e){throw e})},e._publishPageAsync=function(){var e=this;return h.t.isCoAuth&&h.t.mode===o.DisplayMode.Edit&&this._saveOrPublishPageCoAuthFromServerAsync(!0,{shouldSaveAsNewVersion:!1,lockAction:{type:0},isAutoSave:!1}),v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return t.publishPageAsync(n)}).then(this._postPublishUpdate).catch(function(e){throw e})},e._handlePublicationUrlUpdatesAsync=function(e){return e?this._updatePageUrlAfterFirstTitleSave():Promise.resolve()},e._handlePageUrlUpdates=function(e,t){e?this._updatePageUrlAfterFirstTitleSave():t&&(this._getFilenameAndUpdateAddressBar(),this._isFirstSave=!1)},e._isErrorExpected=function(e){return e instanceof x.e&&(403===e.status||404===e.status||406===e.status||409===e.status||429===e.status||400===e.status&&(e.message===O.n.exceedStreamLimitationErrorMessage||e.message===O.n.requestMessageTooBigErrorMessage)||!Object(L.Et)()&&e.code===N.e.siteQuotaExceededException||e.code===N.e.authorByLineNotFoundError)||e instanceof C.e||e instanceof c.ExpectedFailure},e._checkOutPageFromServerAsync=function(t,n){var a=this;if(!h.t.doesPageExistOnServer)throw new Error("Tried to checkout a Page that does not exist on the server");return v.e.instance.getPageDataProviderAsync().then(function(e){var t=a._getListItemID();return e.checkOutAndReloadPageAsync(t)}).then(function(a){e._reconcilePageFieldData(a,"SPPageFieldStoreCheckout",t,n)}).catch(function(e){throw e})},e._updatePageContextForNewPage=function(e){return Object(y.e)(60441)&&e?v.e.instance.serviceScope.consume(P.e.serviceKey).updatePageContextForPage(e):Promise.resolve()},e._errorFilter=function(e,t,n){e instanceof x.e?403===e.status?t.writeExpectedFailure("FailedResponseForbidden",e):404===e.status?t.writeExpectedFailure("FailedResponseNotFound",e):406===e.status?t.writeExpectedFailure("FailedResponseNotAcceptable",e):409===e.status?t.writeExpectedFailure("FailedResponsePageConflict",e):Object(L.Et)()||e.code!==N.e.siteQuotaExceededException?400!==e.status||e.message!==O.n.exceedStreamLimitationErrorMessage&&e.message!==O.n.requestMessageTooBigErrorMessage?t.writeUnexpectedFailure(n||"FailedResponseStatus",e):t.writeUnexpectedFailure("FailedResponseExceedStreamLimitation",e):t.writeExpectedFailure("FailedDueToSiteQuota",e):t.writeUnexpectedFailure(n||"ErrorTag",e)},e._pageTitleRenamedFailure=function(){this._dispatchAction("PAGE_TITLE_RENAME_STATUS",!1,"SPPageFieldStorePageTitleRenamedFailure")},Object.defineProperty(e,"_isFirstTitleSave",{get:function(){var e,t=h.t.fields;return h.t.hasPageBeenRenamed?(e=!1,this._isFirstSave=!1):t[w.e.Title]&&h.t.hasTitleBeenCommitted?(e=!0,this._isFirstSave=!1):this._isFirstSave=!0,e},enumerable:!1,configurable:!0}),e._publishNewMajorVersionToServerAsync=function(){var e=this;return D.e.invalidatePageCacheEntry(),h.t.mode===o.DisplayMode.Edit?this._saveFieldsToServerAsync().then(function(){return e._publishPageAsync()}):L.e.verifyTitleOnPublish.isActivated()||this.ensureValidPageTitle()?this._publishPageAsync():Promise.resolve()},e._scheduleNewMajorVersionToServerAsync=function(){var e=this;return D.e.invalidatePageCacheEntry(),h.t.mode===o.DisplayMode.Edit?this._saveFieldsToServerAsync().then(function(){return e._schedulePublishPageAsync()}):this._schedulePublishPageAsync()},e._discardPageOnServerAsync=function(){var e=this;return v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return t.discardPageAsync(n)}).then(function(t){var n=new r._LogEntry(Z,"SPPageFieldStoreDiscard",r._LogType.Event);t.displayMode=o.DisplayMode.Read,t.IsPageUnpublished=!1,t.ModerationStatus=h.t.fields.ModerationStatus,t.ScheduledVersion=h.t.fields.ScheduledVersion,t.OwsHiddenVersion=h.t.fields.OwsHiddenVersion,t.PublishStartDate=h.t.fields.PublishStartDate,t.TranslatedLanguages=h.t.fields.TranslatedLanguages,t.TranslationLanguage=h.t.fields.TranslationLanguage,t.TranslationSourceItemId=h.t.fields.TranslationSourceItemId,t.IsTranslation=h.t.fields.IsTranslation,e._dispatchActionWithLogEntry("FIELDS_SET",t,n),h.t.isFocusModeTurnedOnByUser||e._dispatchActionWithLogEntry("FIELDS_SET_FOCUS_MODE_STATUS",h.t.mode===o.DisplayMode.Edit,n),"0001-01-01T00:00:00"!==t.LastVersionInfo.LastVersionCreated||t.LastVersionInfo.LastVersionCreatedBy||e._dispatchActionWithLogEntry("PAGELAYOUT_CHANGE",t.PageLayoutType,n)}).catch(function(e){throw e})},e._getPreviousPageVersionInfoAsync=function(){var e=this;return v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return!Object(F.r)()&&Object(H.t)()?t.getLastPageVersionInfoAsync(n):t.getPreviousPageVersionInfoAsync(n)}).then(function(t){e._dispatchActionWithLogFeature("FIELDS_SET_VERSIONINFO",t,"SPPageFieldStoreVersionInfo")}).catch(function(e){throw e})},e._deletePageAsync=function(){return v.e.instance.getPageDataProviderAsync().then(function(e){return e.deletePageAsync()}).catch(function(e){throw e})},e._setListItemModerationStatusAsync=function(e,t){var n=this,a=this._getListItemID();return v.e.instance.getPageDataProviderAsync().then(function(i){return"Approve"===e||"Reject"===e?i.getFileEtagAsync().then(function(r){return n._setListItemModerationStatusInternal(a,t,e,i,r)}):n._setListItemModerationStatusInternal(a,t,e,i)})},e._setFileCheckInComments=function(){var e=this;return v.e.instance.getPageDataProviderAsync().then(function(e){return e.getFileCheckinCommentsAsync()}).then(function(t){e._dispatchActionWithLogFeature("FIELDS_SET_CHECKINCOMMENTS",t,"SPPageFieldStoreSetCheckinComments")})},e._setListItemModerationStatusInternal=function(e,t,n,a,i){var r=this;return a.setListItemModerationStatus(e,t,n.toString(),i).then(function(){var e=r._getModerationStatusFromAPI(n);r._dispatchActionWithLogFeature("FIELDS_SET_MODERATIONSTATUS",e,"SPPageFieldStoreSetModerationStatus")})},e._getModerationStatusFromAPI=function(e){switch(e){case"Approve":return c.SPModerationStatusType.Approved;case"Reject":return c.SPModerationStatusType.Denied;case"Submit":return c.SPModerationStatusType.Pending}},e._reconcilePageFieldData=function(e,t,n,a){var i;void 0===n&&(n=!1),void 0===a&&(a=!1);var s,d=h.t.fields.Modified,l=new Date(d).getTime(),u=new Date(e.Modified).getTime();if(!isNaN(l)||!isNaN(u)||l<u){if(e.displayMode=!Object(L.c)()&&n?o.DisplayMode.Read:o.DisplayMode.Edit,e.EditorId=h.t.fields.EditorId,e.ModerationStatus=h.t.fields.ModerationStatus,e.ScheduledVersion=h.t.fields.ScheduledVersion,e.PublishStartDate=h.t.fields.PublishStartDate,(h.t.mode===o.DisplayMode.Edit||"initializing"===h.t.isCollaborating)&&(e.TranslatedLanguages=h.t.fields.TranslatedLanguages,e.TranslationLanguage=h.t.fields.TranslationLanguage,e.TranslationSourceItemId=h.t.fields.TranslationSourceItemId,e.IsTranslation=h.t.fields.IsTranslation,Object(H.n)())){var f=e.EntityRelations?null===(i=JSON.parse(e.EntityRelations))||void 0===i?void 0:i.badges:void 0,p=v.e.instance.serviceScope.consume(c.EntityRelationsService.serviceKey);f&&(q.e.setTopicBadges({topicBadges:f}),p.relationsContainer.badges=f);var m=e.VerifiedTopicAllowedEditors?JSON.parse(e.VerifiedTopicAllowedEditors):void 0,_=v.e.instance.serviceScope.consume(c.VerifiedTopicAllowedEditorsService.serviceKey);m&&(q.e.setTopicBadgesAllowedEditors({topicBadgesAllowedEditors:m.filter(function(e){return!e.isRemoved})}),_.editorsContainer=m.filter(function(e){return!e.isRemoved}))}e.OwsHiddenVersion=h.t.fields.OwsHiddenVersion,!Object(L.l)()&&h.t.fields&&a&&(e.CanvasContent1=h.t.fields.CanvasContent1),s="FIELDS_SET"}else s="FIELDS_SET_PUBLISHINGSTATUSFIELDS";v.e.instance.rteContentState="ready",r._TraceLogger.logVerbose($,"set rteContentState: ".concat(v.e.instance.rteContentState)),this._dispatchActionWithLogFeature(s,e,t)},e._updatePageUrlAfterFirstTitleSave=function(){return g.e.pageSaved(),this._pageTitleRenamedSuccess(),this._getFilenameAndUpdateAddressBar()},e._getFilenameAndUpdateAddressBar=function(){var e=this;return this.getPageUrlFromServerAsync().then(function(){return e._updatePageUrl(),Promise.resolve()})},e._handlePageRenameFailure=function(e){this._updatePageUrl(),this._pageTitleRenamedFailure(),b.e.showError(U.o,U.a,e),r._TraceLogger.logError($,e,"FailedToSavePageWithNewTitle")},e._updatePageUrl=function(){var e=D.e.url(!0),t=this._removeFragment(e),n=t.toLowerCase().indexOf("/_layouts/")>-1?"".concat(D.e.baseUrl(),"/SitePages/").concat(h.t.fields.FileName).concat(location.search):"".concat(t.substring(0,t.lastIndexOf("/")+1)).concat(h.t.fields.FileName).concat(location.search);Object(R.e)()&&(n=this._handleTopicPageUrlUpdate(n)),D.e.pushUrl(n,{oldPathname:location.pathname},!0)},e._handleTopicPageUrlUpdate=function(e){return D.e.isNewTopicPage()&&(Object(u.isTopicsMultilingualV3FlightEnabled)()&&(e="".concat(D.e.absolutizeUrl(v.e.instance.pageContext.legacyPageContext.serverRequestPath)).concat(location.search)),e=D.e.deleteUrlParam("isNewTopicPage","true",e)),Object(M.t)(h.t.fields.Title,h.t.fields.PageLayoutType),e},e._removeFragment=function(e){return void 0===e&&(e=D.e.url()),e.split("#",1)[0]},e._checkInFile=function(e,t,n){var a=this;return v.e.instance.getPageDataProviderAsync().then(function(i){return i.checkInFileAsync(e,t).then(function(){var t=new r._LogEntry(Z,"SPPageCheckInFile",r._LogType.Event),i=h.t.fields;n===c.SPModerationStatusType.Pending?i.IsPageUnpublished=!1:1!==e&&(i.IsPageUnpublished=!0),i.IsPageCheckedOutToCurrentUser=!1,i.Modified=(new Date).toISOString(),i.Version=i.Version&&parseFloat(i.Version)>1?i.Version:"1.0",a._dispatchActionWithLogEntry("FIELDS_SET_PUBLISHINGSTATUSFIELDS",i,t)})})},e._getNewPageVersionAfterPublish=function(e){var t="1.0",n=parseFloat(e);return e&&!isNaN(n)&&(t=Math.ceil(n).toString()+".0"),t},e._schedulePublishPageAsync=function(){var e=this;return v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return t.schedulePageAsync(n)}).then(function(t){var n=h.t.fields;n.CheckoutUserId=void 0,n.IsPageCheckedOutToCurrentUser=!1,n.Modified=(new Date).toISOString(),n.ScheduledVersion=t,n.IsPageUnpublished=!1,v.e.actions.coreActions.setSaveStatus(c.PageSaveStatus.ScheduleTriggered),e._dispatchActionWithLogFeature("FIELDS_SET_PUBLISHINGSTATUSFIELDS",n,"SPPageFieldStorePublish"),o._SPEventManager.instance.raiseEvent(O.n.sitePagePublishedEvent,{})}).catch(function(e){throw e})},e._getListItemID=function(){return h.t.fields.Id},e._convertTaxonomytoCategoryField=function(e){var t;if(e&&0!==e.length&&""!==(t=e.map(function(e){return"".concat(e.term.label,"|").concat(e.term.termId,";")}).join("")))return t},e._serializeLayoutWebparts=function(e){if(e&&e[w.e.LayoutWebPartsMapName])return m.e.serializeLayoutWebPartData(e[w.e.LayoutWebPartsMapName])},Object.defineProperty(e,"_pageSettingsMetadata",{get:function(){var e=Object(L.Rt)()?{contentVersion:c.RteContentVersion.CK4}:h.t.rtePageSettings;Object(F.a)()||r._TraceLogger.logVerbose($,"RtePageSettings.contentVersion: ".concat(e.contentVersion," in _pageSettingsMetadata")),Object(F.e)()&&e.contentVersion===c.RteContentVersion.CK5&&(e.contentVersion=c.RteContentVersion.CK4,Object(F.a)()||r._TraceLogger.logVerbose($,"CK4 rollback initiated, RtePageSettings.contentVersion: ".concat(e.contentVersion)));var t={isDefaultDescription:h.t.isDefaultDescription,isDefaultThumbnail:h.t.isDefaultThumbnail,isSpellCheckEnabled:h.t.isSpellCheckEnabled,globalRichTextStylingVersion:h.t.globalRichTextStylingVersion,rtePageSettings:e,isEmailReady:h.t.isEmailReady},n={controlType:0,pageSettingsSlice:t};return t.isDefaultDescription||(n.htmlAttributes=["modifiedDescription"]),n},enumerable:!1,configurable:!0}),e._updateCanvasContentBeforeSave=function(e){return e?this._updateServerProcessedData(this._updateCanvasMetadata(Object(s.cloneDeep)(e))):[]},e._generateEndpointTranspileBeforeSave=function(e,t){var n,a=Object(p.getTranspiler)(t);return e.CanvasContent1&&(null==a?void 0:a.canTranspile(e.CanvasContent1))?a.transpile({authority:location.origin,canvasContent1:e.CanvasContent1,titleWebPartData:null===(n=e.LayoutWebPartsDataMap)||void 0===n?void 0:n.get("cbe7b0a9-3504-44dd-a3a3-0e5cacd07788"),rteContentVersion:h.t.rtePageSettings.contentVersion,rteStylingVersion:h.t.globalRichTextStylingVersion,inlineRteStyles:!0,skipByline:!0,scenario:"VivaAmplify"}):""},e._updateCanvasMetadata=function(e){var t=this._pageSettingsMetadata;return(e=e.filter(function(e){return e.controlType!==d.CanvasControlType.Metadata})).push(t),e},e._updateServerProcessedData=function(e){if(e){var t=ee.createElement("div");return e.forEach(function(e){if(d.CanvasControlType.WebPartZone===e.controlType&&e.webPartData.serverProcessedContent){var n=e.webPartData.serverProcessedContent.searchablePlainTexts;n&&Object.keys(n).forEach(function(e){t.textContent=n[e],n[e]=t.innerHTML})}}),e}return[]},e._dispatchAction=function(e,t,n){return S.e._dispatchAction(e,t,Z,n,void 0,$)},e._dispatchActionWithLogFeature=function(e,t,n,a){S.e._dispatchAction(e,t,Z,n,void 0,$,a)},e._dispatchActionWithLogEntry=function(e,t,n,a){S.e._dispatchActionWithLogEntry(e,t,n,$,a)},Object.defineProperty(e,"_isPageCopyAction",{get:function(){var e=v.e.instance.copySourceItemId;return e&&e>0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"_isPageBeingTemplated",{get:function(){var e=v.e.instance.templateSourceItemId;return e&&e>0},enumerable:!1,configurable:!0}),e._copyPage=function(e,t){var n=v.e.instance.copySourceItemId;return n&&n>0?Object(L._n)()?e.copyPage(n,t).then(function(e){return A.e.setIsDefaultDescription(!0),A.e.setIsDefaultThumbnail(!0),e}):e.copyPage(n,t):Promise.resolve(void 0)},e._postPublishUpdate=function(){var t,n=h.t.fields;n.CheckoutUserId=void 0,n.IsPageUnpublished=!1,n.IsPageCheckedOutToCurrentUser=!1,n.Modified=(new Date).toISOString(),n.Version=Object(F.t)()?n.Version&&parseFloat(n.Version)>1?n.Version:"1.0":e._getNewPageVersionAfterPublish(n.Version),n.PageFlags=null===(t=n.PageFlags)||void 0===t?void 0:t.filter(function(e){return e&&e!==O.n.privateAuthoringFlagKey}),e._dispatchActionWithLogFeature("FIELDS_SET_PUBLISHINGSTATUSFIELDS",n,"SPPageFieldStorePublish"),o._SPEventManager.instance.raiseEvent(O.n.sitePagePublishedEvent,{}),Object(M.t)(n.Title,n.PageLayoutType)},e._getBlankTitleError=function(){return o._SPKillSwitch.isActivated("dcf9f829-f405-4021-8a37-f4cd864dcc2f")?new C.e(T.L):new C.e(T.A,{title:T.L})},t=e,e.teamsStageUrl="https://teams.microsoft.com/l/stage/",e._isFirstSave=!1,e._startCoAuthAsync=function(n){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var i,o,s,d,l,u,f,p,m,_,b,g;return Object(a.__generator)(t,function(t){switch(t.label){case 0:if(!h.t.doesPageExistOnServer)throw new Error("Tried to edit a Page that does not exist on the server");return D.e.removeCustomControl(j.t),v.e.actions.fieldActions.turnOnIsCollaborating("initializing"),s=!1,d=Object(j.o)(),n&&h.t.fields&&d?(o=d,i=h.t.fields,[3,3]):[3,1];case 1:return[4,v.e.instance.getPageDataProviderAsync().then(function(t){var n=e._getListItemID();return t.startCoAuthAsync(n)})];case 2:l=t.sent(),i=l.pageFieldData,o=l.sharedLockId,s=l.isNewSession,t.label=3;case 3:return i.SharedLockId=o,r._Diagnostics.updateSettings({extraDiagnosticInfo:{authoringSessionId:o}}),[4,Object(V.e)()];case 4:return[4,t.sent().startCoAuthSession(v.e.instance.serviceScope,{canvasContent:i.CanvasContent1||h.t.homePageDefaultContent||[],layoutWebPartContentMap:i.LayoutWebPartsDataMap,isDefaultDescription:h.t.isDefaultDescription,pageDescription:i.Description,isDefaultThumbnail:h.t.isDefaultThumbnail,pageThumbnail:i.BannerImageUrl,isSpellCheckEnabled:h.t.isSpellCheckEnabled,isRecommendedItemsEnabled:!!(null===(_=null===(m=null===(p=null===(f=h.t.fields)||void 0===f?void 0:f.LayoutWebPartsDataMap)||void 0===p?void 0:p.get("1ee8960a-2fa0-4145-b9bb-e818f6cf18e7"))||void 0===m?void 0:m.properties)||void 0===_?void 0:_.isEnabled),isCommentSectionEnabled:!((null===(b=h.t.pageReduxStore.getState().comments)||void 0===b?void 0:b.disabledAtSiteOrTenant)||(null===(g=h.t.pageReduxStore.getState().comments)||void 0===g?void 0:g.disabled)),sessionId:o},{pageLifeCycleImplementations:{saveImpl:v.e.actions.fieldActions.savePageCoAuthFromServerAsync,saveAndPublishImpl:v.e.actions.fieldActions.saveAndPublishPageCoAuthFromServerAsync},onSessionConnectivityChange:function(t){window.clearTimeout(e._showSlowConnectionTimeout),t?D.e.removeCustomControl(j.n):e._showSlowConnectionTimeout=window.setTimeout(function(){u.fluidOrchestrator.interactiveClientCount>1&&h.t.isCoAuth&&D.e.pushCustomControl(j.n,function(){return c.ScreenReaderAlert.read(W.e,c.ReadingMode.ReadImmediately),z.createElement(G.MessageBar,{messageBarType:G.MessageBarType.info,isMultiline:!1},W.e)},void 0)},3e3)},onSessionEnd:function(t){var n=t.type;window.clearTimeout(e._showSlowConnectionTimeout),D.e.removeCustomControl(j.n),"IDLE_DISCONNECT"===n&&(v.e.actions.coreActions.cancelEdit(),D.e.pushCustomControl(j.t,function(){return e=function(){return D.e.removeCustomControl(j.t)},c.ScreenReaderAlert.read(K.e,c.ReadingMode.ReadImmediately),z.createElement(G.MessageBar,{messageBarType:G.MessageBarType.info,onDismiss:e,isMultiline:!1},K.e);var e},void 0)),"UNKNOWN"===n?(v.e.actions.coreActions.cancelEdit(),Object(c.DeferredDialogUtility)().then(function(e){e.showRefreshDialog({title:T.I,message:T.D})})):"FILE_NOT_FOUND_OR_ACCESS_DENIED"===n?(v.e.actions.coreActions.cancelEdit(),v.e.actions.coreActions.showError(T.w,T.E)):"AUTO_SAVE_FAILED_CONSISTENTLY"===n&&(v.e.actions.coreActions.cancelEdit(),e._handleSaveOrPublishError(t.error))},shouldTryCreateNewContainer:s})];case 5:return u=t.sent(),e._reconcilePageFieldData(i,"CoAuth.StartCoAuthSessionClient"),v.e.actions.fieldActions.turnOnIsCollaborating(!0),[2]}})})},e._saveOrPublishPageCoAuthFromServerAsync=function(e,n){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var i,r,s,c,d,l,u,f,p,m,_,b;return Object(a.__generator)(t,function(t){switch(t.label){case 0:if(i=n.shouldSaveAsNewVersion,r=n.lockAction,s=n.isAutoSave,h.t.mode!==o.DisplayMode.Edit)return[2,Promise.resolve()];if(!h.t.doesPageExistOnServer)throw new Error("Tried to save a Page that does not exist on the server");if(!(c=null===(_=h.t.fields)||void 0===_?void 0:_.SharedLockId))throw new Error("SharedLock ID does not exist.");t.label=1;case 1:return t.trys.push([1,4,,5]),D.e.invalidatePageCacheEntry(),v.e.instance.savePage(s),s||this.ensureValidPageTitle(s),d=this._isFirstTitleSave,l=this._isFirstSave,[4,v.e.instance.getPageDataProviderAsync()];case 2:return u=t.sent(),f=this._getListItemID(),[4,(e?u.publishPageCoAuthAsync:u.savePageCoAuthAsync)(f,this.getFieldsToSave(),c,r,i)];case 3:return t.sent(),(p=h.t.fields).Modified=(new Date).toISOString(),this._dispatchActionWithLogFeature("FIELDS_SET_PUBLISHINGSTATUSFIELDS",p,"SPPageFieldStoreSave"),this._dispatchAction("FIELDS_CLEAR_UNSAVED_FIELDS",p,"SPPageFieldStoreClearUnsavedFieldKeys"),this._handlePageUrlUpdates(d,l),e&&this._postPublishUpdate(),(null===(b=h.t.pageReduxStore.getState().comments)||void 0===b?void 0:b.isCommentSectionDisabledToggleDirty)&&B.e.setDisabledRemote(!Object(j.i)("IsCommentSectionEnabled")),[3,5];case 4:return m=t.sent(),h.t.mode!==o.DisplayMode.Edit?[2,Promise.resolve()]:(this._handleSaveOrPublishError(m),[3,5]);case 5:return[2]}})})},e._handleSaveOrPublishError=function(e){throw t._isFirstTitleSave&&t._handlePageRenameFailure(e),e},e}();t.default=te},"4qRg":function(e,t,n){"use strict";n.d(t,"t",function(){return h}),n.d(t,"e",function(){return b});var a=n("17wl"),i=n("UWqr"),r=n("hiL/"),o=n("XCkH"),s=n("xs0R"),c=n("0IsF"),d=n("7plR"),l=n("67N2"),u=n("LjAQ"),f=n("HVbJ"),p=n("4elw"),m={"title|definition|people":u.v,"title|definition":u.v,"title|people":u.v,"definition|people":u.v,title:u.y,definition:u.g,people:u.S},_={"title|definition|people":u.p,"title|definition":u.f,"title|people":u.m,"definition|people":u.l,title:u.u,definition:u.d,people:u._};function h(e){var t,n,h,b,g,v,y,S,D,I,x,C;if(s.t.fields&&s.t.fields.PageLayoutType!==c.e.Topic)return!1;var O=[],w=(s.t.fields||{}).LayoutWebPartsDataMap,E={};null==w||w.forEach(function(e){E[e.id]=e});var A=d.e.instance.serviceScope.consume(r.TopicDataService.serviceKey),L=Object(a.__assign)({Definitions:[],RelatedPeople:[]},A.currentTopicEntity),k=E["cbe7b0a9-3504-44dd-a3a3-0e5cacd07788"];if((Object(l.i)()?(null===(h=null==k?void 0:k.properties)||void 0===h?void 0:h.title)||L.Name:!A.missingRequiredFields.title)||O.push("title"),!e)if(Object(l.i)()){var M=null===(v=null===(g=null===(b=E["e9ee7242-273c-473f-bfa5-149b32873501"])||void 0===b?void 0:b.serverProcessedContent)||void 0===g?void 0:g.searchablePlainTexts)||void 0===v?void 0:v.content,P=Object(r.countWordFromHTMLString)(M)>0,T=null===(S=null===(y=E["e9ee7242-273c-473f-bfa5-149b32873501"])||void 0===y?void 0:y.properties)||void 0===S?void 0:S.contentCurationDetails,U=Object(f.isValidCurationDetails)(T);if(!U&&Object(r.countWordFromHTMLString)(L.Definition)&&(P=!0),!P&&!U)try{for(var F=Object(a.__values)(L.Definitions),H=F.next();!H.done;H=F.next()){var R=H.value;if(Object(r.countWordFromHTMLString)(R.Definition)){P=!0;break}}}catch(e){t={error:e}}finally{try{H&&!H.done&&(n=F.return)&&n.call(F)}finally{if(t)throw t.error}}P||O.push("definition");var N=E["29991a50-6f14-42e0-9536-aef85d91b05c"];0===(null===(I=null===(D=null==N?void 0:N.properties)||void 0===D?void 0:D.curated)||void 0===I?void 0:I.length)&&0===(null===(C=null===(x=null==N?void 0:N.properties)||void 0===x?void 0:x.suggested)||void 0===C?void 0:C.length)&&0===L.RelatedPeople.length&&O.push("people")}else A.missingRequiredFields.definition&&O.push("definition"),A.missingRequiredFields.people&&O.push("people");if(O.length>0){var B=O.join("|"),j=Object(f.getTopicPageLanguage)(d.e.instance.serviceScope);if(j&&!r.Multilingual.isSameLanguage(j,d.e.instance.pageContext.web.languageName))throw new o.e(function(e){var t=p.LanguageNames.getLocalizedName(e);return{"title|definition|people":i.Text.format(u.o,t),"title|definition":i.Text.format(u.r,t),"title|people":i.Text.format(u.s,t),"definition|people":i.Text.format(u.a,t),title:i.Text.format(u.i,t),definition:i.Text.format(u.n,t),people:u.c}}(j)[B],{type:"TopicPage",title:m[B],reason:"MissingTopicRequiredFields"});throw new o.e(_[B],{type:"TopicPage",title:m[B],reason:"MissingTopicRequiredFields"})}return!0}function b(){var e=d.e.instance.serviceScope.consume(r.TopicDataService.serviceKey).currentTopicEntity;if(!e)return Promise.resolve();var t=[e.Id].concat(e.OriginalIds||[]).filter(function(e){return e!==r.NULL_TOPIC_ENTITY.Id});if(0===t.length)return Promise.resolve();var a=new URL(window.location.href).searchParams;return Promise.resolve().then(n.t.bind(null,"NamT",7)).then(function(e){var n,i,r=e.TopicPageDataProvider,c=Object(f.isTopicsMultilingualV3FlightEnabled)()?(null===(n=s.t.fields)||void 0===n?void 0:n.TranslationLanguage)||void 0:a.get(f.TopicPageParams.Language)||void 0,l=c?p.LanguageNames.getLanguagesByPrefix(c):[];if(l.length<=1)return new r(d.e.instance.serviceScope).getTopicPageByEntityId(t,null===(i=l[0])||void 0===i?void 0:i.languageCode).then(function(e){if(e.Id)throw new o.e(u.h,{type:"TopicPage",title:u.b,reason:"DuplicatedTopicEntityId"})});throw new o.e(u.x,{type:"TopicPage",title:u.b,reason:"NotSupportedLanguageFormat"})})}},"67N2":function(e,t,n){"use strict";n.d(t,"o",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"c",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"r",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"a",function(){return u}),n.d(t,"s",function(){return f});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("64510c71-1542-4054-b968-77cae1542b85")}function r(){return a._SPKillSwitch.isActivated("68d190d9-c1b0-4d51-8263-cbaf1e007b3d")}function o(){return a._SPKillSwitch.isActivated("54a84d15-714a-4db3-b282-0be5a12aaa0a")}function s(){return a._SPKillSwitch.isActivated("a0ab6d80-64ed-43fc-aac3-547bcd967c2c")}function c(){return a._SPKillSwitch.isActivated("64720ed5-b688-4f87-b062-488aa5693a56")}function d(){return a._SPKillSwitch.isActivated("ffa9c69b-28a8-4bab-9474-1f82f48b4a32")}function l(){return a._SPKillSwitch.isActivated("867ad720-b3de-4ad9-958d-1b733b2a8bb7")}function u(){return a._SPKillSwitch.isActivated("cbbaa48c-cb24-4fa4-b952-f010b43da814")}function f(){return a._SPKillSwitch.isActivated("63293d3e-268d-469a-9947-6008e3fb6963")}},"Etq+":function(e,t,n){"use strict";var a=n("17wl"),i=function(e){function t(n,a){void 0===n&&(n=""),void 0===a&&(a="Timeout");var i=e.call(this,n)||this;return i.__proto__=t.prototype,i._errorType=a,i}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"ErrorType",{get:function(){return this._errorType},enumerable:!1,configurable:!0}),t}(Error);t.e=i},Fn15:function(e,t,n){"use strict";var a=n("hiL/"),i=n("jyrw"),r=function(){function e(){}return e.pageSaved=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.Saved,e._moduleName,"SPPageSetPageSaved",{SPPageStatus:a.PageSaveStatus.Saved.toString()})},e.pageDirty=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.NotSaved,e._moduleName,"SPPageSetPageDirty",{SPPageStatus:a.PageSaveStatus.NotSaved.toString()})},e.pageCheckedOut=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.UnPublished,e._moduleName,"SPPageSetPageUnPublished",{SPPageStatus:a.PageSaveStatus.UnPublished.toString()})},e._moduleName="[PageStatusStoreAction]",e}();t.e=r},GDsS:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o});var a=n("UWqr");function i(){return a._SPFlight.isEnabled(1592)}function r(){return a._SPFlight.isEnabled(60191)}function o(){return a._SPFlight.isEnabled(1601)}},Gccx:function(e){e.exports=JSON.parse('{"e":"Your internet connection seems slow and updates to the page may be a little delayed. Try troubleshooting your network."}')},VCl9:function(e){e.exports=JSON.parse('{"e":"Select Edit to continue where you left off."}')},k6KK:function(e,t,n){"use strict";var a=function(){function e(){}return e.isDuplicateFieldValueError=function(e,t){var n,a;return(null===(n=e.code)||void 0===n?void 0:n.indexOf("Microsoft.SharePoint.SPDuplicateValuesFoundException"))>-1&&(null===(a=e.message)||void 0===a?void 0:a.indexOf(t))>-1},e.spDuplicatedEntityIdException="-2130575169, Microsoft.SharePoint.SPDuplicateValuesFoundException",e.siteQuotaExceededException="-2147023080, Microsoft.SharePoint.SPException",e.authorByLineNotFoundError="-2146232832, Microsoft.SharePoint.SPException",e}();t.e=a},lF8N:function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n("ut3N"),i=n("EMa1"),r=function(){function e(){this._actionInProgress=!1}return e.prototype.executeActionAsync=function(e,t){var n=this;return this._actionInProgress?this._ensureNoActionInProgressAsync().then(function(){return n._executeAction(e,t)}):this._executeAction(e,t)},e.prototype._executeAction=function(e,t){var n=this;return this._actionInProgress=!0,this._currentlyRunningScenario=t,e(arguments).then(function(e){return n._actionInProgress=!1,n._currentlyRunningScenario=void 0,e}).catch(function(e){throw n._actionInProgress=!1,n._currentlyRunningScenario=void 0,e})},e.prototype._ensureNoActionInProgressAsync=function(){var e=this;return this._ensureConditionAsync(function(){return!e._actionInProgress})},e.prototype._ensureConditionAsync=function(t,n,r){var o=this;return void 0===n&&(n=i.n.defaultWaitTimeforEnsureCondition),void 0===r&&(r=i.n.defaultRetriesForEnsureCondition),new Promise(function(i,s){var c=function(d){if(a._TraceLogger.logVerbose(e._logSource,"ensureConditionAsync: numTries=="+d),t())i();else if(d>r){var l=o._currentlyRunningScenario||"unknown";s(new Error("".concat("Exceed max number of tries."," The current running task that is blocking the async queue: ").concat(l)))}else setTimeout(function(){return c(d+1)},n)};c(0)})},e._logSource=a._LogSource.create("ObsoleteAsyncQueue"),e}(),o=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(this._instance=new r)},enumerable:!1,configurable:!0}),e}(),s=n("XdGY"),c=n("Etq+"),d=function(){function e(e,t,n){this._task=e,this._taskId=t,this._scenarioName=n,this._taskArgs=arguments}return e.prototype.execute=function(){var e=this;return new Promise(function(t,n){e._rejectFunc=n,e._task(e._taskArgs).then(function(n){e.clearTimer(),t(n)}).catch(function(t){e.clearTimer(),n(t)})})},e.prototype.startTimer=function(){var e=this;this._timerId||this._sleep().then(function(){var t,n;Object(s.q)()?null===(n=e._rejectFunc)||void 0===n||n.call(e,new Error("AsyncQueue timeout failure for scenario: ".concat(e._scenarioName))):null===(t=e._rejectFunc)||void 0===t||t.call(e,new c.e("AsyncQueue timeout failure for scenario: ".concat(e._scenarioName)))})},Object.defineProperty(e.prototype,"scenarioName",{get:function(){return this._scenarioName},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"taskId",{get:function(){return this._taskId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"asyncTaskTimeout",{get:function(){return Object(s.Q)()?e._asyncTaskTimeout:e._asyncTaskTimeout2},set:function(t){Object(s.Q)()?e._asyncTaskTimeout=t:e._asyncTaskTimeout2=t},enumerable:!1,configurable:!0}),e.prototype.clearTimer=function(){this._timerId&&clearTimeout(this._timerId)},e.prototype._sleep=function(){var t=this;return new Promise(function(n){return t._timerId=setTimeout(function(){return n()},e.asyncTaskTimeout)})},e._asyncTaskTimeout=2e4,e._asyncTaskTimeout2=3e4,e}(),l=d,u=n("M+LP"),f=a._LogSource.create("AsyncQueue"),p=function(){function e(){var e=this;this._executeTask=function(){var t=e._taskQueue.length?e._taskQueue[0]:void 0;return t?(e._taskQueue.length>=2&&t.startTimer(),t.execute().then(function(t){return e._removeFirstTaskFromQueue(),t}).catch(function(t){throw e._removeFirstTaskFromQueue(),t})):Promise.resolve()},this._removeFirstTaskFromQueue=function(){e._taskQueue.length&&e._taskQueue.splice(0,1)},this._taskQueue=[],this._taskCounter=0}return e.prototype.executeActionAsync=function(e,t){if(!Object(u.e)(60662))return o.instance.executeActionAsync(e,t);var n=this._taskCounter++;return this._taskQueue.push(new l(e,n,t)),this._taskQueue.length>=2&&this._taskQueue[0].startTimer(),this._waitForTaskQueue(n).then(this._executeTask)},e.prototype._waitForTaskQueue=function(e){var t=this;return new Promise(function(n){var i=function(r){a._TraceLogger.logVerbose(f,"ensureConditionAsync: numTries=="+r),t._taskQueue.length&&e===t._taskQueue[0].taskId?n():setTimeout(function(){return i(r+1)},100)};i(0)})},e}(),m=function(){function e(){}return Object.defineProperty(e,"instance",{get:function(){return e._instance||(this._instance=new p)},enumerable:!1,configurable:!0}),e}()}}]);