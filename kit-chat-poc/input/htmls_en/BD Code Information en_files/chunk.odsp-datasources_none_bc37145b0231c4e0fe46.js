(window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0=window.webpackJsonp_1e2cdec9_1360_4295_b73c_98d6f51866d5_0_1_0||[]).push([[19],{"3Ilx":function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n("17wl"),i=n("6o44"),r=n("OpjN"),o=n("4AK9"),s=n("fTUh"),c=n("K9kD"),d=function(){function e(e,t,n,a,i){this._groupsProvider=e,this._parentGroup=t,this._loadPageFromServerDelegate=n,this._pageSize=a&&"number"==typeof a.pageSize?a.pageSize:20,this._shouldAddOwnershipInformation=!a||(a.ownershipInformation,!1)||a.ownershipInformation,this._userLoginName=i,this._foundOwnersDictionary={},this._numberOfOwnersFound=0}return e.prototype.loadPage=function(e){var t=this,n=e||0;return this._groupsProvider&&this._parentGroup.id?this._loadPageFromServerDelegate(this._parentGroup.id,n,this._pageSize).then(function(e){return t._processPage(e,n)},function(e){return t.error=e,c.Promise.reject(e)}):c.Promise.reject(void 0)},e.prototype._processPage=function(e,t){var n=this;this.totalNumberOfMembers=e.totalNumberOfMembers;var a=t+this._pageSize>=this.totalNumberOfMembers,i=a?void 0:this._computeGetNextPagePromise(t+this._pageSize);return this._shouldAddOwnershipInformation?this._ownersDictionary?(this._addOwnershipInformationToPage(e,a),c.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})):this._groupsProvider.loadOwnershipContainerFromServer(this._parentGroup.id).then(function(t){return n._addOwnershipInformationToPage(e,a,t),c.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})}):c.Promise.resolve({page:e.membersList.members,getNextPagePromise:i})},e.prototype._addOwnershipInformationToPage=function(e,t,n){var a=this;if(n&&(this.totalNumberOfOwners=n.totalNumberOfOwners,this._ownersDictionary={},n.ownersList.members.forEach(function(e){e.userId&&(a._ownersDictionary[e.userId]=e)}),this.isOwner=n.ownersList.containsUserByPrincipalName(this._userLoginName)),e.membersList.members.forEach(function(e){e.isOwnerOfCurrentGroup=a._ownersDictionary&&!!a._ownersDictionary[e.userId],e.isOwnerOfCurrentGroup&&(a._numberOfOwnersFound++,a._foundOwnersDictionary[e.userId]=!0)}),t&&this._ownersDictionary&&this._numberOfOwnersFound<this.totalNumberOfOwners)for(var i in this._ownersDictionary){var r=this._ownersDictionary[i];this._foundOwnersDictionary[r.userId]||(r.isOwnerOfCurrentGroup=!0,e.membersList.members.push(r),this.totalNumberOfMembers++)}},e.prototype._computeGetNextPagePromise=function(e){var t=this;return function(){return t.loadPage(e)}},e}(),l=n("3HEj"),u=n("mxVm"),f=n("8wzk"),p="Yammer.FeedURL",m="MicrosoftTeams.TeamHomeURL",_="Missing group id.",h="CurrentUser",b=function(){function e(e){this._missingLoginNameError="Missing user login name information.",this._partnerUser="PartnerUser",this._pageContext=e.pageContext,this._dataRequestor=new c.DataRequestor({qosName:"GroupsProvider"},{pageContext:e.pageContext}),this._dataSource=e.dataSource||new o.e(e.pageContext);var t=function(e){return e.name?Object(a.__assign)(Object(a.__assign)({},e),{name:"GroupsProvider.PersistentCache.".concat(e.name)}):e};this._persistentCache=new u.e({secret:void 0,cacheType:f.e.indexedDB,telemetry:{engagement:c.Engagement.withData(t),qos:c.Qos.withData(t)}}),this._userLoginName=e.pageContext&&e.pageContext.userLoginName,this._groups=[],this._eventGroup=new c.EventGroup(this),this.switchCurrentGroup(e.groupId||e.pageContext&&e.pageContext.groupId)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.getSPPageContext=function(){return this._pageContext},e.prototype.getMembershipPager=function(e){var t=this;return new d(this,this.group,function(e,n,a){return e?t._userLoginName?t._dataSource.getGroupMembershipPage(e,t._userLoginName,n,a):c.Promise.reject(t._missingLoginNameError):c.Promise.reject(_)},e,this._userLoginName)},e.prototype.loadGroupInfoFromCache=function(e){return e?c.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data})):c.Promise.resolve(void 0)},e.prototype.saveGroupToCache=function(e){if(e)return c.Promise.resolve(this._persistentCache.update({key:e.id},e))},e.prototype.saveMembershipToCache=function(e,t){var n=this;return this.loadGroupInfoFromCache(e).then(function(e){if(e)return e.membership={isMember:t.isMember,totalNumberOfMembers:t.totalNumberOfMembers,totalNumberOfOwners:t.totalNumberOfOwners,membersList:t.membersList,isOwner:t.isOwner,isJoinPending:t.isJoinPending,lastLoadTimeStampFromServer:t.lastLoadTimeStampFromServer},n.saveGroupToCache(e)})},e.prototype.loadGroupInfoContainerFromServer=function(e){var t=this;return e?this._dataSource.getGroupBasicProperties(e).then(function(e){return t._performBasicPropertiesPostProcessing(e),Object(l.c)(t._pageContext)&&t.doesCachedGroupPropertiesDiffer(e)&&t.syncGroupProperties(),e}):c.Promise.reject(_)},e.prototype.loadMembershipContainerFromServer=function(e,t,n,a){return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=this._userLoginName),e?a?this._dataSource.getGroupMembership(e,a,t,n):c.Promise.reject(this._missingLoginNameError):c.Promise.reject(_)},e.prototype.loadOwnershipContainerFromServer=function(e,t){return e?this._dataSource.getGroupOwnership(e,t):c.Promise.reject(_)},e.prototype.loadUserGroups=function(e){var t=this;return this.loadUserGroupsFromCache(e).then(function(n){return n&&0!==n.length?c.Promise.resolve(n):t.getCurrentUser().then(function(n){return e?t._dataSource.getUserGroupsFromAAD(n).then(function(e){return t._persistentCache.update({key:"UserGroupsFromAAD"+n.userId},e),e}):t._dataSource.getUserGroups(n).then(function(e){return t._persistentCache.update({key:"UserGroups"+n.userId},e),t._setUsersGroups(e,r.e.Server),e})})})},e.prototype.loadUserGroupsFromCache=function(e){var t=this;return this.getCurrentUser().then(function(n){return(e?c.Promise.resolve(t._persistentCache.read({key:"UserGroupsFromAAD"+n.userId}).then(function(e){return e.data})):c.Promise.resolve(t._persistentCache.read({key:"UserGroups"+n.userId}).then(function(e){return e.data}))).then(function(n){return n&&!e&&t._setUsersGroups(n,r.e.Cache),n})})},e.prototype.isUserInGroup=function(e){return this.loadUserGroups(!0).then(function(t){for(var n=0,a=t.length;n<a;n++)if(t[n].id===e)return!0;return!1})},e.prototype.getGroup=function(e,t){var n=this;if(void 0===t&&(t=!1),e)throw new Error("NotImplemented: Calling getGroup() on groupsProvider supplying a groupId is not yet implemented.");return t||e&&0!==e.length&&(!this.group||e!==this.group.id)?(e&&0!==e.length||(e=this.group.id),this.loadGroupInfoContainerFromServer(e)):new c.Promise(function(e,t){var a=n.group;n.group?a.source===r.e.None?n._eventGroup.on(a,i.t.onSourceChange,function(i){i!==r.e.Error?i===r.e.None||e(a):t(n.group.error)}):e(a):t("There is no group currently being managed by GroupsProvider.")})},e.prototype.getCurrentUser=function(){var e=this;return this._userLoginName?this.currentUser?c.Promise.resolve(this.currentUser):this._getUserFromCache(h).then(function(t){return e.currentUser=t,t||e._dataSource.getUserInfo(e._userLoginName).then(function(t){return e._saveUserToCache(t,h),e.currentUser=t,t})}):c.Promise.reject(this._missingLoginNameError)},e.prototype.addUserToGroupMembership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupMember(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.Promise.reject(_)},e.prototype.addUserToGroupOwnership=function(e,t,n,a){var i,r=this;return e?this._getUserIdForCacheClear(t,n).then(function(o){return i=o,r._dataSource.addGroupOwner(e,t,n,a)}).then(function(){r._clearUserGroupsCache(i)}):c.Promise.reject(_)},e.prototype.removeUserFromGroupMembership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupMember(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.Promise.reject(_)},e.prototype.removeUserFromGroupOwnership=function(e,t,n){var a,i=this;return e?this._getUserIdForCacheClear(t).then(function(r){return a=r,i._dataSource.removeGroupOwner(e,t,n)}).then(function(){i._clearUserGroupsCache(a)}):c.Promise.reject(_)},e.prototype.addUsersToGroup=function(e,t,n,a,i){var r,o=this;return e?this._isPartnerUser()?this._dataSource.addUsersToGroup(e,t,n,a,i):this.currentUser?(r=this.currentUser.userId,this._dataSource.addUsersToGroup(e,t,n,a,i).then(function(e){return o._clearUserGroupsCache(r),e})):this.getCurrentUser().then(function(e){r=e.userId}).then(function(){return o._dataSource.addUsersToGroup(e,t,n,a,i)}).then(function(e){return o._clearUserGroupsCache(r),e}):c.Promise.reject(_)},e.prototype.saveGroupProperties=function(e){return this._dataSource.setGroupBasicProperties(e)},e.prototype.switchCurrentGroup=function(e){var t=this.group?this.group.id:void 0;if(e&&e!==t){var n=this.getCachedGroup(e);n.load(),this.group=n}},e.prototype.getCachedGroup=function(e,t){var n=this._groups[e];return n||(n=new i.t(t,this,e,this._pageContext),this._groups[e]=n),n},e.prototype.syncGroupProperties=function(){var e=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SyncGroupProperties";return this._dataRequestor.getData({url:e,qosName:"SyncGroupProperties",method:"POST",noRedirect:!0})},e.prototype.setGroupImage=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/GroupService/SetGroupImage";return this._dataRequestor.getData({url:t,qosName:"SetGroupImage",method:"POST",noRedirect:!0,additionalPostData:e,contentType:e?e.type:"image/jpeg"})},e.prototype.doesCachedGroupPropertiesDiffer=function(e){var t,n,a=this._pageContext;return a.groupId===e.id&&(a.webTitle!==e.name||(a.siteClassification||e.classification)&&a.siteClassification!==e.classification||(a.sensitivityLabel||e.assignedLabels)&&(null===(t=a.sensitivityLabel)||void 0===t?void 0:t.toLocaleLowerCase())!==(null===(n=e.assignedLabels)||void 0===n?void 0:n.toLocaleLowerCase())||null===a.groupType||void 0===a.groupType||a.groupType===s.t.public!==e.isPublic||!a.isTeamsConnectedSite&&!!e.teamsUrl&&e.teamsUrl.length>0)},e.prototype.teamify=function(){return this._dataSource.teamify()},e.prototype.teamifyV2=function(e,t){return this._dataSource.teamifyV2(e,t)},e.prototype.hideTeamifyBanner=function(){var e=this._makeHideTeamifyKey();return c.Promise.resolve(this._persistentCache.update({key:e},{}))},e.prototype.dismissTeamifyBanner=function(){return this._dataSource.dismissTeamifyBanner()},e.prototype.getTeamifyBannerHidden=function(e){var t=this;return c.Promise.resolve(this._persistentCache.read({key:this._makeHideTeamifyKey()}).then(function(n){return!!n.data||t._dataSource.getTeamifyBannerHidden(e).catch(function(){return!1})}))},e.prototype.deleteGroup=function(e){return this._dataSource.deleteGroup(e)},e.prototype.deleteSite=function(e){return this._dataSource.deleteSite(e)},e.prototype._makeHideTeamifyKey=function(e){var t=e||this._pageContext.siteId;return"".concat("HideTeamify",":").concat(t)},e.prototype._setUsersGroups=function(t,n){var a=this;this.userGroups=t.map(function(e){var t=a.getCachedGroup(e.id,e);return n!==r.e.Server&&t.source===r.e.Server||t.extend(e),t.pictureUrl||t.load(),t}),this._eventGroup.raise(e.onUserGroupsChange,this.userGroups)},e.prototype._performBasicPropertiesPostProcessing=function(e){this._pageContext&&(e.hasPictureUrl=!!e.pictureUrl,e.pictureUrl="".concat(this._pageContext.webAbsoluteUrl).concat("/_api/GroupService/GetGroupImage"),e.inboxUrl=this._getWorkloadUrl(e,"inboxUrl","conversations",p),e.calendarUrl=this._getWorkloadUrl(e,"calendarUrl","CALENDAR",null),e.membersUrl=this._getWorkloadUrl(e,"membersUrl","members",null),e.teamsUrl=this._getWorkloadUrl(e,"teamsUrl",null,m))},e.prototype._getWorkloadUrl=function(e,t,n,a){var i=null,r=e.yammerResources,o=e.teamsResources,s=function(e){var t=e.filter(function(e){return e.Key===a});return t&&t[0]?t[0].Value:null};return a===m?o&&o.results&&o.results.length>0&&(i=s(o.results)):r&&r.results&&r.results.length>0?a===p&&(i=s(r.results)):i=e[t]?e[t]:"".concat(this._pageContext.webAbsoluteUrl,"/_layouts/15/groupstatus.aspx?id=").concat(e.id,"&target=").concat(n),i},e.prototype._saveUserToCache=function(e,t){if(e)return this._persistentCache.update({key:t},e)},e.prototype._getUserFromCache=function(e){return c.Promise.resolve(this._persistentCache.read({key:e}).then(function(e){return e.data}).catch(function(){}))},e.prototype._clearUserGroupsCache=function(e){if(e)return c.Promise.all([this._persistentCache.remove({key:"UserGroupsFromAAD"+e}),this._persistentCache.remove({key:"UserGroups"+e})]).then(function(e){})},e.prototype._getUserIdForCacheClear=function(e,t){var n;return this.currentUser&&e?(n=e===this.currentUser.userId?e:null,c.Promise.resolve(n)):this.getCurrentUser().then(function(a){return n=e?e===a.userId?a.userId:null:t===a.principalName?a.userId:null})},e.prototype._isPartnerUser=function(){var e,t;try{var n=window.parent;return!!n&&(null===(t=null===(e=n.window)||void 0===e?void 0:e.adminPageContext)||void 0===t?void 0:t.userType)===this._partnerUser}catch(e){return!1}},e.onUserGroupsChange="userGroups",e}()},"4AK9":function(e,t,n){"use strict";var a=n("17wl"),i=n("tOru"),r=n("1tKF"),o=n("K9kD"),s=n("ynV5"),c=n("y88i"),d=n("C21W"),l=n("QVYh"),u=n("w0LS"),f="Group('{0}')",p="Group('{0}')/{1}?$skip={2}&$top={3}&$inlinecount=allpages&$select=PrincipalName,Id,DisplayName,PictureUrl,UserType,Mail",m="Group('{0}')/Members/Add(objectId='{1}', principalName='{2}')",_="Group('{0}')/Owners/Add(objectId='{1}', principalName='{2}')",h="Group('{0}')/Members/Remove('{1}')",b="Group('{0}')/Owners/Remove('{1}')",g="/_layouts/15/groupstatus.aspx?id={0}&target={1}",v="isTeamifyPromptHidden",y=function(e){function t(t){var n=e.call(this,{dataSourceName:"GroupsDataSource",id:"GroupsDataSource"},{pageContext:t})||this;return n._isTeamifyPromptHiddenCacheKey=t?v+"_".concat(t.siteId+t.groupId):v,n}return Object(a.__extends)(t,e),t._copyMember=function(e){return{sip:e.alias,userId:e.id,email:e.mail,principalName:e.principalName,name:e.displayName,job:e.title,image:e.sharePointPictureUrl,profilePage:e.profilePage,entityType:e&&e.userType&&"guest"===e.userType?1:void 0}},t._parseUser=function(e){var n=JSON.parse(e);return t._copyMember(n.d)},t._copyMembers=function(e){var n=new i.t;return n.members=e.map(function(e){return t._copyMember(e)}),n},t._parseGroup=function(e){var n=JSON.parse(e);return t._copyGroup(n.d)},t._parseMembership=function(e){var n=JSON.parse(e);return t._copyMembership(n.d)},t._copyGroup=function(e){return{description:e.description,alias:e.alias,name:e.displayName,principalName:e.principalName,creationTime:e.creationTime,pictureUrl:e.pictureUrl,inboxUrl:e.inboxUrl,calendarUrl:e.calendarUrl,filesUrl:e.documentsUrl,sharePointUrl:e.siteUrl,editUrl:e.editGroupUrl,membersUrl:e.peopleUrl,notebookUrl:e.notebookUrl,teamsUrl:e.teamsUrl,isPublic:e.isPublic,mail:e.mail,classification:e.classification,yammerResources:e.yammerResources,teamsResources:e.teamsResources,allowToAddGuests:e.allowToAddGuests,isDynamic:e.isDynamic,assignedLabels:e.assignedLabels,membership:t._copyMembership(e)}},t._copyMembership=function(e){return{totalNumberOfMembers:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,membersList:e&&e.results?t._copyMembers(e.results):void 0}},t._parseOwnership=function(e){var n=JSON.parse(e);return t._copyOwnership(n.d)},t._copyOwnership=function(e){return{totalNumberOfOwners:"string"==typeof e.__count?parseInt(e.__count,10):e.__count,ownersList:e&&e.results?t._copyMembers(e.results):void 0}},t.prototype.getGroupBasicProperties=function(e){var n=this;return this.getData(function(){return n._getUrl(s.format("Group('{0}')?$select=PrincipalName,Id,DisplayName,Alias,Description,InboxUrl,CalendarUrl,DocumentsUrl,SiteUrl,EditGroupUrl,PictureUrl,PeopleUrl,NotebookUrl,Mail,IsPublic,CreationTime,Classification,yammerResources,teamsResources,allowToAddGuests,isDynamic,assignedLabels",e),"SP.Directory.DirectorySession")},function(a){var i=t._parseGroup(a);return i.id||(i.id=e),n._calculateMissingGroupProperties(i,e),i},"GetBasicProperties",void 0,"GET",void 0,void 0,3)},t.prototype.setGroupBasicProperties=function(e){var t=this;return e?this.getData(function(){return t._getUrl(s.format(f,e.id),"SP.Directory.DirectorySession")},void 0,"SetBasicProperties",function(){var t={__metadata:{type:"SP.Directory.Group"}};return e.name&&(t.displayName=e.name),e.description&&(t.description=e.description),e.assignedLabels?(null!=e.isPublic&&(t.isPublic=e.isPublic),e.assignedLabels===o.Guid.Empty?t.assignedLabels="":t.assignedLabels=e.assignedLabels):(null!=e.isPublic&&(t.isPublic=e.isPublic),e.classification&&(t.classification=e.classification)),JSON.stringify(t)},"PATCH",void 0,void 0,3):o.Promise.reject("Group parameter is null or undefined")},t.prototype.getGroupByAlias=function(e){var n=this;return this.getData(function(){return n._getUrl(s.format("Group(alias='{0}')",e),"SP.Directory.DirectorySession")},function(e){return t._parseGroup(e)},"GetGroupByAlias",void 0,"GET",void 0,void 0,0)},t.prototype.getGroupMembership=function(e,n,a,i){var r=this;void 0===a&&(a=!1),void 0===i&&(i=!1);var c=a?"100":"3";return this.getData(function(){return r._getUrl(s.format(p,e,"members","0",c),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembership",void 0,"GET",void 0,void 0,3).then(function(t){return i?r._addOwnerInformation(e,n,t):o.Promise.resolve(t)})},t.prototype.getGroupMembershipPage=function(e,n,a,i){var r=this;return this.getData(function(){return r._getUrl(s.format(p,e,"members",a,i),"SP.Directory.DirectorySession")},function(e){var a=t._parseMembership(e);return r._calculateMissingMembershipProperties(a,n),a},"GetMembershipPage",void 0,"GET",void 0,void 0,3)},t.prototype.getGroupOwnership=function(e,n){var a=this,i=n||"100";return this.getData(function(){return a._getUrl(s.format(p,e,"owners","0",i),"SP.Directory.DirectorySession")},function(e){var n=t._parseOwnership(e);return a._calculateMissingOwnershipProperties(n),n},"GetOwnership",void 0,"GET",void 0,void 0,3)},t.prototype.getUserGroupsFromAAD=function(e){var t=this;return this.getData(function(){return t._getCsomUrl("ProcessQuery")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroupsFromAAD",function(){return s.format('<Request xmlns="http://schemas.microsoft.com/sharepoint/clientquery/2009" SchemaVersion="15.0.0.0" LibraryVersion="16.0.0.0" ApplicationName="Javascript Library"><Actions><ObjectPath Id="4" ObjectPathId="3" /><Query Id="5" ObjectPathId="3"><Query SelectAllProperties="true"><Properties /></Query></Query></Actions><ObjectPaths><StaticMethod Id="3" Name="GetMyGroups" TypeId="{1e54feb9-52a0-49f7-b464-6b722cf86f94}"><Parameters><Parameter Type="String">{0}</Parameter><Parameter Type="Number">0</Parameter><Parameter Type="Number">100</Parameter></Parameters></StaticMethod></ObjectPaths></Request>',e.email)},"POST")},t.prototype.getUserGroups=function(e){var t=this,n=function(){return t.getUserGroupsFromAAD(e)};return this.getData(function(){return t._getUrl(s.format("User('{0}')/RankedMembership?$top=100&$select=DisplayName,DocumentsUrl,SharePointPictureUrl,PictureUrl,Id,IsFavorite",e.userId),"SP.Directory.DirectorySession")},this._parseResponseForGetUserGroups.bind(this),"GetUserGroups",void 0,"GET",void 0,void 0,0).then(function(e){return e&&e.length?e:n()},n)},t.prototype.addGroupMember=function(e,t,n,a){var i=this;return t=t||o.Guid.Empty,n=n||"",this.getData(function(){return i._getUrl(s.format(m,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddMember",void 0,"POST",void 0,void 0,3)},t.prototype.addGroupOwner=function(e,t,n,a){var i=this;return t=t||o.Guid.Empty,n=n||"",this.getData(function(){return i._getUrl(s.format(_,e,t,n),"SP.Directory.DirectorySession")},void 0,a||"AddOwner",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupMember=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(s.format(h,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveMember",void 0,"POST",void 0,void 0,3)},t.prototype.removeGroupOwner=function(e,t,n){var a=this;return this.getData(function(){return a._getUrl(s.format(b,e,t),"SP.Directory.DirectorySession")},void 0,n||"RemoveOwner",void 0,"POST",void 0,void 0,3)},t.prototype.addUsersToGroup=function(e,t,n,i,r){var c=this,l=o.Guid.generate(),u="multipart/mixed; boundary=batch_"+l,f=[],p=[],h=0,b=0,g=function(t,n,a){for(var i=n?_:m,r=0;r<t.length;r++){var d=void 0,l=void 0;if(a?l=t[r]:d=t[r],d||l){d=d||o.Guid.Empty,l=l||"";var u=c._getUrl(s.format(i,e,d,l),"SP.Directory.DirectorySession");n?p.push(u):f.push(u)}}};if(t?(g(t,!0,!1),h=t.length):i&&(g(i,!0,!0),h=i.length),n?(g(n,!1,!1),b=n.length):r&&(g(r,!1,!0),b=r.length),!(p.length<1&&f.length<1)){var v=this.getData(function(){return d.e.getBatchOperationUrl(c._pageContext.webAbsoluteUrl)},function(e){return e},"AddUsersToGroup",function(){return d.e.getBatchContent(l,[p,f],"POST",d.e.defaultBatchRequestPostData)},"POST",void 0,u,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersNumber:h,MembersNumber:b},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new o.Promise(function(e,t){v.then(function(n){var a=d.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.addRemoveGroupUsers=function(e,t,n,i,r){var c=this,l=o.Guid.generate(),u="multipart/mixed; boundary=batch_"+l,f=[],p=[],g=[],v=[],y=function(t,n,a){var i="SP.Directory.DirectorySession";if(void 0!==t)for(var r=0;r<t.length;r++)if(n)if(a){var o=c._getUrl(s.format(_,e,t[r],""),i);f.push(o)}else o=c._getUrl(s.format(b,e,t[r]),i),g.push(o);else a?(o=c._getUrl(s.format(m,e,t[r],""),i),p.push(o)):(o=c._getUrl(s.format(h,e,t[r]),i),v.push(o))};if(y(t,!0,!0),y(i,!0,!1),y(n,!1,!0),y(r,!1,!1),0!==f.length||0!==p.length||0!==g.length||0!==v.length){var S=this.getData(function(){return d.e.getBatchOperationUrl(c._pageContext.webAbsoluteUrl)},function(e){return e},"AddRemoveGroupOwners",function(){return d.e.getBatchContent(l,[f,p,g,v],"POST",d.e.defaultBatchRequestPostData)},"POST",void 0,u,void 0,void 0,void 0,function(e){var t=e.errorData,n=e.eventData;return t?(t.extraData={OwnersToAdd:f.length,MembersToAdd:p.length,OwnersToRemove:g.length,MembersToRemove:v.length},{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultCode:t.status.toString()})}):{eventData:n}},void 0);return new o.Promise(function(e,t){S.then(function(n){var a=d.e.processBatchResponse(n);a.hasError?t(a):e(a)},function(e){t(e)})})}},t.prototype.getUserInfo=function(e){var n=this;return this.getData(function(){return n._getUrl(s.format("User(principalName='{0}')",c.UriEncoding.encodeRestUriStringToken(e)),"SP.Directory.DirectorySession")},function(n){var a=t._parseUser(n);return a.email=e,a},"GetGraphUser",void 0,"GET",void 0,void 0,3)},t.prototype.deleteGroup=function(e){var t=this;return e?this.getData(function(){return t._getUrl(s.format(f,e.id),"SP.Directory.DirectorySession")},void 0,"DeleteGroup",void 0,"DELETE",void 0,void 0,3):o.Promise.reject("Group parameter is null or undefined")},t.prototype.deleteSite=function(e){var t=this;return this.getData(function(){return t._pageContext.siteAbsoluteUrl+s.format("/_api/GroupSiteManager/Delete?siteUrl='{0}'",e)},void 0,"DeleteSite",void 0,"POST",void 0,void 0,3)},t.prototype.teamify=function(){var e=this;return this.getData(function(){return e._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroup"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroup}},"Groupify",function(){return""},"POST",void 0,void 0,0)},t.prototype.teamifyV2=function(e,t){var n=this;return this.getData(function(){return n._pageContext.webAbsoluteUrl+"/_api/GroupSiteManager/EnsureTeamForGroupEx"},function(e){if(e){var t=JSON.parse(e);if(t&&t.d)return t.d.EnsureTeamForGroupEx}},"TeamifyV2",function(){return""},"POST",void 0,void 0,0).then(function(a){return t(a),a&&a.teamsId?n._pinToTeam(a,e):void 0})},t.prototype.dismissTeamifyBanner=function(){var e=this;return this.getData(function(){return e._pageContext.siteAbsoluteUrl+s.format("/_api/GroupSiteManager/HideTeamifyPrompt?siteUrl='{0}'",e._pageContext.siteAbsoluteUrl)},function(e){return null},"DismissTeamifyBanner",function(){return""},"POST").then(function(){e.flushCache(e._isTeamifyPromptHiddenCacheKey),e.getTeamifyBannerHidden(!0)})},t.prototype.getTeamifyBannerHidden=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return t._pageContext.siteAbsoluteUrl+s.format("/_api/GroupSiteManager/IsTeamifyPromptHidden?siteUrl='{0}'",t._pageContext.siteAbsoluteUrl)},qosName:"TeamifyBannerHidden",parseResponse:function(e){var t=JSON.parse(e);return!(!t||!t.d)&&t.d.IsTeamifyPromptHidden},additionalPostData:"",method:"Get",cachingStrategy:e?u.e.bypassCache:u.e.useCacheAndUpdateInTheBackground,cacheRequestKey:this._isTeamifyPromptHiddenCacheKey})},t.prototype._getUrl=function(e,t){return"".concat(this._pageContext.webAbsoluteUrl,"/_api/").concat(t,"/").concat(e)},t.prototype._getCsomUrl=function(e){return"".concat(this._pageContext.webAbsoluteUrl,"/_vti_bin/client.svc/").concat(e)},t.prototype._getGroupStatusNotebookUrl=function(e){return this._pageContext.webAbsoluteUrl+s.format(g,e,"notebook")},t.prototype._getGroupStatusFilesUrl=function(e){return this._pageContext.webAbsoluteUrl+s.format(g,e,"documents")},t.prototype._addOwnerInformation=function(e,t,n){return this.getGroupOwnership(e,"100").then(function(e){var a=e.ownersList.members,i=n.membersList.members,r=[],s={};a.forEach(function(e){s[e.userId]=!0,e.principalName.toLowerCase()===t.toLowerCase()&&(n.isOwner=!0)});var c=0,d={};return i.forEach(function(e){s[e.userId]?(e.isOwnerOfCurrentGroup=!0,r.push(e),c++,d[e.userId]=!0):r.push(e),e.principalName===t&&(n.isMember=!0)}),c<a.length&&a.forEach(function(e){d[e.userId]||(e.isOwnerOfCurrentGroup=!0,r.push(e))}),n.membersList.members=r,n.totalNumberOfMembers<r.length&&(n.totalNumberOfMembers=r.length),n.totalNumberOfOwners=e.totalNumberOfOwners,o.Promise.resolve(n)})},t.prototype._fixUserImages=function(e){!e.image&&e.email&&(e.image=Object(l.getUserPhotoUrl)(e.email)),!e.profilePage&&e.email&&(e.profilePage=s.format("/_layouts/15/me.aspx?p={0}&v=profile&origin=ProfileODB",e.email))},t.prototype._calculateMissingMembershipProperties=function(e,t){var n=this;e.membersList.members.forEach(function(e){n._fixUserImages(e)})},t.prototype._calculateMissingOwnershipProperties=function(e){var t=this;e.ownersList.members.forEach(function(e){t._fixUserImages(e)})},t.prototype._calculateMissingGroupProperties=function(e,t){e.creationTime||(e.creationTime=Date.now()),e.pictureUrl&&(e.pictureUrl=e.pictureUrl.replace("EWS/Exchange.asmx/s/GetUserPhoto","OWA/service.svc/s/GetPersonaPhoto")),!e.notebookUrl&&t&&(e.notebookUrl=this._getGroupStatusNotebookUrl(t)),!e.filesUrl&&t&&(e.filesUrl=this._getGroupStatusFilesUrl(t))},t.prototype._parseResponseForGetUserGroups=function(e){var t=this,n=JSON.parse(e);if(n.constructor===Array)return n[4].GroupsList.map(function(e){return{filesUrl:e.DocumentsUrl,name:e.DisplayName,id:e.Id}});var a=n.d.results.map(function(e){var n={filesUrl:e.documentsUrl,name:e.displayName,id:e.id,pictureUrl:e.pictureUrl,isFavorite:e.isFavorite};return t._calculateMissingGroupProperties(n,n.id),n}),i=a.filter(function(e){return e.isFavorite});return i.push.apply(i,a.filter(function(e){return!e.isFavorite})),i},t.prototype._pinToTeam=function(e,t){var n=this;return t=t.map(function(e){return{displayName:e.displayName,isDefault:e.isDefault,url:e.url,itemType:e.itemType}}),this.getData(function(){return n._pageContext.siteAbsoluteUrl+"/_api/GroupSiteManager/PinToTeam"},function(t){if(t){var n=JSON.parse(t);if(n&&n.d)return{pinToTeam:n.d.PinToTeam,teamsInfo:e}}},"PinToTeam",function(){if(n._pageContext&&n._pageContext.navigationInfo&&n._pageContext.navigationInfo.quickLaunch){var a={requestParams:{__metadata:{type:"Microsoft.SharePoint.Portal.PinToTeamParams"},teamsId:e.teamsId,tabs:{__metadata:{type:"Collection(Microsoft.SharePoint.Portal.M365TabItem)"},results:t}}};return JSON.stringify(a)}},"POST",void 0,void 0,0)},t}(r.t);t.e=y},"6o44":function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"e",function(){return c});var a=n("7KUI"),i=n("K9kD"),r=n("ynV5"),o=n("OpjN");function s(){var e,t=new i.PlatformDetection,n=!1;if(window.indexedDB&&t.isFirefox)try{var a=window.indexedDB.open("FF_INPRIVATE");a.onerror=function(){return n=!0},"InvalidStateError"===(null===(e=null==a?void 0:a.error)||void 0===e?void 0:e.name)&&(n=!0)}catch(e){n=!0}return n}var c=function(){function e(t,n,r,s){this._eventGroup=new i.EventGroup(this),this.source=o.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=n,this.id=r,t?this.extend(t):this.load(),this.membership=new a.n(void 0,this._groupsProvider,this),!s&&n&&(s=n.getSPPageContext()),this.plannerUrl=e._getPlannerUrl(s,r)}return e._getPlannerUrl=function(e,t){if(e)return t||(t=e.groupId),e.webAbsoluteUrl+r.format("/_layouts/15/groupstatus.aspx?id={0}&target={1}",t,"planner")},e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0)},e.prototype.load=function(t){var n=this;if(this._groupsProvider&&this.id){var a=i.Promise.resolve();return this.source!==o.e.None||s()||(a=this._groupsProvider.loadGroupInfoFromCache(this.id).then(function(t){t&&t.lastLoadTimeStampFromServer>0&&(n.extend(t),n.source=o.e.Cache,n._eventGroup.raise(e.onSourceChange,n.source))})),a.then(function(){if(n._shouldLoadNewData(t))return n._startLoadingFromServer(),n._groupsProvider.loadGroupInfoContainerFromServer(n.id).then(function(e){e.lastLoadTimeStampFromServer=Date.now(),n.extend(e),n._finishLoadingFromServer(),n._groupsProvider.saveGroupToCache(e)},function(e){n._errorLoading(e)})})}return i.Promise.resolve()},e.prototype.extend=function(e){this.name=e.name,this.principalName=e.principalName,this.alias=e.alias,this.mail=e.mail,this.description=e.description,this.creationTime=e.creationTime,this.profileUrl=e.profileUrl,this.inboxUrl=e.inboxUrl,this.calendarUrl=e.calendarUrl,this.filesUrl=e.filesUrl,this.notebookUrl=e.notebookUrl,this.pictureUrl=e.pictureUrl,this.hasPictureUrl=e.hasPictureUrl,this.sharePointUrl=e.sharePointUrl,this.editUrl=e.editUrl,this.membersUrl=e.membersUrl,this.teamsUrl=e.teamsUrl,this.isPublic=e.isPublic,this.classification=e.classification,this.assignedLabels=e.assignedLabels,this.allowToAddGuests=e.allowToAddGuests,this.isDynamic=e.isDynamic,this.yammerResources=e.yammerResources,this.teamsResources=e.teamsResources,this.lastLoadTimeStampFromServer=e.lastLoadTimeStampFromServer},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&(e||this.source!==o.e.Server&&(!this.lastLoadTimeStampFromServer||Date.now()-this.lastLoadTimeStampFromServer>864e5))},e.prototype._startLoadingFromServer=function(){this.isLoadingFromServer=!0},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this.source=o.e.Server,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._errorLoading=function(t){this.isLoadingFromServer=!1,this.error=t,this._eventGroup.raise(e.onSourceChange,o.e.Error)},e.onSourceChange="source",e}();t.t=c},"7KUI":function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return c});var a,i=n("tOru"),r=n("6o44"),o=n("OpjN"),s=n("K9kD");!function(e){e[e.none=0]="none",e[e.allMembers=1]="allMembers",e[e.ownershipInformation=2]="ownershipInformation",e[e.forceSkipCache=4]="forceSkipCache"}(a||(a={}));var c=function(){function e(e,t,n){this._eventGroup=new s.EventGroup(this),this.source=o.e.None,this.lastLoadTimeStampFromServer=-1,this._groupsProvider=t,this._parent=n,e&&this.extend(e,o.e.None),this.membersList||(this.membersList=new i.t)}return e.prototype.dispose=function(){this._eventGroup&&(this._eventGroup.dispose(),this._eventGroup=void 0),this._parent=void 0},e.prototype.load=function(e,t){var n=this;if(void 0===e&&(e=!1),void 0===t&&(t=!1),this._groupsProvider&&this._parent.id){var i=0;e&&(i|=a.allMembers),t&&(i|=a.ownershipInformation);var c=s.Promise.resolve();return Object(r.n)()||this.source!==o.e.None||i||(c=this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&n.extend(e.membership,o.e.Cache)})),c.then(function(){if(n._shouldLoadNewData(i))return n._startLoadingFromServer(i),n._groupsProvider.loadMembershipContainerFromServer(n._parent.id,e,t).then(function(e){n.extend(e,o.e.Server),n._finishLoadingFromServer(),i||(e.lastLoadTimeStampFromServer=n.lastLoadTimeStampFromServer,n._groupsProvider.saveMembershipToCache(n._parent.id,e))},function(e){n._errorLoading(e)})})}return s.Promise.resolve()},e.prototype.loadWithOptions=function(e){var t=this;return this._groupsProvider&&this._parent.id&&(this.source!==o.e.None||e||this._groupsProvider.loadGroupInfoFromCache(this._parent.id).then(function(e){e&&e.membership&&e.membership.lastLoadTimeStampFromServer>0&&t.extend(e.membership,o.e.Cache)}),this._shouldLoadNewData(e))?(this._startLoadingFromServer(e),this._groupsProvider.loadMembershipContainerFromServer(this._parent.id,e&&(e&a.allMembers)===a.allMembers,e&&(e&a.ownershipInformation)===a.ownershipInformation).then(function(n){t.extend(n,o.e.Server),t._finishLoadingFromServer(),e&&e!==a.forceSkipCache||(n.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,t._groupsProvider.saveMembershipToCache(t._parent.id,n))},function(e){t._errorLoading(e)})):s.Promise.resolve(void 0)},e.prototype.extend=function(t,n){this.isMember=t.isMember,this.isOwner=t.isOwner,this.isJoinPending=t.isJoinPending,this.membersList=t.membersList,this.totalNumberOfMembers=t.totalNumberOfMembers,this.totalNumberOfOwners=t.totalNumberOfOwners,this.lastLoadTimeStampFromServer=t.lastLoadTimeStampFromServer,this._parent.membership=this,this.source=n,this._eventGroup.raise(e.onSourceChange,this.source)},e.prototype._shouldLoadNewData=function(e){return!this.isLoadingFromServer&&this.source!==o.e.Server&&(this.lastLoadTimeStampFromServer<0||Date.now()-this.lastLoadTimeStampFromServer>864e5)||e&&(e&a.forceSkipCache)===a.forceSkipCache||e&&(e&a.allMembers)===a.allMembers&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.allMembers)===a.allMembers)||e&&(e&a.ownershipInformation)===a.ownershipInformation&&!(this._currentLoadOptions&&(this._currentLoadOptions&a.ownershipInformation)===a.ownershipInformation)},e.prototype._startLoadingFromServer=function(e){this.isLoadingFromServer=!0,this._currentLoadOptions=e},e.prototype._finishLoadingFromServer=function(){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.lastLoadTimeStampFromServer=Date.now()},e.prototype._errorLoading=function(e){this.isLoadingFromServer=!1,this._currentLoadOptions=void 0,this.error=e},e.onSourceChange="source",e}();t.n=c},C21W:function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n("K9kD"),i=n("m1i4"),r=n("y88i"),o=function(){function e(){}return e.getBatchOperationUrl=function(e,t){return new i.t({webAbsoluteUrl:!e&&t?new r.SimpleUri(t).authority:e}).build().segment("$batch").toString()},e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var a=e.code?e.code.split(","):e.error.code.split(","),i=Number(a[0]),r=e.message.value;n.error={code:i,message:r}}return{items:[n]}},e.getBatchResponseText=function(e){var t,n,a,i=[];if(e.split("\n").length>0&&(t=e.split("\n")[0]),t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var r=1;r<n.length;r++)(a=n[r].split("\n\r")).length>2&&i.push(a[2])}return i},e.processBatchResponse=function(e,t,n){var a,i,r,o,s=[],c=!1;if(e&&e.split("\n").length>0&&(a=e.split("\n")[0]),a){i=(e=e.replace(a.trim()+"--","")).split(a);for(var d=1;d<i.length;d++)if((r=i[d].split("\n\r")).length>2){try{o=JSON.parse(r[2])}catch(e){o=r[2]}var l=t&&t[d-1],u=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var f=o.code?o.code.split(","):o.error.code.split(","),p=Number(f[0]),m=o.message.value;u.error={code:p,message:m},c=!0}s.push(u)}}return{items:s,hasError:c}},e.getBatchContent=function(e,t,n,i){for(var r=[],o=0;o<t.length;o++){for(var s=t[o],c=a.Guid.generate(),d=[],l=0;l<s.length;l++){var u=s[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(n+" "+u+" HTTP/1.1"),d.push(i),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");r.push("--batch_"+e),r.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),r.push("Content-Length: "+f.length),r.push("Content-Transfer-Encoding: binary"),r.push(""),r.push(f),r.push("")}return r.push("--batch_"+e+"--"),r.join("\r\n")},e.getBatchContentExtended=function(e,t,n,i,r,o,s){var c=a.Guid.generate(),d=[];r&&r.length!==t.length&&(r=null);for(var l=0;l<t.length;l++){var u=t[l];d.push("--changeset_"+c),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary"),d.push(""),s?d.push(s[l]+" "+u+" HTTP/1.1"):d.push(n+" "+u+" HTTP/1.1"),d.push(i),o&&d.push(o),r&&(d.push(""),d.push(r[l])),d.push("")}d.push("--changeset_"+c+"--");var f=d.join("\r\n");return(d=[]).push("--batch_"+e),d.push('Content-Type: multipart/mixed; boundary="changeset_'+c+'"'),d.push("Content-Length: "+f.length),d.push("Content-Transfer-Encoding: binary"),d.push(""),d.push(f),d.push(""),d.push("--batch_"+e+"--"),d.join("\r\n")},e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose",e.defaultBatchAcceptData="accept: application/json;odata=verbose",e}();t.t=o},OpjN:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Cache=0]="Cache",e[e.Server=1]="Server",e[e.None=2]="None",e[e.Error=3]="Error"}(a||(a={}))},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},kFKu:function(e,t,n){"use strict";n.r(t);var a=n("3Ilx");n.d(t,"GroupsProvider",function(){return a.e});var i=n("fTUh");n.d(t,"GroupType",function(){return i.e});var r=n("tOru");n.d(t,"MembersList",function(){return r.e});var o=n("6o44");n.d(t,"isFFPrivate",function(){return o.n}),n.d(t,"Group",function(){return o.e});var s=n("7KUI");n.d(t,"MembershipLoadOptions",function(){return s.t}),n.d(t,"Membership",function(){return s.e});var c=n("OpjN");n.d(t,"SourceType",function(){return c.e})},m1i4:function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n("17wl"),i=n("y88i"),r=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n,r=Object(a.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments,!0);return"".concat(r.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?i.UriEncoding.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(i.UriEncoding.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),o=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(r)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}()},tOru:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){this.members=new Array}return e.prototype.addUserToList=function(e){this.members.unshift(e)},e.prototype.removeUserFromList=function(e){for(var t=-1,n=0;n<this.members.length;n++)this.members[n].userId===e.userId&&(t=n);t>=0&&this.members.splice(t,1)},e.prototype.containsUserByPrincipalName=function(e){if(e)for(var t=e.toLowerCase(),n=0;n<this.members.length;n++)if(this.members[n].principalName&&this.members[n].principalName.toLowerCase()===t)return!0;return!1},e}();t.t=a}}]);