(window.msfast_searchux_sb_jsonp=window.msfast_searchux_sb_jsonp||[]).push([["cpl-host~cpl-invoker~cpl-no-submit~stream"],{"3c19":function(e,t,r){"use strict";r.d(t,"a",(function(){return Z})),r.d(t,"b",(function(){return V}));var n=r("+zb2"),s=r("NeXG"),i=r("UlRC"),o=r("vnLS"),a=r("3twC"),c=r("KN+b"),u=r("+6EB"),l=r("H3jn"),p=r("PS6g"),g=r("D7WJ"),h=r("NQus"),d=r("rP0q");i.Observable.prototype.debounce=function(e,t,r){void 0===t&&(t=!1);i.helpers.isScheduler(r)||(r=i.Scheduler.timeout);var n=this;return new i.AnonymousObservable((function(s){var o,a=new i.SerialDisposable,c=!1,u=0,l=n.subscribe((function(t){c=!0,o=t;var n=++u,l=new i.SingleAssignmentDisposable;a.setDisposable(l),l.setDisposable(r.scheduleWithRelative(e,(function(){c&&u===n&&s.onNext(o),c=!1})))}),(function(e){a.dispose(),t&&c&&s.onNext(o),s.onError(e),c=!1,u++}),(function(){a.dispose(),c&&s.onNext(o),s.onCompleted(),c=!1,u++}));return new i.CompositeDisposable(l,a)}))};r("PWby");var m=r("g0AW"),b=r("Pbp7"),f=r("00RH"),v=r("gRZJ"),S=r("kCs8"),O=r("Z0JL"),x=r("+du+"),j=r("ZUMI"),T=r("cDcd"),E=r("Puxc");function w(e){return"innerErrors"in e&&Object(E.a)(e.innerErrors)?function(e){const t=e.reduce(({message:e,groups:t,providers:r},{providerGroupId:n,innerErrors:s})=>({message:e,groups:[...t,n],providers:[...r,...s.map(e=>e.providerId)]}),{message:"Expected suggestion stream error.",groups:[],providers:[]});return{message:t.message,groups:JSON.stringify(t.groups),providers:JSON.stringify(t.providers)}}(e.innerErrors):{message:"Unexpected suggestion stream error."}}var y=r("deeS"),C=r("JF8P"),R=r("Ak5F"),_=r("7yNR"),D=r("n5ha"),N=r("cQB/"),I=r("6e3C"),k=r("Vz/d"),B=r.n(k),P=["->","–>","-","–"],L=/^\d+$/;function F(e){var t=Object(N.a)(P,(function(t){return e.indexOf(t)>=0})),r=t?e.split(t).map((function(e){return e.trim()})):[e.trim()];if(1===r.length){var n=r[0];if(Object(I.e)(n,"*")){var s=n.substring("*".length);return s.match(L)?function(e){return Object(I.a)(e.toString(),s)}:null}return n.match(L)?function(e){return e.toString()===n}:null}if(2===r.length){if(!r[0].match(L))return null;var i=parseInt(r[0],10);if(isNaN(i))return null;if("INF"===r[1])return function(e){return e>=i};if(!r[1].match(L))return null;var o=parseInt(r[1],10);return isNaN(o)?null:function(e){return e>=i&&e<o}}return null}function W(e,t){var r,s,i,o,a=function(t){throw new Error('pluralized string "'.concat(e,'" ').concat(t))};try{for(var c=Object(n.__values)(e.split("||")),u=c.next();!u.done;u=c.next()){var l=u.value,p=l.split("::");2!==p.length&&a("is missing separator ".concat("::",' in clause "').concat(l,'"'));var g=Object(n.__read)(p,2),h=g[0],d=g[1];try{for(var m=(i=void 0,Object(n.__values)(h.split(","))),b=m.next();!b.done;b=m.next()){var f=b.value,v=F(f);if(null===v)a('contains invalid range "'.concat(f,'"'));else if(!t(d,v))return}}catch(e){i={error:e}}finally{try{b&&!b.done&&(o=m.return)&&o.call(m)}finally{if(i)throw i.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(s=c.return)&&s.call(c)}finally{if(r)throw r.error}}}function G(e,t){if(void 0===t)return e;try{return function(e,t){if(t<0||t!==1/0&&!B()(t))throw new Error("count must be a positive integer or Infinity");var r="";return W(e,(function(e,n){return!n(t)||(r=e,!1)})),r}(e,t)}catch(t){return e}}const A=(Object(D.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.suggestionsAvailable")),U=(Object(D.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.suggestionsAvailableForQueryIntervals")),J=(Object(D.declareStringWithPlaceholders)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.numSuggestionsInGroup")),H=(Object(D.declareString)("search-box-container-plugins.searchux.strings.GroupedSearchSuggestions.unnamedGroup")),M=Object(_.a)(R.a);function q(e,t,r){try{let n=0;const s=(null==r?void 0:r.map(e=>{{const t=e.suggestions.length;n+=t;return Object(C.a)(e)?"":J({count:t.toString(),group:e.title||e.heading||e.ariaLabel||H()})}}).filter(Boolean).join(", "))||"",i=t?(({suggestionCount:e,searchText:t})=>G(U({suggestionCount:e,searchText:t}),parseInt(e,0)))({suggestionCount:n.toString(),searchText:t}):(({suggestionCount:e})=>G(A({suggestionCount:e}),parseInt(e,0)))({suggestionCount:n.toString()});e.innerText="",e.innerText=i+s}catch(e){M({eventType:"ERROR",name:"SUGGESTIONS_ARIALIVE_ERROR",detail:"Suggestions failed to create aria live region"})}}const z=Object(_.a)(R.a);class Q extends T.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(){z({eventType:"ERROR",name:"SUGGESTIONS_RENDER_ERROR",detail:"Suggestions failed to render."})}render(){return this.state.hasError?null:T.createElement(T.Suspense,{fallback:null},this.props.children)}}let Z=class extends T.Component{constructor(){super(...arguments),this.resources=new i.CompositeDisposable,this.debouncedFetchSuggestions=Object(m.a)(this.fetchSuggestions,this.props.debounceStream||0)}registerRefetchListener(){const{updateSearchBoxListener:e}=this.props;this.searchBoxListenerToken=null==e?void 0:e.register(()=>this.fetchSuggestionsBasedOnDebounceStream(this.props))}UNSAFE_componentWillMount(){this.fetchSuggestionsBasedOnDebounceStream(this.props),Object(o.a)(this.props.hostWindow||window),this.registerRefetchListener()}fetchSuggestions(e){var t,r;if(!e.configuration)return;const n=this.props.instrumenter,s=Object(y.a)(e);s&&s.createLogicalSearchId("sb");const a="string"==typeof e.searchText?e.searchText:"string"==typeof(null===(t=e.context)||void 0===t?void 0:t.searchText)?null===(r=e.context)||void 0===r?void 0:r.searchText:"",c=Object(h.a)(a);n&&n.setProps({searchTextCharacteristics:c});const u=this,l=Object(g.a)();let p=!1;this.setState({error:null,allComplete:!1}),this.resources.dispose(),this.resources=new i.CompositeDisposable;const d=this.getDependencies(e.configuration),m=e.configuration;let f,v=V(m,Object(b.a)(d,d.map(t=>e[t])),a,"suggestion_stream","suggestion_provider_host");function S(){p||u.setState({data:{configuration:m,groups:[],fetchStartTime:l,activatedTime:e.activatedTime,inputTime:e.inputTime}}),q(Object(o.a)(e.hostWindow||window),a,f)}e.debounceStream&&(v=v.debounce(0,!0)),this.resources.add(v.subscribe(t=>(p=!0,f=t,this.setState({data:{configuration:m,groups:t,fetchStartTime:l,activatedTime:e.activatedTime,inputTime:e.inputTime}})),t=>{this.setState({error:t}),S();try{e.onError&&e.onError(t)}catch(e){}},S))}getDependencies({groups:e}){return Object(c.a)(Object(f.a)(e.map(e=>e.providers)))}render(){const e=this.props.errorComponent;if(!this.state)return null;const{data:t}=this.state,r=(this.props.hostWindow||window).document;return T.createElement(Q,null,T.createElement(T.Fragment,null,this.props.invokeSuggestionOnSubmit&&!this.props.noSubmit?T.createElement("button",{hidden:!0,onClick:e=>{var t;e.preventDefault();const n=r.querySelector("#"+this.props.popupId),s=n&&n.querySelector("[data-suggestion-position='0'] [data-nav='true']");null===(t=null==s?void 0:s.click)||void 0===t||t.call(s)}}):null,this.props.noSubmit&&T.createElement("button",{hidden:!0,onClick:e=>(e.preventDefault(),e.stopPropagation())}),t&&T.createElement(u.a,{fetchStartTime:t.fetchStartTime,activatedTime:t.activatedTime,inputTime:t.inputTime,groups:t.groups.slice(0),searchText:this.props.searchText||"",conversation:Object(y.a)(this.props),instrumenter:this.props.instrumenter,searchSuggestionFactory:K(t.configuration).suggestionFactory,theme:this.props.theme?this.props.theme:p.b,indicateFirstItemAsSelected:this.props.invokeSuggestionOnSubmit,suggestionClickManager:this.props.suggestionClickManager,searchBox:this.props.searchBox,context:this.props.context}),this.state.error&&e?T.createElement(e,{error:this.state.error}):null))}fetchSuggestionsBasedOnDebounceStream(e){this.props.debounceStream?this.debouncedFetchSuggestions(e):this.fetchSuggestions(e)}UNSAFE_componentWillReceiveProps(e){this.relevantPropsChanged(e)&&this.fetchSuggestionsBasedOnDebounceStream(e)}relevantPropsChanged(e){var t,r;return e.searchText!==this.props.searchText||e.configuration!==this.props.configuration||(null===(t=e.context)||void 0===t?void 0:t.searchText)!==(null===(r=this.props.context)||void 0===r?void 0:r.searchText)||(()=>{const t=e.configuration?this.getDependencies(e.configuration):[];return!Object(v.a)(Object(S.a)(this.props,t),Object(S.a)(e,t))})()}componentWillUnmount(){var e;this.resources.dispose(),Object(o.a)(this.props.hostWindow||window).innerText="",this.searchBoxListenerToken&&(null===(e=this.props.updateSearchBoxListener)||void 0===e||e.unregister(this.searchBoxListenerToken),this.searchBoxListenerToken=void 0)}};Z.defaultProps={onError:O.a,errorComponent:()=>T.createElement("div",null)},Z=Object(n.__decorate)([d.a],Z);t.c=Object(a.a)({kind:"suggestion",displayName:"BasicSuggestionProviderHost",scenes:["commanding"]})(e=>T.createElement(Z,Object.assign({},e)));function V(e,t,r,n,s){return Object(l.a)(e,t,r).select(t=>t.map(t=>Object.assign(Object.assign({},t),K(e).stringsIndex[t.id]))).monitor({eventName:n,nameDetail:s,isHot:!1},void 0,w)}const K=Object(s.a)((function({groups:e}){const t=Object(x.a)(Object(j.a)(e.map(({id:e,component:t})=>({id:e,component:t})),X),e=>e[0]);return{stringsIndex:Object(x.a)(Object(j.a)(e.map(({id:e,heading:t,ariaLabel:r})=>({id:e,heading:t,ariaLabel:r})),({id:e})=>e),e=>e[0]),suggestionFactory:function(e,r){const n=t[e].component;return T.createElement(n,Object.assign({},r))}}}));function X(e){return e.id}}}]);