define("7f718435-ee4d-431c-bdbf-9c4ff326f46e_1.1.1",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@ms/sp-grid-layout","@microsoft/sp-component-base","@microsoft/sp-loader","@ms/odsp-core-bundle","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-webpart-base","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={5:0,6:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({3:"sp-people-card-placeholder",4:"sp-people-contact-card"}[e]||e)+"_"+(["en-us","none"])[{"3":1,"4":0}[e]]+"_"+{3:"66365e98ccf1afb7a00e",4:"1327309149513e470402"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp_9956086cf62725f96461166eaa2c4d81=window.webpackJsonp_9956086cf62725f96461166eaa2c4d81||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp\-people\-webparts\-bundle_en-us_32624aa28ba045d0c068\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="+wm6")}({"+mM2":function(e,t,n){"use strict";n.r(t),n.d(t,"getLayoutField",function(){return S}),n.d(t,"getPeoplePropertyPane",function(){return y});var a=n("br4S"),i=n("mFOl"),r=n("u2MZ"),o=n("cDcd"),s=o.createElement("svg",null,o.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},o.createElement("path",{className:"themeableSvgPath",d:"M0,24 L0,8 L32,8 L32,24 L0,24 Z M16,10 L16,22 L30,22 L30,10 L16,10 Z M14,10 L2,10 L2,22 L14,22 L14,10 Z M8,20 C5.790861,20 4,18.209139 4,16 C4,13.790861 5.790861,12 8,12 C10.209139,12 12,13.790861 12,16 C12,18.209139 10.209139,20 8,20 Z M8,14 C6.8954305,14 6,14.8954305 6,16 C6,17.1045695 6.8954305,18 8,18 C9.1045695,18 10,17.1045695 10,16 C10,14.8954305 9.1045695,14 8,14 Z",fillRule:"nonzero"}))),c=o.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"33",fill:"currentColor",viewBox:"0 0 38 22"},o.createElement("path",{className:"themeableSvgPath","fill-rule":"evenodd",d:"M36 2H2v18h34V2zM0 0v22h38V0H0z","clip-rule":"evenodd"}),o.createElement("path",{className:"themeableSvgPath","fill-rule":"evenodd",d:"M10 12a3 3 0 100-6 3 3 0 000 6zm0 2a5 5 0 100-10 5 5 0 000 10zM29 10H18V8h11v2zM33 18H5v-2h28v2z","clip-rule":"evenodd"})),d=o.createElement("svg",null,o.createElement("g",{stroke:"none","stroke-width":"1",fill:"none",fillRule:"evenodd"},o.createElement("path",{className:"themeableSvgPath",d:"M28.0045894,31.9994869 L4.0045894,31.9994869 L4.0045894,0.000533432728 L28.0045894,0.000533432728 L28.0045894,31.9994869 Z M6,18 L6,30.0005334 L26,30.0005334 L26,18 L6,18 Z M26,2.00053343 L6,2.00053343 L6,16 L26,16 L26,2.00053343 Z M16,13.9997486 C13.2386124,13.9997486 11.0000654,11.761348 11.0000654,9.000141 C11.0000654,6.23893398 13.2386124,4.00053343 16,4.00053343 C18.7613876,4.00053343 20.9999346,6.23893398 20.9999346,9.000141 C20.9999346,11.761348 18.7613876,13.9997486 16,13.9997486 Z M16,6.00053343 C14.3432902,6.00053343 13.0002616,7.34356205 13.0002616,9.00027181 C13.0002616,10.6569816 14.3432902,12.0000102 16,12.0000102 C17.6567098,12.0000102 18.9997384,10.6569816 18.9997384,9.00027181 C18.9997384,7.34356205 17.6567098,6.00053343 16,6.00053343 Z M24.0000102,22 L8.00001017,22 L8.00001017,20 L24.0000102,20 L24.0000102,22 Z M20,26 L12,26 L12,24 L20,24 L20,26 Z",fillRule:"nonzero"}))),l=o.createElement("svg",{width:"32",height:"17",viewBox:"0 0 32 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("rect",{className:"themeableSvgStroke",x:"1",y:"1",width:"30",height:"14.4848",rx:"3","stroke-width":"2"}),o.createElement("circle",{className:"themeableSvgStroke",cx:"8.24242",cy:"8.24254",r:"3.36364","stroke-width":"2"})),u=o.createElement("svg",{width:"32",height:"18",viewBox:"0 0 32 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{className:"themeableSvgPath","fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.36364 11.7273C10.669 11.7273 11.7273 10.669 11.7273 9.36364C11.7273 8.05824 10.669 7 9.36364 7C8.05824 7 7 8.05824 7 9.36364C7 10.669 8.05824 11.7273 9.36364 11.7273ZM9.36364 13.7273C11.7736 13.7273 13.7273 11.7736 13.7273 9.36364C13.7273 6.95367 11.7736 5 9.36364 5C6.95367 5 5 6.95367 5 9.36364C5 11.7736 6.95367 13.7273 9.36364 13.7273Z"}),o.createElement("path",{className:"themeableSvgPath","fill-rule":"evenodd","clip-rule":"evenodd",d:"M28 9C28 9.55228 27.5523 10 27 10H17C16.4477 10 16 9.55228 16 9C16 8.44772 16.4477 8 17 8H27C27.5523 8 28 8.44772 28 9Z"}),o.createElement("path",{className:"themeableSvgPath","fill-rule":"evenodd","clip-rule":"evenodd",d:"M28 2H4C2.89543 2 2 2.89543 2 4V14C2 15.1046 2.89543 16 4 16H28C29.1046 16 30 15.1046 30 14V4C30 2.89543 29.1046 2 28 2ZM4 0C1.79086 0 0 1.79086 0 4V14C0 16.2091 1.79086 18 4 18H28C30.2091 18 32 16.2091 32 14V4C32 1.79086 30.2091 0 28 0H4Z"})),f=o.createElement("svg",{width:"24",height:"32",viewBox:"0 0 24 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("rect",{className:"themeableSvgStroke",x:"1",y:"1",width:"22",height:"30",rx:"3","stroke-width":"2"}),o.createElement("circle",{className:"themeableSvgStroke",cx:"12",cy:"11",r:"4","stroke-width":"2"}),o.createElement("path",{className:"themeableSvgPath","fill-rule":"evenodd","clip-rule":"evenodd",d:"M20 21C20 21.5523 19.5523 22 19 22H5C4.44772 22 4 21.5523 4 21C4 20.4477 4.44772 20 5 20H19C19.5523 20 20 20.4477 20 21Z"}),o.createElement("path",{className:"themeableSvgPath","fill-rule":"evenodd","clip-rule":"evenodd",d:"M16 25C16 25.5523 15.5523 26 15 26L9 26C8.44772 26 8 25.5523 8 25C8 24.4477 8.44772 24 9 24L15 24C15.5523 24 16 24.4477 16 25Z"})),p=o.createElement("svg",{width:"16",height:"9",viewBox:"0 0 16 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("rect",{className:"themeableSvgStroke",x:"0.5",y:"0.5",width:"15",height:"7.24242",rx:"1.5"}),o.createElement("circle",{className:"themeableSvgStroke",cx:"4.12121",cy:"4.12127",r:"1.68182"})),m=o.createElement("svg",{width:"16",height:"9",viewBox:"0 0 16 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("path",{className:"themeableSvgFill","fill-rule":"evenodd","clip-rule":"evenodd",d:"M4.68182 5.86364C5.33452 5.86364 5.86364 5.33452 5.86364 4.68182C5.86364 4.02912 5.33452 3.5 4.68182 3.5C4.02912 3.5 3.5 4.02912 3.5 4.68182C3.5 5.33452 4.02912 5.86364 4.68182 5.86364ZM4.68182 6.86364C5.8868 6.86364 6.86364 5.8868 6.86364 4.68182C6.86364 3.47683 5.8868 2.5 4.68182 2.5C3.47683 2.5 2.5 3.47683 2.5 4.68182C2.5 5.8868 3.47683 6.86364 4.68182 6.86364Z"}),o.createElement("path",{className:"themeableSvgFill","fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 4.5C14 4.77614 13.7761 5 13.5 5H8.5C8.22386 5 8 4.77614 8 4.5C8 4.22386 8.22386 4 8.5 4H13.5C13.7761 4 14 4.22386 14 4.5Z"}),o.createElement("path",{className:"themeableSvgFill","fill-rule":"evenodd","clip-rule":"evenodd",d:"M14 1H2C1.44772 1 1 1.44772 1 2V7C1 7.55228 1.44772 8 2 8H14C14.5523 8 15 7.55228 15 7V2C15 1.44772 14.5523 1 14 1ZM2 0C0.895431 0 0 0.89543 0 2V7C0 8.10457 0.895431 9 2 9H14C15.1046 9 16 8.10457 16 7V2C16 0.895431 15.1046 0 14 0H2Z"})),_=o.createElement("svg",{width:"12",height:"16",viewBox:"0 0 12 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.createElement("rect",{className:"themeableSvgStroke",x:"0.5",y:"0.5",width:"11",height:"15",rx:"1.5"}),o.createElement("circle",{className:"themeableSvgStroke",cx:"6",cy:"5.5",r:"2"}),o.createElement("path",{className:"themeableSvgFill","fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 10.5C10 10.7761 9.77614 11 9.5 11H2.5C2.22386 11 2 10.7761 2 10.5C2 10.2239 2.22386 10 2.5 10H9.5C9.77614 10 10 10.2239 10 10.5Z"}),o.createElement("path",{className:"themeableSvgFill","fill-rule":"evenodd","clip-rule":"evenodd",d:"M8 12.5C8 12.7761 7.77614 13 7.5 13L4.5 13C4.22386 13 4 12.7761 4 12.5C4 12.2239 4.22386 12 4.5 12L7.5 12C7.77614 12 8 12.2239 8 12.5Z"})),h=n("vZDh"),b="small.svg",g="medium.svg",v="large.svg";function y(e){var t={pages:[{displayGroupsAsAccordion:!1,groups:[]}]},n=S(e);return t.pages[0].groups.push({groupFields:[n]}),t}function S(e,t){void 0===t&&(t=!1);var n={width:32,height:32},o=[{key:r.r.SmallCard,checked:e===r.r.SmallCard,imageSize:n,text:h.a,imageSrc:b,themableSvg:D(b,t)}];Object(i.c)()&&o.push({key:r.r.MediumCard,checked:e===r.r.MediumCard,imageSize:n,text:h.t,imageSrc:g,themableSvg:D(g,t)}),o.push({key:r.r.LargeCard,checked:e===r.r.LargeCard,imageSize:n,text:h.e,imageSrc:v,themableSvg:D(v,t)});var s={label:h.n,options:o};return Object(a.PropertyPaneChoiceGroup)("layout",s)}function D(e,t){if(void 0===t&&(t=!1),t)return function(e){switch(e){case b:return p;case g:return m;case v:return _;default:return}}(e);if(!Object(i.d)())return function(e){switch(e){case b:return l;case g:return u;case v:return f;default:return}}(e);switch(e){case b:return s;case g:return c;case v:return d;default:return}}},"+wm6":function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("y88i"),s=n("5pbq"),c=n("hiL/"),d=n("2q6Q"),l=n("U4ag"),u=n("7Awa"),f=n("UWqr"),p=n("ut3N"),m=n("br4S"),_=n("vlQI"),h=n("Pk8u"),b=n("X+PM"),g=n("mFOl"),v=function(){function e(e){var t=this;e.whenFinished(function(){Object(g.e)()&&!Object(g.i)()?t._graphFactory=e.consume(_.MSGraphClientFactory.serviceKey):t._graphHttpClient=e.consume(_._DEPRECATED_DO_NOT_USE_GraphHttpClient.serviceKey)}),this._sendBatchRequestDebounce=Object(h.debounce)(this._sendBatchRequest,1e3)}return e._trimStart=function(e,t){return 0===e.indexOf(t)?e.substr(t.length):e},e.prototype.get=function(t){var n=this;return new Promise(function(a,i){n._requests||(n._requests=[]),n._requests.push({method:"GET",url:e._trimStart(t,"v1.0"),attemptCount:1,resolve:a,reject:i}),20===n._requests.length?n._flush():n._sendBatchRequestDebounce()})},e.prototype.cancel=function(){this._sendBatchRequestDebounce.cancel()},e.prototype._sendBatchRequest=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,r,o=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!this._requests)return[2];e=this._requests,this._requests=void 0,a.label=1;case 1:return a.trys.push([1,5,,6]),!Object(g.e)()||Object(g.i)()?[3,2]:(n=this._getMSGraphClientAsync().then(function(t){return t.api("$batch").headers({Accept:"application/json","Content-Type":"application/json","X-PeopleQuery-QuerySources":"Mailbox,Directory"}).post(JSON.stringify({requests:e.map(function(e,t){return{id:t,method:e.method,url:e.url}})}))}),[3,4]);case 2:return[4,this._graphHttpClient.post("v1.0/$batch",_._DEPRECATED_DO_NOT_USE_GraphHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json","X-PeopleQuery-QuerySources":"Mailbox,Directory"},body:JSON.stringify({requests:e.map(function(e,t){return{id:t,method:e.method,url:e.url}})})})];case 3:t=a.sent(),a.label=4;case 4:return[3,6];case 5:return i=a.sent(),e.forEach(function(e){return e.reject(i)}),[2];case 6:if((!Object(g.e)()||Object(g.i)())&&!t.ok)return e.forEach(function(e){return e.resolve(t)}),[2];a.label=7;case 7:return a.trys.push([7,12,,13]),!Object(g.e)()||Object(g.i)()?[3,9]:[4,n];case 8:return a.sent().responses.sort(function(e,t){return Number(e.id)-Number(t.id)}).forEach(function(t,n){var a=e[n];429===t.status&&a.attemptCount<3?o._retry(a,t):o._resolve(a,t,void 0)}),[3,11];case 9:return[4,t.json()];case 10:a.sent().responses.sort(function(e,t){return Number(e.id)-Number(t.id)}).forEach(function(n,a){var i=e[a];429===n.status&&i.attemptCount<3?o._retry(i,n):o._resolve(i,n,f.Guid.tryParse(t.headers.get("request-id")))}),a.label=11;case 11:return[3,13];case 12:return r=a.sent(),e.forEach(function(e){return e.reject(r)}),[2];case 13:return[2]}})})},e.prototype._flush=function(){this._sendBatchRequest().catch(function(){})},e.prototype._retry=function(e,t){var n=this,i=t.headers?Number(t.headers["Retry-After"]):1;setTimeout(function(){n._requests||(n._requests=[]),n._requests.push(Object(a.__assign)(Object(a.__assign)({},e),{attemptCount:e.attemptCount+1})),20===n._requests.length?n._flush():n._sendBatchRequestDebounce()},1e3*i)},e.prototype._resolve=function(e,t,n){e.resolve(new _._DEPRECATED_DO_NOT_USE_GraphHttpClientResponse(new Response(JSON.stringify(t.body),Object(a.__assign)(Object(a.__assign)({},t),{headers:Object(a.__assign)(Object(a.__assign)({},t.headers),{"request-id":(n||"").toString()})}))))},e.prototype._getMSGraphClientAsync=function(){return this._msGraphClientPromise||(this._msGraphClientPromise=this._graphFactory.getClientInternal("3")),this._msGraphClientPromise},e.serviceKey=f.ServiceKey.create("PeopleWebPart.GraphHttpClientBatch",e),e}(),y=function(){function e(e){this._pageContext=e.consume(b.PageContext.serviceKey),this._spHttpClient=e.consume(_.SPHttpClient.serviceKey),this._graphHttpClientBatch=e.consume(v.serviceKey)}return e.prototype.getPeopleInfo=function(e){return this._getPeopleInfo(e).catch(function(e){throw void 0!==e&&e.message&&(e.message=e.message.replace(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi,"PIIInfo")),e})},e.prototype._getPeopleInfo=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){return t=e.id,this._startsWith(t,"i:0#.f|membership|")?[2,this._getPeopleInfoByUserPrincipalName(t)]:this._endsWith(t,".onmicrosoft.com")?[2,this._getPeopleInfoByUserPrincipalName("i:0#.f|membership|".concat(t))]:this._contains(t,"@")&&this._contains(t.substr(0,t.indexOf("@")),".")?[2,this._getPeopleInfoBySearchPeople(t)]:this._contains(t,"@")?[2,this._getPeopleInfoByAliasEmail(t)]:[2,this._getPeopleInfoBySearchPeople(t)]})})},e.prototype._getPeopleInfoByUserPrincipalName=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s,d,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e._spHttpClientBatchGet||(n=this._spHttpClient.beginBatch(),i=Object(h.debounce)(function(){e._spHttpClientBatchGet=void 0,n.execute().catch(function(e){return p._TraceLogger.logError(p._LogSource.create("PeopleWebPart"),e,"GetPeopleInfoByUserPrincipalName")})},1e3),e._spHttpClientBatchGet=function(e){var t=n.get(e,_.SPHttpClientBatch.configurations.v1);return i(),t}),r="".concat(this._pageContext.web.absoluteUrl,"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(AccountName=@v)?@v='").concat(encodeURIComponent(t),"'&$select=AccountName,DisplayName,Email,Title"),[4,e._spHttpClientBatchGet(r)];case 1:if(o=a.sent(),s=o.correlationId?o.correlationId.toString():"Unknown",!o.ok)throw new c.UnexpectedFailure("RequestFailed",new Error("The request is failed for user principal name ".concat(t,".")),{correlationId:s,status:o.status});return[4,o.json()];case 2:if((d=a.sent())["@odata.null"])throw new c.ExpectedFailure("NoProfileReturned",new Error("No person returned for user principal name ".concat(t,".")),{correlationId:s});return l=d.UserProfileProperties?d.UserProfileProperties.reduce(function(e,t){var n;return Object(h.extend)(e,((n={})[t.Key]=t.Value,n))},{}):{},[2,{id:d.AccountName,name:d.DisplayName||"",email:d.Email||"",role:d.Title||"",firstName:l.FirstName||"",lastName:l.LastName||"",upn:l["SPS-UserPrincipalName"]||"",phone:l.WorkPhone||"",sip:l["SPS-SipAddress"]||"",department:l.Department||""}]}})})},e.prototype._getPeopleInfoBySearchPeople=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t='v1.0/me/people?$search="'.concat(encodeURIComponent(e),'"&$top=1&$select=userPrincipalName,displayName,jobTitle,department,scoredEmailAddresses,personType'),[4,this._graphHttpClientBatch.get(t)];case 1:return n=a.sent(),i=f.Guid.tryParse(n.headers.get("request-id"))?f.Guid.tryParse(n.headers.get("request-id")).toString():"Unknown",n.ok?[3,3]:[4,this._getErrorMessage(n)];case 2:throw r=a.sent(),new c.UnexpectedFailure("RequestFailed",new Error("The request is failed for query string ".concat(e,". Error message: ").concat(r)),{correlationId:i,status:n.status});case 3:return[4,n.json()];case 4:if(0===(o=a.sent()).value.length)throw new c.ExpectedFailure("NoProfileReturned",new Error("No person returned for query string ".concat(e,".")),{correlationId:i});return[2,{id:(s=o.value[0]).userPrincipalName||s.scoredEmailAddresses[0].address,name:s.displayName||"",email:s.scoredEmailAddresses[0].address,role:s.jobTitle||"",department:s.department||"",aadObjectId:(null==s?void 0:s.id)||""}]}})})},e.prototype._getPeopleInfoByAliasEmail=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t="v1.0/users/".concat(e),[4,this._graphHttpClientBatch.get(t)];case 1:return n=a.sent(),i=f.Guid.tryParse(n.headers.get("request-id"))?f.Guid.tryParse(n.headers.get("request-id")).toString():"Unknown",n.ok?[3,3]:[4,this._getErrorMessage(n)];case 2:throw r=a.sent(),new c.UnexpectedFailure("RequestFailed",new Error("The request is failed for alias email ".concat(e,". Error message: ").concat(r)),{correlationId:i,status:n.status});case 3:return[4,n.json()];case 4:return[2,{id:(o=a.sent()).userPrincipalName,name:o.displayName||"",email:o.mail||"",role:o.jobTitle||"",aadObjectId:o.id||""}]}})})},e.prototype._getErrorMessage=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.json()];case 1:return[2,t.sent().error.message];case 2:return t.sent(),[2,"N/A"];case 3:return[2]}})})},e.prototype._startsWith=function(e,t){return 0===e.indexOf(t)},e.prototype._endsWith=function(e,t){return e.indexOf(t)+t.length===e.length},e.prototype._contains=function(e,t){return-1!==e.indexOf(t)},Object(a.__decorate)([s.autobind,Object(c.monitor)("PeopleDataProvider.GetPeopleInfo")],e.prototype,"getPeopleInfo",null),Object(a.__decorate)([Object(c.monitor)("PeopleDataProvider.GetPeopleInfoByUserPrincipalName")],e.prototype,"_getPeopleInfoByUserPrincipalName",null),Object(a.__decorate)([Object(c.monitor)("PeopleDataProvider.GetPeopleInfoBySearchPeople")],e.prototype,"_getPeopleInfoBySearchPeople",null),Object(a.__decorate)([Object(c.monitor)("PeopleDataProvider.GetPeopleInfoByAliasEmail")],e.prototype,"_getPeopleInfoByAliasEmail",null),e}();function S(e){var t,n,i=e.theme,r=i.effects,o=i.palette,s=i.semanticColors;return{root:Object(a.__assign)({borderColor:"transparent",borderRadius:r.roundedCorner4,color:o.neutralPrimaryAlt},("transparent",t=r.roundedCorner4,n=s.focusBorder,{".ms-Fabric--isFocusVisible &:focus::after":{border:"1px solid ".concat("transparent"),borderRadius:t,inset:"0",outline:"2px solid ".concat(n)}})),rootHovered:{backgroundColor:o.neutralLighter,borderColor:o.neutralLighter,color:s.buttonTextHovered},rootPressed:{backgroundColor:s.buttonBackgroundPressed,borderColor:s.buttonBackgroundPressed,color:s.buttonTextPressed},rootDisabled:{backgroundColor:"transparent",borderColor:"transparent",color:s.buttonTextDisabled}}}var D=n("6mGg"),I=n("jOlS");I.loadStyles('.w_f_a3a8085b{color:"[theme:neutralPrimary, default: #323130]";font-weight:400;line-height:17px;overflow-wrap:anywhere!important;white-space:pre-wrap;word-break:normal!important}.ai_f_a3a8085b{height:80px;padding:0}.aj_f_a3a8085b{height:35px;padding:0}',!0);var x="w_f_a3a8085b",C=n("yRoY"),O=255,w=function(e){function t(t){var n=e.call(this,t)||this;return n._handleChangeValue=function(e,t){var a=t||"";n.setState({value:a}),n.props.onChangeDescription(a)},n._handleKeyDown=function(e){if(n.props.isEditMode&&"TEXTAREA"===e.target.tagName){var t=e.target,a=t.value.length,i=t.selectionStart!==t.selectionEnd;switch(e.which){case s.KeyCodes.left:case s.KeyCodes.up:(i||0!==a&&0!==t.selectionStart)&&e.stopPropagation();break;case s.KeyCodes.right:case s.KeyCodes.down:(i||0!==a&&t.selectionStart!==a)&&e.stopPropagation();break;case s.KeyCodes.enter:e.preventDefault();break;case s.KeyCodes.del:case s.KeyCodes.home:case s.KeyCodes.end:e.stopPropagation()}}},n.state={value:n.props.content,limit:n._maxCharCount,invalid:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isEditMode||d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","PeopleDescription.Mount",p._LogType.Event,{characterLength:this.props.content.length.toString(),UICulture:this.props.uiCulture||""})),this.props.isEditMode&&this.setState({limit:0===this.props.descriptionSize?50:O})},t.prototype.componentWillUnmount=function(){this.setState({limit:0===this.props.descriptionSize?50:O})},t.prototype.componentDidUpdate=function(){this.setState({limit:0===this.props.descriptionSize?50:O})},t.prototype.render=function(){var e=Boolean(this.props.content),t=o.StringHelper.format(C.e,e?C.n:0===this.props.descriptionSize?C.o:C.r,this._descCharMaxCountHint);return this.props.isEditMode?i.createElement(s.TextField,{ariaLabel:t,borderless:!0,className:Object(s.css)(x,this.props.className),"data-automation-id":"peopleDescriptionTextField",deferredValidationTime:500,description:this.state.invalid?void 0:this._getDescription(this.state.value),inputClassName:0===this.props.descriptionSize?"aj_f_a3a8085b":"ai_f_a3a8085b",multiline:!0,onChange:this._handleChangeValue,onKeyDown:this._handleKeyDown,placeholder:0===this.props.descriptionSize?C.o:C.r,resizable:!1,errorMessage:this.state.invalid?this._errorStr:void 0,value:this._setValidStringLength(this.state.value),autoAdjustHeight:!1,maxLength:this._maxCharCount,rows:this.props.lines}):e&&i.createElement("div",{className:this.props.className,"data-automation-id":"peopleDescriptionViewMode"},i.createElement(l.LessText,{className:x,"data-automation-id":"peopleDescriptionLessText",lines:this.props.lines,omission:this.props.omission,onAfterTruncate:this.props.onAfterTruncate,autoShowTitle:!0,text:this._setValidStringLength(this.state.value)}))},Object.defineProperty(t.prototype,"_errorStr",{get:function(){return o.StringHelper.format(C.t,this.state.value.length,this._descCharMaxCountHint)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_descCharMaxCountHint",{get:function(){return o.StringHelper.formatWithLocalizedCountValue(C.a,C.i,this._maxCharCount)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_maxCharCount",{get:function(){return 0===this.props.descriptionSize?50:O},enumerable:!1,configurable:!0}),t.prototype._getDescription=function(e){return o.StringHelper.format(C.t,e.length,this._descCharMaxCountHint)},t.prototype._setValidStringLength=function(e){return 0===this.props.descriptionSize?e.substring(0,50):e},Object(a.__decorate)([s.autobind],t.prototype,"_getDescription",null),t}(i.PureComponent),E=n("u2MZ"),A=n("G0QY"),L=n("T+ck"),k=function(e){function t(n){var a=e.call(this,n)||this;return a.state={contactCard:void 0},"ContactCard"===t.getHoverCardType()&&t.importContactCard().then(function(e){a.setState({contactCard:e})}).catch(function(){}),a}return Object(a.__extends)(t,e),t.getHoverCardType=function(){return this._isLivePersonaCardFlightEnabled()||f._BrowserUtilities.isMobileWebView()?"LivePersonaCard":"ContactCard"},t.importContactCard=function(){if(!t._contactCardBundle){var e=new d._QosMonitor("PeopleWebPart.ContactCard");t._contactCardBundle=n.e(4).then(n.bind(null,"Q7jw")).then(function(t){return e.writeSuccess(),t.ContactCard}).catch(function(t){throw e.writeUnexpectedFailure("BundleLoadFailure",t),t})}return t._contactCardBundle},t._isLivePersonaCardFlightEnabled=function(){return f._SPFlight.isEnabled(809)},t.prototype.render=function(){var e,n=this.props.person.email||this.props.person.upn||"";if(this.props.isDisabled)return i.Children.only(this.props.children);var a=this.props.layout===E.r.SmallCard?{host:{flex:"1 1 auto",minWidth:"0",display:"flex"}}:{host:{margin:"auto",alignSelf:"center"}};switch(t.getHoverCardType()){case"LivePersonaCard":var r=Object(s.css)(((e={})[L.e.persona]=this.props.layout===E.r.SmallCard,e[L.e.personaCoin]=this.props.layout===E.r.LargeCard,e[L.e.hoverCard]=!this.props.isDisabled,e)),c=Object(g.o)()?o.StringHelper.format(A.e,this.props.person.name,this.props.person.role):void 0;return i.createElement(l.LivePersonaCard,{ariaLabel:c,className:r,clientScenario:"PeopleWebPart",disableHover:this.props.isEditMode,hostAppPersonaInfo:{PersonaType:"User",PersonaCoinName:this.props.person.name},displayName:this.props.person.name,serviceScope:this.props.serviceScope,legacyUpn:n,onCardOpen:this.props.onCardOpen,onCardClose:this.props.onCardClose},this.props.children);case"ContactCard":return this.state.contactCard?i.createElement(this.state.contactCard,{person:this.props.person,styles:a,onCardOpen:this.props.onCardOpen,onCardClose:this.props.onCardClose},this.props.children):i.Children.only(this.props.children);default:return i.Children.only(this.props.children)}},t}(i.Component),M=n("I6O9"),P=function(){function e(){}return e.loadPagePicker=function(){return e.loadModule().then(function(e){return e.PagePicker})},e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=M.SPComponentLoader.loadComponentById("e795d530-8fb6-425c-b864-b86735dbae1d")),e._loadedModulePromise},e}();I.loadStyles(".an_h_a3a8085b{border:0;font-size:12px;height:auto;max-width:100%;padding:0}.an_h_a3a8085b .ms-Button-label{font-weight:400;line-height:17px;margin:0;overflow:hidden;text-align:left;text-overflow:ellipsis}.an_h_a3a8085b .ms-Button-icon{font-size:12px;margin:0}[dir=ltr] .an_h_a3a8085b .ms-Button-icon{margin-right:8px}[dir=rtl] .an_h_a3a8085b .ms-Button-icon{margin-left:8px}.an_h_a3a8085b .ms-Button-flexContainer{justify-content:flex-start}.an_h_a3a8085b,.an_h_a3a8085b:active,.an_h_a3a8085b:focus,.an_h_a3a8085b:hover{background-color:transparent;outline:0}.ao_h_a3a8085b{display:inline-block;font-size:12px;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}",!0);var T,U="ao_h_a3a8085b",F=n("/SYW"),H=function(e){function t(t){var n=e.call(this,t)||this;return n._openPagePicker=function(){d._EngagementLogger.logEvent("PeopleWebPart.PeopleLink.OpenPagePicker"),n._getPagePicker().then(function(e){e.open({title:n.state.linkName,url:n.state.linkUrl})}).catch(function(e){p._TraceLogger.logError(p._LogSource.create("PeopleWebPart"),e,"GetPagePicker")})},n._logOpenLink=function(){d._EngagementLogger.logEvent("PeopleWebPart.PeopleLink.OpenLink")},n.state={linkName:t.linkName,linkUrl:t.linkUrl},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.state.linkName||this.state.linkUrl,n=Boolean(t),a=(this.props,{linkButton:{selectors:{"& .ms-Button-label":{color:(e=Object(s.getTheme)()).semanticColors.actionLink},"&:hover .ms-Button-label, &:focus .ms-Button-label, &:active .ms-Button-label":{color:e.semanticColors.actionLinkHovered+" !important"},"& .ms-Button-icon":{color:e.semanticColors.link},"&:hover .ms-Button-icon, &:focus .ms-Button-icon, &:active .ms-Button-icon":{color:e.semanticColors.linkHovered+" !important"}}},link:{color:e.semanticColors.link,selectors:{"&:hover, &:focus, &:active":{color:e.semanticColors.linkHovered}}}});return this.props.isEditMode?this._renderEditModeButton(t,a):n&&i.createElement(s.Link,{className:Object(s.mergeStyles)(U,a.link),"data-automation-id":"peopleLinkText",href:this.state.linkUrl,target:"_blank",onClick:this._logOpenLink},t)},t.prototype._getPagePicker=function(){var e=this;if(!this._pagePickerPromise){var t=new d._QosMonitor("PeopleWebPart.PeopleLink.InitializePagePicker");this._pagePickerPromise=P.loadPagePicker().then(function(n){return t.writeSuccess(),new n({compact:!0,onSelect:e._handleChangeLink,onUnlink:e._handleChangeLink,serviceScope:e.props.serviceScope})}).catch(function(e){return t.writeUnexpectedFailure("PeopleWebPart.PeopleLink.InitializePagePicker",e),Promise.reject(e)})}return this._pagePickerPromise},t.prototype._handleChangeLink=function(e){void 0===e&&(e={title:"",url:""}),d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","PeopleLink.ChangeLink",p._LogType.Event,{urlLength:e.url.length.toString()})),this.props.onChangeLink(e),this.setState({linkName:e.title,linkUrl:e.url})},t.prototype._renderEditModeButton=function(e,t){return e?i.createElement(s.Link,{className:Object(s.mergeStyles)(U,t.link),"data-automation-id":"peopleLinkEditButton",onClick:this._openPagePicker,title:F.t},e):i.createElement(s.ActionButton,{className:Object(s.mergeStyles)("an_h_a3a8085b",t.linkButton),"data-automation-id":"peopleLinkEditButton",iconProps:{iconName:"CalculatorAddition"},onClick:this._openPagePicker,text:F.e})},Object(a.__decorate)([s.autobind],t.prototype,"_getPagePicker",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleChangeLink",null),t}(i.PureComponent),R=n("Jf8c"),N=n("YDsL"),B=n("E8te"),j=function(e){function t(t){var n=e.call(this,t)||this;return n._focusZoneRef=i.createRef(),n._hoverTarget=null,n._restoreFocusToCard=!1,n._hasLoggedSeeMoreButton=!1,n._isSeeLessStateLogged=!1,n._UICulture=n.props.serviceScope.consume(b.PageContext.serviceKey).cultureInfo.currentUICultureName,n._onFocusNotification=function(){n.setState({isFocusedIn:!0})},n._onBlur=function(){n.setState({isFocusedIn:!1})},n._onCancelClick=function(){n.props.onDeletePerson("Mouse")},n._renderPersonaCoin=function(e,t,o){var c=n.props.layout!==E.r.SmallCard,d=!0,l=f.Text.format(N.c,n.props.person.name,N.r);Object(g.l)()||(d=c);var u=Object(s.mergeStyles)(!c&&L.e.hoverCard,L.e.personaCoin,t.photo,L.e.personaCoinFocusBorder);return i.createElement(s.PersonaCoin,Object(a.__assign)({},o,{"aria-label":d?l:void 0,coinProps:{className:u},tabIndex:-1,size:n._isMediumLayout(n.props.layout)?R.e:n.props.personaSize,imageUrl:e,imageShouldStartVisible:!0,text:n.props.person.name,componentRef:n.props.layout===E.r.LargeCard?function(e){return n._hoverTarget=r.findDOMNode(e)}:void 0}))},n._handleClickSeeMoreButton=function(){n.setState(function(e){return{isDescriptionExpanded:!e.isDescriptionExpanded}}),n.focus()},n._handleDescriptionTruncate=function(e){n.setState({isDescriptionTruncated:e}),n._hasLoggedSeeMoreButton||(n.props.serviceScope.whenFinished(function(){d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","PeopleCard.DisplaySeeMoreButton",p._LogType.Event,{characterLength:(n.props.person.description||"").length.toString(),hasSeeMore:e.toString(),UICulture:n._UICulture}))}),n._hasLoggedSeeMoreButton=!0),!n._isSeeLessStateLogged&&n.state.isDescriptionExpanded&&(n.props.serviceScope.whenFinished(function(){d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","PeopleCard.SeeLessState",p._LogType.Event,{characterLength:(n.props.person.description||"").length.toString(),isTruncated:e.toString(),UICulture:n._UICulture}))}),n._isSeeLessStateLogged=!0)},n._handleKeyDown=function(e){e.which===s.KeyCodes.enter&&n._hoverTarget&&e.target===r.findDOMNode(n._focusZoneRef.current)&&(n._restoreFocusToCard=!0,n._hoverTarget.click(),e.stopPropagation()),n.props.isEditMode&&e.which===s.KeyCodes.del&&(n.props.onDeletePerson("Keyboard"),e.stopPropagation())},n.state={isDescriptionExpanded:!1,isDescriptionTruncated:!1,isFocusedIn:!1},n}return Object(a.__extends)(t,e),t.prototype.focus=function(){this._focusZoneRef&&this._focusZoneRef.current&&this._focusZoneRef.current.focus()},t.prototype.componentDidMount=function(){var e=r.findDOMNode(this._focusZoneRef.current);if(e instanceof Element){var t=o.StringHelper.format(N.s,this.props.person.name,this.props.person.role,this.props.layout===E.r.LargeCard&&this.props.person.description||"",N.r,this.props.isEditMode?"left-right"===this.props.arrowKeyToInside?N.a:N.i:"");e.setAttribute("aria-label",t)}},t.prototype.render=function(){var e=Object(B.e)({isEditMode:this.props.isEditMode,isFocusWithin:this.state.isFocusedIn,layout:this.props.layout,variantTheme:this.props.variantTheme,width:this.props.width}),t=this.props.layout===E.r.SmallCard,n=this.props.layout===E.r.LargeCard,a=Object(s.mergeStyles)(L.e.card,e.card,t&&L.e.compactLayout,this._isMediumLayout(this.props.layout)&&L.e.mediumLayout,n&&L.e.largeLayout,this.state.isDescriptionExpanded&&!this.props.isEditMode&&L.e.hidePersona,Object(g.s)()?void 0:L.e.cardFocusIndicatorImprovedContrastRatio),r="up-down"===this.props.arrowKeyToInside?s.FocusZoneDirection.vertical:s.FocusZoneDirection.horizontal;return i.createElement(s.FocusZone,{className:a,componentRef:this._focusZoneRef,direction:r,isCircularNavigation:!0,onKeyDown:this._handleKeyDown,onFocusNotification:this._onFocusNotification,onBlur:this._onBlur,"data-is-focusable":!0,"data-drag-tag":"grid-layout-drag-leaf","data-automation-id":"people-card","data-layout":t?"compactLayout":"largeLayout",role:"listitem"},this._renderPeoplePersona(t,e),this.props.isEditMode&&this._renderButtons(e),!t&&this._renderPeopleDescription(),this._renderSeeMoreButton())},t.prototype._renderButtons=function(e){var t=this.props.layout===E.r.SmallCard&&this.props.variantTheme?this.props.variantTheme:Object(s.getTheme)(),n=Object(s.mergeStyles)(L.e.buttons,e.buttons);return i.createElement("div",{className:n},i.createElement(s.IconButton,{iconProps:{iconName:"Cancel"},className:L.e.deleteButton,"data-automation-id":"peopleCardDeleteButton",title:N.t,onClick:this._onCancelClick,theme:t}),i.createElement(s.IconButton,{iconProps:{iconName:"Move"},className:L.e.dragAndDropButton,title:N.n,theme:t,"data-drag-handle":"grid-layout-drag-handler"}))},t.prototype._renderPeopleDescription=function(){var e=this.state.isDescriptionExpanded&&this.state.isDescriptionTruncated?"…":"​";return i.createElement(w,{descriptionSize:this._isMediumLayout(this.props.layout)?0:1,className:this._isMediumLayout(this.props.layout)&&Object(g.r)()?L.e.descriptionLegacy:L.e.description,content:this.props.person.description||"",isEditMode:this.props.isEditMode,lines:this._getDescriptionLines(this.props.layout),omission:e,onChangeDescription:this.props.onChangeDescription,onAfterTruncate:this._handleDescriptionTruncate,uiCulture:this._UICulture})},t.prototype._renderSeeMoreButton=function(){var e=f.Text.format(this.state.isDescriptionExpanded?N.d:N.u,this.props.person.name);return!this.props.isEditMode&&!this._isMediumLayout(this.props.layout)&&(this.state.isDescriptionExpanded||this.state.isDescriptionTruncated)&&i.createElement("div",{className:L.e.seeMoreButton},i.createElement(s.IconButton,{ariaLabel:e,onClick:this._handleClickSeeMoreButton,iconProps:{iconName:this.state.isDescriptionExpanded?"ChevronDown":"ChevronUp"},title:this.state.isDescriptionExpanded?N.l:N.f}))},t.prototype._handleCardOpen=function(){c.ScreenReaderAlert.read(f.Text.format(N.o,this.props.person.name),c.ReadingMode.ReadImmediately),d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","PeopleCard.OpenHoverCard",p._LogType.Event,{isEditMode:this.props.isEditMode.toString(),hoverCardType:k.getHoverCardType()}))},t.prototype._handleCardClose=function(){c.ScreenReaderAlert.read(f.Text.format(N.e,this.props.person.name),c.ReadingMode.ReadImmediately),d._EngagementLogger.logEvent("PeopleWebPart.PeopleCard.CloseHoverCard"),this._restoreFocusToCard&&(this._restoreFocusToCard=!1,setTimeout(this.focus))},t.prototype._renderPeoplePersona=function(e,t){var n=this,r={isEditMode:this.props.isEditMode,layout:this.props.layout,onCardOpen:this._handleCardOpen,onCardClose:this._handleCardClose,person:this.props.person,serviceScope:this.props.serviceScope},o=e,c=!e,d=Object(E.c)(this.props.person.email,this.props.layout),u=Object(s.mergeStyles)(this._isMediumLayout(this.props.layout)&&Object(g.r)()?L.e.primaryTextLegacy:L.e.primaryText,t.primaryText,L.e.fluent),f=Object(s.mergeStyles)(this._isMediumLayout(this.props.layout)&&Object(g.r)()?L.e.secondaryTextLegacy:L.e.secondaryText,t.secondaryText,L.e.fluent);return i.createElement(k,Object(a.__assign)({},r,{isDisabled:!o}),i.createElement("div",{className:Object(s.mergeStyles)(L.e.persona,o&&L.e.hoverCard),tabIndex:-1,ref:o?function(e){return n._hoverTarget=e}:void 0},i.createElement(k,Object(a.__assign)({},r,{isDisabled:!c}),i.createElement(l.DoughboyDetector,{imageUrl:d,imageProps:t,renderImage:this._renderPersonaCoin,onDetectCompleted:this.props.onRenderCompleted,disableDelayDetect:!0})),i.createElement("div",{className:L.e.personaDetails},i.createElement("div",{className:u,title:this.props.person.name},this.props.person.name),i.createElement("div",{className:f,title:this.props.person.role},this.props.person.role||(e?"":" ")),!e&&this._renderPeopleLink())))},t.prototype._renderPeopleLink=function(){return i.createElement(H,{isEditMode:this.props.isEditMode,linkName:this.props.person.linkName||"",linkUrl:this.props.person.linkUrl||"",onChangeLink:this.props.onChangeLink,serviceScope:this.props.serviceScope})},t.prototype._isMediumLayout=function(e){return e===E.r.MediumCard},t.prototype._getDescriptionLines=function(e){if(this._isMediumLayout(e))return 2;if(this.state.isDescriptionExpanded){var t=E.t-Math.ceil((E.i-this.props.width)/16*9)-E.n-E.a;return Math.floor(t/E.e)}return this.state.isDescriptionTruncated?4:5},Object(a.__decorate)([s.autobind],t.prototype,"focus",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleCardOpen",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleCardClose",null),t}(i.PureComponent),V=n("clF1"),z=function(e){function t(t){var n=e.call(this,t)||this;n._focusIndex=void 0,n._focusZone=null,n._placeholderRef=i.createRef(),n._peopleCardList=[],n._peopleRenderPromiseResolver=[],n._renderPeopleItem=function(e,t){var a=n.props.layout===E.r.SmallCard?s.PersonaSize.regular:e.width<=243?s.PersonaSize.large:s.PersonaSize.extraLarge;return"placeholder"===e.item?n.state.peopleCardPlaceholderModule?i.createElement(n.state.peopleCardPlaceholderModule,{layout:n.props.layout,width:e.width,variantTheme:n.props.variantTheme,onAddPerson:n._handleAddPerson,personaSize:a,serviceScope:n.props.serviceScope,selectedPersons:n.props.selectedPersons,ref:n._placeholderRef}):i.createElement(i.Fragment,null):i.createElement(j,{isEditMode:n.props.isEditMode,layout:n.props.layout,serviceScope:n.props.serviceScope,person:e.item,personaSize:a,ref:function(a){return e.rootFocusRef(n._peopleCardList[t]=a)},width:e.width,variantTheme:n.props.variantTheme,arrowKeyToInside:e.isMultiItemPerRow?"up-down":"left-right",onMove:h.noop,onDeletePerson:function(e){return n._handleDeletePerson(t,e)},onChangeDescription:function(e){return n._handleChangeDescription(e,t)},onChangeLink:function(e){return n._handleChangeLink(t,e)},onRenderCompleted:function(){return n._handleRenderCompleted(t)}})},n._getGridLayoutAriaLabel=function(e,t){var a=o.StringHelper.formatWithLocalizedCountValue(t?V.i:V.o,V.r,n.props.selectedPersons.length),i=e?t?V.n:V.a:"";return o.StringHelper.format(V.t,a,i)},n._getPeopleKey=function(e){return"placeholder"===e?e:e.id},n._handleReorderPeopleItem=function(e,t){e<n.props.selectedPersons.length&&t<n.props.selectedPersons.length&&n.props.onChangeSelectedPersons(n._swapPerson(e,t))},n._handleAddPerson=function(e){var t=n.props.selectedPersons.concat([e]);n.props.onChangeSelectedPersons(t),n._focusIndex=t.length},n.state={peopleCardPlaceholderModule:void 0},n._peopleRenderPromiseResolver=[];var a=t.selectedPersons.map(function(e,t){return new Promise(function(e){return n._peopleRenderPromiseResolver[t]=e})});return Promise.all(a).then(t.onRenderCompleted).catch(function(e){p._TraceLogger.logError(p._LogSource.create("PeopleWebPart"),e,"ResolvePeopleRender")}),n.props.isEditMode&&n._loadCardPlaceholder().catch(function(e){p._TraceLogger.logError(p._LogSource.create("PeopleWebPart"),e,"LoadCardPlaceholderInConstructor")}),n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;if(this._listElement){var t=new p._QosMonitor("PeopleWall.createSortable");c.SortableLoader.GetSortable().then(function(n){e._sortable=n.create(e._listElement,{forceFallback:f._BrowserDetection.getBrowserInformation().browser!==f._Browser.Chrome,handle:".".concat(L.e.dragAndDropButton),onEnd:e._handleReorder,animation:200}),t.writeSuccess()}).catch(function(e){throw t.writeUnexpectedFailure(void 0,e),e})}},t.prototype.componentWillUnmount=function(){this._sortable&&this._sortable.destroy()},t.prototype.componentDidUpdate=function(){if(void 0!==this._focusIndex){if(this._focusIndex<this.props.selectedPersons.length){var e=this._peopleCardList[this._focusIndex];e&&e.focus()}else this._placeholderRef&&this._placeholderRef.current&&this._placeholderRef.current.focus();this._focusIndex=void 0}},t.prototype.UNSAFE_componentWillReceiveProps=function(e){!0===e.isEditMode&&void 0===this.state.peopleCardPlaceholderModule&&this._loadCardPlaceholder().catch(function(e){p._TraceLogger.logError(p._LogSource.create("PeopleWebPart"),e,"LoadCardPlaceholderWhenReceiveProps")})},t.prototype.render=function(){var e,t=this.props.isEditMode?Object(a.__spreadArray)(Object(a.__spreadArray)([],this.props.selectedPersons,!0),["placeholder"],!1):this.props.selectedPersons;return e=this.props.layout===E.r.SmallCard?10:this.props.layout===E.r.MediumCard?15:20,i.createElement(D.GridLayout,{width:this.props.width,items:t,onRenderItem:this._renderPeopleItem,displayMode:this.props.isEditMode?f.DisplayMode.Edit:f.DisplayMode.Read,getAriaLabel:this._getGridLayoutAriaLabel,getKey:this._getPeopleKey,onReorderItem:this._handleReorderPeopleItem,useSortable:!0,"data-automation-id":"people-list",verticalGutter:e})},t.prototype._loadCardPlaceholder=function(){var e=this;return n.e(3).then(n.bind(null,"6dH4")).then(function(t){e.setState({peopleCardPlaceholderModule:t.PeopleCardPlaceholder})})},t.prototype._handleRenderCompleted=function(e){this._peopleRenderPromiseResolver[e]&&this._peopleRenderPromiseResolver[e]()},t.prototype._handleChangeDescription=function(e,t){e.length<=O&&this.props.onChangeDescription(e,t)},t.prototype._handleChangeLink=function(e,t){this.props.onChangeLink(e,t)},t.prototype._handleDeletePerson=function(e,t){var n=this.props.selectedPersons[e];c.ScreenReaderAlert.read(o.StringHelper.format(V.e,n.name),c.ReadingMode.ReadImmediately);var i=Object(a.__spreadArray)([],this.props.selectedPersons,!0);i.splice(e,1),this.props.onChangeSelectedPersons(i),this._focusIndex=e<this.props.selectedPersons.length-1?e:Math.max(0,e-1),d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","PeopleWall.DeletePerson",p._LogType.Event,{method:t}))},t.prototype._handleReorder=function(e){var t=e.oldIndex,n=e.newIndex;if(t!==n){var a=this._listElement;if(void 0!==a&&a instanceof Element){var i=e.item,r=t<n?t:t+1,o=a.children.item(r);a.insertBefore(i,o),this.props.onChangeSelectedPersons(this._swapPerson(t,n));var s=i.querySelector("[data-is-focusable]");if(s){var c=document.createEvent("MouseEvent");c.initEvent("blur",!0,!0),s.dispatchEvent(c)}this._logReorderEvent("Mouse",!0)}else this._logReorderEvent("Mouse",!1)}},Object.defineProperty(t.prototype,"_listElement",{get:function(){return this._focusZone?r.findDOMNode(this._focusZone):void 0},enumerable:!1,configurable:!0}),t.prototype._swapPerson=function(e,t){var n=[].concat(this.props.selectedPersons);return n.splice(e,1),n.splice(t,0,this.props.selectedPersons[e]),c.ScreenReaderAlert.read(o.StringHelper.format(V.s,this.props.selectedPersons[e].name,t+1),c.ReadingMode.ReadImmediately),n},t.prototype._logReorderEvent=function(e,t){d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","PeopleWall.ReorderPersons",p._LogType.Event,{method:e,success:t.toString()}))},Object(a.__decorate)([s.autobind],t.prototype,"UNSAFE_componentWillReceiveProps",null),Object(a.__decorate)([s.autobind,Object(c.monitor)("PeopleWebPart.LoadCardPlaceHolder")],t.prototype,"_loadCardPlaceholder",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleChangeDescription",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleChangeLink",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleDeletePerson",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleReorder",null),t}(i.PureComponent),G=n("Ym2g"),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=i.createElement(s.Fabric,{className:Object(s.css)({"ms-people-edit":this.props.isEditMode})},i.createElement(l.WebPartTitle,{edit:this.props.isEditMode,title:this.props.title,placeholder:G.e,onTitleChange:this.props.onChangeTitle,marginBottomSize:"Large",theme:this.props.variantTheme}),i.createElement(z,{isEditMode:this.props.isEditMode,layout:this.props.layout,width:this.props.width,selectedPersons:this.props.selectedPersons,serviceScope:this.props.serviceScope,variantTheme:this.props.variantTheme,onChangeSelectedPersons:this.props.onChangeSelectedPersons,onChangeDescription:this.props.onChangeDescription,onChangeLink:this.props.onChangeLink,onRenderCompleted:this.props.renderCompleted})),t={};return Object(g.a)()&&(t={IconButton:{styles:S}}),i.createElement(i.Fragment,null,Object(g.a)()&&i.createElement(s.Customizer,{scopedSettings:t},e),!Object(g.a)()&&e)},t}(i.PureComponent),W=n("+mM2"),q=n("8Inl"),Q=((T={})[E.r.SmallCard]="Small",T[E.r.MediumCard]="Medium",T[E.r.LargeCard]="Large",T),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._countEngagementLogged=!1,t._handleThemeChangedEvent=function(e){t._variantTheme=e.theme,t.render()},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=i.createElement(K,{isEditMode:this.displayMode===f.DisplayMode.Edit,serviceScope:this.context.serviceScope,selectedPersons:this.properties.persons,layout:this.properties.layout,title:this.properties.title,width:this.width,variantTheme:this._variantTheme,onChangeTitle:this._handleChangeTitle,onChangeSelectedPersons:this._handleChangeSelectPersons,renderCompleted:this.renderCompleted,onChangeDescription:this._handleChangeDescription,onChangeLink:this._handleChangeLink});r.render(e,this.domElement)},t.prototype.getTopActionsConfiguration=function(){var e=this;if(Object(g.u)()&&!Object(g.d)())return{topActions:[Object(a.__assign)(Object(a.__assign)({},Object(l._topActionsFieldConverter)(Object(W.getLayoutField)(this.properties.layout,!0))),{title:q.c})],onExecute:function(t,n){d._EngagementLogger.logEvent("PeopleWebPart.TopActions.Click",t),e._onPropertyPaneFieldChanged(t,n)}}},t.prototype.onDispose=function(){e.prototype.onDispose.call(this),r.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(u.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent)},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return this.properties.persons&&this.properties.persons.length>0},enumerable:!1,configurable:!0}),t.prototype.onInit=function(){return this._initialLayout=this.properties.layout,this._peopleDataProvider=new y(this.context.serviceScope),this.context._dataUpdatedEvent.add(this,this._handleWebPartPropertiesUpdated),this._getSectionBackgroundTheme(),d._PerformanceLogger.markComponent(this.context.webPartTag,"".concat(d._PerformanceDataDimensions.Layout).concat(E.r[this.properties.layout])),e.prototype.onInit.call(this)},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return f.Version.parse("1.3")},enumerable:!1,configurable:!0}),t.prototype.onBeforeSerialize=function(){if(this.properties.persons.forEach(function(e){return delete e.imageUrl}),this._initialLayout!==this.properties.layout){var e=Q[this.properties.layout];d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","LayoutType",p._LogType.Event,{layout:e}))}},t.prototype.onAfterDeserialize=function(e,t){return t.lessThan(f.Version.parse("1.1"))&&(e.layout=E.r.SmallCard),e},t.prototype.onDisplayModeChanged=function(t){e.prototype.onDisplayModeChanged.call(this,t),t===f.DisplayMode.Edit&&this._logCountEngagement()},t.prototype.loadPropertyPaneResources=function(){var e=this;return Promise.resolve().then(n.bind(null,"+mM2")).then(function(t){e._getPeopleWebPartProperty=t.getPeoplePropertyPane})},t.prototype.getPropertyPaneConfiguration=function(){return this._getPeopleWebPartProperty?this._getPeopleWebPartProperty(this.properties.layout):(p._TraceLogger.logError(E.o,new Error("Fail to get people property pane config.")),e.prototype.getPropertyPaneConfiguration.call(this))},Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){var e,t=this.properties.title?o.StringHelper.format(q.s,this.properties.title):"",n=this.properties.persons?this.properties.persons.length:0,a=o.StringHelper.formatWithLocalizedCountValue(q.a,q.i,n);switch(this.properties.layout){case E.r.SmallCard:e=q.o;break;case E.r.MediumCard:e=q.n;break;case E.r.LargeCard:e=q.t;break;default:e=q.o}var i=o.StringHelper.format(q.r,e);return o.StringHelper.format(q.e,t,a,i)},enumerable:!1,configurable:!0}),t.prototype.onAfterResize=function(e){this.render()},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},"persons[*].name":{isSearchablePlainText:!0},"persons[*].email":{isSearchablePlainText:!0},"persons[*].description":{isSearchablePlainText:!0},"persons[*].linkUrl":{isLink:!0}}},enumerable:!1,configurable:!0}),t.prototype.renderCompleted=function(){var n=this;e.prototype.renderCompleted.call(this),this._refreshCache().then(function(){n.isDisposed||n.render()}).catch(function(e){p._TraceLogger.logError(t._logSource,e,"UpdateInfoAfterRenderCompleted")})},t.prototype._handleChangeTitle=function(e){this.properties.title=e,this.render()},t.prototype._handleChangeSelectPersons=function(e){this.properties.persons=e,this.render()},t.prototype._handleChangeDescription=function(e,t){this.properties.persons[t].description=e},t.prototype._handleChangeLink=function(e,t){this.properties.persons[e].linkName=t.title,this.properties.persons[e].linkUrl=t.url},t.prototype._logCountEngagement=function(){var e=0,t=0;this.properties.persons&&this.properties.persons.forEach(function(n){n.linkUrl&&t++,n.description&&e++}),this._countEngagementLogged||this.displayMode!==f.DisplayMode.Read||(d._EngagementLogger.logEventWithLogEntry(new p._LogEntry("PeopleWebPart","CountOfPeople",p._LogType.Event,{count:String(this.properties.persons?this.properties.persons.length:0),LayoutName:E.r[this.properties.layout],PeopleWithDescription:e.toString(),PeopleWithLink:t.toString(),WebPartID:this.context.instanceId})),this._countEngagementLogged=!0)},t.prototype._handleWebPartPropertiesUpdated=function(){var e=this;this._refreshCache().then(function(){e.isDisposed||e.render()}).catch(function(e){p._TraceLogger.logError(t._logSource,e,"UpdateInfoAfterWebPartPropertiesUpdated")})},t.prototype._refreshCache=function(){var e=this,n=this.properties.persons.map(function(n,i){return Object(a.__awaiter)(e,void 0,void 0,function(){var e,r,o;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),e=this.properties.persons[i],[4,this._peopleDataProvider.getPeopleInfo(n)];case 1:return(r=s.sent()).linkName=e.linkName,r.linkUrl=e.linkUrl,r.description=e.description,Object(g.t)()||(r.role=e.role),(o=Object(a.__spreadArray)([],this.properties.persons,!0)).splice(i,1,r),this.properties.persons=o,p._TraceLogger.logVerbose(t._logSource,"Update people info succeed: ".concat(n.id),"UpdateCacheSucceed"),[3,3];case 2:return s.sent(),p._TraceLogger.logError(t._logSource,new Error("Update people info failed: ".concat(n.id)),"UpdateCacheFailed"),[3,3];case 3:return[2]}})})});return Promise.all(n).then(function(){})},t.prototype._getSectionBackgroundTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(u.ThemeProvider.serviceKey);e._variantTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},t._logSource=p._LogSource.create("PeopleWebPart"),Object(a.__decorate)([s.autobind],t.prototype,"onInit",null),Object(a.__decorate)([Object(c.monitor)("PeopleWebPart.LoadPropertyPane")],t.prototype,"loadPropertyPaneResources",null),Object(a.__decorate)([s.autobind],t.prototype,"onAfterResize",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleChangeTitle",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleChangeSelectPersons",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleChangeDescription",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleChangeLink",null),Object(a.__decorate)([s.autobind],t.prototype,"_logCountEngagement",null),Object(a.__decorate)([s.autobind],t.prototype,"_handleWebPartPropertiesUpdated",null),t}(m.BaseClientSideWebPart);t.default=Y},"/SYW":function(e){e.exports=JSON.parse('{"e":"Add a profile link","t":"Edit profile link"}')},"0iVW":function(e){e.exports=JSON.parse('{"t":"People profile input box. Add a profile by entering a name, alias, or email address.","e":"The profile for {0} has been added."}')},"17wl":function(e,t){e.exports=n},"2RB3":function(e){e.exports=JSON.parse('{"i":"Name or email address","t":"No results found","e":"Enter more characters","n":"{0}. The person selected is {1}. {2}.","a":"People profiles showing. Press up or down arrow keys to move between profile."}')},"2q6Q":function(e,t){e.exports=a},"5pbq":function(e,t){e.exports=i},"6mGg":function(e,t){e.exports=r},"7Awa":function(e,t){e.exports=o},"8Inl":function(e){e.exports=JSON.parse('{"s":"Title {0}.","a":"There are {0} people profiles yet.||There is {0} people profile.||There are {0} people profiles.","i":"0||1||2-","o":"Small","n":"Medium","t":"Large","r":"The layout of this web part is {0}.","e":"People web part. {0} {1} {2}","c":"Layout options"}')},E8te:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n("17wl"),i=n("5pbq"),r=n("mFOl"),o=n("u2MZ"),s=Math.random().toString().substr(2,5),c={keyboard:"ms-Fabric.is-focusVisible",notDrag:"sortable:not(.dragging)",editMode:"editMode-".concat(s),focusWithin:"focus-within-".concat(s),card:"card-".concat(s)};function d(e){var t,n,s,d,l,u=Object(i.getTheme)(),f=e.variantTheme,p={display:"none",selectors:(t={},t[[".".concat(c.keyboard," .").concat(c.card,":focus &"),".".concat(c.keyboard," .").concat(c.card,".").concat(c.focusWithin," &"),".".concat(c.notDrag," .").concat(c.card,".").concat(c.editMode,":hover &")].join(",")]={display:"flex",flexDirection:"column"},t)};switch(e.layout){case o.r.SmallCard:return{card:[c.card,e.isEditMode&&c.editMode,e.isFocusWithin&&c.focusWithin,{width:e.width,height:76,boxSizing:"border-box",border:"1px solid transparent",selectors:(n={},n[[".".concat(c.keyboard," &:focus"),"&.".concat(c.focusWithin,":focus"),".".concat(c.notDrag," &.").concat(c.editMode,":hover")].join(",")]={outline:void 0,outlineColor:void 0,borderColor:null==f?void 0:f.semanticColors.focusBorder,borderRadius:Object(r.a)()?u.effects.roundedCorner4:u.effects.roundedCorner2,boxShadow:u.effects.elevation4,backgroundColor:null==f?void 0:f.semanticColors.bodyBackground},n)}],photo:void 0,primaryText:[{color:null==f?void 0:f.semanticColors.actionLink,fontSize:u.fonts.medium.fontSize,fontWeight:600,selectors:(s={},s[[".".concat(c.keyboard," .").concat(c.card,":focus &"),".".concat(c.notDrag," .").concat(c.card,".").concat(c.editMode,":hover &")].join(",")]={color:null==f?void 0:f.semanticColors.actionLinkHovered},s)}],secondaryText:Object(a.__assign)({color:null==f?void 0:f.semanticColors.bodySubtext},u.fonts.small),buttons:[p,{alignSelf:"flex-start",justifyContent:"space-between"}]};case o.r.MediumCard:return{card:[c.card,e.isEditMode&&c.editMode,e.isFocusWithin&&c.focusWithin,{width:e.width,height:76,boxSizing:"border-box",backgroundColor:u.semanticColors.bodyBackground,outline:void 0,outlineColor:void 0,border:"1px solid",borderColor:null==f?void 0:f.semanticColors.variantBorder,borderRadius:Object(r.a)()?u.effects.roundedCorner4:u.effects.roundedCorner2,boxShadow:u.effects.elevation4,selectors:(d={},d[[".".concat(c.keyboard," &:focus"),"&.".concat(c.focusWithin,":focus"),".".concat(c.notDrag," &.").concat(c.editMode,":hover")].join(",")]={outline:void 0,outlineColor:void 0,borderColor:null==f?void 0:f.semanticColors.focusBorder,borderRadius:Object(r.a)()?u.effects.roundedCorner4:u.effects.roundedCorner2,boxShadow:u.effects.elevation8},d["&:hover"]={boxShadow:u.effects.elevation8},d)}],photo:void 0,primaryText:[{color:u.semanticColors.bodyText,fontSize:u.fonts.medium.fontSize,fontWeight:600}],secondaryText:Object(a.__assign)({color:null==u?void 0:u.semanticColors.bodySubtext},u.fonts.small),buttons:[p,{alignSelf:"flex-start",justifyContent:"space-between"}]};case o.r.LargeCard:return{card:[c.card,e.isEditMode&&c.editMode,e.isFocusWithin&&c.focusWithin,{width:e.width,maxWidth:o.i,height:o.t-Math.ceil((o.i-e.width)/16*9),boxSizing:"border-box",backgroundColor:u.semanticColors.bodyBackground,outline:void 0,outlineColor:void 0,border:"1px solid",borderColor:null==f?void 0:f.semanticColors.variantBorder,borderRadius:Object(r.a)()?u.effects.roundedCorner4:u.effects.roundedCorner2,boxShadow:u.effects.elevation4,selectors:(l={},l[[".".concat(c.keyboard," &:focus"),"&.".concat(c.focusWithin,":focus"),".".concat(c.notDrag," &.").concat(c.editMode,":hover")].join(",")]={outline:void 0,outlineColor:void 0,borderColor:null==f?void 0:f.semanticColors.focusBorder,borderRadius:Object(r.a)()?u.effects.roundedCorner4:u.effects.roundedCorner2},l["&:hover"]={boxShadow:u.effects.elevation8},l)}],photo:{selectors:{"&:focus":{outline:"none"}}},primaryText:{color:u.semanticColors.bodyText,fontSize:u.fonts.mediumPlus.fontSize,fontWeight:600},secondaryText:Object(a.__assign)({color:u.semanticColors.bodySubtext},u.fonts.medium),buttons:[p,{position:"absolute",right:0,top:0}]};default:return{card:void 0,photo:void 0,primaryText:void 0,secondaryText:void 0,buttons:void 0}}}},G0QY:function(e){e.exports=JSON.parse('{"e":"Opens Profile Card for {0}  {1}"}')},I6O9:function(e,t){e.exports=s},Jf8c:function(e,t,n){"use strict";n.d(t,"e",function(){return ot}),n.d(t,"t",function(){return st});var a={};n.r(a),n.d(a,"Default",function(){return _}),n.d(a,"Tenant",function(){return h}),n.d(a,"Hub",function(){return b}),n.d(a,"Site",function(){return g});var i,r,o,s=n("17wl"),c=n("cDcd"),d=n("y88i"),l=n("5pbq"),u=n("hiL/"),f=n("UWqr");!function(e){e[e.regularUser=0]="regularUser",e[e.externalUser=1]="externalUser",e[e.group=2]="group",e[e.application=3]="application",e[e.linkedinUser=4]="linkedinUser"}(i||(i={})),function(e){e.graph="graph",e.sharepointSearch="sharepointSearch",e.substrate="substrate"}(r||(r={})),function(e){e.unified="unifiedGroup",e.securityGroup="securityGroup",e.SPGroup="SPGroup",e.PublicDistributionList="PublicDistributionList",e.family="family"}(o||(o={}));var p,m=n("K9kD"),_=0,h=1,b=2,g=3,v=m.Killswitch.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),y="undefined"!=typeof window&&m.FeatureOverrides.isFeatureEnabled({ODB:1737});!function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(p||(p={}));var S=function(){function e(e,t){var n=this._pageContext=t.pageContext,a=t.tokenProvider,i=t.noRedirect,r=t.dataRequestorType,o=void 0===r?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:a,noRedirect:i})||this}return Object(s.__extends)(t,e),t}(m.DataRequestor):r,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new o({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_){void 0===i&&(i="POST");var h=e(),b=a&&a(),g=this.needsRequestDigest(h);return this.dataRequestor.getData({url:h,parseResponse:t,qosName:n,additionalPostData:b,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:g,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_})},e}(),D=n("pVWH"),I=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(I.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(I,Error));var x=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var a=t.innerError,i=t.wrapErrorCode,r=a||void 0,o=r?Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},"string"==typeof r.correlationId?{correlationId:r.correlationId}:{}),"boolean"==typeof r.isExpected?{isExpected:r.isExpected}:{}),"string"==typeof r.name?{code:r.name}:{}),"string"==typeof r.code?{code:r.code}:{}),"object"==typeof r.extraData?{extraData:r.extraData}:{}):{},c=t.correlationId,d=void 0===c?o.correlationId:c,l=t.isExpected,u=void 0===l?o.isExpected:l,f=t.extraData;return n.correlationId=d,n.isExpected=!!u,n.code=i&&o.code&&t.code&&"".concat(t.code," (").concat(o.code,")")||t.code||o.code||"",n.extraData=Object(s.__assign)(Object(s.__assign)({},o.extraData||{}),f||{}),n}return Object(s.__extends)(t,e),t}(I),C=function(e){function t(t,n){var a=this,i=n.response,r=(void 0===i?{}:i).error,o=(void 0===r?{}:r).innerError,c=(void 0===o?{}:o).stackTrace,d=void 0===c?"":c,l=n.response,u=n.request,f=n.status,p=n.code,m=void 0===p?E(l,f,function(e){return"".concat(e)})||"unhandled":p,_=Object(s.__assign)({innerError:t,code:m},n);return(a=e.call(this,_)||this).name="GraphError",a.response=l,a.status=f,a.serverStack=d,a.request=u,a.error=t,a}return Object(s.__extends)(t,e),t}(x);function O(e){var t={};if(t.errorMessage=e.message,w(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function w(e){return e instanceof C}function E(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}var A=n("w9oE"),L=window&&window.performance,k={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},M="Bearer",P=function(){function e(e,t){this._sendUrlToGetFormDigestKSActive=m.KillSwitch.isActivated("2F2E0E27-606F-4542-90E2-56D10E78DC5B","03/24/2023","send url to getFormDigest"),this._sendSyncClientHeadersKs=m.Killswitch.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,o=t.apiEvent,s=void 0===o?d.Api:o,c=t.cookieOrigin,l=t.isOffline,u=t.dataSyncClient;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=s,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._urlDataSource=r,this._cookieOrigin=c,this._isOffline=l,this._dataSyncClient=u,this._encodingFixEnabled=!m.Killswitch.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!m.FeatureOverrides.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._isPassAuthTokenInHeaderFeatureEnabled=m.FeatureOverrides.isFeatureEnabled({ODB:!0,ODC:"PassAuthTokenInHeader"}),this._driveIdUrlCheckEnabled=!m.Killswitch.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(n){var a=e.headers,i=void 0===a?{}:a,r=e.endpoint,o=e.driveUrl,c=e.driveId,l=e.apiName,u=e.disableLogging,f=void 0!==u&&u,p=e.timeout,_=e.onProgress,h=e.onUploadProgress,b=e.qosExtraData,g=e.apiVersion,v=void 0===g?"v2.0":g,y=e.needsAuthorization,S=void 0===y||y,D=e.postProcessQos,I=e.breakCache,w=e.allowCookies,P=e.hasContentType,T=void 0===P||P,F=e.useMultiPart,H=void 0!==F&&F,R=e.getErrorAsMessage,N=void 0!==R&&R,B=e.expectedErrors,j=n.path,V=n.accessToken,z=n.forceContentType,G=void 0!==z&&z,K=n.useExactAuthToken,W=void 0!==K&&K,q=n.headers;if(!r){var Q="v2.1"===v?v:void 0;r=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:Q,driveId:c}):t._urlDataSource.getVroomApiBaseUrl():void 0}if(t._driveIdUrlCheckEnabled&&o&&c&&("me"!==c?"".concat(r,"/drives/").concat(c):o)!==o)throw new x({code:"DriveIdAndDriveUrlMismatch"});var Y=e.useAuthorizationHeaders,J=void 0!==Y&&Y;t._isPassAuthTokenInHeaderFeatureEnabled&&(J=!0);var X=Object(s.__assign)(Object(s.__assign)({},k),e.expectedErrorCodes||{}),Z=e.requestType,$=void 0===Z?"GET":Z,ee=t._cookieOrigin,te=new d.SimpleUri(j).authority?j:"".concat(r).concat(j),ne=function(n){var a,o,c="",u={};H?(c=m.Guid.generate(),u={"Content-Type":"multipart/form-data;boundary=".concat(c)}):u=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&T||G?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),N?{prefer:"rich-error-as-message"}:{}),i),t._sendSyncClientHeadersKs?{}:q),n.sessionToken&&n.sessionToken.tokenUrl&&0===j.indexOf("/drive/")?o=new m.Uri("".concat(n.sessionToken.tokenUrl,"/").concat(j.substring(7))):(o=new m.Uri(j),r&&!o.getScheme()&&(o=new m.Uri(r+j))),H&&(o.setQueryParameter("ump","1"),"POST"!==$&&(i["X-HTTP-Method-Override"]=$),$="POST");var g,v=o.toString();if(!H&&n.sessionToken){var y=n.sessionToken,S=y.accessToken,x=y.proofToken,w=y.wlidToken,k=y.isBadger;if(w)u=Object(s.__assign)(Object(s.__assign)({},u),{Authorization:"wlid1.1 ".concat(w)});else if(J){if(S){var M=k?"badger":"bearer",P=W?S:"".concat(M," ").concat(S);u=Object(s.__assign)(Object(s.__assign)({},u),{Authorization:P})}x&&(u=Object(s.__assign)(Object(s.__assign)({},u),{"X-PROOF_TOKEN":x}))}else S&&o.setQueryParameter("access_token",S),x&&o.setQueryParameter("prooftoken",x)}if(H){var U="";if(U+="--".concat(c,"\r\n"),U+="Content-Disposition: form-data;name=data\r\n",i)for(var F=0,R=Object.keys(i);F<R.length;F++){var V=R[F];U+="".concat(V,": ").concat(i[V],"\r\n")}U+="Content-Type: application/json\r\n";var z=n.sessionToken;S=z.accessToken,k=z.isBadger,S&&(U+="Authorization: ".concat(M=k?"badger":"bearer"," ").concat(S,"\r\n")),N&&(U+="prefer: rich-error-as-message\r\n"),U+="\r\n",U+="".concat(void 0!==e.postData?e.postData:"","\r\n"),U+="--".concat(c,"--")}if(I&&o.setQueryParameter("r",Math.random().toFixed(8)),(null===(a=n.sessionToken)||void 0===a?void 0:a.authKey)&&o.setQueryParameter("authKey",n.sessionToken.authKey),!f){var K=new d.SimpleUri(v),Q={url:"".concat(K.authority,"/{ length: ").concat(K.path.length,", segments: ").concat(K.segments.length," }"),name:"".concat(t._apiName,"DataRequest.").concat(l),extraData:b};g=new t._apiEvent(Q)}var Y=o.toString(),Z=L&&L.now();return d.XHRPromise.start({url:Y,headers:u,method:$,json:U||e.postData||"",requestTimeoutInMS:p,withCredentials:n.useCookies,onProgress:_,onUploadProgress:h,responseType:e.responseType||void 0}).then(function(t){var n,a,i=Object(d.getRequestEntryDurationMetrics)(Y,Z);if(g){var r=null!==(a=null===(n=t.getAllResponseHeaders())||void 0===n?void 0:n.toLowerCase())&&void 0!==a?a:"",o={resultType:d.ResultTypeEnum.Success,extraData:{rawRequestDuration:i.duration,performanceEntry:JSON.stringify(i),requestId:r.indexOf("sprequestguid:")>=0?t.getResponseHeader("sprequestguid"):r.indexOf("request-id:")>=0?t.getResponseHeader("request-id"):null,MSCorrelationVector:r.indexOf("ms-cv:")>=0?t.getResponseHeader("MS-CV"):null}};g.end(o)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var a,i=function(e,t){return D&&(e=D(e,t)),g&&g.end(e),m.Promise.reject(t)},r=Object(d.getRequestEntryDurationMetrics)(Y,Z);if(e instanceof Error){var c=m.Promise.isCanceled(e),l=c?d.ResultTypeEnum.ExpectedFailure:d.ResultTypeEnum.Failure,u={error:e.message,resultCode:c?"Canceled":"",resultType:l,extraData:{rawRequestDuration:r.duration,performanceEntry:JSON.stringify(r)}};return i(u,e)}if(e.responseText)try{a=JSON.parse(e.responseText)}catch(e){}if(N)try{var f=t._encodingFixEnabled?JSON.parse((p=a.error.message,decodeURIComponent(escape(atob(p))))):JSON.parse(atob(a.error.message));a={error:f}}catch(e){}var p,_=e.status,h=e.statusText,v=(a||{}).error,y=void 0===v?{}:v,S=y.message,I=void 0===S?"":S,x=y.innerError,w=void 0===x?{}:x,L=w.stackTrace,k=void 0===L?"":L,M=w.debugMessage,P=void 0===M?"":M;return(_||!t._isOffline?m.Promise.resolve(!1):t._isOffline()).then(function(t){var c,l,u=t?"Offline":"",f=null!==(l=null===(c=e.getAllResponseHeaders())||void 0===c?void 0:c.toLowerCase())&&void 0!==l?l:"",p=f.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||f.indexOf("request-id")>=0&&e.getResponseHeader("request-id"),m=t||!!E(a,_,function(e){return X[e]}),g=new C(new Error(I||u),{response:a,status:_,request:e,correlationId:p,isExpected:m});B&&Object(A.isExpectedError)({code:g.code,message:I},B)&&(m=!0);var v={resultType:m?d.ResultTypeEnum.ExpectedFailure:d.ResultTypeEnum.Failure,error:I,resultCode:g.code,extraData:Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},b||{}),O(g)),{stack:k,httpStatus:_,httpStatusText:h,requestId:p,correlationId:p,MSCorrelationVector:f.indexOf("ms-cv:")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:P,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:o.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:r.duration,performanceEntry:JSON.stringify(r)})};return i(v,g)})})},ae=t._sessionManagementProvider;if(S){if(V)return ne({sessionToken:V});var ie=new d.SimpleUri(te).authority;if(w&&ie&&ee&&ie===ee){if("GET"===$)return ne({useCookies:!0});if(ae&&ae.getFormDigest)return ae.getFormDigest(t._sendUrlToGetFormDigestKSActive?void 0:te).then(function(e){return ne({digestValue:e,useCookies:!0})})}if(ae&&ae.getSessionToken){var re={apiVersion:v,endpoint:r,driveUrl:o,path:te};return m.Promise.resolve(ae.getSessionToken(re)).then(function(e){return ne({sessionToken:e}).catch(function(t){return e&&function(e){if(e instanceof C){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,M.length)===M&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?ae.getSessionToken(Object(s.__assign)(Object(s.__assign)({},re),{claimsChallenge:{sessionToken:e,claims:U(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?ne({sessionToken:n}):m.Promise.reject(t)}):m.Promise.reject(t)})})}if(ae&&ae.getToken)return ae.getToken(v,te).then(function(e){return ne({sessionToken:e})})}return ne({})},a=Object(s.__assign)({},e);return!m.KillSwitch.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,a=e.getData,i=function(){return a(n)};return m.Promise.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t,n){var i=Object(s.__assign)(Object(s.__assign)({},e.options),{path:t.url,accessToken:{accessToken:t.authToken},forceContentType:!0,useExactAuthToken:!0,headers:n});return a(i)},i)}(t):i()})}({dataSyncClient:this._dataSyncClient,options:a,getData:n}):n(a)},e}(),T=P;function U(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return m.KillSwitch.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}var F,H,R="DisableSubstrateSearch",N="https://outlook.office.com/search",B={ODB:1286},j=function(){function e(e,t){this._dataRequestor=new P({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation=t.sharingContextInformation,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&m.FeatureOverrides.isFeatureEnabled(B)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue(R,m.DataStoreCachingType.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(R,!0,m.DataStoreCachingType.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return m.Promise.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new m.Qos({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(N).then(function(e){return t.end({resultType:m.ResultTypeEnum.Success}),e},function(n){return m.Promise.isCanceled(n)?(t.end({resultType:m.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),m.Promise.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:m.ResultTypeEnum.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){var t,n,a="".concat(N,"/api/v1/init?scenario=").concat("documentshare");this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:a,headers:{Authorization:"Bearer "+e,"X-AnchorMailbox":"OID:".concat(null===(t=this._pageContext)||void 0===t?void 0:t.aadUserId,"@").concat(null===(n=this._pageContext)||void 0===n?void 0:n.aadTenantId)},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new m.DataStore("PeoplePicker",m.DataStoreCachingType.session))},e}(),V=n("ynV5");!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown"}(F||(F={})),function(e){e[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown"}(H||(H={}));var z=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,a=e.multiGeoInfo,i=e.options,r=void 0===i?{}:i,o=r.path,s=void 0===o?void 0:o,c=r.listUrl,d=void 0===c?void 0:c,l=r.webUrl,u=void 0===l?void 0:l,f=r.mayInferListUrl,p=void 0!==f&&f;this._rawPath=s||void 0,this._rawListUrl=d||void 0,this._rawWebUrl=u||void 0,this.defaultFullWebUrl=K(t||void 0),this.defaultListUrl=K(n||void 0),this.multiGeoInfo=a,this.mayInferListUrl=p}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return G(this._getServerRelativeItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return G(this._getServerRelativeListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return G(this._getNormalizedListUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return G(this._getNormalizedItemUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return G(this._getNormalizedWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return G(this._getServerRelativeWebUrl())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!1,configurable:!0}),e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=K(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e="".concat(n,"/").concat(t))}return this._getPath=function(){return e},e},e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=K(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e="".concat(n,"/").concat(t))}return this._getListUrl=function(){return e},e},e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;return t&&(e="/"===t[0]||t.indexOf("://")>-1?K(t):"".concat(this.defaultFullWebUrl,"/").concat(t)),this._getWebUrl=function(){return e},e},e.prototype._getCurrentAuthority=function(){var e=new d.SimpleUri(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e},e},e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!Object(V.equalsCaseInsensitive)(t,n)){var a=new d.SimpleUri(t);e=Object(V.equalsCaseInsensitive)(a.authority,this._getCurrentAuthority())?a.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new d.SimpleUri(t);e=Object(V.equalsCaseInsensitive)(n.authority,this._getCurrentAuthority())?n.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();return void 0===t||Object(V.equalsCaseInsensitive)(t,n)||(e=Object(V.equalsCaseInsensitive)(new d.SimpleUri(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e},e},e.prototype._getServerUrl=function(){var e=this.path&&new d.SimpleUri(this.path).authority||this.listUrl&&new d.SimpleUri(this.listUrl).authority||this.webUrl&&new d.SimpleUri(this.webUrl).authority||this.defaultListUrl&&new d.SimpleUri(this.defaultListUrl).authority||new d.SimpleUri(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e},e},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new d.SimpleUri(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var a=this._getServerRelativePath(),i=new d.SimpleUri(t).path;if(void 0===a&&(void 0===this.webUrl||i&&Q(q(i),q(this._getServerRelativeWebUrl())))||i&&Q(q(a),q(i)))e=i;else if(void 0!==a&&(""===this.defaultListUrl||n)){var r=this._getServerRelativeWebUrl();if(Q(q(a),q(r))){var o=new d.SimpleUri(a).segments[new d.SimpleUri(r).segments.length];e="".concat(q(r)).concat(o)}}}}return this._getServerRelativeListUrl=function(){return e},e},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();return void 0!==n&&(e="".concat(t).concat(n)),e},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullItemUrl=function(){return e},e},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new d.SimpleUri(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new d.SimpleUri(this.defaultFullWebUrl).path);else{var n=new d.SimpleUri(t);e="".concat(n.segments.slice(0,-1).join("/"))}return this._getServerRelativeWebUrl=function(){return e},e},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new d.SimpleUri(this.path).path),this._getServerRelativePath=function(){return e},e},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e},e},e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==a&&Q(q(n),t=q(a))&&(e=n&&n.substring(t.length)),this._getListRelativeItemUrl=function(){return e},e},e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==a&&Q(q(n),t=q(a))&&(e=n&&n.substring(t.length)),this._getWebRelativeItemUrl=function(){return e},e},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new d.SimpleUri(this.defaultListUrl).authority?this.defaultListUrl:"".concat(this._getCurrentAuthority()).concat(this.defaultListUrl)),this._getDefaultListUrl=function(){return e},e},e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!Object(V.equalsCaseInsensitive)(new d.SimpleUri(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t},t},e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!Object(V.equalsCaseInsensitive)(e,t);return this._getIsCrossList=function(){return n},n},e.prototype._getSiteRelation=function(){var e=F.unknown;if(this._getIsCrossDomain())e=F.crossSite;else if(void 0!==this.webUrl)e=Object(V.equalsCaseInsensitive)(W(this.defaultFullWebUrl),W(this._getFullWebUrl()))?F.sameSite:F.crossSite;else{var t=new d.SimpleUri(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(Q(q(n),q(t))){var a=new d.SimpleUri(W(n)),i=new d.SimpleUri(W(t));e=a.segments.length-1===i.segments.length||a.segments.length-2===i.segments.length&&"Lists"===a.segments[a.segments.length-2]?F.sameSite:F.unknown}else e=F.crossSite}return this._getSiteRelation=function(){return e},e},e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();return void 0!==n&&(e="".concat(t).concat(n)),this._getFullWebUrl=function(){return e},e},e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return H.sameGeo;var e=new d.SimpleUri(this._getServerUrl()).authority;if(!e)return H.unknown;var t=this._getCurrentGeo();if(!t)return H.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?Object(V.equalsCaseInsensitive)(n,t)?H.sameGeo:H.crossGeo:H.unknown},e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,a,i){var r=new d.SimpleUri(n).authority.toUpperCase();!i&&t[r]||(e[r]=a),i&&(t[r]=!0)}if(this.multiGeoInfo)for(var a=0,i=this.multiGeoInfo;a<i.length;a++){var r=i[a],o=r.InstanceId,s=r.IsDefaultDataLocation;if(n(r.MySiteHostUrl,o,s),n(r.PortalUrl,o,s),n(r.RootSiteUrl,o,s),n(r.TenantAdminUrl,o,s),r.AdditionalUrls)for(var c=0,l=r.AdditionalUrls;c<l.length;c++)n(l[c],o,s)}return this._getGeoByAuthority=function(){return e},e},e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];return this._getCurrentGeo=function(){return t},t}},e}();function G(e){return""===e?"/":e}function K(e){return"/"===e?"/":e}function W(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e}function q(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:"".concat(e,"/")}function Q(e,t){var n=e.toUpperCase(),a=t&&t.toUpperCase();return n.substring(0,a&&a.length||0)===a}var Y,J=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,a=void 0===n?z:n;this.itemUrlPartsType=a,this.itemUrlContext=t}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,a=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:a,multiGeoInfo:i,options:e})},e}(),X=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){var t=e.name,n=e.serializedValue;return"".concat(t,"=").concat(n)}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?".concat(t.join("&")):"";var n=this._webUrl,a=void 0===n?this._webAbsoluteUrl:n,i=Object(s.__spreadArray)([this._encodeWebAbsoluteUrl?encodeURI(a):a,"_api"],this._segments,!0);return"".concat(i.join("/")).concat(e)},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push("".concat(o,"=").concat(c.name))}return n.segment("".concat(e,"(").concat(a.join(","),")"))},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment("".concat(e,"(").concat(i.join(","),")"))},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a".concat(t);return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?d.UriEncoding.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'".concat(t.guid,"'"):function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?"".concat(t):"'".concat(d.UriEncoding.encodeRestUriStringToken(t),"'"),this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),Z=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(s.__extends)(n,t),n}(X)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?"".concat(e.substring(0,i),"_").concat(e.substring(i+1)):e}return"".concat(t,"/_api/contextinfo")},e}(),$=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(s.__extends)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,i=this;return(n||t===F.crossSite)&&(i=i.method("SP.RemoteWeb",a)),i.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(X),ee=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,i=n.itemUrlHelper,r=n.pageContext,o=n.encodeWebAbsoluteUrl,c=n.apiUrlType,d=void 0===c?function(e){function t(){return e.call(this,{},{itemUrlHelper:i,pageContext:r,encodeWebAbsoluteUrl:o})||this}return Object(s.__extends)(t,e),t}($):c;return a._apiUrlType=d,a}return Object(s.__extends)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(Z),te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(s.__extends)(t,e),t}(z),ne=function(e){function t(t,n){var a=n.itemUrlPartsType,i=void 0===a?te:a;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}return Object(s.__extends)(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)},t.prototype.getItemUrlParts=function(e){var t=Object(m.deserializeQuery)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})},t}(J),ae=n("QVYh");function ie(e,t,n){var a=Object(ae.getUserPhotoUrl)(t,void 0,n);if(!e||!a||0===a.indexOf("http"))return a;try{return new d.SimpleUri(e).authority+a}catch(e){return a}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(Y||(Y={}));var re=!m.Killswitch.isActivated("b7426b02-fdf6-4c5e-9809-e0c21db41db7","07/10/2022","remove hard code graph endpoint and read from spPageContextInfo")&&!m.FeatureOverrides.isFeatureEnabled({ECS:1026572}),oe=!m.Killswitch.isActivated("29b79ab1-ae17-42fd-b4e1-39e58a904f55","04/02/2023","enable IB discovery"),se=!m.Killswitch.isActivated("1fb78d40-be00-49e2-8e0f-aba66aa1765c","07/06/2023","enable non mail SG for grant access")&&!m.FeatureOverrides.isFeatureEnabled({ECS:1096524}),ce=function(e){function t(t,n){var a=this,i=de(t)?t:n.pageContext,r=null==n?void 0:n.noRedirect,o=null==n?void 0:n.tokenProvider;a=e.call(this,{dataSourceName:"PeoplePickerDataSource"},{pageContext:i,noRedirect:r,tokenProvider:o})||this;var s=de(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=s||new ee({},{itemUrlHelper:new ne({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return Object(s.__extends)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return m.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n,a,i,r,o=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},s=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,c={personDetails:o(s.Primary),managerChain:s.ManagerChain.results.map(o),directReports:s.DirectReports.results.map(o)};return c.personDetails.profilePage=(a=(n=t._pageContext).webAbsoluteUrl,i=n.webServerRelativeUrl,r=n.isSiteListsHost,("/"===i||""===i||!v&&r||y&&(null==n?void 0:n.isUnifiedAdminUrl)?a:a.substring(0,a.lastIndexOf(i)))+"/_layouts/15/me.aspx?p="+encodeURIComponent(c.personDetails.sip)+"&origin=ProfileODBCard"),c}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===D.e.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return m.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return m.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var r=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,additionalHeaders:r,parseResponse:function(e){var a=JSON.parse(e),r=JSON.parse(a.d.ClientPeoplePickerResolveUser),o=[];o[0]=r,r.IsResolved||r.EntityData.IsBlockedOnODB&&"true"===r.EntityData.IsBlockedOnODB.toLowerCase()||o&&!o[0].DisplayText&&(o[0].DisplayText=r.Key);var s=(o=n._transformData(o,t.filterExternalUsers))[0];return t.filterExternalUsers&&s&&s.entityType===i.externalUser?(s.isResolved=!1,s.entityType=i.regularUser):t.blockViaPolicy&&!t.filterExternalUsers&&s&&!s.isResolved&&0===s.multipleMatches.length&&(s.isResolved=!0,s.isExternal=!0,s.entityType=i.externalUser),t.isGraphDistributionList&&t.useGraph&&s.isExternal&&(s.entityType=i.group,s.principalType=D.e.distributionList),s}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new T({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new T({},{})),t},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.search=function(e,t){return oe&&t.enforceIBSegmentFiltering?this.sharePointSearch(e,t):this.canUseSubstrate(t)||t.useNew3Ssearch?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):(0===t.groupID&&(t.useSubstrateSearch=!0),this.sharePointSearch(e,t))},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),m.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){var o=t.listId&&{querycontext:t.listId};return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"ClientPeoplePickerSearchUser",additionalHeaders:o,authToken:a,parseResponse:function(a){var o=t.allowSharePointGroups,s=void 0===o||o,c=t.filterExternalUsers,d=t.bypassEmailValidation,l=void 0===d||d,u=JSON.parse(a),f=JSON.parse(u.d.ClientPeoplePickerSearchUser),p=n._transformData(f,c);return c&&(p=p.filter(function(e){return e.entityType!==i.externalUser})),p=p.filter(function(e){return e.principalType===D.e.sharePointGroup?s:e.principalType===D.e.securityGroup?(se?l:s)||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),n._handleZeroSearchResult(p,e,t,r.sharepointSearch)}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){default:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(s){var c;if(!s)return a.sharePointSearch(e,n);var d=re&&a._pageContext&&a._pageContext.msGraphEndpointUrl?null===(c=a._pageContext)||void 0===c?void 0:c.msGraphEndpointUrl:"https://graph.microsoft.com",l=new m.Uri("".concat(d,"/v1.0/me/people"));if(e)if(l.setQueryFromObject({$search:'"'.concat(e,'"'),$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),m.Killswitch.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&l.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var u=t._getPersonTypeFilter(n);u&&l.setQueryParameter("$filter",u)}var f=new m.Qos({name:"PeoplePickerGraphSearch"});return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:l.toString(),headers:{Authorization:"Bearer "+s,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),t&&t.value&&0!==t.value.length)f.end({resultType:m.ResultTypeEnum.Success});else if(f.end({resultType:m.ResultTypeEnum.Failure,extraData:{error:"graph search return empty results"}}),e)return a.sharePointSearch(e,n);var s=t.value,c=[];return s.forEach(function(e){if(!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t,s=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",d=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:s,l={Key:d,IsResolved:!1},u="ImplicitContact"===e.personType.subclass,f="OrganizationUser"===e.personType.subclass,p="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,m="PublicDistributionList"===e.personType.subclass,_=ie(a._webAbsoluteUrl,s);m&&(t=o.PublicDistributionList),p&&(t=o.unified);var h={department:e.department,email:s,image:u?void 0:_,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||s,name:e.displayName,providerName:f?"Provider":void 0,userId:d,rawData:l,rawPersonData:l,isExternal:!f,aadObjectId:e.id,fromDataSource:r.graph,detailedGroupInfo:t};f?(h.entityType=i.regularUser,h.principalType=D.e.user,h.isResolved=!0):p?(h.entityType=i.group,h.principalType=D.e.securityGroup,h.isResolved=!1,h.userId=e.id):(h.principalType=m?D.e.distributionList:D.e.none,h.entityType="Group"===e.personType.class?i.group:i.externalUser,h.isResolved=!1,h.providerName=void 0),h.userId&&c.push(h)}}),a._handleZeroSearchResult(c,e,n,r.graph)},function(t){if(f.end({resultType:m.ResultTypeEnum.Failure,extraData:{error:t}}),w(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(a){if(!a)return n.sharePointSearch(e,t);var s=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(s=t.siteIBSegmentIDs);var c,d=t.useNew3Ssearch?["Mailbox","Directory","SecurityGroups"]:["Mailbox","Directory"],l={Authorization:"Bearer "+a},u=t.useNew3Ssearch?["OrganizationUser","Guest","UnifiedGroup","MailUniversalSecurityGroup"]:["OrganizationUser","Guest","PublicDistributionList","UnifiedGroup"],f=m.Guid.isValidGuid(e),p={Or:u.map(function(e){return{Term:{PeopleSubtype:e}}})},_=s?{Or:s.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null,h=f?{Or:{Term:{ExternalDirectoryObjectId:e}}}:null,b=s||f?f?s?{And:[p,_,h]}:{And:[p,h]}:{And:[p,_]}:p;c=JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:d,Query:{QueryString:f?null:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:b}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}});var g=new m.Qos({name:"PeoplePickerSubstrateSearch"});return n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:N+"/api/v1/suggestions",headers:l,needsAuthorization:!1,requestType:"POST",postData:c}).then(function(a){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var s=a.Groups[0]?a.Groups[0].Suggestions:[];if(0===s.length){if(g.end({resultType:m.ResultTypeEnum.Failure,extraData:{error:"substrate search return empty results"}}),e)return n.sharePointSearch(e,t)}else g.end({resultType:m.ResultTypeEnum.Success});var c=[];return s.forEach(function(e){if(!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var a=e.EmailAddresses[0]||e.QueryText||"",r=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:a;t.useNew3Ssearch&&!r&&e.Id&&e.Id.indexOf("@")&&(r=e.Id.substring(0,e.Id.indexOf("@")));var s,d={Key:r,IsResolved:!1},l="ImplicitContact"===e.PeopleSubtype,u="OrganizationUser"===e.PeopleSubtype,f="LinkedIn"===e.PeopleSubtype,p="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,m="PublicDistributionList"===e.PeopleSubtype,_=ie(n._webAbsoluteUrl,a);m&&(s=o.PublicDistributionList),p&&(s=o.unified);var h={department:e.Department,office:e.OfficeLocation,email:a,image:l?void 0:_,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||a,name:e.DisplayName,providerName:"Provider",userId:r,rawData:d,rawPersonData:d,isExternal:!u,detailedGroupInfo:s};u?(h.entityType=i.regularUser,h.principalType=D.e.user,h.isResolved=!0):p?(h.entityType=i.group,h.principalType=D.e.securityGroup,h.isResolved=!1,h.providerName=void 0):f?h.entityType=i.linkedinUser:(h.principalType=m?D.e.distributionList:D.e.none,h.entityType="Group"===e.PeopleType?i.group:i.externalUser,h.isResolved=!1,h.providerName=void 0),h.userId&&c.push(h)}}),n._handleZeroSearchResult(c,e,t,r.substrate)},function(a){if(g.end({resultType:m.ResultTypeEnum.Failure,extraData:{error:a}}),w(a))switch(a.status){case 400:case 401:case 403:case 404:return n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==a.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t));return null})})},t.prototype._handleZeroSearchResult=function(e,t,n,a){if(!t)return e;if(!1!==n.resolveEmailIfNoResults&&0===e.length&&this._isValidEmail(t,!1)){var r={Key:t,IsResolved:!1};e.push({email:t,entityType:i.externalUser,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:t,name:t,userId:t,rawData:r,rawPersonData:r,isExternal:!0,fromDataSource:a})}return e},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&d.EmailAddressParser.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){var t="";return e.principalType&D.e.user&&(t+="personType/subclass eq 'OrganizationUser' or personType/subclass eq 'Guest'"),e.principalType&D.e.securityGroup&&(t&&(t+=" or "),t+="personType/subclass eq 'UnifiedGroup'"),e.principalType&D.e.distributionList&&null!==e.filterPublicDistributionList&&e.filterPublicDistributionList!==!m.Killswitch.isActivated("18c99317-6e4f-4859-85bf-b127709b6eff","01/28/2022","Include public distribuition list in filter by default")&&(t&&(t+=" or "),t+="personType/subclass eq 'PublicDistributionList'"),t},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,r={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};r.multipleMatches.length>0&&(r.multipleMatches=n._transformData(r.multipleMatches,t),t&&(r.multipleMatches=r.multipleMatches.filter(function(e){return e.entityType!==i.externalUser})));var s=r.email;r.isResolved&&(r.image=s?ie(n._webAbsoluteUrl,s):null);var c=a.PrincipalType||e.EntityType;switch(c){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":r.entityType=i.externalUser,r.principalType=D.e.user,r.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":case"SecurityGroup":if(!m.Killswitch.isActivated("5bcee89c-f8f5-4973-82d2-ab06c37b03e0","1/25/2025","Fix bug: SharePointSearch result principleType of SecurityGroup was treated as user type")||"SecurityGroup"!==c){r.entityType=i.group,r.principalType="SharePointGroup"===c?D.e.sharePointGroup:D.e.securityGroup,r.detailedGroupInfo="SharePointGroup"===c?o.SPGroup:o.securityGroup;break}default:r.entityType=i.regularUser,r.principalType=D.e.user}return r})},t}(S);function de(e){return!!e.webAbsoluteUrl}var le=n("vlQI"),ue=n("X+PM"),fe=function(){function e(e){var t=this;e.whenFinished(function(){t._oAuthTokenProvider=e.consume(le.DEPRECATED_DO_NOT_USE_OAuthTokenProvider.serviceKey),t._pageContext=e.consume(ue.PageContext.serviceKey)})}return e.prototype.getToken=function(e,t){if(this._oAuthTokenProvider){t&&this._oAuthTokenProvider.clearCachedToken(e);var n=this._pageContext&&this._pageContext.web&&this._pageContext.web.serverRelativeUrl;return this._oAuthTokenProvider.getOAuthToken(e,n).then(function(e){return e.token})}return m.Promise.wrap(void 0)},e.prototype.getInstrumentedToken=function(e,t){return m.Promise.wrap(void 0)},e}(),pe={ODB:387},me="DisableGraph",_e=function(){function e(e,t){this._pageContext=t.pageContext,this._sharingContextInformation=t.sharingContextInformation,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}return e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&m.FeatureOverrides.isFeatureEnabled(pe);return this._dataStore&&(e=e&&!this._dataStore.getValue(me,m.DataStoreCachingType.session)),e},e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue(me,!0,m.DataStoreCachingType.session)},e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return m.Promise.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new m.Qos({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){return t.end({resultType:m.ResultTypeEnum.Success}),e},function(n){return m.Promise.isCanceled(n)?(t.end({resultType:m.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),m.Promise.reject(n)):(t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:m.ResultTypeEnum.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableGraphCallsForPicker(),null)})}return null},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new m.DataStore("PeoplePicker",m.DataStoreCachingType.session))},e}(),he=function(){function e(e){this._serviceScope=e}return Object.defineProperty(e.prototype,"peoplePickerDataSource",{get:function(){if(void 0===this._peoplePickerDataSource){var e=this._serviceScope.consume(ue.PageContext.serviceKey),t=e&&e.legacyPageContext,n=new fe(this._serviceScope),a=new _e({},{pageContext:t,oAuthTokenProvider:n}),i=new j({},{pageContext:t,oAuthTokenProvider:n});this._peoplePickerDataSource=new ce({},{pageContext:t,graphPeoplePickerHelper:a,substratePeoplePickerHelper:i})}return this._peoplePickerDataSource},enumerable:!1,configurable:!0}),e.serviceKey=f.ServiceKey.create("sp-component-utilities:PeoplePickerDataSource",e),e}(),be=n("2q6Q"),ge=n("u2MZ"),ve=n("faye"),ye=n("nOp6"),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onClick=function(e){t.props.inputProps&&t.props.inputProps.onClick&&t.props.inputProps.onClick(e),0!==e.button||e&&e.target&&e.target.value||t.onEmptyInputFocus()},t.onInputFocus=function(e){var n,a;m.Killswitch.isActivated("543f1508-f671-478a-9d8e-f38cf68393fd","04/19/2023","Respect the onEmptyResolveSuggestions prop passed to PeoplePicker")||t.props.showDefaultSuggestionOnlyByClick||e&&e.target&&e.target.value||!t.props.onEmptyResolveSuggestions||t.onEmptyInputFocus(),De()||null===(a=null===(n=t.props.inputProps)||void 0===n?void 0:n.onFocus)||void 0===a||a.call(n,e)},t}return Object(s.__extends)(t,e),t}(ye.e);function De(){return m.Killswitch.isActivated("f7dc3d8b-8019-4187-9e11-6dcb2597352b")}function Ie(e){if(!e||0===e.length)return 0;for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t&=t;return t}var xe=function(e){function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;if(n._MaxItems=200,n._Version=5,n._buffer=n.getValue(t._StorageKey),n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer(),n._data={},Date.now()<n._buffer.lastCachePrune+6048e5)for(var a=0;a<n._buffer.dataArray.length;a++){var i=n._buffer.dataArray[a],r=n._getItemKey(i);n._data[r]=i}else n.initializeBuffer(),n.setValue(t._StorageKey,n._buffer);return n}return Object(s.__extends)(t,e),t.clear=function(){new m.DataStore(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var n=this._getItemKey(e),a=this._data[n];if(a){if(t.isCacheEntryFresh(a,e))return;var i=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[i]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var r=this._buffer.dataArray[this._buffer.index],o=this._getItemKey(r);delete this._data[o],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[n]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var n=[],a=0;a<this._buffer.dataArray.length;a++){var r=(this._buffer.index-a+this._MaxItems)%this._MaxItems,o=this._buffer.dataArray[r];!(o.email&&o.email.toLowerCase().indexOf(e.toLowerCase())>=0||o.name&&o.name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&o.entityType===i.externalUser||n.push(o)}return n},t.prototype.containsItem=function(e){var t=this._getItemKey(e);return Boolean(this._data[t])},t.prototype.initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()},t.prototype._getItemKey=function(e){return e.email||e.userId||Ie(JSON.stringify(e)).toString()},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=m.DataStoreCachingType.local,t}(m.DataStore),Ce=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new ce({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new xe,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,a,i=this,r={cached:null,promise:null};return this._mruCache&&!t.groupID&&(a=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(r.cached=a),r.promise=new m.Promise(function(r,o){n=i._dataSource.search(e,t).then(function(e){if(e)if(a){a.length>0&&(a=i._removeStaleCacheResults(a,e));var t=a.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()}),r},e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){return n._mruCache&&e.isResolved&&n.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)},e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()},e.prototype.searchMruCache=function(e,t){var n=[],a=this._mruCache;if(a){n=a.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n},e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),a=[];return t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var r=e[i];xe.isCacheEntryFresh(r,t)&&a.push(r)}}),a},e}(),Oe=n("fxVk"),we=n("jOlS");Object(we.loadStyles)([{rawString:"@media screen and (-ms-high-contrast:active){.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:';margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid '},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:flex;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_64a1f56a{flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.peoplePickerPill_64a1f56a{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:inline-flex;align-items:center;margin:4px}.peoplePickerClose_64a1f56a{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}html[dir=ltr] .peoplePickerClose_64a1f56a{padding-left:4px}html[dir=rtl] .peoplePickerClose_64a1f56a{padding-right:4px}.peoplePickerClose_64a1f56a:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}.placeholderUser_64a1f56a{background-color:unset;outline:1px dashed;outline-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var Ee,Ae=n("iZ1p");function Le(e,t){if(!ke(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!ke(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,a=Object.keys(t);n<a.length;n++){var i=a[n],r=t[i],o=e[i];if(r!==o){var c=r;if(Te(c))if(c.graftOperationType===Ee.replace)o=void 0,r=d=c.value;else if(c.graftOperationType===Ee.backup){var d=c.value;if(void 0!==e[i])continue;r=d}else{if(c.graftOperationType!==Ee.optional){if(Ue(c)){delete e[i];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(d=c.value))continue;r=d}var l=void 0;if(Me(r))l=new Date(r.getTime());else if(Pe(r)){var u=o;Pe(u)||(u=[]),u.splice.apply(u,Object(s.__spreadArray)([0,u.length],r,!1)),l=u}else if(ke(r)){var f=o;ke(f)||(f={}),Le(f,r),l=f}else l=r;e[i]=l}}return e}function ke(e){return"object"==typeof e&&!!e}function Me(e){return e instanceof Date}function Pe(e){return Array.isArray(e)}function Te(e){return ke(e)&&!!e.graftOperationType}function Ue(e){return e.graftOperationType===Ee.remove}!function(e){e[e.none=0]="none",e[e.replace=1]="replace",e[e.optional=2]="optional",e[e.remove=3]="remove",e[e.backup=4]="backup"}(Ee||(Ee={}));var Fe,He={ODB:60596};function Re(e){var t,n;return!m.KillSwitch.isActivated("E453BAFB-1A08-4222-89F4-568CF37CA2B8","11/02/2021","Placeholder sharing")&&m.Features.isFeatureEnabled(He)&&!(!e.invitationId&&!(null===(n=null===(t=e.rawData||e.rawPersonData)||void 0===t?void 0:t.EntityData)||void 0===n?void 0:n.invitation))}!function(e){e[e.standalone=0]="standalone",e[e.pill=1]="pill"}(Fe||(Fe={}));var Ne=m.Features.isFeatureEnabled({ODC:"ToolTipEmailKillSwitch"})||m.KillSwitch.isActivated("2f7a87f9150a4ef3b35a1ad82e402730","08/28/2021","ToolTipEmailKillSwitchActivated");function Be(e,t,n){var a="3rem";if(t)switch(t){case l.PersonaSize.size24:a="1.5rem";break;case l.PersonaSize.size32:a="2rem";break;case l.PersonaSize.size40:a="2.5rem";break;case l.PersonaSize.extraSmall:a="1.75rem";break;default:a="3rem"}var i={text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:a,height:a,maxWidth:"75px",maxHeight:"75px",flexShrink:0},image:{width:a+"!important",height:a+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:a,height:a,maxWidth:"75px",maxHeight:"75px"},initials:{width:a,height:a,fontSize:"0.625rem",lineHeight:a}}},styles:{root:{height:"auto"},primaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.875rem"},secondaryText:{height:"auto",whiteSpace:"normal",fontSize:"0.75rem"}}};return Re(e)&&void 0!==n?Le(i,function(e,t){void 0===t&&(t={});var n=Object(l.getTheme)(),a=t.fontSize;return{coinProps:{styles:{initials:e===Fe.standalone?{border:"1px dashed ".concat(n.palette.themePrimary),boxSizing:"border-box",fontSize:null!=a?a:"16px",fontWeight:"normal",color:n.palette.themePrimary}:{border:"none",boxSizing:"border-box",fontSize:null!=a?a:"12px",color:n.palette.themePrimary,paddingLeft:"4px",paddingRight:"4px"}}},initialsColor:l.PersonaInitialsColor.transparent,onRenderInitials:function(){return c.createElement(Oe.Icon,{iconName:"Contact",style:{fontWeight:"normal"}})}}}(n)):i}var je,Ve=function(e){return c.createElement("div",{className:"ms-PeoplePicker-personaContent"},c.createElement(l.Persona,Object(s.__assign)({},e.personaProps,{presence:l.PersonaPresence.none,size:l.PersonaSize.size40,className:"ms-PeoplePicker-pickerPersona"})),e.person.entityType===i.linkedinUser&&c.createElement(Oe.Icon,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},ze=function(e){var t,n=e.item,a=e.onRemoveItem,i=e.index,r=e.selected,o=e.removeButtonAriaLabel,d=Be(n,l.PersonaSize.extraSmall,Fe.pill);return Ne||(d.onRenderPrimaryText=function(){return c.createElement(l.TooltipHost,{content:n.email||d.text,directionalHint:l.DirectionalHint.topLeftEdge},d.text)}),c.createElement("div",{className:Object(l.css)("ms-PickerPersona-container",(t={"is-selected":!!r},t.placeholderUser_64a1f56a=Re(n),t)),"data-is-focusable":!0,"data-selection-index":i,key:i,role:"listitem"},c.createElement("div",{className:Object(l.css)("ms-PickerItem-content","itemContent_64a1f56a")},c.createElement(l.Persona,Object(s.__assign)({},d,{presence:l.PersonaPresence.none,size:l.PersonaSize.extraSmall}))),c.createElement(l.IconButton,{styles:{root:{flexShrink:0}},onClick:a,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":null!=o?o:V.format(Ae.t,n.name),disabled:e.disabled}))},Ge=function(e){var t=e.item,n=e.onRemoveItem,a=e.index,i=e.selected,r=Be(t,l.PersonaSize.size40),o="PickerPersonaId"+Math.floor(1e4*Math.random()),d=V.format(Ae.t,t.name);return c.createElement("div",{className:Object(l.css)("ms-PickerPersona-container is-listbelow",{"is-selected":!!i}),"data-is-focusable":!0,"data-selection-index":a,key:a,"aria-labelledby":o,role:"listitem"},c.createElement("div",{className:"ms-PickerPersona-content"},c.createElement(l.Persona,Object(s.__assign)({id:o},r,{presence:l.PersonaPresence.none,size:l.PersonaSize.size40}))),c.createElement("div",{className:"ms-PickerItem-content"},c.createElement(l.IconButton,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,"aria-label":d})))};!function(e){e[e.normal=0]="normal",e[e.listBelow=1]="listBelow"}(je||(je={})),Object(we.loadStyles)([{rawString:":global(.ms-Suggestions){width:260px}"}]);var Ke=m.Killswitch.isActivated("41868B4D-8044-4ACF-8E89-CFD71EF69C3D","10/31/2021","fix people picker suggestion dup"),We=Se,qe=ye.t,Qe=function(e){function t(t){var n=e.call(this,t)||this;if(n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise&&(n._peoplePickerSearchPromise.cancel(),n._peoplePickerSearchPromise=void 0),!(e=e.trim())&&!n._canCallGraph)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._getPeoplePickerQueryParams(),a=null==t?void 0:t.conversationId;t&&t.conversationId&&delete t.conversationId;var i="peoplePickerSearch_".concat(e.trim(),"_").concat(JSON.stringify(t));t&&a&&(t.conversationId=a);var r=function(){var a=n._dataProvider.search(e.trim(),t);if(!a)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var i=a.cached?a.cached:[];return n._peoplePickerSearchPromise=a.promise,n._peoplePickerSearchPromise.then(function(e){return n._peoplePickerSearchPromise=void 0,e?i.concat(e):[]}).then(function(t){var a=Ke?t:n._dedupeSuggestions(t);return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(a,e):a})};if(!n.props.peoplePickerImprovementsExperiment||!n.props.persistCachePeopleSearch)return r().then(function(e){return n._callRumOneLoggerFromProps(),e});try{return n.props.persistCachePeopleSearch({getData:r,key:i}).then(function(e){var t=!isNaN(e.cacheStats.lastModified);return n._callRumOneLoggerFromProps(t),e.data})}catch(e){return r().then(function(e){return n._callRumOneLoggerFromProps(),e})}},n._callRumOneLoggerFromProps=function(e){void 0===e&&(e=!1),n.props.writeUserInputDataToRumoneLogger&&n.props.writeUserInputDataToRumoneLogger(e)},n._onGetMoreResults=function(e){var t;return n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked(),n.props.peoplePickerQueryParams&&((t=Object(s.__assign)({},n.props.peoplePickerQueryParams)).useGraph=!1,t.useSubstrate=!1),n._dataProvider&&n._dataProvider.sharePointSearch&&t?n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var a=n.props.onResolvedSuggestions(t,e);if(a instanceof Array)return a}return t}):[]},t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new Ce({pageContext:t.context,peoplePickerDataSource:t.dataSource})}return n._canCallGraph=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams)),n._handleGetMoreResultsInBaseClass=n._canCallGraph&&!n.props.onGetMoreResults,n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)},n}return Object(s.__extends)(t,e),Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e=this,t=this.props,n=t.className,a=t.onRenderItem,i=t.onRenderSuggestionsItem,r=t.defaultSelectedItems,o=t.onSelectedPersonasChange,d=t.suggestionsHeaderText,u=t.suggestionsClassName,f=t.noResultsFoundText,p=t.loadingText,_=t.inputProps,h=t.onSuggestionSelected,b=t.suggestionsAvailableAlertText,g=t.enableSelectedSuggestionAlert,v=t.selectedItems,y=t.itemLimit,S=t.onInputChange,D=t.onGetMoreResults,I=t.searchForMoreIcon,x=t.searchForMoreText,C=t.ariaLabel,O=void 0===C?"":C,w=t.pickerCalloutProps,E=t.pickerOverrideStyles,A=t.theme,L=t.disabled,k=t.onGetMoreResultsClicked,M=t.removeButtonAriaLabel,P=t.onEmptyResolveSuggestions,T=t.customizeSuggestionPersonaProps,U=t.showDefaultSuggestionOnlyByClick;this._onGetMoreResultsClicked=k;var F={className:n,onRenderSuggestionsItem:i||function(e){return function(e,t){var n,a=Be(e,l.PersonaSize.size40,Fe.standalone);if(n=a,t&&(n=t(a)),n&&n.imageUrl){var i=new m.Uri(n.imageUrl);i.setQueryParameter("fromPeoplePicker","true"),n.imageUrl=i.toString()}return c.createElement(Ve,{person:e,personaProps:n})}(e,T)},onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:r,selectedItems:v,onChange:o,inputProps:_,enableSelectedSuggestionAlert:g,pickerSuggestionsProps:{suggestionsHeaderText:d,loadingText:p,noResultsFoundText:f,className:u,suggestionsAvailableAlertText:b,searchForMoreIcon:I,searchForMoreText:x||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:Ae.e},onItemSelected:h,itemLimit:y,onInputChange:S,onGetMoreResults:D||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:w,styles:E,theme:A,"aria-label":O,disabled:L,removeButtonAriaLabel:M,onEmptyResolveSuggestions:U&&this._canCallGraph?function(){return e.props.initRumone&&e.props.initRumone("",!0),e._onResolveSuggestions("")}:P,showDefaultSuggestionOnlyByClick:U};return this.props.peoplePickerType===je.listBelow?(F.onRenderItem=a||Ge,c.createElement(qe,Object(s.__assign)({},F,{componentRef:this._resolveRef("_peoplePicker")}))):(F.onRenderItem=a||ze,c.createElement(We,Object(s.__assign)({},F,{componentRef:this._resolveRef("_peoplePicker")})))},t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()},t.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:D.e.user|D.e.securityGroup|D.e.sharePointGroup}},t.prototype._dedupeSuggestions=function(e){var t=this,n=[],a=this._peoplePicker&&this._peoplePicker.items||[];a=Object(s.__spreadArray)([],a,!0);for(var i=function(e){var i=r._getItemKey(e);a.some(function(e){var n=t._getItemKey(e);return i===n})||(n.push(e),a.push(e))},r=this,o=0,c=e;o<c.length;o++)i(c[o]);return n},t.prototype._getItemKey=function(e){return e.email||e.userId||Ie(JSON.stringify(e)).toString()},t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})},t.prototype._getSearchForMoreText=function(e){return e?Ae.n:void 0},t}(l.BaseComponent),Ye=n("ut3N"),Je=n("Pk8u"),Xe=n("mFOl"),Ze=n("U4ag");function $e(e){return c.createElement("div",{className:Object(l.css)("ms-PeoplePicker-personaContent","ah_e_a3a8085b")},c.createElement(Ze.DoughboyDetector,{imageUrl:e.image||"",imageProps:e,renderImage:et,disableDelayDetect:!0}))}function et(e,t){return c.createElement(l.Persona,{text:t.name||"",tertiaryText:t.email||"",secondaryText:t.job||t.email||t.department||"",imageInitials:"",presence:l.PersonaPresence.none,size:l.PersonaSize.small,className:"ms-PeoplePicker-Persona",imageUrl:e})}we.loadStyles("[dir=ltr] .ah_e_a3a8085b .ms-Persona-details{padding-right:12px}[dir=rtl] .ah_e_a3a8085b .ms-Persona-details{padding-left:12px}",!0),we.loadStyles('.ae_c_a3a8085b input{background-color:"[theme:bodyBackground, default: #ffffff]";color:"[theme:neutralPrimary, default: #323130]"}.ae_c_a3a8085b input:-ms-input-placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.ae_c_a3a8085b input::placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.ae_c_a3a8085b .ms-BasePicker-input,.ae_c_a3a8085b .ms-BasePicker-text{min-width:1px}.af_c_a3a8085b .ms-BasePicker-input,.af_c_a3a8085b .ms-BasePicker-text,.af_c_a3a8085b input{border-radius:"[theme:roundedCorner4, default: 4px]"}.ag_c_a3a8085b{clip:rect(0,0,0,0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}',!0);var tt=n("2RB3"),nt=function(e){function t(t){var n=e.call(this,t)||this;return n._isUnmounted=!1,n._currentQueryType="",n._pickerRef=c.createRef(),n._handleChangeSelectedPersons=function(e){void 0===e&&(e=[]);var t=e.map(ge.s);n.props.onChangeSelectedPersons(t),be._EngagementLogger.logEventWithLogEntry(new Ye._LogEntry("PeopleWebPart","PeopleSearcher.SelectPeopleFromSuggestion",Ye._LogType.Event,{queryType:n._currentQueryType})),n.setState(function(e){return{key:1-e.key}})},n._handleFilterSuggestion=function(e,t){var a=t.length>=2;n.setState({shouldResolveQuery:a});var i=Object(Je.differenceWith)(e,n.props.selectedPersons||[],function(e,t){return e.userId===t.id||e.email===t.email});return n._logResolveSuggestion(e,t,a),n._updateAlertForResolvedSuggestions(i,a),i},n._peopleSearcherId="people-searcher-id-".concat(0),n.state={shouldResolveQuery:!1,key:0},n._updateAlert=Object(Je.debounce)(n._updateAlert,1e3),n}return Object(s.__extends)(t,e),t.prototype.componentWillUnmount=function(){this._isUnmounted=!0},t.prototype.render=function(){var e={placeholder:tt.i,id:this._peopleSearcherId},t=Object(l.css)(this.props.className,"ae_c_a3a8085b",Object(Xe.n)()&&"af_c_a3a8085b"),n=ge.l,a=this.props.filterExternalUsers;return void 0!==a&&(n.filterExternalUsers=a),c.createElement("div",null,c.createElement("label",{htmlFor:this._peopleSearcherId,className:"ag_c_a3a8085b"},this.props.ariaLabel),c.createElement(Qe,{className:t,context:this.props.serviceScope.consume(ue.PageContext.serviceKey).legacyPageContext,onSelectedPersonasChange:this._handleChangeSelectedPersons,onRenderSuggestionsItem:$e,dataSource:this.props.dataSource,ref:this._pickerRef,inputProps:e,key:this.state.key,noResultsFoundText:this.state.shouldResolveQuery?tt.t:tt.e,onResolvedSuggestions:this._handleFilterSuggestion,peoplePickerQueryParams:n}))},t.prototype.focus=function(){if(this._pickerRef&&this._pickerRef.current){var e=ve.findDOMNode(this._pickerRef.current).getElementsByTagName("input").item(0);e&&e.focus()}},t.prototype._logResolveSuggestion=function(e,t,n){n&&(this._currentQueryType=Object(ge.d)(t),e&&e.length?be._EngagementLogger.logEventWithLogEntry(new Ye._LogEntry("PeopleWebPart","PeopleSearcher.ResolveNonEmptyResults",Ye._LogType.Event,{type:this._currentQueryType,inputDetails:t.split("@")[1]||""})):be._EngagementLogger.logEventWithLogEntry(new Ye._LogEntry("PeopleWebPart","PeopleSearcher.ResolveEmptyResults",Ye._LogType.Event,{type:this._currentQueryType,inputDetails:t.split("@")[1]||""})))},t.prototype._updateAlertForResolvedSuggestions=function(e,t){var n,a=e[0];this._isUnmounted||(n=a?d.StringHelper.format(tt.n,tt.a,a.name||"",a.job||a.department||""):t?tt.t:tt.e,this._updateAlert(n))},t.prototype._updateAlert=function(e){u.ScreenReaderAlert.read(e,u.ReadingMode.ReadImmediately)},Object(s.__decorate)([l.autobind],t.prototype,"_logResolveSuggestion",null),Object(s.__decorate)([l.autobind],t.prototype,"_updateAlertForResolvedSuggestions",null),Object(s.__decorate)([l.autobind],t.prototype,"_updateAlert",null),t}(c.PureComponent),at=n("T+ck"),it=n("E8te"),rt=n("0iVW"),ot=16,st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._searcherRef=c.createRef(),t._dataSource=t._getDataSource(),t.focus=function(){t._searcherRef&&t._searcherRef.current&&t._searcherRef.current.focus()},t._handleAddPerson=function(e){var n=new be._QosMonitor("PeopleWebPart.PeopleCardPlaceholder.AddPerson");if(1===e.length){var a=e[0];t.props.onAddPerson(a),u.ScreenReaderAlert.read(d.StringHelper.format(rt.e,a.name),u.ReadingMode.ReadImmediately),n.writeSuccess(),be._EngagementLogger.logEvent("PeopleWebPart.PeopleCardPlaceholder.AddPerson")}else n.writeUnexpectedFailure("ItemCountNotRight",new Error("People card placeholder only allows adding one person a time."),{itemCount:e.length})},t}return Object(s.__extends)(t,e),t.prototype.render=function(){var e=Object(it.e)({isEditMode:!0,isFocusWithin:!1,layout:this.props.layout,variantTheme:this.props.variantTheme,width:this.props.width}),t=Object(l.mergeStyles)(at.e.card,e.card,this.props.layout===ge.r.SmallCard&&at.e.compactLayout,this.props.layout===ge.r.MediumCard&&at.e.mediumLayout,this.props.layout===ge.r.LargeCard&&at.e.largeLayout,this.props.center&&at.e.center);return c.createElement("div",{className:t,"data-is-focusable":!0,onFocus:this.focus,"data-layout":this.props.layout===ge.r.MediumCard?"mediumLayout":this.props.layout===ge.r.LargeCard?"largeLayout":"smallLayout"},c.createElement("div",{className:at.e.persona},c.createElement(l.PersonaCoin,{coinProps:{className:at.e.personaCoin},imageUrl:u.SPUtility.getUserPhotoUrl(),size:this.props.layout===ge.r.MediumCard?ot:this.props.personaSize}),c.createElement("div",{className:Object(l.mergeStyles)(at.e.personaDetails,at.e.placeholder,at.e.fluent)},c.createElement(nt,{ariaLabel:rt.t,dataSource:this._dataSource,onChangeSelectedPersons:this._handleAddPerson,ref:this._searcherRef,serviceScope:this.props.serviceScope,selectedPersons:this.props.selectedPersons,filterExternalUsers:this.props.filterExternalUsers}))))},t.prototype.componentDidMount=function(){this.props.focusOnMount&&this.focus()},t.prototype._getDataSource=function(){return this.props.serviceScope.consume(he.serviceKey).peoplePickerDataSource},t}(c.PureComponent)},K9kD:function(e,t){e.exports=c},Pk8u:function(e,t){e.exports=d},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},"T+ck":function(e,t,n){"use strict";n("jOlS").loadStyles('.c_b_a3a8085b .e_b_a3a8085b:focus{outline:none}.c_b_a3a8085b .f_b_a3a8085b{cursor:pointer}.c_b_a3a8085b .g_b_a3a8085b.h_b_a3a8085b input{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";text-overflow:ellipsis}.i_b_a3a8085b.j_b_a3a8085b:hover,.i_b_a3a8085b:focus{position:relative}.i_b_a3a8085b.j_b_a3a8085b:hover:after,.i_b_a3a8085b:focus:after{border:2px solid "[theme:neutralsecondaryalt, default: #8a8886]";bottom:-4px;content:"";left:-4px;pointer-events:none;position:absolute;right:-4px;top:-4px}.k_b_a3a8085b .l_b_a3a8085b,.k_b_a3a8085b .m_b_a3a8085b{flex-shrink:0}.c_b_a3a8085b{display:flex}.n_b_a3a8085b,.o_b_a3a8085b{font-weight:400}.n_b_a3a8085b:not(.h_b_a3a8085b),.o_b_a3a8085b:not(.h_b_a3a8085b){font-size:12px}.n_b_a3a8085b,.o_b_a3a8085b,.p_b_a3a8085b,.q_b_a3a8085b{display:block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.r_b_a3a8085b.c_b_a3a8085b{align-items:center;justify-content:space-between;padding:0 0 0 5px}[dir=rtl] .r_b_a3a8085b.c_b_a3a8085b{padding:0 5px 0 0}.r_b_a3a8085b.c_b_a3a8085b .e_b_a3a8085b{align-items:center;display:inline-flex;flex:1 1 0%;height:76px;min-width:0}.r_b_a3a8085b.c_b_a3a8085b .s_b_a3a8085b,.r_b_a3a8085b.c_b_a3a8085b .t_b_a3a8085b{flex:0 0 auto}.r_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b{min-width:0;width:100%}[dir=ltr] .r_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b{padding-left:12px}[dir=ltr] .r_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b.u_b_a3a8085b,[dir=rtl] .r_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b{padding-right:12px}[dir=rtl] .r_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b.u_b_a3a8085b{padding-left:12px}.r_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b:not(.h_b_a3a8085b){font-size:17px;font-weight:400}.v_b_a3a8085b.c_b_a3a8085b{align-items:center;display:grid;grid-template-columns:auto 32px;grid-template-rows:99px 34px 47px;height:180px;justify-content:space-between;max-width:286px}.v_b_a3a8085b.c_b_a3a8085b .e_b_a3a8085b{align-items:flex-start;display:flex;flex:1 1 0%;flex-direction:row;grid-column:1;grid-row:1;min-width:0;z-index:1}.v_b_a3a8085b.c_b_a3a8085b .s_b_a3a8085b,.v_b_a3a8085b.c_b_a3a8085b .t_b_a3a8085b{flex:0 0 auto;padding:21.5px 16px}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .s_b_a3a8085b,[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .t_b_a3a8085b{padding:21.5px 16px}.v_b_a3a8085b.c_b_a3a8085b .k_b_a3a8085b{align-self:flex-start;flex-direction:column;grid-column:2;grid-row:1}.v_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b{flex:1;min-width:0;padding:16px 0 0;width:100%}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b{padding:16px 0 0}.v_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b:not(.h_b_a3a8085b){font-size:17px;font-weight:400}.v_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b{flex:none;font-size:14px;font-weight:600;height:20px;line-height:20px;max-width:162px;order:0;padding:0 0 8px;text-overflow:ellipsis}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b{padding:0 0 8px}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b{left:0}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b,[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b{right:0}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b{left:0}.v_b_a3a8085b.c_b_a3a8085b .q_b_a3a8085b{flex:none;font-family:Segoe UI;font-size:14px;font-weight:600;height:20px;line-height:20px;max-width:162px;order:0;padding:0 0 8px;text-overflow:ellipsis}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .q_b_a3a8085b{padding:0 0 8px}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .q_b_a3a8085b{left:0}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .q_b_a3a8085b,[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .q_b_a3a8085b{right:0}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .q_b_a3a8085b{left:0}.v_b_a3a8085b.c_b_a3a8085b .n_b_a3a8085b{flex:none;font-size:12px;height:14px;line-height:120%;max-width:162px;order:1;padding:0 0 8px;text-overflow:ellipsis}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .n_b_a3a8085b{padding:0 0 8px}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .n_b_a3a8085b{left:0}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .n_b_a3a8085b,[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .n_b_a3a8085b{right:0}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .n_b_a3a8085b{left:0}.v_b_a3a8085b.c_b_a3a8085b .o_b_a3a8085b{flex:none;font-family:Segoe UI;font-size:12px;height:14px;line-height:120%;max-width:162px;order:1;padding:0 0 8px;text-overflow:ellipsis}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .o_b_a3a8085b{padding:0 0 8px}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .o_b_a3a8085b{left:0}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .o_b_a3a8085b,[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .o_b_a3a8085b{right:0}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .o_b_a3a8085b{left:0}.v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b{box-sizing:border-box;flex:1 0 auto;font-size:14px;grid-column:1/span 2;grid-row:2;height:34px;line-height:17px;margin-bottom:0;padding:0 16px;width:100%}.v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b .ms-TextField-fieldGroup{min-height:34px}.v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b .ms-TextField-description{display:inline-block;padding-bottom:21.5px;padding-top:7.5px}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b{padding:0 16px}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b{left:0}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b,[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b{right:0}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b{left:0}.v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b{box-sizing:border-box;flex:1 0 auto;font-family:Segoe UI;font-size:14px;grid-column:1/span 2;grid-row:2;height:34px;line-height:17px;margin-bottom:0;padding:0 16px;width:100%}.v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b .ms-TextField-fieldGroup{min-height:34px}.v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b .ms-TextField-description{display:inline-block;padding-bottom:21.5px;padding-top:7.5px}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b{padding:0 16px}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b{left:0}[dir=ltr] .v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b,[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b{right:0}[dir=rtl] .v_b_a3a8085b.c_b_a3a8085b .x_b_a3a8085b{left:0}.y_b_a3a8085b.c_b_a3a8085b{flex-direction:column;position:relative}.y_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b:not(.h_b_a3a8085b) input{font-size:17px}.y_b_a3a8085b.c_b_a3a8085b .e_b_a3a8085b{box-sizing:border-box;display:flex;flex-direction:column;height:calc(100% - 116px);padding:0 16px;width:100%}.y_b_a3a8085b.c_b_a3a8085b .e_b_a3a8085b button{min-width:0}.y_b_a3a8085b.c_b_a3a8085b .s_b_a3a8085b,.y_b_a3a8085b.c_b_a3a8085b .t_b_a3a8085b{align-self:center;margin:auto}.y_b_a3a8085b.c_b_a3a8085b .z_b_a3a8085b{position:relative}.y_b_a3a8085b.c_b_a3a8085b .z_b_a3a8085b:focus:after{border:2px solid;border-color:inherit;border-radius:inherit;border-radius:50%;bottom:-3px;content:"";left:-3px;pointer-events:none;position:absolute;right:-3px;top:-3px}.y_b_a3a8085b.c_b_a3a8085b .g_b_a3a8085b{height:78px}.y_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b:not(.h_b_a3a8085b){font-size:17px;font-weight:300}.y_b_a3a8085b.c_b_a3a8085b .n_b_a3a8085b,.y_b_a3a8085b.c_b_a3a8085b .p_b_a3a8085b{padding-bottom:8px}.y_b_a3a8085b.c_b_a3a8085b .w_b_a3a8085b{box-sizing:border-box;flex:1 0 auto;margin-bottom:0;padding:0 16px;width:100%}.y_b_a3a8085b.c_b_a3a8085b .aa_b_a3a8085b{align-self:center;margin-bottom:5px}.y_b_a3a8085b.c_b_a3a8085b.ab_b_a3a8085b .e_b_a3a8085b{display:none}.y_b_a3a8085b.c_b_a3a8085b.ab_b_a3a8085b .w_b_a3a8085b{padding-top:16px}.ac_b_a3a8085b{margin:auto}',!0),t.e={card:"c_b_a3a8085b",persona:"e_b_a3a8085b",hoverCard:"f_b_a3a8085b",personaDetails:"g_b_a3a8085b",fluent:"h_b_a3a8085b",cardFocusIndicatorImprovedContrastRatio:"i_b_a3a8085b",editMode:"j_b_a3a8085b",buttons:"k_b_a3a8085b",deleteButton:"l_b_a3a8085b",dragAndDropButton:"m_b_a3a8085b",secondaryText:"n_b_a3a8085b",secondaryTextLegacy:"o_b_a3a8085b",primaryText:"p_b_a3a8085b",primaryTextLegacy:"q_b_a3a8085b",compactLayout:"r_b_a3a8085b",personaCoin:"s_b_a3a8085b",livePersonaCard:"t_b_a3a8085b",placeholder:"u_b_a3a8085b",mediumLayout:"v_b_a3a8085b",description:"w_b_a3a8085b",descriptionLegacy:"x_b_a3a8085b",largeLayout:"y_b_a3a8085b",personaCoinFocusBorder:"z_b_a3a8085b",seeMoreButton:"aa_b_a3a8085b",hidePersona:"ab_b_a3a8085b",center:"ac_b_a3a8085b"}},U4ag:function(e,t){e.exports=l},UWqr:function(e,t){e.exports=u},"X+PM":function(e,t){e.exports=f},YDsL:function(e){e.exports=JSON.parse('{"s":"{0} {1}. {2} {3} {4}","a":"Use the right arrow key to enter this card, and then use the left and right arrow keys to move between elements in the card. Press Delete to remove the profile.","i":"Use the down arrow key to enter this card, and then use the up and down arrow keys to move between elements in the card. Press Delete to remove the profile.","n":"Drag profile to a new location","t":"Remove profile","l":"See less","d":"Show image and link for {0}.","f":"See more","u":"Hide image and link for {0}.","o":"Open details for {0}. Press Escape to close details.","e":"Details for {0} closed.","c":"Image for {0}. {1}","r":"Press Enter to open details for this person."}')},Ym2g:function(e){e.exports=JSON.parse('{"e":"People profiles"}')},br4S:function(e,t){e.exports=p},cDcd:function(e,t){e.exports=m},clF1:function(e){e.exports=JSON.parse('{"i":"People profiles. There are {0} people profiles yet. Use left and right arrow keys to move between profiles.||People profiles. There is {0} people profile. Use left and right arrow keys to move between profiles.||People profiles. There are {0} people profiles. Use left and right arrow keys to move between profiles.","o":"People profiles. There are {0} people profiles yet. Use up and down arrow keys to move between profiles.||People profiles. There is {0} people profile. Use up and down arrow keys to move between profiles.||People profiles. There are {0} people profiles. Use up and down arrow keys to move between profiles.","r":"0||1||2-","n":"Use ctrl + left arrow or ctrl + right arrow to reorder people profiles.","a":"Use ctrl + up arrow or ctrl + down arrow to reorder people profiles.","t":"{0} {1}","e":"The profile for {0} has been removed.","s":"The position of the profile for {0} is now {1}."}')},faye:function(e,t){e.exports=_},fglE:function(e,t){e.exports=h},fxVk:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_Icon},"hiL/":function(e,t){e.exports=b},iZ1p:function(e){e.exports=JSON.parse('{"n":"Search Directory","t":"Remove {0}","e":"Suggested people"}')},jOlS:function(e,t){e.exports=g},mFOl:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"u",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"s",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"r",function(){return m}),n.d(t,"l",function(){return _});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("281f1f12-ba14-4528-9f81-f914ebb9e493")}function r(){return a._SPFlight.isEnabled(60810)&&!a._SPKillSwitch.isActivated("9db97186-3423-4438-a681-cbad28ecaaac")}function o(){return a._SPFlight.isEnabled(60803)||a._SPFlight.isEnabled(60804)}function s(){return a._SPFlight.isEnabled(60803)}function c(){return 1===a._SPExperiment.getVariantAndLogExposure(90163)||a._SPFlight.isEnabled(1438)}function d(){return a._SPKillSwitch.isActivated("98b10987-91a5-42b8-b213-e0ba97630f44")}function l(){return a._SPKillSwitch.isActivated("37c10af0-0fa9-4834-a05c-11a719f93ffb")}function u(){return a._SPKillSwitch.isActivated("d2ad9fdc-2d80-4862-961a-c9676472d5a0")}function f(){return a._SPFlight.isEnabled(1725)}function p(){return a._SPKillSwitch.isActivated("82a4c132-8234-4864-8654-ef7a9dc3a04a")}function m(){return a._SPKillSwitch.isActivated("5a8b5aa8-12f9-4a8d-bc85-7bd1b9638c9d")}function _(){return a._SPKillSwitch.isActivated("6d0835d1-775a-488e-87e1-c517da4b97a3")}},nOp6:function(e,t,n){"use strict";n.d(t,"e",function(){return te}),n.d(t,"t",function(){return ne});var a={};n.r(a),n.d(a,"root",function(){return v}),n.d(a,"suggestionsItem",function(){return y}),n.d(a,"closeButton",function(){return S}),n.d(a,"suggestionsItemIsSuggested",function(){return D}),n.d(a,"itemButton",function(){return I}),n.d(a,"actionButton",function(){return x}),n.d(a,"buttonSelected",function(){return C}),n.d(a,"suggestionsTitle",function(){return O}),n.d(a,"suggestionsContainer",function(){return w}),n.d(a,"suggestionsNone",function(){return E}),n.d(a,"suggestionsSpinner",function(){return A}),n.d(a,"suggestionsAvailable",function(){return L});var i={};n.r(i),n.d(i,"picker",function(){return W}),n.d(i,"pickerText",function(){return q}),n.d(i,"inputFocused",function(){return Q}),n.d(i,"inputDisabled",function(){return Y}),n.d(i,"pickerInput",function(){return J}),n.d(i,"pickerItems",function(){return X}),n.d(i,"screenReaderOnly",function(){return Z});var r,o=n("17wl"),s=n("cDcd"),c=n("5pbq"),d=n("vNcA"),l="data-selection-index",u="data-selection-toggle",f="data-selection-invoke",p="data-selection-all-toggle",m=function(e){function t(t){var n=e.call(this,t)||this;n._root=s.createRef(),n.ignoreNextFocus=function(){n._handleNextFocus(!1)},n._onSelectionChange=function(){var e=n.props.selection,t=e.isModal&&e.isModal();n.setState({isModal:t})},n._onMouseDownCapture=function(e){var t=e.target;if(document.activeElement===t||Object(c.elementContains)(document.activeElement,t)){if(Object(c.elementContains)(t,n._root.current))for(;t!==n._root.current;){if(n._hasAttribute(t,f)){n.ignoreNextFocus();break}t=Object(c.getParent)(t)}}else n.ignoreNextFocus()},n._onFocus=function(e){var t=e.target,a=n.props.selection,i=n._isCtrlPressed||n._isMetaPressed,r=n._getSelectionMode();if(n._shouldHandleFocus&&r!==d.SelectionMode.none){var o=n._hasAttribute(t,u),s=n._findItemRoot(t);if(!o&&s){var c=n._getItemIndex(s);void 0===n._getItemSpan(s)&&(i?(a.setIndexSelected(c,a.isIndexSelected(c),!0),n.props.enterModalOnTouch&&n._isTouch&&a.setModal&&(a.setModal(!0),n._setIsTouch(!1))):n.props.isSelectedOnFocus&&n._onItemSurfaceClick("focus",c))}}n._handleNextFocus(!1)},n._onMouseDown=function(e){n._updateModifiers(e);var t=n.props.toggleWithoutModifierPressed,a=e.target,i=n._findItemRoot(a);if(!n._isSelectionDisabled(a))for(;a!==n._root.current&&!n._hasAttribute(a,p);){if(i){if(n._hasAttribute(a,u))break;if(n._hasAttribute(a,f))break;if(!(a!==i&&!n._shouldAutoSelect(a)||n._isShiftPressed||n._isCtrlPressed||n._isMetaPressed||t)){n._onInvokeMouseDown(e,n._getItemIndex(i),n._getItemSpan(i));break}if(n.props.disableAutoSelectOnInputElements&&("A"===a.tagName||"BUTTON"===a.tagName||"INPUT"===a.tagName))return}a=Object(c.getParent)(a)}},n._onTouchStartCapture=function(e){n._setIsTouch(!0)},n._onClick=function(e){var t=n.props.enableTouchInvocationTarget,a=void 0!==t&&t;n._updateModifiers(e);for(var i=e.target,r=n._findItemRoot(i),o=n._isSelectionDisabled(i);i!==n._root.current;){if(n._hasAttribute(i,p)){o||n._onToggleAllClick(e);break}if(r){var s=n._getItemIndex(r),d=n._getItemSpan(r);if(n._hasAttribute(i,u)){o||(n._isShiftPressed?n._onItemSurfaceClick("click",s,d):n._onToggleClick(e,s,d));break}if(n._isTouch&&a&&n._hasAttribute(i,"data-selection-touch-invoke")||n._hasAttribute(i,f)){void 0===d&&n._onInvokeClick(e,s);break}if(i===r){o||n._onItemSurfaceClick("click",s,d);break}if("A"===i.tagName||"BUTTON"===i.tagName||"INPUT"===i.tagName)return}i=Object(c.getParent)(i)}},n._onContextMenu=function(e){var t=e.target,a=n.props,i=a.onItemContextMenu,r=a.selection;if(i){var o=n._findItemRoot(t);if(o){var s=n._getItemIndex(o);n._onInvokeMouseDown(e,s),i(r.getItems()[s],s,e.nativeEvent)||e.preventDefault()}}},n._onDoubleClick=function(e){var t=e.target,a=n.props.onItemInvoked,i=n._findItemRoot(t);if(i&&a&&!n._isInputElement(t)){for(var r=n._getItemIndex(i);t!==n._root.current&&!n._hasAttribute(t,u)&&!n._hasAttribute(t,f);){if(t===i){n._onInvokeClick(e,r);break}t=Object(c.getParent)(t)}t=Object(c.getParent)(t)}},n._onKeyDownCapture=function(e){n._updateModifiers(e),n._handleNextFocus(!0)},n._onKeyDown=function(e){n._updateModifiers(e);var t=e.target,a=n._isSelectionDisabled(t),i=n.props,r=i.selection,o=i.selectionClearedOnEscapePress,s=e.which===c.KeyCodes.a&&(n._isCtrlPressed||n._isMetaPressed),l=e.which===c.KeyCodes.escape;if(!n._isInputElement(t)){var f=n._getSelectionMode();if(s&&f===d.SelectionMode.multiple&&!r.isAllSelected())return a||r.setAllSelected(!0),e.stopPropagation(),void e.preventDefault();if(o&&l&&r.getSelectedCount()>0)return a||r.setAllSelected(!1),e.stopPropagation(),void e.preventDefault();var p=n._findItemRoot(t);if(p)for(var m=n._getItemIndex(p),_=n._getItemSpan(p);t!==n._root.current&&!n._hasAttribute(t,u);){if(n._shouldAutoSelect(t)){a||void 0!==_||n._onInvokeMouseDown(e,m,_);break}if(!(e.which!==c.KeyCodes.enter&&e.which!==c.KeyCodes.space||"BUTTON"!==t.tagName&&"A"!==t.tagName&&"INPUT"!==t.tagName&&"SUMMARY"!==t.tagName))return!1;if(t===p){if(e.which===c.KeyCodes.enter)return void(void 0===_&&(n._onInvokeClick(e,m),e.preventDefault()));if(e.which===c.KeyCodes.space)return a||n._onToggleClick(e,m,_),void e.preventDefault();break}t=Object(c.getParent)(t)}}},n._events=new c.EventGroup(n),n._async=new c.Async(n),Object(c.initializeComponentRef)(n);var a=n.props.selection,i=a.isModal&&a.isModal();return n.state={isModal:i},n}return Object(o.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.selection.isModal&&e.selection.isModal();return Object(o.__assign)(Object(o.__assign)({},t),{isModal:n})},t.prototype.componentDidMount=function(){var e=Object(c.getWindow)(this._root.current);this._events.on(e,"keydown, keyup",this._updateModifiers,!0),this._events.on(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(document.body,"touchstart",this._onTouchStartCapture,!0),this._events.on(document.body,"touchend",this._onTouchStartCapture,!0),this._events.on(this.props.selection,"change",this._onSelectionChange)},t.prototype.render=function(){var e=this.state.isModal;return s.createElement("div",{className:Object(c.css)("ms-SelectionZone",this.props.className,{"ms-SelectionZone--modal":!!e}),ref:this._root,onKeyDown:this._onKeyDown,onMouseDown:this._onMouseDown,onKeyDownCapture:this._onKeyDownCapture,onClick:this._onClick,role:"presentation",onDoubleClick:this._onDoubleClick,onContextMenu:this._onContextMenu,onMouseDownCapture:this._onMouseDownCapture,onFocusCapture:this._onFocus,"data-selection-is-modal":!!e||void 0},this.props.children,s.createElement(c.FocusRects,null))},t.prototype.componentDidUpdate=function(e){var t=this.props.selection;t!==e.selection&&(this._events.off(e.selection),this._events.on(t,"change",this._onSelectionChange))},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype._isSelectionDisabled=function(e){if(this._getSelectionMode()===d.SelectionMode.none)return!0;for(;e!==this._root.current;){if(this._hasAttribute(e,"data-selection-disabled"))return!0;e=Object(c.getParent)(e)}return!1},t.prototype._onToggleAllClick=function(e){var t=this.props.selection;this._getSelectionMode()===d.SelectionMode.multiple&&(t.toggleAllSelected(),e.stopPropagation(),e.preventDefault())},t.prototype._onToggleClick=function(e,t,n){var a=this.props.selection,i=this._getSelectionMode();if(a.setChangeEvents(!1),this.props.enterModalOnTouch&&this._isTouch&&(void 0!==n?!a.isRangeSelected(t,n):!a.isIndexSelected(t))&&a.setModal&&(a.setModal(!0),this._setIsTouch(!1)),i===d.SelectionMode.multiple)void 0!==n?a.toggleRangeSelected(t,n):a.toggleIndexSelected(t);else{if(i!==d.SelectionMode.single)return void a.setChangeEvents(!0);if(void 0===n||1===n){var r=a.isIndexSelected(t),o=a.isModal&&a.isModal();a.setAllSelected(!1),a.setIndexSelected(t,!r,!0),o&&a.setModal&&a.setModal(!0)}}a.setChangeEvents(!0),e.stopPropagation()},t.prototype._onInvokeClick=function(e,t){var n=this.props,a=n.selection,i=n.onItemInvoked;i&&(i(a.getItems()[t],t,e.nativeEvent),e.preventDefault(),e.stopPropagation())},t.prototype._onItemSurfaceClick=function(e,t,n){var a,i=this.props,r=i.selection,o=i.toggleWithoutModifierPressed,s=this._isCtrlPressed||this._isMetaPressed,c=this._getSelectionMode();c===d.SelectionMode.multiple?this._isShiftPressed&&!this._isTabPressed?void 0!==n?null===(a=r.selectToRange)||void 0===a||a.call(r,t,n,!s):r.selectToIndex(t,!s):"click"===e&&(s||o)?void 0!==n?r.toggleRangeSelected(t,n):r.toggleIndexSelected(t):this._clearAndSelectIndex(t,n):c===d.SelectionMode.single&&this._clearAndSelectIndex(t,n)},t.prototype._onInvokeMouseDown=function(e,t,n){var a=this.props.selection;if(void 0!==n){if(a.isRangeSelected(t,n))return}else if(a.isIndexSelected(t))return;this._clearAndSelectIndex(t,n)},t.prototype._findScrollParentAndTryClearOnEmptyClick=function(e){var t=Object(c.findScrollableParent)(this._root.current);this._events.off(document,"click",this._findScrollParentAndTryClearOnEmptyClick),this._events.on(t,"click",this._tryClearOnEmptyClick),(t&&e.target instanceof Node&&t.contains(e.target)||t===e.target)&&this._tryClearOnEmptyClick(e)},t.prototype._tryClearOnEmptyClick=function(e){!this.props.selectionPreservedOnEmptyClick&&this._isNonHandledClick(e.target)&&this.props.selection.setAllSelected(!1)},t.prototype._clearAndSelectIndex=function(e,t){var n,a=this.props,i=a.selection,r=a.selectionClearedOnSurfaceClick,o=void 0===r||r;if((void 0!==t&&1!==t||1!==i.getSelectedCount()||!i.isIndexSelected(e))&&o){var s=i.isModal&&i.isModal();i.setChangeEvents(!1),i.setAllSelected(!1),void 0!==t?null===(n=i.setRangeSelected)||void 0===n||n.call(i,e,t,!0,!0):i.setIndexSelected(e,!0,!0),(s||this.props.enterModalOnTouch&&this._isTouch)&&(i.setModal&&i.setModal(!0),this._isTouch&&this._setIsTouch(!1)),i.setChangeEvents(!0)}},t.prototype._updateModifiers=function(e){this._isShiftPressed=e.shiftKey,this._isCtrlPressed=e.ctrlKey,this._isMetaPressed=e.metaKey;var t=e.keyCode;this._isTabPressed=!!t&&t===c.KeyCodes.tab},t.prototype._findItemRoot=function(e){for(var t=this.props.selection;e!==this._root.current;){var n=e.getAttribute(l),a=Number(n);if(null!==n&&a>=0&&a<t.getItems().length)break;e=Object(c.getParent)(e)}if(e!==this._root.current)return e},t.prototype._getItemIndex=function(e){var t,n=parseInt(null!==(t=e.getAttribute(l))&&void 0!==t?t:"",10);return isNaN(n)?-1:n},t.prototype._getItemSpan=function(e){var t,n=parseInt(null!==(t=e.getAttribute("data-selection-span"))&&void 0!==t?t:"",10);return isNaN(n)?void 0:n},t.prototype._shouldAutoSelect=function(e){return this._hasAttribute(e,"data-selection-select")},t.prototype._hasAttribute=function(e,t){for(var n=!1;!n&&e!==this._root.current;){var a=e.getAttribute(t);if("false"===a){n=!1;break}n="true"===a,e=Object(c.getParent)(e)}return n},t.prototype._isInputElement=function(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"true"===e.getAttribute("contenteditable")||""===e.getAttribute("contenteditable")},t.prototype._isNonHandledClick=function(e){var t=Object(c.getDocument)();if(t&&e)for(;e&&e!==t.documentElement;){if(Object(c.isElementTabbable)(e)||e.hasAttribute("data-selection-index"))return!1;e=Object(c.getParent)(e)}return!0},t.prototype._handleNextFocus=function(e){var t=this;this._shouldHandleFocusTimeoutId&&(this._async.clearTimeout(this._shouldHandleFocusTimeoutId),this._shouldHandleFocusTimeoutId=void 0),this._shouldHandleFocus=e,e&&this._async.setTimeout(function(){t._shouldHandleFocus=!1},100)},t.prototype._setIsTouch=function(e){var t=this;this._isTouchTimeoutId&&(this._async.clearTimeout(this._isTouchTimeoutId),this._isTouchTimeoutId=void 0),this._isTouch=!0,e&&this._async.setTimeout(function(){t._isTouch=!1},300)},t.prototype._getSelectionMode=function(){var e=this.props.selection,t=this.props.selectionMode;return void 0===t?e?e.mode:d.SelectionMode.none:t},t.defaultProps={isSelectedOnFocus:!0,toggleWithoutModifierPressed:!1,selectionMode:d.SelectionMode.multiple,selectionClearedOnEscapePress:!0},t}(s.Component),_=Object(c.classNamesFunction)(),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.message,n=e.styles,a=e.as,i=void 0===a?"div":a,r=e.className,d=_(n,{className:r});return s.createElement(i,Object(o.__assign)({role:"status",className:d.root},Object(c.getNativeProps)(this.props,c.divProperties,["className"])),s.createElement(c.DelayedRender,null,s.createElement("div",{className:d.screenReaderText},t)))},t.defaultProps={"aria-live":"polite"},t}(s.Component),b=Object(c.styled)(h,function(e){return{root:e.className,screenReaderText:c.hiddenContentStyle}});!function(e){e[e.none=0]="none",e[e.forceResolve=1]="forceResolve",e[e.searchMore=2]="searchMore"}(r||(r={}));var g=n("jOlS");Object(g.loadStyles)([{rawString:".root_8c91000a{min-width:260px}.suggestionsItem_8c91000a{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;position:relative;overflow:hidden}.suggestionsItem_8c91000a:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.suggestionsItem_8c91000a:hover .closeButton_8c91000a{display:block}.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a:hover{background:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a{background:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a .closeButton_8c91000a:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.suggestionsItem_8c91000a.suggestionsItemIsSuggested_8c91000a .itemButton_8c91000a{color:HighlightText}}.suggestionsItem_8c91000a .closeButton_8c91000a{display:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.suggestionsItem_8c91000a .closeButton_8c91000a:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.actionButton_8c91000a{background-color:transparent;border:0;cursor:pointer;margin:0;position:relative;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:40px;width:100%;font-size:12px}[dir=ltr] .actionButton_8c91000a{padding-left:8px}[dir=rtl] .actionButton_8c91000a{padding-right:8px}html[dir=ltr] .actionButton_8c91000a{text-align:left}html[dir=rtl] .actionButton_8c91000a{text-align:right}.actionButton_8c91000a:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";cursor:pointer}.actionButton_8c91000a:active,.actionButton_8c91000a:focus{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_8c91000a .ms-Button-icon{font-size:16px;width:25px}.actionButton_8c91000a .ms-Button-label{margin:0 4px 0 9px}html[dir=rtl] .actionButton_8c91000a .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_8c91000a{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.suggestionsTitle_8c91000a{padding:0 12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsContainer_8c91000a{overflow-y:auto;overflow-x:hidden;max-height:300px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.suggestionsNone_8c91000a{text-align:center;color:#797775;font-size:12px;line-height:30px}.suggestionsSpinner_8c91000a{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir=ltr] .suggestionsSpinner_8c91000a{padding-left:14px}html[dir=rtl] .suggestionsSpinner_8c91000a{padding-right:14px}html[dir=ltr] .suggestionsSpinner_8c91000a{text-align:left}html[dir=rtl] .suggestionsSpinner_8c91000a{text-align:right}.suggestionsSpinner_8c91000a .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_8c91000a .ms-Spinner-label{display:inline-block;margin:0 10px 0 16px;vertical-align:middle}html[dir=rtl] .suggestionsSpinner_8c91000a .ms-Spinner-label{margin:0 16px 0 10px}.itemButton_8c91000a.itemButton_8c91000a{width:100%;padding:0;min-width:0;height:100%}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.itemButton_8c91000a.itemButton_8c91000a{color:WindowText}}.itemButton_8c91000a.itemButton_8c91000a:hover{color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.closeButton_8c91000a.closeButton_8c91000a{padding:0 4px;height:auto;width:32px}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.closeButton_8c91000a.closeButton_8c91000a{color:WindowText}}.closeButton_8c91000a.closeButton_8c91000a:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:"}.suggestionsAvailable_8c91000a{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);var v="root_8c91000a",y="suggestionsItem_8c91000a",S="closeButton_8c91000a",D="suggestionsItemIsSuggested_8c91000a",I="itemButton_8c91000a",x="actionButton_8c91000a",C="buttonSelected_8c91000a",O="suggestionsTitle_8c91000a",w="suggestionsContainer_8c91000a",E="suggestionsNone_8c91000a",A="suggestionsSpinner_8c91000a",L="suggestionsAvailable_8c91000a",k=a,M=Object(c.classNamesFunction)(),P=function(e){function t(t){var n=e.call(this,t)||this;return Object(c.initializeComponentRef)(n),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.suggestionModel,a=t.RenderSuggestion,i=t.onClick,r=t.className,o=t.id,d=t.onRemoveItem,l=t.isSelectedOverride,u=t.removeButtonAriaLabel,f=t.styles,p=t.theme,m=t.removeButtonIconProps,_=f?M(f,{theme:p,className:r,suggested:n.selected||l}):{root:Object(c.css)("ms-Suggestions-item",k.suggestionsItem,(e={},e["is-suggested "+k.suggestionsItemIsSuggested]=n.selected||l,e),r),itemButton:Object(c.css)("ms-Suggestions-itemButton",k.itemButton),closeButton:Object(c.css)("ms-Suggestions-closeButton",k.closeButton)};return s.createElement("div",{className:_.root,role:"presentation"},s.createElement(c.CommandButton,{onClick:i,className:_.itemButton,id:o,"aria-selected":n.selected,role:"option","aria-label":n.ariaLabel},a(n.item,this.props)),this.props.showRemoveButton?s.createElement(c.IconButton,{iconProps:null!=m?m:{iconName:"Cancel"},styles:{icon:{fontSize:"12px"}},title:u,ariaLabel:u,onClick:d,className:_.closeButton}):null)},t}(s.Component),T={root:"ms-Suggestions-item",itemButton:"ms-Suggestions-itemButton",closeButton:"ms-Suggestions-closeButton",isSuggested:"is-suggested"},U=a,F=Object(c.classNamesFunction)(),H=Object(c.styled)(P,function(e){var t,n,a,i,r,s,d=e.className,l=e.theme,u=e.suggested,f=l.palette,p=l.semanticColors,m=Object(c.getGlobalClassNames)(T,l);return{root:[m.root,{display:"flex",alignItems:"stretch",boxSizing:"border-box",width:"100%",position:"relative",selectors:{"&:hover":{background:p.menuItemBackgroundHovered},"&:hover .ms-Suggestions-closeButton":{display:"block"}}},u&&{selectors:(t={},t[".".concat(c.IsFocusVisibleClassName," &")]={selectors:(n={},n[".".concat(m.closeButton)]={display:"block",background:p.menuItemBackgroundPressed},n)},t[":after"]={pointerEvents:"none",content:'""',position:"absolute",left:0,top:0,bottom:0,right:0,border:"1px solid ".concat(l.semanticColors.focusBorder)},t)},d],itemButton:[m.itemButton,{width:"100%",padding:0,border:"none",height:"100%",minWidth:0,overflow:"hidden",selectors:(a={},a[c.HighContrastSelector]={color:"WindowText",selectors:{":hover":Object(o.__assign)({background:"Highlight",color:"HighlightText"},Object(c.getHighContrastNoAdjustStyle)())}},a[":hover"]={color:p.menuItemTextHovered},a)},u&&[m.isSuggested,{background:p.menuItemBackgroundPressed,selectors:(i={":hover":{background:p.menuDivider}},i[c.HighContrastSelector]=Object(o.__assign)({background:"Highlight",color:"HighlightText"},Object(c.getHighContrastNoAdjustStyle)()),i)}]],closeButton:[m.closeButton,{display:"none",color:f.neutralSecondary,padding:"0 4px",height:"auto",width:32,selectors:(r={":hover, :active":{background:f.neutralTertiaryAlt,color:f.neutralDark}},r[c.HighContrastSelector]={color:"WindowText"},r)},u&&(s={},s[".".concat(c.IsFocusVisibleClassName," &")]={selectors:{":hover, :active":{background:f.neutralTertiary}}},s.selectors={":hover, :active":{background:f.neutralTertiary,color:f.neutralPrimary}},s)]}},void 0,{scope:"SuggestionItem"}),R=function(e){function t(t){var n=e.call(this,t)||this;return n._forceResolveButton=s.createRef(),n._searchForMoreButton=s.createRef(),n._selectedElement=s.createRef(),n._scrollContainer=s.createRef(),n.tryHandleKeyDown=function(e,t){var a=!1,i=null,o=n.state.selectedActionType,s=n.props.suggestions.length;if(e===c.KeyCodes.down)switch(o){case r.forceResolve:s>0?(n._refocusOnSuggestions(e),i=r.none):i=n._searchForMoreButton.current?r.searchMore:r.forceResolve;break;case r.searchMore:n._forceResolveButton.current?i=r.forceResolve:s>0?(n._refocusOnSuggestions(e),i=r.none):i=r.searchMore;break;case r.none:-1===t&&n._forceResolveButton.current&&(i=r.forceResolve)}else if(e===c.KeyCodes.up)switch(o){case r.forceResolve:n._searchForMoreButton.current?i=r.searchMore:s>0&&(n._refocusOnSuggestions(e),i=r.none);break;case r.searchMore:s>0?(n._refocusOnSuggestions(e),i=r.none):n._forceResolveButton.current&&(i=r.forceResolve);break;case r.none:-1===t&&n._searchForMoreButton.current&&(i=r.searchMore)}return null!==i&&(n.setState({selectedActionType:i}),a=!0),a},n._getAlertText=function(){var e=n.props,t=e.isLoading,a=e.isSearching,i=e.suggestions,r=e.suggestionsAvailableAlertText,o=e.noResultsFoundText,s=e.isExtendedLoading,c=e.loadingText;if(t||a){if(t&&s)return c||""}else{if(i.length>0)return r||"";if(o)return o}return""},n._getMoreResults=function(){n.props.onGetMoreResults&&(n.props.onGetMoreResults(),n.setState({selectedActionType:r.none}))},n._forceResolve=function(){n.props.createGenericItem&&n.props.createGenericItem()},n._shouldShowForceResolve=function(){return!!n.props.showForceResolve&&n.props.showForceResolve()},n._onClickTypedSuggestionsItem=function(e,t){return function(a){n.props.onSuggestionClick(a,e,t)}},n._refocusOnSuggestions=function(e){"function"==typeof n.props.refocusSuggestions&&n.props.refocusSuggestions(e)},n._onRemoveTypedSuggestionsItem=function(e,t){return function(a){(0,n.props.onSuggestionRemove)(a,e,t),a.stopPropagation()}},Object(c.initializeComponentRef)(n),n.state={selectedActionType:r.none},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.scrollSelected(),this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null},t.prototype.componentDidUpdate=function(){this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current&&(this.scrollSelected(),this.activeSelectedElement=this._selectedElement.current)},t.prototype.render=function(){var e,t,n=this,a=this.props,i=a.forceResolveText,d=a.mostRecentlyUsedHeaderText,l=a.searchForMoreIcon,u=a.searchForMoreText,f=a.className,p=a.moreSuggestionsAvailable,m=a.noResultsFoundText,_=a.suggestions,h=a.isLoading,g=a.isSearching,v=a.loadingText,y=a.onRenderNoResultFound,S=a.searchingText,D=a.isMostRecentlyUsedVisible,I=a.resultsMaximumNumber,x=a.resultsFooterFull,C=a.resultsFooter,O=a.isResultsFooterVisible,w=void 0===O||O,E=a.suggestionsHeaderText,A=a.suggestionsClassName,L=a.theme,k=a.styles,M=a.suggestionsListId,P=a.suggestionsContainerAriaLabel;this._classNames=k?F(k,{theme:L,className:f,suggestionsClassName:A,forceResolveButtonSelected:this.state.selectedActionType===r.forceResolve,searchForMoreButtonSelected:this.state.selectedActionType===r.searchMore}):{root:Object(c.css)("ms-Suggestions",f,U.root),title:Object(c.css)("ms-Suggestions-title",U.suggestionsTitle),searchForMoreButton:Object(c.css)("ms-SearchMore-button",U.actionButton,(e={},e["is-selected "+U.buttonSelected]=this.state.selectedActionType===r.searchMore,e)),forceResolveButton:Object(c.css)("ms-forceResolve-button",U.actionButton,(t={},t["is-selected "+U.buttonSelected]=this.state.selectedActionType===r.forceResolve,t)),suggestionsAvailable:Object(c.css)("ms-Suggestions-suggestionsAvailable",U.suggestionsAvailable),suggestionsContainer:Object(c.css)("ms-Suggestions-container",U.suggestionsContainer,A),noSuggestions:Object(c.css)("ms-Suggestions-none",U.suggestionsNone)};var T=this._classNames.subComponentStyles?this._classNames.subComponentStyles.spinner:void 0,H=k?{styles:T}:{className:Object(c.css)("ms-Suggestions-spinner",U.suggestionsSpinner)},R=E;D&&d&&(R=d);var N=void 0;w&&(N=_.length>=I?x:C);var B,j=!(_&&_.length||h),V=this.state.selectedActionType===r.forceResolve?"sug-selectedAction":void 0,z=this.state.selectedActionType===r.searchMore?"sug-selectedAction":void 0;return s.createElement("div",{className:this._classNames.root,"aria-label":P||R,id:M,role:"listbox"},s.createElement(b,{message:this._getAlertText(),"aria-live":"polite"}),R?s.createElement("div",{className:this._classNames.title},R):null,i&&this._shouldShowForceResolve()&&s.createElement(c.CommandButton,{componentRef:this._forceResolveButton,className:this._classNames.forceResolveButton,id:V,onClick:this._forceResolve,"data-automationid":"sug-forceResolve"},i),h&&s.createElement(c.Spinner,Object(o.__assign)({},H,{ariaLabel:v,label:v})),j?(B=function(){return s.createElement("div",{className:n._classNames.noSuggestions},m)},s.createElement("div",{id:"sug-noResultsFound",role:"option"},y?y(void 0,B):B())):this._renderSuggestions(),u&&p&&s.createElement(c.CommandButton,{componentRef:this._searchForMoreButton,className:this._classNames.searchForMoreButton,iconProps:l||{iconName:"Search"},id:z,onClick:this._getMoreResults,"data-automationid":"sug-searchForMore",role:"option"},u),g?s.createElement(c.Spinner,Object(o.__assign)({},H,{ariaLabel:S,label:S})):null,!N||p||D||g?null:s.createElement("div",{className:this._classNames.title},N(this.props)))},t.prototype.hasSuggestedAction=function(){return!!this._searchForMoreButton.current||!!this._forceResolveButton.current},t.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==r.none},t.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case r.forceResolve:this._forceResolve();break;case r.searchMore:this._getMoreResults()}},t.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:r.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:r.searchMore})},t.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:r.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:r.forceResolve})},t.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()},t.prototype.scrollSelected=function(){if(this._selectedElement.current&&this._scrollContainer.current&&void 0!==this._scrollContainer.current.scrollTo){var e=this._selectedElement.current,t=e.offsetHeight,n=e.offsetTop,a=this._scrollContainer.current,i=a.offsetHeight,r=a.scrollTop,o=n+t>r+i;n<r?this._scrollContainer.current.scrollTo(0,n):o&&this._scrollContainer.current.scrollTo(0,n-i+t)}},t.prototype._renderSuggestions=function(){var e=this,t=this.props,n=t.onRenderSuggestion,a=t.removeSuggestionAriaLabel,i=t.suggestionsItemClassName,r=t.resultsMaximumNumber,o=t.showRemoveButtons,c=t.removeButtonIconProps,d=this.props.suggestions,l=H,u=-1;return d.some(function(e,t){return!!e.selected&&(u=t,!0)}),r&&(d=u>=r?d.slice(u-r+1,u+1):d.slice(0,r)),0===d.length?null:s.createElement("div",{className:this._classNames.suggestionsContainer,ref:this._scrollContainer,role:"presentation"},d.map(function(t,r){return s.createElement("div",{ref:t.selected?e._selectedElement:void 0,key:t.item.key?t.item.key:r,role:"presentation"},s.createElement(l,{suggestionModel:t,RenderSuggestion:n,onClick:e._onClickTypedSuggestionsItem(t.item,r),className:i,showRemoveButton:o,removeButtonAriaLabel:a,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,r),id:"sug-"+r,removeButtonIconProps:c}))}))},t}(s.Component),N={root:"ms-Suggestions",suggestionsContainer:"ms-Suggestions-container",title:"ms-Suggestions-title",forceResolveButton:"ms-forceResolve-button",searchForMoreButton:"ms-SearchMore-button",spinner:"ms-Suggestions-spinner",noSuggestions:"ms-Suggestions-none",suggestionsAvailable:"ms-Suggestions-suggestionsAvailable",isSelected:"is-selected"};function B(e){var t,n=e.className,a=e.suggestionsClassName,i=e.theme,r=e.forceResolveButtonSelected,s=e.searchForMoreButtonSelected,d=i.palette,l=i.semanticColors,u=i.fonts,f=Object(c.getGlobalClassNames)(N,i),p={backgroundColor:"transparent",border:0,cursor:"pointer",margin:0,paddingLeft:8,position:"relative",borderTop:"1px solid ".concat(d.neutralLight),height:40,textAlign:"left",width:"100%",fontSize:u.small.fontSize,selectors:{":hover":{backgroundColor:l.menuItemBackgroundPressed,cursor:"pointer"},":focus, :active":{backgroundColor:d.themeLight},".ms-Button-icon":{fontSize:u.mediumPlus.fontSize,width:25},".ms-Button-label":{margin:"0 4px 0 9px"}}},m={backgroundColor:d.themeLight,selectors:(t={},t[c.HighContrastSelector]=Object(o.__assign)({backgroundColor:"Highlight",borderColor:"Highlight",color:"HighlightText"},Object(c.getHighContrastNoAdjustStyle)()),t)};return{root:[f.root,{minWidth:260},n],suggestionsContainer:[f.suggestionsContainer,{overflowY:"auto",overflowX:"hidden",maxHeight:300,transform:"translate3d(0,0,0)"},a],title:[f.title,{padding:"0 12px",fontSize:u.small.fontSize,color:d.themePrimary,lineHeight:40,borderBottom:"1px solid ".concat(l.menuItemBackgroundPressed)}],forceResolveButton:[f.forceResolveButton,p,r&&[f.isSelected,m]],searchForMoreButton:[f.searchForMoreButton,p,s&&[f.isSelected,m]],noSuggestions:[f.noSuggestions,{textAlign:"center",color:d.neutralSecondary,fontSize:u.small.fontSize,lineHeight:30}],suggestionsAvailable:[f.suggestionsAvailable,c.hiddenContentStyle],subComponentStyles:{spinner:{root:[f.spinner,{margin:"5px 0",paddingLeft:14,textAlign:"left",whiteSpace:"nowrap",lineHeight:20,fontSize:u.small.fontSize}],circle:{display:"inline-block",verticalAlign:"middle"},label:{display:"inline-block",verticalAlign:"middle",margin:"0 10px 0 16px"}}}}}var j,V=function(){function e(){var e=this;this._isSuggestionModel=function(e){return void 0!==e.item},this._ensureSuggestionModel=function(t){return e._isSuggestionModel(t)?t:{item:t,selected:!1,ariaLabel:t.name||t.primaryText}},this.suggestions=[],this.currentIndex=-1}return e.prototype.updateSuggestions=function(e,t,n){if(e&&e.length>0){if(n&&e.length>n){var a=t&&t>n?t+1-n:0;e=e.slice(a,a+n-1)}this.suggestions=this.convertSuggestionsToSuggestionItems(e),this.currentIndex=t||0,-1===t?this.currentSuggestion=void 0:void 0!==t&&(this.suggestions[t].selected=!0,this.currentSuggestion=this.suggestions[t])}else this.suggestions=[],this.currentIndex=-1,this.currentSuggestion=void 0},e.prototype.nextSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex<this.suggestions.length-1)return this.setSelectedSuggestion(this.currentIndex+1),!0;if(this.currentIndex===this.suggestions.length-1)return this.setSelectedSuggestion(0),!0}return!1},e.prototype.previousSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex>0)return this.setSelectedSuggestion(this.currentIndex-1),!0;if(0===this.currentIndex)return this.setSelectedSuggestion(this.suggestions.length-1),!0}return!1},e.prototype.getSuggestions=function(){return this.suggestions},e.prototype.getCurrentItem=function(){return this.currentSuggestion},e.prototype.getSuggestionAtIndex=function(e){return this.suggestions[e]},e.prototype.hasSelectedSuggestion=function(){return!!this.currentSuggestion},e.prototype.removeSuggestion=function(e){this.suggestions.splice(e,1)},e.prototype.createGenericSuggestion=function(e){var t=this.convertSuggestionsToSuggestionItems([e])[0];this.currentSuggestion=t},e.prototype.convertSuggestionsToSuggestionItems=function(e){return Array.isArray(e)?e.map(this._ensureSuggestionModel):[]},e.prototype.deselectAllSuggestions=function(){this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1,this.currentIndex=-1)},e.prototype.setSelectedSuggestion=function(e){e>this.suggestions.length-1||e<0?(this.currentIndex=0,this.currentSuggestion.selected=!1,this.currentSuggestion=this.suggestions[0],this.currentSuggestion.selected=!0):(this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1),this.suggestions[e].selected=!0,this.currentIndex=e,this.currentSuggestion=this.suggestions[e])},e}();!function(e){e[e.valid=0]="valid",e[e.warning=1]="warning",e[e.invalid=2]="invalid"}(j||(j={}));var z="backward",G=function(e){function t(t){var n=e.call(this,t)||this;return n._inputElement=s.createRef(),n._autoFillEnabled=!0,n._onCompositionStart=function(e){n.setState({isComposing:!0}),n._autoFillEnabled=!1},n._onCompositionUpdate=function(){Object(c.isIE11)()&&n._updateValue(n._getCurrentInputValue(),!0)},n._onCompositionEnd=function(e){var t=n._getCurrentInputValue();n._tryEnableAutofill(t,n.value,!1,!0),n.setState({isComposing:!1}),n._async.setTimeout(function(){n._updateValue(n._getCurrentInputValue(),!1)},0)},n._onClick=function(){n.value&&""!==n.value&&n._autoFillEnabled&&(n._autoFillEnabled=!1)},n._onKeyDown=function(e){if(n.props.onKeyDown&&n.props.onKeyDown(e),!e.nativeEvent.isComposing)switch(e.which){case c.KeyCodes.backspace:n._autoFillEnabled=!1;break;case c.KeyCodes.left:case c.KeyCodes.right:n._autoFillEnabled&&(n.setState({inputValue:n.props.suggestedDisplayValue||""}),n._autoFillEnabled=!1);break;default:n._autoFillEnabled||-1!==n.props.enableAutofillOnKeyPress.indexOf(e.which)&&(n._autoFillEnabled=!0)}},n._onInputChanged=function(e){var t=n._getCurrentInputValue(e);if(n.state.isComposing||n._tryEnableAutofill(t,n.value,e.nativeEvent.isComposing),!Object(c.isIE11)()||!n.state.isComposing){var a=e.nativeEvent.isComposing,i=void 0===a?n.state.isComposing:a;n._updateValue(t,i)}},n._onChanged=function(){},n._updateValue=function(e,t){if(e||e!==n.value){var a=n.props,i=a.onInputChange,r=a.onInputValueChange;i&&(e=(null==i?void 0:i(e,t))||""),n.setState({inputValue:e},function(){return null==r?void 0:r(e,t)})}},Object(c.initializeComponentRef)(n),n._async=new c.Async(n),n.state={inputValue:t.defaultVisibleValue||"",isComposing:!1},n}return Object(o.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){if(e.updateValueInWillReceiveProps){var n=e.updateValueInWillReceiveProps();if(null!==n&&n!==t.inputValue&&!t.isComposing)return Object(o.__assign)(Object(o.__assign)({},t),{inputValue:n})}return null},Object.defineProperty(t.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._getControlledValue()||this.state.inputValue||""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!1,configurable:!0}),t.prototype.componentDidUpdate=function(e,t,n){var a=this.props,i=a.suggestedDisplayValue,r=a.shouldSelectFullInputValueInComponentDidUpdate,o=0;if(!a.preventValueSelection)if(this._inputElement.current&&this._inputElement.current===document.activeElement&&this._autoFillEnabled&&this.value&&i&&K(i,this.value)){var s=!1;if(r&&(s=r()),s)this._inputElement.current.setSelectionRange(0,i.length,z);else{for(;o<this.value.length&&this.value[o].toLocaleLowerCase()===i[o].toLocaleLowerCase();)o++;o>0&&this._inputElement.current.setSelectionRange(o,i.length,z)}}else this._inputElement.current&&(null===n||this._autoFillEnabled||this.state.isComposing||this._inputElement.current.setSelectionRange(n.start,n.end,n.dir))},t.prototype.componentWillUnmount=function(){this._async.dispose()},t.prototype.render=function(){var e=Object(c.getNativeProps)(this.props,c.inputProperties),t=Object(o.__assign)(Object(o.__assign)({},this.props.style),{fontFamily:"inherit"});return s.createElement("input",Object(o.__assign)({autoCapitalize:"off",autoComplete:"off","aria-autocomplete":"both"},e,{style:t,ref:this._inputElement,value:this._getDisplayValue(),onCompositionStart:this._onCompositionStart,onCompositionUpdate:this._onCompositionUpdate,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))},t.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()},t.prototype.clear=function(){this._autoFillEnabled=!0,this._updateValue("",!1),this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)},t.prototype.getSnapshotBeforeUpdate=function(){var e,t,n=this._inputElement.current;return n&&n.selectionStart!==this.value.length?{start:null!==(e=n.selectionStart)&&void 0!==e?e:n.value.length,end:null!==(t=n.selectionEnd)&&void 0!==t?t:n.value.length,dir:n.selectionDirection||"backward"}:null},t.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""},t.prototype._tryEnableAutofill=function(e,t,n,a){!n&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||a)&&(this._autoFillEnabled=!0)},t.prototype._getDisplayValue=function(){return this._autoFillEnabled?(n=e=this.value,(t=this.props.suggestedDisplayValue)&&e&&K(t,n)&&(n=t),n):this.value;var e,t,n},t.prototype._getControlledValue=function(){var e=this.props.value;return void 0===e||"string"==typeof e?e:(console.warn("props.value of Autofill should be a string, but it is ".concat(e," with type of ").concat(typeof e)),e.toString())},t.defaultProps={enableAutofillOnKeyPress:[c.KeyCodes.down,c.KeyCodes.up]},t}(s.Component);function K(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())}Object(g.loadStyles)([{rawString:".picker_94f06b16{position:relative}.pickerText_94f06b16{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";min-width:180px;min-height:30px}.pickerText_94f06b16:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#323130"},{rawString:"}.pickerText_94f06b16.inputFocused_94f06b16{position:relative;border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:'}.pickerText_94f06b16.inputFocused_94f06b16:after{pointer-events:none;content:"";position:absolute;left:-1px;top:-1px;bottom:-1px;right:-1px;border:2px solid '},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:'}@media screen and (-ms-high-contrast:active),screen and (forced-colors:active){.pickerText_94f06b16.inputDisabled_94f06b16{position:relative;border-color:GrayText}.pickerText_94f06b16.inputDisabled_94f06b16:after{pointer-events:none;content:"";position:absolute;left:0;top:0;bottom:0;right:0;background-color:Window}}.pickerInput_94f06b16{height:34px;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:0;padding:0 6px 0;-ms-flex-item-align:end;align-self:flex-end}.pickerItems_94f06b16{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;max-width:100%}.screenReaderOnly_94f06b16{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}'}]);var W="picker_94f06b16",q="pickerText_94f06b16",Q="inputFocused_94f06b16",Y="inputDisabled_94f06b16",J="pickerInput_94f06b16",X="pickerItems_94f06b16",Z="screenReaderOnly_94f06b16",$=i,ee=Object(c.classNamesFunction)(),te=function(e){function t(t){var n,a=e.call(this,t)||this;a.root=s.createRef(),a.input=s.createRef(),a.suggestionElement=s.createRef(),a.SuggestionOfProperType=R,a._styledSuggestions=(n=a.SuggestionOfProperType,Object(c.styled)(n,B,void 0,{scope:"Suggestions"})),a._overrideScrollDismiss=!1,a.dismissSuggestions=function(e){var t=function(){var t=!0;a.props.onDismiss&&(t=a.props.onDismiss(e,a.suggestionStore.currentSuggestion?a.suggestionStore.currentSuggestion.item:void 0)),(!e||e&&!e.defaultPrevented)&&!1!==t&&a.canAddItems()&&a.suggestionStore.hasSelectedSuggestion()&&a.state.suggestedDisplayValue&&a.addItemByIndex(0)};a.currentPromise?a.currentPromise.then(function(){return t()}):t(),a.setState({suggestionsVisible:!1})},a.refocusSuggestions=function(e){a.resetFocus(),a.suggestionStore.suggestions&&a.suggestionStore.suggestions.length>0&&(e===c.KeyCodes.up?a.suggestionStore.setSelectedSuggestion(a.suggestionStore.suggestions.length-1):e===c.KeyCodes.down&&a.suggestionStore.setSelectedSuggestion(0))},a.onInputChange=function(e){a.updateValue(e),a.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})},a.onSuggestionClick=function(e,t,n){a.addItemByIndex(n)},a.onSuggestionRemove=function(e,t,n){a.props.onRemoveSuggestion&&a.props.onRemoveSuggestion(t),a.suggestionStore.removeSuggestion(n)},a.onInputFocus=function(e){a.selection.setAllSelected(!1),a.state.isFocused||(a._userTriggeredSuggestions(),a.props.inputProps&&a.props.inputProps.onFocus&&a.props.inputProps.onFocus(e))},a.onInputBlur=function(e){a.props.inputProps&&a.props.inputProps.onBlur&&a.props.inputProps.onBlur(e)},a.onBlur=function(e){if(a.state.isFocused){var t=e.relatedTarget;null===e.relatedTarget&&(t=document.activeElement),t&&!Object(c.elementContains)(a.root.current,t)&&(a.setState({isFocused:!1}),a.props.onBlur&&a.props.onBlur(e))}},a.onWrapperClick=function(e){a.state.items.length&&!a.canAddItems()&&a.resetFocus(a.state.items.length-1)},a.onClick=function(e){void 0!==a.props.inputProps&&void 0!==a.props.inputProps.onClick&&a.props.inputProps.onClick(e),0===e.button&&a._userTriggeredSuggestions()},a.onFocus=function(){a.state.isFocused||a.setState({isFocused:!0})},a.onKeyDown=function(e){var t=e.which;switch(t){case c.KeyCodes.escape:a.state.suggestionsVisible&&(a.setState({suggestionsVisible:!1}),e.preventDefault(),e.stopPropagation());break;case c.KeyCodes.tab:case c.KeyCodes.enter:a.suggestionElement.current&&a.suggestionElement.current.hasSuggestedActionSelected()?a.suggestionElement.current.executeSelectedAction():!e.shiftKey&&a.suggestionStore.hasSelectedSuggestion()&&a.state.suggestionsVisible?(a.completeSuggestion(),e.preventDefault(),e.stopPropagation()):a._completeGenericSuggestion();break;case c.KeyCodes.backspace:a.props.disabled||a.onBackspace(e),e.stopPropagation();break;case c.KeyCodes.del:a.props.disabled||(a.input.current&&e.target===a.input.current.inputElement&&a.state.suggestionsVisible&&-1!==a.suggestionStore.currentIndex?(a.props.onRemoveSuggestion&&a.props.onRemoveSuggestion(a.suggestionStore.currentSuggestion.item),a.suggestionStore.removeSuggestion(a.suggestionStore.currentIndex),a.forceUpdate()):a.onBackspace(e)),e.stopPropagation();break;case c.KeyCodes.up:a.input.current&&e.target===a.input.current.inputElement&&a.state.suggestionsVisible&&(a.suggestionElement.current&&a.suggestionElement.current.tryHandleKeyDown(t,a.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation(),a.forceUpdate()):a.suggestionElement.current&&a.suggestionElement.current.hasSuggestedAction()&&0===a.suggestionStore.currentIndex?(e.preventDefault(),e.stopPropagation(),a.suggestionElement.current.focusAboveSuggestions(),a.suggestionStore.deselectAllSuggestions(),a.forceUpdate()):a.suggestionStore.previousSuggestion()&&(e.preventDefault(),e.stopPropagation(),a.onSuggestionSelect()));break;case c.KeyCodes.down:a.input.current&&e.target===a.input.current.inputElement&&a.state.suggestionsVisible&&(a.suggestionElement.current&&a.suggestionElement.current.tryHandleKeyDown(t,a.suggestionStore.currentIndex)?(e.preventDefault(),e.stopPropagation(),a.forceUpdate()):a.suggestionElement.current&&a.suggestionElement.current.hasSuggestedAction()&&a.suggestionStore.currentIndex+1===a.suggestionStore.suggestions.length?(e.preventDefault(),e.stopPropagation(),a.suggestionElement.current.focusBelowSuggestions(),a.suggestionStore.deselectAllSuggestions(),a.forceUpdate()):a.suggestionStore.nextSuggestion()&&(e.preventDefault(),e.stopPropagation(),a.onSuggestionSelect()))}},a.onItemChange=function(e,t){var n=a.state.items;if(t>=0){var i=n;i[t]=e,a._updateSelectedItems(i)}},a.onGetMoreResults=function(){a.setState({isSearching:!0},function(){if(a.props.onGetMoreResults&&a.input.current){var e=a.props.onGetMoreResults(a.input.current.value,a.state.items),t=e,n=e;Array.isArray(t)?(a.updateSuggestions(t),a.setState({isSearching:!1})):n.then&&n.then(function(e){a.updateSuggestions(e),a.setState({isSearching:!1})})}else a.setState({isSearching:!1});a.input.current&&a.input.current.focus(),a.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})})},a.completeSelection=function(e){a.addItem(e),a.updateValue(""),a.input.current&&a.input.current.clear(),a.setState({suggestionsVisible:!1})},a.addItemByIndex=function(e){a.completeSelection(a.suggestionStore.getSuggestionAtIndex(e).item)},a.addItem=function(e){var t=a.props.onItemSelected?a.props.onItemSelected(e):e;if(null!==t){var n=t,i=t;if(i&&i.then)i.then(function(e){var t=a.state.items.concat([e]);a._updateSelectedItems(t)});else{var r=a.state.items.concat([n]);a._updateSelectedItems(r)}a.setState({suggestedDisplayValue:"",selectionRemoved:void 0})}},a.removeItem=function(e){var t=a.state.items,n=t.indexOf(e);if(n>=0){var i=t.slice(0,n).concat(t.slice(n+1));a.setState({selectionRemoved:e}),a._updateSelectedItems(i),a._async.setTimeout(function(){a.setState({selectionRemoved:void 0})},1e3)}},a.removeItems=function(e){var t=a.state.items.filter(function(t){return-1===e.indexOf(t)});a._updateSelectedItems(t)},a._shouldFocusZoneEnterInnerZone=function(e){if(a.state.suggestionsVisible)switch(e.which){case c.KeyCodes.up:case c.KeyCodes.down:return!0}return e.which===c.KeyCodes.enter},a._onResolveSuggestions=function(e){var t=a.props.onResolveSuggestions(e,a.state.items);null!==t&&a.updateSuggestionsList(t,e)},a._completeGenericSuggestion=function(){if(a.props.onValidateInput&&a.input.current&&a.props.onValidateInput(a.input.current.value)!==j.invalid&&a.props.createGenericItem){var e=a.props.createGenericItem(a.input.current.value,a.props.onValidateInput(a.input.current.value));a.suggestionStore.createGenericSuggestion(e),a.completeSuggestion()}},a._userTriggeredSuggestions=function(){if(!a.state.suggestionsVisible){var e=a.input.current?a.input.current.value:"";e?0===a.suggestionStore.suggestions.length?a._onResolveSuggestions(e):a.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0}):a.onEmptyInputFocus()}},Object(c.initializeComponentRef)(a),a._async=new c.Async(a);var i=t.selectedItems||t.defaultSelectedItems||[];return a._id=Object(c.getId)(),a._ariaMap={selectedItems:"selected-items-".concat(a._id),selectedSuggestionAlert:"selected-suggestion-alert-".concat(a._id),suggestionList:"suggestion-list-".concat(a._id),combobox:"combobox-".concat(a._id)},a.suggestionStore=new V,a.selection=new d.Selection({onSelectionChanged:function(){return a.onSelectionChange()}}),a.selection.setItems(i),a.state={items:i,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1,selectedIndices:[],selectionRemoved:void 0},a}return Object(o.__extends)(t,e),t.getDerivedStateFromProps=function(e){return e.selectedItems?{items:e.selectedItems}:null},Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!1,configurable:!0}),t.prototype.componentDidMount=function(){this.selection.setItems(this.state.items),this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)},t.prototype.componentDidUpdate=function(e,t){var n=this;if(this.state.items&&this.state.items!==t.items){var a=this.selection.getSelectedIndices()[0];this.selection.setItems(this.state.items),this.state.isFocused&&(this.state.items.length<t.items.length?(this.selection.setIndexSelected(a,!1,!0),this.resetFocus(a)):this.state.items.length>t.items.length&&!this.canAddItems()&&this.resetFocus(this.state.items.length-1))}this.state.suggestionsVisible&&!t.suggestionsVisible&&(this._overrideScrollDismiss=!0,this._async.clearTimeout(this._overrideScrollDimissTimeout),this._overrideScrollDimissTimeout=this._async.setTimeout(function(){n._overrideScrollDismiss=!1},100))},t.prototype.componentWillUnmount=function(){this.currentPromise&&(this.currentPromise=void 0),this._async.dispose()},t.prototype.focus=function(){this.input.current&&this.input.current.focus()},t.prototype.focusInput=function(){this.input.current&&this.input.current.focus()},t.prototype.completeSuggestion=function(e){this.suggestionStore.hasSelectedSuggestion()&&this.input.current?this.completeSelection(this.suggestionStore.currentSuggestion.item):e&&this._completeGenericSuggestion()},t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,n=e.isFocused,a=e.items,i=this.props,r=i.className,l=i.inputProps,u=i.disabled,f=i.selectionAriaLabel,p=i.selectionRole,_=void 0===p?"list":p,h=i.theme,b=i.styles,g=!!this.state.suggestionsVisible,v=g?this._ariaMap.suggestionList:void 0,y=b?ee(b,{theme:h,className:r,isFocused:n,disabled:u,inputClassName:l&&l.className}):{root:Object(c.css)("ms-BasePicker",r||""),text:Object(c.css)("ms-BasePicker-text",$.pickerText,this.state.isFocused&&$.inputFocused),itemsWrapper:$.pickerItems,input:Object(c.css)("ms-BasePicker-input",$.pickerInput,l&&l.className),screenReaderText:$.screenReaderOnly},S=this.props["aria-label"]||(null==l?void 0:l["aria-label"]);return s.createElement("div",{ref:this.root,className:y.root,onKeyDown:this.onKeyDown,onFocus:this.onFocus,onBlur:this.onBlur,onClick:this.onWrapperClick},this.renderCustomAlert(y.screenReaderText),s.createElement("span",{id:"".concat(this._ariaMap.selectedItems,"-label"),hidden:!0},f||S),s.createElement(m,{selection:this.selection,selectionMode:d.SelectionMode.multiple},s.createElement("div",{className:y.text,"aria-owns":v},a.length>0&&s.createElement("span",{id:this._ariaMap.selectedItems,className:y.itemsWrapper,role:_,"aria-labelledby":"".concat(this._ariaMap.selectedItems,"-label")},this.renderItems()),this.canAddItems()&&s.createElement(G,Object(o.__assign)({spellCheck:!1},l,{className:y.input,componentRef:this.input,id:(null==l?void 0:l.id)?l.id:this._ariaMap.combobox,onClick:this.onClick,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":g?this.getActiveDescendant():void 0,"aria-controls":v,"aria-describedby":a.length>0?this._ariaMap.selectedItems:void 0,"aria-expanded":g,"aria-haspopup":"listbox","aria-label":S,role:"combobox",disabled:u,onInputChange:this.props.onInputChange})))),this.renderSuggestions())},t.prototype.canAddItems=function(){var e=this.state.items,t=this.props.itemLimit;return void 0===t||e.length<t},t.prototype.renderSuggestions=function(){var e=this,t=this._styledSuggestions;return this.state.suggestionsVisible&&this.input?s.createElement(c.Callout,Object(o.__assign)({isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:c.DirectionalHint.bottomLeftEdge,directionalHintForRTL:c.DirectionalHint.bottomRightEdge,preventDismissOnEvent:function(t){return e._preventDismissOnScrollOrResize(t)}},this.props.pickerCalloutProps),s.createElement(t,Object(o.__assign)({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isExtendedLoading:this.state.suggestionsExtendedLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel,suggestionsListId:this._ariaMap.suggestionList,createGenericItem:this._completeGenericSuggestion},this.props.pickerSuggestionsProps))):null},t.prototype.renderItems=function(){var e=this,t=this.props,n=t.disabled,a=t.removeButtonAriaLabel,i=t.removeButtonIconProps,r=this.props.onRenderItem,o=this.state,s=o.items,c=o.selectedIndices;return s.map(function(t,o){return r({item:t,index:o,key:t.key?t.key:o,selected:-1!==c.indexOf(o),onRemoveItem:function(){return e.removeItem(t)},disabled:n,onItemChange:e.onItemChange,removeButtonAriaLabel:a,removeButtonIconProps:i})})},t.prototype.resetFocus=function(e){var t=this.state.items;if(t.length){e=null!=e?e:t.length-1;var n=this.root.current&&this.root.current.querySelectorAll("[data-selection-index] > button")[Math.min(e,t.length-1)];n&&n.focus()}else this.input.current&&this.input.current.focus()},t.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var e=this.input.current?this.input.current.value:"",t=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e);this.setState({suggestedDisplayValue:t})}},t.prototype.onSelectionChange=function(){this.setState({selectedIndices:this.selection.getSelectedIndices()})},t.prototype.updateSuggestions=function(e){var t,n=null===(t=this.props.pickerSuggestionsProps)||void 0===t?void 0:t.resultsMaximumNumber;this.suggestionStore.updateSuggestions(e,0,n),this.forceUpdate()},t.prototype.onEmptyInputFocus=function(){var e=this.props.onEmptyResolveSuggestions?this.props.onEmptyResolveSuggestions:this.props.onEmptyInputFocus;if(e){var t=e(this.state.items);this.updateSuggestionsList(t),this.setState({isMostRecentlyUsedVisible:!0,suggestionsVisible:!0,moreSuggestionsAvailable:!1})}},t.prototype.updateValue=function(e){this._onResolveSuggestions(e)},t.prototype.updateSuggestionsList=function(e,t){var n=this;Array.isArray(e)?this._updateAndResolveValue(t,e):e&&e.then&&(this.setState({suggestionsLoading:!0}),this._startLoadTimer(),this.suggestionStore.updateSuggestions([]),void 0!==t?this.setState({suggestionsVisible:this._getShowSuggestions()}):this.setState({suggestionsVisible:this.input.current&&this.input.current.inputElement===document.activeElement}),this.currentPromise=e,e.then(function(a){e===n.currentPromise&&n._updateAndResolveValue(t,a)}))},t.prototype.resolveNewValue=function(e,t){var n=this;this.updateSuggestions(t);var a=void 0;this.suggestionStore.currentSuggestion&&(a=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e)),this.setState({suggestedDisplayValue:a,suggestionsVisible:this._getShowSuggestions()},function(){return n.setState({suggestionsLoading:!1,suggestionsExtendedLoading:!1})})},t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)},t.prototype.onBackspace=function(e){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&0===this.input.current.cursorLocation)&&(this.selection.getSelectedCount()>0?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))},t.prototype.getActiveDescendant=function(){var e;if(!this.state.suggestionsLoading){var t=this.suggestionStore.currentIndex;return t<0?(null===(e=this.suggestionElement.current)||void 0===e?void 0:e.hasSuggestedAction())?"sug-selectedAction":0===this.suggestionStore.suggestions.length?"sug-noResultsFound":void 0:"sug-".concat(t)}},t.prototype.getSuggestionsAlert=function(e){void 0===e&&(e=$.screenReaderOnly);var t=this.suggestionStore.currentIndex;if(this.props.enableSelectedSuggestionAlert){var n=t>-1?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,a=n?n.ariaLabel:void 0;return s.createElement("div",{id:this._ariaMap.selectedSuggestionAlert,className:e},"".concat(a," "))}},t.prototype.renderCustomAlert=function(e){void 0===e&&(e=$.screenReaderOnly);var t=this.props.suggestionRemovedText,n=void 0===t?"removed {0}":t,a="";if(this.state.selectionRemoved){var i=this._getTextFromItem(this.state.selectionRemoved,"");a=Object(c.format)(n,i)}return s.createElement("div",{className:e,id:this._ariaMap.selectedSuggestionAlert,"aria-live":"assertive"},this.getSuggestionsAlert(e),a)},t.prototype._preventDismissOnScrollOrResize=function(e){return!(!this._overrideScrollDismiss||"scroll"!==e.type&&"resize"!==e.type)},t.prototype._startLoadTimer=function(){var e=this;this._async.setTimeout(function(){e.state.suggestionsLoading&&e.setState({suggestionsExtendedLoading:!0})},3e3)},t.prototype._updateAndResolveValue=function(e,t){var n;if(void 0!==e)this.resolveNewValue(e,t);else{var a=null===(n=this.props.pickerSuggestionsProps)||void 0===n?void 0:n.resultsMaximumNumber;this.suggestionStore.updateSuggestions(t,-1,a),this.state.suggestionsLoading&&this.setState({suggestionsLoading:!1,suggestionsExtendedLoading:!1})}},t.prototype._updateSelectedItems=function(e){var t=this;this.props.selectedItems?this.onChange(e):this.setState({items:e},function(){t._onSelectedItemsUpdated(e)})},t.prototype._onSelectedItemsUpdated=function(e){this.onChange(e)},t.prototype._getShowSuggestions=function(){return void 0!==this.input.current&&null!==this.input.current&&this.input.current.inputElement===document.activeElement&&""!==this.input.current.value},t.prototype._getTextFromItem=function(e,t){return this.props.getTextFromItem?this.props.getTextFromItem(e,t):""},t}(s.Component),ne=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,n=e.isFocused,a=this.props,i=a.className,r=a.inputProps,l=a.disabled,u=a.selectionAriaLabel,f=a.selectionRole,p=void 0===f?"list":f,_=a.theme,h=a.styles,b=!!this.state.suggestionsVisible,g=b?this._ariaMap.suggestionList:void 0,v=h?ee(h,{theme:_,className:i,isFocused:n,inputClassName:r&&r.className}):{root:Object(c.css)("ms-BasePicker",$.picker,i||""),text:Object(c.css)("ms-BasePicker-text",$.pickerText,this.state.isFocused&&$.inputFocused,l&&$.inputDisabled),itemsWrapper:$.pickerItems,input:Object(c.css)("ms-BasePicker-input",$.pickerInput,r&&r.className),screenReaderText:$.screenReaderOnly},y=this.props["aria-label"]||(null==r?void 0:r["aria-label"]);return s.createElement("div",{ref:this.root,onBlur:this.onBlur,onFocus:this.onFocus},s.createElement("div",{className:v.root,onKeyDown:this.onKeyDown},this.renderCustomAlert(v.screenReaderText),s.createElement("span",{id:"".concat(this._ariaMap.selectedItems,"-label"),hidden:!0},u||y),s.createElement("div",{className:v.text,"aria-owns":g},s.createElement(G,Object(o.__assign)({},r,{className:v.input,componentRef:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onClick:this.onClick,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":b?this.getActiveDescendant():void 0,"aria-controls":g,"aria-expanded":b,"aria-haspopup":"listbox","aria-label":y,"aria-describedby":this.state.items.length>0?this._ariaMap.selectedItems:void 0,role:"combobox",id:(null==r?void 0:r.id)?r.id:this._ariaMap.combobox,disabled:l,onInputChange:this.props.onInputChange})))),this.renderSuggestions(),s.createElement(m,{selection:this.selection,selectionMode:d.SelectionMode.single},s.createElement("div",{id:this._ariaMap.selectedItems,className:"ms-BasePicker-selectedItems",role:p,"aria-labelledby":"".concat(this._ariaMap.selectedItems,"-label")},this.renderItems())))},t.prototype.onBackspace=function(e){},t}(te)},pVWH:function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(a||(a={})),t.e=a},u2MZ:function(e,t,n){"use strict";n.d(t,"i",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"n",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"e",function(){return _}),n.d(t,"o",function(){return h}),n.d(t,"r",function(){return a}),n.d(t,"l",function(){return b}),n.d(t,"s",function(){return g}),n.d(t,"d",function(){return v}),n.d(t,"c",function(){return y});var a,i=n("ut3N"),r=n("Pk8u"),o=n("pVWH"),s=n("y88i"),c=n("hiL/"),d=/@/,l=/<.+@.+\..+>/,u=286,f=350,p=16,m=45,_=17,h=i._LogSource.create("PeopleWebPart");!function(e){e[e.SmallCard=1]="SmallCard",e[e.LargeCard=2]="LargeCard",e[e.MediumCard=3]="MediumCard"}(a||(a={}));var b={allowEmailAddresses:!1,fallbackToEmailIfNoJob:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:o.e.user,useGraph:!0,resolveEmailIfNoResults:!1};function g(e){var t=Boolean(e.rawPersonData)&&e.rawPersonData.Description||"";return{email:e.email,id:e.userId,upn:t,name:e.name,role:e.job||e.department||"",department:e.department||"",phone:e.phone||"",sip:Object(r.get)(e,"rawPersonData.EntityData.SIPAddress",""),aadObjectId:e.aadObjectId||""}}function v(e){return l.exec(e)?"RFC5322":d.exec(e)?"Email":"Name"}function y(e,t){var n;return void 0===t&&(t=a.SmallCard),n=t===a.SmallCard||t===a.MediumCard?s.SPAlternativeUrls.UserPhotoSize.Medium:s.SPAlternativeUrls.UserPhotoSize.Large,e?c.SPUtility.getUserPhotoUrl(e,n):""}},ut3N:function(e,t){e.exports=v},vNcA:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},vZDh:function(e){e.exports=JSON.parse('{"a":"Small","t":"Medium","e":"Large","n":"Layout"}')},vlQI:function(e,t){e.exports=y},w9oE:function(e,t,n){"use strict";var a=n("K9kD");n.o(a,"isExpectedError")&&n.d(t,"isExpectedError",function(){return a.isExpectedError})},y88i:function(e,t){e.exports=S},yRoY:function(e){e.exports=JSON.parse('{"i":"0||1||2-","a":"{0} characters||{0} character||{0} characters","t":"{0} of {1}","e":"{0}. The description can contain up to {1}.","r":"Enter a description for this person","o":"Enter a tagline for this person","n":"Personal description"}')},ynV5:function(e,t,n){var a=n("K9kD");e.exports=a.StringHelper}})});