define("05acb3ef-099f-4f17-bedd-0259b979f054_0.1.0",["@ms/odsp-core-bundle","@microsoft/sp-diagnostics"],function(n,a){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({K9kD:function(e,t){e.exports=n},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"_getHostCommandHandler",function(){return b});var a=n("K9kD"),i=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}(),r=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),a=function(e,a){var r=e,o=r.dispose,s="function"==typeof o&&o.disposalChain||function(e){var t=new i(e),n=e.dispose,a=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=a,a.disposalChain=t,t}(r);return s.addCallback(function(){delete t._disposables[n]}),r}(e);return this._disposables[n]=a,a},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],i=e[a];i&&"function"==typeof i.dispose&&i.dispose(),delete e[a]}},e}(),o=function(){function e(e){this._scope=new r,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(s(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var r=this._disposableMap.get(e);r||(r=new Map,this._disposableMap.set(e,r));var o=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});r.set(t,o)},e.prototype.off=function(e,t,n){var a;if(s(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var r=this._disposableMap.get(e);if(r){var o=r.get(t);o&&(o.dispose(),r.delete(t)),0===r.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function s(e){return!!e.addEventListener}var c=function(){function e(e){this._scope=new r,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),d="handlerRejection",l="canceled",u=0,f=function(){function e(e,t){void 0===t&&(t={});var n=this,a=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},s=e.initResources,u=e.initTimeoutMs,f=void 0===u?1e4:u,p=e.ackTimeoutMs,m=void 0===p?1e3:p,_=e.resultTimeoutMs,h=void 0===_?1e4:_,b=t.asyncType,g=void 0===b?c:b,v=t.eventGroupType,y=void 0===v?o:v,S=this._scope=new r;S.attach(s);var D,I=this._async=S.attach(new g(this)),x=S.attach(new y(this));this._ackTimeoutMs=m,this._resultTimeoutMs=h,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:d,isExpected:!1,message:"Unknown error"}).code||e.name||d,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(e){}};var C=this._port=new Promise(function(t,a){S.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=l,a(e)}}),D=I.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(f,"ms"));e.code="setupTimeout",a(e)},f),e.init(function(e){I.clearTimeout(D),S.attach({dispose:function(){e.close()}}),x.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=C.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=a}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:l,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++u,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o,c=t.transfer;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(p(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(p(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e},c||[]),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function p(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}var m,_,h=n("ut3N");function b(e,t,n,i,s,c,d,l){var u=function(e,t){void 0===t&&(t={});var n=e.channelId,a=e.onReinitialize,i=e.origin,s=e.receiver,c=void 0===s?window:s,d=e.source,l=e.identifyParent,u=t.eventGroupType,p=void 0===u?o:u,m=t.messengerType,_=void 0===m?f:m,h=new r,b=h.attach(new p(null));return new _({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var r;if(l&&d){var o=setInterval(function(){var e={type:"identify-parent",channelId:n};d.postMessage(e,i)},100);r=h.attach({dispose:function(){clearInterval(o)}})}var s=!1;b.on(c,"message",function(t){var o=t.data;if(t.origin===i&&(!d||t.source===d)&&o&&"object"==typeof o&&"initialize"===o.type&&o.channelId===n){if(r&&r.dispose(),a){if(s)return a(),void b.dispose();s=!0}else b.dispose();var c=o.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:h,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({channelId:e,origin:new a.SPResourcePath(n).authority,source:t.contentWindow||void 0,onCommand:function(e){if(e.command===m.getToken)return e.tokenType===_.SHAREPOINT?s().then(function(e){return{result:m.success,token:e}}).catch(function(e){return h._TraceLogger.logError(h._LogSource.create(c),e),{result:m.error,isExpected:!1,error:{code:null==e?void 0:e.name,message:null==e?void 0:e.message}}}):Promise.resolve(void 0)},onNotification:function(e){if(i)switch(e.notification){case m.success:i.writeSuccess(l);break;case m.error:var t=e,n=t.error||{},a=n.code,r=void 0===a?"Unspecified":a,o=n.message,s=new Error(o);return void(t.isExpected?i.writeExpectedFailure(r,s,l):i.writeUnexpectedFailure(r,s,l))}else h._TraceLogger.logError(h._LogSource.create(c),new Error("postMessage while monitor undefined"));d&&d()}});return u}!function(e){e.error="error",e.success="success",e.getToken="getToken",e.result="result"}(m||(m={})),function(e){e.MS_LOKI="MS_LOKI_TOKEN",e.SHAREPOINT="SHAREPOINT_TOKEN",e.MS_GRAPH="MS_GRAPH_TOKEN",e.OFFICE_OCPS="MS_OFFICE_OCPS"}(_||(_={}))},ut3N:function(e,t){e.exports=a}})});