define("b7dd04e1-19ce-4b24-9132-b60a1c2b910d_0.1.0",["tslib","@microsoft/sp-http-base","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-component-base","@ms/sp-host-command-handler","@ms/odsp-core-bundle","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@ms/i18n-utilities","@ms/sp-coachmark-utility","@microsoft/sp-webpart-base","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({0:"sp-fileviewer-edit"}[e]||e)+"_"+"none"+"_"+{0:"9832675bea8b9afbd644"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonpb7dd04e1_19ce_4b24_9132_b60a1c2b910d_0_1_0=window.webpackJsonpb7dd04e1_19ce_4b24_9132_b60a1c2b910d_0_1_0||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp\-fileviewer\-webparts_en-us_a8a6da8a253c643a1ba0\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="qArQ")}({"0pyH":function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"e",function(){return s});var a=n("y88i"),i=n("K9kD");function r(){return"".concat(window.location.protocol,"//").concat(window.location.hostname)}function o(e){if(e){var t=e.getPathSegments();t.splice(t.length-1,1);var n="/".concat(t.join("/"));return window.location.host===e.getHost()?n:a.Uri.concatenate(e.getLeftPart(1),n)}}function s(e,t){var n=e&&e.serverRelativePath,r=e&&e.serverRelativeUrl;if(r||n){if(n){if(new i.SPResourcePath(n).authority)return n;var o=d(e.wopiurl)||d(t);return a.Uri.concatenate("".concat(window.location.protocol,"//").concat(o),n)}return new a.Uri(r).getHost()?r:(o=c(e.wopiurl)||c(e.file)||window.location.host,a.Uri.concatenate("".concat(window.location.protocol,"//").concat(o),e.serverRelativeUrl))}}function c(e){return e&&new a.Uri(e).getHost()}function d(e){return e&&new i.SPResourcePath(e).domain}},"17wl":function(e,t){e.exports=n},"2SXB":function(e,t){e.exports=a},"2q6Q":function(e,t){e.exports=i},"5pbq":function(e,t){e.exports=r},"7Awa":function(e,t){e.exports=o},C3mr:function(e,t){e.exports=s},IWfk:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("hiL/"),i=n("K9kD"),r=n("TImI"),o=[["3gp",r.e.Video],["csv",r.e.Excel],["doc",r.e.Word],["docm",r.e.Word],["docx",r.e.Word],["dotx",r.e.Word],["m4v",r.e.Video],["mov",r.e.Video],["mp4",r.e.Video],["webm",r.e.Video],["pot",r.e.PowerPoint],["potm",r.e.PowerPoint],["potx",r.e.PowerPoint],["pps",r.e.PowerPoint],["ppsx",r.e.PowerPoint],["ppt",r.e.PowerPoint],["pptm",r.e.PowerPoint],["pptx",r.e.PowerPoint],["vsd",r.e.Visio],["vsdm",r.e.Visio],["vsdx",r.e.Visio],["wmv",r.e.Video],["xls",r.e.Excel],["xlsb",r.e.Excel],["xlsm",r.e.Excel],["xlsx",r.e.Excel],["pdf",r.e.PDF]],s=new Map(o);function c(e){if(!s.size)for(var t=0,n=o;t<n.length;t++){var c=n[t];s.set(c[0],c[1])}var d=a.ExtensionHelper.getExtension(new i.SPResourcePath(e));return d&&s.has(d)?s.get(d):r.e.Other}},K9kD:function(e,t){e.exports=c},Pk8u:function(e,t){e.exports=d},TImI:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Excel=0]="Excel",e[e.Other=1]="Other",e[e.PowerPoint=2]="PowerPoint",e[e.Video=3]="Video",e[e.Visio=4]="Visio",e[e.Word=5]="Word",e[e.PDF=6]="PDF"}(a||(a={}))},U4ag:function(e,t){e.exports=l},UWqr:function(e,t){e.exports=u},Uejs:function(e){e.exports=JSON.parse('{"e":"File viewer","t":"File and Media","n":"File and Media viewer"}')},Y3kv:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"s",function(){return s}),n.d(t,"S",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"p",function(){return l}),n.d(t,"u",function(){return u}),n.d(t,"e",function(){return f}),n.d(t,"t",function(){return p}),n.d(t,"b",function(){return m}),n.d(t,"g",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"v",function(){return b}),n.d(t,"m",function(){return g}),n.d(t,"y",function(){return v}),n.d(t,"d",function(){return y}),n.d(t,"o",function(){return S}),n.d(t,"_",function(){return D}),n.d(t,"l",function(){return I}),n.d(t,"h",function(){return x}),n.d(t,"f",function(){return C});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("1d50eb18-0ce9-420f-9930-28cffc5d91ea")}function r(){return a._SPKillSwitch.isActivated("48e2c9fc-6d92-47cf-824f-12e5a67d4628")}function o(){return a._SPKillSwitch.isActivated("fdf168f7-2f10-4fb7-a35c-0a6ab69e72bd")}function s(){return a._SPKillSwitch.isActivated("4168b8a3-d064-4576-a09c-f04d0a91a80d")}function c(){return a._SPKillSwitch.isActivated("cc9c4efd-bb86-48f4-a993-5188ad030987")}function d(){return a._SPKillSwitch.isActivated("54280d10-2ed3-4370-968a-a797828c0d49")}function l(){return a._SPKillSwitch.isActivated("8ba2eac6-ffdc-4604-a0a6-04eee124cf1b")}function u(){return a._SPKillSwitch.isActivated("94716cb2-03fb-403c-984b-5a39afadb69d")}function f(){return a._SPKillSwitch.isActivated("31b3b84c-3905-425d-9a97-05a8eb6ecc82")}function p(){return a._SPKillSwitch.isActivated("5cd9830b-e86e-41cc-94ce-3d1d68ca167f")}function m(){return a._SPKillSwitch.isActivated("dbe0af75-09ee-4f13-906b-9c89998be600")}function _(){return a._SPKillSwitch.isActivated("70002b2d-8e45-4062-9936-1e88f99951ed")}function h(){return a._SPKillSwitch.isActivated("703d802c-3888-42de-a676-fd424e18ce8a")}function b(){return a._SPKillSwitch.isActivated("a95c5b86-e008-4fb6-a91f-38755e43792c")}function g(){return a._SPKillSwitch.isActivated("5550f74a-1bb3-42f2-89d3-34073fe31bec")}function v(){return a._SPKillSwitch.isActivated("d32769d9-658d-4742-b482-f7688511fc97")}function y(){return a._SPKillSwitch.isActivated("043c83ed-06e3-4d46-9c4d-a47f21c9e7fd")}function S(){return a._SPKillSwitch.isActivated("b8dfa806-bf54-465a-8b0c-1339e6193fe3")}function D(){return a._SPKillSwitch.isActivated("f8b3d7b1-0574-4639-ae76-54c1797a87cf")}function I(){return a._SPKillSwitch.isActivated("654cdac8-bab8-449d-ba0e-42889f788f15")}function x(){return a._SPKillSwitch.isActivated("baa4cda0-b73b-495c-b17f-36db64d8135c")}function C(){return a._SPKillSwitch.isActivated("7f207314-2d36-45f6-a7b8-eb18ba73a438")}},Ycni:function(e,t){e.exports=f},bXd7:function(e,t){e.exports=p},br4S:function(e,t){e.exports=m},cDcd:function(e,t){e.exports=_},dVDx:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("UWqr");function i(){return a._SPFlight.isEnabled(60082)}},faye:function(e,t){e.exports=h},fglE:function(e,t){e.exports=b},fxVk:function(e,t,n){var a=n("5pbq");e.exports=a.workaround_Icon},"hiL/":function(e,t){e.exports=g},jOlS:function(e,t){e.exports=v},m2Nw:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e.COMMON_START_PAGE="startPage",e.PPT_START_PAGE="wdslideindex",e.WORD_START_PAGE="wdstarton"}(a||(a={}))},mGD9:function(e){e.exports=JSON.parse('{"j":"Start page","h":"Entire workbook","r":"Chart","i":"Chart name","z":"Table","V":"Table name","F":"Range","U":"Starting cell","T":"Ending cell","H":"Sheet name","N":"Show grid lines","B":"Show row and column headers","R":"Allow sorting and filtering columns","l":".","_":"Press Enter key to enter the document web part.","L":"Couldn\\u0027t display the preview for this document.","S":"Can\\u0027t find your default document library. Use the Site tab to choose the document library and file you want to upload.","t":"Add file","a":"Change file","p":"Embed Office documents from your libraries, and people can read them without leaving your page.","m":"Document","O":"Embed Office documents or other files from your libraries, and people can view them without leaving your page.","w":"File viewer","D":"Embed a file such as Word, Excel, PowerPoint, video, audio, PDF, 3D model, and more.","I":"File and Media","x":"File and Media viewer","W":"We embedded the document. Don\\u0027t forget to add a description.","n":"Add a description","d":"Modified on {0}","Y":"Embedded document","e":"Document web part, showing {0}.","C":"This is not a supported document file. Please select a different document with one of the following extensions: {0}.","y":", ","q":"We\\u0027re still uploading your document. It may get lost if you leave this page.","Q":"Uploading…","b":"You can display a specific chart, table, range or the entire workbook. To display a chart or a table, you\\u0027ll need to enter its name.","J":"Select the page you want people to see first.","g":"How do I find the name of a chart or table?","v":"Link in the Excel Document settings panel that connects to set up guidance.","k":"Select the slide you want people to see first.","M":"Start slide","G":"Display a video from OneDrive and SharePoint for your team.","K":"Replace with another file such as Word, Excel, PowerPoint, video, audio, PDF, 3D model, and more.","f":"This web part is connected to {0}. Select an item in {0} to view it here.","u":"Connect to a document library so that users can choose a file from the library to view. Select a document library to get data from.","E":"Add a file to view on your page. You can select from a variety of file types including Excel, Word, PowerPoint, Visio, PDFs, 3D models, and more. {0}","A":"Embed a file such as Word, Excel, PowerPoint, video, audio, PDF, 3D model, and more. {0}","P":"You can also connect to a source to dynamically view files by selecting More options (...) and then Connect to source.","o":"Just drag a file onto the page, and we\\u0027ll do the rest.","s":"Got it!","c":"Adding files just got easier!"}')},qArQ:function(e,t,n){"use strict";n.r(t);var a,i=n("17wl"),r=n("2q6Q"),o=n("ut3N"),s=n("UWqr"),c=n("2SXB"),d=n("br4S"),l=n("y88i"),u=n("cDcd"),f=n("faye"),p=n("Pk8u"),m=n("bXd7"),_=n("hiL/"),h=n("K9kD"),b=n("U4ag"),g=n("5pbq"),v=n("vNcA");!function(e){e[e.Documents=1]="Documents",e[e.Images=2]="Images",e[e.Pages=3]="Pages",e[e.Videos=4]="Videos",e[e.Audios=5]="Audios",e[e.Models=6]="Models",e[e.BasicDocuments=7]="BasicDocuments",e[e.Transcripts=8]="Transcripts",e[e.VideosWithWebm=9]="VideosWithWebm"}(a||(a={}));var y=n("C3mr"),S=function(){function e(e){this._callbacks=[],this._owner=e}return e.prototype.addCallback=function(e){this._callbacks.push(e)},e.prototype.dispose=function(){for(var e;e=this._callbacks.pop();)e.call(this._owner)},e}(),D=function(){function e(){this._disposables={},this._lastDisposableId=0,this.isDisposed=!1}return e.prototype.attach=function(e){var t=this,n="".concat(++this._lastDisposableId),a=function(e,a){var i=e,r=i.dispose,o="function"==typeof r&&r.disposalChain||function(e){var t=new S(e),n=e.dispose,a=function(){t.dispose(),n&&(e.dispose=n,e.dispose())};return e.dispose=a,a.disposalChain=t,t}(i);return o.addCallback(function(){delete t._disposables[n]}),i}(e);return this._disposables[n]=a,a},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,n=Object.keys(e);t<n.length;t++){var a=n[t],i=e[a];i&&"function"==typeof i.dispose&&i.dispose(),delete e[a]}},e}(),I=function(){function e(e){this._scope=new D,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}return e.prototype.on=function(e,t,n){var a;if(x(e))a=e;else{var i=this._targetMap.get(e);i?a=i:(a=new EventTarget,this._targetMap.set(e,a))}a.addEventListener(t,n);var r=this._disposableMap.get(e);r||(r=new Map,this._disposableMap.set(e,r));var o=this._scope.attach({dispose:function(){a.removeEventListener(t,n)}});r.set(t,o)},e.prototype.off=function(e,t,n){var a;if(x(e))a=e;else{var i=this._targetMap.get(e);i&&(a=i)}var r=this._disposableMap.get(e);if(r){var o=r.get(t);o&&(o.dispose(),r.delete(t)),0===r.size&&this._disposableMap.delete(e)}a&&a.removeEventListener(t,n)},e.prototype.dispose=function(){this._scope.dispose()},e}();function x(e){return!!e.addEventListener}var C=function(){function e(e){this._scope=new D,this._timeoutMap=new Map}return e.prototype.setTimeout=function(e,t){var n=this,a=setTimeout(function(){n._timeoutMap.delete(a),e()},t),i=this._scope.attach({dispose:function(){clearTimeout(a)}});return this._timeoutMap.set(a,i),a},e.prototype.clearTimeout=function(e){var t=this._timeoutMap.get(e);t&&(this._timeoutMap.delete(e),t.dispose())},e.prototype.dispose=function(){this._scope.dispose()},e}(),O="handlerRejection",w="canceled",E=0,A=function(){function e(e,t){void 0===t&&(t={});var n=this,a=new Map,i={onCommand:e.onCommand,onNotification:e.onNotification},r=e.initResources,o=e.initTimeoutMs,s=void 0===o?1e4:o,c=e.ackTimeoutMs,d=void 0===c?1e3:c,l=e.resultTimeoutMs,u=void 0===l?1e4:l,f=t.asyncType,p=void 0===f?C:f,m=t.eventGroupType,_=void 0===m?I:m,h=this._scope=new D;h.attach(r);var b,g=this._async=h.attach(new p(this)),v=h.attach(new _(this));this._ackTimeoutMs=d,this._resultTimeoutMs=u,this._invokeCommandHandler=function(e){try{var t=i.onCommand&&i.onCommand(e);return t?Promise.resolve(t).catch(function(e){return{result:"error",error:{code:(e=e||{name:O,isExpected:!1,message:"Unknown error"}).code||e.name||O,message:e.message||"".concat(e)},isExpected:!!e.isExpected}}):Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:e.command},isExpected:!0})}catch(e){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:e&&"Name: ".concat(e.name,"; Message: ").concat(e.message||e)}})}},this._invokeNotificationHandler=function(e){try{i.onNotification&&i.onNotification(e)}catch(e){}};var y=this._port=new Promise(function(t,a){h.attach({dispose:function(){var e=new Error("Initialization canceled.");e.code=w,a(e)}}),b=g.setTimeout(function(){var e=new Error("Initialization timed out after ".concat(s,"ms"));e.code="setupTimeout",a(e)},s),e.init(function(e){g.clearTimeout(b),h.attach({dispose:function(){e.close()}}),v.on(e,"message",function(t){var a=t.data;if(a&&"object"==typeof a)return"acknowledge"===a.type?n._onAcknowledge(a):"command"===a.type?n._onCommand(e,a):"notification"===a.type?n._onNotification(a):"result"===a.type?n._onResult(a):void 0}),e.start(),t(e)},a)});this.ready=y.then(function(){},function(e){return n.dispose(),Promise.reject(e)}),this._signals=a}return e.prototype.dispose=function(){this._scope.dispose(),this._signals.forEach(function(e){e.resolve({result:"error",isExpected:!0,error:{code:w,message:"Messenger disposed"}})}),this._signals.clear()},e.prototype.sendCommand=function(e,t){var n=this;if(void 0===t&&(t={}),this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});var a=++E,i=t.timeoutDelayMs,r=void 0===i?this._resultTimeoutMs:i,o=t.acknowledgeTimeoutMs,s=void 0===o?this._ackTimeoutMs:o,c=t.transfer;return this._port.then(function(t){var i=n._async,o=new Promise(function(e){n._signals.set(a,{acknowledgeTimeout:i.setTimeout(function(){n._onResult(L(a,"acknowledgeTimeout"))},s),resultTimeout:i.setTimeout(function(){n._onResult(L(a,"resultTimeout"))},r),resolve:e})});return t.postMessage({type:"command",id:a,data:e},c||[]),o})},e.prototype.sendNotification=function(e){this._scope.isDisposed||this._port.then(function(t){t.postMessage({type:"notification",data:e})})},e.prototype._onAcknowledge=function(e){var t=this._signals.get(e.id);t&&this._async.clearTimeout(t.acknowledgeTimeout)},e.prototype._onCommand=function(e,t){var n=t.id;e.postMessage({type:"acknowledge",id:n}),this._invokeCommandHandler(t.data).then(function(t){e.postMessage({type:"result",data:t,id:n})}).catch(function(e){})},e.prototype._onNotification=function(e){this._invokeNotificationHandler(e.data)},e.prototype._onResult=function(e){var t=e.id,n=this._async,a=this._signals,i=a.get(t);i&&(n.clearTimeout(i.acknowledgeTimeout),n.clearTimeout(i.resultTimeout),i.resolve(e.data)),a.delete(t)},e}();function L(e,t){return{id:e,data:{result:"error",error:{code:t,message:"Timed out"},isExpected:!1}}}var k,M=n("vlQI");!function(e){e.error="error",e.success="success",e.getToken="getToken",e.result="result"}(k||(k={}));var P,T="[OneDrive:To:Embed:{0}]",U="".concat(T,'{"conversationId":{1},"type":"acknowledge"}');!function(e){e.MS_LOKI="MS_LOKI_TOKEN",e.SHAREPOINT="SHAREPOINT_TOKEN",e.MS_GRAPH="MS_GRAPH_TOKEN",e.OFFICE_OCPS="MS_OFFICE_OCPS"}(P||(P={}));var F=n("TImI"),H=n("0pyH"),R=n("IWfk");function N(e){var t;return e&&(t=parseInt(String(e),10)),(t=isNaN(t)||t<1?1:t)>1&&r._EngagementLogger.logEvent("DocumentEmbedWP.NonDefaultPage.Click"),t}var B,j=n("Y3kv");function V(e){var t=_.spConstants.isPreviewableExtensionsEnabled();if(!e)return t;var n=Object(R.e)(e);if(n===F.e.Video||n===F.e.Other||n===F.e.PDF)return!0;if(!t)return!1;var a=new h.SPResourcePath(e);return n!==F.e.Word&&n!==F.e.PowerPoint&&n!==F.e.Excel&&n!==F.e.Visio&&(!a.authority||window.location.host===a.domain)}!function(e){e[e.normal=0]="normal",e[e.compact=1]="compact"}(B||(B={}));var z,G,K,W,q,Q,Y=Object(g.classNamesFunction)(),J=u.createContext({}),X=function(e){function t(t){var n=e.call(this,t)||this;return n._rootElement=u.createRef(),n._onClick=function(e){n._onAction(e)},n._onKeyDown=function(e){e.which!==g.KeyCodes.enter&&e.which!==g.KeyCodes.space||n._onAction(e)},n._onAction=function(e){var t=n.props,a=t.onClick,i=t.onClickHref,r=t.onClickTarget;a?a(e):!a&&i&&(r?window.open(i,r,"noreferrer noopener nofollow"):window.location.href=i,e.preventDefault(),e.stopPropagation())},Object(g.initializeComponentRef)(n),Object(g.warnDeprecations)("DocumentCard",t,{accentColor:void 0}),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.onClick,a=t.onClickHref,r=t.children,o=t.type,s=t.accentColor,c=t.styles,d=t.theme,l=t.className,f=Object(g.getNativeProps)(this.props,g.divProperties,["className","onClick","type","role"]),p=!(!n&&!a);this._classNames=Y(c,{theme:d,className:l,actionable:p,compact:o===B.compact}),o===B.compact&&s&&(e={borderBottomColor:s});var m={role:this.props.role||(p?n?"button":"link":void 0),tabIndex:p?0:void 0};return u.createElement("div",Object(i.__assign)({ref:this._rootElement,role:"group",className:this._classNames.root,onKeyDown:p?this._onKeyDown:void 0,onClick:p?this._onClick:void 0,style:e},f),u.createElement(J.Provider,{value:m},r))},t.prototype.focus=function(){this._rootElement.current&&this._rootElement.current.focus()},t.defaultProps={type:B.normal},t}(u.Component),Z={root:"ms-DocumentCardPreview",icon:"ms-DocumentCardPreview-icon",iconContainer:"ms-DocumentCardPreview-iconContainer"},$={root:"ms-DocumentCardActivity",multiplePeople:"ms-DocumentCardActivity--multiplePeople",details:"ms-DocumentCardActivity-details",name:"ms-DocumentCardActivity-name",activity:"ms-DocumentCardActivity-activity",avatars:"ms-DocumentCardActivity-avatars",avatar:"ms-DocumentCardActivity-avatar"},ee={root:"ms-DocumentCardTitle"},te={root:"ms-DocumentCardLocation"},ne={root:"ms-DocumentCard",rootActionable:"ms-DocumentCard--actionable",rootCompact:"ms-DocumentCard--compact"},ae=Object(g.styled)(X,function(e){var t,n,a=e.className,i=e.theme,r=e.actionable,o=e.compact,s=i.palette,c=i.fonts,d=i.effects,l=Object(g.getGlobalClassNames)(ne,i);return{root:[l.root,{WebkitFontSmoothing:"antialiased",backgroundColor:s.white,border:"1px solid ".concat(s.neutralLight),maxWidth:"320px",minWidth:"206px",userSelect:"none",position:"relative",selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(g.IsFocusVisibleClassName," &:focus")]=Object(g.getInputFocusStyle)(s.neutralSecondary,d.roundedCorner2),t[".".concat(te.root," + .").concat(ee.root)]={paddingTop:"4px"},t)},r&&[l.rootActionable,{selectors:{":hover":{cursor:"pointer",borderColor:s.neutralTertiaryAlt},":hover:after":{content:'" "',position:"absolute",top:0,right:0,bottom:0,left:0,border:"1px solid ".concat(s.neutralTertiaryAlt),pointerEvents:"none"}}}],o&&[l.rootCompact,{display:"flex",maxWidth:"480px",height:"108px",selectors:(n={},n[".".concat(Z.root)]={borderRight:"1px solid ".concat(s.neutralLight),borderBottom:0,maxHeight:"106px",maxWidth:"144px"},n[".".concat(Z.icon)]={maxHeight:"32px",maxWidth:"32px"},n[".".concat($.root)]={paddingBottom:"12px"},n[".".concat(ee.root)]={paddingBottom:"12px 16px 8px 16px",fontSize:c.mediumPlus.fontSize,lineHeight:"16px"},n)}],a]}},void 0,{scope:"DocumentCard"}),ie=n("fxVk"),re=Object(g.classNamesFunction)(),oe=function(e){function t(t){var n=e.call(this,t)||this;return n._renderPreviewList=function(e){var t=n.props,a=t.getOverflowDocumentCountText,r=t.maxDisplayCount,o=void 0===r?3:r,s=e.length-o,c=s?a?a(s):"+"+s:null,d=e.slice(0,o).map(function(e,t){return u.createElement("li",{key:t},u.createElement(g.Image,{className:n._classNames.fileListIcon,src:e.iconSrc,role:"presentation",alt:"",width:"16px",height:"16px"}),u.createElement(g.Link,Object(i.__assign)({className:n._classNames.fileListLink,href:e.url},e.linkProps),e.name))});return u.createElement("div",null,u.createElement("ul",{className:n._classNames.fileList},d),c&&u.createElement("span",{className:n._classNames.fileListOverflowText},c))},Object(g.initializeComponentRef)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props,a=n.previewImages,i=n.styles,r=n.theme,o=n.className,s=a.length>1;return this._classNames=re(i,{theme:r,className:o,isFileList:s}),a.length>1?t=this._renderPreviewList(a):1===a.length&&(t=this._renderPreviewImage(a[0]),a[0].accentColor&&(e={borderBottomColor:a[0].accentColor})),u.createElement("div",{className:this._classNames.root,style:e},t)},t.prototype._renderPreviewImage=function(e){var t=e.width,n=e.height,a=e.imageFit,r=e.previewIconProps,o=e.previewIconContainerClass;if(r)return u.createElement("div",{className:Object(g.css)(this._classNames.previewIcon,o),style:{width:t,height:n}},u.createElement(ie.Icon,Object(i.__assign)({},r)));var s,c=u.createElement(g.Image,{width:t,height:n,imageFit:a,src:e.previewImageSrc,role:"presentation",alt:""});return e.iconSrc&&(s=u.createElement(g.Image,{className:this._classNames.icon,src:e.iconSrc,role:"presentation",alt:""})),u.createElement("div",null,c,s)},t}(u.Component),se=Object(g.styled)(oe,function(e){var t,n,a=e.theme,i=e.className,r=e.isFileList,o=a.palette,s=a.fonts,c=Object(g.getGlobalClassNames)(Z,a);return{root:[c.root,s.small,{backgroundColor:r?o.white:o.neutralLighterAlt,borderBottom:"1px solid ".concat(o.neutralLight),overflow:"hidden",position:"relative"},i],previewIcon:[c.iconContainer,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}],icon:[c.icon,{left:"10px",bottom:"10px",position:"absolute"}],fileList:{padding:"16px 16px 0 16px",listStyleType:"none",margin:0,selectors:{li:{height:"16px",lineHeight:"16px",display:"flex",flexWrap:"nowrap",alignItems:"center",marginBottom:"8px",overflow:"hidden"}}},fileListIcon:{display:"inline-block",flexShrink:0,marginRight:"8px"},fileListLink:[Object(g.getFocusStyle)(a,{highContrastStyle:{border:"1px solid WindowText",outline:"none"}}),{boxSizing:"border-box",color:o.neutralDark,flexGrow:1,overflow:"hidden",display:"inline-block",textDecoration:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",selectors:(t={":hover":{color:o.themePrimary}},t[".".concat(g.IsFocusVisibleClassName," &:focus")]={selectors:(n={},n[g.HighContrastSelector]={outline:"none"},n)},t)}],fileListOverflowText:{padding:"0px 16px 8px 16px",display:"block"}}},void 0,{scope:"DocumentCardPreview"}),ce=Object(g.classNamesFunction)(),de=function(e){function t(t){var n=e.call(this,t)||this;return Object(g.initializeComponentRef)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.location,n=e.locationHref,a=e.ariaLabel,i=e.onClick,r=e.styles,o=e.theme,s=e.className;return this._classNames=ce(r,{theme:o,className:s}),u.createElement("a",{className:this._classNames.root,href:n,onClick:i,"aria-label":a},t)},t}(u.Component),le=Object(g.styled)(de,function(e){var t=e.theme,n=e.className,a=t.palette,i=t.fonts;return{root:[Object(g.getGlobalClassNames)(te,t).root,i.small,{color:a.themePrimary,display:"block",fontWeight:g.FontWeights.semibold,overflow:"hidden",padding:"8px 16px",position:"relative",textDecoration:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",selectors:{":hover":{color:a.themePrimary,cursor:"pointer"}}},n]}},void 0,{scope:"DocumentCardLocation"}),ue=Object(g.classNamesFunction)(),fe=function(e){function t(t){var n=e.call(this,t)||this;return n._titleElement=u.createRef(),n._truncateTitle=function(){n._needMeasurement&&n._async.requestAnimationFrame(n._truncateWhenInAnimation)},n._truncateWhenInAnimation=function(){var e=n.props.title,t=n._titleElement.current;if(t){var a=getComputedStyle(t);if(a.width&&a.lineHeight&&a.height){var i=t.clientWidth,r=t.scrollWidth;n._clientWidth=i;var o=Math.floor((parseInt(a.height,10)+5)/parseInt(a.lineHeight,10));t.style.whiteSpace="";var s=r/(parseInt(a.width,10)*o);if(s>1){var c=e.length/s-3;return n.setState({truncatedTitleFirstPiece:e.slice(0,c/2),truncatedTitleSecondPiece:e.slice(e.length-c/2)})}}}},n._shrinkTitle=function(){var e=n.state,t=e.truncatedTitleFirstPiece,a=e.truncatedTitleSecondPiece;if(t&&a){var i=n._titleElement.current;if(!i)return;(i.scrollHeight>i.clientHeight+5||i.scrollWidth>i.clientWidth)&&n.setState({truncatedTitleFirstPiece:t.slice(0,t.length-1),truncatedTitleSecondPiece:a.slice(1)})}},Object(v.initializeComponentRef)(n),n._async=new g.Async(n),n._events=new g.EventGroup(n),n._clientWidth=void 0,n.state={truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0},n}return Object(i.__extends)(t,e),t.prototype.componentDidUpdate=function(e){var t=this;this.props.title!==e.title&&this.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0}),e.shouldTruncate!==this.props.shouldTruncate?this.props.shouldTruncate?(this._truncateTitle(),this._async.requestAnimationFrame(this._shrinkTitle),this._events.on(window,"resize",this._updateTruncation)):this._events.off(window,"resize",this._updateTruncation):this._needMeasurement&&this._async.requestAnimationFrame(function(){t._truncateWhenInAnimation(),t._shrinkTitle()})},t.prototype.componentDidMount=function(){this.props.shouldTruncate&&(this._truncateTitle(),this._events.on(window,"resize",this._updateTruncation))},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype.render=function(){var e=this,t=this.props,n=t.title,a=t.shouldTruncate,i=t.showAsSecondaryTitle,r=t.styles,o=t.theme,s=t.className,c=this.state,d=c.truncatedTitleFirstPiece,l=c.truncatedTitleSecondPiece;return this._classNames=ue(r,{theme:o,className:s,showAsSecondaryTitle:i}),a&&d&&l?u.createElement(J.Consumer,null,function(t){var a=t.role,i=t.tabIndex;return u.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:n,tabIndex:i,role:a},d,"…",l)}):u.createElement(J.Consumer,null,function(t){var a=t.role,i=t.tabIndex;return u.createElement("div",{className:e._classNames.root,ref:e._titleElement,title:n,tabIndex:i,role:a,style:e._needMeasurement?{whiteSpace:"nowrap"}:void 0},n)})},Object.defineProperty(t.prototype,"_needMeasurement",{get:function(){return!!this.props.shouldTruncate&&void 0===this._clientWidth},enumerable:!1,configurable:!0}),t.prototype._updateTruncation=function(){var e=this;this._timerId||(this._timerId=this._async.setTimeout(function(){delete e._timerId,e._clientWidth=void 0,e.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0})},250))},t}(u.Component),pe=Object(g.styled)(fe,function(e){var t,n=e.theme,a=e.className,i=e.showAsSecondaryTitle,r=n.palette,o=n.fonts,s=n.effects;return{root:[Object(g.getGlobalClassNames)(ee,n).root,i?o.medium:o.large,{padding:"8px 16px",display:"block",overflow:"hidden",position:"relative",wordWrap:"break-word",height:i?"45px":"38px",lineHeight:i?"18px":"21px",color:i?r.neutralSecondary:r.neutralPrimary,selectors:(t={":focus":{outline:"0px solid"}},t[".".concat(g.IsFocusVisibleClassName," &:focus")]=Object(g.getInputFocusStyle)(r.neutralSecondary,s.roundedCorner2),t)},a]}},void 0,{scope:"DocumentCardTitle"});!function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(z||(z={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(G||(G={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(K||(K={})),function(e){e.size8="20px",e.size10="20px",e.size16="16px",e.size24="24px",e.size28="28px",e.size32="32px",e.size40="40px",e.size48="48px",e.size56="56px",e.size72="72px",e.size100="100px",e.size120="120px"}(q||(q={})),function(e){e.size6="6px",e.size8="8px",e.size12="12px",e.size16="16px",e.size20="20px",e.size28="28px",e.size32="32px",e.border="2px"}(Q||(Q={}));var me=function(e){return{isSize8:e===z.size8,isSize10:e===z.size10||e===z.tiny,isSize16:e===z.size16,isSize24:e===z.size24||e===z.extraExtraSmall,isSize28:e===z.size28||e===z.extraSmall,isSize32:e===z.size32,isSize40:e===z.size40||e===z.small,isSize48:e===z.size48||e===z.regular,isSize56:e===z.size56,isSize72:e===z.size72||e===z.large,isSize100:e===z.size100||e===z.extraLarge,isSize120:e===z.size120}},_e=((W={})[z.tiny]=10,W[z.extraExtraSmall]=24,W[z.extraSmall]=28,W[z.small]=40,W[z.regular]=48,W[z.large]=72,W[z.extraLarge]=100,W[z.size8]=8,W[z.size10]=10,W[z.size16]=16,W[z.size24]=24,W[z.size28]=28,W[z.size32]=32,W[z.size40]=40,W[z.size48]=48,W[z.size56]=56,W[z.size72]=72,W[z.size100]=100,W[z.size120]=120,W),he=Object(g.classNamesFunction)({cacheSize:100}),be=u.forwardRef(function(e,t){var n=e.coinSize,a=e.isOutOfOffice,r=e.styles,o=e.presence,s=e.theme,c=e.presenceTitle,d=e.presenceColors,l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=u.useCallback(function(t){n.current=t;for(var a=0,i=e;a<i.length;a++){var r=i[a];"function"==typeof r?r(t):r&&(r.current=t)}},Object(i.__spreadArray)([],e,!0));return n}(t,u.useRef(null)),f=me(e.size),p=!(f.isSize8||f.isSize10||f.isSize16||f.isSize24||f.isSize28||f.isSize32)&&(!n||n>32),m=n?n/3<40?n/3+"px":"40px":"",_=n?{fontSize:n?n/6<20?n/6+"px":"20px":"",lineHeight:m}:void 0,h=n?{width:m,height:m}:void 0,b=he(r,{theme:s,presence:o,size:e.size,isOutOfOffice:a,presenceColors:d});return o===G.none?null:u.createElement("div",{role:"presentation",className:b.presence,style:h,title:c,ref:l},p&&u.createElement(ie.Icon,{className:b.presenceIcon,iconName:ge(e.presence,e.isOutOfOffice),style:_}))});function ge(e,t){if(e){var n="SkypeArrow";switch(G[e]){case"online":return"SkypeCheck";case"away":return t?n:"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?n:""}return""}}be.displayName="PersonaPresenceBase";var ve={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function ye(e){return{color:e,borderColor:e}}function Se(e,t){return{selectors:{":before":{border:"".concat(e," solid ").concat(t)}}}}function De(e){return{height:e,width:e}}function Ie(e){return{backgroundColor:e}}var xe=Object(g.styled)(be,function(e){var t,n,a,r,o,s,c=e.theme,d=e.presenceColors,l=c.semanticColors,u=c.fonts,f=Object(g.getGlobalClassNames)(ve,c),p=me(e.size),m=function(e){return{isAvailable:e===G.online,isAway:e===G.away,isBlocked:e===G.blocked,isBusy:e===G.busy,isDoNotDisturb:e===G.dnd,isOffline:e===G.offline}}(e.presence),_=d&&d.available||"#6BB700",h=d&&d.away||"#FFAA44",b=d&&d.busy||"#C43148",v=d&&d.dnd||"#C50F1F",y=d&&d.offline||"#8A8886",S=d&&d.oof||"#B4009E",D=d&&d.background||l.bodyBackground,I=m.isOffline||e.isOutOfOffice&&(m.isAvailable||m.isBusy||m.isAway||m.isDoNotDisturb),x=p.isSize72||p.isSize100?"2px":"1px";return{presence:[f.presence,Object(i.__assign)(Object(i.__assign)({position:"absolute",height:Q.size12,width:Q.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid ".concat(D),textAlign:"center",boxSizing:"content-box",backgroundClip:"border-box"},Object(g.getHighContrastNoAdjustStyle)()),{selectors:(t={},t[g.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},t)}),(p.isSize8||p.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[g.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},n)},(p.isSize8||p.isSize10||p.isSize24||p.isSize28||p.isSize32)&&De(Q.size8),(p.isSize40||p.isSize48)&&De(Q.size12),p.isSize16&&{height:Q.size6,width:Q.size6,borderWidth:"1.5px"},p.isSize56&&De(Q.size16),p.isSize72&&De(Q.size20),p.isSize100&&De(Q.size28),p.isSize120&&De(Q.size32),m.isAvailable&&{backgroundColor:_,selectors:(a={},a[g.HighContrastSelector]=Ie("Highlight"),a)},m.isAway&&Ie(h),m.isBlocked&&[{selectors:(r={":after":p.isSize40||p.isSize48||p.isSize72||p.isSize100?{content:'""',width:"100%",height:x,backgroundColor:b,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},r[g.HighContrastSelector]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},r)}],m.isBusy&&Ie(b),m.isDoNotDisturb&&Ie(v),m.isOffline&&Ie(y),(I||m.isBlocked)&&[{backgroundColor:D,selectors:(o={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:"".concat(x," solid ").concat(b),borderRadius:"50%",boxSizing:"border-box"}},o[g.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},o)}],I&&m.isAvailable&&Se(x,_),I&&m.isBusy&&Se(x,b),I&&m.isAway&&Se(x,S),I&&m.isDoNotDisturb&&Se(x,v),I&&m.isOffline&&Se(x,y),I&&m.isOffline&&e.isOutOfOffice&&Se(x,S)],presenceIcon:[f.presenceIcon,{color:D,fontSize:"6px",lineHeight:Q.size12,verticalAlign:"top",selectors:(s={},s[g.HighContrastSelector]={color:"Window"},s)},p.isSize56&&{fontSize:"8px",lineHeight:Q.size16},p.isSize72&&{fontSize:u.small.fontSize,lineHeight:Q.size20},p.isSize100&&{fontSize:u.medium.fontSize,lineHeight:Q.size28},p.isSize120&&{fontSize:u.medium.fontSize,lineHeight:Q.size32},m.isAway&&{position:"relative",left:I?void 0:"1px"},I&&m.isAvailable&&ye(_),I&&m.isBusy&&ye(b),I&&m.isAway&&ye(S),I&&m.isDoNotDisturb&&ye(v),I&&m.isOffline&&ye(y),I&&m.isOffline&&e.isOutOfOffice&&ye(S)]}},void 0,{scope:"PersonaPresence"}),Ce=[K.lightBlue,K.blue,K.darkBlue,K.teal,K.green,K.darkGreen,K.lightPink,K.pink,K.magenta,K.purple,K.orange,K.lightRed,K.darkRed,K.violet,K.gold,K.burgundy,K.warmGray,K.cyan,K.rust,K.coolGray],Oe=Ce.length;function we(e){var t=e.primaryText,n=e.text,a=e.initialsColor;return"string"==typeof a?a:function(e){switch(e){case K.lightBlue:return"#4F6BED";case K.blue:return"#0078D4";case K.darkBlue:return"#004E8C";case K.teal:return"#038387";case K.lightGreen:case K.green:return"#498205";case K.darkGreen:return"#0B6A0B";case K.lightPink:return"#C239B3";case K.pink:return"#E3008C";case K.magenta:return"#881798";case K.purple:return"#5C2E91";case K.orange:return"#CA5010";case K.red:return"#EE1111";case K.lightRed:return"#D13438";case K.darkRed:return"#A4262C";case K.transparent:return"transparent";case K.violet:return"#8764B8";case K.gold:return"#986F0B";case K.burgundy:return"#750B1C";case K.warmGray:return"#7A7574";case K.cyan:return"#005B70";case K.rust:return"#8E562E";case K.coolGray:return"#69797E";case K.black:return"#1D1D1D";case K.gray:return"#393939"}}(a=void 0!==a?a:function(e){var t=K.blue;if(!e)return t;for(var n=0,a=e.length-1;a>=0;a--){var i=e.charCodeAt(a),r=a%8;n^=(i<<r)+(i>>8-r)}return Ce[n%Oe]}(n||t))}var Ee=Object(g.classNamesFunction)({cacheSize:100}),Ae=Object(g.memoizeFunction)(function(e,t,n,a,i,r){return Object(g.mergeStyles)(e,!r&&{backgroundColor:we({text:a,initialsColor:t,primaryText:i}),color:n})}),Le={size:z.size48,presence:G.none,imageAlt:""},ke=u.forwardRef(function(e,t){var n=Object(g.getPropsWithDefaults)(Le,e),a=function(e){var t=e.onPhotoLoadingStateChange,n=e.imageUrl,a=u.useState(g.ImageLoadState.notLoaded),i=a[0],r=a[1];return u.useEffect(function(){r(g.ImageLoadState.notLoaded)},[n]),[i,function(e){r(e),null==t||t(e)}]}(n),r=a[0],o=a[1],s=Me(o),c=n.className,d=n.coinProps,l=n.showUnknownPersonaCoin,f=n.coinSize,p=n.styles,m=n.imageUrl,_=n.initialsColor,h=n.initialsTextColor,b=n.isOutOfOffice,v=n.onRenderCoin,y=void 0===v?s:v,S=n.onRenderPersonaCoin,D=void 0===S?y:S,I=n.onRenderInitials,x=void 0===I?Pe:I,C=n.presence,O=n.presenceTitle,w=n.presenceColors,E=n.primaryText,A=n.showInitialsUntilImageLoads,L=n.text,k=n.theme,M=n.size,P=Object(g.getNativeProps)(n,g.divProperties),T=Object(g.getNativeProps)(d||{},g.divProperties),U=f?{width:f,height:f}:void 0,F=l,H={coinSize:f,isOutOfOffice:b,presence:C,presenceTitle:O,presenceColors:w,size:M,theme:k},R=Ee(p,{theme:k,className:d&&d.className?d.className:c,size:M,coinSize:f,showUnknownPersonaCoin:l}),N=Boolean(r!==g.ImageLoadState.loaded&&(A&&m||!m||r===g.ImageLoadState.error||F));return u.createElement("div",Object(i.__assign)({role:"presentation"},P,{className:R.coin,ref:t}),M!==z.size8&&M!==z.size10&&M!==z.tiny?u.createElement("div",Object(i.__assign)({role:"presentation"},T,{className:R.imageArea,style:U}),N&&u.createElement("div",{className:Ae(R.initials,_,h,L,E,l),style:U,"aria-hidden":"true"},x(n,Pe)),!F&&D(n,s),u.createElement(xe,Object(i.__assign)({},H))):n.presence?u.createElement(xe,Object(i.__assign)({},H)):u.createElement(ie.Icon,{iconName:"Contact",className:R.size10WithoutPresenceIcon}),n.children)});ke.displayName="PersonaCoinBase";var Me=function(e){return function(t){var n=t.coinSize,a=t.styles,i=t.imageUrl,r=t.imageAlt,o=t.imageShouldFadeIn,s=t.imageShouldStartVisible,c=t.theme,d=t.showUnknownPersonaCoin,l=t.size,f=void 0===l?Le.size:l;if(!i)return null;var p=Ee(a,{theme:c,size:f,showUnknownPersonaCoin:d}),m=n||_e[f];return u.createElement(g.Image,{className:p.image,imageFit:g.ImageFit.cover,src:i,width:m,height:m,alt:r,shouldFadeIn:o,shouldStartVisible:s,onLoadingStateChange:e})}},Pe=function(e){var t=e.imageInitials,n=e.allowPhoneInitials,a=e.showUnknownPersonaCoin,i=e.text,r=e.primaryText,o=e.theme;if(a)return u.createElement(ie.Icon,{iconName:"Help"});var s=Object(g.getRTL)(o);return""!==(t=t||Object(g.getInitials)(i||r||"",s,n))?u.createElement("span",null,t):u.createElement(ie.Icon,{iconName:"Contact"})},Te={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"},Ue=Object(g.styled)(ke,function(e){var t,n=e.className,a=e.theme,r=e.coinSize,o=a.palette,s=a.fonts,c=me(e.size),d=Object(g.getGlobalClassNames)(Te,a),l=r||e.size&&_e[e.size]||48;return{coin:[d.coin,s.medium,c.isSize8&&d.size8,c.isSize10&&d.size10,c.isSize16&&d.size16,c.isSize24&&d.size24,c.isSize28&&d.size28,c.isSize32&&d.size32,c.isSize40&&d.size40,c.isSize48&&d.size48,c.isSize56&&d.size56,c.isSize72&&d.size72,c.isSize100&&d.size100,c.isSize120&&d.size120,n],size10WithoutPresenceIcon:{fontSize:s.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[d.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:l,width:l},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[d.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0},l>10&&{height:l,width:l}],initials:[d.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":o.white,fontSize:s.large.fontSize,fontWeight:g.FontWeights.semibold,lineHeight:48===l?46:l,height:l,selectors:(t={},t[g.HighContrastSelector]=Object(i.__assign)(Object(i.__assign)({border:"1px solid WindowText"},Object(g.getHighContrastNoAdjustStyle)()),{color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"}),t.i={fontWeight:g.FontWeights.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},l<32&&{fontSize:s.xSmall.fontSize},l>=32&&l<40&&{fontSize:s.medium.fontSize},l>=40&&l<56&&{fontSize:s.mediumPlus.fontSize},l>=56&&l<72&&{fontSize:s.xLarge.fontSize},l>=72&&l<100&&{fontSize:s.xxLarge.fontSize},l>=100&&{fontSize:s.superLarge.fontSize}]}},void 0,{scope:"PersonaCoin"}),Fe=Object(g.classNamesFunction)(),He=function(e){function t(t){var n=e.call(this,t)||this;return Object(g.initializeComponentRef)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.activity,n=e.people,a=e.styles,i=e.theme,r=e.className;return this._classNames=Fe(a,{theme:i,className:r,multiplePeople:n.length>1}),n&&0!==n.length?u.createElement("div",{className:this._classNames.root},this._renderAvatars(n),u.createElement("div",{className:this._classNames.details},u.createElement("span",{className:this._classNames.name},this._getNameString(n)),u.createElement("span",{className:this._classNames.activity},t))):null},t.prototype._renderAvatars=function(e){return u.createElement("div",{className:this._classNames.avatars},e.length>1?this._renderAvatar(e[1]):null,this._renderAvatar(e[0]))},t.prototype._renderAvatar=function(e){return u.createElement("div",{className:this._classNames.avatar},u.createElement(Ue,{imageInitials:e.initials,text:e.name,imageUrl:e.profileImageSrc,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,role:"presentation",size:g.PersonaSize.size32}))},t.prototype._getNameString=function(e){var t=e[0].name;return e.length>=2&&(t+=" +"+(e.length-1)),t},t}(u.Component),Re=Object(g.styled)(He,function(e){var t=e.theme,n=e.className,a=e.multiplePeople,i=t.palette,r=t.fonts,o=Object(g.getGlobalClassNames)($,t);return{root:[o.root,a&&o.multiplePeople,{padding:"".concat(8,"px ").concat(16,"px"),position:"relative"},n],avatars:[o.avatars,{marginLeft:"-2px",height:"32px"}],avatar:[o.avatar,{display:"inline-block",verticalAlign:"top",position:"relative",textAlign:"center",width:32,height:32,selectors:{"&:after":{content:'" "',position:"absolute",left:"-1px",top:"-1px",right:"-1px",bottom:"-1px",border:"2px solid ".concat(i.white),borderRadius:"50%"},":nth-of-type(2)":a&&{marginLeft:"-16px"}}}],details:[o.details,{left:"".concat(a?72:56,"px"),height:32,position:"absolute",top:8,width:"calc(100% - ".concat(72,"px)")}],name:[o.name,{display:"block",fontSize:r.small.fontSize,lineHeight:"15px",height:"15px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:i.neutralPrimary,fontWeight:g.FontWeights.semibold}],activity:[o.activity,{display:"block",fontSize:r.small.fontSize,lineHeight:"15px",height:"15px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:i.neutralSecondary}]}},void 0,{scope:"DocumentCardActivity"}),Ne=n("Ycni"),Be=n("mGD9"),je=function(e){function t(t){var n=e.call(this,t)||this;return n.state={previewUrl:void 0},n}return Object(i.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){_.FileTypeIconsLoader.loadIconsModule().catch(function(e){o._TraceLogger.logError(t._logSource,e,"LoadFileTypeIconsChunk")})},t.prototype.componentDidMount=function(){this._setPreviewUrlWithAuth()},t.prototype.componentDidUpdate=function(e){Object(p.isEqual)(this._constructThumbnailRequest(e),this._constructThumbnailRequest())||this._setPreviewUrlWithAuth()},t.prototype.componentWillUnmount=function(){this._revokePreviewUrl()},t.prototype.render=function(){var e,t=this.props,n=t.absoluteUrl,a=t.authorName,r=t.photoUrl,o=t.resolution,s=t.title,c=(null==n?void 0:n.split(".").pop())||"",d=_.Icons.getIconColorFromExtension(c),l=this._ShouldJumpToNative(),f=_.Icons.getIconUrl(c,this.state.previewUrl?32:64),p={borderBottomColor:d};e=o<=320?Math.min(Math.floor(140.625),250):Math.min(Math.floor(.5625*o),250);var m={previewImages:[{previewImageSrc:this.state.previewUrl,iconSrc:f,height:e,accentColor:d,imageFit:g.ImageFit.cover}]};return u.createElement("div",{"data-is-focusable":!0,"data-automation-id":"DocumentCard"},u.createElement(g.FocusZone,{direction:g.FocusZoneDirection.vertical},u.createElement(ae,{onClick:l?void 0:this._onClick,onClickHref:l?this._wacPath:void 0},this.state.previewUrl?u.createElement(se,Object(i.__assign)({},m)):u.createElement("div",{className:Object(g.css)("ms-DocumentCardPreview","iconWithoutPreview"),style:p},u.createElement("img",{src:f,alt:"",role:"presentation"})),u.createElement("div",null,u.createElement(le,{location:this._parent,locationHref:this._parentHref})),s?u.createElement("div",null,u.createElement(pe,{title:s,shouldTruncate:!!s})):void 0,this._activity&&a&&r?u.createElement("div",null,u.createElement(Re,{activity:this._activity,people:[{name:a,profileImageSrc:r}]})):void 0)))},t.prototype._ShouldJumpToNative=function(){var e=this.props,t=e.absoluteUrl,n=e.appType,a=!!b.WebViewUtility.webViewActionRole,i=s._BrowserDetection.getBrowserInformation().os===s._OS.IOS,r=n===F.e.Video,o=location.hostname!==new URL(t).hostname,c=i&&r&&o;return Object(j.r)()?a:a&&!c},t.prototype._setPreviewUrlWithAuth=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,n,a,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(e=this._getPreviewUrl()))return[2];if((n=new URL(e).origin)===window.location.origin)return this.setState({previewUrl:e}),[2];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.props.getAuthToken(n)];case 2:return a=i.sent(),[4,this._fetchThumbnailImage(e,{method:"GET",headers:{Authorization:"Bearer ".concat(a)}})];case 3:return r=i.sent(),this.setState({previewUrl:r}),[2];case 4:return s=i.sent(),this.setState({previewUrl:e}),o._TraceLogger.logError(t._logSource,s),[3,5];case 5:return[2]}})})},t.prototype._getPreviewUrl=function(){var e=this._constructThumbnailRequest();return _.ThumbnailUrlGenerator.getThumbnailUrl(e)},t.prototype._constructThumbnailRequest=function(e){var t=e||this.props,n=t.absoluteUrl,a=t.listId,i=t.resolution,r=t.siteId;return{absoluteUrl:t.webAbsoluteUrl,siteId:r,webId:t.webId,listId:a,uniqueId:t.uniqueId,fileType:(null==n?void 0:n.split(".").pop())||"",width:i,callerId:"docEmbedCard"}},t.prototype._fetchThumbnailImage=function(e,t){return fetch(e,t).then(function(e){return e.blob()}).then(function(e){return URL.createObjectURL(e)})},t.prototype._revokePreviewUrl=function(){var e=this.state.previewUrl;e&&/^blob:/.test(e)&&URL.revokeObjectURL(e)},t.prototype._onClick=function(e){r._EngagementLogger.logEvent("DocumentCard.Click",e.type),window.open(this._wacPath,"_blank")},Object.defineProperty(t.prototype,"_parent",{get:function(){var e=this.props,t=e.absoluteUrl,n=e.webAbsoluteUrl;if(!t)return"";var a,i=new l.Uri(t).getPathSegments();return a=i.length>1?i[i.length-2]:n?n.split("/").pop():"",decodeURI(a)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_parentHref",{get:function(){var e=this.props.absoluteUrl;if(!e)return"";var t=e.split("/");return t.pop(),t.join("/")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_activity",{get:function(){var e=this.props.modifiedDate;if(e){var t=Date.parse(e);if("number"==typeof t){var n=new Date(t);if(n)return l.StringHelper.format(Be.d,Ne.LocaleFormat.formatDate(n,{date:"medium"}))}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_wacPath",{get:function(){return _.SPUtility.getWebPathOfFile(this.props.absoluteUrl)},enumerable:!1,configurable:!0}),t._logSource=o._LogSource.create("DocumentEmbedCard"),Object(i.__decorate)([g.autobind],t.prototype,"_onClick",null),t}(g.BaseComponent);n("jOlS").loadStyles('.a_a_866d546b{display:none}.b_a_866d546b:focus-within .c_a_866d546b{border:3px solid #fff;outline:6px solid #000}.b_a_866d546b .e_a_866d546b{border:none;height:100%;left:0;position:absolute;top:0;width:100%}.b_a_866d546b .f_a_866d546b{padding-top:56.25%;position:relative}.b_a_866d546b .f_a_866d546b.g_a_866d546b{padding-top:max(250px,56.25%)}.b_a_866d546b .f_a_866d546b.h_a_866d546b{padding-top:calc(56.25% + 24px)}.b_a_866d546b .i_a_866d546b{align-items:center;display:flex;height:100%;justify-content:center;left:calc(50% - 62px);position:absolute;top:0}.j_a_866d546b{border:none;-o-object-fit:cover;object-fit:cover;transition:opacity 1s ease-in-out}.j_a_866d546b,.k_a_866d546b{height:100%;position:absolute;top:0;width:100%;z-index:1}.k_a_866d546b{background-color:#000;content:"";opacity:.44}[dir=ltr] .k_a_866d546b{left:0}[dir=rtl] .k_a_866d546b{right:0}.l_a_866d546b{opacity:0}.m_a_866d546b{z-index:0}.n_a_866d546b{cursor:pointer}.o_a_866d546b{background-color:#000;cursor:pointer;left:50%;opacity:1;position:absolute;text-align:center;top:50%;z-index:2}.p_a_866d546b{color:#fff;font-size:68px;position:absolute;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .p_a_866d546b{left:50%}[dir=rtl] .p_a_866d546b{right:50%}.p_a_866d546b:focus{border:3px solid #fff;border-radius:50px}.q_a_866d546b{color:#fff;font-family:"Segoe UI Web (West European)",Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif;font-size:20px;font-style:normal;font-weight:400;line-height:32px;margin-top:8px;overflow:hidden;position:absolute;text-overflow:ellipsis;top:0;transition:opacity 1s ease-in-out;white-space:nowrap;z-index:2}[dir=ltr] .q_a_866d546b{margin-left:14px}[dir=ltr] .q_a_866d546b,[dir=rtl] .q_a_866d546b{margin-right:14px}[dir=rtl] .q_a_866d546b{margin-left:14px}.r_a_866d546b{width:90%}.s_a_866d546b{background-color:rgba(0,0,0,.45);border-radius:2px;bottom:0;color:#fff;font-size:18px;margin-bottom:8px;padding-bottom:4px;position:absolute;transition:opacity 1s ease-in-out;z-index:2}[dir=ltr] .s_a_866d546b{right:8px}[dir=rtl] .s_a_866d546b{left:8px}',!0);var Ve="j_a_866d546b",ze="q_a_866d546b",Ge=n("dVDx"),Ke=function(e){function t(t){var n,a=this;return(a=e.call(this,t)||this).handleFilePickerClick=function(){a._ensureFilePicker().then(function(){a._filePicker.open(),o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","Open")}).catch(function(e){o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebPart"),e,"LoadFilePickerChunk")})},a._asyncImage=function(e){var t=function(e,t){var n=new l.XHR({url:e,responseType:"blob",headers:{Authorization:"bearer ".concat(t)}});return new l.CancelablePromise(function(e,t){n.start(function(t,n){var i=t.response;if(!(n>=200&&n<300&&i))return a._waitForXHR=!1,Promise.reject("Unable to load image");e(i)},function(e,n,a){t(e,n,a)})},function(){a._waitForXHR=!1,n.abort(!0)})},n=u.useState(void 0),r=n[0],o=n[1];if(u.useEffect(function(){if(e.src)return a._waitForXHR=!0,a.props.getAuthToken().then(function(n){return t(e.src,n).catch(function(i){if(a._graphHttpClient&&i&&(404===i.status||403===i.status)&&a.props.link){var r="u!"+window.btoa(a.props.link).trim().replace(/=+$/,"").replace("/","_").replace("+","-");return a._graphHttpClient.get("v1.0/shares/".concat(r),M._DEPRECATED_DO_NOT_USE_GraphHttpClient.configurations.v1,{headers:[["Prefer","redeemSharingLink"]]}).then(function(i){return i.ok?t(e.src,n):(a._waitForXHR=!1,Promise.reject("Unable to load image"))})}a._waitForXHR=!0}).then(function(e){a._waitForXHR=!1,e&&o(URL.createObjectURL(e))})}).catch(function(){a._waitForXHR=!1}),function(){r&&/^blob:/.test(r)&&URL.revokeObjectURL(r)}},[e.src]),r){e.src;var s=Object(i.__rest)(e,["src"]);return u.createElement("img",Object(i.__assign)({src:r},s))}return u.createElement("img",{alt:Be.l})},a._handleVideoThumbnailClick=function(e){if(!Object(j.g)()&&!a.props.edit&&"hidden"===a.state.iFrameVisibility&&a.props.isVideo&&!Object(j.d)()&&(!a._waitForXHR||!a.props.link))if(Object(j.m)())a._setIframeVisibilityState();else{var t=void 0;if(a.state.docIframeSrc){t=new l.Uri(a.state.docIframeSrc);try{var n=JSON.parse(t.getQueryParameter("embed"));n.af=!0,t.setQueryParameter("embed",JSON.stringify(n))}catch(e){}}a._setIframeVisibilityState(t.toString())}if(!Object(j.v)()&&a.props.isVideo){var i=s._BrowserUtilities.isTeamsHosted()?"Teams":"SharePoint",r=new o._LogEntry("FileViewer Webpart","OnClick",o._LogType.Event,{displayApp:i});o._EngagementLogger.logEventWithLogEntry(r)}},a._onSuccessfulDocIFrameLoad=function(){o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","SuccessfulFileSelection"),a._documentLoadMonitor&&!a._isFastPreviewSupported&&(a._documentLoadMonitor.writeSuccess(a._eventData),a._resetDocMonitors(),a._removeHoverBorders()),a._thumbnailLoaded||a.props.renderCompleted(),!Object(j.g)()&&a.props.isVideo||a._removeThumbNail()},a._onFailedDocIFrameLoad=function(){o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","UnSuccessfulFileSelection"),a._documentLoadMonitor&&a._documentLoadMonitor.writeUnexpectedFailure("iframeLoadFailure",void 0,a._eventData),a.props.statusRender.renderError(a.props.statusRenderElement,new Error(Be.L)),a._resetDocMonitors(),a._thumbnailLoaded||a.props.renderCompleted()},a._onFailedImgLoad=function(){a.setState({iFrameVisibility:"visible",imgClass:Object(g.css)(Ve,g.AnimationClassNames.fadeOut100)},function(){Object(j.c)()||a._setEmbedIFrameContent()}),a._thumbnailLoaded=!1,a._logThumbnailStatus(a._previewUrl,!1)},a._onSuccessFullImgLoad=function(){a.props.edit&&a.setState({iFrameVisibility:"visible"},function(){Object(j.c)()||a._setEmbedIFrameContent()}),a.props.renderCompleted(),a._thumbnailLoaded=!0,a._logThumbnailStatus(a._previewUrl,!0)},a._handleMouseOver=function(){a.props.edit||"hidden"!==a.state.iFrameVisibility||Object(j.d)()||a._waitForXHR&&a.props.link||!Object(j.g)()&&a.props.isVideo||a._setIframeVisibilityState()},a._handleKeyDown=function(e){a.props.edit||"hidden"!==a.state.iFrameVisibility||e.which!==g.KeyCodes.enter||Object(j.d)()||a._waitForXHR&&a.props.link||!Object(j.g)()&&a.props.isVideo||a._setIframeVisibilityState(),Object(j.h)()||a.props.isVideo&&e.which===g.KeyCodes.enter&&"embedVideoPreview"===document.activeElement.id&&a._handleVideoThumbnailClick(e)},a._isCrossDomain=!1,a._thumbnailLoaded=!1,a._isFastPreviewSupported=V(a.props.file),a.state={docIframeSrc:"",elementWidth:a.props.width,imgClass:Ve,iFrameVisibility:"hidden"},a._graphHttpClient=null===(n=t.serviceScope)||void 0===n?void 0:n.consume(M._DEPRECATED_DO_NOT_USE_GraphHttpClient.serviceKey),a._waitForXHR=!1,a}return Object(i.__extends)(t,e),t._isLogThumbnailStatusKSActivated=function(){return s._SPKillSwitch.isActivated("4c02c803-b408-4084-9759-0186b0007585")},t._isFullScreenAllowedKSActivated=function(){return s._SPKillSwitch.isActivated("5fb33a5b-cffb-46fa-a52d-f25fee60920d")},t.prototype.componentDidUpdate=function(e){if(!Object(j.t)()){var t=this.props.absoluteUrl,n=e.absoluteUrl;t&&t!==n&&(this._isCrossDomain=new URL(t).origin!==window.location.origin),this._isFastPreviewSupported=V(this.props.file)}},t.prototype.componentDidMount=function(){var e=this.props,t=e.edit,n=e.renderedFromPersistedData,a=e.canOpenPopupOnRender,i=e.isUploadedFromLocalFiles;!t||n||!a||i||!Object(j.f)()&&this.props.isDocumentSelected||this.handleFilePickerClick(),this._isFastPreviewSupported&&Object(j.c)()&&(this._oneUpMessageEventListener=this._onReceiveMessage,window.addEventListener("message",this._oneUpMessageEventListener));var r=this.props.absoluteUrl;r&&(o._EngagementLogger.logEvent("DocumentEmbedWP.extension.".concat(t?"edit":"view"),r.split(".").pop()),this._isCrossDomain=new URL(r).origin!==window.location.origin),this.props.edit||this._embedOverlay||(this._embedOverlay=!Object(j.b)()&&this.props.isVideo?this._getVideoIcon():Object(b.getEmbedOverlay)(this._getIconName(this.props.serverRelativeUrl)))},t.prototype.componentWillUnmount=function(){this._documentLoadMonitor&&this._documentLoadMonitor.writeExpectedFailure("DocumentEmbedWebPartUnmounted",void 0,this._eventData),this._resetDocMonitors(),this._host&&(this._host.dispose(),this._host=void 0),this._isFastPreviewSupported&&Object(j.c)()&&(window.removeEventListener("message",this._oneUpMessageEventListener,!1),this._oneUpMessageEventListener=void 0)},t.prototype.render=function(){var e,n,a=this.props,r=a.absoluteUrl,o=a.authorName,c=a.authorPhotoUrl,d=a.dynamicSourceName,l=a.edit,f=a.isDocumentSelected,p=a.listId,m=a.modifiedAt,h=a.serverRelativeUrl,v=a.showPlaceHolder,y=a.siteId,S=a.title,D=a.uniqueId,I=a.uploadProgressMessage,x=a.webAbsoluteUrl,C=a.webId,O=a.emphasisTheme,w=a.getAuthToken;this._appType=Object(R.e)(h);var E="";if(r&&!this._shouldRenderAsCard){var A=r.split(".").pop(),L={absoluteUrl:x,siteId:y,webId:C,listId:p,width:this.props.width,uniqueId:D,fileType:A,callerId:"docEmbedCard"};E=_.ThumbnailUrlGenerator.getThumbnailUrl(L)}var k=!t._isFullScreenAllowedKSActivated()&&this._appType===F.e.Video||void 0,M=!this._shouldRenderAsCard,P=d?s.Text.format(Be.f,d):this._isFastPreviewSupported?Object(Ge.e)()||0!==s._SPExperiment.getVariantAndLogExposure(90027)?Be.D:Be.O:Be.p,T=this._isFastPreviewSupported?Object(Ge.e)()||1===s._SPExperiment.getVariantAndLogExposure(90027)?Be.I:2===s._SPExperiment.getVariantAndLogExposure(90027)?Be.x:Be.w:Be.m,U=!!E,H=r?_.SPUtility.getWebPathOfFile(r):r;U||this._logThumbnailStatus(void 0,!1);var N=!this.props.edit&&U&&"hidden"===this.state.iFrameVisibility,B=this.state.imgClass;!Object(j.g)()&&this.props.isVideo&&(B=Object(g.css)(B,"n_a_866d546b",((e={}).m_a_866d546b="visible"===this.state.iFrameVisibility,e),((n={}).l_a_866d546b="visible"===this.state.iFrameVisibility,n)));var V=Object(j.y)()?ze:Object(g.mergeStyles)([ze,"r_a_866d546b"]);return f||v||I?u.createElement("div",{className:"b_a_866d546b","data-automation-id":"DocumentEmbed"},u.createElement("button",{className:"a_a_866d546b"}),u.createElement("div",{role:M?"region":"button","aria-label":M?Be._:void 0,className:this._shouldRenderAsCard||v?"":Object(g.css)("f_a_866d546b",this._appType!==F.e.Word||Object(j.s)()?void 0:"g_a_866d546b",this._appType===F.e.PowerPoint?"h_a_866d546b":void 0,"c_a_866d546b"),"data-sp-action":this._shouldRenderAsCard?b.WebViewUtility.getOpenDocumentAction(H):void 0},v?u.createElement("div",null,u.createElement(b.Placeholder,{ref:this._resolveRef("_placeHolder"),icon:"Page",iconText:T,description:P,buttonLabel:l?Be.t:void 0,onAdd:this.handleFilePickerClick,webpartWidth:this.state.elementWidth})):I?u.createElement("div",{className:"i_a_866d546b"},u.createElement(g.Spinner,{type:g.SpinnerType.large,label:I})):this._shouldRenderAsCard?u.createElement(je,{absoluteUrl:r,webAbsoluteUrl:x,siteId:y,webId:C,listId:p,uniqueId:D,title:S,modifiedDate:m,authorName:o,photoUrl:c,resolution:this.state.elementWidth,getAuthToken:w,appType:this._appType}):u.createElement("div",{id:this.props.isVideo?"embedVideoPreview":"",onClick:!Object(j.g)()&&this._handleVideoThumbnailClick,role:N?"row":void 0,onMouseOver:this._handleMouseOver,onKeyDown:this._handleKeyDown,tabIndex:0},N&&this._embedOverlay,U&&u.createElement(u.Fragment,null,this._showVideoMetadata()&&u.createElement(u.Fragment,null,u.createElement("span",{className:V,title:Object(j.y)()?"":this.props.title},this.props.title),u.createElement("span",{className:"s_a_866d546b"},_.SPUtility.formatDuration(this.props.videoDuration))),!Object(j.d)()&&this.props.link?u.createElement(this._asyncImage,{src:E,className:B,onError:this._onFailedImgLoad,onLoad:this._onSuccessFullImgLoad,alt:Be.l}):u.createElement("img",{src:E,className:B,onError:this._onFailedImgLoad,onLoad:this._onSuccessFullImgLoad,alt:Be.l}),this._showVideoMetadata()&&u.createElement("div",{className:"k_a_866d546b",tabIndex:0})),!N&&u.createElement("iframe",Object(i.__assign)({ref:this._resolveRef("_dociFrame"),className:"e_a_866d546b",frameBorder:"0",allowFullScreen:k,tabIndex:0,src:!Object(j.c)()&&this._isCrossDomain&&this._isFastPreviewSupported?"":this.state.docIframeSrc,title:Be.Y,role:"document",style:{visibility:U?this.state.iFrameVisibility:"visible"},onLoad:this._onSuccessfulDocIFrameLoad,onError:this._onFailedDocIFrameLoad},Object(j.t)()?{}:{key:r})))),f?u.createElement(b.CaptionElement,{ref:this._resolveRef("_captionElement"),isEditMode:l,placeholder:Be.n,text:this.props.annotation,onChange:this.props.onChangeCaptionText,className:Object(j.S)()?"":Object(g.mergeStyles)(this._getCaptionStyles(O))}):void 0):u.createElement("div",null)},t.prototype.setDocumentIFrameSrc=function(e){this._documentLoadMonitor||(this._documentLoadMonitor=new o._QosMonitor("DocEmbedWp.FileLoad")),this.setState({docIframeSrc:e})},t.prototype.onDocumentSelectionCancelled=function(){this._placeHolder&&this._placeHolder.focusOnPlaceHolderButton(),o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","UserCancelled")},t.prototype.focusOnCaptionElement=function(){_.ScreenReaderAlert.read(Be.W,_.ReadingMode.ReadImmediately),this._captionElement&&this._captionElement.focusOnCaptionElement()},t.prototype.setContainerWidth=function(e){this.setState({elementWidth:e})},Object.defineProperty(t.prototype,"_shouldRenderAsCard",{get:function(){var e=s._BrowserDetection.getBrowserInformation();if(e.isMobile&&!e.isIpad||s._BrowserUtilities.isMobileWebView())return!0;var t=this._isFastPreviewSupported?355:320;return this.state.elementWidth<=t},enumerable:!1,configurable:!0}),t.prototype._getCaptionStyles=function(e){return e?{color:e.semanticColors.bodyText+" !important",selectors:{textarea:{color:e.semanticColors.bodyText},"textarea::placeholder":{color:e.semanticColors.bodySubtext}}}:void 0},t.prototype._ensureFilePicker=function(){var e=this;if(this._filePicker)return Promise.resolve();var t={onSelect:this.props.onSelect,onCancel:this.onDocumentSelectionCancelled,selectionMode:v.SelectionMode.single,itemTypes:new Set([a.Documents]),disableLocalUpload:this.props.disableUpload,callerName:"FileViewerWebPart"};return Object(j.n)()||(t.disableStockAssets=!0),b.EditModeUtilitiesLoader.GetUtilities().then(function(n){return n.FilePickerLoader.load(e.props.serviceScope,t).then(function(t){e._filePicker||(e._filePicker=t)})})},t.prototype._setIframeVisibilityState=function(e){var t=this;Object(j.m)()?this.setState({iFrameVisibility:"visible"},function(){Object(j.c)()||t._setEmbedIFrameContent()}):this.setState({iFrameVisibility:"visible",docIframeSrc:e||this.state.docIframeSrc},function(){Object(j.c)()||t._setEmbedIFrameContent()})},t.prototype._removeThumbNail=function(){var e=this;setTimeout(function(){e.setState({imgClass:Object(g.css)(Ve,g.AnimationClassNames.fadeOut200)}),setTimeout(function(){e.setState({imgClass:Object(g.css)(Ve,"m_a_866d546b")})},200)},1e3)},t.prototype._removeHoverBorders=function(){if((this._appType===F.e.PowerPoint||this._appType===F.e.Word)&&this._dociFrame&&this._dociFrame.contentWindow&&s._BrowserDetection.getBrowserInformation().os!==s._OS.IOS)try{var e=this._dociFrame.contentWindow.document.getElementsByName("WebApplicationFrame"),t=e&&e.length>0?e.item(0):void 0;if(t){var n=!1,a=!1;switch(this._appType){case F.e.PowerPoint:this._dociFrame.style.height="calc(100% + 1px)",a=!0,n=!0;break;case F.e.Word:n=!0}if(n||a){var i=t.getBoundingClientRect();a&&(t.style.width="calc(100% + 2px)",t.style.height=i.height+2+"px"),n&&(t.style.top=i.top-1+"px",t.style.left=i.left-1+"px")}}}catch(e){}},t.prototype._resetDocMonitors=function(){this._documentLoadMonitor=void 0},t.prototype._onReceiveMessage=function(e){var t=this;if(this._isValidMessageOrigin(null==e?void 0:e.origin)&&e.data&&"string"==typeof e.data&&0===e.data.lastIndexOf(this._oneUpEmbedFromMessagePrefix,0)){var n=JSON.parse(e.data.substring(this._oneUpEmbedFromMessagePrefix.length));if(this._documentLoadMonitor){var a=this._eventData;switch(n.type){case k.success:this._documentLoadMonitor.writeSuccess(a);break;case k.error:var i=n.error||{},r=i.code,s=void 0===r?"Unspecified":r,c=i.message,d=new Error(c);n.isExpected?this._documentLoadMonitor.writeExpectedFailure(s,d,a):this._documentLoadMonitor.writeUnexpectedFailure(s,d,a);break;case k.getToken:this.props.getAuthToken().then(function(e){t._postOneUpEmbedTokenResult(n.conversationId,e)}).catch(function(e){o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebpart"),e),t._postOneUpEmbedTokenResult(n.conversationId,"",e)})}}else o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebpart"),new Error("postMessage while monitor undefined"));this._resetDocMonitors(),this._thumbnailLoaded||this.props.renderCompleted(),window.postMessage(this._constructOneUpEmbedAcknowledgement(n),Object(H.t)())}},t.prototype._isValidMessageOrigin=function(e){if(e){var t=this.props.absoluteUrl?new URL(this.props.absoluteUrl).origin:void 0;return e.indexOf(Object(H.t)())>=0||t&&e.indexOf(t)>=0}return!1},Object.defineProperty(t.prototype,"_oneUpEmbedFromMessagePrefix",{get:function(){return s.Text.format("[OneDrive:From:Embed:{0}]",this.props.uniqueId)},enumerable:!1,configurable:!0}),t.prototype._constructOneUpEmbedAcknowledgement=function(e){return s.Text.format(U,this.props.uniqueId,e.conversationId)},t.prototype._postOneUpEmbedTokenResult=function(e,t,n){var a,i=t?{type:k.result,conversationId:e,data:{result:k.success,token:t}}:{type:k.result,conversationId:e,data:{result:k.error,isExpected:!1,error:{message:null==n?void 0:n.message}}};if(this.props.absoluteUrl){var r=s.Text.format(T,this.props.uniqueId)+JSON.stringify(i);null===(a=this._dociFrame.contentWindow)||void 0===a||a.postMessage(r,new URL(this.props.absoluteUrl).origin)}},Object.defineProperty(t.prototype,"_eventData",{get:function(){return{appType:this._appType&&F.e[this._appType]||"unknown",extension:_.ExtensionHelper.getExtension(this.props.serverRelativeUrl),isCrossDomain:this.props.isCrossDomain,isCrossWeb:this.props.isCrossWeb}},enumerable:!1,configurable:!0}),t.prototype._logThumbnailStatus=function(e,n){if(!t._isLogThumbnailStatusKSActivated()&&this._previewUrl!==e){var a=this.props.edit?"Edit":"Read",i=new o._QosMonitor("EmbedWebpartThumbnail"),r={alias:"FileViewerWebPart",displayMode:a};void 0===e?i.writeExpectedFailure("Unavailable",void 0,r):!1===n?i.writeUnexpectedFailure("FailedToLoad",void 0,r):!0===n&&i.writeSuccess(r),this._previewUrl=e}},t.prototype._setEmbedIFrameContent=function(){var e=this;this._isCrossDomain&&this._isFastPreviewSupported&&"visible"===this.state.iFrameVisibility&&this.state.docIframeSrc&&this._dociFrame&&this.props.getAuthToken().then(function(t){var n=Math.random().toString(16);e._host&&(e._host.dispose(),e._host=void 0),Object(j.p)()?e._host=function(e,t){void 0===t&&(t={});var n=e.channelId,a=e.onReinitialize,i=e.origin,r=e.receiver,o=void 0===r?window:r,s=e.source,c=e.identifyParent,d=t.eventGroupType,l=void 0===d?I:d,u=t.messengerType,f=void 0===u?A:u,p=new D,m=p.attach(new l(null));return new f({onCommand:e.onCommand,onNotification:e.onNotification,init:function(e,t){var r;if(c&&s){var d=setInterval(function(){var e={type:"identify-parent",channelId:n};s.postMessage(e,i)},100);r=p.attach({dispose:function(){clearInterval(d)}})}var l=!1;m.on(o,"message",function(t){var o=t.data;if(t.origin===i&&(!s||t.source===s)&&o&&"object"==typeof o&&"initialize"===o.type&&o.channelId===n){if(r&&r.dispose(),a){if(l)return a(),void m.dispose();l=!0}else m.dispose();var c=o.replyTo;c.postMessage({type:"activate"}),e(c)}})},initResources:p,initTimeoutMs:e.initTimeoutMs,ackTimeoutMs:e.ackTimeoutMs,resultTimeoutMs:e.resultTimeoutMs})}({channelId:n,origin:new h.SPResourcePath(e.state.docIframeSrc).authority,source:e._dociFrame.contentWindow,onCommand:function(t){if(t.command===k.getToken)return t.tokenType===P.SHAREPOINT?e.props.getAuthToken().then(function(e){return{result:k.success,token:e}}).catch(function(e){return o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebpart"),e),{result:k.error,isExpected:!1,error:{code:null==e?void 0:e.name,message:null==e?void 0:e.message}}}):Promise.resolve(void 0)},onNotification:function(t){var n=e._eventData;if(e._documentLoadMonitor)switch(t.notification){case k.success:e._documentLoadMonitor.writeSuccess(n);break;case k.error:var a=t,i=a.error||{},r=i.code,s=void 0===r?"Unspecified":r,c=i.message,d=new Error(c);return void(a.isExpected?e._documentLoadMonitor.writeExpectedFailure(s,d,n):e._documentLoadMonitor.writeUnexpectedFailure(s,d,n))}else o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebpart"),new Error("postMessage while monitor undefined"));e._resetDocMonitors(),e._thumbnailLoaded||e.props.renderCompleted()}}):e._host=Object(y._getHostCommandHandler)(n,e._dociFrame,e.state.docIframeSrc,e._documentLoadMonitor,e.props.getAuthToken,"DocumentEmbedWebpart",function(){e._resetDocMonitors(),e._thumbnailLoaded||e.props.renderCompleted()},e._eventData),function(e){var t=e.document;t.body||t.createElement("body");var n=t.createElement("form");n.action=e.url,n.method="POST",n.style.visibility="hidden",n.target="_self";var a=e.postdata;for(var i in a)if(a.hasOwnProperty(i)){var r=t.createElement("input");r.type="hidden",r.name=i,r.value=a[i],n.appendChild(r)}t.body.appendChild(n),n.submit()}({url:e.state.docIframeSrc+"#channelId=".concat(n,"&origin=").concat(e._dociFrame.contentWindow.origin),postdata:{access_token:t},document:e._dociFrame.contentDocument})})},t.prototype._getIconName=function(e){return/(\.doc|\.docx)$/i.test(e)?"WordDocument":/(\.xls|\.xlsx)$/i.test(e)?"ExcelDocument":/(\.ppt|\.pptx|\.pot|\.potx)$/i.test(e)?"PowerPointDocument":/(\.vsd|\.vsdx|\.vsdm)$/i.test(e)?"VisioDocument":/(\.one)$/i.test(e)?"OneNoteLogo":/(\.pdf)$/i.test(e)?"PDF":_.spConstants.imageExtensions.map(function(t){return new RegExp("(\\.".concat(t,")$")).test(e)}).some(function(e){return e})?"Photo2":_.spConstants.videoExtensions.map(function(t){return new RegExp("(\\.".concat(t,")$")).test(e)}).some(function(e){return e})?"MSNVideos":"TextDocument"},t.prototype._showVideoMetadata=function(){return!Object(j.g)()&&"hidden"===this.state.iFrameVisibility&&this.props.isVideo},t.prototype._getVideoIcon=function(){var e=this.state.elementWidth>600?100:48;return u.createElement("div",{className:"o_a_866d546b"},u.createElement("svg",{className:"p_a_866d546b",width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},u.createElement("path",{d:"M5 5.27368C5 3.56682 6.82609 2.48151 8.32538 3.2973L20.687 10.0235C22.2531 10.8756 22.2531 13.124 20.687 13.9762L8.32538 20.7024C6.82609 21.5181 5 20.4328 5 18.726V5.27368Z",fill:"#ffffff"})))},Object(i.__decorate)([g.autobind],t.prototype,"onDocumentSelectionCancelled",null),Object(i.__decorate)([g.autobind],t.prototype,"setContainerWidth",null),Object(i.__decorate)([g.autobind],t.prototype,"_ensureFilePicker",null),Object(i.__decorate)([g.autobind],t.prototype,"_onReceiveMessage",null),t}(g.BaseComponent),We=Ke,qe={sourcedoc:"",file:"",action:"interactivepreview",defaultitemopen:1,wdembedcode:1,wdprint:1,wdstarton:1},Qe={sourcedoc:"",file:"",action:"interactivepreview",defaultitemopen:1,wdeaa:0,wdAr:1.7777777,wdslideindex:1},Ye={sourcedoc:"",file:"",action:"embedview",defaultitemopen:1,allowtyping:!1,wddownloadbutton:!0,wdhidegridlines:!0,wdhideheaders:!0,wdallowinteractivity:!0,item:""},Je={sourcedoc:"",file:"",action:"EmbedView"},Xe=n("m2Nw"),Ze=function(){function e(){}return e.getIframeUrl=function(t,n,a){return V(t.file)?function(e,t,n){var a=Object(H.e)(e,t.web.absoluteUrl);if(a){var i,r=new h.SPResourcePath(a),o="gltf"===_.ExtensionHelper.getExtension(r),c=e.startPage,d=void 0===c?1:c,u=e.uniqueId,f=e.webAbsoluteUrl||t.web.absoluteUrl;if(o){var p=new l.Uri(a);(i=new l.Uri(l.Uri.concatenate(f,_.spConstants.oneDrivePath))).setQueryParameter("p","16");var m=Object(H.n)(p);i.setQueryParameter("parent",m),i.setQueryParameter("listurl",m),b=p.getPath(),i.setQueryParameter("id",b)}else if(i=new l.Uri(l.Uri.concatenate(f,_.spConstants.embedPath)),u)i.setQueryParameter("UniqueId",u);else{var b=r.path;i.setQueryParameter("id",encodeURIComponent(b))}i.setQueryParameter("client_id","FileViewerWebPart"),Object(j.u)()||i.setQueryParameter("showNewWindow",String(!s._BrowserUtilities.isTeamsWebViewHosted()));var g=Object(j.c)()?JSON.stringify({af:!Object(j.g)()&&!!n,id:u,o:Object(H.t)(),p:d,z:"width"}):JSON.stringify({af:!Object(j.g)()&&!!n,p:d,z:"width"});return i.setQueryParameter("embed",g),Object(j.e)()||i.setQueryParameter("auth","readwrite"),i.toString()}}(t,n,a):e._getUpdatedWopiUrl(t)},e.isVideo=function(e){if(Object(j._)())return _.spConstants.videoExtensions.map(function(t){return new RegExp("(\\.".concat(t,")$")).test(e)}).some(function(e){return e});var t=_.ExtensionHelper.getExtension(e);return void 0!==t&&_.PreviewUtility.isVideo(t)},e._getUpdatedWopiUrl=function(t){var n=Object(R.e)(t.file);if(n===F.e.Other||n===F.e.Video)throw Be.C;var a=decodeURI(t.wopiurl),i=function(e){switch(e){case F.e.Word:return qe;case F.e.PowerPoint:return Qe;case F.e.Excel:return Ye;case F.e.Visio:return Je}}(n);try{var r=Object.keys(t),o=a.split("?"),s=[];for(var c in i)if(i.hasOwnProperty(c)){var d="";"sourcedoc"===c&&o.length>1?d=c+"="+e._getQueryParamValue(a,c):"wdhidegridlines"===c||"wdhideheaders"===c?d=e._getQueryParameter(t,r,c,c,i,!0):"item"===c?t.hasOwnProperty("chart"+c)&&""!==t["chart"+c]?d=e._getQueryParameter(t,r,c,"chart"+c,i):t.hasOwnProperty("range"+c)&&""!==t["range"+c]?(d=e._getQueryParameter(t,r,c,"range"+c,i),d+="!".concat(t.startrange,":").concat(t.endrange)):d=t.hasOwnProperty("table"+c)&&""!==t["table"+c]?e._getQueryParameter(t,r,c,"table"+c,i):e._getQueryParameter(t,r,c,c,i):d=e._getQueryParameter(t,r,c,c,i),s.push(d)}return[o[0],s.join("&")].join("?")}catch(e){throw Be.L}},e._getQueryParameter=function(e,t,n,a,i,r){return void 0===r&&(r=!1),a!==Xe.e.WORD_START_PAGE&&a!==Xe.e.PPT_START_PAGE||(a=Xe.e.COMMON_START_PAGE),a===n?r?t.indexOf(n)>=0?n+"="+encodeURIComponent((!e[a]).toString()):n+"="+encodeURIComponent(i[n]):t.indexOf(n)>=0?n+"="+encodeURIComponent(e[a]):n+"="+encodeURIComponent(i[n]):r?t.indexOf(a)>=0?n+"="+encodeURIComponent((!e[a]).toString()):n+"="+encodeURIComponent(i[n]):t.indexOf(a)>=0?n+"="+encodeURIComponent(e[a]):n+"="+encodeURIComponent(i[n])},e._getQueryParamValue=function(e,t){return new s.UrlQueryParameterCollection(e).getValue(t)||""},e}();function $e(e,t){var n=!!new h.SPResourcePath(e.serverRelativeUrl).authority,a=n;if(!a){var i=s.Guid.tryParse(e.siteId);a=!!i&&!i.equals(t.site.id)}if(!a){var r=s.Guid.tryParse(e.webId);a=!!r&&!r.equals(t.web.id)}e.isCrossDomain=n,e.isCrossWeb=a}var et=n("7Awa"),tt=n("Uejs"),nt=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._handleThemeChangedEvent=function(e){n._emphasisTheme=e.theme,n.render()},n._closeCoachMark=function(){n._isCoachmarkActive=!1,n.context.serviceScope.consume(m.CoachmarkUtility.serviceKey).dismiss(t._dragAndDropCoachmarkLocalStorage)},n._acknowledgeCoachmarkAndLog=function(){n._closeCoachMark(),r._EngagementLogger.logEventWithLogEntry(new o._LogEntry("DocumentWebPart","DragAndDropCoachMarkAcknowledged",o._LogType.Event))},n._dismissCoachmarkAndLog=function(){n._closeCoachMark(),r._EngagementLogger.logEventWithLogEntry(new o._LogEntry("DocumentWebPart","DragAndDropCoachMarkDismissed",o._LogType.Event))},n._shouldAddCoachmark=function(){return n.displayMode===s.DisplayMode.Edit&&!n.renderedFromPersistedData},n._addCoachMarkForDragAndDrop=function(){n._isCoachmarkActive=!0,n.context.serviceScope.consume(m.CoachmarkUtility.serviceKey).attachCoachmark({positioningContainerProps:{directionalHint:g.DirectionalHint.leftTopEdge,directionalHintForRTL:g.DirectionalHint.rightTopEdge},localStorageKey:t._dragAndDropCoachmarkLocalStorage,featureGroupKey:"DocumentEmbedDragAndDropCoachmark",target:n.domElement,content:Be.o,onBeforeDismiss:n._dismissCoachmarkAndLog,teachingBubbleProps:{headline:Be.c,hasCondensedHeadline:!0,primaryButtonProps:{text:Be.s,onClick:n._acknowledgeCoachmarkAndLog}}})},n._setFileFromInit=function(){var e=n.properties.externalFile;if(e){n._isUploadedFromLocalFiles=!0;var t={file:e,src:e.name};n._setFileProperties({selectedItems:[],localFilesPickedToUpload:[t]})}},n}return Object(i.__extends)(t,e),t._logSelectedAppType=function(e,t){var n,a,i=Object(R.e)(e);if(i===F.e.Other)r._EngagementLogger.logEvent("DocumentEmbedWP.NonOfficeAdd.Click");else if(i===F.e.Video)if(Object(j.o)())r._EngagementLogger.logEvent("DocumentEmbedWP.TeamVideoAdd.Click");else{var s=new o._LogEntry("DocumentEmbedWP.TeamVideoAdd.Click","",o._LogType.Event,{displayLanguage:null===(n=null==t?void 0:t.web)||void 0===n?void 0:n.languageName,userCulture:null===(a=null==t?void 0:t.cultureInfo)||void 0===a?void 0:a.currentUICultureName});r._EngagementLogger.logEventWithLogEntry(s)}},t._isDynamicValueAFolder=function(e){var t,n;return!(0!==(null===(n=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.ContentTypeId)||void 0===n?void 0:n.indexOf("0x0120")))},Object.defineProperty(t.prototype,"previewImageUrl",{get:function(){return Object(b.webPartPreviewThumbnail)({pageContext:this.context.pageContext,url:this.properties.serverRelativeUrl,siteId:this.properties.siteId,webId:this.properties.webId,listId:this.properties.listId,uniqueId:this.properties.uniqueId})},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,t=this,n=!!this.properties.requestedDynamicProperty;if(n){this._lookupSourceFromDynamicData();var a=this.properties.requestedDynamicProperty.tryGetSource();a&&(e=a.metadata.title)}var i=!this._isDocumentSelected&&(this.displayMode===s.DisplayMode.Edit&&!this._uploadProgressMessage||n),c=i&&this.renderedOnce,d=this.context.pageContext.web.absoluteUrl,l=!Object(j.g)()&&Ze.isVideo(this.properties.serverRelativeUrl);if(!Object(j.v)()&&l){var m=s._BrowserUtilities.isTeamsHosted()?"Teams":"SharePoint",_=new o._LogEntry("FileViewer Webpart","VideoUsage",o._LogType.Event,{displayApp:m});r._EngagementLogger.logEventWithLogEntry(_)}var h=u.createElement(We,Object(p.merge)({absoluteUrl:Object(H.e)(this.properties,d),annotation:this.properties.annotation,authorName:this.properties.authorName,authorPhotoUrl:this.properties.photoUrl,canOpenPopupOnRender:this.canOpenPopupOnRender,disableUpload:!this._uploadToSiteAssets&&!this._defaultDocLibName,edit:this.displayMode===s.DisplayMode.Edit,dynamicSourceName:n?e:void 0,isDocumentSelected:this._isDocumentSelected,isUploadedFromLocalFiles:this._isUploadedFromLocalFiles,modifiedAt:this.properties.modifiedAt,onSelect:this._setFileProperties,renderCompleted:this.renderCompleted.bind(this),renderedFromPersistedData:this.renderedFromPersistedData,serverRelativeUrl:this.properties.serverRelativeUrl,serviceScope:this.context.serviceScope,shouldGetPrefetchedRecentsData:c,showPlaceHolder:i,statusRender:this.context.statusRenderer,statusRenderElement:this.domElement,title:this.properties.title,uploadProgressMessage:this._uploadProgressMessage,webAbsoluteUrl:d,width:this.width,wopiurl:this.properties.wopiurl,emphasisTheme:this._emphasisTheme,onChangeCaptionText:function(e){return t.properties.annotation=e},getAuthToken:this._getToken.bind(this),isVideo:l,videoDuration:this.properties.videoDuration},this.properties));if(this._component=f.render(h,this.domElement),this._shouldAddCoachmark()&&this._addCoachMarkForDragAndDrop(),(this._isDocumentSelected||this.displayMode===s.DisplayMode.Edit)&&this._isDocumentSelected){var b=Ze.getIframeUrl(this.properties,this.context.pageContext);this._component.setDocumentIFrameSrc(b)}},Object.defineProperty(t.prototype,"title",{get:function(){return Object(Ge.e)()||1===s._SPExperiment.getVariantAndLogExposure(90027)&&_.spConstants.isPreviewableExtensionsEnabled()?tt.t:2===s._SPExperiment.getVariantAndLogExposure(90027)&&_.spConstants.isPreviewableExtensionsEnabled()?tt.n:tt.e},enumerable:!1,configurable:!0}),t.prototype.onInit=function(){var t=this;this._events=new l.EventGroup(this),this._updatedProperties={},this._setFileProperties=this._setFileProperties.bind(this),this._isCoachmarkActive=!1,this._isUploadedFromLocalFiles=!1,this._renderError=this._renderError.bind(this),this._uploadToSiteAssets=s._SPFlight.isEnabled(60040),this._initializeAadTokenConfiguration(),this._getEmphasisTheme();var n=this.properties;return b.EditModeUtilitiesLoader.GetUtilities().then(function(a){var i=a.DocLibraryContext,r=a.SPFileHandler;return t._docLibContextDataProvider=new i(t.context.serviceScope),Object(j.i)()&&!n.wopiurl?t._uploadToSiteAssets?(t._spFileHandler=new r({serviceScope:t.context.serviceScope,qosPrefix:"DocEmbedWp"}),t._setFileFromInit(),e.prototype.onInit.call(t)):t._docLibContextDataProvider.siteContext.then(function(n){return t._defaultDocLibName=n.libraryName,t._libraryServerRelativeUrl=l.Uri.concatenate(t.context.pageContext.web.serverRelativeUrl,t._defaultDocLibName),t._spFileHandler=new r({serviceScope:t.context.serviceScope,qosPrefix:"DocEmbedWp",containerUrl:t._libraryServerRelativeUrl}),t._setFileFromInit(),e.prototype.onInit.call(t)}).catch(function(n){return e.prototype.onInit.call(t)}):!n.webAbsoluteUrl&&n.serverRelativeUrl?t._fetchDocumentMetadata(!1).then(function(){return e.prototype.onInit.call(t)}):Object(j.i)()?e.prototype.onInit.call(t):t._uploadToSiteAssets?(t._spFileHandler=new r({serviceScope:t.context.serviceScope,qosPrefix:"DocEmbedWp"}),t._setFileFromInit(),e.prototype.onInit.call(t)):t._docLibContextDataProvider.siteContext.then(function(n){return t._defaultDocLibName=n.libraryName,t._libraryServerRelativeUrl=l.Uri.concatenate(t.context.pageContext.web.serverRelativeUrl,t._defaultDocLibName),t._spFileHandler=new r({serviceScope:t.context.serviceScope,qosPrefix:"DocEmbedWp",containerUrl:t._libraryServerRelativeUrl}),t._setFileFromInit(),e.prototype.onInit.call(t)}).catch(function(n){return e.prototype.onInit.call(t)})})},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{annotation:{isSearchablePlainText:!0},title:{isSearchablePlainText:!0},serverRelativeUrl:{isLink:!0},wopiurl:{isLink:!0}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return this._isDocumentSelected},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataVersion",{get:function(){return s.Version.parse("1.4")},enumerable:!1,configurable:!0}),t.prototype.onAfterDeserialize=function(e,n){if(n.lessThan(s.Version.tryParse("1.1"))){var a=1;void 0!==e[Xe.e.PPT_START_PAGE]&&(a=N(e[Xe.e.PPT_START_PAGE]),delete e.wdslideindex);var i=1;void 0!==e[Xe.e.WORD_START_PAGE]&&(i=N(e[Xe.e.WORD_START_PAGE]),delete e.wdstarton),e.startPage=Math.max(a,i),e.modifiedBy&&(e.modifiedAt=e.modifiedBy,delete e.modifiedBy)}if(n.lessThan(s.Version.tryParse("1.3"))){if(e.dynamicSource&&(e.requestedDynamicProperty=e.dynamicSource,delete e.dynamicSource),!Object(j.a)()&&!e.title&&e.file){var r="",c=/^.*\/(.*)\.\w+$/.exec(e.file);c&&c[1]&&(r=c[1]),e.title=r}if(!Object(j.a)()&&!e.serverRelativePath&&!e.serverRelativeUrl)try{e.serverRelativeUrl=new URL(e.file).pathname}catch(e){o._TraceLogger.logError(t._logSource,e)}}if($e(e,this.context.pageContext),!e.webAbsoluteUrl){var d=s.Guid.tryParse(e.siteId),l=s.Guid.tryParse(e.webId),u=new h.SPResourcePath(e.serverRelativeUrl).authority,f=this.context.pageContext;!u&&d&&l&&d.equals(f.site.id)&&l.equals(f.web.id)&&(e.webAbsoluteUrl=f.web.absoluteUrl)}return e},t.prototype.onBeforeSerialize=function(){this.properties.startPage=N(this.properties.startPage),delete this.properties.isCrossDomain,delete this.properties.isCrossWeb,this.properties.serverRelativePath&&this.properties.serverRelativeUrl&&delete this.properties.serverRelativePath},t.prototype.onPropertyPaneFieldChanged=function(t,n,a){var i=a;t===Xe.e.COMMON_START_PAGE&&i?this.properties.startPage=N(i):e.prototype.onPropertyPaneFieldChanged.call(this,t,n,a)},t.prototype.onDispose=function(){this._isCoachmarkActive&&this._closeCoachMark(),this._documentEmbedDataProvider&&(this._documentEmbedDataProvider=void 0),this._events&&this._events.dispose&&this._events.dispose(),this.context.serviceScope.consume(et.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),f.unmountComponentAtNode(this.domElement),this._component=void 0,e.prototype.onDispose.call(this)},t.prototype.loadPropertyPaneResources=function(){var e=this;return n.e(0).then(n.bind(null,"pbcy")).then(function(t){e._propertyPaneSettings=new t.PropertyPaneSettings})},t.prototype.getPropertyPaneConfiguration=function(){return this._propertyPaneSettings.getPropertyPaneSettings(this.properties,this._component.handleFilePickerClick,this._handleDynamicConnectionRemoved.bind(this))},t.prototype.onAfterResize=function(e){this._component&&this._component.setContainerWidth(e)},Object.defineProperty(t.prototype,"disableReactivePropertyChanges",{get:function(){return!this.properties.requestedDynamicProperty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){var e=this.properties.annotation||this.properties.title||this.properties.file;return e?l.StringHelper.format(Be.e,e):void 0},enumerable:!1,configurable:!0}),t.prototype._getEmphasisTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(et.ThemeProvider.serviceKey);e._emphasisTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},Object.defineProperty(t.prototype,"_isDocumentSelected",{get:function(){return!!this.properties.wopiurl||!!this.properties.serverRelativeUrl},enumerable:!1,configurable:!0}),t.prototype._clearDocumentSelection=function(){this.properties.wopiurl=this.properties.serverRelativeUrl=void 0},t.prototype._handleDynamicConnectionRemoved=function(){this.properties.requestedDynamicProperty=void 0,this._clearDocumentSelection(),this.render()},t.prototype._updateProperties=function(e){var t=!1;for(var n in e)if(e.hasOwnProperty(n)){var a=n;t=t||this._updatedProperties[a]!==e[a],this.properties[a]=this._updatedProperties[a]=e[a]}t&&(this.render(),(s._SPKillSwitch.isActivated(s.Guid.parse("4fdae1b1-935d-4a4e-8577-e5f8528beea1"),"1/23/2019","SOX_DocumentEmbedWebPartOnlyRefreshPropertyPaneIfOpen")||this.context.propertyPane.isPropertyPaneOpen())&&this.context.propertyPane.refresh())},t.prototype._loadDocumentDataProvider=function(){var e=this,t=this._documentEmbedDataProvider;return t||(t=n.e(0).then(n.bind(null,"eEG9")).then(function(t){return new t.default(e.context.serviceScope)}),this._documentEmbedDataProvider=t),t},t.prototype._fetchDocumentMetadata=function(e){var n=this;void 0===e&&(e=!1);var a=new r._QosMonitor("LoadDocument"),i=this.context.pageContext.web.absoluteUrl,o=[];return!Object(j.g)()&&Ze.isVideo(this.properties.serverRelativeUrl)&&(o=["video"]),this._loadDocumentDataProvider().then(function(t){return t.getFileMetadata(a,n.properties,i,e,o)}).then(function(e){var i;$e(e,n.context.pageContext),a.writeSuccess(),n._updateProperties(e),n._component.focusOnCaptionElement(),Object(j.o)()?t._logSelectedAppType(e.serverRelativeUrl):t._logSelectedAppType(e.serverRelativeUrl,null===(i=n.context)||void 0===i?void 0:i.pageContext)}).catch(function(e){"string"==typeof e?(e=new Error(e),a.writeUnexpectedFailure("FailedtoLoadDocument",e)):e.recorded||a.writeUnexpectedFailure("LoadDocumentCatchAll",e),n._handleDocumentSelectionError(e,e.resetSelection)})},t.prototype._handleDocumentSelectionError=function(e,t){void 0===t&&(t=!1),t&&this._clearDocumentSelection(),this.renderError(e)},t.prototype._setFileProperties=function(e){var t,n,a,i;if(e&&e.localFilesPickedToUpload&&e.localFilesPickedToUpload.length>0&&e.localFilesPickedToUpload[0]&&e.localFilesPickedToUpload[0].file){var c=e.localFilesPickedToUpload[0].file;this._startUpload(c)}else if(e&&e.selectedItems&&e.selectedItems.length&&e.selectedItems[0]&&e.selectedItems[0].Link){var d=e.selectedItems[0],u=d.ServerAbsoluteUrl;this.properties.listId=d.ListId,this.properties.siteId=d.SiteId,this.properties.uniqueId=d.UniqueId,this.properties.webId=d.WebId,Object(j.d)()||(d.Link&&this._needRedeem(d.Link)?this.properties.link=d.Link:this.properties.link=void 0);var f=new h.SPResourcePath(u),p=!f.domain||f.domain===window.location.host;this.properties.serverRelativePath=p?f.path:u;var m,b=-1!==f.path.toLowerCase().indexOf(_.spConstants.wacPath);if(Object(j.t)()||(this.properties.wopiurl=this.properties.serverRelativePath,this.properties.serverRelativeUrl=this.properties.serverRelativePath),b){Object(j.t)()&&(this.properties.wopiurl=this.properties.serverRelativePath,this.properties.serverRelativeUrl=this.properties.serverRelativePath);var g=new l.Uri(u);this.properties.file=g.getQueryParameter("file")||f.path}else this.properties.file=u;m=Object(j.o)()?new o._LogEntry("DocumentWebPart","DocumentSelection",o._LogType.Event,{fileType:F.e[Object(R.e)(this.properties.file)]}):new o._LogEntry("DocumentWebPart","DocumentSelection",o._LogType.Event,{fileType:F.e[Object(R.e)(this.properties.file)],pageLanguage:null===(n=null===(t=this.context.pageContext)||void 0===t?void 0:t.web)||void 0===n?void 0:n.languageName,userCulture:null===(i=null===(a=this.context.pageContext)||void 0===a?void 0:a.cultureInfo)||void 0===i?void 0:i.currentUICultureName}),r._EngagementLogger.logEventWithLogEntry(m),this._fetchDocumentMetadata(!0),s._SPKillSwitch.isActivated("ceb208d8-093e-46d6-ac13-a029f93b3221")||this._resetStartPage()}else this._component.onDocumentSelectionCancelled()},t.prototype._renderError=function(e){this.renderError(e||new Error(Be.S))},t.prototype._resetStartPage=function(){this.properties.startPage=1},t.prototype._startUpload=function(e){var n=this;if(e){if(!this._uploadToSiteAssets&&!this._libraryServerRelativeUrl)return void this._renderError();var a=new r._QosMonitor("DocumentWebPartUpload");b.EditModeUtilitiesLoader.GetUtilities().then(function(i){var c=i.SPFileHandler;if(!c.validateFileType(e,_.spConstants.documentExtensions)){var d=_.spConstants.documentExtensions.join(Be.y);return Object(j.l)()?n._renderError(new Error(l.StringHelper.format(Be.C,d))):(n.context&&n.context.statusRenderer&&(n.context.statusRenderer.clearLoadingIndicator(n.domElement),n.context.statusRenderer.renderError(n.domElement,new Error(l.StringHelper.format(Be.C,d)))),o._TraceLogger.logError(t._logSource,new Error(l.StringHelper.format(Be.C,d)))),void a.writeExpectedFailure("InvalidFileType")}n._uploadProgressMessage=Be.Q,n.render();var u=Math.floor(1e5*Math.random()).toString(),f=e.name?e.name.split(".").pop():"",p=n._spFileHandler.removeExtension(e.name),m=s._SPKillSwitch.isActivated("9dada52d-6913-4d2a-8da2-c92a4e4cda0f")?"".concat(c.replaceSpecialCharacters(p),"_").concat(u,".").concat(f):"".concat(c.replaceSpecialCharacters(p),".").concat(f);if(!n._uploadToSiteAssets){var h=l.Uri.concatenate(n._libraryServerRelativeUrl,m);n.properties.serverRelativeUrl=h}window.addEventListener("beforeunload",n._promptUploadingWarning);var b=new o._LogEntry("DocumentWebPart","DocumentUpload",o._LogType.Event,{fileType:F.e[Object(R.e)(e.name)]});r._EngagementLogger.logEventWithLogEntry(b),n._spFileHandler.uploadLocalFile(e,m).then(function(e){n._onUploadComplete(e),a.writeSuccess()},function(t){if(s._SPKillSwitch.isActivated("eaa7638c-14b7-4339-a879-1036a9c337de")||n._uploadToSiteAssets)throw t;var i=l.Uri.concatenate(n._libraryServerRelativeUrl,m);n.properties.serverRelativeUrl=i,m="".concat(c.replaceSpecialCharacters(p),"_").concat(u,".").concat(f),n._spFileHandler.uploadLocalFile(e,m).then(function(e){n._onUploadComplete(e),a.writeSuccess()}).catch(function(e){throw e})}).catch(function(e){a.writeUnexpectedFailure("FailedToUploadFile",e),n._onUploadError(e)})}).catch(function(e){throw a.writeUnexpectedFailure("EditModeUtilitiesLoaderError",e),e})}},t.prototype._onUploadComplete=function(e){window.removeEventListener("beforeunload",this._promptUploadingWarning),this._uploadProgressMessage=void 0,this.clearError(),this._setFileProperties({selectedItems:[{Link:e.serverRelativeUrl,UniqueId:e.uniqueId,ListId:e.listId,SiteId:this.context.pageContext.site&&this.context.pageContext.site.id&&this.context.pageContext.site.id.toString(),WebId:this.context.pageContext.web&&this.context.pageContext.web.id&&this.context.pageContext.web.id.toString(),ServerAbsoluteUrl:e.serverRelativeUrl}]})},t.prototype._onUploadError=function(e){throw window.removeEventListener("beforeunload",this._promptUploadingWarning),this._uploadProgressMessage=void 0,this._renderError(e),new Error("".concat(e.message))},t.prototype._promptUploadingWarning=function(e){var t=Be.q;return e.returnValue=t,t},t.prototype._lookupSourceFromDynamicData=function(){var e=this.properties,n=e.requestedDynamicProperty.tryGetValues(),a=n&&n[0]&&n[0].FileRef;if(a&&!t._isDynamicValueAFolder(n)){var i=a;if(e.serverRelativePath!==i){e.serverRelativePath=i,e.serverRelativeUrl=e.uniqueId=void 0;var r=n[0].ServerRedirectedEmbedUrl;e.wopiurl=r||void 0,this._fetchDocumentMetadata()}}else this._isDocumentSelected&&(e.serverRelativeUrl=e.serverRelativePath=e.wopiurl=void 0,s._SPKillSwitch.isActivated(s.Guid.parse("59d46f6c-9039-48d8-9543-a1f306de4a92"),"1/23/2019","SOX_DocumentEmbedWebPartClearUniqueIdOnDynamicDataChange")||(e.uniqueId=void 0))},t.prototype._initializeAadTokenConfiguration=function(){var e=this.context.pageContext.legacyPageContext,t=e.aadInstanceUrl,n=e.aadSessionId,a=e.aadTenantId,i=e.aadUserId,r=e.userPrincipalName;this._aadTokenConfiguration={aadInstanceUrl:t,aadSessionId:n,aadTenantId:a,aadUserId:i,redirectUri:window.location.origin+"/_forms/"+c._AadConstants.SPFX_SINGLE_SIGN_ON_REPLY_URL,servicePrincipalId:c._AadConstants.PRE_AUTHORIZED_APP_PRINCIPAL_ID,userPrincipalName:r}},t.prototype._getToken=function(e){var n=this,a=e||this.properties.webAbsoluteUrl&&new URL(this.properties.webAbsoluteUrl).origin;return a?this.context.aadTokenProviderFactory.getTokenProvider().then(function(e){return e._getTokenInternal(a,n._aadTokenConfiguration)}).catch(function(e){throw o._TraceLogger.logError(t._logSource,e),e}):Promise.reject(new Error("Failed to get spo-token: empty resource endpoint"))},t.prototype._needRedeem=function(e){var t=new l.Uri(e),n=t.getAuthority(),a=t.getPathSegments(),i=t.getQueryParameter("share");return!Object(p.isEmpty)(n)&&a.length>=4&&(/:[A-z]:/.test(a[0])&&/[A-z]/.test(a[1])||!Object(p.isEmpty)(i))},t._dragAndDropCoachmarkLocalStorage="DismissedFileDragAndDropCoachmark",t._logSource=o._LogSource.create("DocumentEmbedWebPart"),t}(d.BaseClientSideWebPart);t.default=nt},ut3N:function(e,t){e.exports=y},vNcA:function(e,t,n){var a=n("fglE");e.exports=a._Utilities},vlQI:function(e,t){e.exports=S},y88i:function(e,t){e.exports=D}})});