(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[270],{1343:function(e,t,n){"use strict";n.r(t);var r=n(2205),o=n(2185),a=n(30),i=n(159),c=n(1261),u=n(2022),s=n(1459),l=n(146),d=n(767),f=n(3),p=n(132),g=n(1820),b=n(121),v=n(1656),m=n(744),h=n(724),C=n(774),j=n(426),O=n(149),y=n(1610),S=n(1533),k=n(739),w=n(424),x=n(1436),I=n(1640),P=n(1654),A=n(19),E=n.n(A),T=n(45),L=n(46),D=n(67),N=n(72),R=n(44),U=n(1799),V=n(1479),_=n(854),M=n(1409),K=n(2909),F=n(2074),z=n(205),B=n(2),W=(Object(B.declareStringWithPlaceholders)("lpc-core.inferredContact.newInformationBlock.message")),H=(Object(B.declareString)("lpc-core.inferredContact.newInformationBlock.link")),q=n(14),Z=n(120),Q=n(423),J=Object(Z.c)((function(e){return Object(q.db)({messageBarContainer:{padding:"".concat(Q.h,"px ").concat(Q.i,"px ").concat(Q.f,"px ").concat(Q.i,"px")},root:{border:"1px solid ".concat(e.palette.neutralLighter),borderRadius:"2px",selectors:{"& .ms-Link":{paddingLeft:"0px"}}},iconContainer:{marginTop:"14px",marginLeft:"".concat(Q.i,"px"),fontSize:"13px"},text:{margin:"".concat(Q.i,"px ").concat(Q.h,"px ").concat(Q.i,"px 6px")}})}));function G(e){var t=function(){if("undefined"==typeof Reflect||!E.a)return!1;if(E.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(E()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(R.a)(e);if(t){var o=Object(R.a)(this).constructor;n=E()(r,arguments,o)}else n=r.apply(this,arguments);return Object(N.a)(this,n)}}var Y=function(e){Object(D.a)(n,e);var t=G(n);function n(){return Object(T.a)(this,n),t.apply(this,arguments)}return Object(L.a)(n,[{key:"render",value:function(){var e=this.props,t=e.person,n=e.onShowDetailsClicked,r=J(this.props.theme),o=t&&(t.displayName||t.email&&t.email.Address);if(!o)return null;var a=f.createElement(M.a,{onClick:n,href:"#"},H());return f.createElement("div",{className:r.messageBarContainer},f.createElement(K.a,{messageBarType:F.a.info,isMultiline:!0,styles:r},f.createElement(U.a,{text:W,placeholders:{name:o,newInfo:a}})))}}]),n}(z.a);var $=Object(V.a)(Y,(function(e){return{componentName:"InferredContactCard",identifier:e.person.lpcKey.key,logProperties:{propertyNames:e.properties}}})),X=Object(_.a)($),ee=n(1620),te=(n(9),n(482)),ne=n(125),re=n(268),oe=n(258),ae=(n(92),n(726),n(721),n(364));n(153),n(551);var ie=n(1992),ce=n(1854),ue=(B.declareString("lpc-core.LivPersonaCardStrings.userInfoBlockStrings.emptyContactMessage")),se=n(458),le=Object(se.a)((function(e){return{noContactInfoStyles:{color:e.palette.neutralSecondary,padding:"0 ".concat(Q.l,"px"),fontSize:e.fonts.small.fontSize},tagsStyles:{padding:"".concat(e.spacing.s2," 0")}}})),de=Object(i.a)((function(e,t,n){return function(){!function(e,t){var n=t.applicationContext,r=t.renderingContext,o=Object(oe.b)(n);n.settings.isImmersiveProfileEnabled&&!!o&&o?(Object(ne.k)(e,t),n.dispatch(Object(re.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:r.windowId,navigationStartCheckpoint:Object(te.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Contact")):n.dispatch(Object(re.d)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger})}})),fe=Object(i.a)((function(e,t,n){return function(){!function(e,t){var n=t.applicationContext,r=t.renderingContext,o=Object(oe.b)(n);n.settings.isImmersiveProfileEnabled&&!!o&&o?(Object(ne.k)(e,t),n.dispatch(Object(re.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:r.windowId,navigationStartCheckpoint:Object(te.a)(),shouldResetHistory:!1,personaCorrelationId:n.getPersonaCorrelationId(e.lpcKey)})),o.renderExpandedView(n,"Contact")):n.dispatch(Object(re.b)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!1}))}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger})}})),pe=Object(i.a)((function(e,t,n){return function(){!function(e,t){var n=Object(oe.b)(t.applicationContext);Object(ne.k)(e,t),t.applicationContext.dispatch(Object(re.e)({personaLpcKey:e.lpcKey,isExpandedViewEnabled:!0,section:"Contact",windowId:t.renderingContext.windowId,navigationStartCheckpoint:Object(te.a)(),shouldResetHistory:!1,personaCorrelationId:t.applicationContext.getPersonaCorrelationId(e.lpcKey)})),n&&n.renderExpandedView(t.applicationContext,"Contact"),Object(ae.b)(t.applicationContext.dispatch)}(e,{applicationContext:t,renderingContext:n,cardCorrelationId:t.cardCorrelationId||"",logger:t.logger}),Object(P.b)(e,t)}}));var ge=Object(p.c)((function(e){var t=Object(b.c)(e,"Card"),n=!!Object(b.l)(e,t),r=!!(t?Object(b.g)(e,t.lpcKey):void 0),o=O.a.getSelectors(e).settings.isPSTNWorkaroundActive,i=O.a.getSelectors(e).settings.isRichAvailabilityInfoEnabled,c=i&&Object(a.p)(t)?C.a.getSelectors(e).getTimeZoneOffset(t.lpcKey):void 0,u=t&&m.a.getSelectors(e).getContactTags(t.lpcKey.key)||[],s=O.a.getSelectors(e).settings.isNextAvailabilityEnabled,l=s&&Object(a.p)(t)?C.a.getSelectors(e).getNextAvailability(t.lpcKey):void 0,d=Object(a.p)(t)?j.a.getSelectors(e).getPersonaPresence(t.lpcKey):void 0,f=Object(a.p)(t)?Object(v.a)(e,t.lpcKey):void 0;return{isMePage:n,currentPersona:t,hasInferredContactData:r,isPSTNWorkaroundActive:o,isNextAvailabilityEnabled:s,isRichAvailabilityInfoEnabled:i,timeZoneOffset:c,canUpdateProfileVideo:Object(a.p)(t)&&n&&Boolean(!h.a.getSelectors(e).getProfileVideoPlaybackUrl(t.lpcKey)),nextAvailability:l,richPresence:d,oof:f,tags:u}}))(Object(x.a)((function(e){var t,n,i,p,b,v,m=e.person,h=[],C=e.tags,j=Object(d.a)(),O=le(j);if(Object(a.p)(m)){var x=Object(a.g)(m,e.isPSTNWorkaroundActive);n={contactType:"phone",content:Object(a.l)(x).map((function(e){return{displayString:e.PhoneNumber,hrefLink:e.PhoneUrl,fieldType:e.Type}})).slice(0,2)},i=(p=Object(ie.c)(m)).address?{contactType:"location",content:Object(ie.a)([p.address],[p.address])}:void 0;var P=[m.email?m.email.Address:""].concat(m.extraEmails.map((function(e){return e.Address}))).filter((function(e){return!Object(l.e)(e)})).slice(0,2);t={contactType:"email",content:Object(ie.a)(P,P).slice(0,2)};b=e.lpcAppContext.settings.isProfileVideoEnabled&&e.canUpdateProfileVideo?{contactType:"updateprofilevideo",content:Object(ie.a)([Object(ee.j)()],["updateprofilevideo"])}:void 0,v=m.isExplicitContact}if(Object(s.a)({componentName:"ContactBlock",identifier:m.lpcKey.key,logProperties:{emailCount:t?t.content.length.toString():"0",phoneCount:n?n.content.length.toString():"0",hasLocation:Boolean(p),locationType:p?Boolean(p.address)&&p.locationType:"",isInferredContactsEnabled:e.lpcAppContext.settings.isInferredContactsEnabled,isExplicitContact:v,hasInferredContactData:e.hasInferredContactData,isContactMergeSuggestionsEnabled:Object(k.b)(e.lpcAppContext),isContactCategoriesEnabled:Object(y.a)(e.lpcAppContext),contactCategoriesCount:C?C.length.toString():"0",isMe:e.isMePage,isTimeZoneEnabled:e.isRichAvailabilityInfoEnabled,hasTimeZoneData:void 0!==e.timeZoneOffset,isNextAvailabilityEnabled:e.isNextAvailabilityEnabled,hasNextAvailabilityData:Boolean(e.nextAvailability&&e.richPresence)}}),Object(y.a)(e.lpcAppContext)&&(null==C?void 0:C.length)){var A=C,E={contactId:m.contactId,olsPersonaId:m.olsPersonaId,aadObjectId:m.aadObjectId,userPrincipalName:m.upn},T=f.createElement(u.a,{logger:e.lpcAppContext.logger,featureName:"ContactCategories",eventFieldMap:I.b},f.createElement("div",{className:O.tagsStyles},f.createElement(r.a,{personaIdentifiers:E,showAll:!1,showDelete:function(){return!1},tags:A,onShowMoreClick:fe(m,e.lpcAppContext,e.renderingContext),onTagClick:function(t){Object(g.a)(e.lpcAppContext,t)}}))),L=f.createElement(o.a,{tagList:T});h=h.concat(L)}if(e.shouldShowInferredContact){var D=Object(S.c)(e.inferredContact);h=h.concat(f.createElement(X,{person:m,properties:D,onShowDetailsClicked:fe(m,e.lpcAppContext,e.renderingContext)}))}var N=[t,n,i,b].filter((function(e){return e}));0!==N.length||e.shouldShowInferredContact||(h=h.concat(function(e){var t=le(e);return f.createElement("div",{className:t.noContactInfoStyles},ue())}(j)));var R=[],U=Object(c.a)(e.richPresence);if(e.isNextAvailabilityEnabled&&void 0!==e.nextAvailability){var V=Object(ie.b)(e.nextAvailability,e.richPresence,e.oof,U,e.lpcAppContext.culture,e.isMePage,Object(w.d)(e.lpcAppContext));void 0!==V&&R.push({contactType:"nextavailability",content:[V]})}return void 0!==e.timeZoneOffset&&R.push({contactType:"timezone",content:[Object(ie.d)(e.timeZoneOffset,Object(w.b)(e.lpcAppContext),e.isMePage)]}),f.createElement(ce.a,{onTitleClick:de(m,e.lpcAppContext,e.renderingContext),onFooterClick:fe(m,e.lpcAppContext,e.renderingContext),onUpdateProfileVideoClick:pe(m,e.lpcAppContext,e.renderingContext),showLoading:!m,additionalChildren:h,additionalAvailabilityInfo:R,contacts:N,hideTitle:!1})})));t.default=ge},1436:function(e,t,n){"use strict";n.d(t,"b",(function(){return h}));var r=n(19),o=n.n(r),a=n(45),i=n(46),c=n(67),u=n(72),s=n(44),l=n(5),d=n.n(l),f=n(490),p=n(714),g=n(1391),b=n(3),v=n(148);function m(e){var t=function(){if("undefined"==typeof Reflect||!o.a)return!1;if(o.a.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(o()(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(s.a)(e);if(t){var a=Object(s.a)(this).constructor;n=o()(r,arguments,a)}else n=r.apply(this,arguments);return Object(u.a)(this,n)}}var h=function(e){var t;return(t=function(t){Object(c.a)(r,t);var n=m(r);function r(){return Object(a.a)(this,r),n.apply(this,arguments)}return Object(i.a)(r,[{key:"render",value:function(){var t=Object(p.b)(this).getSingleton(v.a),n=d()(d()({},this.props),{lpcAppContext:t});return b.createElement(e,d()({},n))}}]),r}(b.Component)).contextTypes=d()({},f.b),t};t.a=function(e){return Object(g.a)(h(e))}},1441:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(539),o=n(3),a=n(720);function i(){return Object(o.useContext)(a.a)||Object(r.throwError)("LPCAppContext not found.")}},1456:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return j})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return w}));var r=n(55),o=n.n(r),a=n(2),i=n(13),c=n(1300),u=n(64),s=(Object(a.declareString)("datetime-formatting.contactDetails.localTimeLabel")),l=(Object(a.declareString)("datetime-formatting.contactDetails.myTimeZoneLabel")),d=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.timeZoneBehind")),f=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.timeZoneAhead")),p=(Object(a.declareString)("datetime-formatting.contactDetails.sameTimeZone")),g=(Object(a.declareString)("datetime-formatting.contactDetails.separator")),b=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.freeFrom")),v=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.freeUntil")),m=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.oofUntil")),h=(Object(a.declareString)("datetime-formatting.contactDetails.freeToday")),C=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.dateAndTime")),j=(Object(a.declareStringWithPlaceholders)("datetime-formatting.contactDetails.presenceAndNextAvailability"));function O(e,t,n){var r=g();return n?e:"".concat(e," ").concat(r," ").concat(t)}function y(e,t){var n=new Date,r=Object(u.h)(n);if(r===e)return p();var o=r-e,a=Object(c.getShortDurationFromHoursDifferenceString)(n,o,t);return o>0?f({p0:a}):d({p0:a})}function S(e,t,n,r){void 0===r&&(r=!1);var a=Intl.DateTimeFormat(t,{day:"2-digit",month:"short"}).format(e);if(r)return a;var i=new Date(o()()),c=e.getDay()===i.getDay(),u=Intl.DateTimeFormat(t,{hour:"numeric",minute:"2-digit",hour12:!n}).format(e);return c?u:C({date:a,time:u})}function k(e,t,n,r,o){if((t!==n||"Unknown"!==n)&&void 0!==e){if(t===n&&"Free"===n)return h();var a,c=(a=new Date(e),new Date(a.getTime()-a.getTimezoneOffset()*i.w));if("Oof"===t)return w(c,r,o);var u=S(c,r,o);return"Free"===n?b({time:u}):v({time:u})}}function w(e,t,n){if(void 0!==e){var r=S(e,t,n,!0);return m({time:r})}}},1459:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),o=n(676),a=n(3),i=n(722),c=n(1521);function u(e){var t=Object(i.c)(),n=Object(i.d)(),u=e.identifier,s=e.logProperties,l=n+e.componentName,d=Object(a.useRef)(null),f=Object(a.useRef)(null),p=Object(a.useRef)(null),g=Object(a.useRef)(0);Object(a.useEffect)((function(){return null===d.current&&(d.current=c()),function(){f.current||(f.current=c());var e=d.current&&f.current?f.current-d.current:void 0,n=void 0!==e&&Math.round(e).toString()||"";if(t){var o=Object(r.__assign)({component:l,duration:n,renderCount:g.current.toString()},p.current);t(l,o)}d.current=null,p.current=null,f.current=null,g.current=0}}),[u,l]),Object(a.useEffect)((function(){Object(o.a)(s,p.current)||(g.current++,f.current=c(),p.current=s)}),[l,s])}},1473:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(9),o=n.n(r),a=n(5),i=n.n(a),c=n(38),u=n(1611);function s(){return o.a.resolve({state:"no_data"})}function l(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i()(i()({},t),{clientScenario:t.clientScenario,requestId:null!==(e=t.requestId)&&void 0!==e?e:Object(c.a)()})}function d(e,t){if(!e)return s;var n="function"==typeof e?e():o.a.resolve(e);return function(){return n.then((function(e){return t(e).then(u.a).catch(u.b)}))}}},1474:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(13),o=n(31),a=n(486),i=n(64);function c(e,t){return Object(o.format)(t.timeFormats.todayShort,e,new Date,t,void 0).trim()}function u(e,t,n){void 0===n&&(n=new Date);var r=Object(a.d)(n,e);return Object(o.format)(t.timeFormats.todayShort,r,n,t,void 0,e).trim()}function s(e,t,n,r,a){void 0===a&&(a=!1);var i=l(t,r,a?e:void 0),c=l(n,r,a?e:void 0);if(a)return"".concat(i," - ").concat(c);var u=Object(o.formatTimeZone)(r.timeFormats.timeZone,e);return"".concat(i," - ").concat(c," (").concat(u,")")}function l(e,t,n){var o=Object(i.b)(e);return c(n?Object(a.d)(o,n):new Date(o.getTime()+o.getTimezoneOffset()*r.w),t)}},1479:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n(3),a=n(1459);function i(e,t){return function(n){var i=t(n);return Object(a.a)(i),o.createElement(e,Object(r.__assign)({},n))}}},1480:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r={Accept:"application/json","Content-Type":"application/json"},o={convertPropertiesToPascalCase:!1,defaultResponseObject:!1}},1487:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return y})),n.d(t,"d",(function(){return S})),n.d(t,"c",(function(){return k})),n.d(t,"f",(function(){return w})),n.d(t,"g",(function(){return x})),n.d(t,"h",(function(){return I})),n.d(t,"e",(function(){return P}));var r=n(356),o=n(30),a=n(358),i=n(103),c=n(118),u=n(91),s=n(624),l=n(734),d=n(111),f=n(1550),p=n(488),g=n(9),b=n.n(g),v=n(705),m=n(38),h=n(92);function C(e){var t=e.scenarioName,n=e.lpcAppContext,r=e.logger,o=e.persona,a=e.operation,i=e.successAction,c=e.errorAction,u=Boolean(a);Object(v.a)({scenarioName:t,featureName:"HostAppCallbacks",requestId:Object(m.a)(),operation:function(){return u&&a?(a(o&&Object(h.a)(n.getState(),o,n.hostAppConfiguration.loggedInUserUpn)),b.a.resolve()):b.a.reject("HostApp does not implement the callback")},monitorStarter:r,successAction:function(e){n.dispatch(i())},errorAction:function(){n.dispatch(c({HostAppCallbackNotImplemented:!u}))},treatAsExpectedError:function(e){return!u}})}var j=n(500);function O(e){var t=e.person,n=e.lpcAppContext,r=e.sectionType,o=e.renderingContext,a=e.logger;Object(l.a)(r)?n.dispatch(Object(c.d)({personaLpcKey:t.lpcKey,sectionType:r})):n.dispatch(Object(u.u)()),j.a(t,n,o,a)}function y(e,t,n){t.dispatch(Object(c.c)({personaLpcKey:e,sectionType:n}))}function S(e){var t=e.personaLpcKey,n=e.lpcAppContext,r=e.sectionType,a=e.renderingContext,i=e.focusPropertyUri,s=e.logger,f=Object(d.b)(n.getState(),t);Object(o.p)(f)&&f.olsPersonaId?("PersonaBodies"===i?n.dispatch(Object(c.a)({personaLpcKey:t,contactId:f.olsPersonaId,sectionType:r})):Object(l.a)(r)?n.dispatch(Object(c.t)({personaLpcKey:t,contactId:f.olsPersonaId,sectionType:r})):n.dispatch(Object(u.v)()),j.d(f,f.olsPersonaId,n,a,s,i)):console.error("Cannot edit contact")}function k(e){var t=e.applicationContext,n=e.phoneType,o=e.contactNumber,a=e.annotation,i=e.persona,u=e.expandedViewSection,l=e.props,d=e.logger,f=t.hostAppConfiguration.actionCallbacks,p=f&&f.handleContactNumber,g=j.b(n);if(t.dispatch(u?Object(c.l)({phoneType:n,section:u,logger:d}):Object(c.q)({phoneType:n})),p&&a&&i)C({scenarioName:"ContactActionCreatorsHandleContactNumber",lpcAppContext:t,logger:d,persona:i,operation:p?function(e){return e&&p(o,a,g,e,l,d)}:void 0,successAction:s.d,errorAction:s.c});else{var b={openType:"CurrentTab",hrefLink:o};Object(r.a)(b,t)}}function w(e,t){var n=t.persona,r=t.props,o=t.expandedViewSection,i=t.shouldCloseExpandedView,u=void 0!==i&&i,s=t.applicationContext,l=t.logger;"Outlook_Android"===s.hostAppConfiguration.source||"Outlook_iOS"===s.hostAppConfiguration.source||"OutlookMobileAndroid"===s.hostAppConfiguration.source||s.hostAppConfiguration.source,s.dispatch(o?Object(c.i)({shouldCloseExpandedView:u,windowId:(null==r?void 0:r.windowId)||a.a,section:o,logger:l}):Object(c.p)({logger:l})),Object(p.g)(s,l)({persona:n,recipientId:e,properties:r})}function x(e,t,n,r,o,s){e.dispatch("Header"===n?Object(u.l)():"UserInfoView"===n?Object(c.r)({logger:r}):Object(c.m)({section:n})),Object(f.b)(t,e,r,o,(function(){e.dispatch(Object(i.j)({windowId:a.a,shouldCloseCard:Boolean(s)}))}))}function I(e,t){e.dispatch(Object(c.o)()),Object(r.a)(t,e)}function P(e,t){t.dispatch(Object(c.k)()),Object(r.a)(e,t)}},1505:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(4),o=Object(r.a)("CopyToClipboardSucceededAction",{featureName:"DOMEvent",getLogProperties:function(e){return{targetName:e.targetName}}}),a=Object(r.a)("CopyToClipboardFailedAction",{featureName:"DOMEvent",getLogProperties:function(e){return{targetName:e.targetName}}})},1521:function(e,t,n){(function(t){(function(){var n,r,o,a,i,c;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-i)/1e6},r=t.hrtime,a=(n=function(){var e;return 1e9*(e=r())[0]+e[1]})(),c=1e9*t.uptime(),i=a-c):Date.now?(e.exports=function(){return Date.now()-o},o=Date.now()):(e.exports=function(){return(new Date).getTime()-o},o=(new Date).getTime())}).call(this)}).call(this,n(1005))},1524:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(94),o=n.n(r),a=n(1569),i=n(146),c=n(260),u=n(45),s=n(46),l=function(){function e(){Object(u.a)(this,e)}return Object(s.a)(e,[{key:"load",value:function(e,t,n){if(this.isLoaded(e))t();else{var r=document.getElementsByTagName("head")[0],o=document.createElement("script");o.type="text/javascript",o.onload=function(){return t()},n&&n.forEach((function(e,t){o.setAttribute(t,e)})),o.src=e,r.appendChild(o)}}},{key:"isLoaded",value:function(e){for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++)if(t[n].src===e)return!0;return!1}}]),e}();function d(e){var t=new l,n=e.hostAppConfiguration.lokiUrl,r="PROD";e.settings.isSkypeWebControlIntEnvironmentEnabled?r="INT":n&&"df"===Object(a.a)(n)&&(r="DF");var i=(new o.a).set("data-environment",r).set("data-manualbootstrap","true");t.load("https://latest-swc.cdn.skype.com/sdk/v1/sdk.js",(function(){return e.dispatch(c.c())}),i)}function f(e){return"string"!=typeof e||Object(i.d)(e)}},1529:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"g",(function(){return f}));var r=n(5),o=n.n(r),a={unknown_error:1,not_found:1,server_error:1,unauthorized:1,rest_provider:1,missing_rest_provider:1,host_app_callback:1};function i(e){return function(t){return"no_data"===t.state?t:"success"===t.state?o()(o()({},t),{data:e(t.data)}):o()(o()({},t),{previousData:t.previousData&&e(t.previousData)})}}function c(e){if("no_data"!==e.state)return"success"===e.state?e.data:e.previousData}function u(e,t,n){switch(e){case"idle":case"loading":return{state:"not_asked",previousData:l(t)};case"error":return{state:"error",errorCode:s(n),previousData:l(t)};case"success":return t||d;default:return d}}function s(e){return"string"==typeof e&&a.hasOwnProperty(e)?e:"unknown_error"}function l(e){switch(null==e?void 0:e.state){case"not_asked":case"error":return e.previousData;case"no_data":return;case"success":return e.data;default:return}}var d={state:"no_data"};function f(e,t){return"not_found"!==t&&"unauthorized"!==t&&e<1}},1533:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"b",(function(){return C})),n.d(t,"d",(function(){return j})),n.d(t,"c",(function(){return O})),n.d(t,"e",(function(){return y}));var r=n(11),o=n.n(r),a=n(9),i=n.n(a),c=n(5),u=n.n(c),s=n(240),l=n(89),d=n(153),f=n(431),p=n(507),g=n(18),b=n(56),v=function(e,t,n,r){return new(n||(n=i.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},m="InferredContacts";function h(e,t){return e.settings.isInferredContactsEnabled&&!!t}var C=function(e){var t=e.inferredContact,n=e.person,r=e.sectionType,a=e.lpcAppContext,i=e.renderingContext,c=e.logger,u=O(t),s=j(n,t),l=[{propertyUri:"PersonaCompanyNames",value:t.Company||""},{propertyUri:"PersonaSurnames",value:t.Surname||""},{propertyUri:"PersonaGivenNames",value:t.GivenName||""},{propertyUri:"PersonaTitles",value:t.JobTitle||""},{propertyUri:"PersonaBusinessPhoneNumbers",value:t.TelephoneNumbers&&t.TelephoneNumbers[0]||""},{propertyUri:"PersonaBusinessPhoneNumbers2",value:t.TelephoneNumbers&&t.TelephoneNumbers[1]||""},{propertyUri:"PersonaTitles",value:t.JobTitle||""},{propertyUri:"PersonaEmails1",value:t.Emails&&t.Emails[0]||""},{propertyUri:"PersonaEmails2",value:t.Emails&&t.Emails[1]||""},{propertyUri:"PersonaEmails3",value:t.Emails&&t.Emails[2]||""}];t.Address&&t.Address.value&&(l=l.concat({propertyUri:"PersonaHomeAddresses",value:t.Address.value})),a.dispatch(Object(f.a)({sectionType:r}));var d={onSave:function(e){!function(e,t,n,r,a,i){v(this,void 0,void 0,o.a.mark((function c(){return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,y(e,t,r,a,i);case 2:i.logUserInteractionEvent({eventId:"PromoteInferredContactSaveButtonClickedAction",featureName:m,properties:{propertyNames:n}});case 3:case"end":return o.stop()}}),c)})))}(s,n||Object(b.a)(),u,a,i,c)},onCancel:function(){}};p.b(a,{folderId:"",createCallbacks:d,initialValues:l.filter((function(e){return""!==e.value}))})};function j(e,t){return e.email&&e.email.Address||t&&t.Emails&&t.Emails[0]||""}function O(e){if(void 0===e)return"";var t=[];return Object(s.keys)(e).forEach((function(n){void 0!==e[n]&&null!==e[n]&&t.push(n)})),t.join(",")}function y(e,t,n,r,a){return v(this,void 0,void 0,o.a.mark((function i(){return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(d.g)(e,n,r,a);case 2:return o.next=4,g.F.fetch(n,t.lpcKey,u()(u()({},Object(l.a)(t)),{locale:n.culture}));case 4:case"end":return o.stop()}}),i)})))}},1550:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p}));var r=n(356),o=n(16),a=n(92),i=n(341),c=n(260),u=n(191),s=n(1524);function l(e,t,n){if(Object(u.c)(e.hostAppConfiguration.tenantAadObjectId)){var r={ConversationId:t,CorrelationId:e.cardCorrelationId,ConversationType:"person",TrafficProvider:"lpc",TrafficSource:e.hostAppConfiguration.source},o=e.ownerWindow.SkypeWebControl;if(o){o.SDK&&o.SDK.Chat&&o.SDK.Chat.isInitialized?o.SDK.Chat.startChat(r):o.SDK&&o.SDK.start&&(e.ownerWindow.addEventListener("swc:ready",(function t(){o.SDK.Chat.startChat(r),e.ownerWindow.removeEventListener("swc:ready",t)})),o.SDK.start()),Object(i.c)(e,n)}}else Object(s.b)(e),e.dispatch(Object(c.e)())}function d(e,t,n,r,i){var c=t.settings.useMicrosoftTeamsFeatures;if(Object(u.c)(t.hostAppConfiguration.tenantAadObjectId))return r&&l(t,r,n),void(i&&i());var s=t.hostAppConfiguration.actionCallbacks,d=e.imAddresses.length&&e.imAddresses[0].ImAddressUrl&&0===e.imAddresses[0].ImAddressUrl.trim().indexOf("sip:"),p=e.imAddresses.length&&e.imAddresses[0].ImAddress||"",g=e.imAddresses.length&&e.imAddresses[0].ImAddressUrl||"",b=Object(o.m)(e)||"";(d&&p&&g||c)&&s&&s.startChat?function(e,t,n,r,o,i,c,u){var s=i.startMonitor("StartWorkloadChat","WorkloadChat"),l=Object(a.a)(t.getState(),e,t.hostAppConfiguration.loggedInUserUpn);c({persona:l,smtpAddress:n,imAddress:r,imAddressUrl:o},(function(n,r){n?(u&&u(),s.success(void 0)):(f(e,t),"Tenant opted out of skype chat"===r?s.expectedFailure(r):s.unexpectedFailure(r||"Unknown"))}))}(e,t,b,p,g,n,s.startChat,i):f(e,t)}function f(e,t){var n={openType:"CurrentTab",hrefLink:e.imAddresses.length&&e.imAddresses[0].ImAddressUrl||""};Object(r.a)(n,t)}function p(e,t,n){var r=Object(u.c)(e.hostAppConfiguration.tenantAadObjectId),o=t.imAddresses.length&&t.imAddresses[0].ImAddress||""||n,a=r&&Object(s.a)(o),i=!r&&!t.imAddresses.length;return a||i}},1569:function(e,t,n){"use strict";function r(e){return function(e){return(e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}(e).split(".")[0]}n.d(t,"a",(function(){return r}))},1592:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="contact/contactcategories"},1593:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(42),o=n.n(r),a=n(1480),i=n(1473),c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof o.a){var a=0;for(r=o()(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(i.a)(e,(function(e){return l(e,Object(i.b)(n),t)}))}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(i.a)(e,(function(e){return d(e,Object(i.b)(n),t)}))}function l(e,t,n){return e.request("getContacttags","GET","/api/v1/contactTags",void 0,a.a,n,t,(function(e){return e}),a.b)}function d(e,t,n){var r=n.contactV3UpdateRequest,o=c(n,["contactV3UpdateRequest"]);return e.request("patchPeoplegraphcontact","PATCH","/api/v1/peoplegraph/contact",r,a.a,o,t,(function(e){return e}),a.b)}},1601:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n(3),a=n(80),i=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isRendered:void 0===Object(a.a)()},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props.delay;this._timeoutId=window.setTimeout((function(){e.setState({isRendered:!0})}),t)},t.prototype.componentWillUnmount=function(){this._timeoutId&&clearTimeout(this._timeoutId)},t.prototype.render=function(){return this.state.isRendered?o.Children.only(this.props.children):null},t.defaultProps={delay:0},t}(o.Component)},1610:function(e,t,n){"use strict";function r(e){var t,n;return!!(null===(n=null===(t=e.hostAppConfiguration.dataCallbacks)||void 0===t?void 0:t.isCAPIv3Enabled)||void 0===n?void 0:n.call(t))}n.d(t,"a",(function(){return r}))},1611:function(e,t,n){"use strict";function r(e){var t=e.parsedResponse;return t||"number"==typeof t||"boolean"==typeof t||"string"==typeof t?{state:"success",data:t}:{state:"no_data"}}function o(e){return"rest_provider"===(null==e?void 0:e.errorCode)?{state:"error",errorCode:e.errorCode}:401===(null==e?void 0:e.statusCode)?{state:"error",errorCode:"unauthorized"}:404===(null==e?void 0:e.statusCode)?{state:"error",errorCode:"not_found"}:(t=null==e?void 0:e.statusCode,Boolean(t&&t>=500&&t<600)?{state:"error",errorCode:"server_error"}:{state:"error",errorCode:"unknown_error"});var t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},1620:function(e,t,n){"use strict";n.d(t,"m",(function(){return o})),n.d(t,"j",(function(){return a})),n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"q",(function(){return f})),n.d(t,"n",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"o",(function(){return C})),n.d(t,"p",(function(){return j}));var r=n(2),o=(Object(r.declareString)("lpc-core.videoProfile.getVideoTitle")),a=(Object(r.declareString)("lpc-core.videoProfile.getUpdateProfileVideoString")),i=(Object(r.declareString)("lpc-core.videoProfile.getUploadingProgressProfileVideoString")),c=(Object(r.declareString)("lpc-core.videoProfile.getUploadingFailedProfileVideoString")),u=(Object(r.declareStringWithPlaceholders)("lpc-core.videoProfile.getCorrelationIdProfileVideoString")),s=(Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogTitle")),l=(Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogSubtext")),d=(Object(r.declareString)("lpc-core.contactProfileVideo.getConfirmationDialogCancelText")),f=(Object(r.declareString)("lpc-core.videoProfile.updateProfileVideoFirstLine")),p=(Object(r.declareString)("lpc-core.videoProfile.playProfileVideoFirstLine")),g=(Object(r.declareString)("lpc-core.videoProfile.deleteProfileVideoFirstLine")),b=(Object(r.declareString)("lpc-core.videoProfile.deleteProfileVideoConfirmationDialogue")),v=(Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelButtonTitle")),m=(Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelButtonLabel")),h=(Object(r.declareString)("lpc-core.videoProfile.closeVideoPanelClickOutsideLabel")),C=(Object(r.declareString)("lpc-core.videoProfile.recordVideoPanelButtonLabel")),j=(Object(r.declareString)("lpc-core.videoProfile.replayVideoPanelButtonLabel"))},1621:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return b})),n.d(t,"b",(function(){return v}));var r=n(356),o=n(358),a=n(103),i=n(118),c=n(268),u=n(488),s=n(1487),l=n(364);function d(e,t){var n=t.sourceSectionType,r=t.index,a=t.windowId,s=t.applicationContext,l=t.logger;"Card"===n||"UnknownOutsideOfExpandedView"===n?s.dispatch(Object(c.a)({indexClicked:r})):s.dispatch(Object(i.i)({shouldCloseExpandedView:!0,windowId:a||o.a,section:n,logger:l})),Object(u.g)(s,l)({recipientId:e,properties:{currentTarget:void 0,personaDisplayName:void 0,windowId:a}})}function f(e,t,n){e.dispatch(Object(c.c)({indexClicked:t}));var o=e.settings.useMicrosoftTeamsFeatures?"NewTab":"CurrentTab";if(n){var a={openType:o,hrefLink:"".concat(encodeURI(n))};Object(r.a)(a,e)}}function p(e,t,n,r,o){Object(s.g)(e,t,n,r,o)}function g(e,t){e.dispatch(Object(i.n)({personaLpcKey:t.lpcKey})),Object(l.b)(e.dispatch)}function b(e,t){e.dispatch(Object(a.i)({section:t,entryPoint:"CopyClick",viewType:"Expanded"}))}function v(e,t){e.dispatch(Object(i.j)({personaLpcKey:t.lpcKey}))}},1640:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var r={UserAction:{"Overflow.Categorize.Menu.AddNewCategory":"CategorizeMenuAddNewCategoryClickAction","Overflow.Categorize.Menu.ClearAllCategories":"CategorizeMenuClearAllCategoriesClick","Overflow.Categorize.Menu.ShowAllCategories":"CategorizeMenuShowAllCategoriesClick","Overflow.Categorize.CreateCategoryModal.NewCategorySubmit":"NewContactCategoryCreateSubmitAction","Overflow.Categorize.CreateCategoryModal.NewCategoryCancel":"NewContactCategoryCreateCancelAction","Overflow.Categorize.Menu.CategoryClick":"CategorizeMenuCategoryClick"}},o={UserAction:{"ContactInfo.ContactCategoryPanel.CategoryDelete":"ContactCategoryPanelCategoryDeleteClick"}}},1654:function(e,t,n){"use strict";n.d(t,"b",(function(){return K})),n.d(t,"a",(function(){return z}));var r=n(11),o=n.n(r),a=n(9),i=n.n(a),c=n(506),u=n(366),s=n(45),l=n(46),d=n(477),f=n(1269),p=n(3),g=n(77),b=n(148),v=n(364),m=n(2),h=(Object(m.declareString)("lpc-core.videoProfile.recorderTitleString")),C=(Object(m.declareString)("lpc-core.videoProfile.recorderEditTitleString")),j=(Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteTitleString")),O=(Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteBodyString")),y=(Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteConfirmString")),S=(Object(m.declareString)("lpc-core.videoProfile.recorderEditDeleteCancelString")),k=(Object(m.declareString)("lpc-core.videoProfile.recorderUploadButtonString")),w=n(238),x=n(5),I=n.n(x),P=n(2545),A=n(2906),E=n(2071),T=n(2683),L=n(132),D=n(724),N=n(1705),R=function(e,t,n,r){return new(n||(n=i.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))};var U=Object(L.c)((function(e,t){return{retryVideoUpload:D.a.getSelectors(e).isProfileVideoRetryUpload(),unmountRecorder:D.a.getSelectors(e).isProfileVideoInitialState()}}))((function(e){var t=p.useState(void 0),n=Object(w.a)(t,2),r=n[0],a=n[1],c=p.useState(),u=Object(w.a)(c,2),s=u[0],l=u[1],d=p.useState(!0),f=Object(w.a)(d,2),g=f[0],b=f[1],v=Object(N.a)(),m=Object(N.b)();e.unmountRecorder&&s&&!g&&e.videoRecorderProps.onClose();var h=function(e){return R(void 0,void 0,void 0,o.a.mark((function t(){var n;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e.result)&&(b(!1),C(n));case 2:case"end":return t.stop()}}),t)})))},C=function(t){return R(void 0,void 0,void 0,o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t&&e.videoRecorderProps.handleUpdateProfileVideoClick(t).then((function(t){e.videoRecorderProps.onClose()})).catch((function(e){s||l(t)}));case 1:case"end":return n.stop()}}),n)})))};e.retryVideoUpload&&s&&(C(s),e.onProfileVideoUploadRetry()),p.useEffect((function(){var t=!1;return i.a.all([e.initializeVideoRecorder(e.appContext),e.loadResources(e.videoRecorderProps.userContext.language)]).then((function(n){var r=Object(w.a)(n,2),o=r[0].VideoRecorder,i=r[1],c=I()(I()({},e.videoRecorderProps),{localizedResources:i,onRecorderReady:h}),u=p.createElement(o,I()({},c));t||a(u)})).then((function(){return e.onLoadSuccess()})).catch((function(t){return e.onLoadFailure()})),function(){t=!0}}),[]);return p.createElement(T.a,{isOpen:g,styles:v,isBlocking:!1,layerProps:{eventBubblingEnabled:!0}},!r&&p.createElement("div",{className:m.modalWrapperStyles},p.createElement(P.a,{className:m.cancelButtonStyles,iconProps:{iconName:"Cancel"},onClick:e.videoRecorderProps.onClose}),p.createElement(A.a,{size:E.a.large,className:m.spinnerStyles})),r)})),V=function(e,t,n,r){return new(n||(n=i.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},_=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"renderVideoRecorder",value:function(e,t,n){var r,o=this;if(t){var a=this.appendRootElementIfNeededAndReturnIt(t),i=e.hostAppConfiguration,c=e.cardCorrelationId,s={onClose:function(){return o.closeVideoRecorder(a,t)},userContext:{userId:i.userAadObjectId||"",tenantId:i.tenantAadObjectId||"",language:(null===(r=i.culture)||void 0===r?void 0:r.split("-")[0])||""},hostContext:{hostSessionId:c||"",hostCorrelationId:i.consumerCorrelationId||"",hostVersion:""},handleUpdateProfileVideoClick:n};g.render(p.createElement(f.a,{context:t},p.createElement(U,{appContext:t,initializeVideoRecorder:this.initializeVideoRecorder,loadResources:this.loadResources.bind(this),videoRecorderProps:s,onLoadSuccess:function(){return e.dispatch(Object(u.i)({}))},onLoadFailure:function(){return e.dispatch(Object(u.h)({}))},onProfileVideoUploadRetry:function(){return e.dispatch(Object(u.l)({retryUpload:!1}))}})),a)}}},{key:"loadResources",value:function(e){return V(this,void 0,void 0,o.a.mark((function t(){var r,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e||"en",t.next=3,n(1800)("./language-".concat(r));case 3:return a=t.sent,this.overrideWebRecorderStrings(a.default.loc.strings),t.abrupt("return",a.default);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"initializeVideoRecorder",value:function(e){return V(this,void 0,void 0,o.a.mark((function t(){var r,a=this;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([n.e(275),n.e(276)]).then(n.bind(null,2927));case 2:return r=t.sent,window.setTimeout((function(){return a.appendRootElementIfNeededAndReturnIt(e)}),0),t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))}},{key:"appendRootElementIfNeededAndReturnIt",value:function(e){return Object(d.a)("VideoRecorderRootElement",e.getSingleton(b.a).ownerDocument)}},{key:"closeVideoRecorder",value:function(e,t){Object(v.a)(t.getSingleton(b.a).dispatch),g.unmountComponentAtNode(e)}},{key:"overrideWebRecorderStrings",value:function(e){e["capture_page.title.webcam"]=h.toString(),e["edit_page.next_button.label"]=k.toString(),e["edit_page.title"]=C.toString(),e["edit_page.recording_timeout_dialog.review.recording"]=C.toString(),e["edit_page.back_confirm_dialog.title"]=j.toString(),e["edit_page.back_confirm_dialog.confirm"]=y.toString(),e["edit_page.back_confirm_dialog.cancel"]=S.toString(),e["edit_page.back_confirm_dialog.body"]=O.toString()}}]),e}(),M=function(e,t,n,r){return new(n||(n=i.a))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))},K=function(e,t){var n=function(n){return M(void 0,void 0,void 0,o.a.mark((function r(){return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,F(n,e,t);case 2:case"end":return r.stop()}}),r)})))};window.setTimeout((function(){(new _).renderVideoRecorder(t,t.appContext,n)}),0)};function F(e,t,n){return M(this,void 0,void 0,o.a.mark((function r(){var a,i,s;return o.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t){r.next=21;break}return r.prev=1,n.dispatch(Object(u.m)({personaLpcKey:t.lpcKey})),r.next=5,Object(c.a)(n,t);case 5:if(a=r.sent,r.t0=a.SessionToken,!r.t0){r.next=10;break}return r.next=10,Object(c.d)(e,a.SessionToken,n,t);case 10:return r.next=12,Object(c.c)(t,n);case 12:i=r.sent,s=i.PlaybackUrl,n.dispatch(s?Object(u.j)({personaLpcKey:t.lpcKey}):Object(u.k)({personaLpcKey:t.lpcKey})),r.next=21;break;case 17:throw r.prev=17,r.t1=r.catch(1),n.dispatch(Object(u.k)({personaLpcKey:t.lpcKey})),r.t1;case 21:case"end":return r.stop()}}),r,null,[[1,17]])})))}function z(e,t){return M(this,void 0,void 0,o.a.mark((function n(){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=5;break}return n.next=3,Object(c.b)(t,e);case 3:return n.next=5,Object(c.c)(e,t);case 5:case"end":return n.stop()}}),n)})))}},1656:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(18),o=n(486),a=n(159),i=Object(a.a)((function(e){if(e&&e.InternalReplyMessage)return{start:Object(o.j)(e.DurationStartTimeUtc),end:Object(o.j)(e.DurationEndTimeUtc),message:e.InternalReplyMessage||""}})),c=Object(a.a)((function(e){if(e&&e.oofMessage)return{start:void 0,end:void 0,message:e.oofMessage||""}})),u=n(426);function s(e,t){var n=r.E.getSelectors(e).getLatestSuccess(t),o=u.a.getSelectors(e).getPersonaPresence(t);return n&&i(n)||c(o)}},1681:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(132),a=n(1505);function i(){var e=Object(o.e)();return r.useCallback((function(t,n){e(t?Object(a.b)({targetName:n}):Object(a.a)({targetName:n}))}),[e])}},1705:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(458),o=Object(r.a)((function(e){return{webRecorderCustomStyles:{selectors:{"#screenRecorderUIRoot video":{background:e.palette.neutralPrimarySurface},"#screenRecorderUIRoot .fgr-videoPlayer":{background:e.palette.neutralPrimarySurface},'#screenRecorderUIRoot [class^="capturePanelContainer"]':{gridTemplateRows:"minmax(60px, max-content) auto minmax(104px, max-content)",gridTemplateAreas:'"titleArea" "video" "actions"'},'[class^="overlayBackdropLight"]':{width:"252px",left:"272px"}}}}})),a=Object(r.b)({scrollableContent:{overflowY:"initial"}}),i=Object(r.b)({spinnerStyles:{height:"100%"},cancelButtonStyles:{top:"0px",right:"0px",position:"absolute"},modalWrapperStyles:{width:840,height:647}})},1800:function(e,t,n){var r={"./language-ar":[1721,22],"./language-ar.js":[1721,22],"./language-az-latn-az":[1722,36],"./language-az-latn-az.js":[1722,36],"./language-bg":[1723,46],"./language-bg.js":[1723,46],"./language-bs-latn-ba":[1724,57],"./language-bs-latn-ba.js":[1724,57],"./language-ca":[1725,68],"./language-ca.js":[1725,68],"./language-cs":[1726,23],"./language-cs.js":[1726,23],"./language-cy-gb":[1727,32],"./language-cy-gb.js":[1727,32],"./language-da":[1728,33],"./language-da.js":[1728,33],"./language-de":[1729,34],"./language-de.js":[1729,34],"./language-el":[1730,35],"./language-el.js":[1730,35],"./language-en":[1732,21],"./language-en-gb":[1731,37],"./language-en-gb.js":[1731,37],"./language-en.js":[1732,21],"./language-es":[1734,39],"./language-es-mx":[1733,38],"./language-es-mx.js":[1733,38],"./language-es.js":[1734,39],"./language-et":[1735,40],"./language-et.js":[1735,40],"./language-eu":[1736,41],"./language-eu.js":[1736,41],"./language-fi":[1737,42],"./language-fi.js":[1737,42],"./language-fil-ph":[1738,43],"./language-fil-ph.js":[1738,43],"./language-fr":[1740,45],"./language-fr-ca":[1739,44],"./language-fr-ca.js":[1739,44],"./language-fr.js":[1740,45],"./language-ga-ie":[1741,47],"./language-ga-ie.js":[1741,47],"./language-gl":[1742,48],"./language-gl.js":[1742,48],"./language-he":[1743,49],"./language-he.js":[1743,49],"./language-hi":[1744,50],"./language-hi.js":[1744,50],"./language-hr":[1745,51],"./language-hr.js":[1745,51],"./language-hu":[1746,52],"./language-hu.js":[1746,52],"./language-id":[1747,53],"./language-id.js":[1747,53],"./language-is":[1748,54],"./language-is.js":[1748,54],"./language-it":[1749,55],"./language-it.js":[1749,55],"./language-ja":[1750,56],"./language-ja.js":[1750,56],"./language-ka":[1751,58],"./language-ka.js":[1751,58],"./language-kk":[1752,59],"./language-kk.js":[1752,59],"./language-ko":[1753,60],"./language-ko.js":[1753,60],"./language-lt":[1754,61],"./language-lt.js":[1754,61],"./language-lv":[1755,62],"./language-lv.js":[1755,62],"./language-mk":[1756,63],"./language-mk.js":[1756,63],"./language-ms":[1757,64],"./language-ms.js":[1757,64],"./language-nb-no":[1758,65],"./language-nb-no.js":[1758,65],"./language-nl":[1759,66],"./language-nl.js":[1759,66],"./language-nn-np":[1760,67],"./language-nn-np.js":[1760,67],"./language-pl":[1761,69],"./language-pl.js":[1761,69],"./language-prs-af":[1762,70],"./language-prs-af.js":[1762,70],"./language-pt-br":[1763,71],"./language-pt-br.js":[1763,71],"./language-pt-pt":[1764,72],"./language-pt-pt.js":[1764,72],"./language-ro":[1765,73],"./language-ro.js":[1765,73],"./language-ru":[1766,74],"./language-ru.js":[1766,74],"./language-sk":[1767,75],"./language-sk.js":[1767,75],"./language-sl":[1768,76],"./language-sl.js":[1768,76],"./language-sq":[1769,77],"./language-sq.js":[1769,77],"./language-sr-cyrl-rs":[1770,78],"./language-sr-cyrl-rs.js":[1770,78],"./language-sr-latn-rs":[1771,24],"./language-sr-latn-rs.js":[1771,24],"./language-sv":[1772,25],"./language-sv.js":[1772,25],"./language-th":[1773,26],"./language-th.js":[1773,26],"./language-tr":[1774,27],"./language-tr.js":[1774,27],"./language-uk":[1775,28],"./language-uk.js":[1775,28],"./language-vi":[1776,29],"./language-vi.js":[1776,29],"./language-zh-cn":[1777,30],"./language-zh-cn.js":[1777,30],"./language-zh-tw":[1778,31],"./language-zh-tw.js":[1778,31]};function o(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((function(){return n.t(o,7)}))}o.keys=function(){return Object.keys(r)},o.id=1800,e.exports=o},1820:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(124);function o(e,t){var n,o=e.hostAppConfiguration.actionCallbacks;if(o&&o.onTagClick)try{t&&(null===(n=o.onTagClick)||void 0===n||n.call(o,t.name))}catch(e){Object(r.c)("onTagClick action callback failed: "+e)}}},1854:function(e,t,n){"use strict";n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return R}));var r=n(2175),o=n(1578),a=n(1395),i=n(3),c=n(1621),u=n(366),s=n(1441),l=n(1681),d=n(14),f=Object(d.eb)({marginLeft:"-28px",marginRight:"-28px"}),p={panel:{panelContent:function(){return{panel:{padding:"12px 0 0"}}}}},g={contactPanelContainer:function(){return{contentContainer:{marginRight:0}}}},b=n(210),v=n.n(b),m=n(114),h=n.n(m),C=n(135),j=n.n(C),O=n(76),y=n.n(O),S=n(7),k=n(159),w=n(494);function x(e,t){var n=void 0!==h.a&&e[j.a]||e["@@iterator"];if(!n){if(y()(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return v()(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var P=Object(k.a)((function(e,t,n,r,o,a){var i,c=[],u=x(e);try{var s=function(){var e=i.value;c=c.concat(e.content?e.content.map((function(i,c){return T({firstLine:i.displayString,secondLine:void 0,contactLinkType:e.contactType,index:c,lpcAppContext:t,emailClicked:n,startChatClicked:r,callPhoneClicked:o,updateProfileVideoClicked:a,href:i.hrefLink,contactLinkSubType:i.fieldType,linkIcon:i.linkIcon})})):[])};for(u.s();!(i=u.n()).done;)s()}catch(e){u.e(e)}finally{u.f()}return c})),A=Object(k.a)((function(e,t,n,r,o,a,i,c,u,s){var l,d=[],f=x(e);try{for(f.s();!(l=f.n()).done;){var p=l.value,g=E(p);d=d.concat("unknown"!==g&&p.firstLine?T({firstLine:p.firstLine,secondLine:p.secondLine,contactLinkType:g,index:0,lpcAppContext:t,emailClicked:r,startChatClicked:o,callPhoneClicked:a,updateProfileVideoClicked:i,retryProfileVideoUploadClicked:c,href:p.url,contactLinkSubType:p.contactInfoType,linkIcon:p.icon,label:p.label,tooltip:p.tooltip,dataSources:p.source,fallbackDataSource:p.fallbackSource,person:u,dataSourceLabels:n,consumerChatHandle:s}):[])}}catch(e){f.e(e)}finally{f.f()}return d}));function E(e){var t=e.label?e.label.replace(/\s/g,"").toLowerCase():"unknown";return"unknown"!==e.contactLinkType?e.contactLinkType:t}var T=Object(k.a)((function(e){var t=e.firstLine,n=e.secondLine,r=e.contactLinkType,o=e.index,a=e.lpcAppContext,i=e.emailClicked,c=e.startChatClicked,u=e.callPhoneClicked,s=e.updateProfileVideoClicked,l=e.retryProfileVideoUploadClicked,d=e.href,f=e.contactLinkSubType,p=e.linkIcon,g=e.label,b=e.tooltip,v=e.dataSources,m=e.fallbackDataSource,h=e.person,C=e.dataSourceLabels,j=e.consumerChatHandle,O=0===o?p||D(r):void 0;return{label:g,showInferredData:a.settings.isInferredContactsEnabled,isInferredData:v&&1===v.length&&v[0]===w.a,labelHoverText:C&&v&&function(e,t){var n=t.foundInEmail;if(!e)return"";return 1===e.length&&e[0]===w.a?n:e.filter((function(e){return e&&e!==w.a})).map((function(e){return function(e,t){switch(e){case"Directory":return t.sourceDirectory;case"Contact":return t.sourceContact;case"Custom":return t.sourceCustom;default:return e}}(e,t)})).join(t.dataSourceSeparator)}(v,C)||m,contactLinkType:r,contactLinkSubType:f,firstLine:t,secondLine:n,firstLineHoverText:b,icon:O,onClick:L(t,r,o,i,c,u,s,l,d,h,j,f)}}));var L=Object(k.a)((function(e,t,n,r,o,a,i,c,u,s,l,d){var f=c?function(){return c()}:void 0;switch(t){case"email":return r?function(){return r(e,n)}:void 0;case"phone":case"mobile":case"workphone":return u&&d&&a?function(){return a(u,d,n)}:void 0;case"chat":return s&&o?function(){return o(s,e,l)}:void 0;case"updateprofilevideo":return i?function(){return i()}:void 0;case"uploadfailprofilevideo":return f;default:return}})),D=Object(k.a)((function(e){switch(e){case"email":return S.b.Mail;case"phone":return S.b.Phone;case"website":return S.b.Globe;case"location":return S.b.Location;case"timezone":return S.b.Clock;case"updateprofilevideo":return S.b.VideoAdd;default:return S.b.People}}));function N(e){var t=e.onTitleClick,n=e.onFooterClick,o=e.onUpdateProfileVideoClick,u=e.contacts,d=e.showLoading,f=e.showError,p=void 0!==f&&f,b=e.additionalChildren,v=e.additionalAvailabilityInfo,m=e.hideTitle,h=Object(s.a)(),C=Object(a.b)(),j=P(u,h,(function(e,t){return Object(c.c)(e,{sourceSectionType:"Card",index:t,applicationContext:h,logger:C})}),(function(e,t){return Object(c.a)(h,e,"Card",C)}),(function(e,t,n){return Object(c.d)(h,n,e)}),(function(){o&&o()})),O=v&&v.length?P(v,h):void 0,y=Object(l.a)();return i.createElement(r.a,{logName:"UserInfoBlock",showLoading:d,showError:p,onTitleClick:h.settings.useMicrosoftTeamsFeatures?void 0:t,onFooterClick:n,contacts:j,additionalChildren:b,additionalAvailabilityInfo:O,hideFooter:h.settings.useMicrosoftTeamsFeatures,hideTitle:m,onCopied:y,styleOverrides:g})}function R(e){var t=e.onFooterClick,n=e.onUpdateProfileVideoClick,d=e.onPlayProfileVideoClick,g=e.onDeleteProfileVideoClick,b=e.onContactPopupOpened,v=e.contacts,m=e.showLoading,h=e.showError,C=void 0!==h&&h,j=e.hideFooter,O=void 0===j||j,y=e.person,S=e.sectionType,k=e.consumerChatHandle,w=e.additionalChildren,x=e.additionalAvailabilityInfo,I=Object(s.a)(),P=Object(a.b)(),E=Object(o.e)(),T=function(){y&&I.dispatch(Object(u.l)({retryUpload:!0}))},L=A(v,I,E,(function(e,t){return Object(c.c)(e,{sourceSectionType:S,index:t,applicationContext:I,logger:P})}),(function(e,t,n){return Object(c.a)(I,e,S,P,n)}),(function(e,t,n){return Object(c.d)(I,n,e)}),(function(){n&&n()}),T,y,k),D=I.settings.isRichAvailabilityInfoEnabled&&x&&x.length?A(x,I,E,void 0,void 0,void 0,(function(){n&&n()}),T):void 0,N=Object(l.a)(),R={handleDeleteProfileVideo:g,handlePlayProfileVideo:d};return i.createElement("div",{className:f},i.createElement(r.a,{logName:"UserInfoBlockLarge",showLoading:m,showError:C,onFooterClick:t,contacts:L,additionalChildren:w,additionalAvailabilityInfo:D,hideFooter:O,onCopied:N,showLargeLink:!0,profileVideoProperties:R,onContactPopupOpened:b,styleOverrides:p}))}},1916:function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return m}));var r=n(9),o=n.n(r),a=n(55),i=n.n(a),c=n(85),u=n.n(c),s=n(130),l=n(38),d=n(702),f=n(631),p=n(1),g=n(295),b=function(e,t){return Object(p.__assign)(Object(p.__assign)({},Object(g.a)(t)),{duration:e.duration,errorCode:e.errorCode,misc:u()(e.misc),moduleName:e.componentName,path:e.path,requestCorrelationId:e.requestCorrelationId,responseCorrelationId:e.responseCorrelationId,result:e.result,scenario:e.fetch.scenario,source:e.source})};function v(e){return h("Loki",e)}function m(e){var t=h("HostApp",e);return function(e){return t((function(){return e}))}}function h(e,t){var n=Object(f.c)(),r=Object(d.d)(),o=Object(d.c)(r.pathItems),a=o.path,i=o.componentName,c=n.telemetryContextProps.getFlights().includes("lpcv2debugloggingenabled");return C(e,t,n,a,i,c)}var C=function(e,t,n,r,a,c){return function(s){return function(){return new o.a((function(o){var d=i()(),f={requestId:Object(l.a)(),clientScenario:t.scenario,hostAppApp:n.telemetryContextProps.getHostAppApp()};o(s(f)().then((function(o){if("success"===o.state||"no_data"===o.state||"error"===o.state){var s=i()()-d,l=j(o,t),p="error"===o.state?o.errorCode:void 0;!function(e,t){var n=t.telemetryCallbacks,r=t.telemetryContextProps;n.logFetchEvent(b(e,r))}(function(e,t,n,r,o,a,i,c,u){var s={source:e,fetch:t,misc:u,requestCorrelationId:n.requestId,responseCorrelationId:void 0,duration:r,result:o,path:i,componentName:c};return a&&(s.errorCode=a),s}(e,t,f,s,o.state,p,r,a,l),n),c&&"no_data"!==o.state&&function(e,t,n,r,o,a,i){try{var c=JSON.parse(u()(t,void 0,1)),s=n||"Unknown";console.log("%cLog: Fetch Response, scenario: ".concat(e,", component:").concat(s,", source: ").concat(r,", duration: ").concat(o," ms, sessionId: ").concat(a,", requestId: ").concat(i),"font-weight: bold; color: blue",c)}catch(e){console.log("Failed to log Fetch response")}}(t.scenario,o,a,e,s,n.telemetryContextProps.getSessionCorrelationId(),f.requestId)}return o})))}))}}},j=function(e,t){var n,r,o;switch(e.state){case"success":return null===(n=t.getMisc)||void 0===n?void 0:n.call(t,e.data);case"error":return null===(r=t.getMisc)||void 0===r?void 0:r.call(t,e.previousData);case"no_data":return null===(o=t.getMisc)||void 0===o?void 0:o.call(t,void 0);default:Object(s.a)(e)}}},1943:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(9),o=n.n(r),a=n(498),i=n(633),c=n(1529);function u(e,t){var n=Object(i.c)(),r=Object(a.useMutation)(e,{onMutate:function(e){var r;return null===(r=null==t?void 0:t.onMutate)||void 0===r?void 0:r.call(t,n,e)},onSuccess:function(e,r){var o;return null===(o=null==t?void 0:t.onSuccess)||void 0===o?void 0:o.call(t,n,e,r)},onError:function(e,r,o){var a;return null===(a=null==t?void 0:t.onError)||void 0===a?void 0:a.call(t,n,e,r,o)},onSettled:function(e,r,o,a){var i;return null===(i=null==t?void 0:t.onSettled)||void 0===i?void 0:i.call(t,n,e,r,o,a)}}),u=r.mutateAsync,s=r.data,l=r.status,d=r.error;return[function(){return u.apply(void 0,arguments).catch((function(){return o.a.resolve({state:"error",errorCode:Object(c.f)(d)})}))},Object(c.d)(l,s,d)]}},1945:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i}));var r={name:"Categorize"},o={name:"Menu"},a={name:"CreateCategoryModal"},i={name:"ContactCategoryPanel"}},1992:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(1474),o=n(1456),a=n(30),i=n(146),c=n(1289),u=n(368),s=n(277);function l(e,t){var n=[],r=[],o=e.map((function(e){return e&&e.toLowerCase()}));return e.forEach((function(e,a){o.indexOf(e&&e.toLowerCase())===a&&(r.push(t[a]),n.push(e))})),n.map((function(e,t){return{displayString:e,hrefLink:r[t]}}))}function d(e){if(Object(a.p)(e)){if(!Object(i.d)(e.officeLocation))return{address:e.officeLocation,locationType:"OfficeLocation"};if(e.postalAddresses.length>0){var t=Object(c.a)(e.postalAddresses,(function(e){return"Business"===e.Type}));if(t)return{address:Object(u.a)(t),locationType:"BusinessAddress"};if(t=Object(c.a)(e.postalAddresses,(function(e){return"Home"===e.Type})))return{address:Object(u.a)(t),locationType:"HomeAddress"};var n=e.postalAddresses[0];if(void 0!==n)return{address:Object(u.a)(n),locationType:"PostalAddress"}}}return{address:"",locationType:"PostalAddress"}}function f(e,t,n){var a=Object(r.c)(e,t),i=Object(o.c)(e,t.timeFormats);return{fieldType:"TimeZone",displayString:Object(o.d)(a,i,n)}}function p(e,t,n,r,a,i,c){var u;if(t){var l=null!==(u=function(e,t,n,r,a,i,c){var u,s,l,d,f,p=null!==(u=n.isOutOfOffice)&&void 0!==u&&u;return f=p?Object(o.b)(null==t?void 0:t.end,a,c):Object(o.a)(null!==(s=null==e?void 0:e.UtcDateTime)&&void 0!==s?s:void 0,null!==(l=null==e?void 0:e.CurrentStatus)&&void 0!==l?l:void 0,null!==(d=null==e?void 0:e.NextStatus)&&void 0!==d?d:void 0,a,c),""===r||!f||i||p?p&&f?f:r:Object(o.g)({presence:r,nextAvailability:f})}(e,n,t,r,a,i,c))&&void 0!==u?u:"",d=function(e){return Object(s.b)(null==e?void 0:e.presence,e.isOutOfOffice)}(t);if(d&&""!==l)return{linkIcon:d,fieldType:"NextAvailability",displayString:l}}}},2022:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(964),o=n(1411),a=n(1433),i=n(631),c=n(965),u=n(3),s=n(130);var l=function(e){switch(e){case"success":case"no_data":return"Success";case"error":return"UnexpectedFailure";default:return Object(s.b)(e,"Unknown")}},d=function(e){return e&&JSON.parse(e)},f=function(e){var t=e.logger,n=e.featureName,s=e.eventFieldMap,f=e.getRenderScenario,p=e.children,g={telemetryCallbacks:function(e,t,n){return{logSessionStartEvent:function(e){},logSessionEndEvent:function(e){},logUserActionEvent:function(r){var o=[r.path,r.moduleName,r.action].join("."),a=n.UserAction,i=a&&a[o]||o,c={exportType:"UserInteraction",exportName:"".concat(r.moduleName,"_").concat(r.action)};e.logEvent({eventId:i,featureName:t,properties:d(r.misc),exportOptions:c})},logFetchEvent:function(r){var o=n.Fetch,a=o&&o[r.scenario]||r.scenario;e.logQoS(a,l(r.result),r.result.toString(),t,r.duration,r.source,r.requestCorrelationId||"",d(r.misc))},logRenderEvent:function(n){var r=n.action,o=n.state,a=n.targetView,i=n.checkpoints,c=n.components,u=n.componentsWithError,s=n.duration,l=n.preRenderLatency,d=n.renderLatency,f=n.eupl;e.logEUPL("".concat(r,"-eupl"),t,s,{action:r,state:o,targetView:a,checkpoints:i,components:c,componentsWithError:u,duration:s.toString(),preRenderLatency:(null==l?void 0:l.toString())||"",renderLatency:(null==d?void 0:d.toString())||"",eupl:(null==f?void 0:f.toString())||""})},logErrorEvent:function(n){n.midgardError&&e.logError({eventId:n.midgardError.family+"-error",featureName:t,properties:{midgardError:n.midgardError}})},registerErrors:function(t,n){e.registerErrors(t,n)},lookupError:function(e){return["",void 0,""]},errorMap:{}}}(t,n,s),telemetryContextProps:r.a},b=u.useCallback((function(){return Object(o.a)()}),[]),v=Object(a.b)(g,{getRenderScenario:f||b,getPersonaCorrelationId:function(){return""},getPersonaType:function(){return""},getSize:function(){return""}});return u.createElement(i.a,{telemetry:g,getSize:function(){return""}},u.createElement(c.a.Provider,{value:v},p))}},2029:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(1),o=n(1284),a=n(1529),i=n(1943),c=n(1593),u=n(1916),s=n(712);var l=n(1592);function d(){var e=Object(s.b)(),t=Object(u.b)({scenario:"CategoriesPatch"});return Object(i.a)((function(n){var r,o="DELETE"===n.action?(r=n.category,{id:n.personaIdentifiers.contactId||"",tags:r.map((function(e){return{id:e.id,action:"DELETE"}}))}):function(e,t){return{id:t,tags:[{action:"POST",body:{displayName:e.name,color:{backgroundColor:e.color}}}]}}(n.category,n.personaIdentifiers.contactId||"");return t((function(t){return Object(c.a)(e,{contactV3UpdateRequest:o,contactId:n.personaIdentifiers.contactId||"",aadObjectId:n.personaIdentifiers.aadObjectId||"",olsPersonaId:n.personaIdentifiers.olsPersonaId||"",userPrincipalName:n.personaIdentifiers.userPrincipalName||""},t)}))().then(Object(a.e)(f))}),{onMutate:function(e,t){var n=e.getQueryData([l.a,{contactId:t.personaIdentifiers.contactId}]);e.cancelQueries([l.a,{contactId:t.personaIdentifiers.contactId}]);var o=Object(a.b)(n)||[],i="POST"===t.action?o.concat(Object(r.__assign)(Object(r.__assign)({},t.category),{creationTime:(new Date).toUTCString()})):o.filter((function(e){return!t.category.some((function(t){return t.name===e.name}))}));return e.setQueryData([l.a,{contactId:t.personaIdentifiers.contactId}],{state:"success",data:i}),{state:"success",data:i}},onSuccess:function(e,t,n){"success"===t.state&&(e.setQueryData([l.a,{contactId:n.personaIdentifiers.contactId}],{state:"success",data:Object(a.b)(t)||[]}),e.invalidateQueries(["cardTemplate"]),e.invalidateQueries(["card/person"]),e.invalidateQueries(["hostAppData"]))}})}function f(e){if(e)return(e.tags||[]).filter((function(e){return e.displayName&&e.id})).map((function(e){var t;return{name:e.displayName||"",id:e.id||"",creationTime:e.createdDateTime||"",color:Object(o.b)(null===(t=e.color)||void 0===t?void 0:t.backgroundColor)}}))}},2185:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(7),o=n(3),a=n(1658),i=n(1650),c=n(90),u=n(120),s=n(14),l=Object(u.c)((function(e,t){return Object(s.db)({container:{padding:t?"10px 12px":"0 24px",display:"flex",flexFlow:"row wrap",margin:0},content:{fontSize:t?e.fonts.medium.fontSize:e.fonts.small.fontSize,maxWidth:"100%",display:"block",flex:"1 1 0%"},tagContent:{padding:"".concat(e.spacing.s2," 0")}})})),d=function(e){var t=e.tagIcon,n=e.tagHeader,r=e.tagContent,a=e.isLarge,i=l(Object(c.useLPCTheme)(),a);return o.createElement("div",{className:i.container},t,o.createElement("div",{className:i.content},n,o.createElement("div",{className:i.tagContent},r)))},f=n(2),p=n(32),g=(Object(f.declareString)("lpc-contact-ui.contactLinkBlockUIStrings.tagLabel"));function b(e){var t=e.isLarge,n=e.tagList,c={tag:Object(p.a)(g)},u=t?o.createElement(a.a,{label:c.tag}):void 0,s=o.createElement(i.a,{icon:r.b.Category,isLarge:t});return o.createElement(d,{tagHeader:u,tagIcon:s,tagContent:n,isLarge:t})}},2205:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(1),o=n(2029),a=n(290),i=n(1945),c=n(702),u=n(3),s=n.n(u),l=s.a.lazy((function(){return n.e(97).then(n.bind(null,2866))}));function d(e){return s.a.createElement(s.a.Suspense,{fallback:null},s.a.createElement(c.a,{component:i.b},s.a.createElement(l,Object(r.__assign)({},e))))}function f(e){var t=this,n=e.tags,i=e.showAll,c=e.showDelete,l=e.personaIdentifiers,f=e.onTagDelete,p=e.onShowMoreClick,g=e.onTagClick,b=e.onCategoryAddClick,v=e.showMenuForCategoryAddClick,m=e.onCategoryAddMenuRender,h=Object(r.__read)(Object(o.a)(),1)[0],C=Object(u.useCallback)((function(e){return Object(r.__awaiter)(t,void 0,void 0,(function(){var t,n,o;return Object(r.__generator)(this,(function(r){switch(r.label){case 0:return null==f||f({status:a.b.Pending,tags:[e]}),[4,h({personaIdentifiers:l,action:"DELETE",category:[e]})];case 1:return t=r.sent(),(n=t&&"success"===t.state&&t.data?null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.filter((function(t){return t.name===e.name})):[]).length&&(null==f||f({status:a.b.Failed,tags:n})),[2]}}))}))}),[f,h,l.contactId]);return s.a.createElement(d,{tags:n,showAll:i,showDelete:c,showMenuForCategoryAddClick:v,onTagDelete:C,onShowMoreClick:p,onTagClick:g,onCategoryAddClick:b,onCategoryAddMenuRender:m})}}}]);