define("6410b3b6-d440-4663-8744-378976dc041e_0.1.0",["tslib","@ms/sp-telemetry","@ms/office-ui-fabric-react-bundle","@microsoft/sp-component-base","@microsoft/sp-image-helper","@microsoft/sp-loader","@ms/odsp-core-bundle","@ms/sp-webpart-shared","@microsoft/sp-core-library","@microsoft/sp-webpart-base","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-html-embed","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{0:[{i:"448bd4d2-10bd-4c43-8c9a-4c371667d788",v:"0.1.0",m:"X5Fa"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"link-preview-video-metadata-provider"}[e]||e)+"_"+"none"+"_"+{0:"aba4a1490f116179a4e8"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_6410b3b6_d440_4663_8744_378976dc041e_0_1_0=window.webpackJsonp_6410b3b6_d440_4663_8744_378976dc041e_0_1_0||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp\-linkpreview\-webpart_en-us_ce3004842ca579db60cc\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="oRNZ")}({"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"5pbq":function(e,t){e.exports=i},"7Awa":function(e,t){e.exports=r},"8dK2":function(e,t){e.exports=o},I6O9:function(e,t){e.exports=s},IITQ:function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n("UWqr");function i(){return a._SPFlight.isEnabled(60179)}function r(){return a._SPFlight.isEnabled(60663)}function o(){return a._SPFlight.isEnabled(1725)}},K9kD:function(e,t){e.exports=c},U4ag:function(e,t){e.exports=d},UWqr:function(e,t){e.exports=l},br4S:function(e,t){e.exports=u},cDcd:function(e,t){e.exports=f},faye:function(e,t){e.exports=p},"hiL/":function(e,t){e.exports=m},jOlS:function(e,t){e.exports=_},krEX:function(e,t){e.exports=h},mGD9:function(e){e.exports=JSON.parse('{"o":"Paste a link to a page, video or image on the Internet.","f":"Add http:// or https:// to the beginning of the link and try again.","l":"There\\u0027s no preview available for this link.","_":"Displaying link preview on the page.","m":"There\\u0027s no preview available for this link.","r":"Edit link","a":"Hide link","i":"Hide preview","p":"Loading preview...","e":"{0} web part, showing {1}.","d":"Link","t":"Alternative text","n":"Provide alternative text to describe the thumbnail image. Alternative text helps people with screen readers understand the content of pictures.","g":"Learn more about alternative text","u":"Link Title","s":"Description","c":"Display link","b":"On","h":"Off"}')},oRNZ:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("5pbq"),s=n("7Awa"),c=n("br4S"),d=n("ut3N"),l=n("2q6Q"),u=n("UWqr"),f=function(){function e(){}return e.importVideoMetadataProvider=function(){return n.e(0).then(n.bind(null,"G0YV"))},e}(),p=n("mGD9"),m=n("y88i"),_=n("hiL/"),h=n("krEX"),b=n("U4ag"),g=Object(o.classNamesFunction)(),v=function(e){var t=e.variantTheme;return{urlContainer:{color:t&&t.semanticColors.link},placeholderContainer:{backgroundColor:t&&t.semanticColors.bodyStandoutBackground},deleteButton:{color:t&&t.semanticColors.actionLink},deleteButtonBackground:{backgroundColor:t&&t.semanticColors.bodyBackground,opacity:.6,width:"100%",height:"100%"}}},y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getStyles=function(e){return v(e)},t}(b.BaseEmphasisComponentStyles);n("jOlS").loadStyles('.a_a_55e65040{display:table;width:100%}.a_a_55e65040.b_a_55e65040{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]"}[dir=ltr] .a_a_55e65040 input{padding-left:0}[dir=rtl] .a_a_55e65040 input{padding-right:0}.a_a_55e65040 input::-ms-clear{display:none}.c_a_55e65040{display:table-cell;width:100%;word-break:break-all}.e_a_55e65040{display:inline-block}.f_a_55e65040{color:"[theme:neutralTertiary, default: #a19f9d]"}.f_a_55e65040:not(.b_a_55e65040){font-size:12px;font-weight:400}.f_a_55e65040.b_a_55e65040{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]"}.g_a_55e65040{white-space:nowrap}[dir=ltr] .g_a_55e65040{margin-left:8px}[dir=rtl] .g_a_55e65040{margin-right:8px}.g_a_55e65040:not(.h_a_55e65040){top:8px;vertical-align:bottom}.g_a_55e65040.h_a_55e65040{display:table-cell;vertical-align:middle}@media (max-width:640px){.g_a_55e65040{display:none!important}}.i_a_55e65040{display:table;height:100%;margin-bottom:12px;margin-top:20px}[dir=ltr] .j_a_55e65040{margin-right:20px}[dir=rtl] .j_a_55e65040{margin-left:20px}.k_a_55e65040{display:table-cell;height:100%;width:100%}.l_a_55e65040{-ms-interpolation-mode:nearest-neighbor;height:135px;image-rendering:pixelated;width:100%}@media (max-width:640px){.i_a_55e65040{display:block}.j_a_55e65040{width:100%}}.m_a_55e65040{position:relative}.n_a_55e65040{height:32px;width:32px}.o_a_55e65040{left:0;position:absolute;top:0}.p_a_55e65040{position:absolute!important}[dir=ltr] .p_a_55e65040{right:0}[dir=rtl] .p_a_55e65040{left:0}.p_a_55e65040:not(.h_a_55e65040){top:12px}.p_a_55e65040.h_a_55e65040{top:20px}@media (max-width:640px){.p_a_55e65040{display:none}}.q_a_55e65040{position:absolute;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .q_a_55e65040{left:50%}[dir=rtl] .q_a_55e65040{right:50%}.r_a_55e65040{height:150px;position:relative}',!0);var S,D,I,x,C="a_a_55e65040",O="b_a_55e65040",w="c_a_55e65040",E="h_a_55e65040",A="p_a_55e65040",L=["http","https"],k=function(e){function t(t){var n=e.call(this,t)||this;return n._setTextFieldRef=function(e){n._textField=e},n._validateURL=n._validateURL.bind(n),n._handleValidationResult=n._handleValidationResult.bind(n),n._handleKeyDown=n._handleKeyDown.bind(n),n.state={isDeleted:!1},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=(new y).getClassNames({variantTheme:this.props.variantTheme});return i.createElement(o.Fabric,null,i.createElement("div",{className:Object(o.css)(C,O),"data-automation-id":"inputContainer"},i.createElement(o.TextField,{componentRef:this._setTextFieldRef,className:w,defaultValue:this.props.url,key:this.props.url,placeholder:p.o,onNotifyValidationResult:this._handleValidationResult,deferredValidationTime:1500,onGetErrorMessage:this._validateURL,onKeyDown:this._handleKeyDown,borderless:!0,styles:this.props.variantTheme&&{errorMessage:{color:this.props.variantTheme.semanticColors.errorText}}}),this.props.shouldShowDeleteButton&&i.createElement(o.IconButton,{className:Object(o.css)("g_a_55e65040",E,e.deleteButton),iconProps:{iconName:"Cancel"},title:p.a,ariaLabel:p.a,onClick:this.props.onDelete})),this.props.shouldShowRenderFailMessage&&i.createElement("div",{className:Object(o.css)("f_a_55e65040",O),"data-automation-id":"previewRenderFailureErrorMessage"},p.l))},t.prototype.focus=function(){this._textField&&this._textField.focus()},t.prototype._validateURL=function(e){return!e||_.UrlUtility.ensureSchema(e,L)?"":p.f},t.prototype._handleValidationResult=function(e,t){e||this.props.onUrlChanged(_.UrlUtility.ensureSchema(t,L))},t.prototype._handleKeyDown=function(e){e.keyCode===o.KeyCodes.enter&&this._textField&&(e.preventDefault(),this.props.onFinished(this._textField.value))},t}(i.PureComponent),M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._setLinkRef=function(e){t._link=e},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=g(v,{variantTheme:this.props.variantTheme});return i.createElement("div",{className:Object(o.css)(C,O),"data-automation-id":"inputContainer"},i.createElement("div",{className:w},i.createElement(o.Link,{className:Object(o.css)("e_a_55e65040",e.urlContainer),target:Object(b.getUrlTarget)(this.props.url),href:this.props.url,componentRef:this._setLinkRef},this.props.url)))},t.prototype.focus=function(){var e;null===(e=this._link)||void 0===e||e.focus()},t}(i.Component),P=M,T=n.p+"placeholder_info_cf7e2748ae0512b2581c1414f1aba105.png",U=n.p+"placeholder_thumbnail_82c2dc56deb3299c9755b1e2c9d12acc.png",F=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=(new y).getClassNames({variantTheme:this.props.variantTheme});return i.createElement("div",{className:Object(o.css)("i_a_55e65040",e.placeholderContainer)},i.createElement("img",{className:"j_a_55e65040",src:U,alt:"",role:"presentation"}),i.createElement("div",{className:"k_a_55e65040"},i.createElement("img",{className:"l_a_55e65040",src:T,alt:"",role:"presentation"})))},t}(i.Component),H=F,R=function(){function e(){}return e.isValidURL=function(e){return/^https?:\/\//i.test(e)},e}(),N=n("IITQ"),B="LinkPreviewWebPart";!function(e){e[e.showBoth=0]="showBoth",e[e.onlyShowLink=1]="onlyShowLink",e[e.onlyShowPreview=2]="onlyShowPreview"}(S||(S={})),function(e){e[e.edit=0]="edit",e[e.preview=1]="preview",e[e.view=2]="view"}(D||(D={})),function(e){e[e.success=0]="success",e[e.fail=1]="fail"}(I||(I={})),function(e){e[e.none=0]="none",e[e.linkInput=1]="linkInput",e[e.linkView=2]="linkView",e[e.linkPreviewHTML=3]="linkPreviewHTML"}(x||(x={}));var j=function(e){function t(t){var n=e.call(this,t)||this;return n._focusOnElement=x.none,n._startToPreviewAlertIndicator=0,n._renderPreviewDoneAlertIndicator=0,n._isSyncEmbedServiceCalled=t.linkPreviewDisplayMode!==D.edit,n._handleInputFinished=n._handleInputFinished.bind(n),n._handleEdit=n._handleEdit.bind(n),n._handleLinkDelete=n._handleLinkDelete.bind(n),n._handlePreviewRenderResult=n._handlePreviewRenderResult.bind(n),n._handlePreviewDelete=n._handlePreviewDelete.bind(n),n._renderLoadingIndicator=n._renderLoadingIndicator.bind(n),n._handleUrlChanged=n._handleUrlChanged.bind(n),n._handlePreviewContentChanged=n._handlePreviewContentChanged.bind(n),n}return Object(a.__extends)(t,e),t.prototype.getMeta=function(){return this._htmlEmbed?this._htmlEmbed.getMetadata():void 0},t.prototype.getAccessibleTitle=function(){var e=this._htmlEmbed&&this._htmlEmbed.getMetadata()?this._htmlEmbed.getMetadata().Title:void 0;return e?m.StringHelper.format(p.e,p.d,e):void 0},t.prototype.getPreviewImageUrl=function(){return this._htmlEmbed&&this._htmlEmbed.getMetadata()?this._htmlEmbed.getMetadata().Thumbnail:void 0},t.prototype.render=function(){var e=this,t=this._focusOnElement;this._focusOnElement=x.none;var n=(new y).getClassNames({variantTheme:this.props.variantTheme}),a={className:A,iconProps:{iconName:"Edit"},title:p.r,ariaLabel:p.r,onClick:this._handleEdit},r={className:Object(o.css)(A,n.deleteButton),iconProps:{iconName:"Cancel"},title:p.i,ariaLabel:p.i,onClick:this._handlePreviewDelete},s=i.createElement("div",{"data-automation-id":"linkPreviewWebpart"},i.createElement(o.Fabric,null,this._displayLinkInput&&i.createElement(k,{ref:function(n){e._linkPreviewInput=n,t===x.linkInput&&n&&n.focus()},url:this.props.linkPreviewWebPartProps.url,shouldShowRenderFailMessage:this._showRenderFailMessage,shouldShowDeleteButton:this._displayLinkInputDeleteButton,variantTheme:this.props.variantTheme,onFinished:this._handleInputFinished,onUrlChanged:this._handleUrlChanged,onDelete:this._handleLinkDelete}),this._displayPlaceholder&&i.createElement(H,{variantTheme:this.props.variantTheme}),this._displayLink&&i.createElement(P,{ref:function(e){t===x.linkView&&e&&e.focus()},url:this.props.linkPreviewWebPartProps.url,variantTheme:this.props.variantTheme}),this._displayPreviewContent&&i.createElement("div",{className:"m_a_55e65040","data-automation-id":"embedContainer"},i.createElement(h.HTMLEmbed,{ref:function(n){e._htmlEmbed=n,t===x.linkPreviewHTML&&n&&n.focus()},embedCode:{embedCode:this.props.linkPreviewWebPartProps.url,embedCodeType:h.EmbedCodeType.Url,embedCodeShownType:h.EmbedCodeShownType.BingPreviewStyle},shouldScale:!0,renderLoadingIndicator:this._renderLoadingIndicator,isSkipValidationOn:!0,embedDataSource:this._embedDataSource,onNotifyRenderResult:this._handlePreviewRenderResult,isNarrowContainer:this.props.isNarrowContainer,isFlexNoWrap:!0,isWhiteSpaceBreakSpaces:!0,qosPrefixName:B,boundingRect:{width:this.props.width,height:void 0},variantTheme:this.props.variantTheme,altText:this.props.altText,thumbnailOverlapText:Object(N.n)()?this.props.thumbnailOverlapText:void 0}),this._displayPreviewEditButton&&this._renderPreviewButton(a,n),this._displayPreviewDeleteButton&&this._renderPreviewButton(r,n)),i.createElement(_.ScreenReaderAlert,{indicator:this._startToPreviewAlertIndicator,readingMode:_.ReadingMode.ReadImmediately,message:this._startToPreviewAlert}),i.createElement(_.ScreenReaderAlert,{indicator:this._renderPreviewDoneAlertIndicator,readingMode:_.ReadingMode.ReadImmediately,message:this._renderPreviewDoneAlert})));return i.createElement(o.Customizer,{settings:{theme:this.props.variantTheme}},s)},t.prototype.focusOnInputUrl=function(){this._linkPreviewInput&&this._linkPreviewInput.focus()},t.prototype._handleInputFinished=function(e){this.props.linkPreviewWebPartProps.linkPreviewComponentMode!==S.onlyShowLink&&(this._focusOnElement=x.linkPreviewHTML,this.props.onFinished(e))},t.prototype._handleUrlChanged=function(e){this._startToPreviewAlert=p.p,this._startToPreviewAlertIndicator++,this.props.onUrlChanged(e)},t.prototype._handleEdit=function(){this._focusOnElement=x.linkInput,this.props.onEdit(),this.props.onComponentModeChange(S.showBoth)},t.prototype._handleLinkDelete=function(){this._focusOnElement=x.linkPreviewHTML,this.props.onComponentModeChange(S.onlyShowPreview)},t.prototype._handlePreviewDelete=function(){this._focusOnElement=x.linkInput,this.props.onComponentModeChange(S.onlyShowLink)},t.prototype._handlePreviewRenderResult=function(e){var t,n,a=!e;this._renderPreviewDoneAlert=a?p._:p.m,this._renderPreviewDoneAlertIndicator++,this.props.onPreviewRenderResult(e),null===(n=(t=this.props).onRenderCompleted)||void 0===n||n.call(t)},t.prototype._renderLoadingIndicator=function(){return i.createElement("div",{className:"r_a_55e65040"},i.createElement(o.Spinner,{size:o.SpinnerSize.large,label:p.p,className:"q_a_55e65040"}))},t.prototype._renderPreviewButton=function(e,t){e.className=Object(o.css)("o_a_55e65040",e.title===p.i&&t.deleteButton);var n=Object(o.css)(A,E,"n_a_55e65040");return i.createElement("div",{className:n},i.createElement("div",{className:t.deleteButtonBackground}),i.createElement(o.IconButton,Object(a.__assign)({},e)))},Object.defineProperty(t.prototype,"_displayLink",{get:function(){return this.props.linkPreviewWebPartProps.url&&this.props.linkPreviewDisplayMode===D.view&&this.props.linkPreviewWebPartProps.linkPreviewComponentMode!==S.onlyShowPreview},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_displayPreviewContent",{get:function(){return R.isValidURL(this.props.linkPreviewWebPartProps.url)&&this.props.linkPreviewWebPartProps.linkPreviewComponentMode!==S.onlyShowLink},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_displayLinkInputDeleteButton",{get:function(){return!Object(N.t)()&&this.props.linkPreviewDisplayMode!==D.view&&this.props.linkPreviewWebPartProps.linkPreviewComponentMode!==S.onlyShowLink&&this.props.previewRenderState===I.success},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_showRenderFailMessage",{get:function(){return this.props.previewRenderState===I.fail},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_displayPreviewEditButton",{get:function(){return!Object(N.t)()&&this.props.linkPreviewDisplayMode!==D.view&&this.props.previewRenderState===I.success&&this.props.linkPreviewWebPartProps.linkPreviewComponentMode===S.onlyShowPreview},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_displayPreviewDeleteButton",{get:function(){return!Object(N.t)()&&this.props.linkPreviewDisplayMode!==D.view&&this.props.previewRenderState===I.success&&this.props.linkPreviewWebPartProps.linkPreviewComponentMode!==S.onlyShowPreview},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_displayLinkInput",{get:function(){return this.props.linkPreviewDisplayMode!==D.view&&this.props.linkPreviewWebPartProps.linkPreviewComponentMode!==S.onlyShowPreview},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_displayPlaceholder",{get:function(){return this._displayLinkInput&&(!this.props.linkPreviewWebPartProps.url||!R.isValidURL(this.props.linkPreviewWebPartProps.url))},enumerable:!1,configurable:!0}),t.prototype._handlePreviewContentChanged=function(e){this.props.onPreviewContentChanged&&e.EmbedMetadata&&this.props.onPreviewContentChanged({title:e.EmbedMetadata.Title,description:e.EmbedMetadata.Description,thumbnail:e.EmbedMetadata.Thumbnail,siteId:e.EmbedMetadata.SiteId,listId:e.EmbedMetadata.ListId,webId:e.EmbedMetadata.WebId,uniqueId:e.EmbedMetadata.UniqueId})},Object.defineProperty(t.prototype,"_embedDataSource",{get:function(){var e=this,t={title:this.props.linkPreviewWebPartProps.title,description:this.props.linkPreviewWebPartProps.description,thumbnail:this.props.linkPreviewWebPartProps.imageURL,siteId:this.props.linkPreviewWebPartProps.siteId,listId:this.props.linkPreviewWebPartProps.listId,webId:this.props.linkPreviewWebPartProps.webId,uniqueId:this.props.linkPreviewWebPartProps.uniqueId},n=!t.title&&!t.description&&!t.thumbnail,a=h.EmbeddableServiceFactory.createEmbeddableService(new m.Uri(this.props.linkPreviewWebPartProps.url).getDecodedStringForDisplay(),B,this.props.serviceScope);if(l._EngagementLogger.logEventWithLogEntry(new d._LogEntry(B,"embedDataSource",d._LogType.Event,{hasCache:"".concat(!n)})),n)return{type:h.EmbedDataSourceType.DataProvider,embedDataProvider:{embeddableService:a,onEmbedResultChanged:this._handlePreviewContentChanged}};if(!this._isSyncEmbedServiceCalled){var i=(new Date).getTime();(!this.props.linkPreviewWebPartProps.cachedMetaDataUpdateTimeStamp||i-this.props.linkPreviewWebPartProps.cachedMetaDataUpdateTimeStamp>864e5)&&a.getEmbeddableHtmlCode().then(function(n){n.EmbedMetadata&&n.EmbedMetadata.Title===t.title&&n.EmbedMetadata.Thumbnail===t.thumbnail&&n.EmbedMetadata.Description===t.description||l._EngagementLogger.logEvent(B+".PreviewContentChanged"),e._handlePreviewContentChanged(n)}).catch(function(e){d._TraceLogger.logError(d._LogSource.create("LinkPreviewWebPart"),e,"GetEmbeddableHtmlCode")}),this._isSyncEmbedServiceCalled=!0}return{type:h.EmbedDataSourceType.RawDataSource,embedServiceResult:{Type:"unknown",Html:"",ResponseCode:h.EmbedServiceResponseCode.OK,ErrorMessage:"",EmbedMetadata:{Description:t.description,Title:t.title,Thumbnail:t.thumbnail,SiteId:t.siteId,ListId:t.listId,WebId:t.webId,UniqueId:t.uniqueId}}}},enumerable:!1,configurable:!0}),t}(i.Component),V=n("vlQI");function z(e){if(void 0===e||e<0)return"";var t=3600,n=Math.floor(e/t),a=Math.floor((e-n*t)/60),i=Math.floor(e-n*t-60*a),r=n.toString(),o=a.toString(),s=i.toString();return o=n>0?G(a,o):o,s=G(i,s),0===n?o+":"+s:r+":"+o+":"+s}function G(e,t){return e<10?"0"+t:t}var K=n("8dK2"),W=n("K9kD"),q=n("p8gq"),Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._handleThemeChangedEvent=function(e){t._variantTheme=e.theme,t.render()},t}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"previewImageUrl",{get:function(){var e;return null===(e=this._linkPreviewComponent)||void 0===e?void 0:e.getPreviewImageUrl()},enumerable:!1,configurable:!0}),t.prototype.render=function(){this._setLinkPreviewMode(),Object(N.t)()&&this._handleLinkPreviewDisplay();var e={linkPreviewWebPartProps:this.properties,linkPreviewDisplayMode:this._getLinkPreviewModeByDisplayMode(this.displayMode),previewRenderState:this._previewRenderState,onFinished:this._handleInputFinished,onComponentModeChange:this._handleComponentModeChange,onEdit:this._handleEdit,onUrlChanged:this._handleUrlChanged,onPreviewRenderResult:this._handlePreviewRenderResult,onPreviewContentChanged:this._handlePreviewContentChanged,serviceScope:this.context.serviceScope,onRenderCompleted:this.renderCompleted,isNarrowContainer:this.width<640,width:this.width,variantTheme:this._variantTheme,altText:this.properties.altText,thumbnailOverlapText:this.properties.videoDuration?String(z(this.properties.videoDuration/1e7)):void 0},t=i.createElement(j,e);this._linkPreviewComponent=r.render(t,this.domElement),this._renderedFromPersistedData||this.renderedOnce||this._linkPreviewComponent.focusOnInputUrl()},t.prototype.onInit=function(){return this._previewRenderState=I.success,this._handleComponentModeChange=this._handleComponentModeChange.bind(this),this._handleEdit=this._handleEdit.bind(this),this._handleInputFinished=this._handleInputFinished.bind(this),this._handleUrlChanged=this._handleUrlChanged.bind(this),this._handlePreviewRenderResult=this._handlePreviewRenderResult.bind(this),this.properties.url=this.properties.url?this._resolveUrl(this.properties.url):"",this.properties.imageURL=this.properties.imageURL?this._resolveUrl(this.properties.imageURL):"",this._getSectionBackgroundTheme(),l._PerformanceLogger.markComponent(this.context.webPartTag,"".concat(l._PerformanceDataDimensions.Layout).concat(S[this.properties.linkPreviewComponentMode])),e.prototype.onInit.call(this)},t.prototype.onDispose=function(){r.unmountComponentAtNode(this.domElement),this._linkPreviewComponent=void 0,this.context.serviceScope.consume(s.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent)},t.prototype.onAfterResize=function(){this.render()},t.prototype.onBeforeSerialize=function(){R.isValidURL(this.properties.url)||(this.properties.url="")},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return!this.properties.title&&!this.properties.description&&!this.properties.imageURL&&Boolean(this.properties.url)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},description:{isSearchablePlainText:!0},imageURL:{isImageSource:!0},"previewContent.title":{isHtmlString:!0},"previewContent.description":{isHtmlString:!0},"previewContent.thumbnail":{isImageSource:!0},url:{isLink:!0}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){var e;return null===(e=this._linkPreviewComponent)||void 0===e?void 0:e.getAccessibleTitle()},enumerable:!1,configurable:!0}),t.prototype.getPropertyPaneConfiguration=function(){var e=[];return Object(N.t)()&&e.push({type:c.PropertyPaneFieldType.TextField,targetProperty:"title",properties:{label:p.u,multiline:!1,maxLength:110,resizable:!1,initialValue:this.properties.title}},{type:c.PropertyPaneFieldType.TextField,targetProperty:"description",properties:{label:p.s,multiline:!0,rows:10,maxLength:400,resizable:!1,initialValue:this.properties.description}},{type:c.PropertyPaneFieldType.Toggle,targetProperty:"displayLink",properties:{label:p.c,onText:p.b,offText:p.h,dataAutomationId:"linkDisplayToggle",disabled:!R.isValidURL(this.properties.url)}}),e.push({type:c.PropertyPaneFieldType.TextField,targetProperty:"altText",properties:{label:p.t,multiline:!0,rows:3}},Object(c.PropertyPaneLabel)("altTextLabel",Object(a.__assign)({text:p.n},{styles:{root:{fontWeight:o.FontWeights.regular}}})),Object(c.PropertyPaneLink)("webAIMLink",{ariaLabel:p.g,text:p.g,target:"_blank",href:"https://go.microsoft.com/fwlink/?LinkId=734040"})),{pages:[{groups:[{groupFields:e}]}]}},t.prototype._handleInputFinished=function(e){this._linkPreviewDisplayMode=D.preview,this._handleUrlChanged(e)},t.prototype._handleUrlChanged=function(e){e!==this.properties.url&&(this.properties.linkPreviewComponentMode=S.showBoth,this.properties.url=e,this.properties.title="",this.properties.description="",this.properties.imageURL="",this._previewRenderState=I.success),this.render()},t.prototype._handleLinkPreviewDisplay=function(){this.properties.displayLink?this.properties.linkPreviewComponentMode=S.showBoth:(this.properties.linkPreviewComponentMode=S.onlyShowPreview,d._EngagementLogger.logEvent("".concat("LinkPreviewWebPart",".DisplayLinkDisabled")))},t.prototype._handleComponentModeChange=function(e){this.properties.linkPreviewComponentMode=e,this.render()},t.prototype._handleEdit=function(){this._linkPreviewDisplayMode=D.edit,this.render()},t.prototype._handlePreviewRenderResult=function(e){var t=e?I.fail:I.success;t!==this._previewRenderState&&(this._previewRenderState=t,this.render())},t.prototype._handlePreviewContentChanged=function(e){var t=this;if(this.properties.cachedMetaDataUpdateTimeStamp=(new Date).getTime(),this.properties.title=e.title,this.properties.description=e.description,this.properties.imageURL=e.thumbnail,this.properties.listId=e.listId,this.properties.webId=e.webId,this.properties.uniqueId=e.uniqueId,this.properties.siteId=e.siteId,Object(N.n)()&&e.siteId&&e.webId&&e.listId&&e.uniqueId){var n=new W.SPResourcePath(this.properties.url),a=_.ExtensionHelper.getExtension(n);if(a&&K._PreviewUtility.isVideo(a)){var i=this.properties.videoDuration;this._fetchVideoMetadata().then(function(){i!==t.properties.videoDuration&&t.render()}).catch(function(){t.properties.videoDuration=void 0,i!==t.properties.videoDuration&&t.render()})}else this.properties.videoDuration=void 0}else this.properties.videoDuration=void 0;this.context.propertyPane.refresh()},t.prototype._getLinkPreviewModeByDisplayMode=function(e){return e===u.DisplayMode.Read?D.view:this._linkPreviewDisplayMode},t.prototype._setLinkPreviewMode=function(){this.renderedOnce&&this.displayMode!==u.DisplayMode.Read||(this._linkPreviewDisplayMode=R.isValidURL(this.properties.url)?D.preview:D.edit)},t.prototype._resolveUrl=function(e){return new URL(e,window.location.href).toString()},t.prototype._getSectionBackgroundTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(s.ThemeProvider.serviceKey);e._variantTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},t.prototype._fetchVideoMetadata=function(){var e=this;return f.importVideoMetadataProvider().then(function(t){return Object(N.e)()&&!Object(q.e)()?t.LinksVideoMetadataProvider.getVideoMetadataProvider(e.context.spHttpClient,e.context.pageContext,void 0,e.context.serviceScope):t.LinksVideoMetadataProvider.getVideoMetadataProvider(e.context.spHttpClient,e.context.pageContext,e.context.serviceScope.consume(V._DEPRECATED_DO_NOT_USE_GraphHttpClient.serviceKey))}).then(function(t){return t.getVideoMetaData(e.properties.siteId,Object(q.t)()?void 0:e.properties.webId,e.properties.listId,e.properties.uniqueId,e.properties.url)}).then(function(t){return(null==t?void 0:t.duration)&&t.duration>0?e.properties.videoDuration=t.duration:e.properties.videoDuration=void 0,Promise.resolve()})},Object(a.__decorate)([o.autobind],t.prototype,"_handlePreviewContentChanged",null),t}(c.BaseClientSideWebPart);t.default=Q},p8gq:function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("8d4196e0-1c66-406d-8efd-17a9c853092e")}function r(){return a._SPKillSwitch.isActivated("a9be4eb4-ee28-44b5-9e42-d9b458364c7a")}},ut3N:function(e,t){e.exports=b},vlQI:function(e,t){e.exports=g},y88i:function(e,t){e.exports=v}})});