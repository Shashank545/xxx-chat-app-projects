(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[82],{"5Zgq":function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("y88i"),s=n("UWqr"),c=n("Pk8u"),d=n("QdXD");n("jOlS").loadStyles('.ff_o_ada2ac09{max-height:450px;max-width:230px}.ff_o_ada2ac09 .fg_o_ada2ac09{border:0;color:"[theme:neutralPrimary, default: #323130]";font-size:12px;font-weight:400;list-style:none;margin:0;padding:16px 25px;white-space:nowrap}.ff_o_ada2ac09 .fg_o_ada2ac09 .fh_o_ada2ac09{display:block;margin:0 0 20px;overflow:hidden;text-overflow:ellipsis}.ff_o_ada2ac09 .fg_o_ada2ac09 .fi_o_ada2ac09{margin:0}.ff_o_ada2ac09 .fg_o_ada2ac09 .fj_o_ada2ac09{margin:20px 0 0}',!0);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.item.likedBy.slice(0,10),t=this.props.item.likeCount-e.length;return i.createElement("ul",{className:"fg_o_ada2ac09"},e.map(function(t,n){return n<e.length-1?i.createElement("li",{key:t.email,className:"fh_o_ada2ac09"},t.name):i.createElement("li",{key:t.email,className:"fi_o_ada2ac09"},t.name)}),Boolean(t)&&i.createElement("li",{key:"others",className:"fj_o_ada2ac09"},s.Text.format(d.s,t)))},t}(i.Component),u=l,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"finalProps",{get:function(){var e=this,t=this._getText(this.props.item),n={ariaLabel:this._getAriaLabel(this.props.item),"data-automation-id":"sp-likedbymessage",item:this.props.item,text:t,tooltipProps:{onRenderContent:function(){return i.createElement(u,{item:e.props.item})}}};return Object(c.merge)({},n,this.props)},enumerable:!1,configurable:!0}),t.prototype.render=function(){return this._includeTooltip(this.props.item)?i.createElement(r.TooltipHost,{className:"ff_o_ada2ac09",tooltipProps:this.finalProps.tooltipProps},i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))):i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))},t.prototype._getText=function(e){var t=e.likeCount-Number(e.userLiked);return e.likeCount?s.Text.format(o.StringHelper.getLocalizedCountValue(e.userLiked?d.c:d.d,d.o,t),t):d.t},t.prototype._getAriaLabel=function(e){var t=e.likeCount-Number(e.userLiked),n=e.userLiked?"Page"===e.type?d.l:d.i:"Page"===e.type?d.u:d.r;return e.likeCount?s.Text.format(d.e,s.Text.format(o.StringHelper.getLocalizedCountValue(n,d.o,t),t)):d.n},t.prototype._includeTooltip=function(e){return e.likedBy&&(e.likedBy.length>1||!e.userLiked&&1===e.likedBy.length)},t}(i.Component);t.e=f},DrmC:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i}),n.d(t,"findCommentById",function(){return r});var a=n("17wl");function i(e,t){switch(void 0===e&&(e={comments:[],commentCount:0,disabled:!1,disabledAtSiteOrTenant:!0,loaded:!1,isCommentSectionDisabledToggleDirty:!1}),t.type){case"COMMENTS_DISABLED":return d(e,t.actionData);case"COMMENT_CLEAR":return s(e);case"COMMENT_CHUNK":return function(e){return Object(a.__assign)(Object(a.__assign)({},e),{loaded:!0})}(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{comments:e.comments.sort(function(e,t){return+t.date-+e.date}).filter(function(e,t,n){return 0===t||e.id!==n[t-1].id})})}(function(e,t){var n=e.commentCount||t.count||t.comments.length||0,i=e;return t.comments.forEach(function(e){return i=o(i,e,!1)}),i=d(i,t.disabledState),Object(a.__assign)(Object(a.__assign)({},i),{commentCount:n,nextLink:t.nextLink})}(e,t.actionData)));case"COMMENT_CREATED":return o(e,t.actionData,!0);case"COMMENT_DELETED":return function(e,t){if(t.isReply()){var n=c(e,t.parentId);n&&n.removeReply(t)}return Object(a.__assign)(Object(a.__assign)({},e),{comments:t.isReply()?e.comments:e.comments.filter(function(e){return!t.equals(e)}),commentCount:e.commentCount-1-t.replies.length})}(e,t.actionData);case"COMMENT_LIKE":return function(e,t,n){return t.like(n),Object(a.__assign)({},e)}(e,t.actionData.comment,t.actionData.user);case"COMMENT_LIKE_CHUNK":return function(e,t,n){return n.processLikeChunk(t),Object(a.__assign)({},e)}(e,t.actionData.likeChunk,t.actionData.comment);case"COMMENT_FOCUS_REPLY":return function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{focusedCommentId:t})}(e,t.actionData);case"COMMENT_MARK_DELETED":return function(e,t){return t.markDeleted(),Object(a.__assign)({},e)}(e,t.actionData);case"COMMENT_REPLACED":return function(e,t,n){var i=t&&c(e,t.parentId);if(i)return i.replaceReply(t,n),Object(a.__assign)({},e);var r=e.comments.indexOf(t);return r>-1?Object(a.__assign)(Object(a.__assign)({},e),{comments:e.comments.map(function(e,t){return t===r?n:e})}):o(e,n,!0)}(e,t.actionData.oldComment,t.actionData.newComment);case"COMMENT_REPLY_CHUNK":return function(e,t){var n=c(e,t.parentId);if(!n)throw new Error("CommentReducer: Attempted to add reply chunk but no parent was found");var a=e;return t.comments.forEach(function(e){return a=o(a,e,!1)}),n.nextLink=t.nextLink,a}(e,t.actionData);case"COMMENT_RESET":case"PAGE_CREATE_STUB":return function(e){return Object(a.__assign)(Object(a.__assign)({},s(e)),{disabled:!0})}(e);case"COMMENT_UNLIKE":return function(e,t,n){return t.unlike(n),Object(a.__assign)({},e)}(e,t.actionData.comment,t.actionData.user);case"COMMENT_UNMARK_DELETED":return function(e,t){return r(e,t.id)?(t.unmarkDelted(),Object(a.__assign)({},e)):o(e,t,!0)}(e,t.actionData);case"COMMENT_RESET_DIRTY":return function(e){return Object(a.__assign)(Object(a.__assign)({},e),{isCommentSectionDisabledToggleDirty:!1})}(e);default:return e}}function r(e,t){return c(e,t)||function(e,t){return e.comments.reduce(function(e,n){return e||n.replies.reduce(function(e,n){return e||n.id===t?n:void 0})})}(e,t)}function o(e,t,n){var i=c(e,t.parentId);return i&&(i.addReply(t),i.sortReplies()),Object(a.__assign)(Object(a.__assign)({},e),{comments:i?e.comments:Object(a.__spreadArray)([t],Object(a.__read)(e.comments),!1),commentCount:n?e.commentCount+1:e.commentCount})}function s(e){return Object(a.__assign)(Object(a.__assign)({},e),{comments:[],commentCount:0,nextLink:void 0,loaded:!1})}function c(e,t){return e.comments.filter(function(e){return e.id===t})[0]}function d(e,t){var n=0!==t,i=2===t||3===t;return Object(a.__assign)(Object(a.__assign)({},e),{disabled:n,disabledAtSiteOrTenant:i,isCommentSectionDisabledToggleDirty:!0})}},GW7U:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("ut3N"),o=n("Yo/j"),s=n("Rrln"),c=n("DrmC"),d=n("xs0R"),l=function(){function e(e){var t=this;this._findAndScroll=function(){t._commentIsPresent()?t._scrollToComment():t._getNext().then(t._findAndScroll).catch(t._handleError)},this._hash=e,this._determineValidity(),this._valid&&this._extractParts()}return e.prototype.scroll=function(){this._valid&&this._findAndScroll()},Object.defineProperty(e.prototype,"_commentSlice",{get:function(){return d.t.pageReduxStore.getState().comments},enumerable:!1,configurable:!0}),e.prototype._commentIsPresent=function(){return void 0!==Object(c.findCommentById)(this._commentSlice,String(this._commentId))},e.prototype._determineValidity=function(){this._valid=e._commentIdRegex.test(this._hash)},e.prototype._extractNumber=function(e,t){var n=e.exec(t);return n?Number(n[1]):void 0},e.prototype._extractParts=function(){this._commentId=this._extractNumber(e._commentIdRegex,this._hash),this._parentCommentId=this._extractNumber(e._parentIdRegex,this._hash)},e.prototype._getNext=function(){if(this._parentCommentId){var e=Object(c.findCommentById)(this._commentSlice,String(this._parentCommentId));if(e)return e.nextLink?o.e.getNextReplies(e.nextLink,e.id):Promise.reject(new Error("Unable to find comment reply"))}return this._commentSlice.nextLink?o.e.getNextComments(this._commentSlice.nextLink):Promise.reject(new Error("Unable to find top level comment"))},e.prototype._handleError=function(t){r._TraceLogger.logError(e._logSource,t)},e.prototype._scrollToComment=function(){var t=this;setTimeout(function(){var n=document.getElementById("sp-comment-".concat(t._commentId));n?n.scrollIntoView():r._TraceLogger.logError(e._logSource,new Error("Comment present but could not be found in view"))},0)},e._commentIdRegex=new RegExp(/[#&]comment=(\d+)/),e._logSource=r._LogSource.create("CommentDirectScroller"),e._parentIdRegex=new RegExp(/[#&]parentComment=(\d+)/),e}(),u=n("5pbq"),f=n("faye"),p=n("2q6Q"),m=n("I6O9"),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype._internalLoad=function(){return m.SPComponentLoader.loadComponentById("44f2ec7c-d082-4660-956e-5e3cd760e6ad").then(function(e){return e.AtMentionControl})},t}(n("qjmy")._DeferredComponent),h=_,b=n("y88i"),g=n("UWqr"),v=n("Y7TA"),y=n("X+PM"),S=n("yo36"),D=n.n(S),I=n("hiL/"),x=n("F5rs");n("jOlS").loadStyles('.bl_i_ada2ac09{color:"[theme:neutralSecondary, default: #605e5c]"}[dir=ltr] .bl_i_ada2ac09{margin-right:11px}[dir=rtl] .bl_i_ada2ac09{margin-left:11px}.bl_i_ada2ac09:hover{color:"[theme:themePrimary, default: #0078d4]"}[dir=ltr] .bl_i_ada2ac09:last-child{margin-right:0}[dir=rtl] .bl_i_ada2ac09:last-child{margin-left:0}.bm_i_ada2ac09{color:"[theme:neutralSecondary, default: #605e5c]"}[dir=ltr] .bm_i_ada2ac09{margin-right:0}[dir=rtl] .bm_i_ada2ac09{margin-left:0}.bm_i_ada2ac09:hover{color:"[theme:themePrimary, default: #0078d4]"}.bn_i_ada2ac09{display:flex;font-size:14px;font-weight:400;justify-content:space-between;min-height:40px}.bo_i_ada2ac09{visibility:hidden}.bp_i_ada2ac09{color:"[theme:neutralDark, default: #201f1e]";font-size:14px;font-weight:400;font-weight:700}.bq_i_ada2ac09{height:32px;min-width:32px;position:relative;width:32px}.br_i_ada2ac09{border-radius:17px;height:100%;width:100%}.bs_i_ada2ac09{min-height:32px}.bt_i_ada2ac09{margin:20px;width:100%}.bu_i_ada2ac09{margin:14px 0}[dir=ltr] .bu_i_ada2ac09 .bv_i_ada2ac09{margin-left:41px}[dir=rtl] .bu_i_ada2ac09 .bv_i_ada2ac09{margin-right:41px}.bu_i_ada2ac09 .bv_i_ada2ac09:first-child,.bv_i_ada2ac09{margin-top:14px}.bv_i_ada2ac09 .bw_i_ada2ac09 .bx_i_ada2ac09{max-height:75px;min-height:32px;overflow-y:auto;white-space:pre-wrap}.mobile .bv_i_ada2ac09 .bw_i_ada2ac09 .bx_i_ada2ac09{max-height:none}@media print{.bv_i_ada2ac09 .bw_i_ada2ac09 .bx_i_ada2ac09{max-height:none}}.by_i_ada2ac09{flex:1;line-height:1}[dir=ltr] .by_i_ada2ac09{margin-left:11px}[dir=rtl] .by_i_ada2ac09{margin-right:11px}.bz_i_ada2ac09{display:flex}.ca_i_ada2ac09{background-color:"[theme:white, default: #ffffff]";border-radius:17px;height:33px;opacity:.6;position:absolute;top:0;width:33px}.cb_i_ada2ac09{flex-grow:1;margin:0 7px 30px}.cc_i_ada2ac09{display:inline-block;margin-bottom:10px;margin-top:0}.cc_i_ada2ac09.ce_i_ada2ac09{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.cc_i_ada2ac09:not(.ce_i_ada2ac09){font-size:28px;font-weight:100}.bx_i_ada2ac09{word-wrap:break-word;-webkit-font-smoothing:antialiased;border-style:solid;border-width:1px;box-sizing:border-box;cursor:text;line-height:normal;outline:0;padding:5px 14px;word-break:break-word}.bx_i_ada2ac09.cf_i_ada2ac09{background-color:"[theme:bodyBackground, default: #ffffff]";border-color:"[theme:neutralSecondary, default: #605e5c]";color:"[theme:neutralPrimary, default: #323130]"}.bx_i_ada2ac09.cf_i_ada2ac09:focus{border-color:"[theme:themePrimary, default: #0078d4]"}.bx_i_ada2ac09.cf_i_ada2ac09[disabled]{background-color:"[theme:infoBackground, default: #f4f4f4]";border-color:"[theme:infoBackground, default: #f4f4f4]";cursor:default;pointer-events:none}.bx_i_ada2ac09.cf_i_ada2ac09:hover{border-color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.bx_i_ada2ac09:not(.cf_i_ada2ac09){background-color:"[theme:bodyBackground, default: #ffffff]";border-color:"[theme:neutralTertiaryAlt, default: #c8c6c4]";color:"[theme:neutralPrimary, default: #323130]"}.bx_i_ada2ac09:not(.cf_i_ada2ac09):hover{border-color:"[theme:neutralSecondaryAlt, default: #8a8886]"}.bx_i_ada2ac09:not(.cf_i_ada2ac09):focus{border-color:"[theme:themePrimary, default: #0078d4]"}.bx_i_ada2ac09:not(.cf_i_ada2ac09)[disabled]{background-color:"[theme:infoBackground, default: #f4f4f4]";border-color:"[theme:infoBackground, default: #f4f4f4]";cursor:default;pointer-events:none}.bx_i_ada2ac09.ce_i_ada2ac09{border-radius:"[theme:roundedCorner4, default: 4px]"}.bx_i_ada2ac09:empty:after{color:"[theme:neutralSecondary, default: #605e5c]";content:attr(placeholder);display:block}.bx_i_ada2ac09[disabled]:empty:not(:focus):before{content:""}.cg_i_ada2ac09{color:"[theme:neutralSecondaryAlt, default: #8a8886]";font-size:11px;font-weight:400;padding-top:5px}.ch_i_ada2ac09{color:"[theme:error, default: #a80000]"}.ci_i_ada2ac09{color:"[theme:themePrimary, default: #0078d4]"}.ci_i_ada2ac09:hover{color:"[theme:themeDark, default: #005a9e]";cursor:pointer}.cj_i_ada2ac09{margin-top:6px}.cj_i_ada2ac09>a,.cj_i_ada2ac09>label{color:"[theme:neutralSecondary, default: #605e5c]";font-size:12px;font-weight:400}.ck_i_ada2ac09{margin-bottom:14px}.bw_i_ada2ac09{display:flex;font-size:14px;font-weight:400}@media print{.bw_i_ada2ac09{display:none}}.cl_i_ada2ac09{flex-shrink:0}.cm_i_ada2ac09{word-wrap:break-word;color:"[theme:neutralPrimary, default: #323130]";font-size:17px;font-weight:300;font-weight:400;line-height:normal;margin-top:8px;word-break:break-word}.cm_i_ada2ac09 .cn_i_ada2ac09{display:block}.cm_i_ada2ac09 .cn_i_ada2ac09 a[data-sp-mention-user-id]{color:"[theme:themePrimary, default: #0078d4]";font-weight:lighter;text-decoration:none}.cm_i_ada2ac09 .cn_i_ada2ac09 a[data-sp-mention-user-id][access-type="1"]{font-weight:700}.cm_i_ada2ac09 .cn_i_ada2ac09 div{display:inline}.co_i_ada2ac09{display:inline-block;margin:0 15px;vertical-align:middle}.cp_i_ada2ac09{width:288px}.cq_i_ada2ac09{top:50px}.cr_i_ada2ac09{overflow-x:hidden;overflow-y:auto;padding:0 25px}.cs_i_ada2ac09{flex-shrink:0;padding:0 25px}.cs_i_ada2ac09 .ct_i_ada2ac09{font-size:21px;font-weight:300;line-height:48px;margin:0}@media screen and (min-width:640px){.bt_i_ada2ac09{margin:20px 36px}}@media screen and (max-width:639px){.bt_i_ada2ac09{margin:0}.bw_i_ada2ac09{flex-wrap:wrap}.cu_i_ada2ac09{width:100%}}',!0);var C={spAction:"bl_i_ada2ac09",spActionLike:"bm_i_ada2ac09",spActions:"bn_i_ada2ac09",spActionsHidden:"bo_i_ada2ac09",spAuthor:"bp_i_ada2ac09",spAvatar:"bq_i_ada2ac09",spAvatarImage:"br_i_ada2ac09",spButton:"bs_i_ada2ac09",spCommentSection:"bt_i_ada2ac09",spComment:"bu_i_ada2ac09",spComments:"bv_i_ada2ac09",spReply:"bw_i_ada2ac09",spInput:"bx_i_ada2ac09",spContent:"by_i_ada2ac09",spContentRegion:"bz_i_ada2ac09",spDisabledAvatarOverlay:"ca_i_ada2ac09",spField:"cb_i_ada2ac09",spHeader:"cc_i_ada2ac09",fluent:"ce_i_ada2ac09",spInputContrastRatioOverwrite:"cf_i_ada2ac09",spInputLimit:"cg_i_ada2ac09",spInputLimitExceeded:"ch_i_ada2ac09",spMore:"ci_i_ada2ac09",spMetadata:"cj_i_ada2ac09",spMoreBlock:"ck_i_ada2ac09",spReplyButtonBlock:"cl_i_ada2ac09",spText:"cm_i_ada2ac09",commentRichText:"cn_i_ada2ac09",spToggleWrapper:"co_i_ada2ac09",spLikesList:"cp_i_ada2ac09",spLikesPanel:"cq_i_ada2ac09",spLikesPanelContent:"cr_i_ada2ac09",spLikesPanelHeader:"cs_i_ada2ac09",spLikesPanelHeaderText:"ct_i_ada2ac09",spBreak:"cu_i_ada2ac09"},O=function(e){function t(t){var n=e.call(this,t)||this;return n._avatarErrorLogged=!1,n._lpcAdapterRefresh=n._lpcAdapterRefresh.bind(n),n.state={},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._mounted=!0},t.prototype.componentWillUnmount=function(){this._mounted=!1},t.prototype.render=function(){var e,t=s.e.instance.serviceScope.consume(y.PageContext.serviceKey);if(this._isValidUser())try{e=i.createElement(v.e,{personaType:"User",identifier:this.props.user.email,lpcHoverTargetProps:{upn:this._getUserUpn(this.props.user)},pageContext:t.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},i.createElement("div",null,this._imageComponent()))}catch(e){this._logAvatarError("UnknownError",e)}else this._logAvatarError("InvalidUser");return i.createElement("div",{className:C.spAvatar},e)},t.prototype._lpcAdapterRefresh=function(e){var t=this;!this._lpcAdapterPromise&&e&&(this._lpcAdapterPromise=this.state.lpcAdapter.ensureInitializeLPC(e.makeAdapterConfig()).then(function(){return t._mounted&&t.setState(t.state)}))},t.prototype._imageComponent=function(){return i.createElement(D.a,{key:this.props.user.email,dimensions:{width:32,height:32},displayName:this.props.user.name},i.createElement("img",{alt:b.StringHelper.format(x.V,this.props.user.name),className:C.spAvatarImage,src:I.SPUtility.getUserPhotoUrl(this.props.user.email)}),this.props.disabled&&i.createElement("div",{className:C.spDisabledAvatarOverlay}))},t.prototype._getUserUpn=function(e){return e.loginName?e.loginName.slice(e.loginName.lastIndexOf("|")+1):e.email},t.prototype._isValidUser=function(){return this.props.user&&!!this.props.user.id&&-1!==this.props.user.id},t.prototype._logAvatarError=function(e,t){this._avatarErrorLogged||(new r._QosMonitor("CommentAvatarError").writeUnexpectedFailure(e,t,t?{stack:t.stack}:void 0),this._avatarErrorLogged=!0)},t}(i.Component),w=n("CIL5"),E=n.n(w),A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return this._parseCounter=0,i.createElement("span",{className:this.props.className},this._parse(this.props.children))},t.prototype._cloneElement=function(e){return i.cloneElement(e,{key:"parse".concat(++this._parseCounter)},this._parse(e.props.children))},t.prototype._convertMatchesToReact=function(e,t){var n=this,a=0,i=[];return t.forEach(function(t,r){i.push(e.substring(a,t.index)),i.push(n._newLink(t)),a=t.lastIndex}),i.push(e.substring(a)),i.filter(function(e){return!!e})},t.prototype._getMatches=function(e){return t._linkifyIt.match(e)},t.prototype._newLink=function(e){return i.createElement("a",this._propsFor(e.url,"parse".concat(this._parseCounter,"match").concat(e.url)),e.text)},t.prototype._parseString=function(e){if(""===e)return[];var t=this._getMatches(e);return t?this._convertMatchesToReact(e,t):e},t.prototype._parse=function(e){var t=this;return"string"==typeof e?this._parseString(e):i.isValidElement(e)&&"a"!==e.type?this._cloneElement(e):e instanceof Array?e.map(function(e){return t._parse(e)}):e},t.prototype._propsFor=function(e,t){var n={href:e,key:t};for(var a in this.props.properties)this.props.properties.hasOwnProperty(a)&&(n[a]=this.props.properties[a]);return n},t._linkifyIt=new E.a,t}(i.Component),L=A,k=n("q+wp"),M=function(e){function t(t){var n=e.call(this,t)||this;n._mentionMap=new Map,n._assignInputRef=function(e){n._root=e},n._showMore=function(){k.e.logUserEngagementForPage(d.t.fields,!0,"CommentShowMoreButton"),n.setState({expanded:!0,text:n.props.text})};var a=n._shrinkText(t.text);return n.state={expanded:a===t.text,text:a},n.props.mentions&&n.props.mentions.forEach(function(e){if(n._mentionMap.set(e.email,e.name),e.loginName){var t=e.loginName.substr(e.loginName.lastIndexOf("|")+1);n._mentionMap.set(t,e.name)}}),n}return Object(a.__extends)(t,e),t.htmlDecode=function(e){var t=e;if(DOMParser){var n=(new DOMParser).parseFromString(t||"","text/html");t=n&&n.body&&n.body.innerText?n.body.innerText:""}return t},t.prototype.render=function(){return i.createElement(L,{properties:{target:"_blank",rel:"noopener"},ref:this._assignInputRef},this.state.text&&this.state.text.split("\n").map(function(e,t,n){return i.createElement("span",{key:e+t,className:C.commentRichText,dangerouslySetInnerHTML:{__html:e}})}),!this.state.expanded&&i.createElement(u.Link,{className:C.spMore,onClick:this._showMore},x.F))},t.prototype.componentDidMount=function(){this._attachLivePersonaCard()},t.prototype.componentDidUpdate=function(e,t){t.expanded===!this.state.expanded&&(this._disposeLivePersonaCards(),this._attachLivePersonaCard())},t.prototype.componentWillUnmount=function(){this._disposeLivePersonaCards()},t.prototype._disposeLivePersonaCards=function(){this._lpcAdapters&&(this._lpcAdapters.forEach(function(e){f.unmountComponentAtNode(e)}),this._lpcAdapters=void 0)},t.prototype._attachLivePersonaCard=function(){var e=f.findDOMNode(this._root),t="data-sp-mention-user-id",n="access-type";if(e instanceof Element){var a=e.querySelectorAll("a[".concat(t,"]"));this._lpcAdapters=[];for(var i=0;i<a.length;i++){var r=a[i].getAttribute(t),o=a[i].innerText.replace("@","");if(a[i].setAttribute("href","mailto:"+r),this.props.mentions){var s=this._mentionMap.get(r);s?(-1===s.indexOf(o)&&(o=s),a[i].setAttribute(n,"1")):a[i].setAttribute(n,"0")}var c=this._linkWithLPC(r,g.Text.format(x.Q,o));f.render(c,a[i]),this._lpcAdapters.push(a[i])}}},t.prototype._shrinkText=function(e){return t.htmlDecode(e).length>400?g.Text.format(x.W,e.slice(0,this._truncationPoint(e))):e},t.prototype._truncationPoint=function(e){var t=e.slice(0,350).lastIndexOf(" ");return-1===t?350:t},t.prototype._linkWithLPC=function(e,t){return i.createElement(v.e,{personaType:"User",identifier:e,lpcHoverTargetProps:{upn:e},pageContext:this.props.pageContext.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},i.createElement("span",null,t))},t}(i.Component),P="".concat(" ").concat(" ","\n\r"),T=function(){function e(){this._addingPreNodes=!0,this._postNodes=[],this._preNodes=[]}return e.prototype.addNode=function(e){(this._addingPreNodes?this._preNodes:this._postNodes).push(e)},e.prototype.addText=function(e,t){t>0&&t<e.length?(this.addNode(document.createTextNode(e.substr(0,t))),this._startAddingPostNodes(),this.addNode(document.createTextNode(e.substr(t)))):this.addNode(document.createTextNode(e))},Object.defineProperty(e.prototype,"postNodes",{get:function(){return this._postNodes.filter(this._nonBlankNode)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preNodes",{get:function(){return this._preNodes.filter(this._nonBlankNode)},enumerable:!1,configurable:!0}),e.prototype._nonBlankNode=function(e){return"A"===e.nodeName||!!e.nodeValue},e.prototype._startAddingPostNodes=function(){this._addingPreNodes=!1},e}(),U=function(){function e(e,t){this._element=e,this._requireSpace=t}return e.replaceLinks=function(t,n){new e(t,n).replaceLinks()},e.prototype.replaceLinks=function(){var e=this;[].forEach.call(this._element.childNodes,function(t){t.nodeValue?e._findAndReplaceMatches(t,t.nodeValue):e._replaceChildLinks(t)})},e.prototype._findAndReplaceMatches=function(e,t){var n=this._matchesForText(e,t);if(n.length){var a=this._newNodesForMatches(e,n,t);this._pushNodes(a,e)}},e.prototype._getCursorPosition=function(e){var t,n=0,a=e.ownerDocument||e.document,i=a.defaultView||a.parentWindow;if(void 0!==i.getSelection){if((t=i.getSelection()).rangeCount>0){var r=t.getRangeAt(0),o=r.cloneRange();o.selectNodeContents(e),o.setEnd(r.endContainer,r.endOffset),n=o.toString().length}}else if((t=a.selection)&&"Control"!==t.type){var s=t.createRange(),c=a.body.createTextRange();c.moveToElementText(e),c.setEndPoint("EndToEnd",s),n=c.text.length}return n},e.prototype._lastCharacterShouldBreak=function(e,t,n){var a=this._getCursorPosition(e)-1||t.lastIndex;return a>n.length||void 0!==n[a]&&P.indexOf(n[a])>-1},e.prototype._linkNodeFor=function(e){var t=document.createElement("a");return t.appendChild(document.createTextNode(e.text)),t.setAttribute("contentEditable","false"),t.href=e.url,t.rel="noopener",t.target="_blank",t},e.prototype._matchesForText=function(t,n){return this._removeUnfinishedMatches(t,e._linkifyIt.match(n)||[],n)},e.prototype._newNodesForMatches=function(e,t,n){var a=this,i=this._getCursorPosition(e)||n.length,r=new T,o=0;return t.forEach(function(e){r.addText(n.substr(o,e.index-o),i-o),r.addNode(a._linkNodeFor(e)),o=e.lastIndex}),r.addText(n.substr(o),i-o),r},e.prototype._pushNodes=function(e,t){var n=this;e.preNodes.forEach(function(e){n._element.insertBefore(e,t)}),e.postNodes.forEach(function(e){n._element.insertBefore(e,t.nextSibling)}),t.nodeValue=""},e.prototype._readyToReplace=function(e,t,n){return!this._requireSpace||this._lastCharacterShouldBreak(e,t,n)},e.prototype._removeUnfinishedMatches=function(e,t,n){var a=this;return t.filter(function(t){return a._readyToReplace(e,t,n)})},e.prototype._replaceChildLinks=function(t){"DIV"===t.nodeName&&e.replaceLinks(t,this._requireSpace)},e._linkifyIt=new E.a,e}(),F=n("7plR"),H=2e3,R=function(e){function t(t){var n=e.call(this,t)||this;return n._a11yManager=F.e.instance.a11yManager,n._mentionsWithAccess=0,n._mentionsWithoutAccess=0,n._mentionsTotal=0,n._assignInputElementRef=function(e){n._inputElement=e},n._handleBlur=function(){n._updateText()},n._convertPasteToPlainText=function(e){var t=e;if(!k.e.isIE11()){t.preventDefault();var n="";t.clipboardData||t.originalEvent.clipboardData?n=(t.originalEvent||t).clipboardData.getData("text/plain"):window.clipboardData&&(n=window.clipboardData.getData("Text")),document.queryCommandSupported("insertText")?document.execCommand("insertText",!1,n):document.execCommand("paste",!1,n)}},n._onReply=function(){k.e.logUserEngagementForPage(d.t.fields,!0,"CommentReplyPostButton");var e=n._textContent();o.e.createComment(s.e.instance.user,e,n.props.commentId,function(){n.setState({commentValue:e}),n._inputElement&&(n._inputElement.innerHTML=e)}),n.setState({commentValue:""}),n._logMentionTotal(),n._a11yManager.alert(x.l),n._inputElement&&n._a11yManager.focusTo(n._inputElement)},n._updateText=function(e){e&&e.ctrlKey&&13===e.keyCode?n._onReply():(n._inputElement&&(U.replaceLinks(n._inputElement,e&&13!==e.keyCode),n.setState({commentValue:n._inputElement.innerHTML})),n._handleAtMention())},n._handleAtMention=function(){if(n._inputElement&&!n._atMention){var e=document.createElement("div"),t=i.createElement(h,{deferredProps:{editorElement:n._inputElement,serviceScope:F.e.instance.serviceScope}});n._atMention=f.render(t,e)}},g.Validate.isNotNullOrUndefined(n._a11yManager,"A11yManager"),n._allowTags(["a"]),n.state={commentValue:""},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=x.Y;return i.createElement("form",{className:Object(u.css)(C.spReply)},i.createElement(O,{disabled:this.props.disabled,user:s.e.instance.user}),i.createElement("div",{className:C.spField},i.createElement("div",Object(a.__assign)({"aria-label":x.q,className:Object(u.css)(C.spInput,C.spInputContrastRatioOverwrite,g._SPFlight.isEnabled(60803)&&C.fluent),contentEditable:!this.props.disabled},{disabled:this.props.disabled,placeholder:e},{id:this._isRootReply()?"sp-comment-input":"sp-comment-input-reply-".concat(this.props.commentId),onBlur:this._handleBlur,onKeyUp:this._updateText,onPaste:this._convertPasteToPlainText,ref:this._assignInputElementRef,role:"textbox"})),this._textLength()>1800&&i.createElement("div",{"aria-atomic":"true","aria-live":"polite",className:Object(u.css)(C.spInputLimit,this._inputExceededStyle())},this._charactersRemainingText())),i.createElement("div",{className:C.spBreak}),i.createElement("div",{className:C.spReplyButtonBlock},i.createElement(u.PrimaryButton,{ariaLabel:x.L,className:C.spButton,"data-automation-id":this._isRootReply()?"sp-comment-post":"sp-comment-reply-post-".concat(this.props.commentId),disabled:!this.commentInputValid()||this.props.disabled,onClick:this._onReply,text:x.L})))},t.prototype.commentInputValid=function(){return this._textLength()>0&&this._textLength()<=2e3},t.prototype.componentDidMount=function(){this.props.autoFocus&&this._inputElement&&this._a11yManager.focusTo(this._inputElement)},t.prototype.componentWillUnmount=function(){this._inputElement&&(f.unmountComponentAtNode(this._inputElement),this._inputElement=void 0)},t.prototype.componentDidUpdate=function(){""===this.state.commentValue&&this._inputElement&&(this._inputElement.innerHTML="")},t.prototype.focus=function(){this._inputElement&&this._a11yManager.focusTo(this._inputElement)},t.prototype._charactersRemainingText=function(){return this._textLength()<=H?g.Text.format(b.StringHelper.getLocalizedCountValue(x.T,x.U,H-this._textLength()),H-this._textLength()):g.Text.format(b.StringHelper.getLocalizedCountValue(x.M,x.P,-2e3+this._textLength()),-2e3+this._textLength())},t.prototype._inputExceededStyle=function(){return this._textLength()>H?C.spInputLimitExceeded:""},t.prototype._isRootReply=function(){return!this.props.commentId},t.prototype._limitConsecutiveNewlines=function(e){return e.replace(/\n{3,}/gm,"\n\n")},t.prototype._removeAllTags=function(e){return this._regexWithException?e.replace(this._regexWithException,""):e.replace(/<(?:.|\n)*?>/gm,"")},t.prototype._allowTags=function(e){for(var t=e[0],n=1;n<e.length;n++)t+="|"+e[n];this._regexWithException=new RegExp("<(?!/?("+t+")(?=>|\\s.*>))/?.*?>","gm")},t.prototype._replaceDivsWithNewLines=function(e){return e.replace(/<div>/gi,"\n").replace(/<\/div>/gi,"")},t.prototype._textLength=function(){return this._inputElement&&0!==this.state.commentValue.length?this._textLengthCache&&this._lastHTML===this._inputElement.innerHTML?this._textLengthCache:(this._lastHTML=this._inputElement.innerHTML,this._textLengthCache=this._textContent().length):0},t.prototype._textContent=function(){var e=this._inputElement?this._inputElement.innerHTML:"";return e=this._replaceDivsWithNewLines(e),e=this._limitConsecutiveNewlines(e),e=this._trimSurroundingWhitespace(e),g._SPKillSwitch.isActivated("af73c2cc-3cbf-4ea4-b506-6f92b305a680")||(e=this._replaceBreakTagsWithNewLines(e)),e=this._removeAllTags(e),this._regexWithException||(e=M.htmlDecode(e)),e},t.prototype._trimSurroundingWhitespace=function(e){return e.replace(/^\s+|\s+$/g,"")},t.prototype._replaceBreakTagsWithNewLines=function(e){return g._BrowserDetection.getBrowserInformation().browser===g._Browser.Firefox&&(e=e.replace(/<br ?\/?>/g,"\n")),e},t.prototype._updateMentionTotal=function(){if(this._inputElement){var e=this._inputElement.querySelectorAll("a[".concat("data-sp-mention-user-id","]"));this._mentionsTotal=e.length,this._mentionsWithAccess=0,this._mentionsWithoutAccess=0;for(var t=0;t<e.length;t++){var n=e[t].getAttribute("access-type");"1"===n?this._mentionsWithAccess+=1:"0"===n&&(this._mentionsWithoutAccess+=1)}}},t.prototype._logMentionTotal=function(){this._updateMentionTotal();var e=new r._LogEntry("CommentsAtMention","CommentsPost",r._LogType.Event,{mentionTotal:this._mentionsTotal.toString(),mentionWithPermission:this._mentionsWithAccess.toString(),mentionWithoutPermission:this._mentionsWithoutAccess.toString()});p._EngagementLogger.logEventWithLogEntry(e)},t}(i.Component),N=n("Mi5U"),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onChange=function(e){k.e.logUserEngagementForPage(d.t.fields,!0,e?"CommentsEnable":"CommentsDisable"),o.e.setDisabled(!e).then(function(){o.e.clearComments(),e&&o.e.getComments().catch(function(){})})},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=k.e.isNewPage(),t=i.createElement(N.e,{checked:!this.props.disabled,disabled:e,onAriaLabel:x.H,onText:x.B,offAriaLabel:x.R,offText:x.N,onChanged:this._onChange,"data-automation-id":this.props.disabled?"sp-comment-toggle-disabled":"sp-comment-toggle-enabled"});return e&&(t=i.createElement(u.TooltipHost,{content:x.J,calloutProps:{gapSpace:0}},t)),i.createElement("div",{className:C.spToggleWrapper},t)},t}(i.Component),j=B,V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=Object(u.mergeStyles)(C.spHeader,C.fluent);return i.createElement("div",null,i.createElement("h2",{className:e,id:"sp-comments"},b.StringHelper.format(b.StringHelper.getLocalizedCountValue(x.C,x.O,this.props.count),this.props.count)),this.props.isToggleVisible&&i.createElement(j,{disabled:this.props.disabled}))},t}(i.Component),z=V,G=n("Ycni"),K=n("Pk8u");function W(e){var t={ariaLabel:x.h,className:"deleteAction".concat(e.comment.id),menuIconProps:{iconName:"More"},menuProps:{directionalHint:u.DirectionalHint.bottomRightEdge,items:[{key:"delete",iconProps:{iconName:g._SPKillSwitch.isActivated("f77cd7ea-a060-4c3e-9f05-ebb4df562947")?"Trash":"Delete"},name:x.m,"data-automation-id":"comment-delete-button"}],isBeakVisible:!0}},n=Object(K.merge)({},t,e);return i.createElement(u.TooltipHost,{content:x.h,calloutProps:{gapSpace:0}},i.createElement(u.ActionButton,Object(a.__assign)({},n,{"data-automation-id":"comment-more-button"})))}var q=n("iCqU"),Q=n("ckC2"),Y=n("8q3o"),J=n("nSz9"),X=function(e){function t(t){var n=e.call(this,t)||this;return n._isLikedByLPCLayeringKSActive=g._SPKillSwitch.isActivated("c7e71f3e-cfb9-4f2b-9764-ff07ab466ac5"),n.state={isOpen:n.props.isOpen},n}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e){this._isLikedByLPCLayeringKSActive||e.isOpen||!this.props.isOpen||Object(Y.e)(document.body)},t.prototype.render=function(){return i.createElement(q.e,Object(a.__assign)({},this.props))},t.defaultProps={className:C.spLikesPanel,closeButtonAriaLabel:x.S,customWidth:"320px",headerText:x.A,isBlocking:!0,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},onRenderHeader:ee,onRenderBody:te,type:Q.e.custom},t}(u.BaseComponent);function Z(e){var t=s.e.instance.serviceScope.consume(y.PageContext.serviceKey);return i.createElement(J.e,{pageContext:t,user:e,immediateLPC:!0})}function $(e){return i.createElement(u.FocusZone,{direction:u.FocusZoneDirection.vertical},i.createElement(u.List,{className:C.spLikesList,items:e.comment.likedBy,onRenderCell:Z}))}function ee(){return i.createElement("div",{className:Object(u.css)("ms-Panel-header",C.spLikesPanelHeader)},i.createElement("p",{className:C.spLikesPanelHeaderText},x.A))}function te(e){return i.createElement("div",{className:Object(u.css)("ms-Panel-content",C.spLikesPanelContent)},i.createElement($,Object(a.__assign)({},e)),e.comment.nextLikesLink&&i.createElement(u.ActionButton,{ariaLabel:x.v,onClick:function(){return o.e.getNextLikes(e.comment)},text:x.G}))}var ne=n("QdXD");function ae(e){var t,n={ariaLabel:(t=e.comment.userLiked,t?x.y:x._),className:C.spActionLike,iconProps:{iconName:e.comment.userLiked?"LikeSolid":"Like"},text:e.comment.userLiked?ne.a:ne.t},r=Object(K.merge)({},n,e);return i.createElement(u.ActionButton,Object(a.__assign)({},r))}function ie(e){var t={ariaLabel:g.Text.format(x.g,e.comment.author.name),className:C.spAction,iconProps:{iconName:"Reply"},text:x.b},n=Object(K.merge)({},t,e);return i.createElement(u.ActionButton,Object(a.__assign)({},n,{"data-automation-id":"comment-reply-button"}))}var re=n("5Zgq");function oe(e){var t=s.e.instance.disableEditing,n=e.commentProps.data;return i.createElement("div",null,!t&&!n.isReply()&&n.isFromServer&&i.createElement(ie,{comment:n,onClick:e.onReplyButtonClick}),!t&&n.isFromServer&&i.createElement(ae,{comment:n,onClick:e.onLikeButtonClick}),!t&&n.likeCount-Number(n.userLiked)>0&&i.createElement(re.e,{item:n,onClick:n.likeCount?e.onLikedByMessageClick:e.onLikeButtonClick}))}var se=function(e){function t(n){var a=e.call(this,n)||this;return a._relativeTime=function(e){return e=a._forcePastDate(e),(null===G.LocaleFormat||void 0===G.LocaleFormat?void 0:G.LocaleFormat.formatRelativeTimeApproximate)?G.LocaleFormat.formatRelativeTimeApproximate(e):void 0},a._onDelete=function(){k.e.logUserEngagementForPage(d.t.fields,!0,"CommentDeleteOpenAction"),Object(I.DeferredDialogUtility)().then(function(e){e.showConfirmationDialog(x.I,void 0,function(){k.e.logUserEngagementForPage(d.t.fields,!0,"CommentDeleteConfirmAction"),o.e.deleteComment(a.props.data),k.e.alertScreenreader(x.f,x.u,a.props.replyCount),t._focusAfterDismiss(ue.topLevelReply)},function(){k.e.logUserEngagementForPage(d.t.fields,!0,"CommentDeleteCancelAction"),t._focusAfterDismiss(a._moreActionsButton)},x.D,!0)})},a._onCloseLikedByPanel=function(){a.setState({isLikedByPanelVisible:!1})},a._onOpenLikedByPanel=function(){a._shouldGetLikes&&o.e.getNextLikes(a._comment),a.setState({isLikedByPanelVisible:!0})},a._onReply=function(){k.e.logUserEngagementForPage(d.t.fields,!0,"CommentReplyAction"),o.e.focusReply(a.props.parentCommentId||a._comment.id)},a._onToggleLikeButton=function(){a._comment&&a._sendToggleLikeAction(a._comment,s.e.instance.user)},a._getAuthorUpn=function(e){return e.loginName?e.loginName.slice(e.loginName.lastIndexOf("|")+1):e.email},a.state={isLikedByPanelVisible:!1,showReply:!1},a}return Object(a.__extends)(t,e),t._focusAfterDismiss=function(e){setTimeout(function(){e&&e.focus()},500)},t.prototype.render=function(){var e=s.e.instance.serviceScope.consume(y.PageContext.serviceKey),t=i.createElement(v.e,{personaType:"User",identifier:this._comment.author.email,lpcHoverTargetProps:{upn:this._getAuthorUpn(this._comment.author)},pageContext:e.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},this._authorComponent()),n=g.Text.format(x.e,this._comment.author.name,this._relativeTime(this._comment.date)),a=i.createElement(oe,{commentProps:this.props,onLikeButtonClick:this._onToggleLikeButton,onLikedByMessageClick:this._onOpenLikedByPanel,onReplyButtonClick:this._onReply});return i.createElement("div",{className:Object(u.css)(C.spContentRegion,u.AnimationClassNames.scaleUpIn100)},i.createElement(O,{disabled:!1,user:this._comment.author}),i.createElement("div",{className:C.spContent},t,i.createElement("div",{className:C.spMetadata},i.createElement(u.Label,{"aria-label":n,title:n},this._relativeTime(this._comment.date))),i.createElement("div",{className:C.spText},i.createElement(M,{mentions:this._comment.mentions,pageContext:e,text:this._comment.text})),i.createElement("div",{className:Object(u.css)(C.spActions,this.props.data.isFromServer?u.AnimationClassNames.fadeIn500:C.spActionsHidden)},a,this._canDelete()&&!s.e.instance.disableEditing&&this._comment.isFromServer&&i.createElement(W,{comment:this._comment,componentRef:this._resolveRef("_moreActionsButton"),menuProps:{onItemClick:this._onDelete}}))),i.createElement(X,{comment:this._comment,isOpen:this.state.isLikedByPanelVisible,onDismiss:this._onCloseLikedByPanel}))},t.prototype._authorComponent=function(){return i.createElement("span",{className:C.spAuthor},this._comment.author.name)},t.prototype._canDelete=function(){return s.e.instance.deleteAllPermission||this._comment.author.email===s.e.instance.user.email},Object.defineProperty(t.prototype,"_comment",{get:function(){return this.props.data},enumerable:!1,configurable:!0}),t.prototype._forcePastDate=function(e){var t=new Date;return e<=t?e:t},t.prototype._sendToggleLikeAction=function(e,t){e.userLiked?o.e.unlikeComment(e,t):o.e.likeComment(e,t)},Object.defineProperty(t.prototype,"_shouldGetLikes",{get:function(){return this._comment.likedBy&&this._comment.likedBy.length<25&&Boolean(this._comment.nextLikesLink)},enumerable:!1,configurable:!0}),t}(u.BaseComponent),ce=n("PJr9"),de=function(e){function t(t){var n=e.call(this,t)||this;return n._onLoadMore=function(){k.e.logUserEngagementForPage(d.t.fields,!0,"LoadMoreCommentReplies"),o.e.getNextReplies(n.props.data.nextLink,n.props.data.id)},n._processActions=function(){var e=d.t.pageReduxStore.getState(),t=e.comments.focusedCommentId;e.slicesUpdated.indexOf(ce.e.CommentStore)>-1&&e.slicesUpdated.indexOf(ce.e.ActionStore)>-1&&(n.props.data.id===t||n.state.showReply)&&n.props.data&&(n.state.showReply&&n._replyBlock.focus(),n.setState({showReply:n.props.data.id===t}))},n._assignReplyBlockRef=function(e){n._replyBlock=e},n.state={showReply:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._addStoreListeners()},t.prototype.componentWillUnmount=function(){this._removeStoreListeners()},t.prototype.render=function(){var e=this;return i.createElement("div",{className:Object(u.css)(C.spComment,this.props.data.isDeleted()?u.AnimationClassNames.scaleDownOut98:""),"data-automation-id":this.props.data.isReply()?"sp-comment-block-reply":"sp-comment-block-root",id:"sp-comment-".concat(this.props.data.id)},i.createElement(se,{data:this.props.data,disallowEdit:s.e.instance.disableEditing||!this.props.data.isFromServer,parentCommentId:this.props.parentCommentId,replyCount:this.props.data.replies.length}),this.props.data.replies&&(this.props.data.replies.length>0||this.state.showReply)&&i.createElement("div",{className:C.spComments},this._nextLinkElement(),this.props.data.replies.map(function(n){return i.createElement(t,{data:n,key:n.optimisticId||n.id,parentCommentId:e.props.data.id})}),this._replyElement()))},t.prototype._addStoreListeners=function(){this._unlisten=d.t.addListener(this._processActions)},t.prototype._nextLinkElement=function(){return this.props.data.nextLink&&i.createElement(u.Link,{className:[C.spMore,C.spMoreBlock].join(" "),onClick:this._onLoadMore},x.K)},t.prototype._removeStoreListeners=function(){this._unlisten&&this._unlisten()},t.prototype._replyElement=function(){return this.state.showReply?i.createElement(R,{autoFocus:!0,commentId:this.props.data.id,disabled:s.e.instance.disableEditing,ref:this._assignReplyBlockRef}):void 0},t}(i.Component),le=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._assignCommentReplyRef=function(e){t.topLevelReply=e},n._onLoadMore=function(){k.e.logUserEngagementForPage(d.t.fields,!0,"LoadMoreComments"),o.e.getNextComments(n.props.nextLink)},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e;return this.props.disabledAtSiteOrTenant||this.props.disabled&&!this.props.isToggleVisible?i.createElement(i.Fragment,null):i.createElement("aside",{className:Object(u.css)(C.spCommentSection),role:"complementary","aria-label":x.n},i.createElement(z,{count:this.props.count,isToggleVisible:this.props.isToggleVisible,disabled:this.props.disabled}),this.props.isPublished?i.createElement("div",{className:C.spComments},i.createElement(R,{disabled:s.e.instance.disableEditing||this.props.disabled,ref:this._assignCommentReplyRef}),!this.props.disabled&&(null===(e=this.props.comments)||void 0===e?void 0:e.map(function(e){return i.createElement(de,{data:e,key:e.optimisticId||e.id})})),!this.props.disabled&&this.props.nextLink&&i.createElement(u.Link,{className:C.spMore,onClick:this._onLoadMore},x.z)):i.createElement("div",{className:C.spComments},i.createElement(u.Label,null,x.t)))},t}(i.Component),ue=le,fe=n("kJuR"),pe=function(e){function t(n){var a=e.call(this,n)||this;return a._hasSubscribedToFluidMetadataChange=!1,a._updateStateFromStore=function(){d.t.sliceUpdated.indexOf(ce.e.DisplayModeStore)>-1&&a._subscribeToFluidMetadataChange(),-1!==d.t.sliceUpdated.indexOf(ce.e.CommentStore)?(a.props.onDisabledChange&&a.props.onDisabledChange(a._commentSlice.disabled),a.setState({comments:a._commentSlice.comments,count:a._commentSlice.commentCount,disabled:a._getIsDisabled(),disabledAtSiteOrTenant:a._commentSlice.disabledAtSiteOrTenant,nextLink:a._commentSlice.nextLink})):t._commentsHasRendered&&t._onPageStoreUpdated()},a._getIsDisabled=function(){return d.t.isCoAuth?!Object(fe.i)("IsCommentSectionEnabled"):a._commentSlice.disabled},a._subscribeToFluidMetadataChange=function(){if(d.t.isCoAuth&&!a._hasSubscribedToFluidMetadataChange){a._hasSubscribedToFluidMetadataChange=!0;var e=F.e.instance.coAuthSessionContext,t=e.codeModules;e.fluidOrchestrator.pageFluidDataManager.metadata.on("METADATA_CHANGED_REMOTELY",function(e){if(e.key===t.MetadataKeys.IsCommentSectionEnabled){var n=!Object(fe.i)("IsCommentSectionEnabled");o.e.setDisabledLocal(n),a.setState({disabled:n})}})}},a._qosMonitor=new r._QosMonitor("CommentLoadedAndRendered"),d.t.addReducer("comments",c.default),a.state={comments:a._commentSlice.comments,count:a._commentSlice.commentCount,disabled:a._getIsDisabled(),disabledAtSiteOrTenant:a._commentSlice.disabledAtSiteOrTenant,nextLink:a._commentSlice.nextLink},a._updateCommentContext(n),a._subscribeToFluidMetadataChange(),a}return Object(a.__extends)(t,e),t._onPageStoreUpdated=function(){k.e.isNewPage()&&(t._refreshOnNextStoreUpdate=!0),(k.e.navigatedToNewPage(this._pageKey)||t._refreshOnNextStoreUpdate&&!k.e.isNewPage())&&(t._pageKey=k.e.getPageKey(),o.e.clearComments(),o.e.getComments().catch(function(){}),t._refreshOnNextStoreUpdate=!1)},t.prototype.componentDidMount=function(){this._checkQoSFinished(),this._unsubscribe=d.t.addListener(this._updateStateFromStore),this._onFirstRender(),this._updateTimer=window.setInterval(this.forceUpdate.bind(this),6e4)},t.prototype.componentDidUpdate=function(){this._checkQoSFinished()},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updateCommentContext(e)},t.prototype.componentWillUnmount=function(){this._unsubscribe(),clearInterval(this._updateTimer),t._lastTimeout&&clearTimeout(t._lastTimeout),t._commentsHasRendered=!1},t.prototype.render=function(){var e;try{return i.createElement(ue,{comments:this.state.comments,count:this.state.count,disabled:this.state.disabled,disabledAtSiteOrTenant:this.state.disabledAtSiteOrTenant,isToggleVisible:this.props.isToggleVisible,nextLink:this.state.nextLink,isPublished:k.e.hasPageBeenPublished()})}catch(a){var n=new Error(a);this._qosMonitor.writeUnexpectedFailure("FailedRenderTag",n),r._TraceLogger.logError(t._logSource,n),null===(e=this.props.customerPromiseManager)||void 0===e||e.updateCustomerPromiseInstance(this.props.customerPromiseInstanceId,{commentsData:"Failed"},[n])}},t.prototype._onFirstRender=function(){var e=this;t._pageKey=k.e.getPageKey(),o.e.clearComments(),o.e.getComments().then(function(){var n;t._commentsHasRendered=!0,e._scrollToCommentsIfNeeded(),null===(n=e.props.customerPromiseManager)||void 0===n||n.updateCustomerPromiseInstance(e.props.customerPromiseInstanceId,{commentsData:"Success"})}).catch(function(t){var n;null===(n=e.props.customerPromiseManager)||void 0===n||n.updateCustomerPromiseInstance(e.props.customerPromiseInstanceId,{commentsData:"Failed"},[t])})},t.prototype._checkQoSFinished=function(){!this._qosMonitor.hasEnded&&this._commentSlice.loaded&&this._qosMonitor.writeSuccess()},Object.defineProperty(t.prototype,"_commentSlice",{get:function(){return d.t.pageReduxStore.getState().comments},enumerable:!1,configurable:!0}),t.prototype._scrollToCommentsIfNeeded=function(){"#comments"===window.location.hash?this._scrollToCommentsSection():new l(window.location.hash).scroll()},t.prototype._scrollToCommentsSection=function(){var e=document.getElementById("sp-comments");e&&e.scrollIntoView()},t.prototype._updateCommentContext=function(e){s.e.instance.deleteAllPermission=e.deleteAllPermission,s.e.instance.disableEditing=e.disableEditing,s.e.instance.serviceScope=e.serviceScope,s.e.instance.user=e.user},t._commentsHasRendered=!1,t._refreshOnNextStoreUpdate=!1,t._logSource=r._LogSource.create("CommentContainer"),t}(i.Component);t.default=pe},QdXD:function(e){e.exports=JSON.parse('{"e":"{0} Press Enter to view details.","t":"Like","a":"Unlike","n":"Like this page","s":"and {0} more…","c":"You liked this||You and {0} person liked this||You and {0} people liked this","d":"||{0} person liked this||{0} people liked this","l":"You liked this page.||You and {0} person liked this page.||You and {0} people liked this page.","u":"||{0} person liked this page.||{0} people liked this page.","i":"You liked this comment.||You and {0} person liked this comment.||You and {0} people liked this comment.","r":"||{0} person liked this comment.||{0} people liked this comment.","o":"0||1||2-"}')},Y7TA:function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n("17wl"),i=n("cDcd"),r=n("jOlS");Object(r.loadStyles)([{rawString:".deferredLivePersonaCardRoot_6d7894f7{display:inline-block}.deferredLivePersonaCardRoot_6d7894f7 .lpc-hoverTarget:focus-visible[data-is-focusable=true]{position:initial;outline:-webkit-focus-ring-color auto 1px}"}]);var o=n("5pbq"),s=n("vNcA"),c=function(e){function t(t){var n=e.call(this,t)||this;return n._deferLoadComponent=function(){!n.state.ComponentModule&&n.props.moduleLoader&&n.props.modulePath&&n.props.moduleLoader.load(n.props.modulePath,n.props.getModule).then(function(e){if(n.props.moduleLoader.parse&&(e=n.props.moduleLoader.parse(e)),!e){var t="ReactDeferredComponent: component not found when loading ".concat(n.props.modulePath," ")+"- check your load and parse functions";console.error(t)}n._mounted?n.setState({ComponentModule:e}):n.state={ComponentModule:e}})},n._mounted=!1,n.state={ComponentModule:void 0},n._setupDeferLoadCallback(t),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?i.createElement(t,Object(a.__assign)({ref:function(t){t&&Object(s.hoistMethods)(e,t)}},this.props.props),this.props.children):this.props.placeHolder||null},t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)},t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._setupDeferLoadCallback(e)},t.prototype._setupDeferLoadCallback=function(e){var t=e.customWaiter;t?t.then(this._deferLoadComponent):this._deferLoadComponent()},t}(i.Component),d=n("K9kD"),l=function(e){function t(t,a){var r=e.call(this,t,a)||this;return r._onActivate=function(e){r.state.hovered||r.setState({hovered:!0,activatedByFocus:"focus"===e.type})},r.modulePath="./SpLivePersonaCard",r.moduleLoader={load:function(){return Promise.all([n.e(177),n.e(17),n.e(66)]).then(n.bind(null,"Wv/s")).then(function(e){return e.SpLivePersonaCard})}},r.state={hovered:t.forceLoad,activatedByFocus:!1},r.containerRef=i.createRef(),r}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.state.hovered;this.onFocusRender=function(){if(e.state.activatedByFocus){var t=e.containerRef.current.firstChild;e.props.shouldOnFocusMoveFocusToTarget&&t&&t.className.indexOf("lpc-hoverTarget")>-1&&t.focus()}},this._deferredComponentProps={modulePath:this.modulePath,moduleLoader:this.moduleLoader,props:Object(a.__assign)(Object(a.__assign)({},this.props),{onPersonaCardReady:this.onFocusRender}),customWaiter:this.props.customWaiter,placeHolder:this.props.placeHolder};var n=d.Killswitch.isActivated("306d9715-fab4-4c1d-aca6-5fb0e292f65e"),r=Object(o.css)("deferredLivePersonaCardRoot","deferredLivePersonaCardRoot_6d7894f7",this.props.className);return i.createElement("div",{onMouseOver:!n&&t?void 0:this._onActivate,onClick:!n&&t?void 0:this._onActivate,onFocus:!n&&t?void 0:this._onActivate,onMouseDown:!n&&t?void 0:this._onActivate,onKeyDown:!n&&t?void 0:this._onActivate,className:r,tabIndex:!n&&t?void 0:this.props.containerTabIndex,ref:this.containerRef,"data-is-focusable":!(!(this.props.containerTabIndex>-1)||t)},t?i.createElement(c,Object(a.__assign)({},this._deferredComponentProps),this.props.children):this.props.children)},t.defaultProps={containerTabIndex:-1},t}(o.BaseComponent)},nSz9:function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("Y7TA"),o=n("UWqr"),s=n("yo36"),c=n.n(s),d=n("hiL/"),l=n("q79n");n("jOlS").loadStyles('.fr_r_ada2ac09{padding:7px 0;vertical-align:middle}.fr_r_ada2ac09 .fs_r_ada2ac09{border-radius:50%;vertical-align:middle}[dir=ltr] .fr_r_ada2ac09 .fs_r_ada2ac09{margin-right:10px}[dir=rtl] .fr_r_ada2ac09 .fs_r_ada2ac09{margin-left:10px}.fr_r_ada2ac09 .ft_r_ada2ac09{color:"[theme:bodyText, default: #323130]";font-size:14px;font-weight:400;vertical-align:middle}',!0);var u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,n=e.user,a=e.lpcCardBehavior,o=e.immediateLPC;return i.createElement(r.e,{personaType:"User",identifier:n.email,pageContext:this.props.pageContext.legacyPageContext,lpcCardBehavior:a,ariaLabel:t,moduleLoader:void 0,forceLoad:o},this._renderPersonaCell())},t.prototype._renderPersonaCell=function(){var e=void 0===this.props.size?32:this.props.size;return i.createElement("div",{className:"fr_r_ada2ac09","data-is-focusable":!0,"aria-label":this.props.user.name},i.createElement(c.a,{key:this.props.user.email,dimensions:{height:e,width:e},displayName:this.props.user.name},i.createElement("img",{alt:o.Text.format(l.e,this.props.user.name),className:"fs_r_ada2ac09",src:d.SPUtility.getUserPhotoUrl(this.props.user.email)})),i.createElement("span",{className:"ft_r_ada2ac09"},this.props.user.name))},t}(i.Component);t.e=u},q79n:function(e){e.exports=JSON.parse('{"e":"Photo of {0}"}')}}]);