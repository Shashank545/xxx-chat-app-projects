(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[66],{QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},"Wv/s":function(e,t,n){"use strict";n.r(t),n.d(t,"SpLivePersonaCard",function(){return v});var a=n("17wl"),i=n("cDcd"),r=n("5pbq"),o=n("QVYh"),s=n("jOlS");Object(s.loadStyles)([{rawString:".livePersonaCardAdapterRoot{display:inline-block}"}]);var c=n("9FFT"),d=n("K9kD"),l=n("FeTS"),u=n("gM97"),f=n("dq6a"),p=n("Gu0Z"),m=function(e){function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;return n._oAuthTokenProvider=new u.e(null,{oAuthTokenDataSource:new p.e(t)}),n}return Object(a.__extends)(t,e),t.prototype.getRegion=function(){var e=new d.Qos({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n)return e.end({resultType:d.ResultTypeEnum.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"}),"";var a=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[a]}catch(t){return e.end({resultType:d.ResultTypeEnum.Failure,resultCode:"LokiGetRegionError",error:t}),""}},t.prototype.getAuthTokenGetter=function(e){return void 0===e&&(e=""),this.getAadAuthTokenGetter()},t.prototype.getAadAuthTokenGetter=function(){var e,t,n=this,a=this._pageContext.CorrelationId,i=(e=this._pageContext.farmSettings,(t=Object(l.e)(e))&&t.Loki||"https://loki.delve.office.com");return function(e,t){n._oAuthTokenProvider.getInstrumentedToken(i).then(function(t){return e(t.tokenInfo.token,t.spRequestId)}).catch(function(e){var n={httpStatusCode:e.httpResponseStatus,serverErrorCode:e.serverErrorCode,requestCorrelationId:e.correlationId,type:e.type};t(JSON.stringify(n),a)})}},t.prototype.getBootstrapperConfig=function(){return{culture:this._pageContext.currentUICultureName,region:this.getRegion(),clientType:"ODSP",clientCorrelationId:this._pageContext.CorrelationId,complianceEnvironment:d.Killswitch.isActivated("f513174d-96fc-46d5-ae79-ba202d3ebf91")?(e=this._pageContext,_(e)?"Blackforest":b(e)?"GccModerate":"Prod"):h(this._pageContext),getAuthToken:this.getAuthTokenGetter()};var e},t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"},t}(f.t);function _(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_1")}function h(e){switch(Object(l.t)(e)||"prod"){case"o365test":case"onebox":case"edog":case"spdf":return"Df";case"prodbubble":return"Msit";default:return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09"}}function b(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")||0===t.indexOf("us_105_")||0===t.indexOf("us_265_")||0===t.indexOf("us_266_")||0===t.indexOf("us_267_")||0===t.indexOf("us_268_")||0===t.indexOf("us_269_")||0===t.indexOf("us_270_")}var g=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};return i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback),{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks,clientType:i.props.lpcClientType}},i.state={isReady:!1},i.hasCalledOnReady=!1,t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})}),i}return Object(a.__extends)(t,e),t.ensureInitializeLPC=function(e){if(!e.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if((e.pageContext.isExternalGuestUser||e.pageContext.isAnonymousGuestUser)&&(t.disableLPCForNativeIdentity||!e.pageContext.isNativeFederatedUser))return Promise.reject("LPC is not enabled for guest users.");if(window.LPC&&window.LPC.getRenderer)return t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),Promise.resolve();var n=new m(e.pageContext),a=n.getAadAuthTokenGetter(),i=h(e.pageContext),r={culture:e.pageContext.currentUICultureName,region:n.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:a,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:"Msit"===i||"Df"===i?"Prod":i};return Object(c.initializeLivePersonaCardAsync)(r).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget,t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2,e.callback&&e.callback(),e.onSuccess&&e.onSuccess()}).catch(function(t){e.onFailure&&e.onFailure(t)})},t._buildHostAppPersonaId=function(e,n){if(!t.disableLPCForNativeIdentity&&e&&n)return e=e.replace(/[{}]/g,""),n=n.replace(/[{}]/g,""),"".concat(e,"@").concat(n)},t.prototype.render=function(){var e=this,n=!!this.props.displayName;if(t.LivePersonaCardHoverTargetV2&&!this.props.lpcHoverTargetProps){var o=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),{cardParameters:Object(a.__assign)({personaInfo:{identifiers:{HostAppPersonaId:t._buildHostAppPersonaId(this.props.organizationId,this.props.tenantId),DisplayName:this.props.displayName,Smtp:this.props.legacyEmail||this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.legacyEmail:void 0),PersonaType:this.props.personaType,TopicId:this.props.topicId,LocationId:this.props.locationId},displayName:n?this.props.displayName:void 0,personaCoinColor:n?Object(r.getPersonaInitialsColor)({text:this.props.displayName}):void 0},behavior:Object(a.__assign)(Object(a.__assign)({},this.props.lpcCardBehavior),{onCardOpen:function(){e.props.loggingData&&d.Engagement.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()},onCardClose:function(){e.props.loggingData&&d.Engagement.logData(e.props.loggingData),e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardClose&&e.props.lpcCardBehavior.onCardClose()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})}),this.props.lpcHoverTargetV2Props);return i.createElement(t.LivePersonaCardHoverTargetV2,Object(a.__assign)({},o),this.props.children)}return t.LivePersonaCardHoverTarget?(o=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({upn:this.props.legacyEmail,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex}),this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel}),this.props.lpcHoverTargetProps),{onCardOpen:function(){e.props.loggingData&&d.Engagement.logData(e.props.loggingData),e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}}),i.createElement(t.LivePersonaCardHoverTarget,Object(a.__assign)({},o),this.props.children)):i.createElement("div",{className:"livePersonaCardAdapterRoot"},this.props.children)},t.prototype.componentDidUpdate=function(){this.state.isReady&&!this.hasCalledOnReady&&this.props.onPersonaCardReady&&(this.hasCalledOnReady=!0,this.props.onPersonaCardReady())},t.LivePersonaCardHoverTarget=void 0,t.LivePersonaCardHoverTargetV2=void 0,t.disableLPCForNativeIdentity=d.Killswitch.isActivated("4447C532-D4A2-4162-9C89-56324A4F7E52","08/03/2021","enable LPC for native identity users"),t._logResult=function(e,t,n){},t}(r.BaseComponent),v=function(e){function t(n,a){var i=e.call(this,n,a)||this;return i.state={lpcCallbacks:t.makeSpLpcCallbacks(void 0,i.props.pageContext,i.props.lpcCallbacks)},i}return Object(a.__extends)(t,e),t.makeSpLpcCallbacks=function(e,t,n){return Object(a.__assign)(Object(a.__assign)({},n||{}),{getAndPrefetchPersonaImageUri:function(e,t){"User"===e.PersonaType&&e.Smtp&&t?t(Object(o.getUserPhotoUrl)(e.Smtp,o.UserPhotoSize.Large)):t()},addGroupMembers:e})},t.prototype.render=function(){return i.createElement(g,{personaType:this.props.personaType,displayName:this.props.displayName,legacyEmail:this.props.identifier,locationId:this.props.locationId,pageContext:this.props.pageContext,dataAutomationId:this.props.dataAutomationId,lpcCallbacks:this.state.lpcCallbacks,lpcHoverTargetProps:this.props.lpcHoverTargetProps,loggingData:this.props.loggingData,lpcCardBehavior:this.props.lpcCardBehavior,lpcHoverTargetV2Props:this.props.lpcHoverTargetV2Props,ariaLabel:this.props.ariaLabel,tabIndex:this.props.tabIndex,lpcClientType:this.props.lpcClientType,topicId:this.props.topicId,organizationId:this.props.organizationId,tenantId:this.props.tenantId,onPersonaCardReady:this.props.onPersonaCardReady},this.props.children)},t}(r.BaseComponent)}}]);